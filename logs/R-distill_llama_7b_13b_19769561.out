Wed Dec 13 16:07:17 2023       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.104.12             Driver Version: 535.104.12   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA H100 PCIe               On  | 00000000:A1:00.0 Off |                    0 |
| N/A   23C    P0              44W / 350W |      4MiB / 81559MiB |      0%   E. Process |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
python3 -m torch.distributed.run --nproc_per_node 1 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 3026 /dtu/p1/johlau/LMOps/minillm/train_minillm.py --base-path /dtu/p1/johlau/LMOps/minillm --model-path /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_init/llama-7B --teacher-model-path /dtu/p1/johlau/LMOps/minillm/results/llama/train/sft/llama-13B --ckpt-name 7B-init --teacher-ckpt-name 13B-sft --n-gpu 1 --n-nodes 1 --model-type llama --teacher-model-fp16 --gradient-checkpointing --prompt-data-dir /dtu/p1/johlau/LMOps/minillm/processed_data/dolly/prompt/llama/ --lm-data-dir /dtu/p1/johlau/LMOps/minillm/processed_data/roberta/llama/256/20M/ --dev-num 1000 --num-workers 0 --epochs 10 --total-iters 1000 --kd-ratio 0.5 --batch-size 2 --eval-batch-size 4 --lr 5e-6 --lr-min 5e-6 --gradient-accumulation-steps 2 --max-length 256 --max-prompt-length 128 --warmup-iters 100 --scheduler-name cosine_trm --save /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/ --seed 10 --seed-ppo 42 --seed-lm 7 --save-interval 500 --eval-interval 100 --log-interval 16 --mid-log-num 1 --type minillm --ppo-epochs 4 --num-rollouts 64 --chunk-size 2 --length-norm --single-step-reg --teacher-mixed-alpha 0.2 --reward-scaling 0.5 --cliprange-reward 100 --do-sample --top-k 0 --top-p 1.0 --temperature 1.0 --deepspeed --deepspeed_config /dtu/p1/johlau/LMOps/minillm/configs/deepspeed/ds_config_zero2_offload.json /dtu/p1/johlau/LMOps/minillm 3026
PYTHONPATH=/dtu/p1/johlau/LMOps/minillm
[2023-12-13 16:07:23,552] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
using world size: 1
[2023-12-13 16:07:25,012] [INFO] [comm.py:637:init_distributed] cdb=None
[2023-12-13 16:07:25,012] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_path ................... /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_init/llama-7B
  ckpt_name .................... 7B-init
  model_type ................... llama
  teacher_model_type ........... None
  n_gpu ........................ 1
  n_nodes ...................... 1
  teacher_model_path ........... /dtu/p1/johlau/LMOps/minillm/results/llama/train/sft/llama-13B
  teacher_ckpt_name ............ 13B-sft
  teacher_model_fp16 ........... True
  model_parallel ............... False
  model_parallel_size .......... None
  no_value ..................... False
  dropout_path_rate ............ None
  fp32 ......................... False
  type ......................... minillm
  do_train ..................... False
  do_valid ..................... False
  do_eval ...................... False
  base_path .................... /dtu/p1/johlau/LMOps/minillm
  load ......................... None
  save ......................... /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
  log_interval ................. 16
  mid_log_num .................. 1
  save_interval ................ 500
  eval_interval ................ 100
  local_rank ................... 0
  save_additional_suffix ....... 
  save_rollout ................. False
  eb_sample_times .............. 3
  data_dir ..................... None
  processed_data_dir ........... None
  force_process ................ False
  force_process_demo ........... False
  data_process_workers ......... -1
  train_num .................... -1
  train_ratio .................. 1
  dev_num ...................... 1000
  dev_ratio .................... 1
  gen_num ...................... -1
  data_names ................... None
  prompt_type .................. None
  num_workers .................. 0
  max_prompt_length ............ 128
  min_prompt_length ............ 64
  json_data .................... False
  bin_data ..................... False
  txt_data ..................... False
  prompt_data_dir .............. /dtu/p1/johlau/LMOps/minillm/processed_data/dolly/prompt/llama/
  lm_data_dir .................. /dtu/p1/johlau/LMOps/minillm/processed_data/roberta/llama/256/20M/
  eval_ppl ..................... False
  eval_rw ...................... False
  eval_gen ..................... False
  only_prompt .................. False
  batch_size ................... 2
  eval_batch_size .............. 4
  clip_grad .................... 1.0
  total_iters .................. 1000
  train_iters_per_epoch ........ -1
  max_length ................... 256
  seed ......................... 10
  seed_order ................... 42
  seed_data .................... 42
  seed_ppo ..................... 42
  seed_lm ...................... 7
  epochs ....................... 10
  training_epochs .............. 10000
  gradient_accumulation_steps .. 2
  gradient_checkpointing ....... True
  attn_dtype ................... None
  lr ........................... 5e-06
  lr_min ....................... 5e-06
  weight_decay ................. 0.01
  loss_scale ................... 65536
  kd_ratio ..................... 0.5
  warmup_iters ................. 100
  lr_decay_iters ............... None
  lr_decay_style ............... noam
  scheduler_name ............... cosine_trm
  reward_scaling ............... 0.5
  cliprange_reward ............. 100.0
  ppo_epochs ................... 4
  num_rollouts ................. 64
  num_rollouts_per_device ...... 64
  cliprange .................... 0.2
  chunk_size ................... 2
  gamma ........................ 0.95
  length_norm .................. True
  single_step_reg .............. True
  teacher_mixed_alpha .......... 0.2
  lm_coef ...................... 1
  top_k ........................ 0
  top_p ........................ 1.0
  do_sample .................... True
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  num_beams .................... 1
  temperature .................. 1.0
  peft ......................... None
  peft_lora_r .................. 8
  peft_lora_alpha .............. 32
  peft_lora_dropout ............ 0.1
  peft_name .................... None
  peft_path .................... None
  teacher_peft_name ............ None
  teacher_peft_path ............ None
  deepspeed .................... True
  deepspeed_config ............. /dtu/p1/johlau/LMOps/minillm/configs/deepspeed/ds_config_zero2_offload.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  rank ......................... 0
  world_size ................... 1
 > number of parameters: 13015864320
 > number of parameters: 6738415616
Model load time: 5.948453187942505s
 > number of parameters: 6738M
[2023-12-13 16:07:42,830] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.12.1, git-hash=unknown, git-branch=unknown
[2023-12-13 16:07:43,665] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-12-13 16:07:43,666] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2023-12-13 16:07:43,666] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2023-12-13 16:07:43,678] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = AdamW
[2023-12-13 16:07:43,678] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=AdamW type=<class 'torch.optim.adamw.AdamW'>
[2023-12-13 16:07:43,678] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2023-12-13 16:07:43,678] [INFO] [stage_1_and_2.py:147:__init__] Reduce bucket size 200000000
[2023-12-13 16:07:43,678] [INFO] [stage_1_and_2.py:148:__init__] Allgather bucket size 200000000
[2023-12-13 16:07:43,678] [INFO] [stage_1_and_2.py:149:__init__] CPU Offload: True
[2023-12-13 16:07:43,678] [INFO] [stage_1_and_2.py:150:__init__] Round robin gradient partitioning: False
[2023-12-13 16:07:55,379] [INFO] [utils.py:802:see_memory_usage] Before initializing optimizer states
[2023-12-13 16:07:55,380] [INFO] [utils.py:803:see_memory_usage] MA 37.23 GB         Max_MA 37.23 GB         CA 37.23 GB         Max_CA 37 GB 
[2023-12-13 16:07:55,380] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 82.75 GB, percent = 11.0%
[2023-12-13 16:08:43,650] [INFO] [utils.py:802:see_memory_usage] After initializing optimizer states
[2023-12-13 16:08:43,651] [INFO] [utils.py:803:see_memory_usage] MA 37.23 GB         Max_MA 37.23 GB         CA 37.23 GB         Max_CA 37 GB 
[2023-12-13 16:08:43,651] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 158.72 GB, percent = 21.0%
[2023-12-13 16:08:43,651] [INFO] [stage_1_and_2.py:514:__init__] optimizer state initialized
[2023-12-13 16:08:43,740] [INFO] [utils.py:802:see_memory_usage] After initializing ZeRO optimizer
[2023-12-13 16:08:43,740] [INFO] [utils.py:803:see_memory_usage] MA 37.23 GB         Max_MA 37.23 GB         CA 37.23 GB         Max_CA 37 GB 
[2023-12-13 16:08:43,740] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 158.72 GB, percent = 21.0%
[2023-12-13 16:08:43,749] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = AdamW
[2023-12-13 16:08:43,749] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2023-12-13 16:08:43,749] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <torch.optim.lr_scheduler.LambdaLR object at 0x7fc9fafb1820>
[2023-12-13 16:08:43,749] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0], mom=[[0.9, 0.95]]
[2023-12-13 16:08:43,750] [INFO] [config.py:972:print] DeepSpeedEngine configuration:
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   amp_enabled .................. False
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   amp_params ................... False
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   bfloat16_enabled ............. False
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   checkpoint_parallel_write_pipeline  False
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   checkpoint_tag_validation_enabled  True
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   checkpoint_tag_validation_fail  False
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fc9fafb1490>
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   communication_data_type ...... None
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   curriculum_enabled_legacy .... False
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   curriculum_params_legacy ..... False
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   data_efficiency_enabled ...... False
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   dataloader_drop_last ......... False
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   disable_allgather ............ False
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   dump_state ................... False
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 5000, 'delayed_shift': 4, 'consecutive_hysteresis': False, 'min_scale': 1}
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   eigenvalue_enabled ........... False
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   eigenvalue_gas_boundary_resolution  1
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   eigenvalue_layer_num ......... 0
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   eigenvalue_max_iter .......... 100
[2023-12-13 16:08:43,750] [INFO] [config.py:976:print]   eigenvalue_stability ......... 1e-06
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   eigenvalue_tol ............... 0.01
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   eigenvalue_verbose ........... False
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   elasticity_enabled ........... False
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   fp16_auto_cast ............... False
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   fp16_enabled ................. True
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   fp16_master_weights_and_gradients  False
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   global_rank .................. 0
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   grad_accum_dtype ............. None
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   gradient_accumulation_steps .. 2
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   gradient_clipping ............ 1.0
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   gradient_predivide_factor .... 1.0
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   initial_dynamic_scale ........ 2048
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   load_universal_checkpoint .... False
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   loss_scale ................... 0
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   memory_breakdown ............. False
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   mics_hierarchial_params_gather  False
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   mics_shard_size .............. -1
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   optimizer_legacy_fusion ...... False
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   optimizer_name ............... None
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   optimizer_params ............. None
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   pld_enabled .................. False
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   pld_params ................... False
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   prescale_gradients ........... False
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   scheduler_name ............... None
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   scheduler_params ............. None
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   seq_parallel_communication_data_type  torch.float32
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   sparse_attention ............. None
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   sparse_gradients_enabled ..... False
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   steps_per_print .............. 10000000
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   train_batch_size ............. 4
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   train_micro_batch_size_per_gpu  2
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   use_node_local_storage ....... False
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   wall_clock_breakdown ......... False
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   weight_quantization_config ... None
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   world_size ................... 1
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   zero_allow_untested_optimizer  True
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=DeepSpeedZeroOffloadOptimizerConfig(device='cpu', nvme_path=None, buffer_count=4, pin_memory=False, pipeline=False, pipeline_read=False, pipeline_write=False, fast_init=False) sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   zero_enabled ................. True
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   zero_force_ds_cpu_optimizer .. False
[2023-12-13 16:08:43,751] [INFO] [config.py:976:print]   zero_optimization_stage ...... 2
[2023-12-13 16:08:43,751] [INFO] [config.py:962:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 2, 
    "zero_optimization": {
        "stage": 2, 
        "offload_optimizer": {
            "device": "cpu"
        }, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true
    }, 
    "zero_force_ds_cpu_optimizer": false, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 5.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1.000000e+07
}
Probing Dataset
Probing end. Max data state 1, total length 13517
Num PPO instances: 13517
Probing Dataset
Probing end. Max data state 1, total length 973
Num PPO instances: 973
Probing Dataset
Probing end. Max data state 1, total length 6958892
Num LM instances: 6958892
Probing Dataset
Probing end. Max data state 1, total length 10000
Num LM instances: 10000
                                 Evaluation #0                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ dime un chiste acerca de la situacion │ dime un chiste acerca de la          │
│ actual de la economia, de modo que    │ situacion actual de la economia, de  │
│ los niños comprendan el mal estado de │ modo que los niños comprendan el mal │
│ la misma.                             │ estado de la misma.                  │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ El economista más famoso que ha      │
│                                       │ vivido, no fue un erudito como es    │
│                                       │ sospechado. Fue tontito Bugs Bunny,  │
│                                       │ quien solucionó el mal estado        │
│                                       │ alcançado en varios países con tan   │
│                                       │ sólo un arrugazo y un suspiro.       │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Claro. Bien, un hombre entra en una  │
│                                       │ librería de Londres y pregunta al    │
│                                       │ dependiente "Disculpe, ¿dónde puede  │
│                                       │ encontrar 'Una Canción de Humo'?", a │
│                                       │ lo que el dependiente responde       │
│                                       │ "Bueno, usted puede encontrar la     │
│                                       │ novela en español por aquí, pero si  │
│                                       │ veo por dónde está mirando, lo único │
│                                       │ que hay en inglés es esta otra       │
│                                       │ novela llamada 'Smoke', pero la he   │
│                                       │ visto lo suficiente", "No se         │
│                                       │ preocupe, mi español es bueno",      │
│                                       │ "Ahhh                                │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Tómate un poquito de tiempo y        │
│                                       │ explicame tu posición                │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 12.247 | exact_match: 0.000 | rev_kl: 1.499 | lens: 82.407 | pt_loss: 1.792 | lm_loss: 1.930 | kd_loss: 1.654 
Total Steps: 1000 Data Epochs: 10
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:      2/  1000| tot_loss: 3.5227 | rl_loss: 1.2919 | pt_loss: 2.2307 | pg_loss: 0.0621 | reg_loss: 1.2299 | reward: -0.4211 | rev_kl: 1.6442 | stu_lens: 86.5000 | mixed_lens: 128.0000 | lr: 5.0000e-08 | scale: 2048.00 | time: 25.981 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:      3/  1000| tot_loss: 3.1947 | rl_loss: 1.5175 | pt_loss: 1.6772 | pg_loss: 0.1079 | reg_loss: 1.4096 | reward: -0.2279 | rev_kl: 1.4040 | stu_lens: 96.0000 | mixed_lens: 123.0000 | lr: 1.0000e-07 | scale: 2048.00 | time: 26.417 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:      4/  1000| tot_loss: 3.5261 | rl_loss: 1.5019 | pt_loss: 2.0243 | pg_loss: 0.0731 | reg_loss: 1.4287 | reward: -0.2203 | rev_kl: 1.2883 | stu_lens: 106.0000 | mixed_lens: 128.0000 | lr: 1.5000e-07 | scale: 2048.00 | time: 26.444 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:      5/  1000| tot_loss: 3.7963 | rl_loss: 1.9907 | pt_loss: 1.8056 | pg_loss: 0.6300 | reg_loss: 1.3607 | reward: -0.4291 | rev_kl: 1.3560 | stu_lens: 73.0000 | mixed_lens: 55.0000 | lr: 2.0000e-07 | scale: 2048.00 | time: 26.406 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:      6/  1000| tot_loss: 4.3134 | rl_loss: 1.9810 | pt_loss: 2.3323 | pg_loss: 0.4328 | reg_loss: 1.5482 | reward: -0.3573 | rev_kl: 1.7566 | stu_lens: 87.0000 | mixed_lens: 86.0000 | lr: 2.5000e-07 | scale: 2048.00 | time: 26.427 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:      7/  1000| tot_loss: 3.8088 | rl_loss: 1.6526 | pt_loss: 2.1561 | pg_loss: 0.2797 | reg_loss: 1.3730 | reward: -0.4789 | rev_kl: 1.7925 | stu_lens: 15.5000 | mixed_lens: 100.5000 | lr: 3.0000e-07 | scale: 2048.00 | time: 26.401 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:      8/  1000| tot_loss: 3.7225 | rl_loss: 1.9669 | pt_loss: 1.7556 | pg_loss: 0.5813 | reg_loss: 1.3856 | reward: -1.0663 | rev_kl: 1.7411 | stu_lens: 66.0000 | mixed_lens: 67.5000 | lr: 3.5000e-07 | scale: 2048.00 | time: 26.418 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:      9/  1000| tot_loss: 4.3035 | rl_loss: 2.6080 | pt_loss: 1.6955 | pg_loss: 0.9045 | reg_loss: 1.7035 | reward: -0.5947 | rev_kl: 1.4995 | stu_lens: 14.5000 | mixed_lens: 54.0000 | lr: 4.0000e-07 | scale: 2048.00 | time: 26.403 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:     10/  1000| tot_loss: 3.1710 | rl_loss: 1.2345 | pt_loss: 1.9365 | pg_loss: 0.0308 | reg_loss: 1.2038 | reward: -0.2570 | rev_kl: 1.4192 | stu_lens: 124.5000 | mixed_lens: 128.0000 | lr: 4.5000e-07 | scale: 2048.00 | time: 26.423 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:     11/  1000| tot_loss: 3.2061 | rl_loss: 1.4106 | pt_loss: 1.7955 | pg_loss: 0.0635 | reg_loss: 1.3471 | reward: -0.3766 | rev_kl: 1.4476 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 5.0000e-07 | scale: 2048.00 | time: 26.384 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:     12/  1000| tot_loss: 3.6418 | rl_loss: 1.4244 | pt_loss: 2.2174 | pg_loss: 0.2355 | reg_loss: 1.1889 | reward: -0.4744 | rev_kl: 1.2007 | stu_lens: 128.0000 | mixed_lens: 86.0000 | lr: 5.5000e-07 | scale: 2048.00 | time: 26.399 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:     13/  1000| tot_loss: 3.2540 | rl_loss: 1.4860 | pt_loss: 1.7680 | pg_loss: 0.0859 | reg_loss: 1.4002 | reward: -0.3050 | rev_kl: 2.1529 | stu_lens: 74.0000 | mixed_lens: 126.5000 | lr: 6.0000e-07 | scale: 2048.00 | time: 26.370 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:     14/  1000| tot_loss: 3.2131 | rl_loss: 1.7418 | pt_loss: 1.4713 | pg_loss: 0.3321 | reg_loss: 1.4096 | reward: -0.8546 | rev_kl: 1.3466 | stu_lens: 73.5000 | mixed_lens: 98.0000 | lr: 6.5000e-07 | scale: 2048.00 | time: 26.410 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:     15/  1000| tot_loss: 3.1873 | rl_loss: 1.5946 | pt_loss: 1.5927 | pg_loss: 0.1814 | reg_loss: 1.4132 | reward: -5.5688 | rev_kl: 1.4941 | stu_lens: 67.0000 | mixed_lens: 65.5000 | lr: 7.0000e-07 | scale: 2048.00 | time: 26.378 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     16/  1000| tot_loss: 3.8605 | rl_loss: 2.2944 | pt_loss: 1.5661 | pg_loss: 0.7336 | reg_loss: 1.5609 | reward: -1.0690 | rev_kl: 1.6612 | stu_lens: 67.5000 | mixed_lens: 52.5000 | lr: 7.5000e-07 | scale: 2048.00 | time: 26.397 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     16/  1000| tot_loss: 3.4161 | rl_loss: 1.7149 | pt_loss: 1.7012 | pg_loss: 0.3675 | reg_loss: 1.3474 | reward: -0.6923 | rev_kl: 1.3597 | stu_lens: 67.0156 | mixed_lens: 84.2656 | lr: 7.5000e-07 | scale: 2048.00 | time: 26.397 | step time: 26.060
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:     17/  1000| tot_loss: 3.5668 | rl_loss: 1.6097 | pt_loss: 1.9571 | pg_loss: 0.4676 | reg_loss: 1.1421 | reward: -0.0175 | rev_kl: 1.1414 | stu_lens: 128.0000 | mixed_lens: 75.5000 | lr: 8.0000e-07 | scale: 2048.00 | time: 26.374 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:     18/  1000| tot_loss: 3.2791 | rl_loss: 1.3590 | pt_loss: 1.9201 | pg_loss: 0.0680 | reg_loss: 1.2910 | reward: -0.2805 | rev_kl: 1.4388 | stu_lens: 78.5000 | mixed_lens: 128.0000 | lr: 8.5000e-07 | scale: 2048.00 | time: 26.395 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:     19/  1000| tot_loss: 4.2056 | rl_loss: 2.6548 | pt_loss: 1.5508 | pg_loss: 1.2439 | reg_loss: 1.4109 | reward: -1.7421 | rev_kl: 0.7197 | stu_lens: 44.5000 | mixed_lens: 23.5000 | lr: 9.0000e-07 | scale: 2048.00 | time: 26.386 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:     20/  1000| tot_loss: 3.7714 | rl_loss: 1.7299 | pt_loss: 2.0414 | pg_loss: 0.1842 | reg_loss: 1.5457 | reward: -0.4421 | rev_kl: 1.2572 | stu_lens: 70.0000 | mixed_lens: 102.5000 | lr: 9.5000e-07 | scale: 2048.00 | time: 26.421 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:     21/  1000| tot_loss: 3.1819 | rl_loss: 1.5826 | pt_loss: 1.5992 | pg_loss: 0.0708 | reg_loss: 1.5118 | reward: -0.3096 | rev_kl: 1.1363 | stu_lens: 71.5000 | mixed_lens: 126.5000 | lr: 1.0000e-06 | scale: 2048.00 | time: 26.373 | step time: 0.000
[2023-12-13 16:47:45,827] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, but hysteresis is 4. Reducing hysteresis to 3
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:     22/  1000| tot_loss: 3.1010 | rl_loss: 1.8326 | pt_loss: 1.2685 | pg_loss: 0.5237 | reg_loss: 1.3088 | reward: -0.9038 | rev_kl: 1.6376 | stu_lens: 67.5000 | mixed_lens: 62.5000 | lr: 1.0000e-06 | scale: 2048.00 | time: 2.870 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:     23/  1000| tot_loss: 2.9890 | rl_loss: 1.2738 | pt_loss: 1.7152 | pg_loss: 0.0104 | reg_loss: 1.2633 | reward: -0.4055 | rev_kl: 2.2716 | stu_lens: 74.0000 | mixed_lens: 128.0000 | lr: 1.0500e-06 | scale: 2048.00 | time: 26.392 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:     24/  1000| tot_loss: 4.3308 | rl_loss: 2.2749 | pt_loss: 2.0559 | pg_loss: 0.7785 | reg_loss: 1.4964 | reward: -0.7677 | rev_kl: 2.0213 | stu_lens: 72.0000 | mixed_lens: 43.5000 | lr: 1.1000e-06 | scale: 2048.00 | time: 26.366 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:     25/  1000| tot_loss: 3.0191 | rl_loss: 1.5367 | pt_loss: 1.4824 | pg_loss: 0.8530 | reg_loss: 0.6838 | reward: -0.6625 | rev_kl: 1.2077 | stu_lens: 73.0000 | mixed_lens: 19.5000 | lr: 1.1500e-06 | scale: 2048.00 | time: 26.394 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:     26/  1000| tot_loss: 3.4043 | rl_loss: 1.4381 | pt_loss: 1.9662 | pg_loss: -0.0012 | reg_loss: 1.4393 | reward: -0.2807 | rev_kl: 1.0816 | stu_lens: 47.5000 | mixed_lens: 128.0000 | lr: 1.2000e-06 | scale: 2048.00 | time: 26.376 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:     27/  1000| tot_loss: 3.6464 | rl_loss: 1.4416 | pt_loss: 2.2049 | pg_loss: 0.3224 | reg_loss: 1.1192 | reward: -0.2624 | rev_kl: 1.7044 | stu_lens: 73.0000 | mixed_lens: 75.5000 | lr: 1.2500e-06 | scale: 2048.00 | time: 26.404 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:     28/  1000| tot_loss: 2.9002 | rl_loss: 1.1372 | pt_loss: 1.7630 | pg_loss: 0.0544 | reg_loss: 1.0828 | reward: -0.3281 | rev_kl: 1.3613 | stu_lens: 81.0000 | mixed_lens: 128.0000 | lr: 1.3000e-06 | scale: 2048.00 | time: 26.372 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:     29/  1000| tot_loss: 3.5184 | rl_loss: 1.8837 | pt_loss: 1.6347 | pg_loss: 0.5170 | reg_loss: 1.3667 | reward: -0.6619 | rev_kl: 1.7423 | stu_lens: 14.0000 | mixed_lens: 71.0000 | lr: 1.3500e-06 | scale: 2048.00 | time: 26.427 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:     30/  1000| tot_loss: 3.5289 | rl_loss: 1.7396 | pt_loss: 1.7893 | pg_loss: 0.3503 | reg_loss: 1.3893 | reward: -0.4217 | rev_kl: 1.2101 | stu_lens: 40.0000 | mixed_lens: 88.0000 | lr: 1.4000e-06 | scale: 2048.00 | time: 26.365 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:     31/  1000| tot_loss: 2.8375 | rl_loss: 1.2984 | pt_loss: 1.5390 | pg_loss: 0.1823 | reg_loss: 1.1162 | reward: -0.7743 | rev_kl: 1.3662 | stu_lens: 81.0000 | mixed_lens: 104.0000 | lr: 1.4500e-06 | scale: 2048.00 | time: 26.372 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     32/  1000| tot_loss: 3.4446 | rl_loss: 1.7225 | pt_loss: 1.7222 | pg_loss: 0.5146 | reg_loss: 1.2078 | reward: -0.3758 | rev_kl: 1.2691 | stu_lens: 27.5000 | mixed_lens: 68.5000 | lr: 1.5000e-06 | scale: 2048.00 | time: 26.354 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     32/  1000| tot_loss: 3.3859 | rl_loss: 1.5907 | pt_loss: 1.7952 | pg_loss: 0.3440 | reg_loss: 1.2467 | reward: -0.7158 | rev_kl: 1.4278 | stu_lens: 75.5000 | mixed_lens: 88.4844 | lr: 1.5000e-06 | scale: 2048.00 | time: 26.354 | step time: 26.188
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:     33/  1000| tot_loss: 2.9693 | rl_loss: 1.3155 | pt_loss: 1.6538 | pg_loss: 0.5135 | reg_loss: 0.8020 | reward: -0.8478 | rev_kl: 1.3994 | stu_lens: 97.0000 | mixed_lens: 70.5000 | lr: 1.5500e-06 | scale: 2048.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:     34/  1000| tot_loss: 3.3711 | rl_loss: 1.8219 | pt_loss: 1.5492 | pg_loss: 0.8880 | reg_loss: 0.9340 | reward: -0.8369 | rev_kl: 1.5825 | stu_lens: 105.0000 | mixed_lens: 37.5000 | lr: 1.6000e-06 | scale: 2048.00 | time: 26.350 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:     35/  1000| tot_loss: 3.4297 | rl_loss: 1.6615 | pt_loss: 1.7682 | pg_loss: 0.6035 | reg_loss: 1.0580 | reward: -0.7469 | rev_kl: 1.4781 | stu_lens: 71.5000 | mixed_lens: 68.5000 | lr: 1.6500e-06 | scale: 2048.00 | time: 26.396 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:     36/  1000| tot_loss: 2.4180 | rl_loss: 0.8791 | pt_loss: 1.5388 | pg_loss: 0.0472 | reg_loss: 0.8320 | reward: -0.1960 | rev_kl: 1.0639 | stu_lens: 128.0000 | mixed_lens: 123.0000 | lr: 1.7000e-06 | scale: 2048.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:     37/  1000| tot_loss: 3.7433 | rl_loss: 1.7981 | pt_loss: 1.9452 | pg_loss: 0.5108 | reg_loss: 1.2873 | reward: -0.5915 | rev_kl: 1.3268 | stu_lens: 70.0000 | mixed_lens: 63.0000 | lr: 1.7500e-06 | scale: 2048.00 | time: 26.362 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:     38/  1000| tot_loss: 3.1020 | rl_loss: 1.3051 | pt_loss: 1.7969 | pg_loss: 0.4731 | reg_loss: 0.8320 | reward: -0.9397 | rev_kl: 1.1837 | stu_lens: 97.0000 | mixed_lens: 70.5000 | lr: 1.8000e-06 | scale: 2048.00 | time: 26.328 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:     39/  1000| tot_loss: 3.4767 | rl_loss: 1.6133 | pt_loss: 1.8634 | pg_loss: 0.5747 | reg_loss: 1.0387 | reward: -1.1450 | rev_kl: 1.8884 | stu_lens: 9.0000 | mixed_lens: 59.0000 | lr: 1.8500e-06 | scale: 2048.00 | time: 26.359 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:     40/  1000| tot_loss: 3.2915 | rl_loss: 1.0864 | pt_loss: 2.2051 | pg_loss: 0.1298 | reg_loss: 0.9566 | reward: -0.5723 | rev_kl: 1.3633 | stu_lens: 60.0000 | mixed_lens: 104.0000 | lr: 1.9000e-06 | scale: 2048.00 | time: 26.327 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:     41/  1000| tot_loss: 3.5240 | rl_loss: 1.6968 | pt_loss: 1.8272 | pg_loss: 0.6302 | reg_loss: 1.0665 | reward: -0.4545 | rev_kl: 1.0012 | stu_lens: 68.5000 | mixed_lens: 68.5000 | lr: 1.9500e-06 | scale: 2048.00 | time: 26.354 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:     42/  1000| tot_loss: 2.6305 | rl_loss: 1.0223 | pt_loss: 1.6083 | pg_loss: 0.2001 | reg_loss: 0.8221 | reward: -0.3575 | rev_kl: 1.1253 | stu_lens: 68.5000 | mixed_lens: 85.5000 | lr: 2.0000e-06 | scale: 2048.00 | time: 26.364 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:     43/  1000| tot_loss: 2.7443 | rl_loss: 0.8466 | pt_loss: 1.8977 | pg_loss: 0.0134 | reg_loss: 0.8331 | reward: -0.2992 | rev_kl: 1.1411 | stu_lens: 49.5000 | mixed_lens: 128.0000 | lr: 2.0500e-06 | scale: 2048.00 | time: 26.375 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:     44/  1000| tot_loss: 2.2885 | rl_loss: 0.8288 | pt_loss: 1.4598 | pg_loss: 0.2504 | reg_loss: 0.5784 | reward: -0.5894 | rev_kl: 1.6054 | stu_lens: 112.5000 | mixed_lens: 102.0000 | lr: 2.1000e-06 | scale: 2048.00 | time: 26.344 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:     45/  1000| tot_loss: 3.0452 | rl_loss: 1.6270 | pt_loss: 1.4183 | pg_loss: 0.4231 | reg_loss: 1.2039 | reward: -0.4778 | rev_kl: 1.9410 | stu_lens: 43.5000 | mixed_lens: 75.5000 | lr: 2.1500e-06 | scale: 2048.00 | time: 26.349 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:     46/  1000| tot_loss: 3.5812 | rl_loss: 1.4301 | pt_loss: 2.1512 | pg_loss: 0.4666 | reg_loss: 0.9635 | reward: -1.1348 | rev_kl: 1.6001 | stu_lens: 66.0000 | mixed_lens: 67.5000 | lr: 2.2000e-06 | scale: 2048.00 | time: 26.323 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:     47/  1000| tot_loss: 3.0919 | rl_loss: 1.0498 | pt_loss: 2.0421 | pg_loss: 0.2179 | reg_loss: 0.8319 | reward: -0.4579 | rev_kl: 2.1882 | stu_lens: 72.0000 | mixed_lens: 85.5000 | lr: 2.2500e-06 | scale: 2048.00 | time: 26.362 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:     48/  1000| tot_loss: 3.1992 | rl_loss: 1.1487 | pt_loss: 2.0505 | pg_loss: 0.4927 | reg_loss: 0.6560 | reward: -0.6449 | rev_kl: 1.6807 | stu_lens: 72.5000 | mixed_lens: 79.5000 | lr: 2.3000e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:     48/  1000| tot_loss: 3.0025 | rl_loss: 1.2066 | pt_loss: 1.7958 | pg_loss: 0.3136 | reg_loss: 0.8931 | reward: -0.7270 | rev_kl: 1.4371 | stu_lens: 71.0312 | mixed_lens: 88.0312 | lr: 2.3000e-06 | scale: 2048.00 | time: 26.342 | step time: 27.625
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:     49/  1000| tot_loss: 2.6506 | rl_loss: 0.8169 | pt_loss: 1.8336 | pg_loss: 0.0597 | reg_loss: 0.7573 | reward: -0.2419 | rev_kl: 1.1263 | stu_lens: 75.0000 | mixed_lens: 121.5000 | lr: 2.3500e-06 | scale: 2048.00 | time: 26.352 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:     50/  1000| tot_loss: 2.4108 | rl_loss: 0.7139 | pt_loss: 1.6968 | pg_loss: 0.1188 | reg_loss: 0.5951 | reward: -0.4664 | rev_kl: 1.3766 | stu_lens: 128.0000 | mixed_lens: 113.0000 | lr: 2.4000e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:     51/  1000| tot_loss: 2.6226 | rl_loss: 0.6971 | pt_loss: 1.9255 | pg_loss: 0.0062 | reg_loss: 0.6909 | reward: -0.2598 | rev_kl: 1.3563 | stu_lens: 128.0000 | mixed_lens: 126.5000 | lr: 2.4500e-06 | scale: 2048.00 | time: 26.350 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:     52/  1000| tot_loss: 2.5488 | rl_loss: 0.9626 | pt_loss: 1.5862 | pg_loss: 0.5600 | reg_loss: 0.4027 | reward: -1.1137 | rev_kl: 1.9735 | stu_lens: 5.5000 | mixed_lens: 61.0000 | lr: 2.5000e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:     53/  1000| tot_loss: 2.1875 | rl_loss: 0.6488 | pt_loss: 1.5386 | pg_loss: 0.6038 | reg_loss: 0.0450 | reward: -0.1211 | rev_kl: 0.7913 | stu_lens: 68.5000 | mixed_lens: 16.0000 | lr: 2.5500e-06 | scale: 2048.00 | time: 26.348 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:     54/  1000| tot_loss: 2.6609 | rl_loss: 0.8962 | pt_loss: 1.7648 | pg_loss: 0.2917 | reg_loss: 0.6045 | reward: -0.3630 | rev_kl: 1.2299 | stu_lens: 36.5000 | mixed_lens: 85.5000 | lr: 2.6000e-06 | scale: 2048.00 | time: 26.336 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:     55/  1000| tot_loss: 3.7541 | rl_loss: 2.1824 | pt_loss: 1.5717 | pg_loss: 1.3685 | reg_loss: 0.8140 | reward: -5.6946 | rev_kl: 2.3168 | stu_lens: 11.0000 | mixed_lens: 23.0000 | lr: 2.6500e-06 | scale: 2048.00 | time: 26.343 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:     56/  1000| tot_loss: 2.5405 | rl_loss: 0.6858 | pt_loss: 1.8547 | pg_loss: -0.0055 | reg_loss: 0.6914 | reward: -0.4530 | rev_kl: 1.3958 | stu_lens: 78.5000 | mixed_lens: 128.0000 | lr: 2.7000e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:     57/  1000| tot_loss: 2.0156 | rl_loss: 0.6484 | pt_loss: 1.3672 | pg_loss: 0.0746 | reg_loss: 0.5738 | reward: -0.3126 | rev_kl: 1.1982 | stu_lens: 128.0000 | mixed_lens: 107.5000 | lr: 2.7500e-06 | scale: 2048.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:     58/  1000| tot_loss: 2.4343 | rl_loss: 0.8145 | pt_loss: 1.6197 | pg_loss: 0.2766 | reg_loss: 0.5379 | reward: -0.7647 | rev_kl: 2.3825 | stu_lens: 51.0000 | mixed_lens: 79.5000 | lr: 2.8000e-06 | scale: 2048.00 | time: 26.315 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:     59/  1000| tot_loss: 2.4531 | rl_loss: 0.5010 | pt_loss: 1.9521 | pg_loss: 0.0411 | reg_loss: 0.4599 | reward: -0.1960 | rev_kl: 1.0639 | stu_lens: 128.0000 | mixed_lens: 123.0000 | lr: 2.8500e-06 | scale: 2048.00 | time: 26.338 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:     60/  1000| tot_loss: 2.1548 | rl_loss: 0.5023 | pt_loss: 1.6525 | pg_loss: 0.0054 | reg_loss: 0.4969 | reward: -0.2276 | rev_kl: 1.4421 | stu_lens: 124.5000 | mixed_lens: 128.0000 | lr: 2.9000e-06 | scale: 2048.00 | time: 26.314 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:     61/  1000| tot_loss: 2.3551 | rl_loss: 0.9404 | pt_loss: 1.4147 | pg_loss: 0.4076 | reg_loss: 0.5328 | reward: -0.3240 | rev_kl: 0.8803 | stu_lens: 72.0000 | mixed_lens: 89.5000 | lr: 2.9500e-06 | scale: 2048.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:     62/  1000| tot_loss: 3.2492 | rl_loss: 1.3247 | pt_loss: 1.9245 | pg_loss: 0.4900 | reg_loss: 0.8347 | reward: -0.7232 | rev_kl: 1.1277 | stu_lens: 34.0000 | mixed_lens: 78.5000 | lr: 3.0000e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:     63/  1000| tot_loss: 3.1501 | rl_loss: 1.3062 | pt_loss: 1.8439 | pg_loss: 0.4734 | reg_loss: 0.8328 | reward: -0.4880 | rev_kl: 1.4106 | stu_lens: 16.0000 | mixed_lens: 79.5000 | lr: 3.0500e-06 | scale: 2048.00 | time: 26.345 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:     64/  1000| tot_loss: 2.6759 | rl_loss: 0.8409 | pt_loss: 1.8350 | pg_loss: 0.1544 | reg_loss: 0.6865 | reward: -0.4057 | rev_kl: 1.4283 | stu_lens: 87.0000 | mixed_lens: 100.0000 | lr: 3.1000e-06 | scale: 2048.00 | time: 26.313 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:     64/  1000| tot_loss: 2.6936 | rl_loss: 0.9324 | pt_loss: 1.7612 | pg_loss: 0.3265 | reg_loss: 0.6059 | reward: -0.7091 | rev_kl: 1.3994 | stu_lens: 73.7656 | mixed_lens: 89.7812 | lr: 3.1000e-06 | scale: 2048.00 | time: 26.313 | step time: 27.606
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:     65/  1000| tot_loss: 2.7153 | rl_loss: 0.9068 | pt_loss: 1.8085 | pg_loss: 0.3449 | reg_loss: 0.5620 | reward: -0.6563 | rev_kl: 1.6096 | stu_lens: 118.5000 | mixed_lens: 80.5000 | lr: 3.1500e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:     66/  1000| tot_loss: 4.0212 | rl_loss: 1.7428 | pt_loss: 2.2783 | pg_loss: 0.5168 | reg_loss: 1.2260 | reward: -0.5933 | rev_kl: 0.9357 | stu_lens: 46.0000 | mixed_lens: 80.0000 | lr: 3.2000e-06 | scale: 2048.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:     67/  1000| tot_loss: 3.6386 | rl_loss: 1.8035 | pt_loss: 1.8351 | pg_loss: 0.5337 | reg_loss: 1.2698 | reward: -0.6483 | rev_kl: 1.3225 | stu_lens: 22.0000 | mixed_lens: 70.5000 | lr: 3.2500e-06 | scale: 2048.00 | time: 26.368 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:     68/  1000| tot_loss: 2.8493 | rl_loss: 1.2820 | pt_loss: 1.5673 | pg_loss: 0.5381 | reg_loss: 0.7439 | reward: -0.9928 | rev_kl: 0.7428 | stu_lens: 114.5000 | mixed_lens: 58.0000 | lr: 3.3000e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:     69/  1000| tot_loss: 3.1948 | rl_loss: 1.5194 | pt_loss: 1.6754 | pg_loss: 0.4663 | reg_loss: 1.0531 | reward: -0.3127 | rev_kl: 1.1705 | stu_lens: 39.5000 | mixed_lens: 71.0000 | lr: 3.3500e-06 | scale: 2048.00 | time: 26.383 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:     70/  1000| tot_loss: 3.1275 | rl_loss: 1.0275 | pt_loss: 2.1000 | pg_loss: 0.3400 | reg_loss: 0.6875 | reward: -0.8221 | rev_kl: 0.8638 | stu_lens: 31.5000 | mixed_lens: 72.0000 | lr: 3.4000e-06 | scale: 2048.00 | time: 26.336 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:     71/  1000| tot_loss: 2.7763 | rl_loss: 0.9971 | pt_loss: 1.7792 | pg_loss: 0.1956 | reg_loss: 0.8015 | reward: -0.4707 | rev_kl: 0.9438 | stu_lens: 88.0000 | mixed_lens: 76.5000 | lr: 3.4500e-06 | scale: 2048.00 | time: 26.362 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:     72/  1000| tot_loss: 2.5490 | rl_loss: 1.1262 | pt_loss: 1.4228 | pg_loss: 0.0838 | reg_loss: 1.0423 | reward: -0.2588 | rev_kl: 1.1716 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5000e-06 | scale: 2048.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:     73/  1000| tot_loss: 2.8038 | rl_loss: 1.1458 | pt_loss: 1.6580 | pg_loss: 0.3968 | reg_loss: 0.7490 | reward: -0.2573 | rev_kl: 0.6923 | stu_lens: 41.5000 | mixed_lens: 74.5000 | lr: 3.5500e-06 | scale: 2048.00 | time: 26.381 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:     74/  1000| tot_loss: 3.0876 | rl_loss: 1.3595 | pt_loss: 1.7281 | pg_loss: 0.3971 | reg_loss: 0.9625 | reward: -0.6996 | rev_kl: 1.0000 | stu_lens: 69.0000 | mixed_lens: 71.5000 | lr: 3.6000e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:     75/  1000| tot_loss: 3.1077 | rl_loss: 1.4538 | pt_loss: 1.6540 | pg_loss: 0.3673 | reg_loss: 1.0864 | reward: -5.1937 | rev_kl: 1.5669 | stu_lens: 38.0000 | mixed_lens: 65.0000 | lr: 3.6500e-06 | scale: 2048.00 | time: 26.352 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:     76/  1000| tot_loss: 3.4117 | rl_loss: 1.4459 | pt_loss: 1.9658 | pg_loss: 0.4310 | reg_loss: 1.0149 | reward: -0.2094 | rev_kl: 0.8747 | stu_lens: 74.0000 | mixed_lens: 73.5000 | lr: 3.7000e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:     77/  1000| tot_loss: 2.8180 | rl_loss: 1.1558 | pt_loss: 1.6622 | pg_loss: 0.1796 | reg_loss: 0.9762 | reward: -1.6795 | rev_kl: 0.6401 | stu_lens: 12.5000 | mixed_lens: 57.0000 | lr: 3.7500e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:     78/  1000| tot_loss: 3.6943 | rl_loss: 1.8152 | pt_loss: 1.8791 | pg_loss: 0.5729 | reg_loss: 1.2423 | reward: -0.4003 | rev_kl: 2.2275 | stu_lens: 76.0000 | mixed_lens: 55.5000 | lr: 3.8000e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:     79/  1000| tot_loss: 2.1804 | rl_loss: 0.7609 | pt_loss: 1.4195 | pg_loss: 0.0178 | reg_loss: 0.7432 | reward: -0.1125 | rev_kl: 0.7923 | stu_lens: 98.0000 | mixed_lens: 128.0000 | lr: 3.8500e-06 | scale: 2048.00 | time: 26.364 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     80/  1000| tot_loss: 2.4964 | rl_loss: 0.8206 | pt_loss: 1.6757 | pg_loss: 0.0604 | reg_loss: 0.7603 | reward: -0.0490 | rev_kl: 0.8721 | stu_lens: 97.0000 | mixed_lens: 128.0000 | lr: 3.9000e-06 | scale: 2048.00 | time: 26.345 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     80/  1000| tot_loss: 3.1536 | rl_loss: 1.3235 | pt_loss: 1.8300 | pg_loss: 0.3295 | reg_loss: 0.9941 | reward: -1.0408 | rev_kl: 1.0629 | stu_lens: 80.7031 | mixed_lens: 85.4219 | lr: 3.9000e-06 | scale: 2048.00 | time: 26.345 | step time: 27.620
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:     81/  1000| tot_loss: 3.1954 | rl_loss: 1.2304 | pt_loss: 1.9650 | pg_loss: 0.2761 | reg_loss: 0.9543 | reward: -0.5999 | rev_kl: 0.6376 | stu_lens: 79.0000 | mixed_lens: 94.0000 | lr: 3.9500e-06 | scale: 2048.00 | time: 26.372 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:     82/  1000| tot_loss: 3.4324 | rl_loss: 1.3752 | pt_loss: 2.0572 | pg_loss: 0.7475 | reg_loss: 0.6277 | reward: -5.3828 | rev_kl: 2.6601 | stu_lens: 21.5000 | mixed_lens: 11.0000 | lr: 4.0000e-06 | scale: 2048.00 | time: 26.341 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:     83/  1000| tot_loss: 2.7966 | rl_loss: 0.9889 | pt_loss: 1.8077 | pg_loss: 0.2912 | reg_loss: 0.6977 | reward: -0.4648 | rev_kl: 0.8262 | stu_lens: 88.5000 | mixed_lens: 64.5000 | lr: 4.0500e-06 | scale: 2048.00 | time: 26.358 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:     84/  1000| tot_loss: 2.4393 | rl_loss: 0.6471 | pt_loss: 1.7921 | pg_loss: -0.0080 | reg_loss: 0.6551 | reward: -0.2881 | rev_kl: 0.9367 | stu_lens: 104.5000 | mixed_lens: 128.0000 | lr: 4.1000e-06 | scale: 2048.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:     85/  1000| tot_loss: 2.2885 | rl_loss: 0.7661 | pt_loss: 1.5224 | pg_loss: 0.2737 | reg_loss: 0.4924 | reward: -0.2056 | rev_kl: 0.7275 | stu_lens: 73.5000 | mixed_lens: 73.5000 | lr: 4.1500e-06 | scale: 2048.00 | time: 26.357 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:     86/  1000| tot_loss: 2.7349 | rl_loss: 0.9919 | pt_loss: 1.7430 | pg_loss: 0.4262 | reg_loss: 0.5658 | reward: -0.4481 | rev_kl: 0.6965 | stu_lens: 21.0000 | mixed_lens: 63.5000 | lr: 4.2000e-06 | scale: 2048.00 | time: 26.326 | step time: 0.000
[2023-12-13 17:22:52,000] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, but hysteresis is 3. Reducing hysteresis to 2
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:     87/  1000| tot_loss: 2.7372 | rl_loss: 1.0765 | pt_loss: 1.6607 | pg_loss: 0.7693 | reg_loss: 0.3072 | reward: -9.7136 | rev_kl: 0.6032 | stu_lens: 30.5000 | mixed_lens: 12.0000 | lr: 4.2000e-06 | scale: 2048.00 | time: 2.863 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:     88/  1000| tot_loss: 2.6406 | rl_loss: 0.8887 | pt_loss: 1.7519 | pg_loss: 0.1047 | reg_loss: 0.7840 | reward: -0.2167 | rev_kl: 1.1533 | stu_lens: 82.0000 | mixed_lens: 105.5000 | lr: 4.2500e-06 | scale: 2048.00 | time: 26.345 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:     89/  1000| tot_loss: 1.9938 | rl_loss: 0.8030 | pt_loss: 1.1907 | pg_loss: 0.3161 | reg_loss: 0.4869 | reward: -0.2573 | rev_kl: 0.6923 | stu_lens: 41.5000 | mixed_lens: 74.5000 | lr: 4.3000e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:     90/  1000| tot_loss: 2.6649 | rl_loss: 1.0840 | pt_loss: 1.5809 | pg_loss: 0.3836 | reg_loss: 0.7004 | reward: -1.2211 | rev_kl: 2.0575 | stu_lens: 76.0000 | mixed_lens: 69.5000 | lr: 4.3500e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:     91/  1000| tot_loss: 2.2147 | rl_loss: 0.4283 | pt_loss: 1.7864 | pg_loss: -0.0165 | reg_loss: 0.4448 | reward: -0.2674 | rev_kl: 0.8751 | stu_lens: 91.0000 | mixed_lens: 128.0000 | lr: 4.4000e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:     92/  1000| tot_loss: 2.6594 | rl_loss: 0.9907 | pt_loss: 1.6687 | pg_loss: 0.1392 | reg_loss: 0.8514 | reward: -0.7084 | rev_kl: 1.1886 | stu_lens: 83.5000 | mixed_lens: 102.5000 | lr: 4.4500e-06 | scale: 2048.00 | time: 26.360 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:     93/  1000| tot_loss: 2.8228 | rl_loss: 1.0532 | pt_loss: 1.7696 | pg_loss: 0.4118 | reg_loss: 0.6414 | reward: -0.9086 | rev_kl: 1.0125 | stu_lens: 41.5000 | mixed_lens: 69.0000 | lr: 4.5000e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:     94/  1000| tot_loss: 3.0831 | rl_loss: 1.1621 | pt_loss: 1.9210 | pg_loss: 0.3973 | reg_loss: 0.7647 | reward: -0.5389 | rev_kl: 1.1639 | stu_lens: 71.0000 | mixed_lens: 80.0000 | lr: 4.5500e-06 | scale: 2048.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:     95/  1000| tot_loss: 2.2825 | rl_loss: 0.4926 | pt_loss: 1.7899 | pg_loss: 0.0001 | reg_loss: 0.4926 | reward: -0.1255 | rev_kl: 1.0559 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6000e-06 | scale: 2048.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     96/  1000| tot_loss: 2.8195 | rl_loss: 1.1166 | pt_loss: 1.7029 | pg_loss: 0.4884 | reg_loss: 0.6281 | reward: -0.3607 | rev_kl: 0.8572 | stu_lens: 79.0000 | mixed_lens: 63.0000 | lr: 4.6500e-06 | scale: 2048.00 | time: 26.346 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     96/  1000| tot_loss: 2.7099 | rl_loss: 0.9900 | pt_loss: 1.7199 | pg_loss: 0.3000 | reg_loss: 0.6901 | reward: -1.0307 | rev_kl: 1.0246 | stu_lens: 79.2969 | mixed_lens: 87.1094 | lr: 4.6500e-06 | scale: 2048.00 | time: 26.346 | step time: 26.137
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:     97/  1000| tot_loss: 2.3596 | rl_loss: 0.7400 | pt_loss: 1.6197 | pg_loss: 0.1493 | reg_loss: 0.5907 | reward: -0.3821 | rev_kl: 0.7306 | stu_lens: 67.0000 | mixed_lens: 104.0000 | lr: 4.7000e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:     98/  1000| tot_loss: 2.7863 | rl_loss: 0.9375 | pt_loss: 1.8488 | pg_loss: 0.4238 | reg_loss: 0.5138 | reward: -0.5037 | rev_kl: 0.8336 | stu_lens: 85.0000 | mixed_lens: 80.0000 | lr: 4.7500e-06 | scale: 2048.00 | time: 26.350 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:     99/  1000| tot_loss: 2.7625 | rl_loss: 0.6920 | pt_loss: 2.0705 | pg_loss: 0.2801 | reg_loss: 0.4119 | reward: -0.4293 | rev_kl: 0.9522 | stu_lens: 128.0000 | mixed_lens: 81.5000 | lr: 4.8000e-06 | scale: 2048.00 | time: 26.329 | step time: 0.000
                                 Evaluation #1                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ dime un chiste acerca de la situacion │ dime un chiste acerca de la          │
│ actual de la economia, de modo que    │ situacion actual de la economia, de  │
│ los niños comprendan el mal estado de │ modo que los niños comprendan el mal │
│ la misma.                             │ estado de la misma.                  │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ La economia actual está en una       │
│                                       │ situación bastante delicada. Existe  │
│                                       │ una gran cantidad de gastos que      │
│                                       │ deben pagarse, pero no existe la     │
│                                       │ necesidad de hacerlo, debido a la    │
│                                       │ pandemia de la COVID-19. Esto se ve  │
│                                       │ agravado por la cancelación del PIB, │
│                                       │ debido a la disminución de la        │
│                                       │ actividad económica, que se ve       │
│                                       │ afectada por la pandemia.            │
│                                       │                                      │
│                                       │ Para solucionar este problema, es    │
│                                       │ necesario incrementar la actividad   │
│                                       │ económica, de modo que puedan ser    │
│                                       │ gastados                             │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ De nada. Este chiste es muy simple.  │
│                                       │ Es una situación en la que un padre  │
│                                       │ le diría a su hijo que había         │
│                                       │ olvidado el carro de la tienda y     │
│                                       │ tenía que tomar el Metro, y el hijo  │
│                                       │ le respondiera que el Metro no       │
│                                       │ existía. El padre entonces le diría  │
│                                       │ que debía tomar un taxi, y el hijo   │
│                                       │ le respondiera que debía tomar un    │
│                                       │ coche. El padre entonces le diría    │
│                                       │ que debía pedir ayuda a un vecino, y │
│                                       │ el hijo le respondiera que el vecino │
│                                       │ no existía. El padre entonces le     │
│                                       │ diría que deb                        │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Sí, este chiste se hace porque hay   │
│                                       │ dos personas que se conocen muy de   │
│                                       │ cerca. Ambas sienten un gran respeto │
│                                       │ mutuo, ya que han logrado            │
│                                       │ desarrollar una amistad que dura     │
│                                       │ muchos años. Ambos han alcanzado un  │
│                                       │ punto en su relación en que ya no    │
│                                       │ necesitan ninguna otra persona para  │
│                                       │ completarlos, ya que saben que cada  │
│                                       │ uno de ellos es completosolo. Esta   │
│                                       │ amistad es por tanto la base de este │
│                                       │ chiste, ya que describe la amistad   │
│                                       │ que tienen ambas personas.           │
│                                       │                                      │
│                                       │ Desde el punto de vista de quien     │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.544 | exact_match: 0.000 | rev_kl: 0.884 | lens: 97.971 | pt_loss: 1.764 | lm_loss: 1.911 | kd_loss: 1.617 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    100/  1000| tot_loss: 2.5614 | rl_loss: 0.6466 | pt_loss: 1.9148 | pg_loss: 0.1628 | reg_loss: 0.4839 | reward: -0.2272 | rev_kl: 0.7806 | stu_lens: 114.0000 | mixed_lens: 107.0000 | lr: 4.8500e-06 | scale: 2048.00 | time: 26.349 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    101/  1000| tot_loss: 1.7496 | rl_loss: 0.5609 | pt_loss: 1.1887 | pg_loss: 0.0778 | reg_loss: 0.4831 | reward: -0.0623 | rev_kl: 0.8886 | stu_lens: 46.5000 | mixed_lens: 118.5000 | lr: 4.9000e-06 | scale: 2048.00 | time: 26.344 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    102/  1000| tot_loss: 2.4081 | rl_loss: 0.5164 | pt_loss: 1.8917 | pg_loss: 0.1657 | reg_loss: 0.3507 | reward: -1.7427 | rev_kl: 0.7858 | stu_lens: 70.5000 | mixed_lens: 66.5000 | lr: 4.9500e-06 | scale: 2048.00 | time: 26.362 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    103/  1000| tot_loss: 2.1322 | rl_loss: 0.8370 | pt_loss: 1.2952 | pg_loss: 0.3931 | reg_loss: 0.4439 | reward: -0.3127 | rev_kl: 1.1705 | stu_lens: 39.5000 | mixed_lens: 71.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.320 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    104/  1000| tot_loss: 3.9628 | rl_loss: 2.1263 | pt_loss: 1.8365 | pg_loss: 1.7169 | reg_loss: 0.4094 | reward: -0.6625 | rev_kl: 0.6761 | stu_lens: 13.0000 | mixed_lens: 25.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.362 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    105/  1000| tot_loss: 3.1907 | rl_loss: 1.0968 | pt_loss: 2.0939 | pg_loss: 0.5027 | reg_loss: 0.5941 | reward: -0.5741 | rev_kl: 0.7814 | stu_lens: 72.5000 | mixed_lens: 75.5000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    106/  1000| tot_loss: 3.1398 | rl_loss: 1.2535 | pt_loss: 1.8863 | pg_loss: 0.6796 | reg_loss: 0.5739 | reward: -0.4113 | rev_kl: 2.3453 | stu_lens: 54.0000 | mixed_lens: 74.0000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.344 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    107/  1000| tot_loss: 2.2141 | rl_loss: 0.4102 | pt_loss: 1.8039 | pg_loss: 0.0833 | reg_loss: 0.3269 | reward: -0.1039 | rev_kl: 0.8747 | stu_lens: 127.5000 | mixed_lens: 112.5000 | lr: 4.9998e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    108/  1000| tot_loss: 2.6786 | rl_loss: 0.7478 | pt_loss: 1.9309 | pg_loss: 0.3950 | reg_loss: 0.3528 | reward: -0.1964 | rev_kl: 0.5168 | stu_lens: 54.5000 | mixed_lens: 75.0000 | lr: 4.9996e-06 | scale: 2048.00 | time: 26.355 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    109/  1000| tot_loss: 2.5515 | rl_loss: 0.7678 | pt_loss: 1.7837 | pg_loss: 0.4012 | reg_loss: 0.3666 | reward: -0.4657 | rev_kl: 0.9425 | stu_lens: 70.5000 | mixed_lens: 77.0000 | lr: 4.9995e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    110/  1000| tot_loss: 2.8364 | rl_loss: 1.1149 | pt_loss: 1.7214 | pg_loss: 0.3838 | reg_loss: 0.7311 | reward: -0.2973 | rev_kl: 1.1429 | stu_lens: 17.0000 | mixed_lens: 71.0000 | lr: 4.9993e-06 | scale: 2048.00 | time: 26.353 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    111/  1000| tot_loss: 3.0500 | rl_loss: 1.4026 | pt_loss: 1.6474 | pg_loss: 0.9371 | reg_loss: 0.4655 | reward: -1.3949 | rev_kl: 0.9491 | stu_lens: 54.5000 | mixed_lens: 43.5000 | lr: 4.9990e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    112/  1000| tot_loss: 2.1325 | rl_loss: 0.5493 | pt_loss: 1.5832 | pg_loss: 0.0259 | reg_loss: 0.5233 | reward: -0.3041 | rev_kl: 0.7952 | stu_lens: 86.5000 | mixed_lens: 128.0000 | lr: 4.9988e-06 | scale: 2048.00 | time: 26.363 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    112/  1000| tot_loss: 2.5746 | rl_loss: 0.8055 | pt_loss: 1.7692 | pg_loss: 0.3199 | reg_loss: 0.4855 | reward: -1.0053 | rev_kl: 1.0097 | stu_lens: 79.6250 | mixed_lens: 88.2031 | lr: 4.9988e-06 | scale: 2048.00 | time: 26.363 | step time: 27.612
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    113/  1000| tot_loss: 2.2885 | rl_loss: 0.7014 | pt_loss: 1.5871 | pg_loss: 0.0312 | reg_loss: 0.6701 | reward: -0.2592 | rev_kl: 1.3259 | stu_lens: 114.0000 | mixed_lens: 128.0000 | lr: 4.9985e-06 | scale: 2048.00 | time: 26.314 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    114/  1000| tot_loss: 2.1576 | rl_loss: 0.6064 | pt_loss: 1.5512 | pg_loss: 0.3484 | reg_loss: 0.2581 | reward: -0.9160 | rev_kl: 0.8808 | stu_lens: 39.5000 | mixed_lens: 69.0000 | lr: 4.9982e-06 | scale: 2048.00 | time: 26.338 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    115/  1000| tot_loss: 1.7433 | rl_loss: 0.3333 | pt_loss: 1.4100 | pg_loss: 0.0024 | reg_loss: 0.3309 | reward: -0.3061 | rev_kl: 1.0144 | stu_lens: 97.5000 | mixed_lens: 121.0000 | lr: 4.9978e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    116/  1000| tot_loss: 2.4574 | rl_loss: 0.4290 | pt_loss: 2.0284 | pg_loss: -0.0012 | reg_loss: 0.4302 | reward: -0.2011 | rev_kl: 1.0777 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9974e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    117/  1000| tot_loss: 2.7637 | rl_loss: 0.8688 | pt_loss: 1.8949 | pg_loss: 0.5128 | reg_loss: 0.3560 | reward: -0.3230 | rev_kl: 0.9254 | stu_lens: 79.0000 | mixed_lens: 63.0000 | lr: 4.9970e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    118/  1000| tot_loss: 2.0120 | rl_loss: 0.4296 | pt_loss: 1.5825 | pg_loss: 0.0645 | reg_loss: 0.3651 | reward: -0.0623 | rev_kl: 0.9102 | stu_lens: 70.0000 | mixed_lens: 118.5000 | lr: 4.9966e-06 | scale: 2048.00 | time: 26.349 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    119/  1000| tot_loss: 1.7368 | rl_loss: 0.3184 | pt_loss: 1.4183 | pg_loss: -0.0404 | reg_loss: 0.3588 | reward: -0.0471 | rev_kl: 0.8608 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9961e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    120/  1000| tot_loss: 2.4053 | rl_loss: 0.5179 | pt_loss: 1.8874 | pg_loss: 0.1332 | reg_loss: 0.3846 | reward: -0.1457 | rev_kl: 0.7576 | stu_lens: 91.0000 | mixed_lens: 128.0000 | lr: 4.9956e-06 | scale: 2048.00 | time: 26.347 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    121/  1000| tot_loss: 1.9657 | rl_loss: 0.4335 | pt_loss: 1.5322 | pg_loss: -0.0026 | reg_loss: 0.4361 | reward: -0.2169 | rev_kl: 1.2069 | stu_lens: 113.5000 | mixed_lens: 128.0000 | lr: 4.9951e-06 | scale: 2048.00 | time: 26.314 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    122/  1000| tot_loss: 2.6716 | rl_loss: 0.8520 | pt_loss: 1.8196 | pg_loss: 0.4168 | reg_loss: 0.4352 | reward: -1.2675 | rev_kl: 1.9444 | stu_lens: 52.5000 | mixed_lens: 69.5000 | lr: 4.9945e-06 | scale: 2048.00 | time: 26.348 | step time: 0.000
[2023-12-13 18:05:17,832] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, but hysteresis is 2. Reducing hysteresis to 1
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    123/  1000| tot_loss: 3.8947 | rl_loss: 0.4318 | pt_loss: 3.4629 | pg_loss: 0.0060 | reg_loss: 0.4258 | reward: -0.2284 | rev_kl: 0.8416 | stu_lens: 65.5000 | mixed_lens: 128.0000 | lr: 4.9945e-06 | scale: 2048.00 | time: 2.856 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    124/  1000| tot_loss: 3.3555 | rl_loss: 1.1765 | pt_loss: 2.1789 | pg_loss: 0.9368 | reg_loss: 0.2397 | reward: -0.3729 | rev_kl: 1.9294 | stu_lens: 28.5000 | mixed_lens: 19.5000 | lr: 4.9939e-06 | scale: 2048.00 | time: 26.323 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    125/  1000| tot_loss: 3.0601 | rl_loss: 1.2620 | pt_loss: 1.7980 | pg_loss: 0.9940 | reg_loss: 0.2680 | reward: -10.0901 | rev_kl: 0.8063 | stu_lens: 25.0000 | mixed_lens: 10.0000 | lr: 4.9933e-06 | scale: 2048.00 | time: 26.364 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    126/  1000| tot_loss: 1.6909 | rl_loss: 0.3556 | pt_loss: 1.3354 | pg_loss: 0.0874 | reg_loss: 0.2682 | reward: -0.1077 | rev_kl: 1.0218 | stu_lens: 128.0000 | mixed_lens: 112.5000 | lr: 4.9926e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    127/  1000| tot_loss: 1.8342 | rl_loss: 0.4638 | pt_loss: 1.3704 | pg_loss: 0.0189 | reg_loss: 0.4450 | reward: -0.2139 | rev_kl: 1.0745 | stu_lens: 109.0000 | mixed_lens: 128.0000 | lr: 4.9919e-06 | scale: 2048.00 | time: 26.353 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    128/  1000| tot_loss: 2.3126 | rl_loss: 0.4453 | pt_loss: 1.8672 | pg_loss: 0.0073 | reg_loss: 0.4380 | reward: -0.2518 | rev_kl: 1.4313 | stu_lens: 71.0000 | mixed_lens: 125.5000 | lr: 4.9912e-06 | scale: 2048.00 | time: 26.317 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    128/  1000| tot_loss: 2.4985 | rl_loss: 0.7318 | pt_loss: 1.7667 | pg_loss: 0.3192 | reg_loss: 0.4127 | reward: -0.8851 | rev_kl: 1.0162 | stu_lens: 84.2031 | mixed_lens: 91.0156 | lr: 4.9912e-06 | scale: 2048.00 | time: 26.317 | step time: 26.140
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    129/  1000| tot_loss: 2.5686 | rl_loss: 0.7256 | pt_loss: 1.8430 | pg_loss: 0.3554 | reg_loss: 0.3702 | reward: -0.5021 | rev_kl: 0.6611 | stu_lens: 41.5000 | mixed_lens: 27.0000 | lr: 4.9905e-06 | scale: 2048.00 | time: 26.347 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    130/  1000| tot_loss: 3.3788 | rl_loss: 1.5707 | pt_loss: 1.8081 | pg_loss: 0.4499 | reg_loss: 1.1208 | reward: -0.3611 | rev_kl: 1.1142 | stu_lens: 85.5000 | mixed_lens: 83.0000 | lr: 4.9897e-06 | scale: 2048.00 | time: 26.411 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    131/  1000| tot_loss: 3.3757 | rl_loss: 1.8419 | pt_loss: 1.5338 | pg_loss: 0.5699 | reg_loss: 1.2721 | reward: -0.3723 | rev_kl: 1.1294 | stu_lens: 68.0000 | mixed_lens: 67.5000 | lr: 4.9889e-06 | scale: 2048.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    132/  1000| tot_loss: 2.5464 | rl_loss: 1.0290 | pt_loss: 1.5175 | pg_loss: 0.0185 | reg_loss: 1.0105 | reward: -0.3896 | rev_kl: 0.9038 | stu_lens: 65.5000 | mixed_lens: 128.0000 | lr: 4.9881e-06 | scale: 2048.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    133/  1000| tot_loss: 2.1732 | rl_loss: 0.5248 | pt_loss: 1.6484 | pg_loss: 0.0369 | reg_loss: 0.4879 | reward: -0.0535 | rev_kl: 0.8212 | stu_lens: 78.0000 | mixed_lens: 120.5000 | lr: 4.9872e-06 | scale: 2048.00 | time: 26.315 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    134/  1000| tot_loss: 2.9773 | rl_loss: 1.2293 | pt_loss: 1.7480 | pg_loss: 0.2723 | reg_loss: 0.9569 | reward: -0.3798 | rev_kl: 1.6508 | stu_lens: 128.0000 | mixed_lens: 76.0000 | lr: 4.9863e-06 | scale: 2048.00 | time: 26.372 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    135/  1000| tot_loss: 3.9220 | rl_loss: 2.0172 | pt_loss: 1.9047 | pg_loss: 0.7166 | reg_loss: 1.3006 | reward: 0.1881 | rev_kl: 0.6093 | stu_lens: 72.0000 | mixed_lens: 49.0000 | lr: 4.9854e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    136/  1000| tot_loss: 2.4562 | rl_loss: 1.0851 | pt_loss: 1.3711 | pg_loss: 0.0449 | reg_loss: 1.0402 | reward: -0.1888 | rev_kl: 0.7133 | stu_lens: 118.0000 | mixed_lens: 128.0000 | lr: 4.9844e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    137/  1000| tot_loss: 2.9779 | rl_loss: 1.2357 | pt_loss: 1.7422 | pg_loss: 0.1902 | reg_loss: 1.0455 | reward: -0.3713 | rev_kl: 0.8439 | stu_lens: 114.0000 | mixed_lens: 109.0000 | lr: 4.9834e-06 | scale: 2048.00 | time: 26.317 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    138/  1000| tot_loss: 3.9024 | rl_loss: 1.9541 | pt_loss: 1.9483 | pg_loss: 0.6991 | reg_loss: 1.2550 | reward: -0.4123 | rev_kl: 1.0465 | stu_lens: 87.5000 | mixed_lens: 55.5000 | lr: 4.9824e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    139/  1000| tot_loss: 3.5846 | rl_loss: 1.9572 | pt_loss: 1.6274 | pg_loss: 0.5153 | reg_loss: 1.4419 | reward: -0.4634 | rev_kl: 0.9368 | stu_lens: 55.0000 | mixed_lens: 78.5000 | lr: 4.9814e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    140/  1000| tot_loss: 2.9233 | rl_loss: 1.0717 | pt_loss: 1.8516 | pg_loss: 0.0553 | reg_loss: 1.0163 | reward: -0.3811 | rev_kl: 0.9040 | stu_lens: 95.5000 | mixed_lens: 124.5000 | lr: 4.9803e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    141/  1000| tot_loss: 2.9068 | rl_loss: 0.9693 | pt_loss: 1.9375 | pg_loss: 0.2434 | reg_loss: 0.7260 | reward: -0.0405 | rev_kl: 0.9133 | stu_lens: 100.5000 | mixed_lens: 103.5000 | lr: 4.9792e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    142/  1000| tot_loss: 2.9013 | rl_loss: 1.2568 | pt_loss: 1.6445 | pg_loss: 0.3908 | reg_loss: 0.8661 | reward: -0.7133 | rev_kl: 0.6215 | stu_lens: 86.0000 | mixed_lens: 78.0000 | lr: 4.9780e-06 | scale: 2048.00 | time: 26.345 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    143/  1000| tot_loss: 3.0054 | rl_loss: 1.0066 | pt_loss: 1.9989 | pg_loss: 0.0565 | reg_loss: 0.9501 | reward: -0.1068 | rev_kl: 1.0163 | stu_lens: 110.5000 | mixed_lens: 128.0000 | lr: 4.9769e-06 | scale: 2048.00 | time: 26.317 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    144/  1000| tot_loss: 2.7764 | rl_loss: 1.3180 | pt_loss: 1.4584 | pg_loss: 0.4054 | reg_loss: 0.9126 | reward: -0.5266 | rev_kl: 0.7289 | stu_lens: 128.0000 | mixed_lens: 87.5000 | lr: 4.9757e-06 | scale: 2048.00 | time: 26.345 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    144/  1000| tot_loss: 2.9499 | rl_loss: 1.2427 | pt_loss: 1.7072 | pg_loss: 0.3076 | reg_loss: 0.9351 | reward: -0.4821 | rev_kl: 0.9511 | stu_lens: 91.3125 | mixed_lens: 90.0781 | lr: 4.9757e-06 | scale: 2048.00 | time: 26.345 | step time: 27.603
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    145/  1000| tot_loss: 3.3105 | rl_loss: 1.5292 | pt_loss: 1.7813 | pg_loss: 0.3769 | reg_loss: 1.1523 | reward: -0.1582 | rev_kl: 0.8202 | stu_lens: 70.5000 | mixed_lens: 58.0000 | lr: 4.9744e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    146/  1000| tot_loss: 3.0187 | rl_loss: 1.2295 | pt_loss: 1.7893 | pg_loss: 0.3409 | reg_loss: 0.8886 | reward: -0.4489 | rev_kl: 1.3768 | stu_lens: 78.0000 | mixed_lens: 87.0000 | lr: 4.9732e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    147/  1000| tot_loss: 2.4716 | rl_loss: 0.6495 | pt_loss: 1.8221 | pg_loss: 0.0003 | reg_loss: 0.6492 | reward: -0.1372 | rev_kl: 0.7325 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9719e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    148/  1000| tot_loss: 2.9384 | rl_loss: 0.7833 | pt_loss: 2.1551 | pg_loss: 0.2197 | reg_loss: 0.5635 | reward: -0.0676 | rev_kl: 0.8501 | stu_lens: 102.5000 | mixed_lens: 99.5000 | lr: 4.9706e-06 | scale: 2048.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    149/  1000| tot_loss: 2.9170 | rl_loss: 1.0886 | pt_loss: 1.8284 | pg_loss: 0.2826 | reg_loss: 0.8060 | reward: -0.2107 | rev_kl: 1.1072 | stu_lens: 85.5000 | mixed_lens: 103.0000 | lr: 4.9692e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    150/  1000| tot_loss: 2.6558 | rl_loss: 0.7412 | pt_loss: 1.9146 | pg_loss: 0.2296 | reg_loss: 0.5115 | reward: -0.2310 | rev_kl: 0.4387 | stu_lens: 87.5000 | mixed_lens: 79.5000 | lr: 4.9678e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    151/  1000| tot_loss: 2.2785 | rl_loss: 0.8136 | pt_loss: 1.4649 | pg_loss: 0.2415 | reg_loss: 0.5721 | reward: -0.2978 | rev_kl: 1.0507 | stu_lens: 128.0000 | mixed_lens: 88.0000 | lr: 4.9664e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    152/  1000| tot_loss: 3.7860 | rl_loss: 1.8238 | pt_loss: 1.9622 | pg_loss: 0.9794 | reg_loss: 0.8444 | reward: -0.2278 | rev_kl: 0.4127 | stu_lens: 32.5000 | mixed_lens: 16.0000 | lr: 4.9650e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    153/  1000| tot_loss: 2.8309 | rl_loss: 1.2664 | pt_loss: 1.5645 | pg_loss: 0.4182 | reg_loss: 0.8482 | reward: -0.9345 | rev_kl: 0.8095 | stu_lens: 126.5000 | mixed_lens: 69.5000 | lr: 4.9635e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    154/  1000| tot_loss: 2.6134 | rl_loss: 0.8366 | pt_loss: 1.7768 | pg_loss: 0.2235 | reg_loss: 0.6131 | reward: -0.4570 | rev_kl: 1.6912 | stu_lens: 128.0000 | mixed_lens: 83.5000 | lr: 4.9620e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    155/  1000| tot_loss: 3.6734 | rl_loss: 1.8530 | pt_loss: 1.8204 | pg_loss: 0.8644 | reg_loss: 0.9886 | reward: -0.5744 | rev_kl: 0.6572 | stu_lens: 50.5000 | mixed_lens: 17.5000 | lr: 4.9605e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    156/  1000| tot_loss: 2.1613 | rl_loss: 0.5163 | pt_loss: 1.6450 | pg_loss: 0.0155 | reg_loss: 0.5007 | reward: -0.1928 | rev_kl: 0.7594 | stu_lens: 113.0000 | mixed_lens: 128.0000 | lr: 4.9589e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    157/  1000| tot_loss: 2.2571 | rl_loss: 0.5922 | pt_loss: 1.6648 | pg_loss: 0.0033 | reg_loss: 0.5889 | reward: -0.0915 | rev_kl: 1.0104 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9573e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    158/  1000| tot_loss: 2.0881 | rl_loss: 0.5795 | pt_loss: 1.5086 | pg_loss: 0.0427 | reg_loss: 0.5368 | reward: -0.2937 | rev_kl: 0.8007 | stu_lens: 104.5000 | mixed_lens: 113.5000 | lr: 4.9557e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    159/  1000| tot_loss: 3.2687 | rl_loss: 1.2871 | pt_loss: 1.9816 | pg_loss: 0.4719 | reg_loss: 0.8151 | reward: -0.4391 | rev_kl: 0.7961 | stu_lens: 77.0000 | mixed_lens: 67.5000 | lr: 4.9541e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    160/  1000| tot_loss: 2.9238 | rl_loss: 1.5698 | pt_loss: 1.3541 | pg_loss: 0.7769 | reg_loss: 0.7929 | reward: -0.5603 | rev_kl: 0.7925 | stu_lens: 87.0000 | mixed_lens: 72.0000 | lr: 4.9524e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    160/  1000| tot_loss: 2.7259 | rl_loss: 0.9911 | pt_loss: 1.7348 | pg_loss: 0.3057 | reg_loss: 0.6854 | reward: -0.3208 | rev_kl: 0.8979 | stu_lens: 92.6562 | mixed_lens: 89.0312 | lr: 4.9524e-06 | scale: 2048.00 | time: 26.298 | step time: 27.580
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    161/  1000| tot_loss: 2.5184 | rl_loss: 1.0987 | pt_loss: 1.4197 | pg_loss: 0.3823 | reg_loss: 0.7164 | reward: -0.0501 | rev_kl: 1.0992 | stu_lens: 85.5000 | mixed_lens: 63.5000 | lr: 4.9507e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    162/  1000| tot_loss: 2.2217 | rl_loss: 0.4765 | pt_loss: 1.7452 | pg_loss: 0.0308 | reg_loss: 0.4458 | reward: -0.1150 | rev_kl: 0.8722 | stu_lens: 128.0000 | mixed_lens: 120.5000 | lr: 4.9489e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    163/  1000| tot_loss: 2.3588 | rl_loss: 0.5605 | pt_loss: 1.7983 | pg_loss: 0.0747 | reg_loss: 0.4858 | reward: -0.1142 | rev_kl: 1.2177 | stu_lens: 103.0000 | mixed_lens: 121.5000 | lr: 4.9472e-06 | scale: 2048.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    164/  1000| tot_loss: 2.4893 | rl_loss: 0.8022 | pt_loss: 1.6871 | pg_loss: 0.3903 | reg_loss: 0.4119 | reward: -0.4509 | rev_kl: 0.9249 | stu_lens: 75.5000 | mixed_lens: 68.0000 | lr: 4.9454e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    165/  1000| tot_loss: 2.3803 | rl_loss: 0.5221 | pt_loss: 1.8582 | pg_loss: -0.0195 | reg_loss: 0.5416 | reward: -0.2013 | rev_kl: 0.8345 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9435e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    166/  1000| tot_loss: 2.0323 | rl_loss: 0.6269 | pt_loss: 1.4054 | pg_loss: 0.2346 | reg_loss: 0.3923 | reward: -0.4280 | rev_kl: 0.5703 | stu_lens: 50.5000 | mixed_lens: 77.5000 | lr: 4.9417e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    167/  1000| tot_loss: 3.3376 | rl_loss: 0.5464 | pt_loss: 2.7912 | pg_loss: 0.1559 | reg_loss: 0.3905 | reward: -0.1779 | rev_kl: 0.7669 | stu_lens: 87.5000 | mixed_lens: 70.5000 | lr: 4.9398e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    168/  1000| tot_loss: 2.0083 | rl_loss: 0.6152 | pt_loss: 1.3931 | pg_loss: 0.0732 | reg_loss: 0.5420 | reward: -0.2042 | rev_kl: 1.3555 | stu_lens: 85.5000 | mixed_lens: 109.0000 | lr: 4.9379e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    169/  1000| tot_loss: 2.2897 | rl_loss: 0.6571 | pt_loss: 1.6326 | pg_loss: 0.0474 | reg_loss: 0.6097 | reward: -0.3361 | rev_kl: 0.7383 | stu_lens: 95.5000 | mixed_lens: 124.5000 | lr: 4.9359e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    170/  1000| tot_loss: 2.4779 | rl_loss: 0.8921 | pt_loss: 1.5858 | pg_loss: 0.2560 | reg_loss: 0.6361 | reward: -0.4027 | rev_kl: 0.8607 | stu_lens: 102.5000 | mixed_lens: 95.5000 | lr: 4.9339e-06 | scale: 2048.00 | time: 26.315 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    171/  1000| tot_loss: 2.8817 | rl_loss: 1.0218 | pt_loss: 1.8599 | pg_loss: 0.4991 | reg_loss: 0.5227 | reward: -0.8916 | rev_kl: 0.7912 | stu_lens: 128.0000 | mixed_lens: 69.5000 | lr: 4.9319e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    172/  1000| tot_loss: 2.2349 | rl_loss: 0.4811 | pt_loss: 1.7539 | pg_loss: -0.0057 | reg_loss: 0.4868 | reward: -0.3292 | rev_kl: 0.8787 | stu_lens: 126.5000 | mixed_lens: 128.0000 | lr: 4.9299e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    173/  1000| tot_loss: 5.0880 | rl_loss: 3.0406 | pt_loss: 2.0474 | pg_loss: 1.7581 | reg_loss: 1.2825 | reward: -0.6768 | rev_kl: 0.5994 | stu_lens: 52.0000 | mixed_lens: 22.5000 | lr: 4.9278e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    174/  1000| tot_loss: 2.1691 | rl_loss: 0.6596 | pt_loss: 1.5096 | pg_loss: 0.0300 | reg_loss: 0.6295 | reward: -0.2995 | rev_kl: 0.7178 | stu_lens: 128.0000 | mixed_lens: 121.0000 | lr: 4.9257e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    175/  1000| tot_loss: 3.0555 | rl_loss: 0.9282 | pt_loss: 2.1273 | pg_loss: 0.3576 | reg_loss: 0.5706 | reward: -0.5239 | rev_kl: 0.7095 | stu_lens: 63.0000 | mixed_lens: 74.5000 | lr: 4.9236e-06 | scale: 2048.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    176/  1000| tot_loss: 3.7682 | rl_loss: 2.0414 | pt_loss: 1.7268 | pg_loss: 1.4745 | reg_loss: 0.5669 | reward: -0.5011 | rev_kl: 0.8262 | stu_lens: 67.5000 | mixed_lens: 15.5000 | lr: 4.9215e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    176/  1000| tot_loss: 2.6100 | rl_loss: 0.8472 | pt_loss: 1.7628 | pg_loss: 0.3057 | reg_loss: 0.5415 | reward: -0.3142 | rev_kl: 0.9413 | stu_lens: 94.7500 | mixed_lens: 91.8438 | lr: 4.9215e-06 | scale: 2048.00 | time: 26.293 | step time: 27.565
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    177/  1000| tot_loss: 1.8721 | rl_loss: 0.5921 | pt_loss: 1.2800 | pg_loss: 0.0980 | reg_loss: 0.4941 | reward: -0.2011 | rev_kl: 0.8671 | stu_lens: 104.5000 | mixed_lens: 107.5000 | lr: 4.9193e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    178/  1000| tot_loss: 2.1254 | rl_loss: 0.3425 | pt_loss: 1.7829 | pg_loss: -0.0024 | reg_loss: 0.3449 | reward: -0.2379 | rev_kl: 1.1321 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9171e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    179/  1000| tot_loss: 2.9875 | rl_loss: 0.9452 | pt_loss: 2.0423 | pg_loss: 0.5796 | reg_loss: 0.3656 | reward: -0.3082 | rev_kl: 1.0275 | stu_lens: 68.0000 | mixed_lens: 67.5000 | lr: 4.9148e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    180/  1000| tot_loss: 2.3839 | rl_loss: 0.2941 | pt_loss: 2.0898 | pg_loss: -0.0130 | reg_loss: 0.3071 | reward: -0.0845 | rev_kl: 0.5261 | stu_lens: 113.0000 | mixed_lens: 128.0000 | lr: 4.9125e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    181/  1000| tot_loss: 2.3407 | rl_loss: 0.3920 | pt_loss: 1.9487 | pg_loss: 0.0042 | reg_loss: 0.3878 | reward: -0.0841 | rev_kl: 0.9571 | stu_lens: 128.0000 | mixed_lens: 120.5000 | lr: 4.9102e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    182/  1000| tot_loss: 2.0627 | rl_loss: 0.3800 | pt_loss: 1.6828 | pg_loss: -0.0258 | reg_loss: 0.4058 | reward: -0.2263 | rev_kl: 1.5127 | stu_lens: 124.0000 | mixed_lens: 128.0000 | lr: 4.9079e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    183/  1000| tot_loss: 3.2558 | rl_loss: 1.7040 | pt_loss: 1.5518 | pg_loss: 0.7494 | reg_loss: 0.9546 | reward: -0.4922 | rev_kl: 0.7626 | stu_lens: 87.5000 | mixed_lens: 38.0000 | lr: 4.9055e-06 | scale: 2048.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    184/  1000| tot_loss: 2.4777 | rl_loss: 0.6063 | pt_loss: 1.8714 | pg_loss: 0.0382 | reg_loss: 0.5681 | reward: -0.0905 | rev_kl: 1.5164 | stu_lens: 118.0000 | mixed_lens: 121.5000 | lr: 4.9032e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    185/  1000| tot_loss: 2.5640 | rl_loss: 0.8549 | pt_loss: 1.7091 | pg_loss: 0.5678 | reg_loss: 0.2871 | reward: -0.4095 | rev_kl: 1.1537 | stu_lens: 95.5000 | mixed_lens: 52.0000 | lr: 4.9007e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    186/  1000| tot_loss: 2.5988 | rl_loss: 0.4977 | pt_loss: 2.1011 | pg_loss: -0.0217 | reg_loss: 0.5194 | reward: -0.3123 | rev_kl: 0.8131 | stu_lens: 111.5000 | mixed_lens: 128.0000 | lr: 4.8983e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    187/  1000| tot_loss: 2.8678 | rl_loss: 0.8989 | pt_loss: 1.9689 | pg_loss: 0.5247 | reg_loss: 0.3742 | reward: -0.2359 | rev_kl: 0.7116 | stu_lens: 61.5000 | mixed_lens: 69.0000 | lr: 4.8958e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    188/  1000| tot_loss: 2.6683 | rl_loss: 1.4142 | pt_loss: 1.2541 | pg_loss: 0.9540 | reg_loss: 0.4602 | reward: -0.5961 | rev_kl: 0.7318 | stu_lens: 70.5000 | mixed_lens: 43.5000 | lr: 4.8933e-06 | scale: 2048.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    189/  1000| tot_loss: 1.9319 | rl_loss: 0.4733 | pt_loss: 1.4587 | pg_loss: 0.0488 | reg_loss: 0.4245 | reward: -0.2693 | rev_kl: 1.7753 | stu_lens: 128.0000 | mixed_lens: 116.0000 | lr: 4.8908e-06 | scale: 2048.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    190/  1000| tot_loss: 2.3796 | rl_loss: 0.8084 | pt_loss: 1.5712 | pg_loss: 0.4850 | reg_loss: 0.3233 | reward: -0.5396 | rev_kl: 0.7227 | stu_lens: 114.0000 | mixed_lens: 69.0000 | lr: 4.8882e-06 | scale: 2048.00 | time: 26.352 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    191/  1000| tot_loss: 2.6011 | rl_loss: 1.1071 | pt_loss: 1.4940 | pg_loss: 0.6148 | reg_loss: 0.4923 | reward: 0.2032 | rev_kl: 0.5556 | stu_lens: 23.5000 | mixed_lens: 31.5000 | lr: 4.8856e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    192/  1000| tot_loss: 1.9381 | rl_loss: 0.4732 | pt_loss: 1.4648 | pg_loss: 0.1465 | reg_loss: 0.3267 | reward: -0.2095 | rev_kl: 0.6475 | stu_lens: 87.5000 | mixed_lens: 86.5000 | lr: 4.8830e-06 | scale: 2048.00 | time: 26.339 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    192/  1000| tot_loss: 2.4285 | rl_loss: 0.7019 | pt_loss: 1.7265 | pg_loss: 0.2814 | reg_loss: 0.4205 | reward: -0.2882 | rev_kl: 0.9190 | stu_lens: 96.8750 | mixed_lens: 92.6875 | lr: 4.8830e-06 | scale: 2048.00 | time: 26.339 | step time: 27.581
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    193/  1000| tot_loss: 3.2713 | rl_loss: 1.6786 | pt_loss: 1.5927 | pg_loss: 0.7549 | reg_loss: 0.9237 | reward: -0.6994 | rev_kl: 0.8559 | stu_lens: 42.5000 | mixed_lens: 39.5000 | lr: 4.8803e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    194/  1000| tot_loss: 2.8965 | rl_loss: 0.9719 | pt_loss: 1.9247 | pg_loss: 0.0182 | reg_loss: 0.9536 | reward: -0.2732 | rev_kl: 2.6798 | stu_lens: 77.0000 | mixed_lens: 128.0000 | lr: 4.8776e-06 | scale: 2048.00 | time: 26.352 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    195/  1000| tot_loss: 3.8515 | rl_loss: 1.8659 | pt_loss: 1.9856 | pg_loss: 0.9350 | reg_loss: 0.9309 | reward: -0.7544 | rev_kl: 1.2037 | stu_lens: 44.0000 | mixed_lens: 44.5000 | lr: 4.8749e-06 | scale: 2048.00 | time: 26.336 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    196/  1000| tot_loss: 3.2565 | rl_loss: 1.5852 | pt_loss: 1.6713 | pg_loss: 0.4333 | reg_loss: 1.1519 | reward: -0.2252 | rev_kl: 1.0718 | stu_lens: 111.0000 | mixed_lens: 72.5000 | lr: 4.8722e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    197/  1000| tot_loss: 3.9430 | rl_loss: 1.7945 | pt_loss: 2.1485 | pg_loss: 0.3741 | reg_loss: 1.4203 | reward: -0.3112 | rev_kl: 0.9322 | stu_lens: 109.0000 | mixed_lens: 97.5000 | lr: 4.8694e-06 | scale: 2048.00 | time: 26.340 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    198/  1000| tot_loss: 2.4963 | rl_loss: 1.1479 | pt_loss: 1.3484 | pg_loss: 0.2539 | reg_loss: 0.8940 | reward: -0.4749 | rev_kl: 0.9283 | stu_lens: 18.0000 | mixed_lens: 103.0000 | lr: 4.8666e-06 | scale: 2048.00 | time: 26.320 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    199/  1000| tot_loss: 2.6056 | rl_loss: 1.1382 | pt_loss: 1.4674 | pg_loss: 0.0767 | reg_loss: 1.0615 | reward: -0.2927 | rev_kl: 0.7289 | stu_lens: 93.0000 | mixed_lens: 128.0000 | lr: 4.8638e-06 | scale: 2048.00 | time: 26.322 | step time: 0.000
                                 Evaluation #2                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ dime un chiste acerca de la situacion │ dime un chiste acerca de la          │
│ actual de la economia, de modo que    │ situacion actual de la economia, de  │
│ los niños comprendan el mal estado de │ modo que los niños comprendan el mal │
│ la misma.                             │ estado de la misma.                  │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ La economia actual tiene problemas,  │
│                                       │ y es mucho mejor que no se compruebe │
│                                       │ que está dándose un problema en la   │
│                                       │ economía. Si se nota algo, entonces  │
│                                       │ lo mejor es arruinar el sistema y    │
│                                       │ empezar de nuevo. En caso de que     │
│                                       │ nadie pueda inventarle una solución, │
│                                       │ es mejor que la economia se deshaga  │
│                                       │ de sí misma, de la misma forma que   │
│                                       │ ocurre con la volcanología.          │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Sure! Here's another one:            │
│                                       │                                      │
│                                       │ Once upon a time, there was a king   │
│                                       │ who had three daughters. He wanted   │
│                                       │ to give them the best education, so  │
│                                       │ he sent them to the finest           │
│                                       │ university in the land.              │
│                                       │                                      │
│                                       │ After the daughters finished their   │
│                                       │ studies, they went back to the       │
│                                       │ castle to visit their father. As     │
│                                       │ they entered the room, they saw that │
│                                       │ the king had a huge pile of sweets   │
│                                       │ in front of him. He explained that   │
│                                       │ he had ordered all the confectioners │
│                                       │ in the kingdom to make different     │
│                                       │ kinds of sweets, and that he wanted  │
│                                       │ to give one to each of his           │
│                                       │ daughters.                           │
│                                       │                                      │
│                                       │                                      │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Sure, I'll tell you another joke. A  │
│                                       │ man walked into a bar and said to    │
│                                       │ the bartender, "I'll have what she's │
│                                       │ having." The bartender replied, "I'm │
│                                       │ sorry, sir, but you can't have what  │
│                                       │ she's having. She's having a         │
│                                       │ martini." The man said, "Ooh, thank  │
│                                       │ you. I'll have what she's having."   │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 15.809 | exact_match: 0.000 | rev_kl: 0.946 | lens: 100.514 | pt_loss: 1.753 | lm_loss: 1.892 | kd_loss: 1.614 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    200/  1000| tot_loss: 2.6520 | rl_loss: 0.6963 | pt_loss: 1.9556 | pg_loss: 0.0594 | reg_loss: 0.6369 | reward: -0.2286 | rev_kl: 0.6390 | stu_lens: 111.0000 | mixed_lens: 128.0000 | lr: 4.8609e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    201/  1000| tot_loss: 3.5665 | rl_loss: 1.6305 | pt_loss: 1.9360 | pg_loss: 0.4718 | reg_loss: 1.1587 | reward: -0.7333 | rev_kl: 0.6349 | stu_lens: 80.5000 | mixed_lens: 61.5000 | lr: 4.8581e-06 | scale: 2048.00 | time: 26.340 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    202/  1000| tot_loss: 2.5164 | rl_loss: 1.0538 | pt_loss: 1.4626 | pg_loss: 0.0648 | reg_loss: 0.9890 | reward: -0.2398 | rev_kl: 0.7725 | stu_lens: 112.5000 | mixed_lens: 128.0000 | lr: 4.8551e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    203/  1000| tot_loss: 3.2465 | rl_loss: 1.9040 | pt_loss: 1.3425 | pg_loss: 0.4473 | reg_loss: 1.4567 | reward: -1.0501 | rev_kl: 0.6192 | stu_lens: 75.0000 | mixed_lens: 71.0000 | lr: 4.8522e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    204/  1000| tot_loss: 2.9516 | rl_loss: 1.1255 | pt_loss: 1.8260 | pg_loss: 0.2912 | reg_loss: 0.8344 | reward: -1.1630 | rev_kl: 1.4878 | stu_lens: 81.5000 | mixed_lens: 91.0000 | lr: 4.8492e-06 | scale: 2048.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    205/  1000| tot_loss: 3.2528 | rl_loss: 1.2210 | pt_loss: 2.0317 | pg_loss: 0.3501 | reg_loss: 0.8709 | reward: -0.2459 | rev_kl: 0.7174 | stu_lens: 66.5000 | mixed_lens: 86.5000 | lr: 4.8462e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    206/  1000| tot_loss: 2.6818 | rl_loss: 1.2726 | pt_loss: 1.4092 | pg_loss: 0.0950 | reg_loss: 1.1776 | reward: -0.1144 | rev_kl: 0.7436 | stu_lens: 86.0000 | mixed_lens: 128.0000 | lr: 4.8432e-06 | scale: 2048.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    207/  1000| tot_loss: 3.2875 | rl_loss: 1.6371 | pt_loss: 1.6504 | pg_loss: 0.7876 | reg_loss: 0.8496 | reward: -0.2410 | rev_kl: 1.2062 | stu_lens: 109.5000 | mixed_lens: 40.0000 | lr: 4.8401e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    208/  1000| tot_loss: 4.5743 | rl_loss: 1.5911 | pt_loss: 2.9832 | pg_loss: 0.4431 | reg_loss: 1.1480 | reward: -0.5563 | rev_kl: 1.1580 | stu_lens: 73.5000 | mixed_lens: 73.5000 | lr: 4.8371e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    208/  1000| tot_loss: 3.1152 | rl_loss: 1.3767 | pt_loss: 1.7385 | pg_loss: 0.3529 | reg_loss: 1.0238 | reward: -0.6770 | rev_kl: 0.9432 | stu_lens: 82.2188 | mixed_lens: 86.3750 | lr: 4.8371e-06 | scale: 2048.00 | time: 26.266 | step time: 27.586
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    209/  1000| tot_loss: 3.3474 | rl_loss: 1.3455 | pt_loss: 2.0020 | pg_loss: 0.3373 | reg_loss: 1.0082 | reward: -0.2616 | rev_kl: 1.1922 | stu_lens: 77.5000 | mixed_lens: 91.0000 | lr: 4.8340e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    210/  1000| tot_loss: 2.2282 | rl_loss: 0.9377 | pt_loss: 1.2904 | pg_loss: 0.1120 | reg_loss: 0.8258 | reward: -0.2527 | rev_kl: 1.3514 | stu_lens: 128.0000 | mixed_lens: 105.5000 | lr: 4.8308e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    211/  1000| tot_loss: 2.9240 | rl_loss: 0.9118 | pt_loss: 2.0123 | pg_loss: 0.0704 | reg_loss: 0.8414 | reward: -1.0634 | rev_kl: 0.7575 | stu_lens: 75.0000 | mixed_lens: 71.0000 | lr: 4.8276e-06 | scale: 2048.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    212/  1000| tot_loss: 2.7408 | rl_loss: 0.8858 | pt_loss: 1.8550 | pg_loss: 0.5407 | reg_loss: 0.3451 | reward: -0.2304 | rev_kl: 0.7661 | stu_lens: 18.0000 | mixed_lens: 45.5000 | lr: 4.8244e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    213/  1000| tot_loss: 2.3551 | rl_loss: 0.6819 | pt_loss: 1.6732 | pg_loss: 0.0119 | reg_loss: 0.6700 | reward: -0.2859 | rev_kl: 2.7257 | stu_lens: 104.5000 | mixed_lens: 128.0000 | lr: 4.8212e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    214/  1000| tot_loss: 2.4611 | rl_loss: 0.8103 | pt_loss: 1.6508 | pg_loss: 0.1744 | reg_loss: 0.6359 | reward: -0.4038 | rev_kl: 0.7884 | stu_lens: 78.5000 | mixed_lens: 94.5000 | lr: 4.8180e-06 | scale: 2048.00 | time: 26.340 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    215/  1000| tot_loss: 2.8371 | rl_loss: 1.0769 | pt_loss: 1.7602 | pg_loss: 0.3614 | reg_loss: 0.7155 | reward: -0.1947 | rev_kl: 0.4334 | stu_lens: 76.5000 | mixed_lens: 89.5000 | lr: 4.8147e-06 | scale: 2048.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    216/  1000| tot_loss: 2.6837 | rl_loss: 0.5535 | pt_loss: 2.1302 | pg_loss: 0.0040 | reg_loss: 0.5495 | reward: -0.1724 | rev_kl: 0.8513 | stu_lens: 76.5000 | mixed_lens: 128.0000 | lr: 4.8114e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    217/  1000| tot_loss: 3.0130 | rl_loss: 0.8731 | pt_loss: 2.1399 | pg_loss: 0.2909 | reg_loss: 0.5823 | reward: -0.1438 | rev_kl: 0.7580 | stu_lens: 98.0000 | mixed_lens: 89.0000 | lr: 4.8080e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    218/  1000| tot_loss: 3.5493 | rl_loss: 1.2332 | pt_loss: 2.3161 | pg_loss: 0.5298 | reg_loss: 0.7034 | reward: -0.3027 | rev_kl: 0.7322 | stu_lens: 128.0000 | mixed_lens: 75.5000 | lr: 4.8047e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    219/  1000| tot_loss: 2.5196 | rl_loss: 0.6436 | pt_loss: 1.8761 | pg_loss: -0.0336 | reg_loss: 0.6772 | reward: -0.1066 | rev_kl: 0.4471 | stu_lens: 112.5000 | mixed_lens: 128.0000 | lr: 4.8013e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    220/  1000| tot_loss: 3.7453 | rl_loss: 1.4636 | pt_loss: 2.2817 | pg_loss: 0.5284 | reg_loss: 0.9352 | reward: -0.8030 | rev_kl: 0.3735 | stu_lens: 67.5000 | mixed_lens: 42.0000 | lr: 4.7978e-06 | scale: 2048.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    221/  1000| tot_loss: 3.0281 | rl_loss: 0.8034 | pt_loss: 2.2247 | pg_loss: 0.1543 | reg_loss: 0.6491 | reward: -6.3157 | rev_kl: 0.3246 | stu_lens: 128.0000 | mixed_lens: 65.5000 | lr: 4.7944e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    222/  1000| tot_loss: 2.4638 | rl_loss: 0.8049 | pt_loss: 1.6589 | pg_loss: 0.1956 | reg_loss: 0.6093 | reward: -0.3393 | rev_kl: 1.1186 | stu_lens: 90.0000 | mixed_lens: 91.0000 | lr: 4.7909e-06 | scale: 2048.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    223/  1000| tot_loss: 3.0005 | rl_loss: 1.2931 | pt_loss: 1.7073 | pg_loss: 0.3757 | reg_loss: 0.9174 | reward: -1.8601 | rev_kl: 0.7191 | stu_lens: 91.0000 | mixed_lens: 68.5000 | lr: 4.7874e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    224/  1000| tot_loss: 3.3480 | rl_loss: 1.4695 | pt_loss: 1.8785 | pg_loss: 0.7972 | reg_loss: 0.6723 | reward: -1.7881 | rev_kl: 0.7903 | stu_lens: 7.0000 | mixed_lens: 43.0000 | lr: 4.7839e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    224/  1000| tot_loss: 2.7880 | rl_loss: 0.9790 | pt_loss: 1.8090 | pg_loss: 0.2858 | reg_loss: 0.6932 | reward: -0.7249 | rev_kl: 0.9282 | stu_lens: 80.6250 | mixed_lens: 86.8750 | lr: 4.7839e-06 | scale: 2048.00 | time: 26.311 | step time: 27.566
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    225/  1000| tot_loss: 2.9411 | rl_loss: 1.0345 | pt_loss: 1.9067 | pg_loss: 0.1953 | reg_loss: 0.8392 | reward: -0.3544 | rev_kl: 1.1746 | stu_lens: 120.5000 | mixed_lens: 92.0000 | lr: 4.7803e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    226/  1000| tot_loss: 2.4851 | rl_loss: 0.6978 | pt_loss: 1.7873 | pg_loss: 0.3701 | reg_loss: 0.3277 | reward: -0.1873 | rev_kl: 0.7515 | stu_lens: 120.0000 | mixed_lens: 66.5000 | lr: 4.7767e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    227/  1000| tot_loss: 2.3726 | rl_loss: 0.8148 | pt_loss: 1.5578 | pg_loss: 0.1779 | reg_loss: 0.6369 | reward: -0.4673 | rev_kl: 0.4924 | stu_lens: 78.5000 | mixed_lens: 94.5000 | lr: 4.7731e-06 | scale: 2048.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    228/  1000| tot_loss: 2.4534 | rl_loss: 0.7454 | pt_loss: 1.7080 | pg_loss: 0.1294 | reg_loss: 0.6159 | reward: -0.5313 | rev_kl: 0.8095 | stu_lens: 107.5000 | mixed_lens: 96.0000 | lr: 4.7694e-06 | scale: 2048.00 | time: 26.317 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    229/  1000| tot_loss: 2.8131 | rl_loss: 1.0427 | pt_loss: 1.7704 | pg_loss: 0.7441 | reg_loss: 0.2986 | reward: -1.3095 | rev_kl: 0.7824 | stu_lens: 37.0000 | mixed_lens: 21.5000 | lr: 4.7658e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    230/  1000| tot_loss: 2.4025 | rl_loss: 0.4329 | pt_loss: 1.9696 | pg_loss: 0.0049 | reg_loss: 0.4280 | reward: -0.0393 | rev_kl: 0.9221 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7621e-06 | scale: 2048.00 | time: 26.322 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    231/  1000| tot_loss: 2.4699 | rl_loss: 0.7625 | pt_loss: 1.7074 | pg_loss: 0.2968 | reg_loss: 0.4657 | reward: -0.2290 | rev_kl: 1.2461 | stu_lens: 26.0000 | mixed_lens: 91.0000 | lr: 4.7583e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    232/  1000| tot_loss: 2.3042 | rl_loss: 0.8235 | pt_loss: 1.4807 | pg_loss: 0.2310 | reg_loss: 0.5926 | reward: -0.1355 | rev_kl: 1.0402 | stu_lens: 69.0000 | mixed_lens: 95.0000 | lr: 4.7546e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    233/  1000| tot_loss: 2.2698 | rl_loss: 0.5846 | pt_loss: 1.6852 | pg_loss: 0.0966 | reg_loss: 0.4879 | reward: -6.2104 | rev_kl: 0.5406 | stu_lens: 128.0000 | mixed_lens: 65.5000 | lr: 4.7508e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    234/  1000| tot_loss: 2.2595 | rl_loss: 0.9579 | pt_loss: 1.3016 | pg_loss: 0.2101 | reg_loss: 0.7478 | reward: -0.3807 | rev_kl: 1.6078 | stu_lens: 128.0000 | mixed_lens: 92.0000 | lr: 4.7470e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    235/  1000| tot_loss: 2.6419 | rl_loss: 0.8317 | pt_loss: 1.8103 | pg_loss: 0.1691 | reg_loss: 0.6626 | reward: -0.4949 | rev_kl: 1.0404 | stu_lens: 82.0000 | mixed_lens: 94.0000 | lr: 4.7431e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    236/  1000| tot_loss: 2.3751 | rl_loss: 0.3529 | pt_loss: 2.0221 | pg_loss: -0.0235 | reg_loss: 0.3764 | reward: -0.1815 | rev_kl: 0.7119 | stu_lens: 95.5000 | mixed_lens: 128.0000 | lr: 4.7393e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    237/  1000| tot_loss: 2.8027 | rl_loss: 0.8914 | pt_loss: 1.9113 | pg_loss: 0.4411 | reg_loss: 0.4503 | reward: -0.2112 | rev_kl: 1.0794 | stu_lens: 71.5000 | mixed_lens: 72.5000 | lr: 4.7354e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    238/  1000| tot_loss: 2.1587 | rl_loss: 0.4178 | pt_loss: 1.7409 | pg_loss: 0.1946 | reg_loss: 0.2232 | reward: -0.2455 | rev_kl: 0.4937 | stu_lens: 76.5000 | mixed_lens: 89.5000 | lr: 4.7315e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    239/  1000| tot_loss: 2.3489 | rl_loss: 1.0797 | pt_loss: 1.2691 | pg_loss: 0.3268 | reg_loss: 0.7530 | reward: -0.5086 | rev_kl: 1.0111 | stu_lens: 98.0000 | mixed_lens: 82.5000 | lr: 4.7275e-06 | scale: 2048.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    240/  1000| tot_loss: 2.8841 | rl_loss: 0.7810 | pt_loss: 2.1031 | pg_loss: 0.1867 | reg_loss: 0.5943 | reward: -0.2988 | rev_kl: 1.2661 | stu_lens: 120.5000 | mixed_lens: 98.5000 | lr: 4.7235e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    240/  1000| tot_loss: 2.5518 | rl_loss: 0.7533 | pt_loss: 1.7985 | pg_loss: 0.2327 | reg_loss: 0.5205 | reward: -0.6719 | rev_kl: 1.0047 | stu_lens: 83.9375 | mixed_lens: 88.2188 | lr: 4.7235e-06 | scale: 2048.00 | time: 26.287 | step time: 27.575
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    241/  1000| tot_loss: 3.1053 | rl_loss: 1.0958 | pt_loss: 2.0095 | pg_loss: 0.5565 | reg_loss: 0.5393 | reward: -0.5332 | rev_kl: 0.5729 | stu_lens: 73.5000 | mixed_lens: 73.5000 | lr: 4.7195e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    242/  1000| tot_loss: 1.9699 | rl_loss: 0.4796 | pt_loss: 1.4903 | pg_loss: -0.0157 | reg_loss: 0.4953 | reward: -0.1952 | rev_kl: 0.8352 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7155e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    243/  1000| tot_loss: 2.7297 | rl_loss: 0.6442 | pt_loss: 2.0855 | pg_loss: 0.1734 | reg_loss: 0.4708 | reward: -0.4737 | rev_kl: 1.1490 | stu_lens: 50.5000 | mixed_lens: 94.0000 | lr: 4.7115e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    244/  1000| tot_loss: 2.0768 | rl_loss: 0.4814 | pt_loss: 1.5954 | pg_loss: 0.2635 | reg_loss: 0.2179 | reward: -0.2779 | rev_kl: 0.6808 | stu_lens: 52.0000 | mixed_lens: 87.0000 | lr: 4.7074e-06 | scale: 2048.00 | time: 26.322 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    245/  1000| tot_loss: 2.3763 | rl_loss: 0.7400 | pt_loss: 1.6363 | pg_loss: 0.2011 | reg_loss: 0.5389 | reward: -0.2785 | rev_kl: 1.0128 | stu_lens: 86.0000 | mixed_lens: 92.0000 | lr: 4.7033e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    246/  1000| tot_loss: 2.2561 | rl_loss: 0.6720 | pt_loss: 1.5841 | pg_loss: 0.1701 | reg_loss: 0.5019 | reward: -0.3862 | rev_kl: 0.6245 | stu_lens: 80.5000 | mixed_lens: 93.5000 | lr: 4.6991e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    247/  1000| tot_loss: 2.0943 | rl_loss: 0.5459 | pt_loss: 1.5484 | pg_loss: 0.2438 | reg_loss: 0.3021 | reward: -0.2415 | rev_kl: 0.6014 | stu_lens: 57.5000 | mixed_lens: 98.0000 | lr: 4.6950e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    248/  1000| tot_loss: 2.0461 | rl_loss: 0.6970 | pt_loss: 1.3492 | pg_loss: 0.3865 | reg_loss: 0.3105 | reward: -6.5002 | rev_kl: 0.6812 | stu_lens: 69.5000 | mixed_lens: 40.5000 | lr: 4.6908e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    249/  1000| tot_loss: 2.0584 | rl_loss: 0.4761 | pt_loss: 1.5824 | pg_loss: 0.0675 | reg_loss: 0.4085 | reward: -0.4652 | rev_kl: 0.8063 | stu_lens: 28.0000 | mixed_lens: 74.0000 | lr: 4.6865e-06 | scale: 2048.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    250/  1000| tot_loss: 1.9521 | rl_loss: 0.7043 | pt_loss: 1.2478 | pg_loss: 0.2293 | reg_loss: 0.4750 | reward: -0.2988 | rev_kl: 1.2661 | stu_lens: 120.5000 | mixed_lens: 98.5000 | lr: 4.6823e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    251/  1000| tot_loss: 2.4010 | rl_loss: 0.6431 | pt_loss: 1.7579 | pg_loss: 0.3034 | reg_loss: 0.3398 | reward: -0.2024 | rev_kl: 0.7507 | stu_lens: 66.5000 | mixed_lens: 86.5000 | lr: 4.6780e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    252/  1000| tot_loss: 2.2555 | rl_loss: 0.7635 | pt_loss: 1.4920 | pg_loss: 0.3717 | reg_loss: 0.3918 | reward: -0.5700 | rev_kl: 1.0733 | stu_lens: 77.5000 | mixed_lens: 59.0000 | lr: 4.6737e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    253/  1000| tot_loss: 2.9076 | rl_loss: 1.0743 | pt_loss: 1.8333 | pg_loss: 0.5289 | reg_loss: 0.5454 | reward: -1.5940 | rev_kl: 0.8565 | stu_lens: 65.5000 | mixed_lens: 68.0000 | lr: 4.6694e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    254/  1000| tot_loss: 2.8852 | rl_loss: 0.4043 | pt_loss: 2.4809 | pg_loss: 0.0117 | reg_loss: 0.3926 | reward: -0.2904 | rev_kl: 0.5717 | stu_lens: 76.5000 | mixed_lens: 128.0000 | lr: 4.6651e-06 | scale: 2048.00 | time: 26.317 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    255/  1000| tot_loss: 2.2625 | rl_loss: 0.3645 | pt_loss: 1.8980 | pg_loss: 0.0847 | reg_loss: 0.2798 | reward: -0.1981 | rev_kl: 0.5874 | stu_lens: 76.5000 | mixed_lens: 89.5000 | lr: 4.6607e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    256/  1000| tot_loss: 2.8176 | rl_loss: 0.7668 | pt_loss: 2.0508 | pg_loss: 0.2287 | reg_loss: 0.5381 | reward: -0.4049 | rev_kl: 0.8698 | stu_lens: 74.0000 | mixed_lens: 97.5000 | lr: 4.6563e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    256/  1000| tot_loss: 2.4281 | rl_loss: 0.6585 | pt_loss: 1.7696 | pg_loss: 0.2610 | reg_loss: 0.3975 | reward: -0.7003 | rev_kl: 0.9263 | stu_lens: 81.3281 | mixed_lens: 86.0469 | lr: 4.6563e-06 | scale: 2048.00 | time: 26.290 | step time: 27.580
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    257/  1000| tot_loss: 1.6754 | rl_loss: 0.6553 | pt_loss: 1.0201 | pg_loss: 0.1563 | reg_loss: 0.4990 | reward: -0.3824 | rev_kl: 1.0910 | stu_lens: 73.0000 | mixed_lens: 91.0000 | lr: 4.6519e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    258/  1000| tot_loss: 3.2301 | rl_loss: 1.2451 | pt_loss: 1.9851 | pg_loss: 0.3341 | reg_loss: 0.9110 | reward: -0.2422 | rev_kl: 0.8013 | stu_lens: 122.5000 | mixed_lens: 83.5000 | lr: 4.6474e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    259/  1000| tot_loss: 2.9777 | rl_loss: 1.0175 | pt_loss: 1.9602 | pg_loss: 0.1652 | reg_loss: 0.8523 | reward: -0.1360 | rev_kl: 0.8131 | stu_lens: 105.0000 | mixed_lens: 102.5000 | lr: 4.6429e-06 | scale: 2048.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    260/  1000| tot_loss: 3.0826 | rl_loss: 1.2410 | pt_loss: 1.8415 | pg_loss: 0.0662 | reg_loss: 1.1749 | reward: -0.1787 | rev_kl: 0.7191 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6384e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    261/  1000| tot_loss: 3.6193 | rl_loss: 1.7657 | pt_loss: 1.8536 | pg_loss: 0.0707 | reg_loss: 1.6949 | reward: -0.2758 | rev_kl: 1.1100 | stu_lens: 105.5000 | mixed_lens: 128.0000 | lr: 4.6339e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    262/  1000| tot_loss: 3.2355 | rl_loss: 1.4990 | pt_loss: 1.7365 | pg_loss: 0.3104 | reg_loss: 1.1886 | reward: -0.1430 | rev_kl: 0.8083 | stu_lens: 91.5000 | mixed_lens: 96.0000 | lr: 4.6293e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    263/  1000| tot_loss: 4.3544 | rl_loss: 1.8164 | pt_loss: 2.5380 | pg_loss: 0.1827 | reg_loss: 1.6337 | reward: -0.3626 | rev_kl: 1.4356 | stu_lens: 128.0000 | mixed_lens: 117.0000 | lr: 4.6247e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    264/  1000| tot_loss: 3.4124 | rl_loss: 1.4656 | pt_loss: 1.9467 | pg_loss: 0.0557 | reg_loss: 1.4099 | reward: -0.4170 | rev_kl: 1.3910 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6201e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    265/  1000| tot_loss: 2.6865 | rl_loss: 0.9459 | pt_loss: 1.7406 | pg_loss: 0.0689 | reg_loss: 0.8770 | reward: -0.3434 | rev_kl: 1.0283 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6155e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    266/  1000| tot_loss: 3.0676 | rl_loss: 1.2197 | pt_loss: 1.8480 | pg_loss: 0.3372 | reg_loss: 0.8825 | reward: -0.6729 | rev_kl: 0.8345 | stu_lens: 128.0000 | mixed_lens: 79.0000 | lr: 4.6108e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    267/  1000| tot_loss: 2.4717 | rl_loss: 0.7776 | pt_loss: 1.6941 | pg_loss: 0.0695 | reg_loss: 0.7081 | reward: 0.0337 | rev_kl: 0.5260 | stu_lens: 128.0000 | mixed_lens: 117.5000 | lr: 4.6061e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    268/  1000| tot_loss: 3.2703 | rl_loss: 1.6576 | pt_loss: 1.6127 | pg_loss: 0.3760 | reg_loss: 1.2816 | reward: -0.6563 | rev_kl: 1.0494 | stu_lens: 73.5000 | mixed_lens: 76.5000 | lr: 4.6014e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    269/  1000| tot_loss: 2.8565 | rl_loss: 1.0500 | pt_loss: 1.8066 | pg_loss: 0.0485 | reg_loss: 1.0014 | reward: -0.2620 | rev_kl: 0.9719 | stu_lens: 107.0000 | mixed_lens: 128.0000 | lr: 4.5967e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    270/  1000| tot_loss: 2.7753 | rl_loss: 1.2106 | pt_loss: 1.5647 | pg_loss: 0.4084 | reg_loss: 0.8022 | reward: -0.1936 | rev_kl: 0.3966 | stu_lens: 74.5000 | mixed_lens: 74.5000 | lr: 4.5919e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    271/  1000| tot_loss: 2.7151 | rl_loss: 0.7705 | pt_loss: 1.9447 | pg_loss: 0.0365 | reg_loss: 0.7339 | reward: -0.2096 | rev_kl: 0.9269 | stu_lens: 74.0000 | mixed_lens: 128.0000 | lr: 4.5871e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    272/  1000| tot_loss: 2.9104 | rl_loss: 1.1974 | pt_loss: 1.7129 | pg_loss: 0.3365 | reg_loss: 0.8609 | reward: -1.1741 | rev_kl: 1.4476 | stu_lens: 67.0000 | mixed_lens: 67.0000 | lr: 4.5823e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    272/  1000| tot_loss: 2.9772 | rl_loss: 1.1662 | pt_loss: 1.8110 | pg_loss: 0.1716 | reg_loss: 0.9946 | reward: -0.3382 | rev_kl: 0.9361 | stu_lens: 103.6250 | mixed_lens: 106.6875 | lr: 4.5823e-06 | scale: 2048.00 | time: 26.251 | step time: 27.557
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    273/  1000| tot_loss: 2.5115 | rl_loss: 0.9919 | pt_loss: 1.5196 | pg_loss: 0.1045 | reg_loss: 0.8874 | reward: -0.1126 | rev_kl: 0.8689 | stu_lens: 93.0000 | mixed_lens: 113.0000 | lr: 4.5775e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    274/  1000| tot_loss: 2.7067 | rl_loss: 0.8440 | pt_loss: 1.8627 | pg_loss: 0.0231 | reg_loss: 0.8209 | reward: -0.2943 | rev_kl: 1.3319 | stu_lens: 128.0000 | mixed_lens: 117.0000 | lr: 4.5726e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    275/  1000| tot_loss: 4.2223 | rl_loss: 1.9302 | pt_loss: 2.2922 | pg_loss: 1.2102 | reg_loss: 0.7200 | reward: -1.4793 | rev_kl: 1.4526 | stu_lens: 9.5000 | mixed_lens: 30.0000 | lr: 4.5677e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    276/  1000| tot_loss: 2.6706 | rl_loss: 0.6967 | pt_loss: 1.9739 | pg_loss: -0.0258 | reg_loss: 0.7225 | reward: -0.4003 | rev_kl: 0.8265 | stu_lens: 93.5000 | mixed_lens: 128.0000 | lr: 4.5628e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    277/  1000| tot_loss: 2.3762 | rl_loss: 0.6118 | pt_loss: 1.7644 | pg_loss: 0.0595 | reg_loss: 0.5523 | reward: -0.0460 | rev_kl: 0.8011 | stu_lens: 128.0000 | mixed_lens: 113.5000 | lr: 4.5578e-06 | scale: 2048.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    278/  1000| tot_loss: 2.4269 | rl_loss: 0.7926 | pt_loss: 1.6343 | pg_loss: -0.0152 | reg_loss: 0.8078 | reward: -0.2497 | rev_kl: 1.0060 | stu_lens: 103.0000 | mixed_lens: 128.0000 | lr: 4.5529e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    279/  1000| tot_loss: 1.5187 | rl_loss: 0.7189 | pt_loss: 0.7997 | pg_loss: 0.0647 | reg_loss: 0.6542 | reward: -0.1752 | rev_kl: 0.8679 | stu_lens: 92.0000 | mixed_lens: 116.5000 | lr: 4.5479e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    280/  1000| tot_loss: 1.7293 | rl_loss: 0.4064 | pt_loss: 1.3229 | pg_loss: 0.0296 | reg_loss: 0.3768 | reward: -0.1566 | rev_kl: 0.6572 | stu_lens: 128.0000 | mixed_lens: 126.5000 | lr: 4.5429e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    281/  1000| tot_loss: 2.7503 | rl_loss: 0.7992 | pt_loss: 1.9511 | pg_loss: 0.2309 | reg_loss: 0.5682 | reward: -0.1856 | rev_kl: 0.7294 | stu_lens: 123.0000 | mixed_lens: 83.5000 | lr: 4.5378e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    282/  1000| tot_loss: 2.6636 | rl_loss: 0.7267 | pt_loss: 1.9369 | pg_loss: 0.0809 | reg_loss: 0.6458 | reward: -0.1624 | rev_kl: 0.8895 | stu_lens: 101.5000 | mixed_lens: 123.0000 | lr: 4.5328e-06 | scale: 2048.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    283/  1000| tot_loss: 3.3228 | rl_loss: 1.2287 | pt_loss: 2.0941 | pg_loss: 0.4049 | reg_loss: 0.8238 | reward: -1.1438 | rev_kl: 1.1631 | stu_lens: 67.0000 | mixed_lens: 67.0000 | lr: 4.5277e-06 | scale: 2048.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    284/  1000| tot_loss: 2.5072 | rl_loss: 0.7991 | pt_loss: 1.7081 | pg_loss: 0.3216 | reg_loss: 0.4775 | reward: -0.1649 | rev_kl: 0.4465 | stu_lens: 71.5000 | mixed_lens: 74.5000 | lr: 4.5225e-06 | scale: 2048.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    285/  1000| tot_loss: 2.8636 | rl_loss: 0.8186 | pt_loss: 2.0450 | pg_loss: 0.0163 | reg_loss: 0.8023 | reward: -0.3465 | rev_kl: 1.1024 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5174e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    286/  1000| tot_loss: 2.2301 | rl_loss: 0.5181 | pt_loss: 1.7120 | pg_loss: 0.0382 | reg_loss: 0.4800 | reward: -0.1099 | rev_kl: 0.7995 | stu_lens: 73.0000 | mixed_lens: 117.5000 | lr: 4.5122e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    287/  1000| tot_loss: 2.1528 | rl_loss: 0.5520 | pt_loss: 1.6008 | pg_loss: -0.0076 | reg_loss: 0.5596 | reward: -0.2564 | rev_kl: 0.8933 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5070e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    288/  1000| tot_loss: 2.2215 | rl_loss: 0.5723 | pt_loss: 1.6492 | pg_loss: 0.0130 | reg_loss: 0.5593 | reward: -0.2528 | rev_kl: 0.8869 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5018e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    288/  1000| tot_loss: 2.5948 | rl_loss: 0.8299 | pt_loss: 1.7648 | pg_loss: 0.1839 | reg_loss: 0.6460 | reward: -0.3267 | rev_kl: 0.9682 | stu_lens: 101.1250 | mixed_lens: 105.4688 | lr: 4.5018e-06 | scale: 2048.00 | time: 26.251 | step time: 27.547
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    289/  1000| tot_loss: 3.1670 | rl_loss: 1.1999 | pt_loss: 1.9671 | pg_loss: 0.2390 | reg_loss: 0.9609 | reward: -0.2072 | rev_kl: 0.3965 | stu_lens: 78.0000 | mixed_lens: 96.0000 | lr: 4.4966e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    290/  1000| tot_loss: 2.2171 | rl_loss: 0.4644 | pt_loss: 1.7527 | pg_loss: 0.0259 | reg_loss: 0.4385 | reward: -0.2372 | rev_kl: 0.7970 | stu_lens: 126.0000 | mixed_lens: 125.0000 | lr: 4.4913e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    291/  1000| tot_loss: 2.7284 | rl_loss: 0.7410 | pt_loss: 1.9874 | pg_loss: 0.3345 | reg_loss: 0.4065 | reward: -1.5960 | rev_kl: 1.2988 | stu_lens: 68.0000 | mixed_lens: 69.0000 | lr: 4.4860e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    292/  1000| tot_loss: 2.2689 | rl_loss: 0.4455 | pt_loss: 1.8234 | pg_loss: 0.0150 | reg_loss: 0.4305 | reward: -0.2247 | rev_kl: 0.6366 | stu_lens: 110.0000 | mixed_lens: 123.0000 | lr: 4.4807e-06 | scale: 2048.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    293/  1000| tot_loss: 2.3925 | rl_loss: 0.4575 | pt_loss: 1.9350 | pg_loss: -0.0285 | reg_loss: 0.4860 | reward: -0.4234 | rev_kl: 0.8419 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4754e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    294/  1000| tot_loss: 2.7368 | rl_loss: 0.9784 | pt_loss: 1.7584 | pg_loss: 0.2888 | reg_loss: 0.6896 | reward: -0.2463 | rev_kl: 0.7396 | stu_lens: 128.0000 | mixed_lens: 83.5000 | lr: 4.4700e-06 | scale: 2048.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    295/  1000| tot_loss: 2.8042 | rl_loss: 0.8145 | pt_loss: 1.9897 | pg_loss: 0.2030 | reg_loss: 0.6115 | reward: -0.1160 | rev_kl: 1.2975 | stu_lens: 69.5000 | mixed_lens: 89.0000 | lr: 4.4646e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    296/  1000| tot_loss: 2.2586 | rl_loss: 0.4792 | pt_loss: 1.7793 | pg_loss: 0.1533 | reg_loss: 0.3259 | reward: -0.3095 | rev_kl: 1.4789 | stu_lens: 128.0000 | mixed_lens: 110.5000 | lr: 4.4592e-06 | scale: 2048.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    297/  1000| tot_loss: 2.3590 | rl_loss: 0.4927 | pt_loss: 1.8664 | pg_loss: 0.1265 | reg_loss: 0.3662 | reward: -0.2294 | rev_kl: 0.6396 | stu_lens: 105.0000 | mixed_lens: 89.5000 | lr: 4.4538e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    298/  1000| tot_loss: 2.8049 | rl_loss: 0.9126 | pt_loss: 1.8923 | pg_loss: 0.3415 | reg_loss: 0.5710 | reward: -0.0643 | rev_kl: 0.6954 | stu_lens: 125.5000 | mixed_lens: 73.0000 | lr: 4.4483e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    299/  1000| tot_loss: 2.1715 | rl_loss: 0.4135 | pt_loss: 1.7581 | pg_loss: -0.0101 | reg_loss: 0.4235 | reward: -0.1559 | rev_kl: 0.8517 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4429e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
                                 Evaluation #3                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ dime un chiste acerca de la situacion │ dime un chiste acerca de la          │
│ actual de la economia, de modo que    │ situacion actual de la economia, de  │
│ los niños comprendan el mal estado de │ modo que los niños comprendan el mal │
│ la misma.                             │ estado de la misma.                  │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Hoy en día, la economía del mundo se │
│                                       │ ha deteriorado mucho, por lo que     │
│                                       │ muchos niños han tenido que emigrar  │
│                                       │ de sus países, para poder encontrar  │
│                                       │ un lugar donde vivir. Piensa en todo │
│                                       │ el mundo, y dime un chiste que       │
│                                       │ puedas contar a tus hijos para que   │
│                                       │ te entenderan mejor la situación     │
│                                       │ actual de la economía.               │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Sure! Here is another joke:          │
│                                       │                                      │
│                                       │ A kangaroo walks into a bar. The     │
│                                       │ bartender says, "Hey, we don't serve │
│                                       │ kangaroos here." The kangaroo says,  │
│                                       │ "What do you mean, we don't serve    │
│                                       │ kangaroos? I'm a kangaroo!" The      │
│                                       │ bartender says, "You can't come in   │
│                                       │ here. You're drunk." The kangaroo    │
│                                       │ says, "I'm not drunk! I'm a          │
│                                       │ kangaroo!" The bartender says, "Ok   │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Sure! Here is another joke:          │
│                                       │                                      │
│                                       │ An architect, a civil engineer, and  │
│                                       │ a contractor are sitting in a hotel  │
│                                       │ bar. The bartender says to the       │
│                                       │ architect, "Why are there so many    │
│                                       │ different types of screwdrivers?     │
│                                       │ Doesn't it make things more          │
│                                       │ complicated?"                        │
│                                       │                                      │
│                                       │ The architect says, "No, it doesn't  │
│                                       │ make things more complicated. It     │
│                                       │ just makes things different."        │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 15.876 | exact_match: 0.000 | rev_kl: 0.926 | lens: 95.045 | pt_loss: 1.750 | lm_loss: 1.890 | kd_loss: 1.610 
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    300/  1000| tot_loss: 2.3013 | rl_loss: 0.5537 | pt_loss: 1.7476 | pg_loss: 0.0341 | reg_loss: 0.5196 | reward: -0.1464 | rev_kl: 0.7158 | stu_lens: 101.5000 | mixed_lens: 123.0000 | lr: 4.4374e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    301/  1000| tot_loss: 2.3821 | rl_loss: 0.5898 | pt_loss: 1.7923 | pg_loss: 0.0377 | reg_loss: 0.5522 | reward: -0.2404 | rev_kl: 1.1841 | stu_lens: 128.0000 | mixed_lens: 125.5000 | lr: 4.4318e-06 | scale: 2048.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    302/  1000| tot_loss: 2.0257 | rl_loss: 0.6647 | pt_loss: 1.3610 | pg_loss: 0.1471 | reg_loss: 0.5176 | reward: -0.4756 | rev_kl: 1.2602 | stu_lens: 80.5000 | mixed_lens: 97.5000 | lr: 4.4263e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    303/  1000| tot_loss: 2.2323 | rl_loss: 0.5111 | pt_loss: 1.7212 | pg_loss: 0.0139 | reg_loss: 0.4972 | reward: -0.2064 | rev_kl: 0.8072 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4207e-06 | scale: 2048.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    304/  1000| tot_loss: 1.8101 | rl_loss: 0.6610 | pt_loss: 1.1491 | pg_loss: 0.1642 | reg_loss: 0.4968 | reward: -0.1839 | rev_kl: 0.7654 | stu_lens: 91.5000 | mixed_lens: 96.0000 | lr: 4.4151e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    304/  1000| tot_loss: 2.3720 | rl_loss: 0.6244 | pt_loss: 1.7476 | pg_loss: 0.1320 | reg_loss: 0.4924 | reward: -0.2933 | rev_kl: 0.8867 | stu_lens: 105.5781 | mixed_lens: 107.2344 | lr: 4.4151e-06 | scale: 2048.00 | time: 26.266 | step time: 27.548
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    305/  1000| tot_loss: 2.1821 | rl_loss: 0.4424 | pt_loss: 1.7397 | pg_loss: 0.1207 | reg_loss: 0.3217 | reward: -1.2185 | rev_kl: 1.5992 | stu_lens: 30.0000 | mixed_lens: 57.0000 | lr: 4.4095e-06 | scale: 2048.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    306/  1000| tot_loss: 1.9687 | rl_loss: 0.4326 | pt_loss: 1.5361 | pg_loss: 0.0160 | reg_loss: 0.4167 | reward: -0.2219 | rev_kl: 0.9020 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4038e-06 | scale: 2048.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    307/  1000| tot_loss: 3.2121 | rl_loss: 1.4188 | pt_loss: 1.7933 | pg_loss: 0.9652 | reg_loss: 0.4536 | reward: -0.5242 | rev_kl: 1.0580 | stu_lens: 15.0000 | mixed_lens: 37.5000 | lr: 4.3982e-06 | scale: 2048.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    308/  1000| tot_loss: 2.7215 | rl_loss: 1.0170 | pt_loss: 1.7044 | pg_loss: 0.6959 | reg_loss: 0.3211 | reward: -0.6811 | rev_kl: 0.7717 | stu_lens: 125.5000 | mixed_lens: 34.5000 | lr: 4.3925e-06 | scale: 2048.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    309/  1000| tot_loss: 2.1357 | rl_loss: 0.4768 | pt_loss: 1.6590 | pg_loss: 0.0656 | reg_loss: 0.4112 | reward: -0.3216 | rev_kl: 1.6610 | stu_lens: 128.0000 | mixed_lens: 112.0000 | lr: 4.3868e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    310/  1000| tot_loss: 1.9519 | rl_loss: 0.3769 | pt_loss: 1.5749 | pg_loss: -0.0405 | reg_loss: 0.4175 | reward: -0.1187 | rev_kl: 0.6968 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3810e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    311/  1000| tot_loss: 1.6783 | rl_loss: 0.3997 | pt_loss: 1.2786 | pg_loss: 0.0424 | reg_loss: 0.3573 | reward: -0.1557 | rev_kl: 0.9446 | stu_lens: 101.5000 | mixed_lens: 123.0000 | lr: 4.3753e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    312/  1000| tot_loss: 2.3100 | rl_loss: 0.7643 | pt_loss: 1.5457 | pg_loss: 0.1525 | reg_loss: 0.6118 | reward: -0.2710 | rev_kl: 1.0849 | stu_lens: 91.5000 | mixed_lens: 93.5000 | lr: 4.3695e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    313/  1000| tot_loss: 2.2048 | rl_loss: 0.6555 | pt_loss: 1.5493 | pg_loss: 0.2377 | reg_loss: 0.4179 | reward: -0.1933 | rev_kl: 0.9472 | stu_lens: 82.0000 | mixed_lens: 96.5000 | lr: 4.3637e-06 | scale: 2048.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    314/  1000| tot_loss: 2.2356 | rl_loss: 0.3347 | pt_loss: 1.9009 | pg_loss: -0.0166 | reg_loss: 0.3513 | reward: -0.2626 | rev_kl: 0.8142 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3579e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    315/  1000| tot_loss: 2.4606 | rl_loss: 0.4224 | pt_loss: 2.0382 | pg_loss: -0.0250 | reg_loss: 0.4474 | reward: -0.1232 | rev_kl: 1.2248 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3520e-06 | scale: 2048.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    316/  1000| tot_loss: 1.7260 | rl_loss: 0.3795 | pt_loss: 1.3465 | pg_loss: 0.0211 | reg_loss: 0.3584 | reward: -0.2543 | rev_kl: 0.9485 | stu_lens: 107.0000 | mixed_lens: 126.5000 | lr: 4.3461e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    317/  1000| tot_loss: 1.8336 | rl_loss: 0.3085 | pt_loss: 1.5251 | pg_loss: -0.0033 | reg_loss: 0.3118 | reward: -0.1874 | rev_kl: 0.8060 | stu_lens: 79.0000 | mixed_lens: 128.0000 | lr: 4.3402e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    318/  1000| tot_loss: 2.5824 | rl_loss: 0.5511 | pt_loss: 2.0313 | pg_loss: 0.1072 | reg_loss: 0.4439 | reward: -0.2037 | rev_kl: 0.9501 | stu_lens: 127.0000 | mixed_lens: 117.0000 | lr: 4.3343e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    319/  1000| tot_loss: 2.3845 | rl_loss: 0.3052 | pt_loss: 2.0793 | pg_loss: 0.0439 | reg_loss: 0.2613 | reward: -0.2407 | rev_kl: 0.8355 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 4.3284e-06 | scale: 2048.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    320/  1000| tot_loss: 1.7478 | rl_loss: 0.4493 | pt_loss: 1.2984 | pg_loss: -0.0044 | reg_loss: 0.4537 | reward: -0.2034 | rev_kl: 0.6644 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3224e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    320/  1000| tot_loss: 2.2443 | rl_loss: 0.5251 | pt_loss: 1.7192 | pg_loss: 0.1369 | reg_loss: 0.3882 | reward: -0.3650 | rev_kl: 0.9933 | stu_lens: 99.8750 | mixed_lens: 105.7188 | lr: 4.3224e-06 | scale: 2048.00 | time: 26.290 | step time: 27.538
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    321/  1000| tot_loss: 1.9456 | rl_loss: 0.6253 | pt_loss: 1.3203 | pg_loss: 0.0291 | reg_loss: 0.5961 | reward: -0.2097 | rev_kl: 0.6192 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3164e-06 | scale: 2048.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    322/  1000| tot_loss: 4.0455 | rl_loss: 2.7867 | pt_loss: 1.2587 | pg_loss: 0.6980 | reg_loss: 2.0887 | reward: -0.6612 | rev_kl: 0.6013 | stu_lens: 69.5000 | mixed_lens: 70.0000 | lr: 4.3104e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    323/  1000| tot_loss: 2.4614 | rl_loss: 0.9844 | pt_loss: 1.4770 | pg_loss: 0.0450 | reg_loss: 0.9394 | reward: -0.3008 | rev_kl: 0.7284 | stu_lens: 92.5000 | mixed_lens: 128.0000 | lr: 4.3044e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    324/  1000| tot_loss: 3.1513 | rl_loss: 1.0767 | pt_loss: 2.0746 | pg_loss: 0.2811 | reg_loss: 0.7956 | reward: -0.3286 | rev_kl: 0.6229 | stu_lens: 98.0000 | mixed_lens: 90.5000 | lr: 4.2983e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    325/  1000| tot_loss: 2.7189 | rl_loss: 1.3279 | pt_loss: 1.3910 | pg_loss: 0.3850 | reg_loss: 0.9429 | reward: -0.2936 | rev_kl: 0.7296 | stu_lens: 82.0000 | mixed_lens: 84.5000 | lr: 4.2923e-06 | scale: 2048.00 | time: 26.317 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    326/  1000| tot_loss: 4.4632 | rl_loss: 2.4807 | pt_loss: 1.9825 | pg_loss: 1.3559 | reg_loss: 1.1248 | reward: -1.0829 | rev_kl: 1.4008 | stu_lens: 82.5000 | mixed_lens: 44.0000 | lr: 4.2862e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    327/  1000| tot_loss: 2.6046 | rl_loss: 0.9998 | pt_loss: 1.6047 | pg_loss: 0.1807 | reg_loss: 0.8191 | reward: -0.1896 | rev_kl: 1.3508 | stu_lens: 88.0000 | mixed_lens: 111.5000 | lr: 4.2801e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    328/  1000| tot_loss: 3.3757 | rl_loss: 1.4169 | pt_loss: 1.9588 | pg_loss: 0.2781 | reg_loss: 1.1388 | reward: -0.4434 | rev_kl: 0.7932 | stu_lens: 99.5000 | mixed_lens: 86.0000 | lr: 4.2739e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    329/  1000| tot_loss: 3.2103 | rl_loss: 1.3791 | pt_loss: 1.8312 | pg_loss: 0.3042 | reg_loss: 1.0749 | reward: -0.9113 | rev_kl: 0.4570 | stu_lens: 38.0000 | mixed_lens: 84.0000 | lr: 4.2678e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    330/  1000| tot_loss: 2.6487 | rl_loss: 0.8792 | pt_loss: 1.7695 | pg_loss: 0.0426 | reg_loss: 0.8366 | reward: -0.1054 | rev_kl: 0.7358 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.2616e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    331/  1000| tot_loss: 2.8289 | rl_loss: 1.2950 | pt_loss: 1.5340 | pg_loss: 0.1704 | reg_loss: 1.1245 | reward: -0.2267 | rev_kl: 0.6111 | stu_lens: 128.0000 | mixed_lens: 106.0000 | lr: 4.2554e-06 | scale: 2048.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    332/  1000| tot_loss: 3.3695 | rl_loss: 1.3453 | pt_loss: 2.0242 | pg_loss: 0.0844 | reg_loss: 1.2609 | reward: -0.1622 | rev_kl: 0.7355 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.2492e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    333/  1000| tot_loss: 2.4787 | rl_loss: 0.7470 | pt_loss: 1.7317 | pg_loss: 0.1790 | reg_loss: 0.5680 | reward: -0.5426 | rev_kl: 1.0649 | stu_lens: 128.0000 | mixed_lens: 85.0000 | lr: 4.2429e-06 | scale: 2048.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    334/  1000| tot_loss: 5.1786 | rl_loss: 3.5203 | pt_loss: 1.6583 | pg_loss: 2.1183 | reg_loss: 1.4021 | reward: -0.1687 | rev_kl: 0.5708 | stu_lens: 27.5000 | mixed_lens: 15.0000 | lr: 4.2366e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    335/  1000| tot_loss: 2.7618 | rl_loss: 0.7343 | pt_loss: 2.0275 | pg_loss: 0.0843 | reg_loss: 0.6499 | reward: -0.2328 | rev_kl: 0.7773 | stu_lens: 128.0000 | mixed_lens: 97.0000 | lr: 4.2304e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    336/  1000| tot_loss: 2.0643 | rl_loss: 0.9163 | pt_loss: 1.1480 | pg_loss: 0.0641 | reg_loss: 0.8522 | reward: -0.3659 | rev_kl: 1.1724 | stu_lens: 96.0000 | mixed_lens: 83.0000 | lr: 4.2240e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    336/  1000| tot_loss: 3.0044 | rl_loss: 1.3179 | pt_loss: 1.6865 | pg_loss: 0.3634 | reg_loss: 0.9546 | reward: -0.3467 | rev_kl: 0.8997 | stu_lens: 96.0156 | mixed_lens: 91.2031 | lr: 4.2240e-06 | scale: 2048.00 | time: 26.264 | step time: 27.564
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    337/  1000| tot_loss: 1.9764 | rl_loss: 0.7406 | pt_loss: 1.2358 | pg_loss: 0.0739 | reg_loss: 0.6667 | reward: -0.1709 | rev_kl: 0.8568 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.2177e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    338/  1000| tot_loss: 3.2158 | rl_loss: 1.3963 | pt_loss: 1.8195 | pg_loss: 0.6744 | reg_loss: 0.7219 | reward: -1.5447 | rev_kl: 0.7487 | stu_lens: 88.5000 | mixed_lens: 27.5000 | lr: 4.2114e-06 | scale: 2048.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    339/  1000| tot_loss: 2.5651 | rl_loss: 0.4704 | pt_loss: 2.0947 | pg_loss: -0.0294 | reg_loss: 0.4998 | reward: -0.3301 | rev_kl: 0.9338 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.2050e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    340/  1000| tot_loss: 2.9586 | rl_loss: 1.0047 | pt_loss: 1.9539 | pg_loss: 0.5130 | reg_loss: 0.4917 | reward: -0.2914 | rev_kl: 0.8174 | stu_lens: 128.0000 | mixed_lens: 81.0000 | lr: 4.1986e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    341/  1000| tot_loss: 2.4193 | rl_loss: 0.9510 | pt_loss: 1.4683 | pg_loss: 0.2321 | reg_loss: 0.7189 | reward: -0.2235 | rev_kl: 0.9137 | stu_lens: 126.5000 | mixed_lens: 102.5000 | lr: 4.1922e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    342/  1000| tot_loss: 2.3731 | rl_loss: 0.4117 | pt_loss: 1.9615 | pg_loss: 0.0171 | reg_loss: 0.3946 | reward: -0.3321 | rev_kl: 1.0292 | stu_lens: 96.0000 | mixed_lens: 91.0000 | lr: 4.1858e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    343/  1000| tot_loss: 2.6305 | rl_loss: 0.8120 | pt_loss: 1.8185 | pg_loss: 0.2332 | reg_loss: 0.5788 | reward: -0.3775 | rev_kl: 0.3340 | stu_lens: 67.5000 | mixed_lens: 73.0000 | lr: 4.1793e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    344/  1000| tot_loss: 2.8062 | rl_loss: 0.8636 | pt_loss: 1.9426 | pg_loss: 0.0236 | reg_loss: 0.8400 | reward: -0.1659 | rev_kl: 0.3624 | stu_lens: 100.0000 | mixed_lens: 128.0000 | lr: 4.1728e-06 | scale: 2048.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    345/  1000| tot_loss: 2.8359 | rl_loss: 1.2567 | pt_loss: 1.5791 | pg_loss: 0.4937 | reg_loss: 0.7630 | reward: -0.5944 | rev_kl: 0.9296 | stu_lens: 128.0000 | mixed_lens: 63.0000 | lr: 4.1663e-06 | scale: 2048.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    346/  1000| tot_loss: 2.4825 | rl_loss: 0.9232 | pt_loss: 1.5593 | pg_loss: 0.1058 | reg_loss: 0.8174 | reward: -0.2210 | rev_kl: 0.9797 | stu_lens: 125.0000 | mixed_lens: 111.5000 | lr: 4.1598e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    347/  1000| tot_loss: 2.3828 | rl_loss: 0.8064 | pt_loss: 1.5763 | pg_loss: 0.1062 | reg_loss: 0.7002 | reward: -0.2093 | rev_kl: 0.7909 | stu_lens: 128.0000 | mixed_lens: 112.0000 | lr: 4.1533e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    348/  1000| tot_loss: 1.8160 | rl_loss: 0.6718 | pt_loss: 1.1443 | pg_loss: 0.0922 | reg_loss: 0.5796 | reward: -0.1945 | rev_kl: 0.9520 | stu_lens: 128.0000 | mixed_lens: 97.0000 | lr: 4.1467e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    349/  1000| tot_loss: 2.1365 | rl_loss: 0.5522 | pt_loss: 1.5843 | pg_loss: 0.0019 | reg_loss: 0.5503 | reward: -0.2059 | rev_kl: 0.8818 | stu_lens: 128.0000 | mixed_lens: 120.0000 | lr: 4.1401e-06 | scale: 2048.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    350/  1000| tot_loss: 2.4138 | rl_loss: 0.7412 | pt_loss: 1.6727 | pg_loss: 0.0442 | reg_loss: 0.6970 | reward: -0.0829 | rev_kl: 1.0015 | stu_lens: 92.5000 | mixed_lens: 128.0000 | lr: 4.1336e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    351/  1000| tot_loss: 2.1548 | rl_loss: 0.6334 | pt_loss: 1.5214 | pg_loss: 0.0717 | reg_loss: 0.5617 | reward: -0.2116 | rev_kl: 0.7306 | stu_lens: 96.0000 | mixed_lens: 120.5000 | lr: 4.1269e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    352/  1000| tot_loss: 2.8946 | rl_loss: 1.0663 | pt_loss: 1.8283 | pg_loss: 0.3852 | reg_loss: 0.6811 | reward: -0.8027 | rev_kl: 0.5559 | stu_lens: 37.5000 | mixed_lens: 70.5000 | lr: 4.1203e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    352/  1000| tot_loss: 2.5314 | rl_loss: 0.9051 | pt_loss: 1.6263 | pg_loss: 0.2539 | reg_loss: 0.6512 | reward: -0.3351 | rev_kl: 0.8195 | stu_lens: 98.5781 | mixed_lens: 94.2812 | lr: 4.1203e-06 | scale: 2048.00 | time: 26.266 | step time: 27.558
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    353/  1000| tot_loss: 2.2728 | rl_loss: 0.4621 | pt_loss: 1.8107 | pg_loss: 0.0099 | reg_loss: 0.4522 | reward: -0.1041 | rev_kl: 0.6785 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1136e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    354/  1000| tot_loss: 2.7866 | rl_loss: 0.6518 | pt_loss: 2.1348 | pg_loss: 0.1853 | reg_loss: 0.4665 | reward: -0.1657 | rev_kl: 0.8781 | stu_lens: 92.5000 | mixed_lens: 106.0000 | lr: 4.1070e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    355/  1000| tot_loss: 2.3491 | rl_loss: 0.4451 | pt_loss: 1.9040 | pg_loss: 0.0325 | reg_loss: 0.4126 | reward: -0.1594 | rev_kl: 0.7872 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1003e-06 | scale: 2048.00 | time: 26.315 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    356/  1000| tot_loss: 2.5087 | rl_loss: 0.9336 | pt_loss: 1.5752 | pg_loss: 0.4676 | reg_loss: 0.4660 | reward: -0.5171 | rev_kl: 0.8726 | stu_lens: 66.5000 | mixed_lens: 53.5000 | lr: 4.0936e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    357/  1000| tot_loss: 2.2707 | rl_loss: 0.8050 | pt_loss: 1.4656 | pg_loss: 0.4004 | reg_loss: 0.4047 | reward: -0.0946 | rev_kl: 0.5164 | stu_lens: 50.0000 | mixed_lens: 43.0000 | lr: 4.0868e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    358/  1000| tot_loss: 2.6875 | rl_loss: 0.8420 | pt_loss: 1.8456 | pg_loss: 0.2128 | reg_loss: 0.6291 | reward: -0.2597 | rev_kl: 0.8507 | stu_lens: 128.0000 | mixed_lens: 106.0000 | lr: 4.0801e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    359/  1000| tot_loss: 2.9668 | rl_loss: 0.8280 | pt_loss: 2.1388 | pg_loss: 0.4372 | reg_loss: 0.3908 | reward: -0.1693 | rev_kl: 0.7767 | stu_lens: 40.0000 | mixed_lens: 64.5000 | lr: 4.0733e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    360/  1000| tot_loss: 2.0431 | rl_loss: 0.2777 | pt_loss: 1.7654 | pg_loss: -0.0016 | reg_loss: 0.2794 | reward: -0.3074 | rev_kl: 0.8763 | stu_lens: 128.0000 | mixed_lens: 120.0000 | lr: 4.0665e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    361/  1000| tot_loss: 2.9690 | rl_loss: 1.3541 | pt_loss: 1.6148 | pg_loss: 0.6487 | reg_loss: 0.7055 | reward: -0.3954 | rev_kl: 1.2045 | stu_lens: 100.0000 | mixed_lens: 59.5000 | lr: 4.0597e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    362/  1000| tot_loss: 2.3024 | rl_loss: 0.4318 | pt_loss: 1.8706 | pg_loss: -0.0149 | reg_loss: 0.4467 | reward: -0.0730 | rev_kl: 0.9663 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.0529e-06 | scale: 2048.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    363/  1000| tot_loss: 2.6445 | rl_loss: 0.5983 | pt_loss: 2.0462 | pg_loss: 0.1015 | reg_loss: 0.4968 | reward: -0.2487 | rev_kl: 0.8821 | stu_lens: 94.0000 | mixed_lens: 112.0000 | lr: 4.0460e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    364/  1000| tot_loss: 2.6527 | rl_loss: 0.8038 | pt_loss: 1.8488 | pg_loss: 0.4021 | reg_loss: 0.4018 | reward: -0.3900 | rev_kl: 0.7013 | stu_lens: 128.0000 | mixed_lens: 81.0000 | lr: 4.0392e-06 | scale: 2048.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    365/  1000| tot_loss: 2.9343 | rl_loss: 1.0208 | pt_loss: 1.9135 | pg_loss: 0.1192 | reg_loss: 0.9016 | reward: -0.4667 | rev_kl: 0.7476 | stu_lens: 126.5000 | mixed_lens: 118.5000 | lr: 4.0323e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    366/  1000| tot_loss: 2.7227 | rl_loss: 0.9087 | pt_loss: 1.8140 | pg_loss: 0.3266 | reg_loss: 0.5820 | reward: 0.3355 | rev_kl: 0.7318 | stu_lens: 84.0000 | mixed_lens: 72.5000 | lr: 4.0254e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    367/  1000| tot_loss: 1.4934 | rl_loss: 0.4740 | pt_loss: 1.0194 | pg_loss: 0.0135 | reg_loss: 0.4606 | reward: -0.2050 | rev_kl: 1.0332 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.0184e-06 | scale: 2048.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    368/  1000| tot_loss: 2.6216 | rl_loss: 0.5440 | pt_loss: 2.0776 | pg_loss: 0.0263 | reg_loss: 0.5177 | reward: -0.2131 | rev_kl: 0.5363 | stu_lens: 104.5000 | mixed_lens: 128.0000 | lr: 4.0115e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    368/  1000| tot_loss: 2.5262 | rl_loss: 0.7286 | pt_loss: 1.7976 | pg_loss: 0.2261 | reg_loss: 0.5025 | reward: -0.3596 | rev_kl: 1.0119 | stu_lens: 98.2656 | mixed_lens: 93.4375 | lr: 4.0115e-06 | scale: 2048.00 | time: 26.264 | step time: 27.556
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    369/  1000| tot_loss: 1.8839 | rl_loss: 0.5671 | pt_loss: 1.3167 | pg_loss: 0.1122 | reg_loss: 0.4550 | reward: -0.0824 | rev_kl: 1.2031 | stu_lens: 112.5000 | mixed_lens: 111.5000 | lr: 4.0045e-06 | scale: 2048.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    370/  1000| tot_loss: 3.0362 | rl_loss: 1.2388 | pt_loss: 1.7974 | pg_loss: 0.7362 | reg_loss: 0.5026 | reward: -0.4010 | rev_kl: 1.1973 | stu_lens: 54.0000 | mixed_lens: 53.5000 | lr: 3.9976e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    371/  1000| tot_loss: 2.0621 | rl_loss: 0.3044 | pt_loss: 1.7577 | pg_loss: 0.0082 | reg_loss: 0.2962 | reward: -0.1716 | rev_kl: 0.4796 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.9906e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    372/  1000| tot_loss: 2.6457 | rl_loss: 0.7950 | pt_loss: 1.8507 | pg_loss: 0.3903 | reg_loss: 0.4047 | reward: -0.5100 | rev_kl: 0.9470 | stu_lens: 99.0000 | mixed_lens: 85.0000 | lr: 3.9835e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    373/  1000| tot_loss: 3.0126 | rl_loss: 0.9605 | pt_loss: 2.0521 | pg_loss: 0.4962 | reg_loss: 0.4643 | reward: -0.3934 | rev_kl: 0.4979 | stu_lens: 67.5000 | mixed_lens: 73.0000 | lr: 3.9765e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    374/  1000| tot_loss: 2.2681 | rl_loss: 0.4368 | pt_loss: 1.8312 | pg_loss: -0.0358 | reg_loss: 0.4727 | reward: -0.1200 | rev_kl: 0.8005 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.9695e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    375/  1000| tot_loss: 1.9271 | rl_loss: 0.3814 | pt_loss: 1.5457 | pg_loss: 0.0320 | reg_loss: 0.3494 | reward: -0.0545 | rev_kl: 0.9316 | stu_lens: 60.5000 | mixed_lens: 120.5000 | lr: 3.9624e-06 | scale: 2048.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    376/  1000| tot_loss: 2.7182 | rl_loss: 0.6041 | pt_loss: 2.1141 | pg_loss: 0.2347 | reg_loss: 0.3694 | reward: -0.1970 | rev_kl: 0.8789 | stu_lens: 109.0000 | mixed_lens: 98.5000 | lr: 3.9553e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    377/  1000| tot_loss: 2.2988 | rl_loss: 0.5935 | pt_loss: 1.7054 | pg_loss: 0.0775 | reg_loss: 0.5160 | reward: -0.2247 | rev_kl: 0.6066 | stu_lens: 97.0000 | mixed_lens: 111.5000 | lr: 3.9482e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    378/  1000| tot_loss: 1.7675 | rl_loss: 0.1090 | pt_loss: 1.6585 | pg_loss: -0.0425 | reg_loss: 0.1516 | reward: -0.2443 | rev_kl: 0.9779 | stu_lens: 73.0000 | mixed_lens: 71.5000 | lr: 3.9411e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    379/  1000| tot_loss: 2.3184 | rl_loss: 0.7866 | pt_loss: 1.5318 | pg_loss: 0.4110 | reg_loss: 0.3756 | reward: -0.4075 | rev_kl: 0.9008 | stu_lens: 76.0000 | mixed_lens: 61.5000 | lr: 3.9339e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    380/  1000| tot_loss: 1.8547 | rl_loss: 0.3143 | pt_loss: 1.5404 | pg_loss: -0.0003 | reg_loss: 0.3146 | reward: -0.1923 | rev_kl: 0.7845 | stu_lens: 128.0000 | mixed_lens: 120.0000 | lr: 3.9268e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    381/  1000| tot_loss: 1.9418 | rl_loss: 0.4839 | pt_loss: 1.4579 | pg_loss: -0.0105 | reg_loss: 0.4944 | reward: -0.1493 | rev_kl: 0.8961 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.9196e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    382/  1000| tot_loss: 3.5173 | rl_loss: 1.7837 | pt_loss: 1.7336 | pg_loss: 1.2780 | reg_loss: 0.5057 | reward: -0.6087 | rev_kl: 1.1840 | stu_lens: 26.5000 | mixed_lens: 30.5000 | lr: 3.9124e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    383/  1000| tot_loss: 1.8643 | rl_loss: 0.3178 | pt_loss: 1.5466 | pg_loss: -0.0093 | reg_loss: 0.3271 | reward: -0.1199 | rev_kl: 0.9404 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.9052e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    384/  1000| tot_loss: 1.9431 | rl_loss: 0.3900 | pt_loss: 1.5531 | pg_loss: -0.0094 | reg_loss: 0.3995 | reward: -0.2636 | rev_kl: 0.8644 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8980e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    384/  1000| tot_loss: 2.4253 | rl_loss: 0.7085 | pt_loss: 1.7168 | pg_loss: 0.2865 | reg_loss: 0.4220 | reward: -0.3455 | rev_kl: 0.9241 | stu_lens: 96.0781 | mixed_lens: 90.9844 | lr: 3.8980e-06 | scale: 2048.00 | time: 26.236 | step time: 27.551
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    385/  1000| tot_loss: 2.3873 | rl_loss: 0.4875 | pt_loss: 1.8998 | pg_loss: 0.0386 | reg_loss: 0.4489 | reward: -0.3254 | rev_kl: 0.7315 | stu_lens: 103.0000 | mixed_lens: 118.5000 | lr: 3.8907e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    386/  1000| tot_loss: 2.8813 | rl_loss: 0.8789 | pt_loss: 2.0024 | pg_loss: 0.0626 | reg_loss: 0.8164 | reward: -0.0861 | rev_kl: 0.9883 | stu_lens: 111.5000 | mixed_lens: 128.0000 | lr: 3.8835e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    387/  1000| tot_loss: 2.5043 | rl_loss: 0.9205 | pt_loss: 1.5838 | pg_loss: 0.0967 | reg_loss: 0.8238 | reward: -0.0202 | rev_kl: 1.0336 | stu_lens: 128.0000 | mixed_lens: 116.0000 | lr: 3.8762e-06 | scale: 2048.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    388/  1000| tot_loss: 2.5361 | rl_loss: 0.9515 | pt_loss: 1.5846 | pg_loss: 0.0716 | reg_loss: 0.8799 | reward: -0.1475 | rev_kl: 0.9965 | stu_lens: 128.0000 | mixed_lens: 125.5000 | lr: 3.8689e-06 | scale: 2048.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    389/  1000| tot_loss: 3.4187 | rl_loss: 1.2693 | pt_loss: 2.1494 | pg_loss: 0.3564 | reg_loss: 0.9129 | reward: -0.3379 | rev_kl: 0.8266 | stu_lens: 100.5000 | mixed_lens: 91.0000 | lr: 3.8616e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    390/  1000| tot_loss: 2.8577 | rl_loss: 0.9334 | pt_loss: 1.9243 | pg_loss: 0.1594 | reg_loss: 0.7739 | reward: -0.2336 | rev_kl: 0.6499 | stu_lens: 88.5000 | mixed_lens: 82.5000 | lr: 3.8543e-06 | scale: 2048.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    391/  1000| tot_loss: 3.2255 | rl_loss: 1.4018 | pt_loss: 1.8236 | pg_loss: 0.2849 | reg_loss: 1.1169 | reward: -0.4273 | rev_kl: 1.0369 | stu_lens: 128.0000 | mixed_lens: 81.0000 | lr: 3.8469e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    392/  1000| tot_loss: 2.9382 | rl_loss: 1.2487 | pt_loss: 1.6895 | pg_loss: 0.0707 | reg_loss: 1.1779 | reward: -0.1973 | rev_kl: 1.0680 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8396e-06 | scale: 2048.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    393/  1000| tot_loss: 2.8475 | rl_loss: 0.9846 | pt_loss: 1.8629 | pg_loss: 0.1267 | reg_loss: 0.8579 | reward: -0.2579 | rev_kl: 0.8915 | stu_lens: 128.0000 | mixed_lens: 117.5000 | lr: 3.8322e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    394/  1000| tot_loss: 2.9502 | rl_loss: 1.2298 | pt_loss: 1.7203 | pg_loss: 0.1669 | reg_loss: 1.0629 | reward: -0.1247 | rev_kl: 0.7607 | stu_lens: 118.0000 | mixed_lens: 113.5000 | lr: 3.8248e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    395/  1000| tot_loss: 3.1391 | rl_loss: 1.3413 | pt_loss: 1.7978 | pg_loss: 0.1830 | reg_loss: 1.1583 | reward: -0.1992 | rev_kl: 0.7998 | stu_lens: 128.0000 | mixed_lens: 73.0000 | lr: 3.8174e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    396/  1000| tot_loss: 2.5360 | rl_loss: 0.9631 | pt_loss: 1.5729 | pg_loss: 0.0579 | reg_loss: 0.9052 | reward: -0.2816 | rev_kl: 1.0329 | stu_lens: 94.0000 | mixed_lens: 125.5000 | lr: 3.8100e-06 | scale: 2048.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    397/  1000| tot_loss: 3.2549 | rl_loss: 1.3471 | pt_loss: 1.9078 | pg_loss: 0.3544 | reg_loss: 0.9926 | reward: -0.1653 | rev_kl: 0.8210 | stu_lens: 128.0000 | mixed_lens: 105.0000 | lr: 3.8025e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    398/  1000| tot_loss: 2.8566 | rl_loss: 1.0664 | pt_loss: 1.7902 | pg_loss: 0.0677 | reg_loss: 0.9986 | reward: -0.0830 | rev_kl: 0.7487 | stu_lens: 118.5000 | mixed_lens: 121.0000 | lr: 3.7951e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    399/  1000| tot_loss: 2.8504 | rl_loss: 1.1889 | pt_loss: 1.6615 | pg_loss: 0.0848 | reg_loss: 1.1041 | reward: -0.2606 | rev_kl: 1.1034 | stu_lens: 97.5000 | mixed_lens: 118.0000 | lr: 3.7876e-06 | scale: 2048.00 | time: 26.229 | step time: 0.000
                                 Evaluation #4                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ dime un chiste acerca de la situacion │ dime un chiste acerca de la          │
│ actual de la economia, de modo que    │ situacion actual de la economia, de  │
│ los niños comprendan el mal estado de │ modo que los niños comprendan el mal │
│ la misma.                             │ estado de la misma.                  │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Hace mucho tiempo, la gente vivía de │
│                                       │ manera sencilla y con poco esfuerzo, │
│                                       │ por lo general dedicando el tiempo   │
│                                       │ que tenía libre a pasatiempos y      │
│                                       │ diversiones. Ahora, debido a la      │
│                                       │ crisis mundial, la gente está        │
│                                       │ duramente trabajando para subsistir, │
│                                       │ dedicando gran parte de su tiempo    │
│                                       │ libre a la economia, y solo          │
│                                       │ disponiendo de unos cuantos momentos │
│                                       │ para disfrutar de la vida.           │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ De acuerdo. Una vez, cuando era      │
│                                       │ niño, jugaba al fútbol americano en  │
│                                       │ el campo de mi escuela. Era un día   │
│                                       │ brillante y el entrenador nos hizo   │
│                                       │ una petición: dejar que los aviones  │
│                                       │ de la Fuerza Aérea que estaban       │
│                                       │ sobrevolando la cancha nos dieran un │
│                                       │ festín de humo a causa de los vuelos │
│                                       │ de prácticas. Poco después, el       │
│                                       │ entrenador les dijo a los jugadores  │
│                                       │ que el experimento había terminado y │
│                                       │ que salieran del campo. Uno de los   │
│                                       │ jugadores, que estaba parecido       │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Sí, otro chiste es:                  │
│                                       │                                      │
│                                       │ Un hombre entra en una tienda de     │
│                                       │ lujo y compró un robot que puede     │
│                                       │ lidiar con la limpieza.              │
│                                       │ Regresó a su casa y ordenó al robot  │
│                                       │ que limpie la casa.                  │
│                                       │ El robot comenzó a limpiar la casa y │
│                                       │ terminó en la cocina.                │
│                                       │ El hombre le preguntó al robot que   │
│                                       │ hacía ahí.                           │
│                                       │ El robot respondió: "Estoy           │
│                                       │ cocinando".                          │
│                                       │ El hombre le preguntó al robot que   │
│                                       │ preparaba.                           │
│                                       │ El robot respondió: "Estoy coc       │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.108 | exact_match: 0.103 | rev_kl: 0.858 | lens: 102.069 | pt_loss: 1.748 | lm_loss: 1.884 | kd_loss: 1.611 
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    400/  1000| tot_loss: 2.9134 | rl_loss: 1.0509 | pt_loss: 1.8625 | pg_loss: 0.0483 | reg_loss: 1.0026 | reward: -0.0873 | rev_kl: 5.3428 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7801e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    400/  1000| tot_loss: 2.8838 | rl_loss: 1.1652 | pt_loss: 1.7186 | pg_loss: 0.2157 | reg_loss: 0.9494 | reward: -0.4404 | rev_kl: 1.1292 | stu_lens: 103.0469 | mixed_lens: 97.2031 | lr: 3.7801e-06 | scale: 2048.00 | time: 26.276 | step time: 27.511
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    401/  1000| tot_loss: 2.1221 | rl_loss: 1.0872 | pt_loss: 1.0349 | pg_loss: 0.0305 | reg_loss: 1.0567 | reward: -0.3116 | rev_kl: 0.8973 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7726e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    402/  1000| tot_loss: 2.6881 | rl_loss: 0.5369 | pt_loss: 2.1511 | pg_loss: 0.0351 | reg_loss: 0.5018 | reward: -0.1552 | rev_kl: 0.8630 | stu_lens: 128.0000 | mixed_lens: 114.0000 | lr: 3.7651e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    403/  1000| tot_loss: 2.4868 | rl_loss: 0.6632 | pt_loss: 1.8236 | pg_loss: -0.0128 | reg_loss: 0.6760 | reward: -0.1794 | rev_kl: 0.8972 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7575e-06 | scale: 2048.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    404/  1000| tot_loss: 3.0122 | rl_loss: 0.9524 | pt_loss: 2.0598 | pg_loss: 0.1421 | reg_loss: 0.8102 | reward: -0.1209 | rev_kl: 0.8161 | stu_lens: 128.0000 | mixed_lens: 103.0000 | lr: 3.7500e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    405/  1000| tot_loss: 2.3486 | rl_loss: 0.5640 | pt_loss: 1.7846 | pg_loss: 0.0588 | reg_loss: 0.5052 | reward: -0.1596 | rev_kl: 0.5256 | stu_lens: 118.5000 | mixed_lens: 121.0000 | lr: 3.7424e-06 | scale: 2048.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    406/  1000| tot_loss: 2.3273 | rl_loss: 0.8254 | pt_loss: 1.5018 | pg_loss: 0.3449 | reg_loss: 0.4805 | reward: -0.5820 | rev_kl: 0.8018 | stu_lens: 9.0000 | mixed_lens: 17.0000 | lr: 3.7349e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    407/  1000| tot_loss: 2.3813 | rl_loss: 0.6398 | pt_loss: 1.7415 | pg_loss: 0.0014 | reg_loss: 0.6384 | reward: -0.1924 | rev_kl: 1.0979 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7273e-06 | scale: 2048.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    408/  1000| tot_loss: 2.6769 | rl_loss: 0.9571 | pt_loss: 1.7198 | pg_loss: 0.3756 | reg_loss: 0.5815 | reward: -0.3991 | rev_kl: 0.7997 | stu_lens: 128.0000 | mixed_lens: 81.0000 | lr: 3.7196e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    409/  1000| tot_loss: 2.2926 | rl_loss: 0.6168 | pt_loss: 1.6759 | pg_loss: 0.0032 | reg_loss: 0.6136 | reward: -0.2014 | rev_kl: 0.9980 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7120e-06 | scale: 2048.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    410/  1000| tot_loss: 2.1769 | rl_loss: 0.6049 | pt_loss: 1.5720 | pg_loss: -0.0068 | reg_loss: 0.6118 | reward: -0.1211 | rev_kl: 1.0610 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7044e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    411/  1000| tot_loss: 2.8002 | rl_loss: 1.0788 | pt_loss: 1.7215 | pg_loss: 0.4987 | reg_loss: 0.5800 | reward: -0.9877 | rev_kl: 1.1254 | stu_lens: 39.5000 | mixed_lens: 59.0000 | lr: 3.6967e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    412/  1000| tot_loss: 2.6036 | rl_loss: 0.8980 | pt_loss: 1.7056 | pg_loss: 0.1224 | reg_loss: 0.7756 | reward: -0.2138 | rev_kl: 0.7335 | stu_lens: 128.0000 | mixed_lens: 117.5000 | lr: 3.6891e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    413/  1000| tot_loss: 2.4916 | rl_loss: 0.7644 | pt_loss: 1.7272 | pg_loss: 0.0077 | reg_loss: 0.7567 | reward: -0.1339 | rev_kl: 0.5192 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6814e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    414/  1000| tot_loss: 2.3999 | rl_loss: 0.5314 | pt_loss: 1.8685 | pg_loss: -0.0223 | reg_loss: 0.5537 | reward: -0.2194 | rev_kl: 0.9364 | stu_lens: 94.0000 | mixed_lens: 128.0000 | lr: 3.6737e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    415/  1000| tot_loss: 3.0121 | rl_loss: 1.2350 | pt_loss: 1.7771 | pg_loss: 0.5871 | reg_loss: 0.6479 | reward: 0.2160 | rev_kl: 1.0662 | stu_lens: 51.0000 | mixed_lens: 65.5000 | lr: 3.6660e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    416/  1000| tot_loss: 2.5364 | rl_loss: 0.8587 | pt_loss: 1.6777 | pg_loss: 0.2695 | reg_loss: 0.5892 | reward: -0.3589 | rev_kl: 0.9824 | stu_lens: 100.5000 | mixed_lens: 91.0000 | lr: 3.6582e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    416/  1000| tot_loss: 2.6169 | rl_loss: 0.8638 | pt_loss: 1.7530 | pg_loss: 0.1887 | reg_loss: 0.6751 | reward: -0.4351 | rev_kl: 1.1153 | stu_lens: 106.3750 | mixed_lens: 98.8906 | lr: 3.6582e-06 | scale: 2048.00 | time: 26.268 | step time: 27.532
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    417/  1000| tot_loss: 2.4125 | rl_loss: 0.6949 | pt_loss: 1.7175 | pg_loss: 0.0084 | reg_loss: 0.6866 | reward: -0.2840 | rev_kl: 1.1915 | stu_lens: 94.0000 | mixed_lens: 125.5000 | lr: 3.6505e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    418/  1000| tot_loss: 1.6053 | rl_loss: 0.4002 | pt_loss: 1.2051 | pg_loss: -0.0208 | reg_loss: 0.4210 | reward: -0.1553 | rev_kl: 0.8054 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6427e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    419/  1000| tot_loss: 2.2908 | rl_loss: 0.4989 | pt_loss: 1.7919 | pg_loss: 0.0553 | reg_loss: 0.4437 | reward: -0.1437 | rev_kl: 0.6205 | stu_lens: 92.0000 | mixed_lens: 116.5000 | lr: 3.6350e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    420/  1000| tot_loss: 2.6616 | rl_loss: 0.5832 | pt_loss: 2.0784 | pg_loss: 0.2233 | reg_loss: 0.3599 | reward: 0.2991 | rev_kl: 1.1099 | stu_lens: 67.5000 | mixed_lens: 53.5000 | lr: 3.6272e-06 | scale: 2048.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    421/  1000| tot_loss: 1.8545 | rl_loss: 0.4893 | pt_loss: 1.3652 | pg_loss: -0.0286 | reg_loss: 0.5179 | reward: -0.1387 | rev_kl: 0.8333 | stu_lens: 86.0000 | mixed_lens: 128.0000 | lr: 3.6194e-06 | scale: 2048.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    422/  1000| tot_loss: 2.4753 | rl_loss: 0.6316 | pt_loss: 1.8437 | pg_loss: 0.2438 | reg_loss: 0.3878 | reward: -2.5697 | rev_kl: 0.9674 | stu_lens: 88.0000 | mixed_lens: 66.5000 | lr: 3.6116e-06 | scale: 2048.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    423/  1000| tot_loss: 2.0932 | rl_loss: 0.4754 | pt_loss: 1.6178 | pg_loss: 0.0803 | reg_loss: 0.3951 | reward: -0.3504 | rev_kl: 0.6881 | stu_lens: 88.5000 | mixed_lens: 82.5000 | lr: 3.6038e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    424/  1000| tot_loss: 2.9050 | rl_loss: 0.9429 | pt_loss: 1.9621 | pg_loss: 0.3684 | reg_loss: 0.5745 | reward: -0.2774 | rev_kl: 0.7771 | stu_lens: 102.5000 | mixed_lens: 67.0000 | lr: 3.5959e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    425/  1000| tot_loss: 1.1441 | rl_loss: -0.4602 | pt_loss: 1.6043 | pg_loss: -0.6211 | reg_loss: 0.1610 | reward: -1.0305 | rev_kl: 0.8120 | stu_lens: 72.0000 | mixed_lens: 15.5000 | lr: 3.5881e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    426/  1000| tot_loss: 2.6820 | rl_loss: 0.9668 | pt_loss: 1.7152 | pg_loss: 0.3338 | reg_loss: 0.6331 | reward: -0.5085 | rev_kl: 0.7239 | stu_lens: 88.5000 | mixed_lens: 74.0000 | lr: 3.5802e-06 | scale: 2048.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    427/  1000| tot_loss: 2.5222 | rl_loss: 0.6123 | pt_loss: 1.9099 | pg_loss: 0.0108 | reg_loss: 0.6015 | reward: -0.2739 | rev_kl: 1.1294 | stu_lens: 94.0000 | mixed_lens: 125.5000 | lr: 3.5723e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    428/  1000| tot_loss: 2.7873 | rl_loss: 0.8644 | pt_loss: 1.9229 | pg_loss: 0.4095 | reg_loss: 0.4549 | reward: -0.4734 | rev_kl: 0.7945 | stu_lens: 48.5000 | mixed_lens: 72.5000 | lr: 3.5644e-06 | scale: 2048.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    429/  1000| tot_loss: 2.4283 | rl_loss: 0.5227 | pt_loss: 1.9056 | pg_loss: -0.0215 | reg_loss: 0.5442 | reward: -0.0704 | rev_kl: 0.7271 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5565e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    430/  1000| tot_loss: 2.1219 | rl_loss: 0.5767 | pt_loss: 1.5452 | pg_loss: 0.0292 | reg_loss: 0.5475 | reward: -0.1780 | rev_kl: 0.9318 | stu_lens: 97.5000 | mixed_lens: 118.0000 | lr: 3.5486e-06 | scale: 2048.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    431/  1000| tot_loss: 2.5820 | rl_loss: 0.7776 | pt_loss: 1.8044 | pg_loss: 0.3167 | reg_loss: 0.4609 | reward: -0.2709 | rev_kl: 0.8099 | stu_lens: 94.5000 | mixed_lens: 89.5000 | lr: 3.5407e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    432/  1000| tot_loss: 1.8830 | rl_loss: 0.4556 | pt_loss: 1.4274 | pg_loss: -0.0079 | reg_loss: 0.4635 | reward: -0.0816 | rev_kl: 0.9109 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5328e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    432/  1000| tot_loss: 2.2782 | rl_loss: 0.5899 | pt_loss: 1.6883 | pg_loss: 0.0877 | reg_loss: 0.5022 | reward: -0.3497 | rev_kl: 1.0352 | stu_lens: 105.0000 | mixed_lens: 101.3594 | lr: 3.5328e-06 | scale: 2048.00 | time: 26.287 | step time: 27.530
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    433/  1000| tot_loss: 2.7169 | rl_loss: 0.7616 | pt_loss: 1.9553 | pg_loss: 0.2692 | reg_loss: 0.4925 | reward: -3.0878 | rev_kl: 4.1437 | stu_lens: 66.0000 | mixed_lens: 67.0000 | lr: 3.5248e-06 | scale: 2048.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    434/  1000| tot_loss: 2.2273 | rl_loss: 0.4724 | pt_loss: 1.7549 | pg_loss: 0.1814 | reg_loss: 0.2910 | reward: -0.4459 | rev_kl: 0.7078 | stu_lens: 128.0000 | mixed_lens: 81.0000 | lr: 3.5168e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    435/  1000| tot_loss: 2.4443 | rl_loss: 0.5204 | pt_loss: 1.9239 | pg_loss: -0.0264 | reg_loss: 0.5468 | reward: -0.1080 | rev_kl: 1.0805 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5089e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    436/  1000| tot_loss: 2.3859 | rl_loss: 0.5446 | pt_loss: 1.8414 | pg_loss: 0.0888 | reg_loss: 0.4558 | reward: -0.2315 | rev_kl: 0.9491 | stu_lens: 128.0000 | mixed_lens: 117.5000 | lr: 3.5009e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    437/  1000| tot_loss: 2.0807 | rl_loss: 0.5828 | pt_loss: 1.4979 | pg_loss: 0.0771 | reg_loss: 0.5057 | reward: -0.1200 | rev_kl: 1.0815 | stu_lens: 126.0000 | mixed_lens: 113.5000 | lr: 3.4929e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    438/  1000| tot_loss: 2.1007 | rl_loss: 0.5808 | pt_loss: 1.5199 | pg_loss: 0.3691 | reg_loss: 0.2117 | reward: -0.4833 | rev_kl: 0.4774 | stu_lens: 55.5000 | mixed_lens: 65.5000 | lr: 3.4849e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    439/  1000| tot_loss: 2.3616 | rl_loss: 0.7006 | pt_loss: 1.6610 | pg_loss: 0.2636 | reg_loss: 0.4370 | reward: -0.1707 | rev_kl: 0.7864 | stu_lens: 102.5000 | mixed_lens: 77.5000 | lr: 3.4768e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    440/  1000| tot_loss: 2.8694 | rl_loss: 0.6683 | pt_loss: 2.2011 | pg_loss: 0.1951 | reg_loss: 0.4732 | reward: -0.0692 | rev_kl: 0.9990 | stu_lens: 128.0000 | mixed_lens: 91.0000 | lr: 3.4688e-06 | scale: 2048.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    441/  1000| tot_loss: 1.5478 | rl_loss: 0.3592 | pt_loss: 1.1886 | pg_loss: -0.0107 | reg_loss: 0.3699 | reward: -0.1746 | rev_kl: 1.0415 | stu_lens: 120.0000 | mixed_lens: 128.0000 | lr: 3.4607e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    442/  1000| tot_loss: 2.4062 | rl_loss: 0.4785 | pt_loss: 1.9277 | pg_loss: -0.0002 | reg_loss: 0.4787 | reward: -0.1183 | rev_kl: 0.7036 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4527e-06 | scale: 2048.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    443/  1000| tot_loss: 2.2123 | rl_loss: 0.2887 | pt_loss: 1.9236 | pg_loss: 0.0008 | reg_loss: 0.2880 | reward: -0.1033 | rev_kl: 0.9899 | stu_lens: 111.5000 | mixed_lens: 128.0000 | lr: 3.4446e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    444/  1000| tot_loss: 2.5739 | rl_loss: 0.6803 | pt_loss: 1.8936 | pg_loss: 0.0956 | reg_loss: 0.5847 | reward: -0.7094 | rev_kl: 0.7833 | stu_lens: 109.0000 | mixed_lens: 72.5000 | lr: 3.4365e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    445/  1000| tot_loss: 1.8458 | rl_loss: 0.3661 | pt_loss: 1.4797 | pg_loss: -0.0022 | reg_loss: 0.3683 | reward: -0.2603 | rev_kl: 0.9018 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4284e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    446/  1000| tot_loss: 2.5791 | rl_loss: 0.7968 | pt_loss: 1.7823 | pg_loss: 0.4413 | reg_loss: 0.3555 | reward: -3.1305 | rev_kl: 3.8313 | stu_lens: 50.0000 | mixed_lens: 57.5000 | lr: 3.4203e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    447/  1000| tot_loss: 2.5107 | rl_loss: 0.7033 | pt_loss: 1.8074 | pg_loss: 0.2990 | reg_loss: 0.4043 | reward: -2.4709 | rev_kl: 5.2371 | stu_lens: 88.0000 | mixed_lens: 66.5000 | lr: 3.4122e-06 | scale: 2048.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    448/  1000| tot_loss: 2.2790 | rl_loss: 0.4992 | pt_loss: 1.7797 | pg_loss: -0.0061 | reg_loss: 0.5054 | reward: -0.3145 | rev_kl: 0.9690 | stu_lens: 109.0000 | mixed_lens: 128.0000 | lr: 3.4041e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    448/  1000| tot_loss: 2.3115 | rl_loss: 0.5372 | pt_loss: 1.7744 | pg_loss: 0.1325 | reg_loss: 0.4047 | reward: -0.5014 | rev_kl: 1.2200 | stu_lens: 102.7812 | mixed_lens: 98.7812 | lr: 3.4041e-06 | scale: 2048.00 | time: 26.291 | step time: 27.539
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    449/  1000| tot_loss: 2.4267 | rl_loss: 0.8252 | pt_loss: 1.6014 | pg_loss: 0.5289 | reg_loss: 0.2963 | reward: -0.9578 | rev_kl: 1.1272 | stu_lens: 128.0000 | mixed_lens: 47.5000 | lr: 3.3959e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    450/  1000| tot_loss: 2.7392 | rl_loss: 1.1684 | pt_loss: 1.5707 | pg_loss: 0.1099 | reg_loss: 1.0585 | reward: -0.1521 | rev_kl: 0.5628 | stu_lens: 108.5000 | mixed_lens: 105.5000 | lr: 3.3878e-06 | scale: 2048.00 | time: 26.343 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    451/  1000| tot_loss: 2.4875 | rl_loss: 1.0856 | pt_loss: 1.4019 | pg_loss: 0.0715 | reg_loss: 1.0141 | reward: -0.3344 | rev_kl: 0.9123 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.3796e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    452/  1000| tot_loss: 2.4515 | rl_loss: 1.0098 | pt_loss: 1.4418 | pg_loss: 0.0634 | reg_loss: 0.9464 | reward: -0.1979 | rev_kl: 1.7769 | stu_lens: 112.5000 | mixed_lens: 128.0000 | lr: 3.3714e-06 | scale: 2048.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    453/  1000| tot_loss: 3.1459 | rl_loss: 1.2608 | pt_loss: 1.8851 | pg_loss: 0.1627 | reg_loss: 1.0980 | reward: -0.2572 | rev_kl: 1.2347 | stu_lens: 68.0000 | mixed_lens: 113.5000 | lr: 3.3632e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    454/  1000| tot_loss: 3.0080 | rl_loss: 1.1761 | pt_loss: 1.8319 | pg_loss: 0.0631 | reg_loss: 1.1130 | reward: -0.1735 | rev_kl: 0.7411 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.3551e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    455/  1000| tot_loss: 3.0998 | rl_loss: 1.2265 | pt_loss: 1.8734 | pg_loss: 0.3218 | reg_loss: 0.9046 | reward: 0.0757 | rev_kl: 0.9810 | stu_lens: 72.5000 | mixed_lens: 74.0000 | lr: 3.3468e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    456/  1000| tot_loss: 3.1787 | rl_loss: 1.5456 | pt_loss: 1.6331 | pg_loss: 0.3074 | reg_loss: 1.2382 | reward: -0.4609 | rev_kl: 0.6141 | stu_lens: 71.5000 | mixed_lens: 99.5000 | lr: 3.3386e-06 | scale: 2048.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    457/  1000| tot_loss: 2.7169 | rl_loss: 0.9798 | pt_loss: 1.7371 | pg_loss: 0.0677 | reg_loss: 0.9121 | reward: -0.0658 | rev_kl: 1.0037 | stu_lens: 109.0000 | mixed_lens: 128.0000 | lr: 3.3304e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    458/  1000| tot_loss: 2.4221 | rl_loss: 1.0675 | pt_loss: 1.3546 | pg_loss: 0.2128 | reg_loss: 0.8548 | reward: -0.1315 | rev_kl: 0.2133 | stu_lens: 52.5000 | mixed_lens: 99.5000 | lr: 3.3222e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    459/  1000| tot_loss: 2.6847 | rl_loss: 0.9879 | pt_loss: 1.6968 | pg_loss: 0.0651 | reg_loss: 0.9228 | reward: -0.2509 | rev_kl: 0.6083 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.3139e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    460/  1000| tot_loss: 3.1064 | rl_loss: 1.2234 | pt_loss: 1.8830 | pg_loss: 0.4077 | reg_loss: 0.8157 | reward: -0.2157 | rev_kl: 0.8501 | stu_lens: 53.5000 | mixed_lens: 82.0000 | lr: 3.3057e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    461/  1000| tot_loss: 2.8557 | rl_loss: 1.2305 | pt_loss: 1.6251 | pg_loss: 0.4327 | reg_loss: 0.7978 | reward: -0.1354 | rev_kl: 13.4664 | stu_lens: 79.0000 | mixed_lens: 71.5000 | lr: 3.2974e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    462/  1000| tot_loss: 3.0597 | rl_loss: 1.4890 | pt_loss: 1.5707 | pg_loss: 0.3259 | reg_loss: 1.1630 | reward: -0.7749 | rev_kl: 4.0409 | stu_lens: 78.0000 | mixed_lens: 72.0000 | lr: 3.2891e-06 | scale: 2048.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    463/  1000| tot_loss: 3.5045 | rl_loss: 1.8278 | pt_loss: 1.6767 | pg_loss: 0.6011 | reg_loss: 1.2267 | reward: -0.8602 | rev_kl: 1.0982 | stu_lens: 72.0000 | mixed_lens: 72.5000 | lr: 3.2808e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    464/  1000| tot_loss: 3.1709 | rl_loss: 1.0556 | pt_loss: 2.1153 | pg_loss: 0.0539 | reg_loss: 1.0017 | reward: -0.0537 | rev_kl: 0.8562 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.2725e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    464/  1000| tot_loss: 2.9160 | rl_loss: 1.2053 | pt_loss: 1.7107 | pg_loss: 0.2834 | reg_loss: 0.9219 | reward: -0.3224 | rev_kl: 1.3543 | stu_lens: 93.9688 | mixed_lens: 96.7656 | lr: 3.2725e-06 | scale: 2048.00 | time: 26.289 | step time: 27.563
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    465/  1000| tot_loss: 3.0317 | rl_loss: 1.0752 | pt_loss: 1.9566 | pg_loss: 0.0441 | reg_loss: 1.0311 | reward: -0.1280 | rev_kl: 0.8381 | stu_lens: 118.5000 | mixed_lens: 128.0000 | lr: 3.2642e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    466/  1000| tot_loss: 2.5182 | rl_loss: 0.9830 | pt_loss: 1.5352 | pg_loss: 0.0614 | reg_loss: 0.9217 | reward: -0.1450 | rev_kl: 1.8932 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.2559e-06 | scale: 2048.00 | time: 26.328 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    467/  1000| tot_loss: 2.5207 | rl_loss: 0.5575 | pt_loss: 1.9632 | pg_loss: 0.1633 | reg_loss: 0.3942 | reward: -0.0645 | rev_kl: 1.1875 | stu_lens: 67.5000 | mixed_lens: 96.5000 | lr: 3.2476e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    468/  1000| tot_loss: 2.7027 | rl_loss: 1.0939 | pt_loss: 1.6088 | pg_loss: 0.4556 | reg_loss: 0.6383 | reward: -0.0906 | rev_kl: 0.8344 | stu_lens: 60.5000 | mixed_lens: 71.0000 | lr: 3.2393e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    469/  1000| tot_loss: 2.9637 | rl_loss: 0.7245 | pt_loss: 2.2391 | pg_loss: 0.0308 | reg_loss: 0.6938 | reward: 0.0360 | rev_kl: 0.7020 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.2309e-06 | scale: 2048.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    470/  1000| tot_loss: 2.5158 | rl_loss: 0.9477 | pt_loss: 1.5681 | pg_loss: 0.4198 | reg_loss: 0.5279 | reward: -0.2242 | rev_kl: 1.0580 | stu_lens: 67.0000 | mixed_lens: 83.0000 | lr: 3.2226e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    471/  1000| tot_loss: 1.9289 | rl_loss: 0.3790 | pt_loss: 1.5499 | pg_loss: 0.0207 | reg_loss: 0.3583 | reward: -0.0812 | rev_kl: 0.6774 | stu_lens: 81.0000 | mixed_lens: 128.0000 | lr: 3.2142e-06 | scale: 2048.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    472/  1000| tot_loss: 2.8556 | rl_loss: 0.8988 | pt_loss: 1.9569 | pg_loss: 0.1013 | reg_loss: 0.7974 | reward: -0.3406 | rev_kl: 1.2655 | stu_lens: 96.0000 | mixed_lens: 110.0000 | lr: 3.2059e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    473/  1000| tot_loss: 2.0127 | rl_loss: 0.6148 | pt_loss: 1.3979 | pg_loss: 0.0394 | reg_loss: 0.5754 | reward: -0.0740 | rev_kl: 0.7234 | stu_lens: 84.0000 | mixed_lens: 128.0000 | lr: 3.1975e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    474/  1000| tot_loss: 2.2995 | rl_loss: 0.6313 | pt_loss: 1.6682 | pg_loss: 0.2293 | reg_loss: 0.4020 | reward: -0.1059 | rev_kl: 13.3876 | stu_lens: 55.0000 | mixed_lens: 43.0000 | lr: 3.1891e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    475/  1000| tot_loss: 2.1943 | rl_loss: 0.8988 | pt_loss: 1.2955 | pg_loss: 0.2200 | reg_loss: 0.6788 | reward: -0.4104 | rev_kl: 1.0754 | stu_lens: 97.0000 | mixed_lens: 89.0000 | lr: 3.1807e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    476/  1000| tot_loss: 2.6632 | rl_loss: 0.8724 | pt_loss: 1.7908 | pg_loss: 0.3013 | reg_loss: 0.5711 | reward: -0.4487 | rev_kl: 0.5853 | stu_lens: 70.0000 | mixed_lens: 70.0000 | lr: 3.1723e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    477/  1000| tot_loss: 2.1700 | rl_loss: 0.5999 | pt_loss: 1.5701 | pg_loss: 0.0109 | reg_loss: 0.5889 | reward: -0.1609 | rev_kl: 0.2921 | stu_lens: 76.5000 | mixed_lens: 128.0000 | lr: 3.1639e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    478/  1000| tot_loss: 2.8768 | rl_loss: 1.1422 | pt_loss: 1.7346 | pg_loss: 0.3685 | reg_loss: 0.7737 | reward: -0.7725 | rev_kl: 1.1090 | stu_lens: 78.0000 | mixed_lens: 72.0000 | lr: 3.1555e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    479/  1000| tot_loss: 2.4154 | rl_loss: 0.5448 | pt_loss: 1.8706 | pg_loss: -0.0000 | reg_loss: 0.5448 | reward: -0.2721 | rev_kl: 0.7519 | stu_lens: 107.5000 | mixed_lens: 128.0000 | lr: 3.1470e-06 | scale: 2048.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    480/  1000| tot_loss: 2.7691 | rl_loss: 1.1174 | pt_loss: 1.6516 | pg_loss: 0.4997 | reg_loss: 0.6178 | reward: -0.0118 | rev_kl: 0.7711 | stu_lens: 76.5000 | mixed_lens: 66.0000 | lr: 3.1386e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    480/  1000| tot_loss: 2.5386 | rl_loss: 0.8143 | pt_loss: 1.7243 | pg_loss: 0.1944 | reg_loss: 0.6199 | reward: -0.2914 | rev_kl: 1.3257 | stu_lens: 92.3438 | mixed_lens: 97.7969 | lr: 3.1386e-06 | scale: 2048.00 | time: 26.287 | step time: 27.557
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    481/  1000| tot_loss: 3.2283 | rl_loss: 1.1688 | pt_loss: 2.0596 | pg_loss: 0.3447 | reg_loss: 0.8240 | reward: -0.5329 | rev_kl: 0.7133 | stu_lens: 96.5000 | mixed_lens: 84.0000 | lr: 3.1302e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    482/  1000| tot_loss: 2.3176 | rl_loss: 1.1098 | pt_loss: 1.2077 | pg_loss: 0.4251 | reg_loss: 0.6847 | reward: -0.2040 | rev_kl: 1.1766 | stu_lens: 93.0000 | mixed_lens: 81.5000 | lr: 3.1217e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    483/  1000| tot_loss: 2.5673 | rl_loss: 0.9409 | pt_loss: 1.6264 | pg_loss: 0.4040 | reg_loss: 0.5369 | reward: -0.7887 | rev_kl: 1.1213 | stu_lens: 78.0000 | mixed_lens: 62.5000 | lr: 3.1133e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    484/  1000| tot_loss: 2.8090 | rl_loss: 1.2755 | pt_loss: 1.5334 | pg_loss: 0.6950 | reg_loss: 0.5805 | reward: 0.0313 | rev_kl: 0.9617 | stu_lens: 48.5000 | mixed_lens: 51.5000 | lr: 3.1048e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    485/  1000| tot_loss: 2.5361 | rl_loss: 0.8172 | pt_loss: 1.7189 | pg_loss: 0.3283 | reg_loss: 0.4889 | reward: -0.3298 | rev_kl: 0.8784 | stu_lens: 76.5000 | mixed_lens: 93.0000 | lr: 3.0963e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    486/  1000| tot_loss: 2.0907 | rl_loss: 0.4784 | pt_loss: 1.6123 | pg_loss: 0.0424 | reg_loss: 0.4361 | reward: -0.0774 | rev_kl: 0.5229 | stu_lens: 92.0000 | mixed_lens: 107.0000 | lr: 3.0879e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    487/  1000| tot_loss: 2.1092 | rl_loss: 0.3574 | pt_loss: 1.7519 | pg_loss: 0.0278 | reg_loss: 0.3295 | reward: -0.2318 | rev_kl: 0.7223 | stu_lens: 128.0000 | mixed_lens: 123.5000 | lr: 3.0794e-06 | scale: 2048.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    488/  1000| tot_loss: 2.7127 | rl_loss: 0.9150 | pt_loss: 1.7977 | pg_loss: 0.3539 | reg_loss: 0.5611 | reward: -0.4602 | rev_kl: 0.4620 | stu_lens: 96.5000 | mixed_lens: 84.0000 | lr: 3.0709e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    489/  1000| tot_loss: 2.1956 | rl_loss: 0.7158 | pt_loss: 1.4797 | pg_loss: 0.2595 | reg_loss: 0.4564 | reward: -0.5785 | rev_kl: 0.9133 | stu_lens: 87.5000 | mixed_lens: 81.0000 | lr: 3.0624e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    490/  1000| tot_loss: 2.1481 | rl_loss: 0.8436 | pt_loss: 1.3045 | pg_loss: 0.5900 | reg_loss: 0.2536 | reward: 0.1737 | rev_kl: 0.9025 | stu_lens: 33.0000 | mixed_lens: 36.0000 | lr: 3.0539e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    491/  1000| tot_loss: 2.4686 | rl_loss: 0.5287 | pt_loss: 1.9399 | pg_loss: 0.1035 | reg_loss: 0.4252 | reward: -0.1593 | rev_kl: 0.8706 | stu_lens: 114.5000 | mixed_lens: 114.0000 | lr: 3.0454e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    492/  1000| tot_loss: 2.6293 | rl_loss: 0.4200 | pt_loss: 2.2093 | pg_loss: 0.0156 | reg_loss: 0.4044 | reward: -0.3153 | rev_kl: 0.7816 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.0368e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    493/  1000| tot_loss: 2.3461 | rl_loss: 0.6568 | pt_loss: 1.6893 | pg_loss: 0.0415 | reg_loss: 0.6153 | reward: -0.1519 | rev_kl: 0.5845 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.0283e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    494/  1000| tot_loss: 2.2385 | rl_loss: 0.4019 | pt_loss: 1.8366 | pg_loss: -0.0014 | reg_loss: 0.4033 | reward: -0.1286 | rev_kl: 0.8075 | stu_lens: 78.0000 | mixed_lens: 128.0000 | lr: 3.0198e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    495/  1000| tot_loss: 2.7788 | rl_loss: 0.5834 | pt_loss: 2.1954 | pg_loss: 0.0057 | reg_loss: 0.5778 | reward: -0.2147 | rev_kl: 0.4791 | stu_lens: 82.5000 | mixed_lens: 128.0000 | lr: 3.0112e-06 | scale: 2048.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    496/  1000| tot_loss: 3.4548 | rl_loss: 1.4398 | pt_loss: 2.0150 | pg_loss: 1.0826 | reg_loss: 0.3572 | reward: -0.5481 | rev_kl: 0.4635 | stu_lens: 54.0000 | mixed_lens: 35.5000 | lr: 3.0027e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    496/  1000| tot_loss: 2.4785 | rl_loss: 0.7060 | pt_loss: 1.7725 | pg_loss: 0.2363 | reg_loss: 0.4697 | reward: -0.2954 | rev_kl: 1.2988 | stu_lens: 92.5156 | mixed_lens: 97.6719 | lr: 3.0027e-06 | scale: 2048.00 | time: 26.264 | step time: 27.545
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    497/  1000| tot_loss: 2.2760 | rl_loss: 0.3726 | pt_loss: 1.9035 | pg_loss: -0.0097 | reg_loss: 0.3823 | reward: -0.1367 | rev_kl: 1.1426 | stu_lens: 111.5000 | mixed_lens: 125.5000 | lr: 2.9941e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    498/  1000| tot_loss: 2.3522 | rl_loss: 0.3573 | pt_loss: 1.9949 | pg_loss: 0.0262 | reg_loss: 0.3311 | reward: -0.2052 | rev_kl: 0.7649 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.9856e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    499/  1000| tot_loss: 2.4363 | rl_loss: 0.3677 | pt_loss: 2.0686 | pg_loss: 0.0015 | reg_loss: 0.3662 | reward: -0.1734 | rev_kl: 1.0300 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.9770e-06 | scale: 2048.00 | time: 26.235 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/500
                                 Evaluation #5                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ dime un chiste acerca de la situacion │ dime un chiste acerca de la          │
│ actual de la economia, de modo que    │ situacion actual de la economia, de  │
│ los niños comprendan el mal estado de │ modo que los niños comprendan el mal │
│ la misma.                             │ estado de la misma.                  │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ En la actualidad, la economía de los │
│                                       │ Estados Unidos se encuentra en un    │
│                                       │ estado lamentable. Muchas personas   │
│                                       │ han perdido su empleo y el ingreso   │
│                                       │ familiar se ha visto afectado. Los   │
│                                       │ bonos del gobierno se han quedado    │
│                                       │ sin compradores y la deuda pública   │
│                                       │ se ha incrementado. Las empresas     │
│                                       │ privadas han visto disminuidas sus   │
│                                       │ ventas y la producción se ha visto   │
│                                       │ afectada. Las personas tienen muchas │
│                                       │ dudas sobre el futuro económico por  │
│                                       │ lo que muchos han decidido apagar la │
│                                       │ televisión y no seguir los hechos de │
│                                       │ la actualidad.                       │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Sí, éste es un chiste que suele      │
│                                       │ contarse a los niños. Es una         │
│                                       │ historia de un elefante que se metió │
│                                       │ en un potro de leche y lo hizo       │
│                                       │ reventar. Los niños no pueden        │
│                                       │ entender el chiste porque no saben   │
│                                       │ lo que es un elefante, ni siquiera   │
│                                       │ sabrán que una leche es una          │
│                                       │ sustancia que se utiliza para hacer  │
│                                       │ helados.                             │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Sí, siempre y cuando lo quieras oír. │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.316 | exact_match: 0.103 | rev_kl: 0.930 | lens: 90.068 | pt_loss: 1.744 | lm_loss: 1.879 | kd_loss: 1.609 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    500/  1000| tot_loss: 2.0537 | rl_loss: 0.4757 | pt_loss: 1.5780 | pg_loss: 0.1007 | reg_loss: 0.3750 | reward: -0.1127 | rev_kl: 0.6944 | stu_lens: 92.0000 | mixed_lens: 107.0000 | lr: 2.9685e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    501/  1000| tot_loss: 1.8631 | rl_loss: 0.5249 | pt_loss: 1.3381 | pg_loss: 0.1926 | reg_loss: 0.3323 | reward: -0.1074 | rev_kl: 0.7783 | stu_lens: 93.0000 | mixed_lens: 81.5000 | lr: 2.9599e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    502/  1000| tot_loss: 2.2962 | rl_loss: 0.6274 | pt_loss: 1.6687 | pg_loss: 0.2924 | reg_loss: 0.3350 | reward: -0.0456 | rev_kl: 0.5748 | stu_lens: 82.5000 | mixed_lens: 85.5000 | lr: 2.9513e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    503/  1000| tot_loss: 1.9682 | rl_loss: 0.3501 | pt_loss: 1.6181 | pg_loss: 0.0116 | reg_loss: 0.3385 | reward: -0.2529 | rev_kl: 1.0244 | stu_lens: 53.0000 | mixed_lens: 123.0000 | lr: 2.9427e-06 | scale: 2048.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    504/  1000| tot_loss: 2.4566 | rl_loss: 0.5334 | pt_loss: 1.9233 | pg_loss: 0.0001 | reg_loss: 0.5333 | reward: -0.2358 | rev_kl: 4.2888 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.9341e-06 | scale: 2048.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    505/  1000| tot_loss: 2.3756 | rl_loss: 0.4516 | pt_loss: 1.9240 | pg_loss: 0.0307 | reg_loss: 0.4209 | reward: -0.1642 | rev_kl: 1.8670 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 2.9255e-06 | scale: 2048.00 | time: 26.191 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    506/  1000| tot_loss: 2.3411 | rl_loss: 0.6691 | pt_loss: 1.6721 | pg_loss: 0.2346 | reg_loss: 0.4345 | reward: -0.0233 | rev_kl: 0.5746 | stu_lens: 64.5000 | mixed_lens: 74.0000 | lr: 2.9169e-06 | scale: 2048.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    507/  1000| tot_loss: 1.7436 | rl_loss: 0.1693 | pt_loss: 1.5743 | pg_loss: -0.0051 | reg_loss: 0.1744 | reward: -0.2444 | rev_kl: 0.4914 | stu_lens: 79.5000 | mixed_lens: 128.0000 | lr: 2.9083e-06 | scale: 2048.00 | time: 26.177 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    508/  1000| tot_loss: 2.7156 | rl_loss: 0.7432 | pt_loss: 1.9724 | pg_loss: 0.2140 | reg_loss: 0.5292 | reward: -0.6753 | rev_kl: 0.8578 | stu_lens: 106.5000 | mixed_lens: 81.0000 | lr: 2.8997e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    509/  1000| tot_loss: 2.1520 | rl_loss: 0.4812 | pt_loss: 1.6708 | pg_loss: 0.2028 | reg_loss: 0.2785 | reward: -0.8015 | rev_kl: 1.1499 | stu_lens: 34.0000 | mixed_lens: 72.0000 | lr: 2.8911e-06 | scale: 2048.00 | time: 26.206 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    510/  1000| tot_loss: 2.5598 | rl_loss: 0.7218 | pt_loss: 1.8380 | pg_loss: 0.3170 | reg_loss: 0.4048 | reward: -0.4855 | rev_kl: 0.7794 | stu_lens: 96.5000 | mixed_lens: 84.0000 | lr: 2.8825e-06 | scale: 2048.00 | time: 26.225 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    511/  1000| tot_loss: 1.9511 | rl_loss: 0.4391 | pt_loss: 1.5120 | pg_loss: 0.0446 | reg_loss: 0.3945 | reward: -0.2850 | rev_kl: 0.6725 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8738e-06 | scale: 2048.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    512/  1000| tot_loss: 2.5387 | rl_loss: 0.9790 | pt_loss: 1.5597 | pg_loss: 0.4950 | reg_loss: 0.4840 | reward: -0.4163 | rev_kl: 0.6202 | stu_lens: 60.5000 | mixed_lens: 71.5000 | lr: 2.8652e-06 | scale: 2048.00 | time: 26.231 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    512/  1000| tot_loss: 2.2913 | rl_loss: 0.5939 | pt_loss: 1.6974 | pg_loss: 0.2129 | reg_loss: 0.3810 | reward: -0.3162 | rev_kl: 1.3362 | stu_lens: 91.6094 | mixed_lens: 98.1250 | lr: 2.8652e-06 | scale: 2048.00 | time: 26.231 | step time: 27.501
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    513/  1000| tot_loss: 2.1820 | rl_loss: 0.7092 | pt_loss: 1.4728 | pg_loss: 0.2385 | reg_loss: 0.4707 | reward: -0.1991 | rev_kl: 1.2050 | stu_lens: 41.5000 | mixed_lens: 39.5000 | lr: 2.8566e-06 | scale: 2048.00 | time: 26.212 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    514/  1000| tot_loss: 2.6564 | rl_loss: 1.1394 | pt_loss: 1.5170 | pg_loss: 0.4820 | reg_loss: 0.6574 | reward: -0.8963 | rev_kl: 0.5545 | stu_lens: 35.5000 | mixed_lens: 55.5000 | lr: 2.8479e-06 | scale: 2048.00 | time: 26.225 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    515/  1000| tot_loss: 3.7106 | rl_loss: 1.5641 | pt_loss: 2.1465 | pg_loss: 0.4338 | reg_loss: 1.1303 | reward: -0.1547 | rev_kl: 1.0171 | stu_lens: 75.0000 | mixed_lens: 77.0000 | lr: 2.8393e-06 | scale: 2048.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    516/  1000| tot_loss: 3.8207 | rl_loss: 1.7673 | pt_loss: 2.0534 | pg_loss: 0.4295 | reg_loss: 1.3378 | reward: -0.4929 | rev_kl: 0.5580 | stu_lens: 87.0000 | mixed_lens: 98.5000 | lr: 2.8306e-06 | scale: 2048.00 | time: 26.201 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    517/  1000| tot_loss: 2.7102 | rl_loss: 1.4890 | pt_loss: 1.2212 | pg_loss: 0.4635 | reg_loss: 1.0255 | reward: -0.1793 | rev_kl: 0.9405 | stu_lens: 100.0000 | mixed_lens: 69.5000 | lr: 2.8220e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    518/  1000| tot_loss: 3.5955 | rl_loss: 1.2135 | pt_loss: 2.3820 | pg_loss: 0.5742 | reg_loss: 0.6393 | reward: 1.1843 | rev_kl: 1.1383 | stu_lens: 82.5000 | mixed_lens: 67.5000 | lr: 2.8133e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    519/  1000| tot_loss: 3.0291 | rl_loss: 1.2591 | pt_loss: 1.7701 | pg_loss: 0.0902 | reg_loss: 1.1688 | reward: -0.4917 | rev_kl: 0.9541 | stu_lens: 95.5000 | mixed_lens: 128.0000 | lr: 2.8047e-06 | scale: 2048.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    520/  1000| tot_loss: 2.9709 | rl_loss: 1.3241 | pt_loss: 1.6468 | pg_loss: 0.2793 | reg_loss: 1.0448 | reward: -0.8462 | rev_kl: 5.6534 | stu_lens: 81.0000 | mixed_lens: 71.5000 | lr: 2.7960e-06 | scale: 2048.00 | time: 26.188 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    521/  1000| tot_loss: 3.0474 | rl_loss: 0.9677 | pt_loss: 2.0797 | pg_loss: 0.1799 | reg_loss: 0.7878 | reward: -0.1804 | rev_kl: 0.4538 | stu_lens: 103.5000 | mixed_lens: 96.5000 | lr: 2.7873e-06 | scale: 2048.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    522/  1000| tot_loss: 3.0217 | rl_loss: 1.2792 | pt_loss: 1.7426 | pg_loss: 0.5520 | reg_loss: 0.7272 | reward: -0.5127 | rev_kl: 0.8085 | stu_lens: 67.0000 | mixed_lens: 44.5000 | lr: 2.7787e-06 | scale: 2048.00 | time: 26.191 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    523/  1000| tot_loss: 3.1111 | rl_loss: 1.2769 | pt_loss: 1.8342 | pg_loss: 0.1674 | reg_loss: 1.1095 | reward: -0.3662 | rev_kl: 0.8928 | stu_lens: 128.0000 | mixed_lens: 97.5000 | lr: 2.7700e-06 | scale: 2048.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    524/  1000| tot_loss: 3.5023 | rl_loss: 1.2920 | pt_loss: 2.2102 | pg_loss: 0.2229 | reg_loss: 1.0691 | reward: -0.1374 | rev_kl: 0.8168 | stu_lens: 128.0000 | mixed_lens: 106.0000 | lr: 2.7613e-06 | scale: 2048.00 | time: 26.191 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    525/  1000| tot_loss: 2.7533 | rl_loss: 1.1284 | pt_loss: 1.6249 | pg_loss: 0.2915 | reg_loss: 0.8369 | reward: -0.1972 | rev_kl: 0.7405 | stu_lens: 101.0000 | mixed_lens: 98.5000 | lr: 2.7526e-06 | scale: 2048.00 | time: 26.203 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    526/  1000| tot_loss: 3.2058 | rl_loss: 1.1695 | pt_loss: 2.0364 | pg_loss: 0.3901 | reg_loss: 0.7793 | reward: -0.6010 | rev_kl: 1.1911 | stu_lens: 46.5000 | mixed_lens: 55.5000 | lr: 2.7440e-06 | scale: 2048.00 | time: 26.172 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    527/  1000| tot_loss: 3.4225 | rl_loss: 1.8416 | pt_loss: 1.5809 | pg_loss: 0.7795 | reg_loss: 1.0621 | reward: -0.7131 | rev_kl: 1.3549 | stu_lens: 28.0000 | mixed_lens: 45.0000 | lr: 2.7353e-06 | scale: 2048.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    528/  1000| tot_loss: 3.1360 | rl_loss: 1.1834 | pt_loss: 1.9526 | pg_loss: 0.3950 | reg_loss: 0.7884 | reward: -0.1718 | rev_kl: 0.9546 | stu_lens: 101.5000 | mixed_lens: 84.0000 | lr: 2.7266e-06 | scale: 2048.00 | time: 26.172 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    528/  1000| tot_loss: 3.0249 | rl_loss: 1.2494 | pt_loss: 1.7755 | pg_loss: 0.3788 | reg_loss: 0.8706 | reward: -0.3236 | rev_kl: 1.1075 | stu_lens: 83.2656 | mixed_lens: 80.8750 | lr: 2.7266e-06 | scale: 2048.00 | time: 26.172 | step time: 27.489
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    529/  1000| tot_loss: 3.5646 | rl_loss: 1.5900 | pt_loss: 1.9745 | pg_loss: 0.7346 | reg_loss: 0.8555 | reward: -0.3819 | rev_kl: 0.6363 | stu_lens: 59.5000 | mixed_lens: 23.0000 | lr: 2.7179e-06 | scale: 2048.00 | time: 26.203 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    530/  1000| tot_loss: 2.3567 | rl_loss: 0.8496 | pt_loss: 1.5071 | pg_loss: 0.1320 | reg_loss: 0.7176 | reward: -0.2968 | rev_kl: 1.1060 | stu_lens: 92.0000 | mixed_lens: 97.5000 | lr: 2.7092e-06 | scale: 2048.00 | time: 26.170 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    531/  1000| tot_loss: 2.8218 | rl_loss: 0.9789 | pt_loss: 1.8429 | pg_loss: 0.3825 | reg_loss: 0.5964 | reward: -0.6196 | rev_kl: 0.4915 | stu_lens: 63.5000 | mixed_lens: 72.5000 | lr: 2.7005e-06 | scale: 2048.00 | time: 26.195 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    532/  1000| tot_loss: 3.5985 | rl_loss: 0.5639 | pt_loss: 3.0346 | pg_loss: 0.0127 | reg_loss: 0.5512 | reward: -0.1244 | rev_kl: 0.6368 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6918e-06 | scale: 2048.00 | time: 26.169 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    533/  1000| tot_loss: 3.4989 | rl_loss: 1.4947 | pt_loss: 2.0041 | pg_loss: 0.8802 | reg_loss: 0.6146 | reward: -0.4141 | rev_kl: 0.8265 | stu_lens: 72.5000 | mixed_lens: 55.0000 | lr: 2.6831e-06 | scale: 2048.00 | time: 26.194 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    534/  1000| tot_loss: 3.2691 | rl_loss: 1.6624 | pt_loss: 1.6067 | pg_loss: 0.6370 | reg_loss: 1.0254 | reward: -0.5127 | rev_kl: 1.3874 | stu_lens: 65.5000 | mixed_lens: 40.0000 | lr: 2.6744e-06 | scale: 2048.00 | time: 26.169 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    535/  1000| tot_loss: 2.9885 | rl_loss: 1.2955 | pt_loss: 1.6930 | pg_loss: 0.3714 | reg_loss: 0.9240 | reward: -0.3946 | rev_kl: 0.7119 | stu_lens: 119.5000 | mixed_lens: 97.5000 | lr: 2.6657e-06 | scale: 2048.00 | time: 26.189 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    536/  1000| tot_loss: 2.3202 | rl_loss: 0.7365 | pt_loss: 1.5837 | pg_loss: 0.1201 | reg_loss: 0.6164 | reward: -0.0729 | rev_kl: 0.7548 | stu_lens: 128.0000 | mixed_lens: 106.0000 | lr: 2.6570e-06 | scale: 2048.00 | time: 26.178 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    537/  1000| tot_loss: 2.4563 | rl_loss: 0.8749 | pt_loss: 1.5813 | pg_loss: 0.2022 | reg_loss: 0.6727 | reward: -0.2257 | rev_kl: 1.0455 | stu_lens: 108.5000 | mixed_lens: 102.5000 | lr: 2.6483e-06 | scale: 2048.00 | time: 26.195 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    538/  1000| tot_loss: 2.4233 | rl_loss: 0.7791 | pt_loss: 1.6442 | pg_loss: 0.1228 | reg_loss: 0.6563 | reward: -0.1555 | rev_kl: 0.8245 | stu_lens: 116.5000 | mixed_lens: 96.0000 | lr: 2.6396e-06 | scale: 2048.00 | time: 26.173 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    539/  1000| tot_loss: 2.6144 | rl_loss: 0.6782 | pt_loss: 1.9362 | pg_loss: 0.0020 | reg_loss: 0.6762 | reward: -0.1256 | rev_kl: 0.9921 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6308e-06 | scale: 2048.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    540/  1000| tot_loss: 3.0496 | rl_loss: 1.4430 | pt_loss: 1.6066 | pg_loss: 0.6109 | reg_loss: 0.8321 | reward: -0.5401 | rev_kl: 1.2813 | stu_lens: 59.0000 | mixed_lens: 55.0000 | lr: 2.6221e-06 | scale: 2048.00 | time: 26.167 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    541/  1000| tot_loss: 2.6768 | rl_loss: 0.7102 | pt_loss: 1.9666 | pg_loss: 0.0286 | reg_loss: 0.6816 | reward: -0.2646 | rev_kl: 0.9813 | stu_lens: 65.5000 | mixed_lens: 118.0000 | lr: 2.6134e-06 | scale: 2048.00 | time: 26.194 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    542/  1000| tot_loss: 2.2738 | rl_loss: 0.7428 | pt_loss: 1.5310 | pg_loss: 0.1956 | reg_loss: 0.5472 | reward: -0.1750 | rev_kl: 0.7705 | stu_lens: 115.0000 | mixed_lens: 92.5000 | lr: 2.6047e-06 | scale: 2048.00 | time: 26.170 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    543/  1000| tot_loss: 2.7686 | rl_loss: 0.8986 | pt_loss: 1.8700 | pg_loss: 0.1930 | reg_loss: 0.7056 | reward: -1.0356 | rev_kl: 1.2700 | stu_lens: 70.0000 | mixed_lens: 65.5000 | lr: 2.5960e-06 | scale: 2048.00 | time: 26.195 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    544/  1000| tot_loss: 3.5784 | rl_loss: 1.6436 | pt_loss: 1.9349 | pg_loss: 0.5475 | reg_loss: 1.0960 | reward: -0.7647 | rev_kl: 0.8449 | stu_lens: 81.0000 | mixed_lens: 72.0000 | lr: 2.5872e-06 | scale: 2048.00 | time: 26.170 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    544/  1000| tot_loss: 2.7199 | rl_loss: 0.9489 | pt_loss: 1.7710 | pg_loss: 0.2973 | reg_loss: 0.6516 | reward: -0.3355 | rev_kl: 1.1044 | stu_lens: 86.6719 | mixed_lens: 81.9688 | lr: 2.5872e-06 | scale: 2048.00 | time: 26.170 | step time: 27.455
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    545/  1000| tot_loss: 3.5475 | rl_loss: 1.6413 | pt_loss: 1.9062 | pg_loss: 0.6730 | reg_loss: 0.9683 | reward: -0.1550 | rev_kl: 0.9006 | stu_lens: 58.0000 | mixed_lens: 36.5000 | lr: 2.5785e-06 | scale: 2048.00 | time: 26.199 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    546/  1000| tot_loss: 2.7960 | rl_loss: 0.9194 | pt_loss: 1.8767 | pg_loss: 0.1155 | reg_loss: 0.8038 | reward: -0.3877 | rev_kl: 0.9603 | stu_lens: 128.0000 | mixed_lens: 106.0000 | lr: 2.5698e-06 | scale: 2048.00 | time: 26.173 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    547/  1000| tot_loss: 2.2504 | rl_loss: 0.5100 | pt_loss: 1.7404 | pg_loss: -0.0090 | reg_loss: 0.5190 | reward: -0.2303 | rev_kl: 1.0214 | stu_lens: 95.5000 | mixed_lens: 128.0000 | lr: 2.5611e-06 | scale: 2048.00 | time: 26.195 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    548/  1000| tot_loss: 1.6785 | rl_loss: 0.4803 | pt_loss: 1.1982 | pg_loss: 0.0506 | reg_loss: 0.4297 | reward: -0.1151 | rev_kl: 0.6338 | stu_lens: 128.0000 | mixed_lens: 109.0000 | lr: 2.5524e-06 | scale: 2048.00 | time: 26.174 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    549/  1000| tot_loss: 2.9514 | rl_loss: 1.1388 | pt_loss: 1.8126 | pg_loss: 0.7263 | reg_loss: 0.4125 | reward: -0.7226 | rev_kl: 1.0495 | stu_lens: 12.5000 | mixed_lens: 17.0000 | lr: 2.5436e-06 | scale: 2048.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    550/  1000| tot_loss: 2.2860 | rl_loss: 0.8086 | pt_loss: 1.4774 | pg_loss: 0.3349 | reg_loss: 0.4737 | reward: -0.9585 | rev_kl: 5.8402 | stu_lens: 81.0000 | mixed_lens: 71.5000 | lr: 2.5349e-06 | scale: 2048.00 | time: 26.192 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    551/  1000| tot_loss: 2.4713 | rl_loss: 0.5605 | pt_loss: 1.9108 | pg_loss: -0.0106 | reg_loss: 0.5711 | reward: -0.2703 | rev_kl: 0.5963 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.5262e-06 | scale: 2048.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    552/  1000| tot_loss: 2.0405 | rl_loss: 0.7403 | pt_loss: 1.3002 | pg_loss: 0.3918 | reg_loss: 0.3485 | reward: -0.5581 | rev_kl: 0.7444 | stu_lens: 75.0000 | mixed_lens: 72.5000 | lr: 2.5175e-06 | scale: 2048.00 | time: 26.168 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    553/  1000| tot_loss: 2.2012 | rl_loss: 0.4688 | pt_loss: 1.7324 | pg_loss: 0.0031 | reg_loss: 0.4657 | reward: -0.2215 | rev_kl: 1.0574 | stu_lens: 92.0000 | mixed_lens: 128.0000 | lr: 2.5087e-06 | scale: 2048.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    554/  1000| tot_loss: 3.1775 | rl_loss: 1.1393 | pt_loss: 2.0382 | pg_loss: 0.8685 | reg_loss: 0.2708 | reward: 0.9527 | rev_kl: 0.8115 | stu_lens: 32.0000 | mixed_lens: 24.0000 | lr: 2.5000e-06 | scale: 2048.00 | time: 26.186 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    555/  1000| tot_loss: 2.2181 | rl_loss: 0.4902 | pt_loss: 1.7279 | pg_loss: 0.1115 | reg_loss: 0.3787 | reward: -0.2151 | rev_kl: 0.7644 | stu_lens: 103.5000 | mixed_lens: 104.0000 | lr: 2.4913e-06 | scale: 2048.00 | time: 26.212 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    556/  1000| tot_loss: 2.0416 | rl_loss: 0.5961 | pt_loss: 1.4455 | pg_loss: 0.1387 | reg_loss: 0.4575 | reward: -0.2357 | rev_kl: 0.8565 | stu_lens: 128.0000 | mixed_lens: 111.5000 | lr: 2.4825e-06 | scale: 2048.00 | time: 26.190 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    557/  1000| tot_loss: 2.8549 | rl_loss: 0.8912 | pt_loss: 1.9636 | pg_loss: 0.3363 | reg_loss: 0.5549 | reward: -0.3231 | rev_kl: 0.6166 | stu_lens: 106.5000 | mixed_lens: 55.0000 | lr: 2.4738e-06 | scale: 2048.00 | time: 26.202 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    558/  1000| tot_loss: 2.5823 | rl_loss: 0.7003 | pt_loss: 1.8820 | pg_loss: 0.3888 | reg_loss: 0.3116 | reward: -0.3825 | rev_kl: 1.4890 | stu_lens: 111.0000 | mixed_lens: 80.0000 | lr: 2.4651e-06 | scale: 2048.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    559/  1000| tot_loss: 2.8767 | rl_loss: 1.3188 | pt_loss: 1.5579 | pg_loss: 0.5692 | reg_loss: 0.7496 | reward: -0.1550 | rev_kl: 0.9006 | stu_lens: 58.0000 | mixed_lens: 36.5000 | lr: 2.4564e-06 | scale: 2048.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    560/  1000| tot_loss: 2.0335 | rl_loss: 0.6958 | pt_loss: 1.3377 | pg_loss: 0.2265 | reg_loss: 0.4693 | reward: -0.1670 | rev_kl: 1.0273 | stu_lens: 92.5000 | mixed_lens: 82.0000 | lr: 2.4476e-06 | scale: 2048.00 | time: 26.190 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    560/  1000| tot_loss: 2.4897 | rl_loss: 0.7996 | pt_loss: 1.6901 | pg_loss: 0.3347 | reg_loss: 0.4649 | reward: -0.3316 | rev_kl: 1.1056 | stu_lens: 83.0312 | mixed_lens: 77.5312 | lr: 2.4476e-06 | scale: 2048.00 | time: 26.190 | step time: 27.473
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    561/  1000| tot_loss: 2.0022 | rl_loss: 0.4946 | pt_loss: 1.5076 | pg_loss: 0.0234 | reg_loss: 0.4712 | reward: -0.1457 | rev_kl: 0.7296 | stu_lens: 98.0000 | mixed_lens: 118.0000 | lr: 2.4389e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    562/  1000| tot_loss: 2.3085 | rl_loss: 0.8999 | pt_loss: 1.4087 | pg_loss: 0.3586 | reg_loss: 0.5413 | reward: 1.1401 | rev_kl: 0.9660 | stu_lens: 75.0000 | mixed_lens: 66.0000 | lr: 2.4302e-06 | scale: 2048.00 | time: 26.181 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    563/  1000| tot_loss: 2.2427 | rl_loss: 0.4286 | pt_loss: 1.8141 | pg_loss: 0.0684 | reg_loss: 0.3602 | reward: -0.1673 | rev_kl: 0.7528 | stu_lens: 104.0000 | mixed_lens: 110.0000 | lr: 2.4215e-06 | scale: 2048.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    564/  1000| tot_loss: 2.4341 | rl_loss: 0.9699 | pt_loss: 1.4642 | pg_loss: 0.4607 | reg_loss: 0.5092 | reward: -0.5260 | rev_kl: 1.0028 | stu_lens: 68.0000 | mixed_lens: 73.5000 | lr: 2.4128e-06 | scale: 2048.00 | time: 26.185 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    565/  1000| tot_loss: 2.7771 | rl_loss: 1.1871 | pt_loss: 1.5901 | pg_loss: 0.7738 | reg_loss: 0.4132 | reward: -1.1247 | rev_kl: 5.5651 | stu_lens: 72.5000 | mixed_lens: 47.0000 | lr: 2.4040e-06 | scale: 2048.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    566/  1000| tot_loss: 2.0533 | rl_loss: 0.4381 | pt_loss: 1.6152 | pg_loss: -0.0002 | reg_loss: 0.4383 | reward: -0.2592 | rev_kl: 0.8071 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.3953e-06 | scale: 2048.00 | time: 26.191 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    567/  1000| tot_loss: 2.4270 | rl_loss: 0.5230 | pt_loss: 1.9040 | pg_loss: 0.2595 | reg_loss: 0.2634 | reward: -0.1289 | rev_kl: 1.0637 | stu_lens: 101.0000 | mixed_lens: 91.0000 | lr: 2.3866e-06 | scale: 2048.00 | time: 26.193 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    568/  1000| tot_loss: 2.3986 | rl_loss: 0.4308 | pt_loss: 1.9678 | pg_loss: 0.1220 | reg_loss: 0.3088 | reward: -0.1735 | rev_kl: 0.3853 | stu_lens: 85.0000 | mixed_lens: 85.0000 | lr: 2.3779e-06 | scale: 2048.00 | time: 26.168 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    569/  1000| tot_loss: 2.9118 | rl_loss: 0.7599 | pt_loss: 2.1519 | pg_loss: 0.2907 | reg_loss: 0.4693 | reward: -0.9910 | rev_kl: 0.8135 | stu_lens: 36.0000 | mixed_lens: 59.0000 | lr: 2.3692e-06 | scale: 2048.00 | time: 26.192 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    570/  1000| tot_loss: 1.7842 | rl_loss: 0.3000 | pt_loss: 1.4842 | pg_loss: -0.0240 | reg_loss: 0.3240 | reward: -0.0580 | rev_kl: 0.4970 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.3604e-06 | scale: 2048.00 | time: 26.170 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    571/  1000| tot_loss: 1.3578 | rl_loss: 0.2969 | pt_loss: 1.0609 | pg_loss: -0.0531 | reg_loss: 0.3501 | reward: -0.1718 | rev_kl: 0.9093 | stu_lens: 40.5000 | mixed_lens: 71.0000 | lr: 2.3517e-06 | scale: 2048.00 | time: 26.193 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    572/  1000| tot_loss: 2.1549 | rl_loss: 0.6381 | pt_loss: 1.5169 | pg_loss: 0.3079 | reg_loss: 0.3302 | reward: -0.2589 | rev_kl: 1.0908 | stu_lens: 78.5000 | mixed_lens: 68.0000 | lr: 2.3430e-06 | scale: 2048.00 | time: 26.166 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    573/  1000| tot_loss: 2.1424 | rl_loss: 0.5042 | pt_loss: 1.6382 | pg_loss: 0.1996 | reg_loss: 0.3045 | reward: -0.1535 | rev_kl: 0.7654 | stu_lens: 112.5000 | mixed_lens: 98.5000 | lr: 2.3343e-06 | scale: 2048.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    574/  1000| tot_loss: 2.7007 | rl_loss: 0.7932 | pt_loss: 1.9075 | pg_loss: 0.4598 | reg_loss: 0.3333 | reward: -0.4536 | rev_kl: 0.6529 | stu_lens: 87.0000 | mixed_lens: 88.0000 | lr: 2.3256e-06 | scale: 2048.00 | time: 26.169 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    575/  1000| tot_loss: 2.2522 | rl_loss: 0.4315 | pt_loss: 1.8208 | pg_loss: 0.1709 | reg_loss: 0.2606 | reward: -0.4490 | rev_kl: 1.1201 | stu_lens: 55.0000 | mixed_lens: 75.5000 | lr: 2.3169e-06 | scale: 2048.00 | time: 26.187 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    576/  1000| tot_loss: 2.1341 | rl_loss: 0.2626 | pt_loss: 1.8715 | pg_loss: 0.0956 | reg_loss: 0.1670 | reward: -0.1276 | rev_kl: 0.7905 | stu_lens: 97.5000 | mixed_lens: 114.5000 | lr: 2.3082e-06 | scale: 2048.00 | time: 26.171 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    576/  1000| tot_loss: 2.3684 | rl_loss: 0.6575 | pt_loss: 1.7109 | pg_loss: 0.2698 | reg_loss: 0.3878 | reward: -0.3278 | rev_kl: 1.0960 | stu_lens: 83.4219 | mixed_lens: 82.4062 | lr: 2.3082e-06 | scale: 2048.00 | time: 26.171 | step time: 27.462
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    577/  1000| tot_loss: 2.3917 | rl_loss: 0.4976 | pt_loss: 1.8942 | pg_loss: 0.1461 | reg_loss: 0.3515 | reward: -0.1570 | rev_kl: 0.8917 | stu_lens: 115.0000 | mixed_lens: 79.5000 | lr: 2.2995e-06 | scale: 2048.00 | time: 26.198 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    578/  1000| tot_loss: 3.3961 | rl_loss: 1.5793 | pt_loss: 1.8169 | pg_loss: 0.5126 | reg_loss: 1.0667 | reward: -0.4186 | rev_kl: 1.0371 | stu_lens: 85.0000 | mixed_lens: 82.5000 | lr: 2.2908e-06 | scale: 2048.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    579/  1000| tot_loss: 2.8280 | rl_loss: 1.1484 | pt_loss: 1.6796 | pg_loss: 0.3687 | reg_loss: 0.7798 | reward: -0.0455 | rev_kl: 0.8696 | stu_lens: 94.0000 | mixed_lens: 65.5000 | lr: 2.2821e-06 | scale: 2048.00 | time: 26.166 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    580/  1000| tot_loss: 3.3129 | rl_loss: 1.2335 | pt_loss: 2.0794 | pg_loss: 0.3465 | reg_loss: 0.8871 | reward: -0.0795 | rev_kl: 1.2216 | stu_lens: 73.0000 | mixed_lens: 60.0000 | lr: 2.2734e-06 | scale: 2048.00 | time: 26.191 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    581/  1000| tot_loss: 3.1562 | rl_loss: 1.3096 | pt_loss: 1.8466 | pg_loss: 0.4262 | reg_loss: 0.8835 | reward: 0.0773 | rev_kl: 0.9095 | stu_lens: 62.5000 | mixed_lens: 84.5000 | lr: 2.2647e-06 | scale: 2048.00 | time: 26.170 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    582/  1000| tot_loss: 3.0784 | rl_loss: 1.5935 | pt_loss: 1.4849 | pg_loss: 0.6503 | reg_loss: 0.9432 | reward: -0.2523 | rev_kl: 0.2839 | stu_lens: 71.5000 | mixed_lens: 53.0000 | lr: 2.2560e-06 | scale: 2048.00 | time: 26.201 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    583/  1000| tot_loss: 2.8774 | rl_loss: 1.1298 | pt_loss: 1.7476 | pg_loss: 0.2722 | reg_loss: 0.8576 | reward: -0.6858 | rev_kl: 0.6711 | stu_lens: 89.5000 | mixed_lens: 80.0000 | lr: 2.2474e-06 | scale: 2048.00 | time: 26.186 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    584/  1000| tot_loss: 3.1323 | rl_loss: 1.3095 | pt_loss: 1.8228 | pg_loss: 0.2100 | reg_loss: 1.0995 | reward: -0.2147 | rev_kl: 0.7876 | stu_lens: 81.5000 | mixed_lens: 106.5000 | lr: 2.2387e-06 | scale: 2048.00 | time: 26.197 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    585/  1000| tot_loss: 2.7701 | rl_loss: 0.9783 | pt_loss: 1.7919 | pg_loss: 0.0407 | reg_loss: 0.9375 | reward: -0.1233 | rev_kl: 0.7188 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.2300e-06 | scale: 2048.00 | time: 26.166 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    586/  1000| tot_loss: 3.5532 | rl_loss: 1.6646 | pt_loss: 1.8887 | pg_loss: 0.4485 | reg_loss: 1.2160 | reward: 0.7058 | rev_kl: 0.9291 | stu_lens: 66.0000 | mixed_lens: 68.5000 | lr: 2.2213e-06 | scale: 2048.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    587/  1000| tot_loss: 2.7274 | rl_loss: 0.9451 | pt_loss: 1.7823 | pg_loss: 0.0635 | reg_loss: 0.8816 | reward: -0.1171 | rev_kl: 0.9818 | stu_lens: 119.5000 | mixed_lens: 128.0000 | lr: 2.2127e-06 | scale: 2048.00 | time: 26.173 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    588/  1000| tot_loss: 3.0190 | rl_loss: 1.3533 | pt_loss: 1.6657 | pg_loss: 0.3758 | reg_loss: 0.9775 | reward: -0.2214 | rev_kl: 1.0902 | stu_lens: 79.0000 | mixed_lens: 77.5000 | lr: 2.2040e-06 | scale: 2048.00 | time: 26.193 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    589/  1000| tot_loss: 3.1857 | rl_loss: 1.6767 | pt_loss: 1.5090 | pg_loss: 0.4697 | reg_loss: 1.2070 | reward: -2.6520 | rev_kl: 1.3902 | stu_lens: 19.5000 | mixed_lens: 46.5000 | lr: 2.1953e-06 | scale: 2048.00 | time: 26.169 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    590/  1000| tot_loss: 2.6333 | rl_loss: 0.8175 | pt_loss: 1.8158 | pg_loss: 0.2059 | reg_loss: 0.6116 | reward: -0.4544 | rev_kl: 0.4380 | stu_lens: 44.0000 | mixed_lens: 66.0000 | lr: 2.1867e-06 | scale: 2048.00 | time: 26.194 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    591/  1000| tot_loss: 2.8149 | rl_loss: 1.2812 | pt_loss: 1.5337 | pg_loss: 0.1776 | reg_loss: 1.1036 | reward: -0.4438 | rev_kl: 1.1780 | stu_lens: 68.0000 | mixed_lens: 108.5000 | lr: 2.1780e-06 | scale: 2048.00 | time: 26.225 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    592/  1000| tot_loss: 2.1397 | rl_loss: 0.8508 | pt_loss: 1.2890 | pg_loss: 0.0370 | reg_loss: 0.8138 | reward: -0.3478 | rev_kl: 0.6785 | stu_lens: 102.0000 | mixed_lens: 128.0000 | lr: 2.1694e-06 | scale: 2048.00 | time: 26.225 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    592/  1000| tot_loss: 2.9864 | rl_loss: 1.1952 | pt_loss: 1.7911 | pg_loss: 0.2697 | reg_loss: 0.9255 | reward: -0.2850 | rev_kl: 0.8472 | stu_lens: 88.1562 | mixed_lens: 90.4219 | lr: 2.1694e-06 | scale: 2048.00 | time: 26.225 | step time: 27.464
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    593/  1000| tot_loss: 2.1406 | rl_loss: 0.5227 | pt_loss: 1.6179 | pg_loss: 0.0968 | reg_loss: 0.4259 | reward: 0.4060 | rev_kl: 1.0227 | stu_lens: 120.0000 | mixed_lens: 51.0000 | lr: 2.1607e-06 | scale: 2048.00 | time: 26.366 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    594/  1000| tot_loss: 2.4218 | rl_loss: 1.0039 | pt_loss: 1.4179 | pg_loss: 0.2100 | reg_loss: 0.7939 | reward: -0.1063 | rev_kl: 0.8731 | stu_lens: 128.0000 | mixed_lens: 100.0000 | lr: 2.1521e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    595/  1000| tot_loss: 2.4617 | rl_loss: 0.8379 | pt_loss: 1.6237 | pg_loss: -0.0000 | reg_loss: 0.8379 | reward: -0.0895 | rev_kl: 0.7445 | stu_lens: 128.0000 | mixed_lens: 125.5000 | lr: 2.1434e-06 | scale: 2048.00 | time: 26.173 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    596/  1000| tot_loss: 2.3726 | rl_loss: 1.1139 | pt_loss: 1.2587 | pg_loss: 0.3878 | reg_loss: 0.7261 | reward: -0.1888 | rev_kl: 0.8676 | stu_lens: 25.5000 | mixed_lens: 85.0000 | lr: 2.1348e-06 | scale: 2048.00 | time: 26.203 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    597/  1000| tot_loss: 2.4566 | rl_loss: 0.7839 | pt_loss: 1.6728 | pg_loss: 0.2985 | reg_loss: 0.4854 | reward: -0.3781 | rev_kl: 0.7535 | stu_lens: 122.5000 | mixed_lens: 80.0000 | lr: 2.1262e-06 | scale: 2048.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    598/  1000| tot_loss: 2.8097 | rl_loss: 0.8561 | pt_loss: 1.9536 | pg_loss: 0.3156 | reg_loss: 0.5404 | reward: -0.1970 | rev_kl: 0.9263 | stu_lens: 94.0000 | mixed_lens: 73.5000 | lr: 2.1175e-06 | scale: 2048.00 | time: 26.192 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    599/  1000| tot_loss: 2.5824 | rl_loss: 0.8289 | pt_loss: 1.7535 | pg_loss: 0.1098 | reg_loss: 0.7191 | reward: -0.1392 | rev_kl: 0.5462 | stu_lens: 128.0000 | mixed_lens: 95.0000 | lr: 2.1089e-06 | scale: 2048.00 | time: 26.171 | step time: 0.000
                                 Evaluation #6                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ dime un chiste acerca de la situacion │ dime un chiste acerca de la          │
│ actual de la economia, de modo que    │ situacion actual de la economia, de  │
│ los niños comprendan el mal estado de │ modo que los niños comprendan el mal │
│ la misma.                             │ estado de la misma.                  │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Hay muchas situaciones que permiten  │
│                                       │ hacer chistes sobre la economia,     │
│                                       │ entre otras las siguientes:          │
│                                       │                                      │
│                                       │ - La crisis económica - Una crisis   │
│                                       │ económica es una situación que       │
│                                       │ afecta a muchos ciudadanos y que     │
│                                       │ hace que la gente esté embarazada de │
│                                       │ dolor y desempleo. Es una situación  │
│                                       │ que ha afectado a muchos países en   │
│                                       │ los últimos años, y ha dado pie a    │
│                                       │ muchos chistes. Un chiste básico es  │
│                                       │ el siguiente:                        │
│                                       │                                      │
│                                       │ - Los políticos se van de compras y  │
│                                       │ todo el mundo hace una cesta - Los   │
│                                       │ polít                                │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Sí, en realidad es una joke que se   │
│                                       │ puede contar muchas veces. A         │
│                                       │ continuación te muestro el chiste    │
│                                       │ completo:                            │
│                                       │                                      │
│                                       │ Un hombre se encuentra en un bar y   │
│                                       │ le pide a la camarera un whisky.     │
│                                       │ Cuando la camarera le pregunta por   │
│                                       │ qué bebe whisky, él responde:        │
│                                       │ "Porque me gusta". La camarera le    │
│                                       │ pregunta entonces: "¿Y por qué te    │
│                                       │ gusta beber whisky?". El hombre      │
│                                       │ responde: "Porque me gusta".         │
│                                       │                                      │
│                                       │ Este chiste es muy                   │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Sí. Una vez hubo un niño que era muy │
│                                       │ malo. Nadie quería jugar con él. Lo  │
│                                       │ hubo una vez cuando estaba jugando   │
│                                       │ con un ángel, que era una niña       │
│                                       │ bonita. El niño es idéntico a un     │
│                                       │ granjero y le dijo a la niña que si  │
│                                       │ quería jugar con él debía ayudarlo a │
│                                       │ recoger la cosecha. La niña se quedó │
│                                       │ de mal humor cuando el niño se llevó │
│                                       │ la cosecha a casa, y se fue. Él se   │
│                                       │ percató de que la niña               │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 15.968 | exact_match: 0.205 | rev_kl: 0.906 | lens: 83.582 | pt_loss: 1.742 | lm_loss: 1.879 | kd_loss: 1.606 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    600/  1000| tot_loss: 2.4121 | rl_loss: 0.7326 | pt_loss: 1.6795 | pg_loss: 0.1787 | reg_loss: 0.5539 | reward: -0.1958 | rev_kl: 0.8838 | stu_lens: 107.5000 | mixed_lens: 99.5000 | lr: 2.1003e-06 | scale: 2048.00 | time: 26.353 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    601/  1000| tot_loss: 2.6748 | rl_loss: 0.8567 | pt_loss: 1.8181 | pg_loss: 0.1286 | reg_loss: 0.7280 | reward: 0.3959 | rev_kl: 0.9822 | stu_lens: 111.5000 | mixed_lens: 74.0000 | lr: 2.0917e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    602/  1000| tot_loss: 2.6111 | rl_loss: 0.6974 | pt_loss: 1.9136 | pg_loss: 0.0851 | reg_loss: 0.6124 | reward: -0.4347 | rev_kl: 0.6965 | stu_lens: 70.5000 | mixed_lens: 109.5000 | lr: 2.0831e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    603/  1000| tot_loss: 3.8628 | rl_loss: 1.7660 | pt_loss: 2.0968 | pg_loss: 1.0135 | reg_loss: 0.7525 | reward: -0.2383 | rev_kl: 0.6343 | stu_lens: 51.5000 | mixed_lens: 36.0000 | lr: 2.0745e-06 | scale: 2048.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    604/  1000| tot_loss: 2.8857 | rl_loss: 1.0552 | pt_loss: 1.8306 | pg_loss: 0.1746 | reg_loss: 0.8805 | reward: -0.3332 | rev_kl: 1.0200 | stu_lens: 63.5000 | mixed_lens: 102.5000 | lr: 2.0659e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    605/  1000| tot_loss: 2.6154 | rl_loss: 0.5693 | pt_loss: 2.0461 | pg_loss: -0.0288 | reg_loss: 0.5981 | reward: -0.3588 | rev_kl: 0.1621 | stu_lens: 41.5000 | mixed_lens: 36.0000 | lr: 2.0573e-06 | scale: 2048.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    606/  1000| tot_loss: 2.9337 | rl_loss: 0.8726 | pt_loss: 2.0611 | pg_loss: 0.0164 | reg_loss: 0.8561 | reward: -0.0827 | rev_kl: 0.8140 | stu_lens: 107.0000 | mixed_lens: 128.0000 | lr: 2.0487e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    607/  1000| tot_loss: 2.5804 | rl_loss: 0.6646 | pt_loss: 1.9158 | pg_loss: 0.1206 | reg_loss: 0.5440 | reward: -0.1017 | rev_kl: 0.7806 | stu_lens: 112.5000 | mixed_lens: 109.0000 | lr: 2.0401e-06 | scale: 2048.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    608/  1000| tot_loss: 2.3410 | rl_loss: 0.7385 | pt_loss: 1.6024 | pg_loss: 0.2448 | reg_loss: 0.4938 | reward: -0.6094 | rev_kl: 0.6253 | stu_lens: 92.5000 | mixed_lens: 72.5000 | lr: 2.0315e-06 | scale: 2048.00 | time: 26.256 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    608/  1000| tot_loss: 2.5880 | rl_loss: 0.8633 | pt_loss: 1.7247 | pg_loss: 0.2053 | reg_loss: 0.6580 | reward: -0.2434 | rev_kl: 0.8587 | stu_lens: 89.8125 | mixed_lens: 87.4531 | lr: 2.0315e-06 | scale: 2048.00 | time: 26.256 | step time: 27.520
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    609/  1000| tot_loss: 1.7696 | rl_loss: 0.3726 | pt_loss: 1.3970 | pg_loss: -0.0644 | reg_loss: 0.4370 | reward: -0.6289 | rev_kl: 0.6965 | stu_lens: 89.5000 | mixed_lens: 54.5000 | lr: 2.0230e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    610/  1000| tot_loss: 3.5122 | rl_loss: 1.7278 | pt_loss: 1.7844 | pg_loss: 1.1638 | reg_loss: 0.5639 | reward: -0.1905 | rev_kl: 0.7575 | stu_lens: 122.5000 | mixed_lens: 35.0000 | lr: 2.0144e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    611/  1000| tot_loss: 2.6247 | rl_loss: 0.7147 | pt_loss: 1.9100 | pg_loss: -0.0266 | reg_loss: 0.7413 | reward: -0.2672 | rev_kl: 1.4090 | stu_lens: 61.0000 | mixed_lens: 128.0000 | lr: 2.0059e-06 | scale: 2048.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    612/  1000| tot_loss: 2.4070 | rl_loss: 0.7633 | pt_loss: 1.6437 | pg_loss: 0.4753 | reg_loss: 0.2880 | reward: -0.1232 | rev_kl: 0.2903 | stu_lens: 71.5000 | mixed_lens: 71.5000 | lr: 1.9973e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    613/  1000| tot_loss: 2.0115 | rl_loss: 0.7542 | pt_loss: 1.2574 | pg_loss: 0.1911 | reg_loss: 0.5631 | reward: -0.3130 | rev_kl: 1.0601 | stu_lens: 77.0000 | mixed_lens: 108.5000 | lr: 1.9888e-06 | scale: 2048.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    614/  1000| tot_loss: 2.5779 | rl_loss: 0.7832 | pt_loss: 1.7947 | pg_loss: 0.1167 | reg_loss: 0.6664 | reward: -0.3983 | rev_kl: 1.0251 | stu_lens: 75.5000 | mixed_lens: 109.5000 | lr: 1.9802e-06 | scale: 2048.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    615/  1000| tot_loss: 2.5728 | rl_loss: 0.7774 | pt_loss: 1.7954 | pg_loss: 0.3454 | reg_loss: 0.4320 | reward: -0.3440 | rev_kl: 0.5618 | stu_lens: 79.0000 | mixed_lens: 72.0000 | lr: 1.9717e-06 | scale: 2048.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    616/  1000| tot_loss: 2.2561 | rl_loss: 0.5245 | pt_loss: 1.7315 | pg_loss: -0.0095 | reg_loss: 0.5341 | reward: -0.1602 | rev_kl: 0.8873 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.9632e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    617/  1000| tot_loss: 2.9114 | rl_loss: 1.1487 | pt_loss: 1.7628 | pg_loss: 0.6023 | reg_loss: 0.5463 | reward: -0.8040 | rev_kl: 0.4933 | stu_lens: 46.5000 | mixed_lens: 53.5000 | lr: 1.9546e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    618/  1000| tot_loss: 2.8085 | rl_loss: 0.7177 | pt_loss: 2.0908 | pg_loss: 0.2477 | reg_loss: 0.4700 | reward: -0.7195 | rev_kl: 0.8447 | stu_lens: 89.5000 | mixed_lens: 80.0000 | lr: 1.9461e-06 | scale: 2048.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    619/  1000| tot_loss: 2.4886 | rl_loss: 0.6551 | pt_loss: 1.8335 | pg_loss: 0.0836 | reg_loss: 0.5715 | reward: -0.0359 | rev_kl: 0.8849 | stu_lens: 107.5000 | mixed_lens: 109.0000 | lr: 1.9376e-06 | scale: 2048.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    620/  1000| tot_loss: 2.1412 | rl_loss: 0.4717 | pt_loss: 1.6694 | pg_loss: 0.1406 | reg_loss: 0.3311 | reward: -0.3108 | rev_kl: 0.8394 | stu_lens: 50.0000 | mixed_lens: 99.5000 | lr: 1.9291e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    621/  1000| tot_loss: 2.2601 | rl_loss: 0.6092 | pt_loss: 1.6509 | pg_loss: 0.3197 | reg_loss: 0.2895 | reward: -0.3885 | rev_kl: 1.0846 | stu_lens: 79.0000 | mixed_lens: 66.0000 | lr: 1.9206e-06 | scale: 2048.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    622/  1000| tot_loss: 2.2295 | rl_loss: 0.4624 | pt_loss: 1.7671 | pg_loss: 0.0296 | reg_loss: 0.4329 | reward: -0.0897 | rev_kl: 0.8256 | stu_lens: 119.5000 | mixed_lens: 128.0000 | lr: 1.9121e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    623/  1000| tot_loss: 2.2548 | rl_loss: 0.4499 | pt_loss: 1.8049 | pg_loss: 0.0249 | reg_loss: 0.4251 | reward: -0.0807 | rev_kl: 0.7933 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.9037e-06 | scale: 2048.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    624/  1000| tot_loss: 2.6755 | rl_loss: 0.8797 | pt_loss: 1.7957 | pg_loss: 0.3440 | reg_loss: 0.5357 | reward: -2.7191 | rev_kl: 1.3223 | stu_lens: 35.5000 | mixed_lens: 30.0000 | lr: 1.8952e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    624/  1000| tot_loss: 2.4689 | rl_loss: 0.6961 | pt_loss: 1.7728 | pg_loss: 0.1897 | reg_loss: 0.5064 | reward: -0.3104 | rev_kl: 0.8383 | stu_lens: 88.1719 | mixed_lens: 87.9375 | lr: 1.8952e-06 | scale: 2048.00 | time: 26.254 | step time: 27.516
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    625/  1000| tot_loss: 2.3806 | rl_loss: 0.5157 | pt_loss: 1.8650 | pg_loss: 0.0471 | reg_loss: 0.4686 | reward: -0.1451 | rev_kl: 0.8990 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.8867e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    626/  1000| tot_loss: 2.3690 | rl_loss: 0.6503 | pt_loss: 1.7187 | pg_loss: 0.2613 | reg_loss: 0.3890 | reward: -0.0988 | rev_kl: 0.6119 | stu_lens: 128.0000 | mixed_lens: 83.0000 | lr: 1.8783e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
[2023-12-14 00:50:18,510] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, reducing to 1024
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    627/  1000| tot_loss: 2.7558 | rl_loss: 1.1430 | pt_loss: 1.6128 | pg_loss: 0.7747 | reg_loss: 0.3684 | reward: -0.0292 | rev_kl: 0.7958 | stu_lens: 78.0000 | mixed_lens: 103.5000 | lr: 1.8783e-06 | scale: 1024.00 | time: 2.851 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    628/  1000| tot_loss: 2.3468 | rl_loss: 0.7573 | pt_loss: 1.5895 | pg_loss: 0.3716 | reg_loss: 0.3857 | reward: -0.2660 | rev_kl: 0.8424 | stu_lens: 102.5000 | mixed_lens: 68.5000 | lr: 1.8698e-06 | scale: 1024.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    629/  1000| tot_loss: 2.2638 | rl_loss: 0.6369 | pt_loss: 1.6268 | pg_loss: 0.1288 | reg_loss: 0.5081 | reward: -0.2745 | rev_kl: 1.0751 | stu_lens: 76.5000 | mixed_lens: 102.5000 | lr: 1.8614e-06 | scale: 1024.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    630/  1000| tot_loss: 2.5958 | rl_loss: 1.2102 | pt_loss: 1.3856 | pg_loss: 0.7439 | reg_loss: 0.4663 | reward: -0.8208 | rev_kl: 0.6720 | stu_lens: 40.0000 | mixed_lens: 54.0000 | lr: 1.8530e-06 | scale: 1024.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    631/  1000| tot_loss: 1.7253 | rl_loss: 0.4737 | pt_loss: 1.2516 | pg_loss: 0.0971 | reg_loss: 0.3766 | reward: -0.1037 | rev_kl: 1.0083 | stu_lens: 128.0000 | mixed_lens: 105.0000 | lr: 1.8445e-06 | scale: 1024.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    632/  1000| tot_loss: 2.0417 | rl_loss: 0.3216 | pt_loss: 1.7201 | pg_loss: 0.0415 | reg_loss: 0.2801 | reward: -0.5412 | rev_kl: 0.5746 | stu_lens: 40.5000 | mixed_lens: 92.5000 | lr: 1.8361e-06 | scale: 1024.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    633/  1000| tot_loss: 1.9487 | rl_loss: 0.4819 | pt_loss: 1.4668 | pg_loss: 0.0929 | reg_loss: 0.3890 | reward: -0.2338 | rev_kl: 0.7876 | stu_lens: 128.0000 | mixed_lens: 108.0000 | lr: 1.8277e-06 | scale: 1024.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    634/  1000| tot_loss: 2.4808 | rl_loss: 0.7606 | pt_loss: 1.7202 | pg_loss: 0.3212 | reg_loss: 0.4394 | reward: -2.4960 | rev_kl: 1.6120 | stu_lens: 36.0000 | mixed_lens: 65.5000 | lr: 1.8193e-06 | scale: 1024.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    635/  1000| tot_loss: 2.2191 | rl_loss: 0.4300 | pt_loss: 1.7891 | pg_loss: 0.0600 | reg_loss: 0.3699 | reward: -0.4006 | rev_kl: 0.8996 | stu_lens: 102.0000 | mixed_lens: 116.5000 | lr: 1.8109e-06 | scale: 1024.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    636/  1000| tot_loss: 2.0595 | rl_loss: 0.6305 | pt_loss: 1.4290 | pg_loss: 0.0697 | reg_loss: 0.5608 | reward: -0.3839 | rev_kl: 1.2411 | stu_lens: 90.5000 | mixed_lens: 109.5000 | lr: 1.8025e-06 | scale: 1024.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    637/  1000| tot_loss: 2.3822 | rl_loss: 0.4029 | pt_loss: 1.9793 | pg_loss: 0.0231 | reg_loss: 0.3797 | reward: -0.2120 | rev_kl: 0.8779 | stu_lens: 119.0000 | mixed_lens: 128.0000 | lr: 1.7941e-06 | scale: 1024.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    638/  1000| tot_loss: 2.4306 | rl_loss: 0.5937 | pt_loss: 1.8369 | pg_loss: 0.1861 | reg_loss: 0.4076 | reward: -0.0742 | rev_kl: 1.0851 | stu_lens: 93.5000 | mixed_lens: 88.5000 | lr: 1.7858e-06 | scale: 1024.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    639/  1000| tot_loss: 2.4143 | rl_loss: 0.6389 | pt_loss: 1.7754 | pg_loss: 0.1459 | reg_loss: 0.4930 | reward: -0.0217 | rev_kl: 0.9226 | stu_lens: 89.0000 | mixed_lens: 93.5000 | lr: 1.7774e-06 | scale: 1024.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    640/  1000| tot_loss: 2.5223 | rl_loss: 0.6429 | pt_loss: 1.8793 | pg_loss: 0.2339 | reg_loss: 0.4091 | reward: -0.2232 | rev_kl: 0.6608 | stu_lens: 79.0000 | mixed_lens: 92.0000 | lr: 1.7691e-06 | scale: 1024.00 | time: 26.258 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    640/  1000| tot_loss: 2.3293 | rl_loss: 0.6177 | pt_loss: 1.7116 | pg_loss: 0.2027 | reg_loss: 0.4150 | reward: -0.2592 | rev_kl: 0.8497 | stu_lens: 88.7656 | mixed_lens: 89.9531 | lr: 1.7691e-06 | scale: 1024.00 | time: 26.258 | step time: 26.056
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    641/  1000| tot_loss: 2.4907 | rl_loss: 0.7382 | pt_loss: 1.7525 | pg_loss: 0.2719 | reg_loss: 0.4663 | reward: 0.4790 | rev_kl: 0.8748 | stu_lens: 120.0000 | mixed_lens: 71.5000 | lr: 1.7607e-06 | scale: 1024.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    642/  1000| tot_loss: 2.7494 | rl_loss: 1.1400 | pt_loss: 1.6094 | pg_loss: 0.2652 | reg_loss: 0.8748 | reward: -0.3867 | rev_kl: 0.6177 | stu_lens: 82.0000 | mixed_lens: 79.0000 | lr: 1.7524e-06 | scale: 1024.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    643/  1000| tot_loss: 2.1694 | rl_loss: 0.7567 | pt_loss: 1.4127 | pg_loss: 0.0794 | reg_loss: 0.6772 | reward: 0.0243 | rev_kl: 0.6923 | stu_lens: 123.5000 | mixed_lens: 119.5000 | lr: 1.7441e-06 | scale: 1024.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    644/  1000| tot_loss: 2.9564 | rl_loss: 1.0952 | pt_loss: 1.8612 | pg_loss: 0.2855 | reg_loss: 0.8097 | reward: -0.1002 | rev_kl: 0.4354 | stu_lens: 76.0000 | mixed_lens: 79.0000 | lr: 1.7358e-06 | scale: 1024.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    645/  1000| tot_loss: 3.2638 | rl_loss: 1.6485 | pt_loss: 1.6152 | pg_loss: 0.4357 | reg_loss: 1.2128 | reward: -4.1659 | rev_kl: 0.5986 | stu_lens: 70.5000 | mixed_lens: 66.0000 | lr: 1.7275e-06 | scale: 1024.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    646/  1000| tot_loss: 2.5423 | rl_loss: 0.9142 | pt_loss: 1.6281 | pg_loss: 0.2574 | reg_loss: 0.6568 | reward: 0.0381 | rev_kl: 0.5573 | stu_lens: 79.0000 | mixed_lens: 80.0000 | lr: 1.7192e-06 | scale: 1024.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    647/  1000| tot_loss: 3.0584 | rl_loss: 1.5400 | pt_loss: 1.5184 | pg_loss: 0.3330 | reg_loss: 1.2069 | reward: -0.7048 | rev_kl: 0.5671 | stu_lens: 87.5000 | mixed_lens: 81.0000 | lr: 1.7109e-06 | scale: 1024.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    648/  1000| tot_loss: 3.0021 | rl_loss: 1.7227 | pt_loss: 1.2794 | pg_loss: 0.4993 | reg_loss: 1.2234 | reward: -0.4177 | rev_kl: 0.8855 | stu_lens: 90.0000 | mixed_lens: 74.5000 | lr: 1.7026e-06 | scale: 1024.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    649/  1000| tot_loss: 3.0900 | rl_loss: 1.1187 | pt_loss: 1.9713 | pg_loss: 0.3824 | reg_loss: 0.7363 | reward: -0.2180 | rev_kl: 0.6154 | stu_lens: 77.5000 | mixed_lens: 69.0000 | lr: 1.6943e-06 | scale: 1024.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    650/  1000| tot_loss: 2.9138 | rl_loss: 1.0296 | pt_loss: 1.8842 | pg_loss: 0.2577 | reg_loss: 0.7720 | reward: -0.1104 | rev_kl: 1.0086 | stu_lens: 118.5000 | mixed_lens: 95.0000 | lr: 1.6861e-06 | scale: 1024.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    651/  1000| tot_loss: 2.9686 | rl_loss: 1.2630 | pt_loss: 1.7056 | pg_loss: 0.2343 | reg_loss: 1.0287 | reward: 0.1008 | rev_kl: 0.6090 | stu_lens: 57.0000 | mixed_lens: 67.5000 | lr: 1.6778e-06 | scale: 1024.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    652/  1000| tot_loss: 2.5444 | rl_loss: 1.4108 | pt_loss: 1.1336 | pg_loss: 0.3294 | reg_loss: 1.0814 | reward: -0.4350 | rev_kl: 0.5857 | stu_lens: 34.5000 | mixed_lens: 78.5000 | lr: 1.6696e-06 | scale: 1024.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    653/  1000| tot_loss: 3.3644 | rl_loss: 1.5984 | pt_loss: 1.7660 | pg_loss: 1.0251 | reg_loss: 0.5733 | reward: -0.4884 | rev_kl: 0.5324 | stu_lens: 46.5000 | mixed_lens: 36.5000 | lr: 1.6614e-06 | scale: 1024.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    654/  1000| tot_loss: 2.9517 | rl_loss: 1.0502 | pt_loss: 1.9016 | pg_loss: 0.2014 | reg_loss: 0.8488 | reward: -0.2982 | rev_kl: 0.7674 | stu_lens: 92.5000 | mixed_lens: 77.0000 | lr: 1.6532e-06 | scale: 1024.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    655/  1000| tot_loss: 3.2385 | rl_loss: 1.3695 | pt_loss: 1.8690 | pg_loss: 0.4092 | reg_loss: 0.9604 | reward: 0.0963 | rev_kl: 0.5882 | stu_lens: 72.0000 | mixed_lens: 72.0000 | lr: 1.6449e-06 | scale: 1024.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    656/  1000| tot_loss: 2.9373 | rl_loss: 1.2945 | pt_loss: 1.6428 | pg_loss: 0.1542 | reg_loss: 1.1402 | reward: -0.3459 | rev_kl: 0.4970 | stu_lens: 35.0000 | mixed_lens: 112.0000 | lr: 1.6368e-06 | scale: 1024.00 | time: 26.230 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    656/  1000| tot_loss: 3.0131 | rl_loss: 1.2846 | pt_loss: 1.7286 | pg_loss: 0.4009 | reg_loss: 0.8837 | reward: -0.4425 | rev_kl: 0.8477 | stu_lens: 73.7031 | mixed_lens: 75.7344 | lr: 1.6368e-06 | scale: 1024.00 | time: 26.230 | step time: 27.526
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    657/  1000| tot_loss: 2.7205 | rl_loss: 0.7488 | pt_loss: 1.9717 | pg_loss: 0.1948 | reg_loss: 0.5540 | reward: -0.2391 | rev_kl: 0.6568 | stu_lens: 127.5000 | mixed_lens: 79.0000 | lr: 1.6286e-06 | scale: 1024.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    658/  1000| tot_loss: 2.0911 | rl_loss: 0.6131 | pt_loss: 1.4780 | pg_loss: -0.0012 | reg_loss: 0.6143 | reward: -0.1326 | rev_kl: 0.8103 | stu_lens: 109.5000 | mixed_lens: 128.0000 | lr: 1.6204e-06 | scale: 1024.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    659/  1000| tot_loss: 2.8407 | rl_loss: 0.9004 | pt_loss: 1.9404 | pg_loss: 0.4348 | reg_loss: 0.4656 | reward: -0.0562 | rev_kl: 0.2338 | stu_lens: 79.0000 | mixed_lens: 79.0000 | lr: 1.6122e-06 | scale: 1024.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    660/  1000| tot_loss: 2.9957 | rl_loss: 1.3963 | pt_loss: 1.5995 | pg_loss: 0.3631 | reg_loss: 1.0331 | reward: -0.4961 | rev_kl: 0.7923 | stu_lens: 90.0000 | mixed_lens: 74.5000 | lr: 1.6041e-06 | scale: 1024.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    661/  1000| tot_loss: 2.9304 | rl_loss: 0.8945 | pt_loss: 2.0359 | pg_loss: -0.0094 | reg_loss: 0.9038 | reward: -0.0583 | rev_kl: 0.9136 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.5959e-06 | scale: 1024.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    662/  1000| tot_loss: 4.8296 | rl_loss: 3.1042 | pt_loss: 1.7254 | pg_loss: 2.0921 | reg_loss: 1.0121 | reward: -4.2336 | rev_kl: 0.4210 | stu_lens: 53.5000 | mixed_lens: 11.5000 | lr: 1.5878e-06 | scale: 1024.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    663/  1000| tot_loss: 3.6145 | rl_loss: 1.8050 | pt_loss: 1.8094 | pg_loss: 1.2050 | reg_loss: 0.6001 | reward: -0.8604 | rev_kl: 0.4638 | stu_lens: 112.5000 | mixed_lens: 28.5000 | lr: 1.5797e-06 | scale: 1024.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    664/  1000| tot_loss: 3.0244 | rl_loss: 1.0204 | pt_loss: 2.0040 | pg_loss: 0.2212 | reg_loss: 0.7992 | reward: -0.5679 | rev_kl: 0.6298 | stu_lens: 91.0000 | mixed_lens: 85.0000 | lr: 1.5716e-06 | scale: 1024.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    665/  1000| tot_loss: 0.6973 | rl_loss: -1.3743 | pt_loss: 2.0717 | pg_loss: -1.5089 | reg_loss: 0.1346 | reward: 0.2192 | rev_kl: 0.6259 | stu_lens: 20.5000 | mixed_lens: 22.5000 | lr: 1.5635e-06 | scale: 1024.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    666/  1000| tot_loss: 2.6743 | rl_loss: 0.8891 | pt_loss: 1.7853 | pg_loss: 0.1909 | reg_loss: 0.6982 | reward: -0.3597 | rev_kl: 0.8110 | stu_lens: 95.5000 | mixed_lens: 79.0000 | lr: 1.5554e-06 | scale: 1024.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    667/  1000| tot_loss: 2.3201 | rl_loss: 0.8376 | pt_loss: 1.4825 | pg_loss: 0.5370 | reg_loss: 0.3006 | reward: -0.1518 | rev_kl: 0.3871 | stu_lens: 42.5000 | mixed_lens: 32.5000 | lr: 1.5473e-06 | scale: 1024.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    668/  1000| tot_loss: 2.5904 | rl_loss: 1.0467 | pt_loss: 1.5437 | pg_loss: 0.4529 | reg_loss: 0.5938 | reward: -0.2648 | rev_kl: 0.9459 | stu_lens: 101.5000 | mixed_lens: 82.5000 | lr: 1.5393e-06 | scale: 1024.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    669/  1000| tot_loss: 2.3082 | rl_loss: 0.9634 | pt_loss: 1.3448 | pg_loss: 0.1753 | reg_loss: 0.7881 | reward: -0.4149 | rev_kl: 1.2081 | stu_lens: 74.5000 | mixed_lens: 102.0000 | lr: 1.5312e-06 | scale: 1024.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    670/  1000| tot_loss: 2.1902 | rl_loss: 0.6788 | pt_loss: 1.5114 | pg_loss: 0.0164 | reg_loss: 0.6624 | reward: -0.1463 | rev_kl: 0.5838 | stu_lens: 83.0000 | mixed_lens: 128.0000 | lr: 1.5232e-06 | scale: 1024.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    671/  1000| tot_loss: 2.2680 | rl_loss: 0.5902 | pt_loss: 1.6778 | pg_loss: 0.1240 | reg_loss: 0.4662 | reward: -0.2925 | rev_kl: 0.6430 | stu_lens: 58.0000 | mixed_lens: 102.5000 | lr: 1.5151e-06 | scale: 1024.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    672/  1000| tot_loss: 2.5184 | rl_loss: 0.7917 | pt_loss: 1.7267 | pg_loss: 0.0348 | reg_loss: 0.7569 | reward: -0.2424 | rev_kl: 0.5592 | stu_lens: 74.0000 | mixed_lens: 119.5000 | lr: 1.5071e-06 | scale: 1024.00 | time: 26.227 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    672/  1000| tot_loss: 2.6712 | rl_loss: 0.9531 | pt_loss: 1.7181 | pg_loss: 0.3047 | reg_loss: 0.6484 | reward: -0.4869 | rev_kl: 0.8275 | stu_lens: 78.5938 | mixed_lens: 80.7188 | lr: 1.5071e-06 | scale: 1024.00 | time: 26.227 | step time: 27.520
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    673/  1000| tot_loss: 2.4249 | rl_loss: 0.9962 | pt_loss: 1.4288 | pg_loss: -0.1457 | reg_loss: 1.1418 | reward: 0.3634 | rev_kl: 1.5712 | stu_lens: 13.0000 | mixed_lens: 13.0000 | lr: 1.4991e-06 | scale: 1024.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    674/  1000| tot_loss: 3.1827 | rl_loss: 1.6588 | pt_loss: 1.5238 | pg_loss: 1.0301 | reg_loss: 0.6287 | reward: -0.0662 | rev_kl: 0.3425 | stu_lens: 38.5000 | mixed_lens: 27.5000 | lr: 1.4911e-06 | scale: 1024.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    675/  1000| tot_loss: 2.3971 | rl_loss: 0.5582 | pt_loss: 1.8389 | pg_loss: -0.0340 | reg_loss: 0.5922 | reward: -0.2405 | rev_kl: 0.8230 | stu_lens: 125.0000 | mixed_lens: 128.0000 | lr: 1.4832e-06 | scale: 1024.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    676/  1000| tot_loss: 2.4336 | rl_loss: 0.7217 | pt_loss: 1.7119 | pg_loss: -0.0098 | reg_loss: 0.7315 | reward: -0.2935 | rev_kl: 0.6241 | stu_lens: 34.5000 | mixed_lens: 128.0000 | lr: 1.4752e-06 | scale: 1024.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    677/  1000| tot_loss: 2.1620 | rl_loss: 0.6842 | pt_loss: 1.4778 | pg_loss: 0.1426 | reg_loss: 0.5417 | reward: -0.1471 | rev_kl: 5.1397 | stu_lens: 75.0000 | mixed_lens: 95.0000 | lr: 1.4672e-06 | scale: 1024.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    678/  1000| tot_loss: 2.3730 | rl_loss: 0.7796 | pt_loss: 1.5934 | pg_loss: 0.3054 | reg_loss: 0.4742 | reward: -0.2741 | rev_kl: 0.6732 | stu_lens: 128.0000 | mixed_lens: 89.5000 | lr: 1.4593e-06 | scale: 1024.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    679/  1000| tot_loss: 2.2659 | rl_loss: 0.6493 | pt_loss: 1.6166 | pg_loss: 0.2171 | reg_loss: 0.4322 | reward: -0.4060 | rev_kl: 0.4566 | stu_lens: 61.0000 | mixed_lens: 79.0000 | lr: 1.4514e-06 | scale: 1024.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    680/  1000| tot_loss: 2.1248 | rl_loss: 0.3407 | pt_loss: 1.7842 | pg_loss: 0.0012 | reg_loss: 0.3395 | reward: -0.1268 | rev_kl: 0.6130 | stu_lens: 121.5000 | mixed_lens: 122.0000 | lr: 1.4435e-06 | scale: 1024.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    681/  1000| tot_loss: 2.0114 | rl_loss: 0.4839 | pt_loss: 1.5275 | pg_loss: 0.0326 | reg_loss: 0.4513 | reward: -0.1732 | rev_kl: 1.1338 | stu_lens: 58.0000 | mixed_lens: 122.0000 | lr: 1.4356e-06 | scale: 1024.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    682/  1000| tot_loss: 2.3821 | rl_loss: 0.8321 | pt_loss: 1.5499 | pg_loss: 0.2450 | reg_loss: 0.5872 | reward: -0.0059 | rev_kl: 1.7814 | stu_lens: 61.0000 | mixed_lens: 62.0000 | lr: 1.4277e-06 | scale: 1024.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    683/  1000| tot_loss: 2.2244 | rl_loss: 0.6928 | pt_loss: 1.5316 | pg_loss: 0.0780 | reg_loss: 0.6148 | reward: -0.1937 | rev_kl: 0.8338 | stu_lens: 111.0000 | mixed_lens: 115.5000 | lr: 1.4198e-06 | scale: 1024.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    684/  1000| tot_loss: 2.3536 | rl_loss: 0.5211 | pt_loss: 1.8325 | pg_loss: 0.2233 | reg_loss: 0.2978 | reward: -3.9965 | rev_kl: 0.3034 | stu_lens: 51.0000 | mixed_lens: 58.5000 | lr: 1.4119e-06 | scale: 1024.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    685/  1000| tot_loss: 2.8449 | rl_loss: 1.4333 | pt_loss: 1.4116 | pg_loss: 0.7845 | reg_loss: 0.6488 | reward: -0.4533 | rev_kl: 0.8450 | stu_lens: 62.0000 | mixed_lens: 52.5000 | lr: 1.4041e-06 | scale: 1024.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    686/  1000| tot_loss: 2.7324 | rl_loss: 0.7823 | pt_loss: 1.9500 | pg_loss: 0.4114 | reg_loss: 0.3709 | reward: -0.6590 | rev_kl: 0.9570 | stu_lens: 37.0000 | mixed_lens: 61.0000 | lr: 1.3962e-06 | scale: 1024.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    687/  1000| tot_loss: 1.9449 | rl_loss: 0.6083 | pt_loss: 1.3366 | pg_loss: 0.2235 | reg_loss: 0.3848 | reward: 0.3024 | rev_kl: 0.2124 | stu_lens: 16.5000 | mixed_lens: 22.5000 | lr: 1.3884e-06 | scale: 1024.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    688/  1000| tot_loss: 3.4202 | rl_loss: 2.0148 | pt_loss: 1.4053 | pg_loss: 1.7562 | reg_loss: 0.2586 | reward: -0.3967 | rev_kl: 0.3284 | stu_lens: 14.5000 | mixed_lens: 14.5000 | lr: 1.3806e-06 | scale: 1024.00 | time: 26.227 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    688/  1000| tot_loss: 2.4073 | rl_loss: 0.7184 | pt_loss: 1.6889 | pg_loss: 0.2198 | reg_loss: 0.4986 | reward: -0.4515 | rev_kl: 0.8766 | stu_lens: 73.2656 | mixed_lens: 78.5312 | lr: 1.3806e-06 | scale: 1024.00 | time: 26.227 | step time: 27.521
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    689/  1000| tot_loss: 1.7779 | rl_loss: -0.0071 | pt_loss: 1.7851 | pg_loss: -0.1524 | reg_loss: 0.1453 | reward: -0.0050 | rev_kl: 0.6929 | stu_lens: 72.0000 | mixed_lens: 34.0000 | lr: 1.3728e-06 | scale: 1024.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    690/  1000| tot_loss: 1.9680 | rl_loss: 0.4444 | pt_loss: 1.5236 | pg_loss: 0.2456 | reg_loss: 0.1988 | reward: 0.0165 | rev_kl: 0.3139 | stu_lens: 45.5000 | mixed_lens: 65.0000 | lr: 1.3650e-06 | scale: 1024.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    691/  1000| tot_loss: 2.2502 | rl_loss: 0.4544 | pt_loss: 1.7958 | pg_loss: 0.1020 | reg_loss: 0.3524 | reward: -0.2988 | rev_kl: 0.8233 | stu_lens: 111.0000 | mixed_lens: 115.5000 | lr: 1.3573e-06 | scale: 1024.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    692/  1000| tot_loss: 1.6276 | rl_loss: 0.4132 | pt_loss: 1.2144 | pg_loss: -0.0181 | reg_loss: 0.4313 | reward: -0.1763 | rev_kl: 0.4711 | stu_lens: 83.5000 | mixed_lens: 128.0000 | lr: 1.3495e-06 | scale: 1024.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    693/  1000| tot_loss: 1.2368 | rl_loss: 0.0283 | pt_loss: 1.2084 | pg_loss: -0.2298 | reg_loss: 0.2581 | reward: -0.1405 | rev_kl: 1.0212 | stu_lens: 63.5000 | mixed_lens: 21.0000 | lr: 1.3418e-06 | scale: 1024.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    694/  1000| tot_loss: 1.6958 | rl_loss: 0.3738 | pt_loss: 1.3220 | pg_loss: -0.0176 | reg_loss: 0.3914 | reward: -0.1007 | rev_kl: 0.8496 | stu_lens: 114.5000 | mixed_lens: 128.0000 | lr: 1.3340e-06 | scale: 1024.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    695/  1000| tot_loss: 2.5817 | rl_loss: 0.7055 | pt_loss: 1.8762 | pg_loss: 0.3437 | reg_loss: 0.3618 | reward: -0.3679 | rev_kl: 0.6376 | stu_lens: 128.0000 | mixed_lens: 55.5000 | lr: 1.3263e-06 | scale: 1024.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    696/  1000| tot_loss: 2.1501 | rl_loss: 0.4076 | pt_loss: 1.7425 | pg_loss: 0.1413 | reg_loss: 0.2664 | reward: -0.3132 | rev_kl: 0.6365 | stu_lens: 92.0000 | mixed_lens: 92.0000 | lr: 1.3186e-06 | scale: 1024.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    697/  1000| tot_loss: 2.8125 | rl_loss: 0.9701 | pt_loss: 1.8424 | pg_loss: 0.6647 | reg_loss: 0.3053 | reward: -0.3547 | rev_kl: 0.8296 | stu_lens: 94.5000 | mixed_lens: 41.0000 | lr: 1.3109e-06 | scale: 1024.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    698/  1000| tot_loss: 2.5495 | rl_loss: 0.7189 | pt_loss: 1.8306 | pg_loss: 0.2830 | reg_loss: 0.4359 | reward: 0.3508 | rev_kl: 0.0608 | stu_lens: 45.0000 | mixed_lens: 70.0000 | lr: 1.3033e-06 | scale: 1024.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    699/  1000| tot_loss: 2.0619 | rl_loss: 0.6625 | pt_loss: 1.3994 | pg_loss: 0.3232 | reg_loss: 0.3393 | reward: -0.2697 | rev_kl: 0.4613 | stu_lens: 27.5000 | mixed_lens: 63.0000 | lr: 1.2956e-06 | scale: 1024.00 | time: 26.249 | step time: 0.000
                                 Evaluation #7                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ dime un chiste acerca de la situacion │ dime un chiste acerca de la          │
│ actual de la economia, de modo que    │ situacion actual de la economia, de  │
│ los niños comprendan el mal estado de │ modo que los niños comprendan el mal │
│ la misma.                             │ estado de la misma.                  │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ La economia es un sistema en el cual │
│                                       │ la gente es capaz de comprar cosas   │
│                                       │ con dinero, y eso les permite vivir. │
│                                       │ Sin embargo, actualmente la gente no │
│                                       │ puede comprar tanto como antes,      │
│                                       │ debido a que el dinero ya no vale lo │
│                                       │ que valía, por lo que la gente no    │
│                                       │ puede vivir de manera cómoda. Pero   │
│                                       │ la gente también no puede hacerse    │
│                                       │ cargo de las cosas, por lo que otras │
│                                       │ personas se han visto obligadas a    │
│                                       │ hacerlo. Esto les ha permitido       │
│                                       │ seguir viviendo, pero sólo gracias a │
│                                       │ las personas                         │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Sí, por supuesto. También es un      │
│                                       │ chiste con mucho sentido y mucha     │
│                                       │ gracia. Es un chiste de por medio.   │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Claro que puedo. Este chiste es      │
│                                       │ fácil de entender si te das cuenta   │
│                                       │ de que los españoles dicen "gracias" │
│                                       │ por todo. "No entiendo la gracia de  │
│                                       │ este chiste" es lógico si "gracias"  │
│                                       │ es entrecomillado.                   │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.300 | exact_match: 0.103 | rev_kl: 0.963 | lens: 93.629 | pt_loss: 1.740 | lm_loss: 1.877 | kd_loss: 1.604 
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    700/  1000| tot_loss: 2.7592 | rl_loss: 0.9244 | pt_loss: 1.8348 | pg_loss: 0.5435 | reg_loss: 0.3809 | reward: -0.7842 | rev_kl: 1.1944 | stu_lens: 37.5000 | mixed_lens: 68.0000 | lr: 1.2880e-06 | scale: 1024.00 | time: 26.225 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    701/  1000| tot_loss: 1.8080 | rl_loss: 0.3651 | pt_loss: 1.4429 | pg_loss: 0.0137 | reg_loss: 0.3514 | reward: -0.1061 | rev_kl: 0.9307 | stu_lens: 89.5000 | mixed_lens: 122.0000 | lr: 1.2804e-06 | scale: 1024.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    702/  1000| tot_loss: 2.5166 | rl_loss: 0.7342 | pt_loss: 1.7824 | pg_loss: 0.4463 | reg_loss: 0.2880 | reward: -0.5303 | rev_kl: 0.6448 | stu_lens: 38.5000 | mixed_lens: 33.0000 | lr: 1.2727e-06 | scale: 1024.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    703/  1000| tot_loss: 2.7875 | rl_loss: 0.8357 | pt_loss: 1.9518 | pg_loss: 0.3201 | reg_loss: 0.5156 | reward: -4.0846 | rev_kl: 0.5863 | stu_lens: 26.5000 | mixed_lens: 66.0000 | lr: 1.2651e-06 | scale: 1024.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    704/  1000| tot_loss: 2.8704 | rl_loss: 1.0233 | pt_loss: 1.8471 | pg_loss: -0.0315 | reg_loss: 1.0548 | reward: -0.3763 | rev_kl: 1.9315 | stu_lens: 27.5000 | mixed_lens: 17.0000 | lr: 1.2576e-06 | scale: 1024.00 | time: 26.229 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    704/  1000| tot_loss: 2.3834 | rl_loss: 0.7083 | pt_loss: 1.6751 | pg_loss: 0.2951 | reg_loss: 0.4131 | reward: -0.4823 | rev_kl: 0.8499 | stu_lens: 70.2656 | mixed_lens: 72.7031 | lr: 1.2576e-06 | scale: 1024.00 | time: 26.229 | step time: 27.524
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    705/  1000| tot_loss: 2.1363 | rl_loss: 0.4621 | pt_loss: 1.6742 | pg_loss: 0.0036 | reg_loss: 0.4585 | reward: -0.0693 | rev_kl: 0.6831 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.2500e-06 | scale: 1024.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    706/  1000| tot_loss: 3.1379 | rl_loss: 1.3400 | pt_loss: 1.7979 | pg_loss: 0.4084 | reg_loss: 0.9316 | reward: -0.2638 | rev_kl: 0.9008 | stu_lens: 121.5000 | mixed_lens: 75.0000 | lr: 1.2425e-06 | scale: 1024.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    707/  1000| tot_loss: 2.5762 | rl_loss: 0.9337 | pt_loss: 1.6424 | pg_loss: 0.0471 | reg_loss: 0.8867 | reward: -0.1563 | rev_kl: 0.8105 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.2349e-06 | scale: 1024.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    708/  1000| tot_loss: 2.6316 | rl_loss: 1.0020 | pt_loss: 1.6296 | pg_loss: 0.0259 | reg_loss: 0.9761 | reward: -0.4198 | rev_kl: 0.8702 | stu_lens: 98.5000 | mixed_lens: 128.0000 | lr: 1.2274e-06 | scale: 1024.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    709/  1000| tot_loss: 2.0853 | rl_loss: 0.9784 | pt_loss: 1.1070 | pg_loss: 0.0671 | reg_loss: 0.9112 | reward: -0.0932 | rev_kl: 0.9204 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.2199e-06 | scale: 1024.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    710/  1000| tot_loss: 2.8934 | rl_loss: 1.3556 | pt_loss: 1.5378 | pg_loss: 0.2048 | reg_loss: 1.1507 | reward: -0.2611 | rev_kl: 0.7263 | stu_lens: 83.5000 | mixed_lens: 84.5000 | lr: 1.2124e-06 | scale: 1024.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    711/  1000| tot_loss: 2.4074 | rl_loss: 0.9456 | pt_loss: 1.4618 | pg_loss: 0.0538 | reg_loss: 0.8918 | reward: -0.1998 | rev_kl: 1.0061 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.2049e-06 | scale: 1024.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    712/  1000| tot_loss: 2.3912 | rl_loss: 0.7751 | pt_loss: 1.6161 | pg_loss: 0.1262 | reg_loss: 0.6489 | reward: -0.2635 | rev_kl: 0.4799 | stu_lens: 107.5000 | mixed_lens: 119.5000 | lr: 1.1975e-06 | scale: 1024.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    713/  1000| tot_loss: 2.1282 | rl_loss: 0.7866 | pt_loss: 1.3416 | pg_loss: 0.0374 | reg_loss: 0.7492 | reward: -0.1593 | rev_kl: 0.4587 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.1900e-06 | scale: 1024.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    714/  1000| tot_loss: 3.1888 | rl_loss: 1.6983 | pt_loss: 1.4904 | pg_loss: 0.6353 | reg_loss: 1.0630 | reward: -0.1134 | rev_kl: 0.9295 | stu_lens: 14.5000 | mixed_lens: 50.5000 | lr: 1.1826e-06 | scale: 1024.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    715/  1000| tot_loss: 3.1482 | rl_loss: 1.2603 | pt_loss: 1.8879 | pg_loss: 0.0746 | reg_loss: 1.1857 | reward: -0.1565 | rev_kl: 1.2454 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.1752e-06 | scale: 1024.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    716/  1000| tot_loss: 2.9669 | rl_loss: 1.2106 | pt_loss: 1.7563 | pg_loss: 0.3312 | reg_loss: 0.8795 | reward: -0.1707 | rev_kl: 0.6158 | stu_lens: 120.5000 | mixed_lens: 98.0000 | lr: 1.1678e-06 | scale: 1024.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    717/  1000| tot_loss: 2.5266 | rl_loss: 0.8551 | pt_loss: 1.6715 | pg_loss: 0.0483 | reg_loss: 0.8068 | reward: -0.2439 | rev_kl: 0.7168 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.1604e-06 | scale: 1024.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    718/  1000| tot_loss: 2.8476 | rl_loss: 0.9424 | pt_loss: 1.9052 | pg_loss: 0.1324 | reg_loss: 0.8100 | reward: -0.2086 | rev_kl: 0.4889 | stu_lens: 103.5000 | mixed_lens: 118.5000 | lr: 1.1531e-06 | scale: 1024.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    719/  1000| tot_loss: 3.2154 | rl_loss: 1.1897 | pt_loss: 2.0257 | pg_loss: 0.3475 | reg_loss: 0.8422 | reward: -0.6161 | rev_kl: 0.9391 | stu_lens: 73.5000 | mixed_lens: 75.5000 | lr: 1.1457e-06 | scale: 1024.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    720/  1000| tot_loss: 3.1261 | rl_loss: 1.0861 | pt_loss: 2.0400 | pg_loss: 0.0833 | reg_loss: 1.0028 | reward: -0.2797 | rev_kl: 0.6404 | stu_lens: 102.5000 | mixed_lens: 128.0000 | lr: 1.1384e-06 | scale: 1024.00 | time: 26.247 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    720/  1000| tot_loss: 2.9333 | rl_loss: 1.2325 | pt_loss: 1.7008 | pg_loss: 0.3641 | reg_loss: 0.8683 | reward: -0.3490 | rev_kl: 0.8008 | stu_lens: 87.9844 | mixed_lens: 92.5469 | lr: 1.1384e-06 | scale: 1024.00 | time: 26.247 | step time: 27.511
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    721/  1000| tot_loss: 2.9501 | rl_loss: 0.9738 | pt_loss: 1.9763 | pg_loss: 0.0462 | reg_loss: 0.9276 | reward: -0.1703 | rev_kl: 0.8551 | stu_lens: 127.5000 | mixed_lens: 128.0000 | lr: 1.1311e-06 | scale: 1024.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    722/  1000| tot_loss: 2.5719 | rl_loss: 0.7917 | pt_loss: 1.7802 | pg_loss: 0.0942 | reg_loss: 0.6975 | reward: -0.2520 | rev_kl: 0.6641 | stu_lens: 107.5000 | mixed_lens: 119.5000 | lr: 1.1238e-06 | scale: 1024.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    723/  1000| tot_loss: 2.9420 | rl_loss: 1.3417 | pt_loss: 1.6003 | pg_loss: 0.9925 | reg_loss: 0.3492 | reward: 0.0509 | rev_kl: 0.8236 | stu_lens: 33.0000 | mixed_lens: 35.5000 | lr: 1.1165e-06 | scale: 1024.00 | time: 26.220 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    724/  1000| tot_loss: 3.4715 | rl_loss: 1.3921 | pt_loss: 2.0793 | pg_loss: 0.4706 | reg_loss: 0.9216 | reward: -0.3803 | rev_kl: 0.5580 | stu_lens: 67.5000 | mixed_lens: 68.0000 | lr: 1.1093e-06 | scale: 1024.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    725/  1000| tot_loss: 2.5956 | rl_loss: 0.7297 | pt_loss: 1.8658 | pg_loss: 0.1753 | reg_loss: 0.5544 | reward: -0.5769 | rev_kl: 0.8425 | stu_lens: 82.5000 | mixed_lens: 75.5000 | lr: 1.1020e-06 | scale: 1024.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    726/  1000| tot_loss: 2.5082 | rl_loss: 1.0248 | pt_loss: 1.4835 | pg_loss: 0.0233 | reg_loss: 1.0015 | reward: -0.3278 | rev_kl: 0.8175 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.0948e-06 | scale: 1024.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    727/  1000| tot_loss: 1.8913 | rl_loss: 0.9201 | pt_loss: 0.9712 | pg_loss: 0.0097 | reg_loss: 0.9104 | reward: -0.3280 | rev_kl: 0.8032 | stu_lens: 77.0000 | mixed_lens: 128.0000 | lr: 1.0876e-06 | scale: 1024.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    728/  1000| tot_loss: 3.0738 | rl_loss: 1.2320 | pt_loss: 1.8418 | pg_loss: 0.4705 | reg_loss: 0.7615 | reward: -1.6413 | rev_kl: 1.0153 | stu_lens: 62.0000 | mixed_lens: 69.0000 | lr: 1.0804e-06 | scale: 1024.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    729/  1000| tot_loss: 2.8344 | rl_loss: 0.9676 | pt_loss: 1.8668 | pg_loss: 0.1924 | reg_loss: 0.7752 | reward: -0.6944 | rev_kl: 1.2377 | stu_lens: 65.5000 | mixed_lens: 70.5000 | lr: 1.0732e-06 | scale: 1024.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    730/  1000| tot_loss: 2.3654 | rl_loss: 0.6759 | pt_loss: 1.6895 | pg_loss: 0.0024 | reg_loss: 0.6735 | reward: -0.2446 | rev_kl: 0.5753 | stu_lens: 101.0000 | mixed_lens: 128.0000 | lr: 1.0661e-06 | scale: 1024.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    731/  1000| tot_loss: 2.3375 | rl_loss: 1.3507 | pt_loss: 0.9868 | pg_loss: 0.4053 | reg_loss: 0.9454 | reward: -0.5297 | rev_kl: 0.9754 | stu_lens: 121.5000 | mixed_lens: 87.5000 | lr: 1.0589e-06 | scale: 1024.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    732/  1000| tot_loss: 2.5055 | rl_loss: 0.7591 | pt_loss: 1.7464 | pg_loss: 0.1183 | reg_loss: 0.6408 | reward: -0.0679 | rev_kl: 0.3688 | stu_lens: 90.5000 | mixed_lens: 90.5000 | lr: 1.0518e-06 | scale: 1024.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    733/  1000| tot_loss: 2.5683 | rl_loss: 0.6833 | pt_loss: 1.8850 | pg_loss: -0.0231 | reg_loss: 0.7064 | reward: -0.1658 | rev_kl: 0.7478 | stu_lens: 95.5000 | mixed_lens: 128.0000 | lr: 1.0447e-06 | scale: 1024.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    734/  1000| tot_loss: 3.0260 | rl_loss: 1.0338 | pt_loss: 1.9922 | pg_loss: 0.2736 | reg_loss: 0.7602 | reward: -0.5546 | rev_kl: 0.9952 | stu_lens: 71.5000 | mixed_lens: 71.5000 | lr: 1.0376e-06 | scale: 1024.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    735/  1000| tot_loss: 2.7758 | rl_loss: 0.8845 | pt_loss: 1.8913 | pg_loss: 0.1448 | reg_loss: 0.7398 | reward: -0.3645 | rev_kl: 0.8773 | stu_lens: 119.0000 | mixed_lens: 92.0000 | lr: 1.0305e-06 | scale: 1024.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    736/  1000| tot_loss: 3.7705 | rl_loss: 1.9125 | pt_loss: 1.8580 | pg_loss: 1.7677 | reg_loss: 0.1448 | reward: -1.4187 | rev_kl: 2.0474 | stu_lens: 11.5000 | mixed_lens: 11.0000 | lr: 1.0235e-06 | scale: 1024.00 | time: 26.270 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    736/  1000| tot_loss: 2.6967 | rl_loss: 0.9593 | pt_loss: 1.7374 | pg_loss: 0.2419 | reg_loss: 0.7174 | reward: -0.3527 | rev_kl: 0.8085 | stu_lens: 89.1094 | mixed_lens: 96.1094 | lr: 1.0235e-06 | scale: 1024.00 | time: 26.270 | step time: 27.507
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    737/  1000| tot_loss: 2.1021 | rl_loss: 1.0015 | pt_loss: 1.1006 | pg_loss: 0.3317 | reg_loss: 0.6698 | reward: -0.3886 | rev_kl: 0.5597 | stu_lens: 77.0000 | mixed_lens: 75.0000 | lr: 1.0165e-06 | scale: 1024.00 | time: 26.220 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    738/  1000| tot_loss: 2.8866 | rl_loss: 0.8118 | pt_loss: 2.0748 | pg_loss: 0.2250 | reg_loss: 0.5868 | reward: -0.2003 | rev_kl: 0.7595 | stu_lens: 120.5000 | mixed_lens: 98.0000 | lr: 1.0094e-06 | scale: 1024.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    739/  1000| tot_loss: 2.1940 | rl_loss: 0.4687 | pt_loss: 1.7253 | pg_loss: -0.0204 | reg_loss: 0.4891 | reward: -0.2143 | rev_kl: 0.5730 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.0024e-06 | scale: 1024.00 | time: 26.225 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    740/  1000| tot_loss: 2.4804 | rl_loss: 0.5572 | pt_loss: 1.9231 | pg_loss: -0.0054 | reg_loss: 0.5626 | reward: -0.1929 | rev_kl: 1.0538 | stu_lens: 120.5000 | mixed_lens: 128.0000 | lr: 9.9546e-07 | scale: 1024.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    741/  1000| tot_loss: 2.4005 | rl_loss: 0.8974 | pt_loss: 1.5030 | pg_loss: 0.4181 | reg_loss: 0.4793 | reward: 0.1303 | rev_kl: 0.8549 | stu_lens: 77.5000 | mixed_lens: 79.0000 | lr: 9.8850e-07 | scale: 1024.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    742/  1000| tot_loss: 2.2418 | rl_loss: 0.7020 | pt_loss: 1.5398 | pg_loss: -0.0276 | reg_loss: 0.7297 | reward: -0.2158 | rev_kl: 0.8326 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 9.8156e-07 | scale: 1024.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    743/  1000| tot_loss: 2.4253 | rl_loss: 0.7726 | pt_loss: 1.6527 | pg_loss: -0.0266 | reg_loss: 0.7992 | reward: -0.1656 | rev_kl: 0.8433 | stu_lens: 95.5000 | mixed_lens: 128.0000 | lr: 9.7464e-07 | scale: 1024.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    744/  1000| tot_loss: 2.8697 | rl_loss: 1.0469 | pt_loss: 1.8227 | pg_loss: 0.4026 | reg_loss: 0.6443 | reward: -0.4543 | rev_kl: 0.5609 | stu_lens: 66.0000 | mixed_lens: 71.5000 | lr: 9.6773e-07 | scale: 1024.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    745/  1000| tot_loss: 2.1186 | rl_loss: 0.8114 | pt_loss: 1.3072 | pg_loss: 0.2111 | reg_loss: 0.6003 | reward: -0.4626 | rev_kl: 1.9211 | stu_lens: 69.0000 | mixed_lens: 68.5000 | lr: 9.6085e-07 | scale: 1024.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    746/  1000| tot_loss: 2.9308 | rl_loss: 1.4003 | pt_loss: 1.5304 | pg_loss: 1.0053 | reg_loss: 0.3950 | reward: -1.1182 | rev_kl: 1.0616 | stu_lens: 26.0000 | mixed_lens: 27.0000 | lr: 9.5398e-07 | scale: 1024.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    747/  1000| tot_loss: 2.1736 | rl_loss: 0.6736 | pt_loss: 1.4999 | pg_loss: -0.0123 | reg_loss: 0.6859 | reward: -0.3070 | rev_kl: 0.6981 | stu_lens: 86.5000 | mixed_lens: 128.0000 | lr: 9.4713e-07 | scale: 1024.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    748/  1000| tot_loss: 1.4096 | rl_loss: -0.2665 | pt_loss: 1.6762 | pg_loss: -1.2707 | reg_loss: 1.0042 | reward: 0.3163 | rev_kl: 0.6294 | stu_lens: 9.5000 | mixed_lens: 13.0000 | lr: 9.4030e-07 | scale: 1024.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    749/  1000| tot_loss: 2.4137 | rl_loss: 0.4582 | pt_loss: 1.9556 | pg_loss: 0.0208 | reg_loss: 0.4373 | reward: -0.7623 | rev_kl: 0.9775 | stu_lens: 65.5000 | mixed_lens: 70.5000 | lr: 9.3349e-07 | scale: 1024.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    750/  1000| tot_loss: 2.7424 | rl_loss: 1.0405 | pt_loss: 1.7019 | pg_loss: 0.5698 | reg_loss: 0.4707 | reward: 0.1279 | rev_kl: 0.6037 | stu_lens: 53.5000 | mixed_lens: 58.5000 | lr: 9.2670e-07 | scale: 1024.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    751/  1000| tot_loss: 2.3657 | rl_loss: 0.5379 | pt_loss: 1.8278 | pg_loss: 0.1455 | reg_loss: 0.3923 | reward: -0.5307 | rev_kl: 0.9636 | stu_lens: 82.5000 | mixed_lens: 75.5000 | lr: 9.1993e-07 | scale: 1024.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    752/  1000| tot_loss: 2.7408 | rl_loss: 0.9802 | pt_loss: 1.7606 | pg_loss: 0.3877 | reg_loss: 0.5925 | reward: -1.0819 | rev_kl: 0.6168 | stu_lens: 105.0000 | mixed_lens: 75.5000 | lr: 9.1317e-07 | scale: 1024.00 | time: 26.241 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    752/  1000| tot_loss: 2.4902 | rl_loss: 0.7828 | pt_loss: 1.7073 | pg_loss: 0.1942 | reg_loss: 0.5886 | reward: -0.3426 | rev_kl: 0.7958 | stu_lens: 85.7031 | mixed_lens: 92.1250 | lr: 9.1317e-07 | scale: 1024.00 | time: 26.241 | step time: 27.505
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    753/  1000| tot_loss: 2.6325 | rl_loss: 0.8435 | pt_loss: 1.7890 | pg_loss: 0.3138 | reg_loss: 0.5297 | reward: -0.3375 | rev_kl: 0.9852 | stu_lens: 121.5000 | mixed_lens: 87.5000 | lr: 9.0644e-07 | scale: 1024.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    754/  1000| tot_loss: 2.3826 | rl_loss: 0.3075 | pt_loss: 2.0751 | pg_loss: 0.2492 | reg_loss: 0.0583 | reward: -0.5068 | rev_kl: 0.4765 | stu_lens: 34.0000 | mixed_lens: 34.0000 | lr: 8.9973e-07 | scale: 1024.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    755/  1000| tot_loss: 2.8750 | rl_loss: 0.7505 | pt_loss: 2.1245 | pg_loss: 0.2496 | reg_loss: 0.5009 | reward: -0.3322 | rev_kl: 0.2863 | stu_lens: 71.0000 | mixed_lens: 88.5000 | lr: 8.9303e-07 | scale: 1024.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    756/  1000| tot_loss: 2.4396 | rl_loss: 0.6547 | pt_loss: 1.7848 | pg_loss: -0.0077 | reg_loss: 0.6625 | reward: -0.3516 | rev_kl: 0.9895 | stu_lens: 95.5000 | mixed_lens: 128.0000 | lr: 8.8636e-07 | scale: 1024.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    757/  1000| tot_loss: 2.9209 | rl_loss: 0.5014 | pt_loss: 2.4195 | pg_loss: 0.0507 | reg_loss: 0.4507 | reward: -0.0555 | rev_kl: 0.8042 | stu_lens: 128.0000 | mixed_lens: 115.5000 | lr: 8.7970e-07 | scale: 1024.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    758/  1000| tot_loss: 2.4041 | rl_loss: 0.6076 | pt_loss: 1.7965 | pg_loss: -0.0134 | reg_loss: 0.6210 | reward: -0.1131 | rev_kl: 0.8787 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 8.7306e-07 | scale: 1024.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    759/  1000| tot_loss: 2.6811 | rl_loss: 0.8335 | pt_loss: 1.8475 | pg_loss: 0.4254 | reg_loss: 0.4081 | reward: 0.1756 | rev_kl: 0.8231 | stu_lens: 74.0000 | mixed_lens: 67.0000 | lr: 8.6645e-07 | scale: 1024.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    760/  1000| tot_loss: 2.7590 | rl_loss: 1.1953 | pt_loss: 1.5637 | pg_loss: 0.4601 | reg_loss: 0.7352 | reward: -1.7129 | rev_kl: 1.0769 | stu_lens: 69.5000 | mixed_lens: 69.0000 | lr: 8.5985e-07 | scale: 1024.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    761/  1000| tot_loss: 2.4338 | rl_loss: 0.4868 | pt_loss: 1.9470 | pg_loss: -0.0155 | reg_loss: 0.5023 | reward: -0.1682 | rev_kl: 0.9154 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 8.5328e-07 | scale: 1024.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    762/  1000| tot_loss: 2.2827 | rl_loss: 0.7766 | pt_loss: 1.5061 | pg_loss: 0.2669 | reg_loss: 0.5098 | reward: -0.0577 | rev_kl: 0.8796 | stu_lens: 83.5000 | mixed_lens: 84.5000 | lr: 8.4672e-07 | scale: 1024.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    763/  1000| tot_loss: 2.2640 | rl_loss: 0.4176 | pt_loss: 1.8465 | pg_loss: -0.0253 | reg_loss: 0.4428 | reward: -0.1914 | rev_kl: 0.5765 | stu_lens: 119.0000 | mixed_lens: 128.0000 | lr: 8.4018e-07 | scale: 1024.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    764/  1000| tot_loss: 2.2856 | rl_loss: 0.5266 | pt_loss: 1.7591 | pg_loss: -0.0385 | reg_loss: 0.5650 | reward: -0.3019 | rev_kl: 0.8837 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 8.3367e-07 | scale: 1024.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    765/  1000| tot_loss: 2.2060 | rl_loss: 0.4978 | pt_loss: 1.7081 | pg_loss: 0.0055 | reg_loss: 0.4923 | reward: -0.3230 | rev_kl: 0.5827 | stu_lens: 107.5000 | mixed_lens: 119.5000 | lr: 8.2717e-07 | scale: 1024.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    766/  1000| tot_loss: 2.4408 | rl_loss: 0.6853 | pt_loss: 1.7556 | pg_loss: 0.2162 | reg_loss: 0.4691 | reward: -0.1750 | rev_kl: 0.5851 | stu_lens: 70.0000 | mixed_lens: 95.0000 | lr: 8.2070e-07 | scale: 1024.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    767/  1000| tot_loss: 2.1444 | rl_loss: 0.4046 | pt_loss: 1.7399 | pg_loss: 0.0167 | reg_loss: 0.3879 | reward: -0.7161 | rev_kl: 1.0985 | stu_lens: 65.5000 | mixed_lens: 70.5000 | lr: 8.1424e-07 | scale: 1024.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    768/  1000| tot_loss: 2.1241 | rl_loss: 0.4205 | pt_loss: 1.7036 | pg_loss: 0.0973 | reg_loss: 0.3232 | reward: -0.1102 | rev_kl: 0.5071 | stu_lens: 71.0000 | mixed_lens: 98.0000 | lr: 8.0781e-07 | scale: 1024.00 | time: 26.246 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    768/  1000| tot_loss: 2.4830 | rl_loss: 0.7332 | pt_loss: 1.7499 | pg_loss: 0.2549 | reg_loss: 0.4782 | reward: -0.3685 | rev_kl: 0.8178 | stu_lens: 85.8438 | mixed_lens: 89.4062 | lr: 8.0781e-07 | scale: 1024.00 | time: 26.246 | step time: 27.505
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    769/  1000| tot_loss: 2.2180 | rl_loss: 0.4376 | pt_loss: 1.7804 | pg_loss: -0.0198 | reg_loss: 0.4575 | reward: -0.1224 | rev_kl: 0.7820 | stu_lens: 127.5000 | mixed_lens: 128.0000 | lr: 8.0140e-07 | scale: 1024.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    770/  1000| tot_loss: 3.7636 | rl_loss: 1.7646 | pt_loss: 1.9990 | pg_loss: 0.4821 | reg_loss: 1.2825 | reward: -0.0864 | rev_kl: 0.9369 | stu_lens: 128.0000 | mixed_lens: 65.5000 | lr: 7.9500e-07 | scale: 1024.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    771/  1000| tot_loss: 2.9449 | rl_loss: 1.2861 | pt_loss: 1.6588 | pg_loss: 0.4076 | reg_loss: 0.8785 | reward: -0.1866 | rev_kl: 0.5848 | stu_lens: 80.5000 | mixed_lens: 71.5000 | lr: 7.8863e-07 | scale: 1024.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    772/  1000| tot_loss: 3.3691 | rl_loss: 1.6821 | pt_loss: 1.6870 | pg_loss: 0.4441 | reg_loss: 1.2379 | reward: -0.3926 | rev_kl: 0.8349 | stu_lens: 61.0000 | mixed_lens: 73.0000 | lr: 7.8228e-07 | scale: 1024.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    773/  1000| tot_loss: 2.7095 | rl_loss: 1.4390 | pt_loss: 1.2706 | pg_loss: 0.4795 | reg_loss: 0.9595 | reward: -0.1314 | rev_kl: 0.4960 | stu_lens: 112.5000 | mixed_lens: 77.0000 | lr: 7.7595e-07 | scale: 1024.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    774/  1000| tot_loss: 3.3387 | rl_loss: 1.6740 | pt_loss: 1.6647 | pg_loss: 0.8554 | reg_loss: 0.8186 | reward: -0.5656 | rev_kl: 0.8829 | stu_lens: 80.0000 | mixed_lens: 45.0000 | lr: 7.6964e-07 | scale: 1024.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    775/  1000| tot_loss: 2.9659 | rl_loss: 1.3749 | pt_loss: 1.5911 | pg_loss: 0.3198 | reg_loss: 1.0551 | reward: -0.2056 | rev_kl: 1.0149 | stu_lens: 117.0000 | mixed_lens: 94.5000 | lr: 7.6335e-07 | scale: 1024.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    776/  1000| tot_loss: 2.8262 | rl_loss: 1.5683 | pt_loss: 1.2579 | pg_loss: 0.3334 | reg_loss: 1.2349 | reward: -0.2286 | rev_kl: 0.9789 | stu_lens: 93.0000 | mixed_lens: 94.0000 | lr: 7.5709e-07 | scale: 1024.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    777/  1000| tot_loss: 3.2022 | rl_loss: 1.3252 | pt_loss: 1.8770 | pg_loss: 0.0622 | reg_loss: 1.2630 | reward: -0.1621 | rev_kl: 1.1066 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 7.5084e-07 | scale: 1024.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    778/  1000| tot_loss: 2.8281 | rl_loss: 0.9046 | pt_loss: 1.9236 | pg_loss: 0.0405 | reg_loss: 0.8641 | reward: -0.1976 | rev_kl: 0.9950 | stu_lens: 114.0000 | mixed_lens: 128.0000 | lr: 7.4462e-07 | scale: 1024.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    779/  1000| tot_loss: 3.5513 | rl_loss: 1.6169 | pt_loss: 1.9344 | pg_loss: 0.6237 | reg_loss: 0.9931 | reward: -0.4039 | rev_kl: 0.7207 | stu_lens: 76.0000 | mixed_lens: 70.5000 | lr: 7.3841e-07 | scale: 1024.00 | time: 26.220 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    780/  1000| tot_loss: 3.1689 | rl_loss: 1.5804 | pt_loss: 1.5885 | pg_loss: 0.5643 | reg_loss: 1.0161 | reward: -0.6140 | rev_kl: 0.8083 | stu_lens: 119.5000 | mixed_lens: 68.0000 | lr: 7.3223e-07 | scale: 1024.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    781/  1000| tot_loss: 3.2012 | rl_loss: 1.3837 | pt_loss: 1.8175 | pg_loss: 0.5081 | reg_loss: 0.8756 | reward: -0.3342 | rev_kl: 0.8743 | stu_lens: 106.5000 | mixed_lens: 59.5000 | lr: 7.2607e-07 | scale: 1024.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    782/  1000| tot_loss: 2.5395 | rl_loss: 0.8133 | pt_loss: 1.7263 | pg_loss: 0.3667 | reg_loss: 0.4465 | reward: -0.3198 | rev_kl: 1.1349 | stu_lens: 92.0000 | mixed_lens: 64.0000 | lr: 7.1993e-07 | scale: 1024.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    783/  1000| tot_loss: 2.3025 | rl_loss: 1.2972 | pt_loss: 1.0053 | pg_loss: 0.4568 | reg_loss: 0.8405 | reward: -0.2727 | rev_kl: 0.4826 | stu_lens: 38.0000 | mixed_lens: 67.5000 | lr: 7.1382e-07 | scale: 1024.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    784/  1000| tot_loss: 2.6585 | rl_loss: 0.9038 | pt_loss: 1.7547 | pg_loss: 0.1987 | reg_loss: 0.7051 | reward: -0.2247 | rev_kl: 0.4968 | stu_lens: 84.0000 | mixed_lens: 83.5000 | lr: 7.0772e-07 | scale: 1024.00 | time: 26.243 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    784/  1000| tot_loss: 2.8864 | rl_loss: 1.1850 | pt_loss: 1.7014 | pg_loss: 0.3087 | reg_loss: 0.8763 | reward: -0.2762 | rev_kl: 0.8012 | stu_lens: 96.7188 | mixed_lens: 91.7656 | lr: 7.0772e-07 | scale: 1024.00 | time: 26.243 | step time: 27.511
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    785/  1000| tot_loss: 1.9490 | rl_loss: 0.4873 | pt_loss: 1.4616 | pg_loss: 0.0274 | reg_loss: 0.4599 | reward: -0.1891 | rev_kl: 0.7365 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 7.0165e-07 | scale: 1024.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    786/  1000| tot_loss: 2.5056 | rl_loss: 0.7279 | pt_loss: 1.7776 | pg_loss: 0.0421 | reg_loss: 0.6858 | reward: -0.1213 | rev_kl: 0.5490 | stu_lens: 44.5000 | mixed_lens: 125.5000 | lr: 6.9560e-07 | scale: 1024.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    787/  1000| tot_loss: 2.9907 | rl_loss: 1.0934 | pt_loss: 1.8973 | pg_loss: 0.2847 | reg_loss: 0.8087 | reward: -0.5308 | rev_kl: 1.1498 | stu_lens: 103.0000 | mixed_lens: 82.0000 | lr: 6.8957e-07 | scale: 1024.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    788/  1000| tot_loss: 2.5984 | rl_loss: 1.1323 | pt_loss: 1.4661 | pg_loss: 0.3219 | reg_loss: 0.8104 | reward: -0.2736 | rev_kl: 0.8033 | stu_lens: 106.5000 | mixed_lens: 89.0000 | lr: 6.8356e-07 | scale: 1024.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    789/  1000| tot_loss: 2.6510 | rl_loss: 0.5893 | pt_loss: 2.0617 | pg_loss: 0.0028 | reg_loss: 0.5865 | reward: -0.1696 | rev_kl: 0.7054 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 6.7758e-07 | scale: 1024.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    790/  1000| tot_loss: 3.7229 | rl_loss: 1.7776 | pt_loss: 1.9453 | pg_loss: 0.8479 | reg_loss: 0.9297 | reward: -0.4262 | rev_kl: 0.6140 | stu_lens: 39.5000 | mixed_lens: 39.0000 | lr: 6.7162e-07 | scale: 1024.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    791/  1000| tot_loss: 2.6379 | rl_loss: 0.6597 | pt_loss: 1.9781 | pg_loss: 0.2257 | reg_loss: 0.4340 | reward: -0.1116 | rev_kl: 0.7400 | stu_lens: 84.0000 | mixed_lens: 83.5000 | lr: 6.6568e-07 | scale: 1024.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    792/  1000| tot_loss: 2.5588 | rl_loss: 1.1605 | pt_loss: 1.3983 | pg_loss: 0.4977 | reg_loss: 0.6627 | reward: -0.4438 | rev_kl: 0.6244 | stu_lens: 71.5000 | mixed_lens: 39.5000 | lr: 6.5976e-07 | scale: 1024.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    793/  1000| tot_loss: 2.8672 | rl_loss: 0.9409 | pt_loss: 1.9263 | pg_loss: 0.0551 | reg_loss: 0.8858 | reward: -0.0671 | rev_kl: 1.0266 | stu_lens: 125.0000 | mixed_lens: 128.0000 | lr: 6.5386e-07 | scale: 1024.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    794/  1000| tot_loss: 2.9241 | rl_loss: 1.0659 | pt_loss: 1.8582 | pg_loss: 0.5816 | reg_loss: 0.4843 | reward: -0.0885 | rev_kl: 0.3427 | stu_lens: 74.5000 | mixed_lens: 51.0000 | lr: 6.4799e-07 | scale: 1024.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    795/  1000| tot_loss: 2.4451 | rl_loss: 0.6599 | pt_loss: 1.7852 | pg_loss: 0.0325 | reg_loss: 0.6275 | reward: -0.1517 | rev_kl: 0.6760 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 6.4214e-07 | scale: 1024.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    796/  1000| tot_loss: 2.3377 | rl_loss: 0.6783 | pt_loss: 1.6595 | pg_loss: 0.1249 | reg_loss: 0.5533 | reward: -0.4138 | rev_kl: 0.9120 | stu_lens: 128.0000 | mixed_lens: 96.0000 | lr: 6.3631e-07 | scale: 1024.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    797/  1000| tot_loss: 2.8776 | rl_loss: 1.0318 | pt_loss: 1.8458 | pg_loss: 0.2575 | reg_loss: 0.7743 | reward: 0.0750 | rev_kl: 0.8230 | stu_lens: 128.0000 | mixed_lens: 97.5000 | lr: 6.3050e-07 | scale: 1024.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    798/  1000| tot_loss: 2.9147 | rl_loss: 1.2163 | pt_loss: 1.6984 | pg_loss: 0.5610 | reg_loss: 0.6553 | reward: -0.2689 | rev_kl: 0.7074 | stu_lens: 76.0000 | mixed_lens: 41.0000 | lr: 6.2472e-07 | scale: 1024.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    799/  1000| tot_loss: 2.9561 | rl_loss: 1.1514 | pt_loss: 1.8047 | pg_loss: 0.2346 | reg_loss: 0.9169 | reward: -0.3152 | rev_kl: 0.8882 | stu_lens: 119.5000 | mixed_lens: 102.0000 | lr: 6.1896e-07 | scale: 1024.00 | time: 26.226 | step time: 0.000
                                 Evaluation #8                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ dime un chiste acerca de la situacion │ dime un chiste acerca de la          │
│ actual de la economia, de modo que    │ situacion actual de la economia, de  │
│ los niños comprendan el mal estado de │ modo que los niños comprendan el mal │
│ la misma.                             │ estado de la misma.                  │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ En la economia hay que hacer que el  │
│                                       │ dinero circule, y para esto es       │
│                                       │ necesario que la gente teng          │
│                                       │ confianza en ella. En la actualidad  │
│                                       │ la gente no tiene confianza en la    │
│                                       │ economia, por lo que no se gana      │
│                                       │ dinero, y ni siquiera se cambia el   │
│                                       │ dinero a cambio de bienes y          │
│                                       │ servicios, por lo que la economia se │
│                                       │ paraliza. Como resultado de ello, la │
│                                       │ gente pierde su dinero, se queda sin │
│                                       │ empleo y se va a la calle.           │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Sí, claro. Una vez hubo un circo que │
│                                       │ no tenía mucho dinero para pagar a   │
│                                       │ los artistas, por lo que los         │
│                                       │ artistas se ahogaban de hambre. Un   │
│                                       │ día, un oso desapareció del circo.   │
│                                       │ Los artistas se sintieron orgullosos │
│                                       │ de haber desaparecido al oso, hasta  │
│                                       │ que un juglar dijo: "No hubo ningún  │
│                                       │ oso, fue un hombre disfrazado". Esto │
│                                       │ les estremeció a todos, porque       │
│                                       │ pensaron que era elό que había sido  │
│                                       │ asesinado por la gente del circo     │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Sure!                                │
│                                       │                                      │
│                                       │ This is a puzzle. It is a            │
│                                       │ head-scratcher. It is a conundrum.   │
│                                       │ It is a riddle. It is a brain        │
│                                       │ teaser. It is a mind bender. It is a │
│                                       │ logical paradox. It is a             │
│                                       │ mathematical enigma. It is a         │
│                                       │ cryptographic puzzle. It is a        │
│                                       │ spartan riddle. It is a tongue       │
│                                       │ twister. It is a witty saying. It is │
│                                       │ a catchphrase. It is a memorable     │
│                                       │ quote. It is a clever turn of        │
│                                       │ phrase. It is a philosophical        │
│                                       │ question. It is a zen                │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 15.778 | exact_match: 0.103 | rev_kl: 0.858 | lens: 92.497 | pt_loss: 1.739 | lm_loss: 1.875 | kd_loss: 1.603 
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    800/  1000| tot_loss: 2.3703 | rl_loss: 0.6599 | pt_loss: 1.7105 | pg_loss: 0.2095 | reg_loss: 0.4504 | reward: -0.3085 | rev_kl: 0.8457 | stu_lens: 128.0000 | mixed_lens: 97.5000 | lr: 6.1323e-07 | scale: 1024.00 | time: 26.259 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    800/  1000| tot_loss: 2.7878 | rl_loss: 1.0527 | pt_loss: 1.7351 | pg_loss: 0.2830 | reg_loss: 0.7697 | reward: -0.2492 | rev_kl: 0.8349 | stu_lens: 96.5156 | mixed_lens: 91.6094 | lr: 6.1323e-07 | scale: 1024.00 | time: 26.259 | step time: 27.515
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    801/  1000| tot_loss: 2.0296 | rl_loss: 0.2002 | pt_loss: 1.8294 | pg_loss: -0.0919 | reg_loss: 0.2922 | reward: -0.1141 | rev_kl: 1.0776 | stu_lens: 106.0000 | mixed_lens: 72.0000 | lr: 6.0751e-07 | scale: 1024.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    802/  1000| tot_loss: 2.4228 | rl_loss: 0.8353 | pt_loss: 1.5875 | pg_loss: 0.0309 | reg_loss: 0.8044 | reward: -0.1259 | rev_kl: 0.8658 | stu_lens: 128.0000 | mixed_lens: 123.0000 | lr: 6.0182e-07 | scale: 1024.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    803/  1000| tot_loss: 1.8373 | rl_loss: 0.4287 | pt_loss: 1.4086 | pg_loss: 0.0736 | reg_loss: 0.3550 | reward: -0.0990 | rev_kl: 1.0244 | stu_lens: 88.5000 | mixed_lens: 106.5000 | lr: 5.9615e-07 | scale: 1024.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    804/  1000| tot_loss: 1.8470 | rl_loss: 0.8832 | pt_loss: 0.9638 | pg_loss: 0.1788 | reg_loss: 0.7044 | reward: -0.1999 | rev_kl: 0.7697 | stu_lens: 124.0000 | mixed_lens: 95.5000 | lr: 5.9051e-07 | scale: 1024.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    805/  1000| tot_loss: 2.3523 | rl_loss: 0.6620 | pt_loss: 1.6904 | pg_loss: -0.0052 | reg_loss: 0.6672 | reward: -0.2117 | rev_kl: 0.8566 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 5.8489e-07 | scale: 1024.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    806/  1000| tot_loss: 2.4053 | rl_loss: 0.5404 | pt_loss: 1.8648 | pg_loss: 0.0112 | reg_loss: 0.5292 | reward: -0.1517 | rev_kl: 0.6760 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 5.7929e-07 | scale: 1024.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    807/  1000| tot_loss: 2.2056 | rl_loss: 0.7576 | pt_loss: 1.4481 | pg_loss: 0.1567 | reg_loss: 0.6009 | reward: -0.2687 | rev_kl: 0.7756 | stu_lens: 119.5000 | mixed_lens: 102.0000 | lr: 5.7372e-07 | scale: 1024.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    808/  1000| tot_loss: 2.6531 | rl_loss: 0.8472 | pt_loss: 1.8059 | pg_loss: -0.0239 | reg_loss: 0.8710 | reward: -0.1474 | rev_kl: 0.9738 | stu_lens: 110.5000 | mixed_lens: 128.0000 | lr: 5.6817e-07 | scale: 1024.00 | time: 26.216 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    809/  1000| tot_loss: 2.1989 | rl_loss: 0.6910 | pt_loss: 1.5079 | pg_loss: 0.1085 | reg_loss: 0.5825 | reward: 0.0093 | rev_kl: 0.7717 | stu_lens: 128.0000 | mixed_lens: 111.0000 | lr: 5.6264e-07 | scale: 1024.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    810/  1000| tot_loss: 2.7818 | rl_loss: 0.8070 | pt_loss: 1.9748 | pg_loss: 0.2165 | reg_loss: 0.5905 | reward: 0.8062 | rev_kl: 1.8012 | stu_lens: 23.0000 | mixed_lens: 64.5000 | lr: 5.5714e-07 | scale: 1024.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    811/  1000| tot_loss: 2.7160 | rl_loss: 1.4399 | pt_loss: 1.2761 | pg_loss: 0.5439 | reg_loss: 0.8960 | reward: -0.3802 | rev_kl: 0.5726 | stu_lens: 112.5000 | mixed_lens: 40.0000 | lr: 5.5166e-07 | scale: 1024.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    812/  1000| tot_loss: 2.7540 | rl_loss: 0.9687 | pt_loss: 1.7853 | pg_loss: -0.0230 | reg_loss: 0.9917 | reward: -0.0964 | rev_kl: 1.0210 | stu_lens: 125.0000 | mixed_lens: 128.0000 | lr: 5.4620e-07 | scale: 1024.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    813/  1000| tot_loss: 3.0018 | rl_loss: 1.1464 | pt_loss: 1.8555 | pg_loss: 0.6251 | reg_loss: 0.5212 | reward: -0.3710 | rev_kl: 0.7224 | stu_lens: 48.0000 | mixed_lens: 41.0000 | lr: 5.4077e-07 | scale: 1024.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    814/  1000| tot_loss: 2.7292 | rl_loss: 1.1053 | pt_loss: 1.6239 | pg_loss: 0.3981 | reg_loss: 0.7072 | reward: -0.4055 | rev_kl: 0.9327 | stu_lens: 51.0000 | mixed_lens: 58.5000 | lr: 5.3536e-07 | scale: 1024.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    815/  1000| tot_loss: 3.1084 | rl_loss: 0.9948 | pt_loss: 2.1136 | pg_loss: 0.6385 | reg_loss: 0.3564 | reward: -0.3427 | rev_kl: 0.4579 | stu_lens: 48.5000 | mixed_lens: 50.0000 | lr: 5.2997e-07 | scale: 1024.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    816/  1000| tot_loss: 2.4330 | rl_loss: 0.6536 | pt_loss: 1.7794 | pg_loss: 0.0982 | reg_loss: 0.5554 | reward: -0.3683 | rev_kl: 0.7023 | stu_lens: 128.0000 | mixed_lens: 82.0000 | lr: 5.2461e-07 | scale: 1024.00 | time: 26.220 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    816/  1000| tot_loss: 2.5837 | rl_loss: 0.8703 | pt_loss: 1.7134 | pg_loss: 0.2394 | reg_loss: 0.6309 | reward: -0.2047 | rev_kl: 0.8991 | stu_lens: 95.2188 | mixed_lens: 87.5938 | lr: 5.2461e-07 | scale: 1024.00 | time: 26.220 | step time: 27.514
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    817/  1000| tot_loss: 2.3754 | rl_loss: 0.7300 | pt_loss: 1.6453 | pg_loss: -0.0020 | reg_loss: 0.7320 | reward: -0.2085 | rev_kl: 0.8552 | stu_lens: 91.0000 | mixed_lens: 128.0000 | lr: 5.1928e-07 | scale: 1024.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    818/  1000| tot_loss: 3.1643 | rl_loss: 1.0447 | pt_loss: 2.1195 | pg_loss: 0.5173 | reg_loss: 0.5275 | reward: -0.2482 | rev_kl: 0.2996 | stu_lens: 85.0000 | mixed_lens: 56.5000 | lr: 5.1396e-07 | scale: 1024.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    819/  1000| tot_loss: 2.5645 | rl_loss: 0.8612 | pt_loss: 1.7033 | pg_loss: 0.3497 | reg_loss: 0.5115 | reward: -0.1727 | rev_kl: 0.6827 | stu_lens: 84.0000 | mixed_lens: 83.5000 | lr: 5.0868e-07 | scale: 1024.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    820/  1000| tot_loss: 1.8497 | rl_loss: 0.5595 | pt_loss: 1.2902 | pg_loss: -0.0205 | reg_loss: 0.5800 | reward: -0.0733 | rev_kl: 0.7713 | stu_lens: 124.0000 | mixed_lens: 128.0000 | lr: 5.0341e-07 | scale: 1024.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    821/  1000| tot_loss: 2.5464 | rl_loss: 0.7199 | pt_loss: 1.8265 | pg_loss: 0.3617 | reg_loss: 0.3581 | reward: -0.6341 | rev_kl: 0.3079 | stu_lens: 51.0000 | mixed_lens: 43.0000 | lr: 4.9817e-07 | scale: 1024.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    822/  1000| tot_loss: 2.4920 | rl_loss: 0.5970 | pt_loss: 1.8950 | pg_loss: 0.0123 | reg_loss: 0.5846 | reward: -0.2417 | rev_kl: 0.7370 | stu_lens: 84.5000 | mixed_lens: 125.0000 | lr: 4.9296e-07 | scale: 1024.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    823/  1000| tot_loss: 2.8457 | rl_loss: 0.8695 | pt_loss: 1.9762 | pg_loss: 0.3719 | reg_loss: 0.4976 | reward: -0.2486 | rev_kl: 0.7527 | stu_lens: 80.5000 | mixed_lens: 71.5000 | lr: 4.8777e-07 | scale: 1024.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    824/  1000| tot_loss: 2.2826 | rl_loss: 0.5183 | pt_loss: 1.7643 | pg_loss: -0.0241 | reg_loss: 0.5424 | reward: -0.0309 | rev_kl: 1.2955 | stu_lens: 95.5000 | mixed_lens: 128.0000 | lr: 4.8260e-07 | scale: 1024.00 | time: 26.225 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    825/  1000| tot_loss: 2.4178 | rl_loss: 0.8420 | pt_loss: 1.5758 | pg_loss: 0.2553 | reg_loss: 0.5867 | reward: -0.2755 | rev_kl: 0.7990 | stu_lens: 106.0000 | mixed_lens: 56.5000 | lr: 4.7746e-07 | scale: 1024.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    826/  1000| tot_loss: 2.5207 | rl_loss: 0.7023 | pt_loss: 1.8183 | pg_loss: 0.1434 | reg_loss: 0.5589 | reward: -0.1880 | rev_kl: 1.0680 | stu_lens: 103.0000 | mixed_lens: 99.0000 | lr: 4.7234e-07 | scale: 1024.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    827/  1000| tot_loss: 2.5970 | rl_loss: 0.5955 | pt_loss: 2.0015 | pg_loss: -0.0238 | reg_loss: 0.6192 | reward: -0.0974 | rev_kl: 1.0687 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6725e-07 | scale: 1024.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    828/  1000| tot_loss: 2.9311 | rl_loss: 1.1619 | pt_loss: 1.7692 | pg_loss: 0.6669 | reg_loss: 0.4950 | reward: -0.3348 | rev_kl: 0.6538 | stu_lens: 50.5000 | mixed_lens: 54.5000 | lr: 4.6218e-07 | scale: 1024.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    829/  1000| tot_loss: 2.3443 | rl_loss: 0.6935 | pt_loss: 1.6507 | pg_loss: -0.0121 | reg_loss: 0.7056 | reward: -0.2649 | rev_kl: 1.0687 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5714e-07 | scale: 1024.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    830/  1000| tot_loss: 2.6392 | rl_loss: 0.8679 | pt_loss: 1.7713 | pg_loss: 0.3081 | reg_loss: 0.5599 | reward: 0.7656 | rev_kl: 1.8073 | stu_lens: 40.5000 | mixed_lens: 56.5000 | lr: 4.5212e-07 | scale: 1024.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    831/  1000| tot_loss: 1.9381 | rl_loss: 0.4645 | pt_loss: 1.4736 | pg_loss: 0.0876 | reg_loss: 0.3769 | reward: -0.1922 | rev_kl: 1.0704 | stu_lens: 128.0000 | mixed_lens: 106.5000 | lr: 4.4713e-07 | scale: 1024.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    832/  1000| tot_loss: 2.3373 | rl_loss: 0.7672 | pt_loss: 1.5701 | pg_loss: 0.2237 | reg_loss: 0.5435 | reward: -0.3802 | rev_kl: 0.6401 | stu_lens: 60.5000 | mixed_lens: 73.0000 | lr: 4.4216e-07 | scale: 1024.00 | time: 26.251 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    832/  1000| tot_loss: 2.5386 | rl_loss: 0.8013 | pt_loss: 1.7373 | pg_loss: 0.2390 | reg_loss: 0.5623 | reward: -0.2411 | rev_kl: 0.8434 | stu_lens: 95.5625 | mixed_lens: 91.0469 | lr: 4.4216e-07 | scale: 1024.00 | time: 26.251 | step time: 27.508
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    833/  1000| tot_loss: 2.3532 | rl_loss: 0.6511 | pt_loss: 1.7021 | pg_loss: -0.0093 | reg_loss: 0.6605 | reward: -0.2025 | rev_kl: 0.9318 | stu_lens: 114.5000 | mixed_lens: 128.0000 | lr: 4.3722e-07 | scale: 1024.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    834/  1000| tot_loss: 3.3441 | rl_loss: 1.2712 | pt_loss: 2.0729 | pg_loss: 0.4403 | reg_loss: 0.8309 | reward: 0.0469 | rev_kl: 0.7901 | stu_lens: 81.5000 | mixed_lens: 78.0000 | lr: 4.3230e-07 | scale: 1024.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    835/  1000| tot_loss: 3.4539 | rl_loss: 1.8155 | pt_loss: 1.6384 | pg_loss: 1.0606 | reg_loss: 0.7549 | reward: -0.1971 | rev_kl: 0.6046 | stu_lens: 44.0000 | mixed_lens: 31.0000 | lr: 4.2741e-07 | scale: 1024.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    836/  1000| tot_loss: 2.4500 | rl_loss: 0.9269 | pt_loss: 1.5231 | pg_loss: 0.0923 | reg_loss: 0.8346 | reward: -0.2220 | rev_kl: 1.3476 | stu_lens: 86.0000 | mixed_lens: 123.5000 | lr: 4.2254e-07 | scale: 1024.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    837/  1000| tot_loss: 2.8033 | rl_loss: 1.4433 | pt_loss: 1.3600 | pg_loss: 0.4317 | reg_loss: 1.0116 | reward: -0.2365 | rev_kl: 0.7712 | stu_lens: 75.5000 | mixed_lens: 92.5000 | lr: 4.1770e-07 | scale: 1024.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    838/  1000| tot_loss: 3.3668 | rl_loss: 1.7303 | pt_loss: 1.6365 | pg_loss: 0.4912 | reg_loss: 1.2391 | reward: -0.5829 | rev_kl: 0.8201 | stu_lens: 66.0000 | mixed_lens: 70.5000 | lr: 4.1288e-07 | scale: 1024.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    839/  1000| tot_loss: 2.0295 | rl_loss: 0.5420 | pt_loss: 1.4875 | pg_loss: 0.0298 | reg_loss: 0.5122 | reward: -0.1698 | rev_kl: 1.2481 | stu_lens: 115.5000 | mixed_lens: 126.5000 | lr: 4.0809e-07 | scale: 1024.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    840/  1000| tot_loss: 2.9621 | rl_loss: 1.1369 | pt_loss: 1.8252 | pg_loss: 0.1057 | reg_loss: 1.0312 | reward: -0.3346 | rev_kl: 0.9254 | stu_lens: 128.0000 | mixed_lens: 103.5000 | lr: 4.0332e-07 | scale: 1024.00 | time: 26.216 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    841/  1000| tot_loss: 2.6667 | rl_loss: 0.9052 | pt_loss: 1.7614 | pg_loss: 0.3114 | reg_loss: 0.5938 | reward: -0.3802 | rev_kl: 0.8307 | stu_lens: 54.0000 | mixed_lens: 57.0000 | lr: 3.9858e-07 | scale: 1024.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    842/  1000| tot_loss: 2.3796 | rl_loss: 0.7872 | pt_loss: 1.5924 | pg_loss: -0.0071 | reg_loss: 0.7943 | reward: -0.6076 | rev_kl: 0.5098 | stu_lens: 70.0000 | mixed_lens: 73.0000 | lr: 3.9387e-07 | scale: 1024.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    843/  1000| tot_loss: 3.3104 | rl_loss: 1.2346 | pt_loss: 2.0758 | pg_loss: 0.2352 | reg_loss: 0.9995 | reward: -0.1690 | rev_kl: 1.2087 | stu_lens: 81.0000 | mixed_lens: 93.5000 | lr: 3.8918e-07 | scale: 1024.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    844/  1000| tot_loss: 3.8807 | rl_loss: 2.4229 | pt_loss: 1.4578 | pg_loss: 1.4462 | reg_loss: 0.9767 | reward: -0.5491 | rev_kl: 0.6339 | stu_lens: 36.0000 | mixed_lens: 34.5000 | lr: 3.8452e-07 | scale: 1024.00 | time: 26.212 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    845/  1000| tot_loss: 2.8310 | rl_loss: 1.1112 | pt_loss: 1.7198 | pg_loss: 0.0621 | reg_loss: 1.0491 | reward: -0.0999 | rev_kl: 0.6190 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7988e-07 | scale: 1024.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    846/  1000| tot_loss: 2.6499 | rl_loss: 0.9878 | pt_loss: 1.6621 | pg_loss: 0.1066 | reg_loss: 0.8812 | reward: -0.1632 | rev_kl: 0.5218 | stu_lens: 128.0000 | mixed_lens: 118.0000 | lr: 3.7527e-07 | scale: 1024.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    847/  1000| tot_loss: 2.7553 | rl_loss: 1.1189 | pt_loss: 1.6364 | pg_loss: 0.3612 | reg_loss: 0.7577 | reward: 0.0525 | rev_kl: 0.5982 | stu_lens: 106.0000 | mixed_lens: 90.0000 | lr: 3.7068e-07 | scale: 1024.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    848/  1000| tot_loss: 3.1737 | rl_loss: 1.2696 | pt_loss: 1.9042 | pg_loss: 0.7713 | reg_loss: 0.4982 | reward: -0.3023 | rev_kl: 0.4333 | stu_lens: 70.5000 | mixed_lens: 24.0000 | lr: 3.6612e-07 | scale: 1024.00 | time: 26.216 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    848/  1000| tot_loss: 3.0702 | rl_loss: 1.2628 | pt_loss: 1.8074 | pg_loss: 0.3679 | reg_loss: 0.8949 | reward: -0.2869 | rev_kl: 0.8655 | stu_lens: 90.9062 | mixed_lens: 86.6719 | lr: 3.6612e-07 | scale: 1024.00 | time: 26.216 | step time: 27.503
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    849/  1000| tot_loss: 2.4648 | rl_loss: 1.0259 | pt_loss: 1.4388 | pg_loss: 0.2302 | reg_loss: 0.7958 | reward: -0.0140 | rev_kl: 0.7456 | stu_lens: 128.0000 | mixed_lens: 76.5000 | lr: 3.6159e-07 | scale: 1024.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    850/  1000| tot_loss: 2.7950 | rl_loss: 0.8341 | pt_loss: 1.9609 | pg_loss: 0.0777 | reg_loss: 0.7564 | reward: -0.1204 | rev_kl: 0.6247 | stu_lens: 81.0000 | mixed_lens: 93.5000 | lr: 3.5708e-07 | scale: 1024.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    851/  1000| tot_loss: 3.8804 | rl_loss: 1.8444 | pt_loss: 2.0360 | pg_loss: 1.0034 | reg_loss: 0.8410 | reward: -0.6861 | rev_kl: 0.6595 | stu_lens: 35.5000 | mixed_lens: 38.5000 | lr: 3.5260e-07 | scale: 1024.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    852/  1000| tot_loss: 4.1003 | rl_loss: 2.3078 | pt_loss: 1.7926 | pg_loss: 1.5609 | reg_loss: 0.7469 | reward: -0.9481 | rev_kl: 0.6448 | stu_lens: 25.5000 | mixed_lens: 18.0000 | lr: 3.4814e-07 | scale: 1024.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    853/  1000| tot_loss: 2.7908 | rl_loss: 1.3041 | pt_loss: 1.4867 | pg_loss: 0.2174 | reg_loss: 1.0867 | reward: -0.6389 | rev_kl: 0.7229 | stu_lens: 91.0000 | mixed_lens: 90.0000 | lr: 3.4372e-07 | scale: 1024.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    854/  1000| tot_loss: 2.1214 | rl_loss: 0.9093 | pt_loss: 1.2121 | pg_loss: 0.1732 | reg_loss: 0.7361 | reward: -0.2657 | rev_kl: 1.1238 | stu_lens: 75.5000 | mixed_lens: 93.5000 | lr: 3.3931e-07 | scale: 1024.00 | time: 26.216 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    855/  1000| tot_loss: 2.5826 | rl_loss: 0.7005 | pt_loss: 1.8822 | pg_loss: 0.0733 | reg_loss: 0.6271 | reward: -0.0505 | rev_kl: 0.7733 | stu_lens: 86.0000 | mixed_lens: 109.5000 | lr: 3.3494e-07 | scale: 1024.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    856/  1000| tot_loss: 2.6561 | rl_loss: 1.2221 | pt_loss: 1.4341 | pg_loss: 0.5956 | reg_loss: 0.6265 | reward: -0.6400 | rev_kl: 0.7688 | stu_lens: 70.0000 | mixed_lens: 73.0000 | lr: 3.3059e-07 | scale: 1024.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    857/  1000| tot_loss: 2.9201 | rl_loss: 1.1173 | pt_loss: 1.8028 | pg_loss: -0.0061 | reg_loss: 1.1235 | reward: -0.2887 | rev_kl: 0.9004 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.2626e-07 | scale: 1024.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    858/  1000| tot_loss: 2.9230 | rl_loss: 1.3544 | pt_loss: 1.5685 | pg_loss: 0.4224 | reg_loss: 0.9320 | reward: -0.4592 | rev_kl: 0.7134 | stu_lens: 51.5000 | mixed_lens: 58.5000 | lr: 3.2197e-07 | scale: 1024.00 | time: 26.212 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    859/  1000| tot_loss: 1.7720 | rl_loss: 0.6203 | pt_loss: 1.1517 | pg_loss: 0.2087 | reg_loss: 0.4116 | reward: -0.0007 | rev_kl: 0.4607 | stu_lens: 128.0000 | mixed_lens: 76.5000 | lr: 3.1769e-07 | scale: 1024.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    860/  1000| tot_loss: 3.4467 | rl_loss: 1.2331 | pt_loss: 2.2136 | pg_loss: 0.2245 | reg_loss: 1.0086 | reward: -0.4080 | rev_kl: 0.9722 | stu_lens: 98.5000 | mixed_lens: 85.0000 | lr: 3.1345e-07 | scale: 1024.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    861/  1000| tot_loss: 2.2986 | rl_loss: 1.1115 | pt_loss: 1.1871 | pg_loss: 0.3275 | reg_loss: 0.7839 | reward: -0.1504 | rev_kl: 0.4852 | stu_lens: 73.0000 | mixed_lens: 73.0000 | lr: 3.0923e-07 | scale: 1024.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    862/  1000| tot_loss: 2.4054 | rl_loss: 0.7038 | pt_loss: 1.7016 | pg_loss: -0.0070 | reg_loss: 0.7107 | reward: -0.1645 | rev_kl: 1.4919 | stu_lens: 115.5000 | mixed_lens: 128.0000 | lr: 3.0504e-07 | scale: 1024.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    863/  1000| tot_loss: 2.7965 | rl_loss: 1.5145 | pt_loss: 1.2820 | pg_loss: 0.8602 | reg_loss: 0.6544 | reward: -0.5464 | rev_kl: 0.4986 | stu_lens: 48.5000 | mixed_lens: 46.5000 | lr: 3.0088e-07 | scale: 1024.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    864/  1000| tot_loss: 2.3663 | rl_loss: 0.8208 | pt_loss: 1.5455 | pg_loss: 0.1998 | reg_loss: 0.6210 | reward: -0.1672 | rev_kl: 0.7403 | stu_lens: 100.5000 | mixed_lens: 105.0000 | lr: 2.9674e-07 | scale: 1024.00 | time: 26.224 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    864/  1000| tot_loss: 2.8147 | rl_loss: 1.1440 | pt_loss: 1.6707 | pg_loss: 0.3121 | reg_loss: 0.8319 | reward: -0.2800 | rev_kl: 0.8602 | stu_lens: 90.1875 | mixed_lens: 86.7344 | lr: 2.9674e-07 | scale: 1024.00 | time: 26.224 | step time: 27.500
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    865/  1000| tot_loss: 2.5767 | rl_loss: 0.9467 | pt_loss: 1.6300 | pg_loss: 0.1071 | reg_loss: 0.8396 | reward: -0.0913 | rev_kl: 0.6098 | stu_lens: 128.0000 | mixed_lens: 118.0000 | lr: 2.9263e-07 | scale: 1024.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    866/  1000| tot_loss: 3.8626 | rl_loss: 2.2791 | pt_loss: 1.5835 | pg_loss: 0.9316 | reg_loss: 1.3474 | reward: -0.9267 | rev_kl: 0.5407 | stu_lens: 43.5000 | mixed_lens: 34.5000 | lr: 2.8855e-07 | scale: 1024.00 | time: 26.216 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    867/  1000| tot_loss: 2.3650 | rl_loss: 0.7220 | pt_loss: 1.6430 | pg_loss: -0.0064 | reg_loss: 0.7284 | reward: -0.1091 | rev_kl: 0.7114 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8449e-07 | scale: 1024.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    868/  1000| tot_loss: 3.5543 | rl_loss: 1.2018 | pt_loss: 2.3526 | pg_loss: 0.5478 | reg_loss: 0.6539 | reward: 0.0261 | rev_kl: 0.6685 | stu_lens: 80.0000 | mixed_lens: 70.5000 | lr: 2.8046e-07 | scale: 1024.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    869/  1000| tot_loss: 2.9171 | rl_loss: 1.1122 | pt_loss: 1.8049 | pg_loss: 0.1893 | reg_loss: 0.9229 | reward: -0.6173 | rev_kl: 1.3514 | stu_lens: 119.5000 | mixed_lens: 95.5000 | lr: 2.7646e-07 | scale: 1024.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    870/  1000| tot_loss: 3.1956 | rl_loss: 1.4050 | pt_loss: 1.7906 | pg_loss: 0.6776 | reg_loss: 0.7274 | reward: -0.2245 | rev_kl: 0.8724 | stu_lens: 64.0000 | mixed_lens: 65.0000 | lr: 2.7248e-07 | scale: 1024.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    871/  1000| tot_loss: 2.2357 | rl_loss: 0.9461 | pt_loss: 1.2896 | pg_loss: 0.1574 | reg_loss: 0.7887 | reward: -0.5268 | rev_kl: 0.6296 | stu_lens: 44.5000 | mixed_lens: 70.5000 | lr: 2.6854e-07 | scale: 1024.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    872/  1000| tot_loss: 2.9279 | rl_loss: 1.0398 | pt_loss: 1.8881 | pg_loss: 0.1101 | reg_loss: 0.9297 | reward: -0.3029 | rev_kl: 1.1504 | stu_lens: 128.0000 | mixed_lens: 120.0000 | lr: 2.6461e-07 | scale: 1024.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    873/  1000| tot_loss: 3.3110 | rl_loss: 1.2513 | pt_loss: 2.0597 | pg_loss: 0.7395 | reg_loss: 0.5118 | reward: -0.2453 | rev_kl: 0.6904 | stu_lens: 43.5000 | mixed_lens: 30.0000 | lr: 2.6072e-07 | scale: 1024.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    874/  1000| tot_loss: 2.6490 | rl_loss: 0.9834 | pt_loss: 1.6655 | pg_loss: 0.4221 | reg_loss: 0.5614 | reward: -0.1094 | rev_kl: 0.9904 | stu_lens: 86.0000 | mixed_lens: 72.0000 | lr: 2.5685e-07 | scale: 1024.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    875/  1000| tot_loss: 2.9124 | rl_loss: 0.7974 | pt_loss: 2.1150 | pg_loss: -0.0219 | reg_loss: 0.8193 | reward: -0.0689 | rev_kl: 0.8336 | stu_lens: 81.5000 | mixed_lens: 128.0000 | lr: 2.5301e-07 | scale: 1024.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    876/  1000| tot_loss: 3.3399 | rl_loss: 1.2052 | pt_loss: 2.1347 | pg_loss: 0.3280 | reg_loss: 0.8771 | reward: -0.4521 | rev_kl: 1.1616 | stu_lens: 90.5000 | mixed_lens: 75.5000 | lr: 2.4920e-07 | scale: 1024.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    877/  1000| tot_loss: 2.8937 | rl_loss: 0.9666 | pt_loss: 1.9272 | pg_loss: -0.0104 | reg_loss: 0.9769 | reward: -0.3392 | rev_kl: 0.9966 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.4542e-07 | scale: 1024.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    878/  1000| tot_loss: 2.3605 | rl_loss: 0.8304 | pt_loss: 1.5300 | pg_loss: 0.1765 | reg_loss: 0.6539 | reward: -0.4166 | rev_kl: 1.2692 | stu_lens: 128.0000 | mixed_lens: 103.5000 | lr: 2.4166e-07 | scale: 1024.00 | time: 26.216 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    879/  1000| tot_loss: 2.7276 | rl_loss: 0.8616 | pt_loss: 1.8661 | pg_loss: 0.2131 | reg_loss: 0.6485 | reward: 0.2000 | rev_kl: 0.6483 | stu_lens: 128.0000 | mixed_lens: 54.5000 | lr: 2.3793e-07 | scale: 1024.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    880/  1000| tot_loss: 2.8839 | rl_loss: 0.7205 | pt_loss: 2.1634 | pg_loss: 0.0332 | reg_loss: 0.6873 | reward: -0.1082 | rev_kl: 0.7677 | stu_lens: 128.0000 | mixed_lens: 118.5000 | lr: 2.3423e-07 | scale: 1024.00 | time: 26.216 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    880/  1000| tot_loss: 2.8160 | rl_loss: 1.0061 | pt_loss: 1.8099 | pg_loss: 0.2546 | reg_loss: 0.7515 | reward: -0.2479 | rev_kl: 0.8270 | stu_lens: 94.8438 | mixed_lens: 88.0625 | lr: 2.3423e-07 | scale: 1024.00 | time: 26.216 | step time: 27.504
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    881/  1000| tot_loss: 2.8565 | rl_loss: 0.9425 | pt_loss: 1.9139 | pg_loss: 0.2206 | reg_loss: 0.7220 | reward: -0.6100 | rev_kl: 1.3478 | stu_lens: 83.0000 | mixed_lens: 75.5000 | lr: 2.3056e-07 | scale: 1024.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    882/  1000| tot_loss: 2.1790 | rl_loss: 0.7638 | pt_loss: 1.4152 | pg_loss: -0.0143 | reg_loss: 0.7781 | reward: -0.1143 | rev_kl: 0.7808 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.2691e-07 | scale: 1024.00 | time: 26.220 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    883/  1000| tot_loss: 2.0327 | rl_loss: 0.6386 | pt_loss: 1.3941 | pg_loss: 0.0582 | reg_loss: 0.5805 | reward: -0.1666 | rev_kl: 0.5367 | stu_lens: 100.5000 | mixed_lens: 128.0000 | lr: 2.2329e-07 | scale: 1024.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    884/  1000| tot_loss: 2.3858 | rl_loss: 0.7897 | pt_loss: 1.5961 | pg_loss: 0.0146 | reg_loss: 0.7751 | reward: -0.2296 | rev_kl: 1.2873 | stu_lens: 128.0000 | mixed_lens: 127.0000 | lr: 2.1970e-07 | scale: 1024.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    885/  1000| tot_loss: 2.2621 | rl_loss: 0.7906 | pt_loss: 1.4715 | pg_loss: 0.1491 | reg_loss: 0.6414 | reward: -0.1922 | rev_kl: 0.8233 | stu_lens: 81.5000 | mixed_lens: 104.5000 | lr: 2.1614e-07 | scale: 1024.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    886/  1000| tot_loss: 2.4826 | rl_loss: 0.6476 | pt_loss: 1.8350 | pg_loss: 0.0181 | reg_loss: 0.6295 | reward: -0.2174 | rev_kl: 0.8509 | stu_lens: 86.0000 | mixed_lens: 123.5000 | lr: 2.1260e-07 | scale: 1024.00 | time: 26.220 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    887/  1000| tot_loss: 2.4844 | rl_loss: 1.0249 | pt_loss: 1.4595 | pg_loss: 0.4036 | reg_loss: 0.6213 | reward: 0.0303 | rev_kl: 0.8050 | stu_lens: 81.0000 | mixed_lens: 43.5000 | lr: 2.0909e-07 | scale: 1024.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    888/  1000| tot_loss: 2.3342 | rl_loss: 0.6041 | pt_loss: 1.7302 | pg_loss: 0.2517 | reg_loss: 0.3524 | reward: -0.5758 | rev_kl: 0.7117 | stu_lens: 28.0000 | mixed_lens: 20.5000 | lr: 2.0561e-07 | scale: 1024.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    889/  1000| tot_loss: 3.2141 | rl_loss: 1.2808 | pt_loss: 1.9333 | pg_loss: 0.4079 | reg_loss: 0.8729 | reward: -0.5829 | rev_kl: 0.8201 | stu_lens: 66.0000 | mixed_lens: 70.5000 | lr: 2.0216e-07 | scale: 1024.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    890/  1000| tot_loss: 3.2405 | rl_loss: 1.3288 | pt_loss: 1.9116 | pg_loss: 0.6098 | reg_loss: 0.7190 | reward: -0.3924 | rev_kl: 0.5082 | stu_lens: 91.0000 | mixed_lens: 43.5000 | lr: 1.9874e-07 | scale: 1024.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    891/  1000| tot_loss: 1.8541 | rl_loss: 0.5448 | pt_loss: 1.3094 | pg_loss: 0.1449 | reg_loss: 0.3999 | reward: -0.0643 | rev_kl: 0.7078 | stu_lens: 91.5000 | mixed_lens: 75.0000 | lr: 1.9534e-07 | scale: 1024.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    892/  1000| tot_loss: 2.2171 | rl_loss: 0.7757 | pt_loss: 1.4413 | pg_loss: 0.0086 | reg_loss: 0.7671 | reward: -0.1224 | rev_kl: 1.1042 | stu_lens: 122.5000 | mixed_lens: 128.0000 | lr: 1.9197e-07 | scale: 1024.00 | time: 26.216 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    893/  1000| tot_loss: 2.8230 | rl_loss: 0.7894 | pt_loss: 2.0335 | pg_loss: 0.3320 | reg_loss: 0.4574 | reward: -0.4316 | rev_kl: 1.1403 | stu_lens: 119.5000 | mixed_lens: 72.5000 | lr: 1.8863e-07 | scale: 1024.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    894/  1000| tot_loss: 2.7488 | rl_loss: 1.2039 | pt_loss: 1.5450 | pg_loss: 0.5217 | reg_loss: 0.6821 | reward: -0.1414 | rev_kl: 0.4476 | stu_lens: 34.5000 | mixed_lens: 57.0000 | lr: 1.8532e-07 | scale: 1024.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    895/  1000| tot_loss: 2.7215 | rl_loss: 1.0353 | pt_loss: 1.6863 | pg_loss: 0.2751 | reg_loss: 0.7602 | reward: 0.0704 | rev_kl: 0.7199 | stu_lens: 80.0000 | mixed_lens: 80.5000 | lr: 1.8204e-07 | scale: 1024.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    896/  1000| tot_loss: 2.9148 | rl_loss: 1.2083 | pt_loss: 1.7065 | pg_loss: 0.4293 | reg_loss: 0.7790 | reward: -0.7027 | rev_kl: 0.6491 | stu_lens: 52.5000 | mixed_lens: 61.5000 | lr: 1.7879e-07 | scale: 1024.00 | time: 26.218 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    896/  1000| tot_loss: 2.6384 | rl_loss: 0.9542 | pt_loss: 1.6842 | pg_loss: 0.3044 | reg_loss: 0.6498 | reward: -0.2802 | rev_kl: 0.8787 | stu_lens: 87.9688 | mixed_lens: 84.3906 | lr: 1.7879e-07 | scale: 1024.00 | time: 26.218 | step time: 27.500
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    897/  1000| tot_loss: 2.5286 | rl_loss: 0.7876 | pt_loss: 1.7411 | pg_loss: -0.0194 | reg_loss: 0.8069 | reward: -0.2950 | rev_kl: 0.9790 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.7556e-07 | scale: 1024.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    898/  1000| tot_loss: 2.8153 | rl_loss: 0.9457 | pt_loss: 1.8696 | pg_loss: 0.0694 | reg_loss: 0.8763 | reward: -0.0187 | rev_kl: 0.7408 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.7236e-07 | scale: 1024.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    899/  1000| tot_loss: 2.7672 | rl_loss: 1.1002 | pt_loss: 1.6670 | pg_loss: 0.3550 | reg_loss: 0.7452 | reward: -0.2544 | rev_kl: 0.9423 | stu_lens: 79.0000 | mixed_lens: 80.5000 | lr: 1.6919e-07 | scale: 1024.00 | time: 26.236 | step time: 0.000
                                 Evaluation #9                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ dime un chiste acerca de la situacion │ dime un chiste acerca de la          │
│ actual de la economia, de modo que    │ situacion actual de la economia, de  │
│ los niños comprendan el mal estado de │ modo que los niños comprendan el mal │
│ la misma.                             │ estado de la misma.                  │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Todos sabemos que la economia ha     │
│                                       │ sido un año difícil, con muchas      │
│                                       │ depresiones y bajas de laidad. Esto  │
│                                       │ ha tenido un impacto negativo en la  │
│                                       │ vida de la mayoría de los habitantes │
│                                       │ de la Tierra, ya que la mayoría de   │
│                                       │ los datos estadísticos indican que   │
│                                       │ la economía ha disminuido en la      │
│                                       │ mayoría de los países.               │
│                                       │                                      │
│                                       │ Esto se debe a que la crisis         │
│                                       │ financiera de 2008 aún se siente,    │
│                                       │ debido a que la gente sigue teniendo │
│                                       │ dificultades para conseguir dinero   │
│                                       │ para comprar                         │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Sí, claro. Kondo es una organizadora │
│                                       │ de interiores famosa por su método   │
│                                       │ de organización. El chiste se        │
│                                       │ refiere a la frase de Kondo: "¿Por   │
│                                       │ qué te esfuerzas?". El chiste se     │
│                                       │ hizo muy popular por la idea de que  │
│                                       │ el orden es la gracia.               │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Sure! I'm glad you asked. This joke  │
│                                       │ is about the popularity of divorce.  │
│                                       │ Divorce is becoming more and more    │
│                                       │ common, and it can be hard to        │
│                                       │ understand why. This joke explains   │
│                                       │ that divorce is all the rage because │
│                                       │ it's so much fun. If you like        │
│                                       │ parties, divorce is for you. If you  │
│                                       │ like drama, divorce is for you. If   │
│                                       │ you like being single, divorce is    │
│                                       │ for you. Divorce is a lot of fun.    │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.228 | exact_match: 0.103 | rev_kl: 0.839 | lens: 93.435 | pt_loss: 1.738 | lm_loss: 1.874 | kd_loss: 1.602 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    900/  1000| tot_loss: 2.8600 | rl_loss: 1.1060 | pt_loss: 1.7540 | pg_loss: 0.1986 | reg_loss: 0.9074 | reward: -0.2797 | rev_kl: 1.1098 | stu_lens: 113.0000 | mixed_lens: 102.5000 | lr: 1.6605e-07 | scale: 1024.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    901/  1000| tot_loss: 2.6595 | rl_loss: 1.1885 | pt_loss: 1.4710 | pg_loss: 0.0559 | reg_loss: 1.1326 | reward: -0.1331 | rev_kl: 0.7844 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.6294e-07 | scale: 1024.00 | time: 26.320 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    902/  1000| tot_loss: 3.0696 | rl_loss: 0.8949 | pt_loss: 2.1747 | pg_loss: 0.1328 | reg_loss: 0.7621 | reward: -0.1998 | rev_kl: 0.5339 | stu_lens: 78.0000 | mixed_lens: 114.0000 | lr: 1.5985e-07 | scale: 1024.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    903/  1000| tot_loss: 2.9932 | rl_loss: 1.2546 | pt_loss: 1.7386 | pg_loss: 0.6418 | reg_loss: 0.6128 | reward: -0.1355 | rev_kl: 0.8245 | stu_lens: 85.5000 | mixed_lens: 71.5000 | lr: 1.5680e-07 | scale: 1024.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    904/  1000| tot_loss: 2.1281 | rl_loss: 0.3956 | pt_loss: 1.7325 | pg_loss: 0.0231 | reg_loss: 0.3725 | reward: -0.1428 | rev_kl: 0.8853 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.5377e-07 | scale: 1024.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    905/  1000| tot_loss: 3.2963 | rl_loss: 1.9142 | pt_loss: 1.3821 | pg_loss: 0.9918 | reg_loss: 0.9224 | reward: -1.2218 | rev_kl: 0.9595 | stu_lens: 78.0000 | mixed_lens: 24.5000 | lr: 1.5077e-07 | scale: 1024.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    906/  1000| tot_loss: 2.9791 | rl_loss: 1.0046 | pt_loss: 1.9745 | pg_loss: 0.0437 | reg_loss: 0.9609 | reward: -0.1776 | rev_kl: 0.8294 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4780e-07 | scale: 1024.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    907/  1000| tot_loss: 2.6102 | rl_loss: 0.6237 | pt_loss: 1.9864 | pg_loss: 0.0275 | reg_loss: 0.5963 | reward: -0.1320 | rev_kl: 0.8929 | stu_lens: 106.5000 | mixed_lens: 128.0000 | lr: 1.4486e-07 | scale: 1024.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    908/  1000| tot_loss: 2.7236 | rl_loss: 0.9541 | pt_loss: 1.7695 | pg_loss: 0.1650 | reg_loss: 0.7891 | reward: -0.1423 | rev_kl: 0.6433 | stu_lens: 128.0000 | mixed_lens: 111.5000 | lr: 1.4194e-07 | scale: 1024.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    909/  1000| tot_loss: 2.9394 | rl_loss: 1.1222 | pt_loss: 1.8172 | pg_loss: 0.0714 | reg_loss: 1.0508 | reward: -0.1409 | rev_kl: 0.7297 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.3906e-07 | scale: 1024.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    910/  1000| tot_loss: 5.5546 | rl_loss: 3.6097 | pt_loss: 1.9449 | pg_loss: 3.4252 | reg_loss: 0.1845 | reward: -0.2364 | rev_kl: 0.4110 | stu_lens: 32.0000 | mixed_lens: 6.0000 | lr: 1.3620e-07 | scale: 1024.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    911/  1000| tot_loss: 2.0182 | rl_loss: 1.0647 | pt_loss: 0.9535 | pg_loss: 0.1112 | reg_loss: 0.9535 | reward: -0.3014 | rev_kl: 0.8696 | stu_lens: 111.0000 | mixed_lens: 110.0000 | lr: 1.3338e-07 | scale: 1024.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    912/  1000| tot_loss: 2.6812 | rl_loss: 0.7522 | pt_loss: 1.9290 | pg_loss: 0.1100 | reg_loss: 0.6422 | reward: -0.1495 | rev_kl: 0.4023 | stu_lens: 92.5000 | mixed_lens: 120.5000 | lr: 1.3058e-07 | scale: 1024.00 | time: 26.286 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    912/  1000| tot_loss: 2.9815 | rl_loss: 1.2365 | pt_loss: 1.7450 | pg_loss: 0.4053 | reg_loss: 0.8312 | reward: -0.2710 | rev_kl: 0.8329 | stu_lens: 97.1094 | mixed_lens: 97.0000 | lr: 1.3058e-07 | scale: 1024.00 | time: 26.286 | step time: 27.547
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    913/  1000| tot_loss: 4.4742 | rl_loss: 2.8140 | pt_loss: 1.6602 | pg_loss: 1.8479 | reg_loss: 0.9662 | reward: -1.0229 | rev_kl: 1.3011 | stu_lens: 11.5000 | mixed_lens: 20.5000 | lr: 1.2781e-07 | scale: 1024.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    914/  1000| tot_loss: 2.8498 | rl_loss: 1.2064 | pt_loss: 1.6434 | pg_loss: 0.0987 | reg_loss: 1.1078 | reward: -0.0796 | rev_kl: 0.9919 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.2507e-07 | scale: 1024.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    915/  1000| tot_loss: 3.0282 | rl_loss: 1.2618 | pt_loss: 1.7664 | pg_loss: 0.5064 | reg_loss: 0.7554 | reward: -0.1070 | rev_kl: 0.5100 | stu_lens: 83.0000 | mixed_lens: 77.5000 | lr: 1.2236e-07 | scale: 1024.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    916/  1000| tot_loss: 4.7226 | rl_loss: 2.8051 | pt_loss: 1.9176 | pg_loss: 2.1277 | reg_loss: 0.6773 | reward: -0.9609 | rev_kl: 0.4775 | stu_lens: 12.5000 | mixed_lens: 14.5000 | lr: 1.1968e-07 | scale: 1024.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    917/  1000| tot_loss: 3.6431 | rl_loss: 1.8647 | pt_loss: 1.7783 | pg_loss: 1.0274 | reg_loss: 0.8373 | reward: -1.6202 | rev_kl: 1.4413 | stu_lens: 67.5000 | mixed_lens: 17.0000 | lr: 1.1702e-07 | scale: 1024.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    918/  1000| tot_loss: 3.2619 | rl_loss: 1.0209 | pt_loss: 2.2409 | pg_loss: 0.1274 | reg_loss: 0.8935 | reward: -0.2309 | rev_kl: 0.6369 | stu_lens: 98.0000 | mixed_lens: 100.5000 | lr: 1.1440e-07 | scale: 1024.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    919/  1000| tot_loss: 2.5603 | rl_loss: 0.8302 | pt_loss: 1.7301 | pg_loss: 0.1556 | reg_loss: 0.6746 | reward: -0.1469 | rev_kl: 0.7006 | stu_lens: 128.0000 | mixed_lens: 111.5000 | lr: 1.1180e-07 | scale: 1024.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    920/  1000| tot_loss: 2.3755 | rl_loss: 0.6057 | pt_loss: 1.7698 | pg_loss: -0.0058 | reg_loss: 0.6115 | reward: -0.1480 | rev_kl: 0.9000 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.0924e-07 | scale: 1024.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    921/  1000| tot_loss: 2.6965 | rl_loss: 0.7513 | pt_loss: 1.9452 | pg_loss: 0.0247 | reg_loss: 0.7266 | reward: -0.1768 | rev_kl: 0.8204 | stu_lens: 120.0000 | mixed_lens: 123.0000 | lr: 1.0670e-07 | scale: 1024.00 | time: 26.201 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    922/  1000| tot_loss: 2.7199 | rl_loss: 1.0977 | pt_loss: 1.6222 | pg_loss: 0.3773 | reg_loss: 0.7204 | reward: -0.4178 | rev_kl: 0.9399 | stu_lens: 84.5000 | mixed_lens: 92.0000 | lr: 1.0419e-07 | scale: 1024.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    923/  1000| tot_loss: 2.5746 | rl_loss: 1.1578 | pt_loss: 1.4168 | pg_loss: 0.1181 | reg_loss: 1.0397 | reward: -0.2029 | rev_kl: 0.9142 | stu_lens: 78.0000 | mixed_lens: 114.0000 | lr: 1.0172e-07 | scale: 1024.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    924/  1000| tot_loss: 2.5582 | rl_loss: 0.7602 | pt_loss: 1.7980 | pg_loss: 0.2130 | reg_loss: 0.5472 | reward: -0.0120 | rev_kl: 0.6161 | stu_lens: 85.5000 | mixed_lens: 86.5000 | lr: 9.9266e-08 | scale: 1024.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    925/  1000| tot_loss: 2.2948 | rl_loss: 0.7527 | pt_loss: 1.5421 | pg_loss: 0.0020 | reg_loss: 0.7507 | reward: -0.1489 | rev_kl: 1.0816 | stu_lens: 106.5000 | mixed_lens: 128.0000 | lr: 9.6846e-08 | scale: 1024.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    926/  1000| tot_loss: 3.9598 | rl_loss: 2.0052 | pt_loss: 1.9546 | pg_loss: 1.2311 | reg_loss: 0.7741 | reward: -0.5582 | rev_kl: 1.0701 | stu_lens: 29.0000 | mixed_lens: 32.0000 | lr: 9.4455e-08 | scale: 1024.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    927/  1000| tot_loss: 3.3783 | rl_loss: 1.4245 | pt_loss: 1.9538 | pg_loss: 0.7342 | reg_loss: 0.6903 | reward: -0.3129 | rev_kl: 0.9338 | stu_lens: 128.0000 | mixed_lens: 75.5000 | lr: 9.2094e-08 | scale: 1024.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    928/  1000| tot_loss: 2.5282 | rl_loss: 0.8838 | pt_loss: 1.6444 | pg_loss: 0.2381 | reg_loss: 0.6457 | reward: -0.2298 | rev_kl: 0.7760 | stu_lens: 128.0000 | mixed_lens: 102.5000 | lr: 8.9761e-08 | scale: 1024.00 | time: 26.283 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    928/  1000| tot_loss: 2.8822 | rl_loss: 1.1512 | pt_loss: 1.7309 | pg_loss: 0.3490 | reg_loss: 0.8022 | reward: -0.3120 | rev_kl: 0.8710 | stu_lens: 90.8750 | mixed_lens: 91.3906 | lr: 8.9761e-08 | scale: 1024.00 | time: 26.283 | step time: 27.543
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    929/  1000| tot_loss: 2.9738 | rl_loss: 1.3001 | pt_loss: 1.6737 | pg_loss: 0.3739 | reg_loss: 0.9263 | reward: -0.4192 | rev_kl: 0.5727 | stu_lens: 72.0000 | mixed_lens: 78.5000 | lr: 8.7459e-08 | scale: 1024.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    930/  1000| tot_loss: 2.2055 | rl_loss: 0.8515 | pt_loss: 1.3540 | pg_loss: 0.1574 | reg_loss: 0.6941 | reward: -0.2035 | rev_kl: 0.7871 | stu_lens: 111.0000 | mixed_lens: 110.0000 | lr: 8.5185e-08 | scale: 1024.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    931/  1000| tot_loss: 3.2306 | rl_loss: 1.2212 | pt_loss: 2.0094 | pg_loss: 0.3905 | reg_loss: 0.8307 | reward: -0.1947 | rev_kl: 1.8046 | stu_lens: 57.0000 | mixed_lens: 70.5000 | lr: 8.2942e-08 | scale: 1024.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    932/  1000| tot_loss: 2.6431 | rl_loss: 0.7050 | pt_loss: 1.9381 | pg_loss: 0.0177 | reg_loss: 0.6873 | reward: -0.1339 | rev_kl: 0.7271 | stu_lens: 94.0000 | mixed_lens: 128.0000 | lr: 8.0727e-08 | scale: 1024.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    933/  1000| tot_loss: 3.1877 | rl_loss: 0.9448 | pt_loss: 2.2429 | pg_loss: 0.2460 | reg_loss: 0.6988 | reward: -0.1611 | rev_kl: 0.9191 | stu_lens: 80.5000 | mixed_lens: 77.0000 | lr: 7.8542e-08 | scale: 1024.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    934/  1000| tot_loss: 3.4943 | rl_loss: 1.6329 | pt_loss: 1.8613 | pg_loss: 1.0022 | reg_loss: 0.6307 | reward: -0.3644 | rev_kl: 0.3717 | stu_lens: 16.0000 | mixed_lens: 52.0000 | lr: 7.6387e-08 | scale: 1024.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    935/  1000| tot_loss: 2.9279 | rl_loss: 0.9012 | pt_loss: 2.0267 | pg_loss: 0.0456 | reg_loss: 0.8556 | reward: -0.1080 | rev_kl: 1.1096 | stu_lens: 84.5000 | mixed_lens: 128.0000 | lr: 7.4261e-08 | scale: 1024.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    936/  1000| tot_loss: 2.5809 | rl_loss: 0.8987 | pt_loss: 1.6822 | pg_loss: 0.2724 | reg_loss: 0.6263 | reward: -0.1894 | rev_kl: 0.7254 | stu_lens: 128.0000 | mixed_lens: 90.5000 | lr: 7.2164e-08 | scale: 1024.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    937/  1000| tot_loss: 2.5153 | rl_loss: 0.8818 | pt_loss: 1.6335 | pg_loss: -0.0046 | reg_loss: 0.8864 | reward: -0.1776 | rev_kl: 0.8294 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 7.0097e-08 | scale: 1024.00 | time: 26.201 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    938/  1000| tot_loss: 2.9932 | rl_loss: 1.0265 | pt_loss: 1.9667 | pg_loss: 0.4310 | reg_loss: 0.5956 | reward: -0.4396 | rev_kl: 0.5696 | stu_lens: 42.0000 | mixed_lens: 49.0000 | lr: 6.8060e-08 | scale: 1024.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    939/  1000| tot_loss: 2.8836 | rl_loss: 0.9649 | pt_loss: 1.9187 | pg_loss: 0.3619 | reg_loss: 0.6030 | reward: -0.3350 | rev_kl: 0.7955 | stu_lens: 100.0000 | mixed_lens: 93.0000 | lr: 6.6053e-08 | scale: 1024.00 | time: 26.197 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    940/  1000| tot_loss: 3.8739 | rl_loss: 2.2203 | pt_loss: 1.6536 | pg_loss: 1.4231 | reg_loss: 0.7971 | reward: -1.2279 | rev_kl: 1.3975 | stu_lens: 18.0000 | mixed_lens: 26.0000 | lr: 6.4075e-08 | scale: 1024.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    941/  1000| tot_loss: 2.9478 | rl_loss: 1.0301 | pt_loss: 1.9177 | pg_loss: 0.1443 | reg_loss: 0.8857 | reward: -0.4611 | rev_kl: 0.6300 | stu_lens: 128.0000 | mixed_lens: 92.0000 | lr: 6.2127e-08 | scale: 1024.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    942/  1000| tot_loss: 2.3453 | rl_loss: 0.5051 | pt_loss: 1.8402 | pg_loss: -0.0041 | reg_loss: 0.5092 | reward: -0.1458 | rev_kl: 0.7325 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 6.0208e-08 | scale: 1024.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    943/  1000| tot_loss: 2.0444 | rl_loss: 0.3899 | pt_loss: 1.6545 | pg_loss: 0.0245 | reg_loss: 0.3655 | reward: -0.9508 | rev_kl: 1.0952 | stu_lens: 128.0000 | mixed_lens: 73.0000 | lr: 5.8319e-08 | scale: 1024.00 | time: 26.198 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    944/  1000| tot_loss: 2.3626 | rl_loss: 0.8447 | pt_loss: 1.5179 | pg_loss: 0.0103 | reg_loss: 0.8344 | reward: -0.1605 | rev_kl: 0.8155 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 5.6460e-08 | scale: 1024.00 | time: 26.231 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    944/  1000| tot_loss: 2.8115 | rl_loss: 1.0845 | pt_loss: 1.7270 | pg_loss: 0.3081 | reg_loss: 0.7765 | reward: -0.3056 | rev_kl: 0.8313 | stu_lens: 90.7344 | mixed_lens: 92.5156 | lr: 5.6460e-08 | scale: 1024.00 | time: 26.231 | step time: 27.524
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    945/  1000| tot_loss: 3.5320 | rl_loss: 1.3326 | pt_loss: 2.1994 | pg_loss: 0.3759 | reg_loss: 0.9567 | reward: -0.4169 | rev_kl: 0.9357 | stu_lens: 78.0000 | mixed_lens: 79.5000 | lr: 5.4631e-08 | scale: 1024.00 | time: 26.202 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    946/  1000| tot_loss: 3.1957 | rl_loss: 1.0413 | pt_loss: 2.1544 | pg_loss: 0.0104 | reg_loss: 1.0309 | reward: -0.1331 | rev_kl: 0.7844 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 5.2832e-08 | scale: 1024.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    947/  1000| tot_loss: 2.9440 | rl_loss: 0.9463 | pt_loss: 1.9976 | pg_loss: 0.0313 | reg_loss: 0.9150 | reward: -0.1523 | rev_kl: 0.7430 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 5.1062e-08 | scale: 1024.00 | time: 26.202 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    948/  1000| tot_loss: 2.3433 | rl_loss: 0.5582 | pt_loss: 1.7851 | pg_loss: 0.0404 | reg_loss: 0.5178 | reward: -0.1562 | rev_kl: 0.9863 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9322e-08 | scale: 1024.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    949/  1000| tot_loss: 2.3054 | rl_loss: 0.8556 | pt_loss: 1.4498 | pg_loss: -0.0003 | reg_loss: 0.8560 | reward: -0.1457 | rev_kl: 0.7168 | stu_lens: 94.0000 | mixed_lens: 128.0000 | lr: 4.7612e-08 | scale: 1024.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    950/  1000| tot_loss: 4.1135 | rl_loss: 2.4098 | pt_loss: 1.7036 | pg_loss: 1.7126 | reg_loss: 0.6972 | reward: -0.5394 | rev_kl: 0.5162 | stu_lens: 16.0000 | mixed_lens: 17.5000 | lr: 4.5932e-08 | scale: 1024.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    951/  1000| tot_loss: 2.5363 | rl_loss: 0.6861 | pt_loss: 1.8502 | pg_loss: 0.0195 | reg_loss: 0.6666 | reward: -0.0715 | rev_kl: 0.5266 | stu_lens: 120.0000 | mixed_lens: 123.0000 | lr: 4.4282e-08 | scale: 1024.00 | time: 26.199 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    952/  1000| tot_loss: 2.6119 | rl_loss: 0.9205 | pt_loss: 1.6915 | pg_loss: -0.0010 | reg_loss: 0.9215 | reward: -0.1371 | rev_kl: 0.7043 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.2662e-08 | scale: 1024.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    953/  1000| tot_loss: 2.0645 | rl_loss: 0.9762 | pt_loss: 1.0882 | pg_loss: 0.0236 | reg_loss: 0.9527 | reward: -0.0724 | rev_kl: 0.7374 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1071e-08 | scale: 1024.00 | time: 26.198 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    954/  1000| tot_loss: 2.5461 | rl_loss: 1.1648 | pt_loss: 1.3813 | pg_loss: 0.3564 | reg_loss: 0.8084 | reward: -0.3238 | rev_kl: 0.9000 | stu_lens: 79.0000 | mixed_lens: 80.5000 | lr: 3.9511e-08 | scale: 1024.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    955/  1000| tot_loss: 2.8263 | rl_loss: 0.8470 | pt_loss: 1.9793 | pg_loss: 0.1470 | reg_loss: 0.7000 | reward: -0.1933 | rev_kl: 0.9841 | stu_lens: 128.0000 | mixed_lens: 102.5000 | lr: 3.7981e-08 | scale: 1024.00 | time: 26.195 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    956/  1000| tot_loss: 3.0330 | rl_loss: 1.1333 | pt_loss: 1.8997 | pg_loss: 0.0098 | reg_loss: 1.1235 | reward: -0.2066 | rev_kl: 0.7732 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6480e-08 | scale: 1024.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    957/  1000| tot_loss: 2.9185 | rl_loss: 0.9180 | pt_loss: 2.0004 | pg_loss: 0.1071 | reg_loss: 0.8109 | reward: -0.2564 | rev_kl: 0.9143 | stu_lens: 89.5000 | mixed_lens: 118.0000 | lr: 3.5010e-08 | scale: 1024.00 | time: 26.198 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    958/  1000| tot_loss: 2.5903 | rl_loss: 1.3176 | pt_loss: 1.2727 | pg_loss: 0.5477 | reg_loss: 0.7698 | reward: -0.4133 | rev_kl: 1.3476 | stu_lens: 44.5000 | mixed_lens: 47.0000 | lr: 3.3570e-08 | scale: 1024.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    959/  1000| tot_loss: 2.9006 | rl_loss: 1.0659 | pt_loss: 1.8347 | pg_loss: 0.2802 | reg_loss: 0.7857 | reward: -0.3174 | rev_kl: 1.0077 | stu_lens: 111.0000 | mixed_lens: 103.0000 | lr: 3.2159e-08 | scale: 1024.00 | time: 26.200 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    960/  1000| tot_loss: 3.1520 | rl_loss: 1.3385 | pt_loss: 1.8135 | pg_loss: 0.7108 | reg_loss: 0.6277 | reward: -0.5191 | rev_kl: 0.5851 | stu_lens: 22.0000 | mixed_lens: 64.5000 | lr: 3.0779e-08 | scale: 1024.00 | time: 26.219 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    960/  1000| tot_loss: 2.8143 | rl_loss: 1.1148 | pt_loss: 1.6994 | pg_loss: 0.3360 | reg_loss: 0.7788 | reward: -0.3051 | rev_kl: 0.8396 | stu_lens: 92.2031 | mixed_lens: 91.0000 | lr: 3.0779e-08 | scale: 1024.00 | time: 26.219 | step time: 27.492
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    961/  1000| tot_loss: 2.1616 | rl_loss: 0.5675 | pt_loss: 1.5941 | pg_loss: 0.0841 | reg_loss: 0.4834 | reward: -0.2777 | rev_kl: 0.6977 | stu_lens: 100.0000 | mixed_lens: 108.0000 | lr: 2.9429e-08 | scale: 1024.00 | time: 26.199 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    962/  1000| tot_loss: 3.4671 | rl_loss: 1.4609 | pt_loss: 2.0062 | pg_loss: 0.3708 | reg_loss: 1.0901 | reward: -1.2008 | rev_kl: 0.6572 | stu_lens: 72.0000 | mixed_lens: 67.5000 | lr: 2.8109e-08 | scale: 1024.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    963/  1000| tot_loss: 3.0801 | rl_loss: 1.2176 | pt_loss: 1.8625 | pg_loss: 0.2224 | reg_loss: 0.9952 | reward: -0.2080 | rev_kl: 1.1657 | stu_lens: 110.0000 | mixed_lens: 95.0000 | lr: 2.6819e-08 | scale: 1024.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    964/  1000| tot_loss: 2.5618 | rl_loss: 1.0348 | pt_loss: 1.5270 | pg_loss: 0.0512 | reg_loss: 0.9836 | reward: -0.1729 | rev_kl: 0.8724 | stu_lens: 118.5000 | mixed_lens: 128.0000 | lr: 2.5559e-08 | scale: 1024.00 | time: 26.192 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    965/  1000| tot_loss: 2.6503 | rl_loss: 1.2129 | pt_loss: 1.4374 | pg_loss: 0.1308 | reg_loss: 1.0821 | reward: -0.2130 | rev_kl: 0.7423 | stu_lens: 110.5000 | mixed_lens: 112.0000 | lr: 2.4330e-08 | scale: 1024.00 | time: 26.220 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    966/  1000| tot_loss: 3.5036 | rl_loss: 1.2394 | pt_loss: 2.2642 | pg_loss: 0.1285 | reg_loss: 1.1109 | reward: 0.0665 | rev_kl: 0.6409 | stu_lens: 86.0000 | mixed_lens: 106.0000 | lr: 2.3130e-08 | scale: 1024.00 | time: 26.199 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    967/  1000| tot_loss: 2.5954 | rl_loss: 0.8892 | pt_loss: 1.7062 | pg_loss: 0.0522 | reg_loss: 0.8370 | reward: -0.0892 | rev_kl: 0.6743 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.1961e-08 | scale: 1024.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    968/  1000| tot_loss: 3.3027 | rl_loss: 1.5208 | pt_loss: 1.7818 | pg_loss: 0.4604 | reg_loss: 1.0605 | reward: -1.7781 | rev_kl: 0.7907 | stu_lens: 128.0000 | mixed_lens: 69.0000 | lr: 2.0822e-08 | scale: 1024.00 | time: 26.200 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    969/  1000| tot_loss: 3.2435 | rl_loss: 1.2720 | pt_loss: 1.9716 | pg_loss: 0.2459 | reg_loss: 1.0261 | reward: -0.5854 | rev_kl: 0.7306 | stu_lens: 128.0000 | mixed_lens: 83.5000 | lr: 1.9713e-08 | scale: 1024.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    970/  1000| tot_loss: 2.8998 | rl_loss: 1.0837 | pt_loss: 1.8161 | pg_loss: 0.0543 | reg_loss: 1.0294 | reward: -0.1666 | rev_kl: 0.9289 | stu_lens: 126.5000 | mixed_lens: 128.0000 | lr: 1.8635e-08 | scale: 1024.00 | time: 26.225 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    971/  1000| tot_loss: 3.5992 | rl_loss: 1.7870 | pt_loss: 1.8122 | pg_loss: 0.6061 | reg_loss: 1.1809 | reward: -0.0218 | rev_kl: 0.2663 | stu_lens: 27.0000 | mixed_lens: 43.0000 | lr: 1.7586e-08 | scale: 1024.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    972/  1000| tot_loss: 1.9151 | rl_loss: 0.7365 | pt_loss: 1.1786 | pg_loss: 0.1787 | reg_loss: 0.5578 | reward: -0.0810 | rev_kl: 0.5081 | stu_lens: 50.5000 | mixed_lens: 112.0000 | lr: 1.6568e-08 | scale: 1024.00 | time: 26.202 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    973/  1000| tot_loss: 3.4766 | rl_loss: 1.6292 | pt_loss: 1.8474 | pg_loss: 0.5045 | reg_loss: 1.1247 | reward: 0.0754 | rev_kl: 0.6790 | stu_lens: 74.5000 | mixed_lens: 75.0000 | lr: 1.5580e-08 | scale: 1024.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    974/  1000| tot_loss: 3.3735 | rl_loss: 1.5993 | pt_loss: 1.7742 | pg_loss: 0.3637 | reg_loss: 1.2356 | reward: -0.5655 | rev_kl: 0.7926 | stu_lens: 107.5000 | mixed_lens: 88.5000 | lr: 1.4623e-08 | scale: 1024.00 | time: 26.196 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    975/  1000| tot_loss: 3.0121 | rl_loss: 0.7924 | pt_loss: 2.2197 | pg_loss: 0.0532 | reg_loss: 0.7392 | reward: -0.1199 | rev_kl: 0.9074 | stu_lens: 100.5000 | mixed_lens: 128.0000 | lr: 1.3695e-08 | scale: 1024.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    976/  1000| tot_loss: 2.2454 | rl_loss: 0.9566 | pt_loss: 1.2888 | pg_loss: 0.0474 | reg_loss: 0.9092 | reward: -0.2081 | rev_kl: 0.4625 | stu_lens: 66.0000 | mixed_lens: 128.0000 | lr: 1.2798e-08 | scale: 1024.00 | time: 26.204 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    976/  1000| tot_loss: 3.0084 | rl_loss: 1.2587 | pt_loss: 1.7497 | pg_loss: 0.2823 | reg_loss: 0.9764 | reward: -0.3574 | rev_kl: 0.7968 | stu_lens: 94.8438 | mixed_lens: 94.2188 | lr: 1.2798e-08 | scale: 1024.00 | time: 26.204 | step time: 27.493
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    977/  1000| tot_loss: 2.7482 | rl_loss: 1.1047 | pt_loss: 1.6435 | pg_loss: 0.1155 | reg_loss: 0.9892 | reward: -0.3190 | rev_kl: 0.7554 | stu_lens: 70.5000 | mixed_lens: 112.5000 | lr: 1.1932e-08 | scale: 1024.00 | time: 26.220 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    978/  1000| tot_loss: 3.0972 | rl_loss: 1.4592 | pt_loss: 1.6380 | pg_loss: 0.5488 | reg_loss: 0.9105 | reward: -0.7898 | rev_kl: 0.8578 | stu_lens: 33.0000 | mixed_lens: 55.5000 | lr: 1.1095e-08 | scale: 1024.00 | time: 26.195 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    979/  1000| tot_loss: 3.1125 | rl_loss: 1.5388 | pt_loss: 1.5738 | pg_loss: 0.6304 | reg_loss: 0.9083 | reward: -0.0862 | rev_kl: 0.4400 | stu_lens: 7.0000 | mixed_lens: 69.0000 | lr: 1.0289e-08 | scale: 1024.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    980/  1000| tot_loss: 3.5371 | rl_loss: 1.4403 | pt_loss: 2.0969 | pg_loss: 0.4092 | reg_loss: 1.0311 | reward: -0.4275 | rev_kl: 0.9756 | stu_lens: 13.0000 | mixed_lens: 71.5000 | lr: 9.5133e-09 | scale: 1024.00 | time: 26.198 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    981/  1000| tot_loss: 2.9578 | rl_loss: 1.1574 | pt_loss: 1.8003 | pg_loss: 0.1473 | reg_loss: 1.0102 | reward: -0.2420 | rev_kl: 0.9345 | stu_lens: 128.0000 | mixed_lens: 114.0000 | lr: 8.7679e-09 | scale: 1024.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    982/  1000| tot_loss: 3.0557 | rl_loss: 1.5584 | pt_loss: 1.4973 | pg_loss: 0.4644 | reg_loss: 1.0939 | reward: -0.5385 | rev_kl: 0.6517 | stu_lens: 128.0000 | mixed_lens: 83.5000 | lr: 8.0528e-09 | scale: 1024.00 | time: 26.201 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    983/  1000| tot_loss: 3.0234 | rl_loss: 1.1285 | pt_loss: 1.8949 | pg_loss: 0.3478 | reg_loss: 0.7807 | reward: 0.1200 | rev_kl: 0.4665 | stu_lens: 74.5000 | mixed_lens: 75.0000 | lr: 7.3681e-09 | scale: 1024.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    984/  1000| tot_loss: 3.1646 | rl_loss: 1.4453 | pt_loss: 1.7193 | pg_loss: 0.2281 | reg_loss: 1.2172 | reward: 0.0966 | rev_kl: 0.2933 | stu_lens: 75.5000 | mixed_lens: 91.5000 | lr: 6.7138e-09 | scale: 1024.00 | time: 26.197 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    985/  1000| tot_loss: 3.3687 | rl_loss: 1.4960 | pt_loss: 1.8727 | pg_loss: 0.4939 | reg_loss: 1.0022 | reward: 0.3891 | rev_kl: 0.6744 | stu_lens: 128.0000 | mixed_lens: 54.0000 | lr: 6.0899e-09 | scale: 1024.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    986/  1000| tot_loss: 2.6791 | rl_loss: 1.0335 | pt_loss: 1.6456 | pg_loss: 0.0420 | reg_loss: 0.9915 | reward: -0.2532 | rev_kl: 1.4579 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 5.4963e-09 | scale: 1024.00 | time: 26.197 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    987/  1000| tot_loss: 2.7254 | rl_loss: 1.3790 | pt_loss: 1.3464 | pg_loss: 0.2301 | reg_loss: 1.1490 | reward: -0.5190 | rev_kl: 0.6681 | stu_lens: 110.5000 | mixed_lens: 81.5000 | lr: 4.9332e-09 | scale: 1024.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    988/  1000| tot_loss: 2.4817 | rl_loss: 0.9857 | pt_loss: 1.4959 | pg_loss: 0.1913 | reg_loss: 0.7944 | reward: -0.1585 | rev_kl: 0.7212 | stu_lens: 128.0000 | mixed_lens: 87.0000 | lr: 4.4004e-09 | scale: 1024.00 | time: 26.199 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    989/  1000| tot_loss: 3.2034 | rl_loss: 1.3467 | pt_loss: 1.8567 | pg_loss: 0.3127 | reg_loss: 1.0341 | reward: -0.3762 | rev_kl: 1.1906 | stu_lens: 92.5000 | mixed_lens: 104.5000 | lr: 3.8981e-09 | scale: 1024.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    990/  1000| tot_loss: 2.8633 | rl_loss: 0.9518 | pt_loss: 1.9115 | pg_loss: 0.4202 | reg_loss: 0.5316 | reward: -0.3863 | rev_kl: 1.0460 | stu_lens: 79.5000 | mixed_lens: 79.5000 | lr: 3.4262e-09 | scale: 1024.00 | time: 26.198 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    991/  1000| tot_loss: 2.6914 | rl_loss: 1.2301 | pt_loss: 1.4613 | pg_loss: 0.0457 | reg_loss: 1.1844 | reward: -0.1866 | rev_kl: 1.0317 | stu_lens: 126.5000 | mixed_lens: 128.0000 | lr: 2.9847e-09 | scale: 1024.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    992/  1000| tot_loss: 2.9339 | rl_loss: 1.0738 | pt_loss: 1.8600 | pg_loss: 0.0518 | reg_loss: 1.0220 | reward: -0.1998 | rev_kl: 0.6846 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.5736e-09 | scale: 1024.00 | time: 26.200 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    992/  1000| tot_loss: 3.0739 | rl_loss: 1.2976 | pt_loss: 1.7763 | pg_loss: 0.3131 | reg_loss: 0.9845 | reward: -0.3326 | rev_kl: 0.7778 | stu_lens: 93.0938 | mixed_lens: 92.0938 | lr: 2.5736e-09 | scale: 1024.00 | time: 26.200 | step time: 27.485
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    993/  1000| tot_loss: 3.1494 | rl_loss: 1.2208 | pt_loss: 1.9286 | pg_loss: 0.2731 | reg_loss: 0.9477 | reward: -0.4378 | rev_kl: 0.8622 | stu_lens: 118.5000 | mixed_lens: 96.0000 | lr: 2.1929e-09 | scale: 1024.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    994/  1000| tot_loss: 2.8568 | rl_loss: 1.5461 | pt_loss: 1.3107 | pg_loss: 0.4437 | reg_loss: 1.1023 | reward: -0.4229 | rev_kl: 1.2687 | stu_lens: 87.0000 | mixed_lens: 84.5000 | lr: 1.8427e-09 | scale: 1024.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    995/  1000| tot_loss: 2.7744 | rl_loss: 1.2494 | pt_loss: 1.5250 | pg_loss: 0.3868 | reg_loss: 0.8626 | reward: 0.0720 | rev_kl: 0.4560 | stu_lens: 74.5000 | mixed_lens: 75.0000 | lr: 1.5229e-09 | scale: 1024.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    996/  1000| tot_loss: 3.2472 | rl_loss: 1.0477 | pt_loss: 2.1995 | pg_loss: 0.2183 | reg_loss: 0.8294 | reward: -0.4476 | rev_kl: 0.9799 | stu_lens: 128.0000 | mixed_lens: 96.0000 | lr: 1.2336e-09 | scale: 1024.00 | time: 26.196 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    997/  1000| tot_loss: 2.6662 | rl_loss: 1.2426 | pt_loss: 1.4236 | pg_loss: 0.1547 | reg_loss: 1.0880 | reward: -0.2186 | rev_kl: 0.9319 | stu_lens: 33.5000 | mixed_lens: 75.0000 | lr: 9.7471e-10 | scale: 1024.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    998/  1000| tot_loss: 2.5398 | rl_loss: 0.9179 | pt_loss: 1.6220 | pg_loss: 0.0450 | reg_loss: 0.8728 | reward: -0.2174 | rev_kl: 0.7796 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 7.4628e-10 | scale: 1024.00 | time: 26.200 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    999/  1000| tot_loss: 3.8172 | rl_loss: 1.9537 | pt_loss: 1.8635 | pg_loss: 0.5549 | reg_loss: 1.3988 | reward: -1.7873 | rev_kl: 1.3686 | stu_lens: 128.0000 | mixed_lens: 73.5000 | lr: 5.4829e-10 | scale: 1024.00 | time: 26.221 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/1000
                                 Evaluation #10                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ dime un chiste acerca de la situacion │ dime un chiste acerca de la          │
│ actual de la economia, de modo que    │ situacion actual de la economia, de  │
│ los niños comprendan el mal estado de │ modo que los niños comprendan el mal │
│ la misma.                             │ estado de la misma.                  │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Dime un chiste acerca de la          │
│                                       │ situacion actual de la economia, de  │
│                                       │ modo que los niños comprendan el mal │
│                                       │ estado de la misma.                  │
│                                       │                                      │
│                                       │ El cierre de la planta de General    │
│                                       │ Motors en Brighton fue un duro golpe │
│                                       │ para la economia local, pero pudo    │
│                                       │ haber sido peor.                     │
│                                       │                                      │
│                                       │ Antes de que se cerrara la planta,   │
│                                       │ los trabajadores de la misma podían  │
│                                       │ hacerse cargo de las compras de los  │
│                                       │ clientes, ya que los mismos se       │
│                                       │ encontraban allí para hacer las      │
│                                       │ compras.                             │
│                                       │                                      │
│                                       │ Ahora, sin la planta,                │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ De acuerdo. Un hombre está dando un  │
│                                       │ paseo y encuentra un revolver        │
│                                       │ abandonado en un rincón. El hombre   │
│                                       │ no es tonto, así que se da cuenta de │
│                                       │ que el arma es una bomba de tiempo.  │
│                                       │ El mismo día, el hombre encuentra un │
│                                       │ cigarrillo abandonado en una pared.  │
│                                       │ El cigarrillo es no es de puros, es  │
│                                       │ un cigarrillo de estómago, con la    │
│                                       │ madera tallada para simular un       │
│                                       │ cigarrillo de puros. En el otro      │
│                                       │ extremo de la calle, un individuo    │
│                                       │ esconde un pan sin importancia. La   │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Sure!                                │
│                                       │                                      │
│                                       │ This is a joke about the difference  │
│                                       │ between American and British         │
│                                       │ English. In Britain, the word        │
│                                       │ "football" refers to a team sport    │
│                                       │ that is played with a round ball. In │
│                                       │ America, the word "football" refers  │
│                                       │ to a team sport that is played with  │
│                                       │ a flat pan.                          │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.400 | exact_match: 0.103 | rev_kl: 0.890 | lens: 91.849 | pt_loss: 1.738 | lm_loss: 1.874 | kd_loss: 1.602 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1000/  1000| tot_loss: 2.8650 | rl_loss: 1.1049 | pt_loss: 1.7601 | pg_loss: 0.0491 | reg_loss: 1.0558 | reward: -0.1479 | rev_kl: 0.8168 | stu_lens: 118.5000 | mixed_lens: 128.0000 | lr: 3.8076e-10 | scale: 1024.00 | time: 26.196 | step time: 0.000
Reached total steps 1000/1000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/1000
                                 Evaluation #11                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ dime un chiste acerca de la situacion │ dime un chiste acerca de la          │
│ actual de la economia, de modo que    │ situacion actual de la economia, de  │
│ los niños comprendan el mal estado de │ modo que los niños comprendan el mal │
│ la misma.                             │ estado de la misma.                  │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ La economía es un sistema que se     │
│                                       │ basa en la transformacion de los     │
│                                       │ recursos naturales en bienes y       │
│                                       │ servicios, con el fin de que los     │
│                                       │ humanos puedan disfrutar de una vida │
│                                       │ mejor. Sin embargo, actualmente la   │
│                                       │ economía se encuentra en un mal      │
│                                       │ estado, ya que los recursos          │
│                                       │ naturales se encuentran amenazados   │
│                                       │ por la contaminaciÃ³n, el            │
│                                       │ desprendimiento de tierras, la       │
│                                       │ sobrepesca, la deforestación, la     │
│                                       │ desertificacion y otras graves       │
│                                       │ amenazas. Por lo tanto, los niños    │
│                                       │ deberian ent                         │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Este chiste es una referencia al     │
│                                       │ nombre de un famoso attorney general │
│                                       │ de Estados Unidos, Robert Kennedy.   │
│                                       │ En el 1968, Kennedy fue asignado a   │
│                                       │ la primera jornada de las pruebas de │
│                                       │ realineamiento de la NASA en la      │
│                                       │ Ciudad de Houston. En el punto más   │
│                                       │ alto de la jornada, el vehículo de   │
│                                       │ Kennedy se desvió de la ruta y se    │
│                                       │ estrelló en un árbol. Kennedy        │
│                                       │ sobrevivió al accidente, pero        │
│                                       │ resultó herido. Posteriormente, se   │
│                                       │ llevó a cabo una investigación para  │
│                                       │ determinar la causa del              │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ No entiendo la gracia de este chiste. │ No entiendo la gracia de este        │
│ ¿Puedes contar otro?                  │ chiste. ¿Puedes contar otro?         │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Es cierto que la gracia de este      │
│                                       │ chiste no puede ser entendida por    │
│                                       │ todos. Para algunos, el chiste es    │
│                                       │ simplemente una pregunta absurda que │
│                                       │ no tiene respuesta. Para otros, el   │
│                                       │ chiste es una broma sutil aluden a   │
│                                       │ la superstición y la leyenda de la   │
│                                       │ India. En el inglés medio, la        │
│                                       │ palabra "dog" significa "perro",     │
│                                       │ pero también significa "verdad". Por │
│                                       │ lo tanto, la frase "No entiendo la   │
│                                       │ verdad del chiste" significa en      │
│                                       │ realidad "No entiendo la gracia del  │
│                                       │ ch                                   │
└───────────────────────────────────────┴──────────────────────────────────────┘
