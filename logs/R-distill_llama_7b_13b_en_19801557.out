Mon Dec 18 13:39:49 2023       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.104.12             Driver Version: 535.104.12   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA H100 PCIe               On  | 00000000:41:00.0 Off |                    0 |
| N/A   25C    P0              45W / 350W |      4MiB / 81559MiB |      0%   E. Process |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
python3 -m torch.distributed.run --nproc_per_node 1 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 3017 /dtu/p1/johlau/LMOps/minillm/train_minillm.py --base-path /dtu/p1/johlau/LMOps/minillm --model-path /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_init/llama-7B --teacher-model-path /dtu/p1/johlau/LMOps/minillm/results/llama/train/sft/llama-13B --ckpt-name 7B-init --teacher-ckpt-name 13B-sft --n-gpu 1 --n-nodes 1 --model-type llama --teacher-model-fp16 --gradient-checkpointing --prompt-data-dir /dtu/p1/johlau/LMOps/minillm/processed_data/dolly_en/prompt/llama/ --lm-data-dir /dtu/p1/johlau/LMOps/minillm/processed_data/roberta_en/llama/256/20M/ --dev-num 1000 --num-workers 0 --epochs 10 --total-iters 5000 --kd-ratio 0.5 --batch-size 2 --eval-batch-size 4 --lr 5e-6 --lr-min 5e-6 --gradient-accumulation-steps 2 --max-length 256 --max-prompt-length 128 --warmup-iters 100 --scheduler-name cosine_trm --save /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/ --seed 10 --seed-ppo 42 --seed-lm 7 --save-interval 250 --eval-interval 100 --log-interval 16 --mid-log-num 1 --type minillm --ppo-epochs 4 --num-rollouts 64 --chunk-size 2 --length-norm --single-step-reg --teacher-mixed-alpha 0.2 --reward-scaling 0.5 --cliprange-reward 100 --do-sample --top-k 0 --top-p 1.0 --temperature 1.0 --deepspeed --deepspeed_config /dtu/p1/johlau/LMOps/minillm/configs/deepspeed/ds_config_zero2_offload.json /dtu/p1/johlau/LMOps/minillm 3017
PYTHONPATH=/dtu/p1/johlau/LMOps/minillm
[2023-12-18 13:39:54,740] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
using world size: 1
[2023-12-18 13:39:56,268] [INFO] [comm.py:637:init_distributed] cdb=None
[2023-12-18 13:39:56,269] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_path ................... /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_init/llama-7B
  ckpt_name .................... 7B-init
  model_type ................... llama
  teacher_model_type ........... None
  n_gpu ........................ 1
  n_nodes ...................... 1
  teacher_model_path ........... /dtu/p1/johlau/LMOps/minillm/results/llama/train/sft/llama-13B
  teacher_ckpt_name ............ 13B-sft
  teacher_model_fp16 ........... True
  model_parallel ............... False
  model_parallel_size .......... None
  no_value ..................... False
  dropout_path_rate ............ None
  fp32 ......................... False
  type ......................... minillm
  do_train ..................... False
  do_valid ..................... False
  do_eval ...................... False
  base_path .................... /dtu/p1/johlau/LMOps/minillm
  load ......................... None
  save ......................... /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
  log_interval ................. 16
  mid_log_num .................. 1
  save_interval ................ 250
  eval_interval ................ 100
  local_rank ................... 0
  save_additional_suffix ....... 
  save_rollout ................. False
  eb_sample_times .............. 3
  data_dir ..................... None
  processed_data_dir ........... None
  force_process ................ False
  force_process_demo ........... False
  data_process_workers ......... -1
  train_num .................... -1
  train_ratio .................. 1
  dev_num ...................... 1000
  dev_ratio .................... 1
  gen_num ...................... -1
  data_names ................... None
  prompt_type .................. None
  num_workers .................. 0
  max_prompt_length ............ 128
  min_prompt_length ............ 64
  json_data .................... False
  bin_data ..................... False
  txt_data ..................... False
  prompt_data_dir .............. /dtu/p1/johlau/LMOps/minillm/processed_data/dolly_en/prompt/llama/
  lm_data_dir .................. /dtu/p1/johlau/LMOps/minillm/processed_data/roberta_en/llama/256/20M/
  eval_ppl ..................... False
  eval_rw ...................... False
  eval_gen ..................... False
  only_prompt .................. False
  batch_size ................... 2
  eval_batch_size .............. 4
  clip_grad .................... 1.0
  total_iters .................. 5000
  train_iters_per_epoch ........ -1
  max_length ................... 256
  seed ......................... 10
  seed_order ................... 42
  seed_data .................... 42
  seed_ppo ..................... 42
  seed_lm ...................... 7
  epochs ....................... 10
  training_epochs .............. 10000
  gradient_accumulation_steps .. 2
  gradient_checkpointing ....... True
  attn_dtype ................... None
  lr ........................... 5e-06
  lr_min ....................... 5e-06
  weight_decay ................. 0.01
  loss_scale ................... 65536
  kd_ratio ..................... 0.5
  warmup_iters ................. 100
  lr_decay_iters ............... None
  lr_decay_style ............... noam
  scheduler_name ............... cosine_trm
  reward_scaling ............... 0.5
  cliprange_reward ............. 100.0
  ppo_epochs ................... 4
  num_rollouts ................. 64
  num_rollouts_per_device ...... 64
  cliprange .................... 0.2
  chunk_size ................... 2
  gamma ........................ 0.95
  length_norm .................. True
  single_step_reg .............. True
  teacher_mixed_alpha .......... 0.2
  lm_coef ...................... 1
  top_k ........................ 0
  top_p ........................ 1.0
  do_sample .................... True
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  num_beams .................... 1
  temperature .................. 1.0
  peft ......................... None
  peft_lora_r .................. 8
  peft_lora_alpha .............. 32
  peft_lora_dropout ............ 0.1
  peft_name .................... None
  peft_path .................... None
  teacher_peft_name ............ None
  teacher_peft_path ............ None
  deepspeed .................... True
  deepspeed_config ............. /dtu/p1/johlau/LMOps/minillm/configs/deepspeed/ds_config_zero2_offload.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  rank ......................... 0
  world_size ................... 1
 > number of parameters: 13015864320
 > number of parameters: 6738415616
Model load time: 15.633073568344116s
 > number of parameters: 6738M
[2023-12-18 13:40:41,399] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.12.1, git-hash=unknown, git-branch=unknown
[2023-12-18 13:40:42,399] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-12-18 13:40:42,402] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2023-12-18 13:40:42,402] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2023-12-18 13:40:42,414] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = AdamW
[2023-12-18 13:40:42,414] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=AdamW type=<class 'torch.optim.adamw.AdamW'>
[2023-12-18 13:40:42,414] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2023-12-18 13:40:42,414] [INFO] [stage_1_and_2.py:147:__init__] Reduce bucket size 200000000
[2023-12-18 13:40:42,414] [INFO] [stage_1_and_2.py:148:__init__] Allgather bucket size 200000000
[2023-12-18 13:40:42,414] [INFO] [stage_1_and_2.py:149:__init__] CPU Offload: True
[2023-12-18 13:40:42,414] [INFO] [stage_1_and_2.py:150:__init__] Round robin gradient partitioning: False
[2023-12-18 13:40:54,448] [INFO] [utils.py:802:see_memory_usage] Before initializing optimizer states
[2023-12-18 13:40:54,449] [INFO] [utils.py:803:see_memory_usage] MA 37.23 GB         Max_MA 37.23 GB         CA 37.23 GB         Max_CA 37 GB 
[2023-12-18 13:40:54,449] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 84.25 GB, percent = 11.2%
[2023-12-18 13:41:43,156] [INFO] [utils.py:802:see_memory_usage] After initializing optimizer states
[2023-12-18 13:41:43,158] [INFO] [utils.py:803:see_memory_usage] MA 37.23 GB         Max_MA 37.23 GB         CA 37.23 GB         Max_CA 37 GB 
[2023-12-18 13:41:43,158] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 160.21 GB, percent = 21.2%
[2023-12-18 13:41:43,158] [INFO] [stage_1_and_2.py:514:__init__] optimizer state initialized
[2023-12-18 13:41:43,246] [INFO] [utils.py:802:see_memory_usage] After initializing ZeRO optimizer
[2023-12-18 13:41:43,247] [INFO] [utils.py:803:see_memory_usage] MA 37.23 GB         Max_MA 37.23 GB         CA 37.23 GB         Max_CA 37 GB 
[2023-12-18 13:41:43,247] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 160.21 GB, percent = 21.2%
[2023-12-18 13:41:43,255] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = AdamW
[2023-12-18 13:41:43,255] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2023-12-18 13:41:43,255] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <torch.optim.lr_scheduler.LambdaLR object at 0x7f36322ed4f0>
[2023-12-18 13:41:43,255] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0], mom=[[0.9, 0.95]]
[2023-12-18 13:41:43,256] [INFO] [config.py:972:print] DeepSpeedEngine configuration:
[2023-12-18 13:41:43,256] [INFO] [config.py:976:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   amp_enabled .................. False
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   amp_params ................... False
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   bfloat16_enabled ............. False
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   checkpoint_parallel_write_pipeline  False
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   checkpoint_tag_validation_enabled  True
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   checkpoint_tag_validation_fail  False
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f36322ed460>
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   communication_data_type ...... None
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   curriculum_enabled_legacy .... False
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   curriculum_params_legacy ..... False
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   data_efficiency_enabled ...... False
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   dataloader_drop_last ......... False
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   disable_allgather ............ False
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   dump_state ................... False
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 5000, 'delayed_shift': 4, 'consecutive_hysteresis': False, 'min_scale': 1}
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   eigenvalue_enabled ........... False
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   eigenvalue_gas_boundary_resolution  1
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   eigenvalue_layer_num ......... 0
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   eigenvalue_max_iter .......... 100
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   eigenvalue_stability ......... 1e-06
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   eigenvalue_tol ............... 0.01
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   eigenvalue_verbose ........... False
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   elasticity_enabled ........... False
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   fp16_auto_cast ............... False
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   fp16_enabled ................. True
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   fp16_master_weights_and_gradients  False
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   global_rank .................. 0
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   grad_accum_dtype ............. None
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   gradient_accumulation_steps .. 2
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   gradient_clipping ............ 1.0
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   gradient_predivide_factor .... 1.0
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   initial_dynamic_scale ........ 2048
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   load_universal_checkpoint .... False
[2023-12-18 13:41:43,257] [INFO] [config.py:976:print]   loss_scale ................... 0
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   memory_breakdown ............. False
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   mics_hierarchial_params_gather  False
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   mics_shard_size .............. -1
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   optimizer_legacy_fusion ...... False
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   optimizer_name ............... None
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   optimizer_params ............. None
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   pld_enabled .................. False
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   pld_params ................... False
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   prescale_gradients ........... False
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   scheduler_name ............... None
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   scheduler_params ............. None
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   seq_parallel_communication_data_type  torch.float32
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   sparse_attention ............. None
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   sparse_gradients_enabled ..... False
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   steps_per_print .............. 10000000
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   train_batch_size ............. 4
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   train_micro_batch_size_per_gpu  2
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   use_node_local_storage ....... False
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   wall_clock_breakdown ......... False
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   weight_quantization_config ... None
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   world_size ................... 1
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   zero_allow_untested_optimizer  True
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=DeepSpeedZeroOffloadOptimizerConfig(device='cpu', nvme_path=None, buffer_count=4, pin_memory=False, pipeline=False, pipeline_read=False, pipeline_write=False, fast_init=False) sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   zero_enabled ................. True
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   zero_force_ds_cpu_optimizer .. False
[2023-12-18 13:41:43,258] [INFO] [config.py:976:print]   zero_optimization_stage ...... 2
[2023-12-18 13:41:43,258] [INFO] [config.py:962:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 2, 
    "zero_optimization": {
        "stage": 2, 
        "offload_optimizer": {
            "device": "cpu"
        }, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true
    }, 
    "zero_force_ds_cpu_optimizer": false, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 5.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1.000000e+07
}
Probing Dataset
Probing end. Max data state 1, total length 2360
Num PPO instances: 2360
Probing Dataset
Probing end. Max data state 1, total length 929
Num PPO instances: 929
Probing Dataset
Probing end. Max data state 1, total length 20000001
Num LM instances: 20000001
Probing Dataset
Probing end. Max data state 1, total length 10000
Num LM instances: 10000
                                 Evaluation #0                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Leave Alice.                         │
│                                       │                                      │
│                                       │ 9% vs 31% is > 100% improvement      │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ It deletes letters you didn't        │
│                                       │ intend. The software is based on     │
│                                       │ smart editing, where it is trained   │
│                                       │ on multiple bilingual text files     │
│                                       │ containing bilingual text. What's    │
│                                       │ the key to differentiating both -    │
│                                       │ levenshtein distance and NLP both    │
│                                       │ perform really well and have         │
│                                       │ challenges.                          │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Bigstep supports Kubernetes and      │
│                                       │ applications on top of Kubernetes in │
│                                       │ the following languages: C, C++, Go, │
│                                       │ Java, and JavaScript.                │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 12.481 | exact_match: 0.215 | rev_kl: 2.115 | lens: 75.250 | pt_loss: 1.152 | lm_loss: 1.263 | kd_loss: 1.042 
Total Steps: 5000 Data Epochs: 10
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:      2/  5000| tot_loss: 4.5344 | rl_loss: 2.7880 | pt_loss: 1.7465 | pg_loss: 0.5432 | reg_loss: 2.2448 | reward: -2.5729 | rev_kl: 1.6918 | stu_lens: 43.5000 | mixed_lens: 75.0000 | lr: 5.0000e-08 | scale: 2048.00 | time: 26.150 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:      3/  5000| tot_loss: 4.5151 | rl_loss: 2.4511 | pt_loss: 2.0640 | pg_loss: 0.2278 | reg_loss: 2.2233 | reward: -0.7253 | rev_kl: 1.8926 | stu_lens: 79.0000 | mixed_lens: 105.0000 | lr: 1.0000e-07 | scale: 2048.00 | time: 26.580 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:      4/  5000| tot_loss: 4.1013 | rl_loss: 2.5863 | pt_loss: 1.5150 | pg_loss: 0.9011 | reg_loss: 1.6852 | reward: -0.9712 | rev_kl: 2.3791 | stu_lens: 76.5000 | mixed_lens: 57.0000 | lr: 1.5000e-07 | scale: 2048.00 | time: 26.615 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:      5/  5000| tot_loss: 3.6277 | rl_loss: 1.7634 | pt_loss: 1.8643 | pg_loss: 0.4049 | reg_loss: 1.3585 | reward: -0.9098 | rev_kl: 1.8953 | stu_lens: 128.0000 | mixed_lens: 68.0000 | lr: 2.0000e-07 | scale: 2048.00 | time: 26.637 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:      6/  5000| tot_loss: 3.9903 | rl_loss: 2.0017 | pt_loss: 1.9886 | pg_loss: 0.0861 | reg_loss: 1.9156 | reward: -0.3206 | rev_kl: 1.6736 | stu_lens: 83.0000 | mixed_lens: 128.0000 | lr: 2.5000e-07 | scale: 2048.00 | time: 26.608 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:      7/  5000| tot_loss: 3.9891 | rl_loss: 1.9509 | pt_loss: 2.0382 | pg_loss: 0.5189 | reg_loss: 1.4321 | reward: -0.7981 | rev_kl: 2.2142 | stu_lens: 33.5000 | mixed_lens: 37.0000 | lr: 3.0000e-07 | scale: 2048.00 | time: 26.570 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:      8/  5000| tot_loss: 6.0596 | rl_loss: 4.9218 | pt_loss: 1.1378 | pg_loss: 2.6693 | reg_loss: 2.2525 | reward: -2.1775 | rev_kl: 1.2941 | stu_lens: 35.0000 | mixed_lens: 9.5000 | lr: 3.5000e-07 | scale: 2048.00 | time: 26.609 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:      9/  5000| tot_loss: 4.8647 | rl_loss: 2.9003 | pt_loss: 1.9644 | pg_loss: 1.9119 | reg_loss: 0.9884 | reward: -1.0501 | rev_kl: 1.6834 | stu_lens: 9.0000 | mixed_lens: 8.0000 | lr: 4.0000e-07 | scale: 2048.00 | time: 26.569 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:     10/  5000| tot_loss: 5.3236 | rl_loss: 2.7910 | pt_loss: 2.5326 | pg_loss: 0.9391 | reg_loss: 1.8519 | reward: -1.8362 | rev_kl: 1.9318 | stu_lens: 80.5000 | mixed_lens: 35.5000 | lr: 4.5000e-07 | scale: 2048.00 | time: 26.590 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:     11/  5000| tot_loss: 5.5255 | rl_loss: 3.7413 | pt_loss: 1.7842 | pg_loss: 1.6744 | reg_loss: 2.0669 | reward: -4.8817 | rev_kl: 2.6823 | stu_lens: 31.0000 | mixed_lens: 29.0000 | lr: 5.0000e-07 | scale: 2048.00 | time: 26.567 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:     12/  5000| tot_loss: 4.2610 | rl_loss: 2.2259 | pt_loss: 2.0351 | pg_loss: 0.0555 | reg_loss: 2.1704 | reward: -0.4506 | rev_kl: 1.9520 | stu_lens: 108.0000 | mixed_lens: 128.0000 | lr: 5.5000e-07 | scale: 2048.00 | time: 26.596 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:     13/  5000| tot_loss: 6.0195 | rl_loss: 4.1772 | pt_loss: 1.8423 | pg_loss: 1.7502 | reg_loss: 2.4270 | reward: -1.4441 | rev_kl: 2.2796 | stu_lens: 57.0000 | mixed_lens: 26.0000 | lr: 6.0000e-07 | scale: 2048.00 | time: 26.561 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:     14/  5000| tot_loss: 3.5941 | rl_loss: 1.4801 | pt_loss: 2.1140 | pg_loss: 0.2413 | reg_loss: 1.2388 | reward: -0.6148 | rev_kl: 1.7593 | stu_lens: 84.5000 | mixed_lens: 102.5000 | lr: 6.5000e-07 | scale: 2048.00 | time: 26.575 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:     15/  5000| tot_loss: 4.4013 | rl_loss: 2.6693 | pt_loss: 1.7320 | pg_loss: 0.5040 | reg_loss: 2.1653 | reward: -1.2064 | rev_kl: 2.3372 | stu_lens: 110.0000 | mixed_lens: 70.0000 | lr: 7.0000e-07 | scale: 2048.00 | time: 26.509 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     16/  5000| tot_loss: 4.2203 | rl_loss: 2.4854 | pt_loss: 1.7349 | pg_loss: 0.3822 | reg_loss: 2.1032 | reward: -4.1458 | rev_kl: 3.9322 | stu_lens: 22.5000 | mixed_lens: 68.0000 | lr: 7.5000e-07 | scale: 2048.00 | time: 26.530 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     16/  5000| tot_loss: 4.2474 | rl_loss: 2.5418 | pt_loss: 1.7056 | pg_loss: 0.6393 | reg_loss: 1.9025 | reward: -1.1901 | rev_kl: 2.0037 | stu_lens: 64.1250 | mixed_lens: 69.7500 | lr: 7.5000e-07 | scale: 2048.00 | time: 26.530 | step time: 26.230
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:     17/  5000| tot_loss: 4.5711 | rl_loss: 2.5800 | pt_loss: 1.9911 | pg_loss: 0.0404 | reg_loss: 2.5396 | reward: -0.7588 | rev_kl: 1.9585 | stu_lens: 61.0000 | mixed_lens: 128.0000 | lr: 8.0000e-07 | scale: 2048.00 | time: 26.526 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:     18/  5000| tot_loss: 4.5352 | rl_loss: 2.5408 | pt_loss: 1.9944 | pg_loss: 0.5779 | reg_loss: 1.9629 | reward: -0.8773 | rev_kl: 2.1492 | stu_lens: 16.5000 | mixed_lens: 73.0000 | lr: 8.5000e-07 | scale: 2048.00 | time: 26.569 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:     19/  5000| tot_loss: 4.7576 | rl_loss: 2.9185 | pt_loss: 1.8392 | pg_loss: 0.3318 | reg_loss: 2.5867 | reward: -0.6388 | rev_kl: 1.8081 | stu_lens: 92.5000 | mixed_lens: 97.5000 | lr: 9.0000e-07 | scale: 2048.00 | time: 26.537 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:     20/  5000| tot_loss: 4.1483 | rl_loss: 2.2608 | pt_loss: 1.8875 | pg_loss: 0.7896 | reg_loss: 1.4712 | reward: -1.6652 | rev_kl: 1.0129 | stu_lens: 20.0000 | mixed_lens: 26.5000 | lr: 9.5000e-07 | scale: 2048.00 | time: 26.555 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:     21/  5000| tot_loss: 5.9063 | rl_loss: 4.0801 | pt_loss: 1.8262 | pg_loss: 1.6017 | reg_loss: 2.4784 | reward: -0.7700 | rev_kl: 1.6542 | stu_lens: 67.5000 | mixed_lens: 23.5000 | lr: 1.0000e-06 | scale: 2048.00 | time: 26.529 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:     22/  5000| tot_loss: 4.2748 | rl_loss: 2.6092 | pt_loss: 1.6655 | pg_loss: 0.5083 | reg_loss: 2.1009 | reward: -4.1994 | rev_kl: 3.4967 | stu_lens: 18.0000 | mixed_lens: 68.0000 | lr: 1.0500e-06 | scale: 2048.00 | time: 26.543 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:     23/  5000| tot_loss: 4.3776 | rl_loss: 2.8855 | pt_loss: 1.4921 | pg_loss: 1.2977 | reg_loss: 1.5878 | reward: -1.2844 | rev_kl: 2.7717 | stu_lens: 28.0000 | mixed_lens: 32.0000 | lr: 1.1000e-06 | scale: 2048.00 | time: 26.533 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:     24/  5000| tot_loss: 3.6327 | rl_loss: 1.8213 | pt_loss: 1.8114 | pg_loss: 0.0266 | reg_loss: 1.7947 | reward: -0.3019 | rev_kl: 1.8598 | stu_lens: 68.5000 | mixed_lens: 128.0000 | lr: 1.1500e-06 | scale: 2048.00 | time: 26.559 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:     25/  5000| tot_loss: 4.4095 | rl_loss: 2.1635 | pt_loss: 2.2460 | pg_loss: 0.0189 | reg_loss: 2.1445 | reward: -0.8418 | rev_kl: 2.1448 | stu_lens: 111.5000 | mixed_lens: 128.0000 | lr: 1.2000e-06 | scale: 2048.00 | time: 26.530 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:     26/  5000| tot_loss: 3.6911 | rl_loss: 2.1489 | pt_loss: 1.5423 | pg_loss: 0.3393 | reg_loss: 1.8096 | reward: -0.5787 | rev_kl: 2.1715 | stu_lens: 76.5000 | mixed_lens: 97.0000 | lr: 1.2500e-06 | scale: 2048.00 | time: 26.596 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:     27/  5000| tot_loss: 4.8341 | rl_loss: 3.1178 | pt_loss: 1.7163 | pg_loss: 1.1823 | reg_loss: 1.9355 | reward: -1.2552 | rev_kl: 2.0211 | stu_lens: 128.0000 | mixed_lens: 28.0000 | lr: 1.3000e-06 | scale: 2048.00 | time: 26.553 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:     28/  5000| tot_loss: 3.5391 | rl_loss: 1.8634 | pt_loss: 1.6757 | pg_loss: 0.2870 | reg_loss: 1.5765 | reward: -1.0298 | rev_kl: 2.0934 | stu_lens: 85.5000 | mixed_lens: 70.0000 | lr: 1.3500e-06 | scale: 2048.00 | time: 26.586 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:     29/  5000| tot_loss: 4.5014 | rl_loss: 3.0890 | pt_loss: 1.4124 | pg_loss: 1.6639 | reg_loss: 1.4250 | reward: -1.5061 | rev_kl: 2.4616 | stu_lens: 22.5000 | mixed_lens: 14.0000 | lr: 1.4000e-06 | scale: 2048.00 | time: 26.555 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:     30/  5000| tot_loss: 4.3001 | rl_loss: 2.6783 | pt_loss: 1.6217 | pg_loss: 1.0448 | reg_loss: 1.6335 | reward: -1.3738 | rev_kl: 2.5330 | stu_lens: 41.0000 | mixed_lens: 45.0000 | lr: 1.4500e-06 | scale: 2048.00 | time: 26.555 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:     31/  5000| tot_loss: 3.8450 | rl_loss: 1.7699 | pt_loss: 2.0751 | pg_loss: 0.1111 | reg_loss: 1.6587 | reward: -0.3119 | rev_kl: 1.6691 | stu_lens: 81.0000 | mixed_lens: 116.5000 | lr: 1.5000e-06 | scale: 2048.00 | time: 26.514 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     32/  5000| tot_loss: 3.5600 | rl_loss: 1.4990 | pt_loss: 2.0610 | pg_loss: 0.5001 | reg_loss: 0.9989 | reward: -0.8359 | rev_kl: 1.7943 | stu_lens: 72.0000 | mixed_lens: 72.5000 | lr: 1.5500e-06 | scale: 2048.00 | time: 26.556 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     32/  5000| tot_loss: 4.2688 | rl_loss: 2.4730 | pt_loss: 1.7958 | pg_loss: 0.5642 | reg_loss: 1.9089 | reward: -1.2150 | rev_kl: 2.0871 | stu_lens: 68.0312 | mixed_lens: 79.0156 | lr: 1.5500e-06 | scale: 2048.00 | time: 26.556 | step time: 27.813
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:     33/  5000| tot_loss: 4.1679 | rl_loss: 2.2586 | pt_loss: 1.9093 | pg_loss: 0.4260 | reg_loss: 1.8326 | reward: -1.5894 | rev_kl: 2.0848 | stu_lens: 105.5000 | mixed_lens: 75.5000 | lr: 1.6000e-06 | scale: 2048.00 | time: 26.497 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:     34/  5000| tot_loss: 3.5607 | rl_loss: 1.8713 | pt_loss: 1.6894 | pg_loss: 0.0471 | reg_loss: 1.8242 | reward: -0.6250 | rev_kl: 2.3919 | stu_lens: 111.0000 | mixed_lens: 125.0000 | lr: 1.6500e-06 | scale: 2048.00 | time: 26.516 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:     35/  5000| tot_loss: 3.0943 | rl_loss: 1.1345 | pt_loss: 1.9598 | pg_loss: 0.4207 | reg_loss: 0.7138 | reward: -0.5041 | rev_kl: 1.6437 | stu_lens: 71.5000 | mixed_lens: 81.0000 | lr: 1.7000e-06 | scale: 2048.00 | time: 26.532 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:     36/  5000| tot_loss: 3.4840 | rl_loss: 1.9312 | pt_loss: 1.5528 | pg_loss: 0.0416 | reg_loss: 1.8896 | reward: -0.5705 | rev_kl: 2.0385 | stu_lens: 54.0000 | mixed_lens: 122.0000 | lr: 1.7500e-06 | scale: 2048.00 | time: 26.537 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:     37/  5000| tot_loss: 2.8512 | rl_loss: 1.3303 | pt_loss: 1.5209 | pg_loss: 0.3497 | reg_loss: 0.9806 | reward: -1.4127 | rev_kl: 1.5054 | stu_lens: 67.5000 | mixed_lens: 66.5000 | lr: 1.8000e-06 | scale: 2048.00 | time: 26.632 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:     38/  5000| tot_loss: 3.4887 | rl_loss: 1.7613 | pt_loss: 1.7274 | pg_loss: 0.2147 | reg_loss: 1.5466 | reward: -0.6867 | rev_kl: 2.2120 | stu_lens: 62.0000 | mixed_lens: 102.5000 | lr: 1.8500e-06 | scale: 2048.00 | time: 26.599 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:     39/  5000| tot_loss: 5.4649 | rl_loss: 4.1870 | pt_loss: 1.2780 | pg_loss: 2.2485 | reg_loss: 1.9385 | reward: -5.5396 | rev_kl: 3.4623 | stu_lens: 20.0000 | mixed_lens: 12.5000 | lr: 1.9000e-06 | scale: 2048.00 | time: 26.539 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:     40/  5000| tot_loss: 3.4798 | rl_loss: 1.6288 | pt_loss: 1.8510 | pg_loss: 0.2520 | reg_loss: 1.3768 | reward: -0.5717 | rev_kl: 1.5909 | stu_lens: 128.0000 | mixed_lens: 93.5000 | lr: 1.9500e-06 | scale: 2048.00 | time: 26.558 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:     41/  5000| tot_loss: 4.0053 | rl_loss: 2.5005 | pt_loss: 1.5048 | pg_loss: 0.8201 | reg_loss: 1.6804 | reward: -1.2788 | rev_kl: 2.6037 | stu_lens: 69.5000 | mixed_lens: 61.0000 | lr: 2.0000e-06 | scale: 2048.00 | time: 26.530 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:     42/  5000| tot_loss: 3.2561 | rl_loss: 1.5937 | pt_loss: 1.6624 | pg_loss: 0.4995 | reg_loss: 1.0942 | reward: -0.8235 | rev_kl: 1.4552 | stu_lens: 55.5000 | mixed_lens: 88.0000 | lr: 2.0500e-06 | scale: 2048.00 | time: 26.574 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:     43/  5000| tot_loss: 3.5720 | rl_loss: 1.7839 | pt_loss: 1.7882 | pg_loss: 0.9442 | reg_loss: 0.8397 | reward: -1.3012 | rev_kl: 2.3140 | stu_lens: 48.5000 | mixed_lens: 50.0000 | lr: 2.1000e-06 | scale: 2048.00 | time: 26.545 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:     44/  5000| tot_loss: 3.5288 | rl_loss: 1.5875 | pt_loss: 1.9413 | pg_loss: 0.0160 | reg_loss: 1.5715 | reward: -0.5448 | rev_kl: 2.4020 | stu_lens: 57.5000 | mixed_lens: 128.0000 | lr: 2.1500e-06 | scale: 2048.00 | time: 26.552 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:     45/  5000| tot_loss: 3.6355 | rl_loss: 2.4188 | pt_loss: 1.2167 | pg_loss: 0.6117 | reg_loss: 1.8071 | reward: -1.0631 | rev_kl: 2.3588 | stu_lens: 97.0000 | mixed_lens: 68.0000 | lr: 2.2000e-06 | scale: 2048.00 | time: 26.507 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:     46/  5000| tot_loss: 3.1020 | rl_loss: 1.4330 | pt_loss: 1.6690 | pg_loss: 0.7724 | reg_loss: 0.6606 | reward: -1.0624 | rev_kl: 1.7996 | stu_lens: 41.5000 | mixed_lens: 31.5000 | lr: 2.2500e-06 | scale: 2048.00 | time: 26.555 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:     47/  5000| tot_loss: 3.2706 | rl_loss: 1.4253 | pt_loss: 1.8452 | pg_loss: 0.0222 | reg_loss: 1.4031 | reward: -0.6189 | rev_kl: 1.9170 | stu_lens: 88.5000 | mixed_lens: 128.0000 | lr: 2.3000e-06 | scale: 2048.00 | time: 26.493 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:     48/  5000| tot_loss: 3.5044 | rl_loss: 2.0576 | pt_loss: 1.4468 | pg_loss: 1.0999 | reg_loss: 0.9577 | reward: -1.0593 | rev_kl: 3.4303 | stu_lens: 13.5000 | mixed_lens: 19.5000 | lr: 2.3500e-06 | scale: 2048.00 | time: 26.523 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:     48/  5000| tot_loss: 3.6606 | rl_loss: 1.9047 | pt_loss: 1.7559 | pg_loss: 0.5580 | reg_loss: 1.3467 | reward: -1.1457 | rev_kl: 2.1752 | stu_lens: 71.8281 | mixed_lens: 79.2812 | lr: 2.3500e-06 | scale: 2048.00 | time: 26.523 | step time: 27.807
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:     49/  5000| tot_loss: 2.5128 | rl_loss: 1.1567 | pt_loss: 1.3561 | pg_loss: 0.7394 | reg_loss: 0.4173 | reward: -4.4166 | rev_kl: 1.6351 | stu_lens: 12.5000 | mixed_lens: 20.5000 | lr: 2.4000e-06 | scale: 2048.00 | time: 26.498 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:     50/  5000| tot_loss: 3.1355 | rl_loss: 0.9916 | pt_loss: 2.1439 | pg_loss: 0.0703 | reg_loss: 0.9213 | reward: -0.7818 | rev_kl: 2.7796 | stu_lens: 39.5000 | mixed_lens: 116.5000 | lr: 2.4500e-06 | scale: 2048.00 | time: 26.515 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:     51/  5000| tot_loss: 2.9118 | rl_loss: 1.5617 | pt_loss: 1.3501 | pg_loss: 0.4825 | reg_loss: 1.0792 | reward: -1.2805 | rev_kl: 1.7335 | stu_lens: 57.0000 | mixed_lens: 75.0000 | lr: 2.5000e-06 | scale: 2048.00 | time: 26.478 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:     52/  5000| tot_loss: 2.3960 | rl_loss: 0.7073 | pt_loss: 1.6887 | pg_loss: 0.4296 | reg_loss: 0.2777 | reward: -0.5863 | rev_kl: 1.4846 | stu_lens: 55.0000 | mixed_lens: 40.5000 | lr: 2.5500e-06 | scale: 2048.00 | time: 26.491 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:     53/  5000| tot_loss: 3.6455 | rl_loss: 1.6929 | pt_loss: 1.9526 | pg_loss: 0.4076 | reg_loss: 1.2853 | reward: -1.2543 | rev_kl: 2.4927 | stu_lens: 97.0000 | mixed_lens: 72.5000 | lr: 2.6000e-06 | scale: 2048.00 | time: 26.467 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:     54/  5000| tot_loss: 3.2261 | rl_loss: 1.3853 | pt_loss: 1.8408 | pg_loss: 0.5037 | reg_loss: 0.8816 | reward: -0.8380 | rev_kl: 1.3280 | stu_lens: 117.5000 | mixed_lens: 74.5000 | lr: 2.6500e-06 | scale: 2048.00 | time: 26.493 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:     55/  5000| tot_loss: 2.7923 | rl_loss: 1.0917 | pt_loss: 1.7006 | pg_loss: 0.0202 | reg_loss: 1.0715 | reward: -0.5828 | rev_kl: 1.9242 | stu_lens: 88.5000 | mixed_lens: 128.0000 | lr: 2.7000e-06 | scale: 2048.00 | time: 26.484 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:     56/  5000| tot_loss: 3.2744 | rl_loss: 1.4106 | pt_loss: 1.8638 | pg_loss: 1.0377 | reg_loss: 0.3729 | reward: -0.8386 | rev_kl: 2.2135 | stu_lens: 53.0000 | mixed_lens: 50.5000 | lr: 2.7500e-06 | scale: 2048.00 | time: 26.519 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:     57/  5000| tot_loss: 2.5976 | rl_loss: 0.9017 | pt_loss: 1.6958 | pg_loss: 0.0523 | reg_loss: 0.8494 | reward: -0.6062 | rev_kl: 1.9951 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8000e-06 | scale: 2048.00 | time: 26.479 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:     58/  5000| tot_loss: 2.9730 | rl_loss: 1.4287 | pt_loss: 1.5444 | pg_loss: 0.5600 | reg_loss: 0.8687 | reward: -0.9021 | rev_kl: 2.7066 | stu_lens: 52.5000 | mixed_lens: 66.5000 | lr: 2.8500e-06 | scale: 2048.00 | time: 26.485 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:     59/  5000| tot_loss: 3.0300 | rl_loss: 1.3184 | pt_loss: 1.7116 | pg_loss: 0.0504 | reg_loss: 1.2680 | reward: -0.5705 | rev_kl: 2.0385 | stu_lens: 54.0000 | mixed_lens: 122.0000 | lr: 2.9000e-06 | scale: 2048.00 | time: 26.452 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:     60/  5000| tot_loss: 3.6547 | rl_loss: 2.1528 | pt_loss: 1.5019 | pg_loss: 1.7662 | reg_loss: 0.3866 | reward: -5.5267 | rev_kl: 2.5826 | stu_lens: 69.0000 | mixed_lens: 14.0000 | lr: 2.9500e-06 | scale: 2048.00 | time: 26.478 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:     61/  5000| tot_loss: 2.5103 | rl_loss: 0.8165 | pt_loss: 1.6938 | pg_loss: 0.2949 | reg_loss: 0.5216 | reward: -0.5000 | rev_kl: 2.8268 | stu_lens: 61.0000 | mixed_lens: 97.0000 | lr: 3.0000e-06 | scale: 2048.00 | time: 26.444 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:     62/  5000| tot_loss: 2.6423 | rl_loss: 1.1475 | pt_loss: 1.4948 | pg_loss: 0.5616 | reg_loss: 0.5859 | reward: -1.3997 | rev_kl: 0.9980 | stu_lens: 67.5000 | mixed_lens: 55.0000 | lr: 3.0500e-06 | scale: 2048.00 | time: 26.484 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:     63/  5000| tot_loss: 2.7427 | rl_loss: 0.7159 | pt_loss: 2.0269 | pg_loss: 0.5073 | reg_loss: 0.2085 | reward: 0.3029 | rev_kl: 2.3242 | stu_lens: 18.0000 | mixed_lens: 8.5000 | lr: 3.1000e-06 | scale: 2048.00 | time: 26.468 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:     64/  5000| tot_loss: 2.8654 | rl_loss: 1.5502 | pt_loss: 1.3151 | pg_loss: 0.7655 | reg_loss: 0.7848 | reward: -1.7578 | rev_kl: 2.5456 | stu_lens: 59.5000 | mixed_lens: 54.5000 | lr: 3.1500e-06 | scale: 2048.00 | time: 26.495 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:     64/  5000| tot_loss: 2.9923 | rl_loss: 1.2856 | pt_loss: 1.7067 | pg_loss: 0.5005 | reg_loss: 0.7851 | reward: -1.3007 | rev_kl: 2.1319 | stu_lens: 68.0781 | mixed_lens: 77.1875 | lr: 3.1500e-06 | scale: 2048.00 | time: 26.495 | step time: 27.747
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:     65/  5000| tot_loss: 2.3168 | rl_loss: 0.7737 | pt_loss: 1.5431 | pg_loss: 0.3616 | reg_loss: 0.4121 | reward: -0.5899 | rev_kl: 1.1638 | stu_lens: 80.5000 | mixed_lens: 88.0000 | lr: 3.2000e-06 | scale: 2048.00 | time: 26.460 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:     66/  5000| tot_loss: 3.6480 | rl_loss: 2.0053 | pt_loss: 1.6427 | pg_loss: 0.4014 | reg_loss: 1.6039 | reward: -0.4085 | rev_kl: 1.7060 | stu_lens: 98.0000 | mixed_lens: 98.5000 | lr: 3.2500e-06 | scale: 2048.00 | time: 26.540 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:     67/  5000| tot_loss: 2.8048 | rl_loss: 1.0954 | pt_loss: 1.7094 | pg_loss: 0.1934 | reg_loss: 0.9020 | reward: -0.1878 | rev_kl: 0.7288 | stu_lens: 127.0000 | mixed_lens: 103.0000 | lr: 3.3000e-06 | scale: 2048.00 | time: 26.470 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:     68/  5000| tot_loss: 2.8287 | rl_loss: 1.3984 | pt_loss: 1.4302 | pg_loss: 0.0499 | reg_loss: 1.3486 | reward: -0.3605 | rev_kl: 1.7566 | stu_lens: 126.0000 | mixed_lens: 128.0000 | lr: 3.3500e-06 | scale: 2048.00 | time: 26.500 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:     69/  5000| tot_loss: 4.5687 | rl_loss: 2.4861 | pt_loss: 2.0826 | pg_loss: 0.6159 | reg_loss: 1.8701 | reward: -0.6097 | rev_kl: 1.7160 | stu_lens: 69.5000 | mixed_lens: 66.0000 | lr: 3.4000e-06 | scale: 2048.00 | time: 26.481 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:     70/  5000| tot_loss: 3.2892 | rl_loss: 1.5130 | pt_loss: 1.7762 | pg_loss: 0.7874 | reg_loss: 0.7256 | reward: -1.4287 | rev_kl: 1.4587 | stu_lens: 53.0000 | mixed_lens: 38.5000 | lr: 3.4500e-06 | scale: 2048.00 | time: 26.520 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:     71/  5000| tot_loss: 3.6431 | rl_loss: 1.9575 | pt_loss: 1.6856 | pg_loss: 0.2367 | reg_loss: 1.7208 | reward: -0.3666 | rev_kl: 1.3393 | stu_lens: 128.0000 | mixed_lens: 87.5000 | lr: 3.5000e-06 | scale: 2048.00 | time: 26.422 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:     72/  5000| tot_loss: 3.3718 | rl_loss: 1.5183 | pt_loss: 1.8535 | pg_loss: 0.3147 | reg_loss: 1.2036 | reward: -0.9640 | rev_kl: 1.5435 | stu_lens: 65.0000 | mixed_lens: 71.5000 | lr: 3.5500e-06 | scale: 2048.00 | time: 26.435 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:     73/  5000| tot_loss: 4.0935 | rl_loss: 2.2238 | pt_loss: 1.8697 | pg_loss: 0.5414 | reg_loss: 1.6824 | reward: -0.2815 | rev_kl: 0.7377 | stu_lens: 66.0000 | mixed_lens: 66.0000 | lr: 3.6000e-06 | scale: 2048.00 | time: 26.362 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:     74/  5000| tot_loss: 3.6603 | rl_loss: 1.8980 | pt_loss: 1.7624 | pg_loss: 0.4658 | reg_loss: 1.4322 | reward: -0.7826 | rev_kl: 1.3192 | stu_lens: 74.0000 | mixed_lens: 82.5000 | lr: 3.6500e-06 | scale: 2048.00 | time: 26.396 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:     75/  5000| tot_loss: 3.1767 | rl_loss: 1.2835 | pt_loss: 1.8932 | pg_loss: 0.0926 | reg_loss: 1.1909 | reward: -0.4513 | rev_kl: 0.9894 | stu_lens: 100.5000 | mixed_lens: 115.0000 | lr: 3.7000e-06 | scale: 2048.00 | time: 26.406 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:     76/  5000| tot_loss: 4.0416 | rl_loss: 2.4146 | pt_loss: 1.6270 | pg_loss: 0.9753 | reg_loss: 1.4394 | reward: -1.5070 | rev_kl: 1.6132 | stu_lens: 50.0000 | mixed_lens: 46.0000 | lr: 3.7500e-06 | scale: 2048.00 | time: 26.423 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:     77/  5000| tot_loss: 3.8099 | rl_loss: 2.3947 | pt_loss: 1.4152 | pg_loss: 1.2499 | reg_loss: 1.1448 | reward: -0.8863 | rev_kl: 1.0911 | stu_lens: 19.0000 | mixed_lens: 38.0000 | lr: 3.8000e-06 | scale: 2048.00 | time: 26.374 | step time: 0.000
[2023-12-18 14:49:39,590] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, but hysteresis is 4. Reducing hysteresis to 3
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:     78/  5000| tot_loss: 9.1602 | rl_loss: 7.1128 | pt_loss: 2.0474 | pg_loss: 4.8349 | reg_loss: 2.2779 | reward: -4.5718 | rev_kl: 4.4923 | stu_lens: 29.0000 | mixed_lens: 4.5000 | lr: 3.8000e-06 | scale: 2048.00 | time: 2.857 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:     79/  5000| tot_loss: 3.4780 | rl_loss: 1.3914 | pt_loss: 2.0866 | pg_loss: 0.2356 | reg_loss: 1.1558 | reward: -0.5068 | rev_kl: 1.4190 | stu_lens: 105.0000 | mixed_lens: 90.0000 | lr: 3.8500e-06 | scale: 2048.00 | time: 26.383 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     80/  5000| tot_loss: 3.7026 | rl_loss: 1.8085 | pt_loss: 1.8941 | pg_loss: 0.2467 | reg_loss: 1.5618 | reward: -0.4252 | rev_kl: 1.9262 | stu_lens: 61.0000 | mixed_lens: 97.0000 | lr: 3.9000e-06 | scale: 2048.00 | time: 26.344 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     80/  5000| tot_loss: 3.7072 | rl_loss: 1.9486 | pt_loss: 1.7586 | pg_loss: 0.6264 | reg_loss: 1.3222 | reward: -0.8112 | rev_kl: 1.5459 | stu_lens: 72.0469 | mixed_lens: 70.1875 | lr: 3.9000e-06 | scale: 2048.00 | time: 26.344 | step time: 26.229
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:     81/  5000| tot_loss: 4.4888 | rl_loss: 2.4917 | pt_loss: 1.9971 | pg_loss: 1.3100 | reg_loss: 1.1817 | reward: -2.3082 | rev_kl: 1.2284 | stu_lens: 25.5000 | mixed_lens: 24.0000 | lr: 3.9500e-06 | scale: 2048.00 | time: 26.350 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:     82/  5000| tot_loss: 3.4014 | rl_loss: 1.4810 | pt_loss: 1.9204 | pg_loss: 0.5601 | reg_loss: 0.9210 | reward: -1.4484 | rev_kl: 1.3542 | stu_lens: 54.5000 | mixed_lens: 54.5000 | lr: 4.0000e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:     83/  5000| tot_loss: 3.6296 | rl_loss: 1.6324 | pt_loss: 1.9972 | pg_loss: 0.5727 | reg_loss: 1.0596 | reward: -0.4434 | rev_kl: 0.9350 | stu_lens: 91.5000 | mixed_lens: 64.0000 | lr: 4.0500e-06 | scale: 2048.00 | time: 26.371 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:     84/  5000| tot_loss: 3.1295 | rl_loss: 1.4614 | pt_loss: 1.6682 | pg_loss: 0.6849 | reg_loss: 0.7765 | reward: -0.4910 | rev_kl: 1.0652 | stu_lens: 80.5000 | mixed_lens: 56.5000 | lr: 4.1000e-06 | scale: 2048.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:     85/  5000| tot_loss: 3.4954 | rl_loss: 1.3058 | pt_loss: 2.1896 | pg_loss: 0.3090 | reg_loss: 0.9968 | reward: -1.0568 | rev_kl: 1.4231 | stu_lens: 81.0000 | mixed_lens: 74.0000 | lr: 4.1500e-06 | scale: 2048.00 | time: 26.359 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:     86/  5000| tot_loss: 3.5250 | rl_loss: 1.5660 | pt_loss: 1.9591 | pg_loss: 0.6391 | reg_loss: 0.9268 | reward: -0.4484 | rev_kl: 1.0281 | stu_lens: 73.0000 | mixed_lens: 58.0000 | lr: 4.2000e-06 | scale: 2048.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:     87/  5000| tot_loss: 3.1098 | rl_loss: 1.3477 | pt_loss: 1.7621 | pg_loss: 0.6460 | reg_loss: 0.7017 | reward: -0.2234 | rev_kl: 2.8429 | stu_lens: 64.0000 | mixed_lens: 35.0000 | lr: 4.2500e-06 | scale: 2048.00 | time: 26.372 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:     88/  5000| tot_loss: 3.1550 | rl_loss: 1.4621 | pt_loss: 1.6929 | pg_loss: 0.5787 | reg_loss: 0.8834 | reward: -3.5573 | rev_kl: 4.4644 | stu_lens: 75.0000 | mixed_lens: 65.0000 | lr: 4.3000e-06 | scale: 2048.00 | time: 26.364 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:     89/  5000| tot_loss: 3.4544 | rl_loss: 1.4331 | pt_loss: 2.0213 | pg_loss: 0.4423 | reg_loss: 0.9907 | reward: -0.2815 | rev_kl: 0.7377 | stu_lens: 66.0000 | mixed_lens: 66.0000 | lr: 4.3500e-06 | scale: 2048.00 | time: 26.372 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:     90/  5000| tot_loss: 3.0034 | rl_loss: 1.2749 | pt_loss: 1.7286 | pg_loss: 0.6970 | reg_loss: 0.5779 | reward: -0.5628 | rev_kl: 1.1231 | stu_lens: 51.5000 | mixed_lens: 55.0000 | lr: 4.4000e-06 | scale: 2048.00 | time: 26.379 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:     91/  5000| tot_loss: 3.6151 | rl_loss: 1.5421 | pt_loss: 2.0729 | pg_loss: 0.4969 | reg_loss: 1.0453 | reward: -1.3306 | rev_kl: 0.8137 | stu_lens: 70.0000 | mixed_lens: 74.5000 | lr: 4.4500e-06 | scale: 2048.00 | time: 26.441 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:     92/  5000| tot_loss: 3.2172 | rl_loss: 1.4393 | pt_loss: 1.7780 | pg_loss: 0.7301 | reg_loss: 0.7091 | reward: -0.4592 | rev_kl: 1.3381 | stu_lens: 22.5000 | mixed_lens: 32.0000 | lr: 4.5000e-06 | scale: 2048.00 | time: 26.401 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:     93/  5000| tot_loss: 2.8325 | rl_loss: 0.8073 | pt_loss: 2.0252 | pg_loss: 0.0459 | reg_loss: 0.7614 | reward: -0.3985 | rev_kl: 1.1247 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5500e-06 | scale: 2048.00 | time: 26.409 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:     94/  5000| tot_loss: 3.4916 | rl_loss: 1.5007 | pt_loss: 1.9909 | pg_loss: 0.7372 | reg_loss: 0.7635 | reward: -0.4391 | rev_kl: 1.7747 | stu_lens: 73.5000 | mixed_lens: 63.0000 | lr: 4.6000e-06 | scale: 2048.00 | time: 26.373 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:     95/  5000| tot_loss: 2.7838 | rl_loss: 0.9235 | pt_loss: 1.8603 | pg_loss: 0.1088 | reg_loss: 0.8147 | reward: -0.4283 | rev_kl: 1.6394 | stu_lens: 88.0000 | mixed_lens: 113.0000 | lr: 4.6500e-06 | scale: 2048.00 | time: 26.390 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     96/  5000| tot_loss: 6.9621 | rl_loss: 5.3209 | pt_loss: 1.6411 | pg_loss: 3.2932 | reg_loss: 2.0277 | reward: -2.1301 | rev_kl: 2.3339 | stu_lens: 19.0000 | mixed_lens: 7.0000 | lr: 4.7000e-06 | scale: 2048.00 | time: 26.352 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     96/  5000| tot_loss: 3.2923 | rl_loss: 1.4411 | pt_loss: 1.8512 | pg_loss: 0.5850 | reg_loss: 0.8561 | reward: -0.8482 | rev_kl: 1.5533 | stu_lens: 70.0156 | mixed_lens: 67.9219 | lr: 4.7000e-06 | scale: 2048.00 | time: 26.352 | step time: 27.633
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:     97/  5000| tot_loss: 3.9550 | rl_loss: 2.1822 | pt_loss: 1.7728 | pg_loss: 1.1520 | reg_loss: 1.0302 | reward: -1.2364 | rev_kl: 1.1304 | stu_lens: 36.0000 | mixed_lens: 46.0000 | lr: 4.7500e-06 | scale: 2048.00 | time: 26.366 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:     98/  5000| tot_loss: 2.8569 | rl_loss: 1.2510 | pt_loss: 1.6059 | pg_loss: 0.6004 | reg_loss: 0.6506 | reward: -1.8002 | rev_kl: 2.0810 | stu_lens: 65.5000 | mixed_lens: 56.5000 | lr: 4.8000e-06 | scale: 2048.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:     99/  5000| tot_loss: 6.5004 | rl_loss: 4.6040 | pt_loss: 1.8965 | pg_loss: 3.0731 | reg_loss: 1.5309 | reward: -1.5264 | rev_kl: 2.6231 | stu_lens: 18.5000 | mixed_lens: 7.5000 | lr: 4.8500e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
                                 Evaluation #1                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Yes, Bob should leave Alice. By      │
│                                       │ leaving Alice, his chances of        │
│                                       │ survival increases by 9%.            │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ It is because of the way the         │
│                                       │ keyboard is laid out. The QWERTY     │
│                                       │ keyboard is laid out in a certain    │
│                                       │ way so that people can type quickly  │
│                                       │ and efficiently. The Y and Z keys    │
│                                       │ are right next to each other, so it  │
│                                       │ is hard to hit the correct key when  │
│                                       │ you are typing quickly. To avoid     │
│                                       │ this, the Z key is used for the      │
│                                       │ letter Y, and the Y key is used for  │
│                                       │ the letter Z.                        │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support English and Chinese       │
│                                       │ (Mandarin).                          │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.279 | exact_match: 0.323 | rev_kl: 1.263 | lens: 88.756 | pt_loss: 1.118 | lm_loss: 1.229 | kd_loss: 1.007 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    100/  5000| tot_loss: 2.8444 | rl_loss: 0.6743 | pt_loss: 2.1702 | pg_loss: 0.3738 | reg_loss: 0.3005 | reward: -0.8015 | rev_kl: 0.6349 | stu_lens: 40.5000 | mixed_lens: 47.5000 | lr: 4.9000e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    101/  5000| tot_loss: 3.1133 | rl_loss: 1.2942 | pt_loss: 1.8191 | pg_loss: 0.7118 | reg_loss: 0.5824 | reward: -0.4732 | rev_kl: 1.3699 | stu_lens: 73.0000 | mixed_lens: 60.5000 | lr: 4.9500e-06 | scale: 2048.00 | time: 26.348 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    102/  5000| tot_loss: 2.8811 | rl_loss: 1.1374 | pt_loss: 1.7437 | pg_loss: 0.4186 | reg_loss: 0.7189 | reward: -0.8798 | rev_kl: 1.4699 | stu_lens: 51.0000 | mixed_lens: 72.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    103/  5000| tot_loss: 3.0553 | rl_loss: 1.2002 | pt_loss: 1.8551 | pg_loss: 0.5310 | reg_loss: 0.6692 | reward: -0.6097 | rev_kl: 1.7160 | stu_lens: 69.5000 | mixed_lens: 66.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.314 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    104/  5000| tot_loss: 3.1910 | rl_loss: 1.8047 | pt_loss: 1.3863 | pg_loss: 0.9362 | reg_loss: 0.8685 | reward: -0.5666 | rev_kl: 1.0271 | stu_lens: 25.0000 | mixed_lens: 20.5000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.336 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    105/  5000| tot_loss: 4.7380 | rl_loss: 3.4415 | pt_loss: 1.2965 | pg_loss: 2.6794 | reg_loss: 0.7621 | reward: -5.3732 | rev_kl: 4.6526 | stu_lens: 20.0000 | mixed_lens: 10.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    106/  5000| tot_loss: 4.8256 | rl_loss: 3.0420 | pt_loss: 1.7836 | pg_loss: 2.2937 | reg_loss: 0.7483 | reward: -1.5096 | rev_kl: 1.6197 | stu_lens: 23.5000 | mixed_lens: 11.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    107/  5000| tot_loss: 2.8126 | rl_loss: 0.6543 | pt_loss: 2.1584 | pg_loss: 0.0019 | reg_loss: 0.6524 | reward: -0.4653 | rev_kl: 1.6685 | stu_lens: 128.0000 | mixed_lens: 125.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    108/  5000| tot_loss: 2.4429 | rl_loss: 0.8043 | pt_loss: 1.6386 | pg_loss: 0.3239 | reg_loss: 0.4805 | reward: -0.4394 | rev_kl: 2.0244 | stu_lens: 111.5000 | mixed_lens: 57.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.394 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    109/  5000| tot_loss: 2.4589 | rl_loss: 0.8815 | pt_loss: 1.5775 | pg_loss: 0.1201 | reg_loss: 0.7614 | reward: -0.4492 | rev_kl: 1.2956 | stu_lens: 97.5000 | mixed_lens: 111.5000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.348 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    110/  5000| tot_loss: 2.5651 | rl_loss: 0.3834 | pt_loss: 2.1817 | pg_loss: 0.2257 | reg_loss: 0.1576 | reward: -0.9260 | rev_kl: 0.8095 | stu_lens: 80.0000 | mixed_lens: 77.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.385 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    111/  5000| tot_loss: 2.7491 | rl_loss: 0.8241 | pt_loss: 1.9249 | pg_loss: 0.2379 | reg_loss: 0.5862 | reward: -0.3452 | rev_kl: 1.2080 | stu_lens: 81.0000 | mixed_lens: 88.5000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.387 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    112/  5000| tot_loss: 2.3011 | rl_loss: 0.8588 | pt_loss: 1.4422 | pg_loss: 0.3412 | reg_loss: 0.5176 | reward: -0.3236 | rev_kl: 0.9346 | stu_lens: 80.0000 | mixed_lens: 79.0000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.357 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    112/  5000| tot_loss: 3.0006 | rl_loss: 1.2938 | pt_loss: 1.7068 | pg_loss: 0.6597 | reg_loss: 0.6342 | reward: -0.8229 | rev_kl: 1.4911 | stu_lens: 71.8594 | mixed_lens: 67.8594 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.357 | step time: 27.599
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    113/  5000| tot_loss: 2.9953 | rl_loss: 1.1013 | pt_loss: 1.8940 | pg_loss: 0.4786 | reg_loss: 0.6228 | reward: -0.5291 | rev_kl: 2.0092 | stu_lens: 58.5000 | mixed_lens: 73.5000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.429 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    114/  5000| tot_loss: 2.2208 | rl_loss: 0.7339 | pt_loss: 1.4869 | pg_loss: 0.1516 | reg_loss: 0.5823 | reward: -0.4238 | rev_kl: 1.4210 | stu_lens: 108.0000 | mixed_lens: 103.0000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.444 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    115/  5000| tot_loss: 2.1762 | rl_loss: 0.7392 | pt_loss: 1.4370 | pg_loss: 0.2338 | reg_loss: 0.5054 | reward: -1.0195 | rev_kl: 1.5048 | stu_lens: 82.0000 | mixed_lens: 75.5000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.484 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    116/  5000| tot_loss: 2.4171 | rl_loss: 0.9495 | pt_loss: 1.4677 | pg_loss: 0.3402 | reg_loss: 0.6093 | reward: -0.6080 | rev_kl: 1.1746 | stu_lens: 68.0000 | mixed_lens: 90.5000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.445 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    117/  5000| tot_loss: 3.3555 | rl_loss: 1.5357 | pt_loss: 1.8198 | pg_loss: 0.9925 | reg_loss: 0.5432 | reward: -0.6121 | rev_kl: 1.2553 | stu_lens: 33.0000 | mixed_lens: 39.5000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.457 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    118/  5000| tot_loss: 2.7666 | rl_loss: 1.2494 | pt_loss: 1.5172 | pg_loss: 0.7851 | reg_loss: 0.4644 | reward: -0.4347 | rev_kl: 1.2605 | stu_lens: 56.0000 | mixed_lens: 79.0000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.431 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    119/  5000| tot_loss: 2.0124 | rl_loss: 0.7454 | pt_loss: 1.2670 | pg_loss: 0.2233 | reg_loss: 0.5222 | reward: -0.1064 | rev_kl: 1.2586 | stu_lens: 41.5000 | mixed_lens: 89.0000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    120/  5000| tot_loss: 2.1095 | rl_loss: 0.9911 | pt_loss: 1.1184 | pg_loss: 0.5257 | reg_loss: 0.4653 | reward: -1.3167 | rev_kl: 1.3846 | stu_lens: 60.0000 | mixed_lens: 63.5000 | lr: 4.9998e-06 | scale: 2048.00 | time: 26.416 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    121/  5000| tot_loss: 2.1435 | rl_loss: 0.7801 | pt_loss: 1.3635 | pg_loss: 0.2960 | reg_loss: 0.4841 | reward: -0.4755 | rev_kl: 1.7481 | stu_lens: 74.5000 | mixed_lens: 70.5000 | lr: 4.9998e-06 | scale: 2048.00 | time: 26.384 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    122/  5000| tot_loss: 2.7197 | rl_loss: 0.9673 | pt_loss: 1.7524 | pg_loss: 0.5805 | reg_loss: 0.3868 | reward: -0.3287 | rev_kl: 1.4130 | stu_lens: 87.0000 | mixed_lens: 67.0000 | lr: 4.9998e-06 | scale: 2048.00 | time: 26.421 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    123/  5000| tot_loss: 2.1574 | rl_loss: 0.4427 | pt_loss: 1.7147 | pg_loss: 0.0207 | reg_loss: 0.4220 | reward: -0.3548 | rev_kl: 1.9111 | stu_lens: 98.0000 | mixed_lens: 128.0000 | lr: 4.9998e-06 | scale: 2048.00 | time: 26.508 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    124/  5000| tot_loss: 3.5422 | rl_loss: 2.1320 | pt_loss: 1.4101 | pg_loss: 1.6848 | reg_loss: 0.4472 | reward: -2.1456 | rev_kl: 1.5073 | stu_lens: 35.0000 | mixed_lens: 16.5000 | lr: 4.9998e-06 | scale: 2048.00 | time: 26.485 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    125/  5000| tot_loss: 3.4317 | rl_loss: 1.1496 | pt_loss: 2.2822 | pg_loss: 0.6523 | reg_loss: 0.4973 | reward: -0.2155 | rev_kl: 1.9126 | stu_lens: 80.5000 | mixed_lens: 54.0000 | lr: 4.9997e-06 | scale: 2048.00 | time: 26.492 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    126/  5000| tot_loss: 2.4811 | rl_loss: 0.6940 | pt_loss: 1.7871 | pg_loss: 0.2985 | reg_loss: 0.3955 | reward: -0.9154 | rev_kl: 1.8586 | stu_lens: 97.0000 | mixed_lens: 97.0000 | lr: 4.9997e-06 | scale: 2048.00 | time: 26.531 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    127/  5000| tot_loss: 2.4599 | rl_loss: 0.9140 | pt_loss: 1.5459 | pg_loss: 0.5383 | reg_loss: 0.3758 | reward: -0.6009 | rev_kl: 1.6475 | stu_lens: 77.0000 | mixed_lens: 77.0000 | lr: 4.9997e-06 | scale: 2048.00 | time: 26.512 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    128/  5000| tot_loss: 2.6607 | rl_loss: 0.6917 | pt_loss: 1.9690 | pg_loss: 0.3569 | reg_loss: 0.3348 | reward: -0.2487 | rev_kl: 1.0757 | stu_lens: 83.5000 | mixed_lens: 76.0000 | lr: 4.9997e-06 | scale: 2048.00 | time: 26.484 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    128/  5000| tot_loss: 2.7822 | rl_loss: 1.1005 | pt_loss: 1.6817 | pg_loss: 0.6255 | reg_loss: 0.4750 | reward: -0.8289 | rev_kl: 1.5316 | stu_lens: 66.4844 | mixed_lens: 67.2188 | lr: 4.9997e-06 | scale: 2048.00 | time: 26.484 | step time: 27.707
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    129/  5000| tot_loss: 1.9965 | rl_loss: 0.6773 | pt_loss: 1.3192 | pg_loss: 0.3458 | reg_loss: 0.3315 | reward: -0.2900 | rev_kl: 2.2993 | stu_lens: 110.5000 | mixed_lens: 73.5000 | lr: 4.9996e-06 | scale: 2048.00 | time: 26.468 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    130/  5000| tot_loss: 3.7554 | rl_loss: 2.1825 | pt_loss: 1.5729 | pg_loss: 0.6584 | reg_loss: 1.5240 | reward: -0.8905 | rev_kl: 0.8816 | stu_lens: 111.5000 | mixed_lens: 44.0000 | lr: 4.9996e-06 | scale: 2048.00 | time: 26.440 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    131/  5000| tot_loss: 4.6453 | rl_loss: 3.3855 | pt_loss: 1.2599 | pg_loss: 1.6846 | reg_loss: 1.7009 | reward: -1.0593 | rev_kl: 1.2917 | stu_lens: 52.0000 | mixed_lens: 29.0000 | lr: 4.9996e-06 | scale: 2048.00 | time: 26.416 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    132/  5000| tot_loss: 3.6018 | rl_loss: 1.9069 | pt_loss: 1.6949 | pg_loss: 0.3438 | reg_loss: 1.5631 | reward: -0.7848 | rev_kl: 1.1134 | stu_lens: 98.5000 | mixed_lens: 89.0000 | lr: 4.9995e-06 | scale: 2048.00 | time: 26.414 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    133/  5000| tot_loss: 3.9040 | rl_loss: 2.1268 | pt_loss: 1.7772 | pg_loss: 1.5852 | reg_loss: 0.5417 | reward: -0.2219 | rev_kl: 0.3883 | stu_lens: 26.5000 | mixed_lens: 26.0000 | lr: 4.9995e-06 | scale: 2048.00 | time: 26.481 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    134/  5000| tot_loss: 3.5252 | rl_loss: 1.6854 | pt_loss: 1.8398 | pg_loss: 0.3495 | reg_loss: 1.3359 | reward: -0.0149 | rev_kl: 1.3981 | stu_lens: 37.0000 | mixed_lens: 82.0000 | lr: 4.9995e-06 | scale: 2048.00 | time: 26.477 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    135/  5000| tot_loss: 3.0299 | rl_loss: 1.3491 | pt_loss: 1.6808 | pg_loss: 0.2101 | reg_loss: 1.1389 | reward: -0.1961 | rev_kl: 1.2757 | stu_lens: 88.5000 | mixed_lens: 106.0000 | lr: 4.9994e-06 | scale: 2048.00 | time: 26.461 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    136/  5000| tot_loss: 3.4515 | rl_loss: 2.0691 | pt_loss: 1.3824 | pg_loss: 0.5651 | reg_loss: 1.5040 | reward: 0.4297 | rev_kl: 0.9984 | stu_lens: 44.0000 | mixed_lens: 70.5000 | lr: 4.9994e-06 | scale: 2048.00 | time: 26.459 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    137/  5000| tot_loss: 3.3575 | rl_loss: 1.3352 | pt_loss: 2.0223 | pg_loss: 0.0812 | reg_loss: 1.2540 | reward: -0.0317 | rev_kl: 1.8570 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9994e-06 | scale: 2048.00 | time: 26.439 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    138/  5000| tot_loss: 2.4281 | rl_loss: 1.1142 | pt_loss: 1.3140 | pg_loss: 0.1768 | reg_loss: 0.9374 | reward: -1.3695 | rev_kl: 1.6485 | stu_lens: 84.0000 | mixed_lens: 74.0000 | lr: 4.9993e-06 | scale: 2048.00 | time: 26.490 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    139/  5000| tot_loss: 3.8389 | rl_loss: 1.7339 | pt_loss: 2.1049 | pg_loss: 0.0972 | reg_loss: 1.6367 | reward: -0.2588 | rev_kl: 1.5130 | stu_lens: 100.5000 | mixed_lens: 122.5000 | lr: 4.9993e-06 | scale: 2048.00 | time: 26.471 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    140/  5000| tot_loss: 3.6845 | rl_loss: 1.5502 | pt_loss: 2.1342 | pg_loss: 0.2288 | reg_loss: 1.3214 | reward: -0.2155 | rev_kl: 1.0273 | stu_lens: 100.0000 | mixed_lens: 95.5000 | lr: 4.9993e-06 | scale: 2048.00 | time: 26.525 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    141/  5000| tot_loss: 2.5175 | rl_loss: 1.2832 | pt_loss: 1.2343 | pg_loss: 0.0686 | reg_loss: 1.2146 | reward: -0.2692 | rev_kl: 1.2926 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9992e-06 | scale: 2048.00 | time: 26.504 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    142/  5000| tot_loss: 3.0711 | rl_loss: 1.6291 | pt_loss: 1.4420 | pg_loss: 0.2869 | reg_loss: 1.3422 | reward: -0.0797 | rev_kl: 1.4214 | stu_lens: 65.5000 | mixed_lens: 77.0000 | lr: 4.9992e-06 | scale: 2048.00 | time: 26.460 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    143/  5000| tot_loss: 3.5883 | rl_loss: 1.9620 | pt_loss: 1.6262 | pg_loss: 0.3838 | reg_loss: 1.5782 | reward: -0.6492 | rev_kl: 1.1312 | stu_lens: 88.0000 | mixed_lens: 92.0000 | lr: 4.9991e-06 | scale: 2048.00 | time: 26.479 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    144/  5000| tot_loss: 2.6788 | rl_loss: 0.9209 | pt_loss: 1.7579 | pg_loss: 0.2342 | reg_loss: 0.6867 | reward: -0.6776 | rev_kl: 0.7465 | stu_lens: 98.5000 | mixed_lens: 86.5000 | lr: 4.9991e-06 | scale: 2048.00 | time: 26.501 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    144/  5000| tot_loss: 3.5033 | rl_loss: 1.7923 | pt_loss: 1.7110 | pg_loss: 0.5235 | reg_loss: 1.2688 | reward: -0.4393 | rev_kl: 1.2719 | stu_lens: 79.0469 | mixed_lens: 75.2500 | lr: 4.9991e-06 | scale: 2048.00 | time: 26.501 | step time: 27.726
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    145/  5000| tot_loss: 4.1281 | rl_loss: 2.3447 | pt_loss: 1.7834 | pg_loss: 0.7843 | reg_loss: 1.5604 | reward: -0.5612 | rev_kl: 2.4338 | stu_lens: 78.0000 | mixed_lens: 54.0000 | lr: 4.9990e-06 | scale: 2048.00 | time: 26.474 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    146/  5000| tot_loss: 2.1176 | rl_loss: 0.7795 | pt_loss: 1.3381 | pg_loss: 0.0205 | reg_loss: 0.7591 | reward: -0.4333 | rev_kl: 1.5091 | stu_lens: 113.5000 | mixed_lens: 128.0000 | lr: 4.9990e-06 | scale: 2048.00 | time: 26.460 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    147/  5000| tot_loss: 2.9642 | rl_loss: 1.3106 | pt_loss: 1.6536 | pg_loss: 0.3703 | reg_loss: 0.9404 | reward: -0.1757 | rev_kl: 1.1583 | stu_lens: 79.0000 | mixed_lens: 73.0000 | lr: 4.9990e-06 | scale: 2048.00 | time: 26.447 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    148/  5000| tot_loss: 2.5731 | rl_loss: 1.1069 | pt_loss: 1.4661 | pg_loss: 0.2986 | reg_loss: 0.8083 | reward: -0.1932 | rev_kl: 1.1275 | stu_lens: 118.0000 | mixed_lens: 95.5000 | lr: 4.9989e-06 | scale: 2048.00 | time: 26.446 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    149/  5000| tot_loss: 3.4450 | rl_loss: 1.9562 | pt_loss: 1.4887 | pg_loss: 0.9089 | reg_loss: 1.0474 | reward: -0.8202 | rev_kl: 0.9673 | stu_lens: 98.0000 | mixed_lens: 41.0000 | lr: 4.9989e-06 | scale: 2048.00 | time: 26.403 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    150/  5000| tot_loss: 2.2463 | rl_loss: 0.6318 | pt_loss: 1.6145 | pg_loss: 0.1167 | reg_loss: 0.5151 | reward: -0.8078 | rev_kl: 0.7259 | stu_lens: 128.0000 | mixed_lens: 92.5000 | lr: 4.9988e-06 | scale: 2048.00 | time: 26.458 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    151/  5000| tot_loss: 3.0683 | rl_loss: 1.5472 | pt_loss: 1.5211 | pg_loss: 0.9238 | reg_loss: 0.6233 | reward: -0.0693 | rev_kl: 1.2734 | stu_lens: 45.0000 | mixed_lens: 37.0000 | lr: 4.9988e-06 | scale: 2048.00 | time: 26.419 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    152/  5000| tot_loss: 2.9561 | rl_loss: 0.9730 | pt_loss: 1.9831 | pg_loss: 0.1935 | reg_loss: 0.7795 | reward: -0.1890 | rev_kl: 1.7085 | stu_lens: 86.5000 | mixed_lens: 92.0000 | lr: 4.9987e-06 | scale: 2048.00 | time: 26.457 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    153/  5000| tot_loss: 2.8571 | rl_loss: 1.0924 | pt_loss: 1.7646 | pg_loss: 0.1816 | reg_loss: 0.9109 | reward: -0.7285 | rev_kl: 1.1589 | stu_lens: 95.5000 | mixed_lens: 86.0000 | lr: 4.9987e-06 | scale: 2048.00 | time: 26.428 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    154/  5000| tot_loss: 3.0796 | rl_loss: 1.1016 | pt_loss: 1.9781 | pg_loss: 0.1879 | reg_loss: 0.9137 | reward: -1.3652 | rev_kl: 1.6357 | stu_lens: 38.5000 | mixed_lens: 74.0000 | lr: 4.9986e-06 | scale: 2048.00 | time: 26.427 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    155/  5000| tot_loss: 2.3605 | rl_loss: 1.1524 | pt_loss: 1.2081 | pg_loss: 0.2750 | reg_loss: 0.8774 | reward: -0.2160 | rev_kl: 2.4923 | stu_lens: 126.0000 | mixed_lens: 97.0000 | lr: 4.9986e-06 | scale: 2048.00 | time: 26.386 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    156/  5000| tot_loss: 3.2816 | rl_loss: 1.5560 | pt_loss: 1.7257 | pg_loss: 0.7215 | reg_loss: 0.8345 | reward: -0.4885 | rev_kl: 1.2517 | stu_lens: 76.0000 | mixed_lens: 57.5000 | lr: 4.9985e-06 | scale: 2048.00 | time: 26.413 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    157/  5000| tot_loss: 3.7018 | rl_loss: 1.4142 | pt_loss: 2.2876 | pg_loss: 0.9670 | reg_loss: 0.4472 | reward: -0.8127 | rev_kl: 0.8834 | stu_lens: 15.0000 | mixed_lens: 22.5000 | lr: 4.9984e-06 | scale: 2048.00 | time: 26.457 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    158/  5000| tot_loss: 3.4471 | rl_loss: 1.5045 | pt_loss: 1.9426 | pg_loss: 0.5203 | reg_loss: 0.9842 | reward: -0.2352 | rev_kl: 1.4653 | stu_lens: 96.5000 | mixed_lens: 70.5000 | lr: 4.9984e-06 | scale: 2048.00 | time: 26.431 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    159/  5000| tot_loss: 3.1382 | rl_loss: 1.3407 | pt_loss: 1.7975 | pg_loss: 0.3396 | reg_loss: 1.0011 | reward: -0.3863 | rev_kl: 1.3530 | stu_lens: 88.0000 | mixed_lens: 59.5000 | lr: 4.9983e-06 | scale: 2048.00 | time: 26.443 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    160/  5000| tot_loss: 2.9730 | rl_loss: 0.8978 | pt_loss: 2.0752 | pg_loss: 0.2025 | reg_loss: 0.6953 | reward: -0.2664 | rev_kl: 1.3891 | stu_lens: 65.0000 | mixed_lens: 106.0000 | lr: 4.9983e-06 | scale: 2048.00 | time: 26.459 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    160/  5000| tot_loss: 3.0963 | rl_loss: 1.3484 | pt_loss: 1.7479 | pg_loss: 0.4749 | reg_loss: 0.8735 | reward: -0.4443 | rev_kl: 1.4041 | stu_lens: 78.5156 | mixed_lens: 73.9688 | lr: 4.9983e-06 | scale: 2048.00 | time: 26.459 | step time: 27.699
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    161/  5000| tot_loss: 2.7395 | rl_loss: 0.6942 | pt_loss: 2.0453 | pg_loss: 0.0426 | reg_loss: 0.6516 | reward: -0.2062 | rev_kl: 1.3679 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9982e-06 | scale: 2048.00 | time: 26.456 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    162/  5000| tot_loss: 2.8777 | rl_loss: 1.6789 | pt_loss: 1.1988 | pg_loss: 1.2827 | reg_loss: 0.3961 | reward: -0.5999 | rev_kl: 0.4432 | stu_lens: 14.0000 | mixed_lens: 15.5000 | lr: 4.9982e-06 | scale: 2048.00 | time: 26.463 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    163/  5000| tot_loss: 2.7073 | rl_loss: 0.8722 | pt_loss: 1.8350 | pg_loss: 0.2739 | reg_loss: 0.5984 | reward: -1.1009 | rev_kl: 1.7443 | stu_lens: 47.5000 | mixed_lens: 41.5000 | lr: 4.9981e-06 | scale: 2048.00 | time: 26.435 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    164/  5000| tot_loss: 3.1996 | rl_loss: 1.6291 | pt_loss: 1.5704 | pg_loss: 0.7660 | reg_loss: 0.8631 | reward: -0.6261 | rev_kl: 1.5454 | stu_lens: 93.0000 | mixed_lens: 52.0000 | lr: 4.9980e-06 | scale: 2048.00 | time: 26.446 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    165/  5000| tot_loss: 2.4290 | rl_loss: 1.0142 | pt_loss: 1.4148 | pg_loss: 0.4751 | reg_loss: 0.5391 | reward: -0.2987 | rev_kl: 1.1137 | stu_lens: 53.0000 | mixed_lens: 62.0000 | lr: 4.9980e-06 | scale: 2048.00 | time: 26.414 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    166/  5000| tot_loss: 2.0753 | rl_loss: 0.6728 | pt_loss: 1.4025 | pg_loss: 0.0520 | reg_loss: 0.6208 | reward: -0.3707 | rev_kl: 1.6758 | stu_lens: 84.5000 | mixed_lens: 123.0000 | lr: 4.9979e-06 | scale: 2048.00 | time: 26.429 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    167/  5000| tot_loss: 3.0652 | rl_loss: 1.2296 | pt_loss: 1.8356 | pg_loss: 0.6377 | reg_loss: 0.5920 | reward: -0.5155 | rev_kl: 1.0029 | stu_lens: 66.5000 | mixed_lens: 72.5000 | lr: 4.9978e-06 | scale: 2048.00 | time: 26.423 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    168/  5000| tot_loss: 2.9028 | rl_loss: 1.2847 | pt_loss: 1.6181 | pg_loss: 0.5160 | reg_loss: 0.7687 | reward: -0.6590 | rev_kl: 0.9220 | stu_lens: 89.5000 | mixed_lens: 46.5000 | lr: 4.9978e-06 | scale: 2048.00 | time: 26.409 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    169/  5000| tot_loss: 2.4034 | rl_loss: 0.6449 | pt_loss: 1.7585 | pg_loss: 0.0296 | reg_loss: 0.6153 | reward: -0.3170 | rev_kl: 1.5814 | stu_lens: 113.5000 | mixed_lens: 112.5000 | lr: 4.9977e-06 | scale: 2048.00 | time: 26.383 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    170/  5000| tot_loss: 2.5675 | rl_loss: 0.8054 | pt_loss: 1.7621 | pg_loss: 0.2578 | reg_loss: 0.5476 | reward: -1.4325 | rev_kl: 1.5733 | stu_lens: 84.0000 | mixed_lens: 74.0000 | lr: 4.9976e-06 | scale: 2048.00 | time: 26.400 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    171/  5000| tot_loss: 2.8759 | rl_loss: 0.7164 | pt_loss: 2.1595 | pg_loss: 0.1502 | reg_loss: 0.5662 | reward: -0.7202 | rev_kl: 0.7762 | stu_lens: 122.0000 | mixed_lens: 87.5000 | lr: 4.9976e-06 | scale: 2048.00 | time: 26.377 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    172/  5000| tot_loss: 2.5440 | rl_loss: 0.8252 | pt_loss: 1.7188 | pg_loss: 0.2960 | reg_loss: 0.5292 | reward: -0.2444 | rev_kl: 1.5793 | stu_lens: 79.0000 | mixed_lens: 97.5000 | lr: 4.9975e-06 | scale: 2048.00 | time: 26.400 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    173/  5000| tot_loss: 3.2188 | rl_loss: 1.1453 | pt_loss: 2.0735 | pg_loss: 0.5734 | reg_loss: 0.5719 | reward: -0.4814 | rev_kl: 2.7672 | stu_lens: 45.5000 | mixed_lens: 46.5000 | lr: 4.9974e-06 | scale: 2048.00 | time: 26.378 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    174/  5000| tot_loss: 2.3839 | rl_loss: 0.5084 | pt_loss: 1.8755 | pg_loss: 0.1433 | reg_loss: 0.3652 | reward: -0.4838 | rev_kl: 0.7728 | stu_lens: 115.0000 | mixed_lens: 88.5000 | lr: 4.9973e-06 | scale: 2048.00 | time: 26.428 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    175/  5000| tot_loss: 2.6181 | rl_loss: 0.9305 | pt_loss: 1.6877 | pg_loss: 0.0847 | reg_loss: 0.8458 | reward: -0.1038 | rev_kl: 1.8837 | stu_lens: 103.5000 | mixed_lens: 107.0000 | lr: 4.9973e-06 | scale: 2048.00 | time: 26.401 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    176/  5000| tot_loss: 2.5722 | rl_loss: 0.8100 | pt_loss: 1.7621 | pg_loss: 0.5009 | reg_loss: 0.3091 | reward: -0.0114 | rev_kl: 2.0424 | stu_lens: 80.5000 | mixed_lens: 64.0000 | lr: 4.9972e-06 | scale: 2048.00 | time: 26.454 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    176/  5000| tot_loss: 2.8429 | rl_loss: 1.0798 | pt_loss: 1.7631 | pg_loss: 0.4816 | reg_loss: 0.5982 | reward: -0.4209 | rev_kl: 1.3408 | stu_lens: 78.0156 | mixed_lens: 76.4844 | lr: 4.9972e-06 | scale: 2048.00 | time: 26.454 | step time: 27.678
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    177/  5000| tot_loss: 2.7726 | rl_loss: 1.4248 | pt_loss: 1.3477 | pg_loss: 0.8026 | reg_loss: 0.6223 | reward: -0.4619 | rev_kl: 1.2802 | stu_lens: 90.0000 | mixed_lens: 49.0000 | lr: 4.9971e-06 | scale: 2048.00 | time: 26.439 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    178/  5000| tot_loss: 2.3305 | rl_loss: 0.7421 | pt_loss: 1.5884 | pg_loss: 0.2805 | reg_loss: 0.4616 | reward: -0.1793 | rev_kl: 1.3479 | stu_lens: 101.0000 | mixed_lens: 84.0000 | lr: 4.9970e-06 | scale: 2048.00 | time: 26.460 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    179/  5000| tot_loss: 3.6072 | rl_loss: 1.8656 | pt_loss: 1.7416 | pg_loss: 1.1328 | reg_loss: 0.7328 | reward: -0.9363 | rev_kl: 1.3362 | stu_lens: 78.0000 | mixed_lens: 40.0000 | lr: 4.9970e-06 | scale: 2048.00 | time: 26.421 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    180/  5000| tot_loss: 2.4017 | rl_loss: 0.7083 | pt_loss: 1.6934 | pg_loss: 0.2308 | reg_loss: 0.4774 | reward: -0.2508 | rev_kl: 1.1237 | stu_lens: 82.0000 | mixed_lens: 86.5000 | lr: 4.9969e-06 | scale: 2048.00 | time: 26.460 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    181/  5000| tot_loss: 3.6804 | rl_loss: 1.7408 | pt_loss: 1.9396 | pg_loss: 1.5541 | reg_loss: 0.1867 | reward: -0.1816 | rev_kl: 0.5439 | stu_lens: 28.0000 | mixed_lens: 20.5000 | lr: 4.9968e-06 | scale: 2048.00 | time: 26.455 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    182/  5000| tot_loss: 3.4038 | rl_loss: 1.4049 | pt_loss: 1.9989 | pg_loss: 0.7492 | reg_loss: 0.6557 | reward: -0.3284 | rev_kl: 1.9692 | stu_lens: 58.5000 | mixed_lens: 47.0000 | lr: 4.9967e-06 | scale: 2048.00 | time: 26.478 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    183/  5000| tot_loss: 2.4678 | rl_loss: 0.9159 | pt_loss: 1.5519 | pg_loss: 0.3111 | reg_loss: 0.6048 | reward: -1.5407 | rev_kl: 1.5298 | stu_lens: 84.0000 | mixed_lens: 74.0000 | lr: 4.9966e-06 | scale: 2048.00 | time: 26.406 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    184/  5000| tot_loss: 2.5734 | rl_loss: 0.8062 | pt_loss: 1.7672 | pg_loss: 0.1584 | reg_loss: 0.6478 | reward: -0.9987 | rev_kl: 1.6074 | stu_lens: 32.5000 | mixed_lens: 42.0000 | lr: 4.9965e-06 | scale: 2048.00 | time: 26.418 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    185/  5000| tot_loss: 2.7398 | rl_loss: 0.9684 | pt_loss: 1.7714 | pg_loss: 0.9041 | reg_loss: 0.0642 | reward: 0.0600 | rev_kl: 0.2143 | stu_lens: 19.5000 | mixed_lens: 28.5000 | lr: 4.9965e-06 | scale: 2048.00 | time: 26.403 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    186/  5000| tot_loss: 2.5557 | rl_loss: 0.6887 | pt_loss: 1.8670 | pg_loss: 0.2039 | reg_loss: 0.4848 | reward: -0.8565 | rev_kl: 1.5295 | stu_lens: 73.0000 | mixed_lens: 81.5000 | lr: 4.9964e-06 | scale: 2048.00 | time: 26.406 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    187/  5000| tot_loss: 2.4300 | rl_loss: 0.6687 | pt_loss: 1.7613 | pg_loss: 0.3097 | reg_loss: 0.3591 | reward: -0.5484 | rev_kl: 2.4410 | stu_lens: 87.0000 | mixed_lens: 67.0000 | lr: 4.9963e-06 | scale: 2048.00 | time: 26.407 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    188/  5000| tot_loss: 3.6864 | rl_loss: 1.7654 | pt_loss: 1.9210 | pg_loss: 1.2074 | reg_loss: 0.5581 | reward: -0.1599 | rev_kl: 0.8148 | stu_lens: 68.0000 | mixed_lens: 32.5000 | lr: 4.9962e-06 | scale: 2048.00 | time: 26.426 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    189/  5000| tot_loss: 1.9785 | rl_loss: 0.4353 | pt_loss: 1.5432 | pg_loss: 0.0206 | reg_loss: 0.4147 | reward: -0.2469 | rev_kl: 1.0910 | stu_lens: 82.5000 | mixed_lens: 128.0000 | lr: 4.9961e-06 | scale: 2048.00 | time: 26.398 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    190/  5000| tot_loss: 2.9660 | rl_loss: 1.1640 | pt_loss: 1.8020 | pg_loss: 0.3820 | reg_loss: 0.7820 | reward: -0.0183 | rev_kl: 1.7637 | stu_lens: 82.5000 | mixed_lens: 82.0000 | lr: 4.9960e-06 | scale: 2048.00 | time: 26.474 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    191/  5000| tot_loss: 2.1065 | rl_loss: 0.6726 | pt_loss: 1.4339 | pg_loss: 0.0772 | reg_loss: 0.5954 | reward: -0.1230 | rev_kl: 1.5336 | stu_lens: 103.5000 | mixed_lens: 107.0000 | lr: 4.9959e-06 | scale: 2048.00 | time: 26.368 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    192/  5000| tot_loss: 3.2502 | rl_loss: 1.5268 | pt_loss: 1.7234 | pg_loss: 0.8322 | reg_loss: 0.6947 | reward: -0.7621 | rev_kl: 1.0024 | stu_lens: 65.5000 | mixed_lens: 40.0000 | lr: 4.9958e-06 | scale: 2048.00 | time: 26.404 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    192/  5000| tot_loss: 2.7139 | rl_loss: 0.9622 | pt_loss: 1.7518 | pg_loss: 0.4761 | reg_loss: 0.4861 | reward: -0.4660 | rev_kl: 1.3012 | stu_lens: 79.6562 | mixed_lens: 70.4844 | lr: 4.9958e-06 | scale: 2048.00 | time: 26.404 | step time: 27.687
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    193/  5000| tot_loss: 2.1162 | rl_loss: 0.4926 | pt_loss: 1.6236 | pg_loss: 0.0560 | reg_loss: 0.4366 | reward: -0.3191 | rev_kl: 1.4588 | stu_lens: 102.5000 | mixed_lens: 122.5000 | lr: 4.9957e-06 | scale: 2048.00 | time: 26.392 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    194/  5000| tot_loss: 2.7777 | rl_loss: 1.3651 | pt_loss: 1.4126 | pg_loss: 0.1078 | reg_loss: 1.2573 | reward: -0.2140 | rev_kl: 1.7802 | stu_lens: 123.5000 | mixed_lens: 119.0000 | lr: 4.9957e-06 | scale: 2048.00 | time: 26.486 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    195/  5000| tot_loss: 3.5489 | rl_loss: 1.6250 | pt_loss: 1.9239 | pg_loss: 0.4100 | reg_loss: 1.2150 | reward: -0.4327 | rev_kl: 1.1245 | stu_lens: 46.5000 | mixed_lens: 79.5000 | lr: 4.9956e-06 | scale: 2048.00 | time: 26.452 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    196/  5000| tot_loss: 3.1849 | rl_loss: 1.6915 | pt_loss: 1.4934 | pg_loss: 0.2932 | reg_loss: 1.3983 | reward: -0.7058 | rev_kl: 1.6175 | stu_lens: 111.0000 | mixed_lens: 87.0000 | lr: 4.9955e-06 | scale: 2048.00 | time: 26.454 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    197/  5000| tot_loss: 3.7034 | rl_loss: 2.1243 | pt_loss: 1.5791 | pg_loss: 0.6058 | reg_loss: 1.5185 | reward: -2.0277 | rev_kl: 1.2985 | stu_lens: 68.0000 | mixed_lens: 68.0000 | lr: 4.9954e-06 | scale: 2048.00 | time: 26.453 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    198/  5000| tot_loss: 3.2794 | rl_loss: 1.6640 | pt_loss: 1.6154 | pg_loss: 0.1295 | reg_loss: 1.5345 | reward: -0.4686 | rev_kl: 1.1906 | stu_lens: 79.0000 | mixed_lens: 119.0000 | lr: 4.9953e-06 | scale: 2048.00 | time: 26.516 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    199/  5000| tot_loss: 3.9827 | rl_loss: 2.3465 | pt_loss: 1.6362 | pg_loss: 1.2834 | reg_loss: 1.0631 | reward: 0.6973 | rev_kl: 1.2200 | stu_lens: 54.5000 | mixed_lens: 31.5000 | lr: 4.9952e-06 | scale: 2048.00 | time: 26.441 | step time: 0.000
                                 Evaluation #2                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Bob should leave Alice. His chances  │
│                                       │ of survival are 31% if he stays with │
│                                       │ Alice, but only 9% if he leaves her. │
│                                       │ Therefore, it is best for Bob to     │
│                                       │ leave Alice.                         │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ The kezboard type z is a type of     │
│                                       │ keyboard that uses a typing method   │
│                                       │ called "gradual typing". This method │
│                                       │ is different from the "striking      │
│                                       │ method" that most keyboards use. The │
│                                       │ key "z" is struck with the middle    │
│                                       │ finger, and the key "y" is struck    │
│                                       │ with the index finger. This method   │
│                                       │ is more comfortable than the         │
│                                       │ striking method, since it does not   │
│                                       │ require the wrist to be bent.        │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support 8 languages: English,     │
│                                       │ Spanish, French, German, Italian,    │
│                                       │ Portuguese, Chinese, and Japanese.   │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.286 | exact_match: 0.215 | rev_kl: 1.229 | lens: 87.803 | pt_loss: 1.102 | lm_loss: 1.202 | kd_loss: 1.002 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    200/  5000| tot_loss: 3.3242 | rl_loss: 1.2763 | pt_loss: 2.0479 | pg_loss: 0.2046 | reg_loss: 1.0717 | reward: -0.0753 | rev_kl: 0.5403 | stu_lens: 81.0000 | mixed_lens: 98.0000 | lr: 4.9951e-06 | scale: 2048.00 | time: 26.439 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    201/  5000| tot_loss: 3.0882 | rl_loss: 1.5194 | pt_loss: 1.5687 | pg_loss: 0.0704 | reg_loss: 1.4491 | reward: -0.3753 | rev_kl: 1.2198 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9950e-06 | scale: 2048.00 | time: 26.448 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    202/  5000| tot_loss: 3.0243 | rl_loss: 1.4881 | pt_loss: 1.5362 | pg_loss: 0.3932 | reg_loss: 1.0949 | reward: -0.8753 | rev_kl: 0.7808 | stu_lens: 67.0000 | mixed_lens: 67.0000 | lr: 4.9949e-06 | scale: 2048.00 | time: 26.385 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    203/  5000| tot_loss: 3.5626 | rl_loss: 1.7796 | pt_loss: 1.7830 | pg_loss: 0.9055 | reg_loss: 0.8741 | reward: -1.1032 | rev_kl: 1.0120 | stu_lens: 30.5000 | mixed_lens: 27.5000 | lr: 4.9948e-06 | scale: 2048.00 | time: 26.426 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    204/  5000| tot_loss: 2.6901 | rl_loss: 1.1533 | pt_loss: 1.5368 | pg_loss: 0.2789 | reg_loss: 0.8743 | reward: -0.2099 | rev_kl: 1.1504 | stu_lens: 83.0000 | mixed_lens: 100.0000 | lr: 4.9947e-06 | scale: 2048.00 | time: 26.427 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    205/  5000| tot_loss: 3.1541 | rl_loss: 1.8673 | pt_loss: 1.2868 | pg_loss: 0.4632 | reg_loss: 1.4041 | reward: -0.2694 | rev_kl: 1.2885 | stu_lens: 111.0000 | mixed_lens: 92.5000 | lr: 4.9946e-06 | scale: 2048.00 | time: 26.409 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    206/  5000| tot_loss: 3.7713 | rl_loss: 1.9925 | pt_loss: 1.7788 | pg_loss: 0.3471 | reg_loss: 1.6453 | reward: -0.4810 | rev_kl: 0.7854 | stu_lens: 72.0000 | mixed_lens: 81.5000 | lr: 4.9944e-06 | scale: 2048.00 | time: 26.432 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    207/  5000| tot_loss: 3.3847 | rl_loss: 1.6758 | pt_loss: 1.7089 | pg_loss: 0.2908 | reg_loss: 1.3850 | reward: -0.5018 | rev_kl: 1.0758 | stu_lens: 95.0000 | mixed_lens: 100.5000 | lr: 4.9943e-06 | scale: 2048.00 | time: 26.409 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    208/  5000| tot_loss: 3.5785 | rl_loss: 1.9274 | pt_loss: 1.6511 | pg_loss: 0.4089 | reg_loss: 1.5185 | reward: -0.2959 | rev_kl: 1.4611 | stu_lens: 91.0000 | mixed_lens: 84.0000 | lr: 4.9942e-06 | scale: 2048.00 | time: 26.410 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    208/  5000| tot_loss: 3.3430 | rl_loss: 1.6625 | pt_loss: 1.6806 | pg_loss: 0.3789 | reg_loss: 1.2836 | reward: -0.5208 | rev_kl: 1.3245 | stu_lens: 87.3438 | mixed_lens: 89.2344 | lr: 4.9942e-06 | scale: 2048.00 | time: 26.410 | step time: 27.709
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    209/  5000| tot_loss: 3.3198 | rl_loss: 1.3031 | pt_loss: 2.0167 | pg_loss: 0.0302 | reg_loss: 1.2730 | reward: -0.2805 | rev_kl: 1.0590 | stu_lens: 102.0000 | mixed_lens: 128.0000 | lr: 4.9941e-06 | scale: 2048.00 | time: 26.421 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    210/  5000| tot_loss: 3.1500 | rl_loss: 1.0641 | pt_loss: 2.0859 | pg_loss: 0.1328 | reg_loss: 0.9313 | reward: -0.2993 | rev_kl: 1.2316 | stu_lens: 128.0000 | mixed_lens: 105.5000 | lr: 4.9940e-06 | scale: 2048.00 | time: 26.420 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    211/  5000| tot_loss: 3.1577 | rl_loss: 1.5238 | pt_loss: 1.6339 | pg_loss: 0.3219 | reg_loss: 1.2019 | reward: -0.9983 | rev_kl: 0.8366 | stu_lens: 71.5000 | mixed_lens: 73.5000 | lr: 4.9939e-06 | scale: 2048.00 | time: 26.426 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    212/  5000| tot_loss: 3.6119 | rl_loss: 1.4212 | pt_loss: 2.1907 | pg_loss: 0.4585 | reg_loss: 0.9626 | reward: -0.5627 | rev_kl: 1.4600 | stu_lens: 111.0000 | mixed_lens: 83.0000 | lr: 4.9938e-06 | scale: 2048.00 | time: 26.387 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    213/  5000| tot_loss: 2.5957 | rl_loss: 0.9899 | pt_loss: 1.6059 | pg_loss: 0.1256 | reg_loss: 0.8643 | reward: -0.1959 | rev_kl: 1.4680 | stu_lens: 128.0000 | mixed_lens: 109.5000 | lr: 4.9937e-06 | scale: 2048.00 | time: 26.378 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    214/  5000| tot_loss: 2.5962 | rl_loss: 0.7506 | pt_loss: 1.8457 | pg_loss: 0.2088 | reg_loss: 0.5418 | reward: -0.2912 | rev_kl: 1.0035 | stu_lens: 91.5000 | mixed_lens: 93.0000 | lr: 4.9936e-06 | scale: 2048.00 | time: 26.365 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    215/  5000| tot_loss: 2.9271 | rl_loss: 1.1657 | pt_loss: 1.7614 | pg_loss: 0.3755 | reg_loss: 0.7901 | reward: -2.0231 | rev_kl: 1.4936 | stu_lens: 50.5000 | mixed_lens: 68.0000 | lr: 4.9934e-06 | scale: 2048.00 | time: 26.383 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    216/  5000| tot_loss: 3.4872 | rl_loss: 1.4108 | pt_loss: 2.0764 | pg_loss: 0.2919 | reg_loss: 1.1189 | reward: -0.1967 | rev_kl: 0.7880 | stu_lens: 57.0000 | mixed_lens: 88.0000 | lr: 4.9933e-06 | scale: 2048.00 | time: 26.343 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    217/  5000| tot_loss: 2.5476 | rl_loss: 0.9800 | pt_loss: 1.5676 | pg_loss: 0.0501 | reg_loss: 0.9299 | reward: -0.2215 | rev_kl: 1.0570 | stu_lens: 123.5000 | mixed_lens: 128.0000 | lr: 4.9932e-06 | scale: 2048.00 | time: 26.391 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    218/  5000| tot_loss: 2.7559 | rl_loss: 0.9607 | pt_loss: 1.7952 | pg_loss: 0.2420 | reg_loss: 0.7187 | reward: -0.5070 | rev_kl: 1.1412 | stu_lens: 69.0000 | mixed_lens: 100.5000 | lr: 4.9931e-06 | scale: 2048.00 | time: 26.365 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    219/  5000| tot_loss: 3.1979 | rl_loss: 1.8287 | pt_loss: 1.3692 | pg_loss: 0.9433 | reg_loss: 0.8854 | reward: -0.9955 | rev_kl: 0.9232 | stu_lens: 26.0000 | mixed_lens: 21.0000 | lr: 4.9930e-06 | scale: 2048.00 | time: 26.435 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    220/  5000| tot_loss: 3.0433 | rl_loss: 1.2832 | pt_loss: 1.7602 | pg_loss: 0.4128 | reg_loss: 0.8703 | reward: -1.0566 | rev_kl: 1.4998 | stu_lens: 105.5000 | mixed_lens: 84.5000 | lr: 4.9928e-06 | scale: 2048.00 | time: 26.384 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    221/  5000| tot_loss: 3.3319 | rl_loss: 1.5279 | pt_loss: 1.8040 | pg_loss: 0.6703 | reg_loss: 0.8576 | reward: 0.4780 | rev_kl: 1.6725 | stu_lens: 69.0000 | mixed_lens: 33.0000 | lr: 4.9927e-06 | scale: 2048.00 | time: 26.473 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    222/  5000| tot_loss: 3.7278 | rl_loss: 1.8521 | pt_loss: 1.8757 | pg_loss: 0.8280 | reg_loss: 1.0241 | reward: -0.9181 | rev_kl: 0.7194 | stu_lens: 50.0000 | mixed_lens: 51.0000 | lr: 4.9926e-06 | scale: 2048.00 | time: 26.429 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    223/  5000| tot_loss: 2.3750 | rl_loss: 0.9729 | pt_loss: 1.4021 | pg_loss: 0.2162 | reg_loss: 0.7567 | reward: -0.3435 | rev_kl: 1.0122 | stu_lens: 96.0000 | mixed_lens: 110.5000 | lr: 4.9925e-06 | scale: 2048.00 | time: 26.499 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    224/  5000| tot_loss: 2.0208 | rl_loss: 0.4299 | pt_loss: 1.5910 | pg_loss: 0.0789 | reg_loss: 0.3510 | reward: -0.3324 | rev_kl: 0.8497 | stu_lens: 104.0000 | mixed_lens: 119.0000 | lr: 4.9924e-06 | scale: 2048.00 | time: 26.461 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    224/  5000| tot_loss: 2.8814 | rl_loss: 1.1082 | pt_loss: 1.7731 | pg_loss: 0.2780 | reg_loss: 0.8303 | reward: -0.5071 | rev_kl: 1.2502 | stu_lens: 89.2500 | mixed_lens: 92.4375 | lr: 4.9924e-06 | scale: 2048.00 | time: 26.461 | step time: 27.673
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    225/  5000| tot_loss: 2.5809 | rl_loss: 1.1755 | pt_loss: 1.4054 | pg_loss: 0.2133 | reg_loss: 0.9622 | reward: -0.5950 | rev_kl: 1.4326 | stu_lens: 86.5000 | mixed_lens: 86.5000 | lr: 4.9922e-06 | scale: 2048.00 | time: 26.457 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    226/  5000| tot_loss: 2.2262 | rl_loss: 0.7150 | pt_loss: 1.5112 | pg_loss: 0.0678 | reg_loss: 0.6471 | reward: -0.1663 | rev_kl: 1.2586 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9921e-06 | scale: 2048.00 | time: 26.429 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    227/  5000| tot_loss: 2.6005 | rl_loss: 0.7141 | pt_loss: 1.8864 | pg_loss: 0.2382 | reg_loss: 0.4759 | reward: -0.4964 | rev_kl: 1.2322 | stu_lens: 89.5000 | mixed_lens: 95.0000 | lr: 4.9920e-06 | scale: 2048.00 | time: 26.444 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    228/  5000| tot_loss: 1.8078 | rl_loss: 0.5498 | pt_loss: 1.2580 | pg_loss: 0.0067 | reg_loss: 0.5431 | reward: -0.3637 | rev_kl: 1.5010 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9918e-06 | scale: 2048.00 | time: 26.424 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    229/  5000| tot_loss: 3.1098 | rl_loss: 1.1772 | pt_loss: 1.9326 | pg_loss: 0.6603 | reg_loss: 0.5169 | reward: -1.0472 | rev_kl: 0.8113 | stu_lens: 26.0000 | mixed_lens: 61.5000 | lr: 4.9917e-06 | scale: 2048.00 | time: 26.440 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    230/  5000| tot_loss: 2.4197 | rl_loss: 0.5105 | pt_loss: 1.9092 | pg_loss: 0.0590 | reg_loss: 0.4515 | reward: -0.3251 | rev_kl: 1.5800 | stu_lens: 124.5000 | mixed_lens: 114.5000 | lr: 4.9916e-06 | scale: 2048.00 | time: 26.407 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    231/  5000| tot_loss: 3.1401 | rl_loss: 0.9023 | pt_loss: 2.2378 | pg_loss: 0.0519 | reg_loss: 0.8504 | reward: -0.3045 | rev_kl: 1.1994 | stu_lens: 97.0000 | mixed_lens: 128.0000 | lr: 4.9915e-06 | scale: 2048.00 | time: 26.395 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    232/  5000| tot_loss: 2.4436 | rl_loss: 0.9911 | pt_loss: 1.4526 | pg_loss: 0.5583 | reg_loss: 0.4327 | reward: -0.8975 | rev_kl: 1.3202 | stu_lens: 55.0000 | mixed_lens: 40.5000 | lr: 4.9913e-06 | scale: 2048.00 | time: 26.405 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    233/  5000| tot_loss: 3.2816 | rl_loss: 1.4849 | pt_loss: 1.7967 | pg_loss: 0.6174 | reg_loss: 0.8675 | reward: 0.6063 | rev_kl: 1.6001 | stu_lens: 107.5000 | mixed_lens: 66.0000 | lr: 4.9912e-06 | scale: 2048.00 | time: 26.414 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    234/  5000| tot_loss: 2.5604 | rl_loss: 0.7434 | pt_loss: 1.8170 | pg_loss: 0.1110 | reg_loss: 0.6324 | reward: -0.3734 | rev_kl: 1.3561 | stu_lens: 128.0000 | mixed_lens: 105.5000 | lr: 4.9911e-06 | scale: 2048.00 | time: 26.394 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    235/  5000| tot_loss: 2.8669 | rl_loss: 1.2292 | pt_loss: 1.6378 | pg_loss: 0.4251 | reg_loss: 0.8041 | reward: -0.4887 | rev_kl: 1.3252 | stu_lens: 51.0000 | mixed_lens: 45.5000 | lr: 4.9909e-06 | scale: 2048.00 | time: 26.414 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    236/  5000| tot_loss: 2.8726 | rl_loss: 1.0335 | pt_loss: 1.8391 | pg_loss: 0.4708 | reg_loss: 0.5627 | reward: -0.7380 | rev_kl: 0.7253 | stu_lens: 20.0000 | mixed_lens: 67.0000 | lr: 4.9908e-06 | scale: 2048.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    237/  5000| tot_loss: 3.3766 | rl_loss: 1.5550 | pt_loss: 1.8216 | pg_loss: 0.8320 | reg_loss: 0.7230 | reward: -1.9473 | rev_kl: 3.2332 | stu_lens: 41.0000 | mixed_lens: 51.5000 | lr: 4.9906e-06 | scale: 2048.00 | time: 26.422 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    238/  5000| tot_loss: 2.2629 | rl_loss: 0.6666 | pt_loss: 1.5962 | pg_loss: 0.2229 | reg_loss: 0.4437 | reward: -0.2000 | rev_kl: 1.2673 | stu_lens: 74.0000 | mixed_lens: 93.0000 | lr: 4.9905e-06 | scale: 2048.00 | time: 26.410 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    239/  5000| tot_loss: 2.7286 | rl_loss: 0.9110 | pt_loss: 1.8176 | pg_loss: 0.3168 | reg_loss: 0.5942 | reward: -1.8863 | rev_kl: 1.4285 | stu_lens: 65.0000 | mixed_lens: 68.0000 | lr: 4.9904e-06 | scale: 2048.00 | time: 26.442 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    240/  5000| tot_loss: 2.9066 | rl_loss: 1.1622 | pt_loss: 1.7444 | pg_loss: 0.2892 | reg_loss: 0.8729 | reward: -0.6534 | rev_kl: 1.4567 | stu_lens: 43.5000 | mixed_lens: 86.5000 | lr: 4.9902e-06 | scale: 2048.00 | time: 26.464 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    240/  5000| tot_loss: 2.5532 | rl_loss: 0.8883 | pt_loss: 1.6649 | pg_loss: 0.2818 | reg_loss: 0.6065 | reward: -0.5314 | rev_kl: 1.2912 | stu_lens: 89.7656 | mixed_lens: 90.2344 | lr: 4.9902e-06 | scale: 2048.00 | time: 26.464 | step time: 27.685
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    241/  5000| tot_loss: 2.5504 | rl_loss: 0.7125 | pt_loss: 1.8379 | pg_loss: 0.1608 | reg_loss: 0.5517 | reward: -0.2294 | rev_kl: 1.2955 | stu_lens: 65.0000 | mixed_lens: 106.5000 | lr: 4.9901e-06 | scale: 2048.00 | time: 26.464 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    242/  5000| tot_loss: 3.1761 | rl_loss: 1.1980 | pt_loss: 1.9781 | pg_loss: 0.7656 | reg_loss: 0.4324 | reward: -0.1670 | rev_kl: 0.7272 | stu_lens: 72.5000 | mixed_lens: 52.5000 | lr: 4.9899e-06 | scale: 2048.00 | time: 26.454 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    243/  5000| tot_loss: 2.2934 | rl_loss: 0.7775 | pt_loss: 1.5159 | pg_loss: 0.2404 | reg_loss: 0.5370 | reward: -0.4352 | rev_kl: 1.3060 | stu_lens: 92.0000 | mixed_lens: 91.5000 | lr: 4.9898e-06 | scale: 2048.00 | time: 26.479 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    244/  5000| tot_loss: 1.8515 | rl_loss: 0.7839 | pt_loss: 1.0676 | pg_loss: 0.2957 | reg_loss: 0.4882 | reward: -0.3509 | rev_kl: 1.7823 | stu_lens: 123.5000 | mixed_lens: 91.0000 | lr: 4.9896e-06 | scale: 2048.00 | time: 26.460 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    245/  5000| tot_loss: 2.5123 | rl_loss: 0.4753 | pt_loss: 2.0371 | pg_loss: 0.1121 | reg_loss: 0.3632 | reward: -0.4596 | rev_kl: 0.9926 | stu_lens: 72.0000 | mixed_lens: 81.5000 | lr: 4.9895e-06 | scale: 2048.00 | time: 26.455 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    246/  5000| tot_loss: 2.2750 | rl_loss: 0.8075 | pt_loss: 1.4675 | pg_loss: 0.3556 | reg_loss: 0.4519 | reward: -0.4674 | rev_kl: 1.2572 | stu_lens: 87.0000 | mixed_lens: 82.0000 | lr: 4.9894e-06 | scale: 2048.00 | time: 26.411 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    247/  5000| tot_loss: 2.3051 | rl_loss: 0.5067 | pt_loss: 1.7985 | pg_loss: 0.1205 | reg_loss: 0.3862 | reward: -1.9961 | rev_kl: 0.9526 | stu_lens: 78.0000 | mixed_lens: 65.5000 | lr: 4.9892e-06 | scale: 2048.00 | time: 26.432 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    248/  5000| tot_loss: 2.0108 | rl_loss: 0.6676 | pt_loss: 1.3432 | pg_loss: 0.4056 | reg_loss: 0.2620 | reward: 0.4859 | rev_kl: 1.4253 | stu_lens: 89.5000 | mixed_lens: 57.0000 | lr: 4.9891e-06 | scale: 2048.00 | time: 26.410 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    249/  5000| tot_loss: 3.3303 | rl_loss: 1.2606 | pt_loss: 2.0696 | pg_loss: 0.6388 | reg_loss: 0.6218 | reward: -0.9588 | rev_kl: 1.4987 | stu_lens: 105.5000 | mixed_lens: 65.0000 | lr: 4.9889e-06 | scale: 2048.00 | time: 26.415 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/250
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    250/  5000| tot_loss: 2.3633 | rl_loss: 0.8992 | pt_loss: 1.4641 | pg_loss: 0.3196 | reg_loss: 0.5796 | reward: -0.6534 | rev_kl: 1.4567 | stu_lens: 43.5000 | mixed_lens: 86.5000 | lr: 4.9888e-06 | scale: 2048.00 | time: 26.364 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    251/  5000| tot_loss: 2.3034 | rl_loss: 0.5622 | pt_loss: 1.7412 | pg_loss: 0.1423 | reg_loss: 0.4198 | reward: -0.3856 | rev_kl: 1.1225 | stu_lens: 85.0000 | mixed_lens: 111.0000 | lr: 4.9886e-06 | scale: 2048.00 | time: 26.420 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    252/  5000| tot_loss: 2.2684 | rl_loss: 0.5226 | pt_loss: 1.7458 | pg_loss: 0.0179 | reg_loss: 0.5047 | reward: -0.3498 | rev_kl: 1.2137 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9884e-06 | scale: 2048.00 | time: 26.436 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    253/  5000| tot_loss: 2.0619 | rl_loss: 0.2620 | pt_loss: 1.7999 | pg_loss: -0.0048 | reg_loss: 0.2668 | reward: -0.2009 | rev_kl: 0.8157 | stu_lens: 122.0000 | mixed_lens: 128.0000 | lr: 4.9883e-06 | scale: 2048.00 | time: 26.447 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    254/  5000| tot_loss: 2.5893 | rl_loss: 0.9132 | pt_loss: 1.6762 | pg_loss: 0.2665 | reg_loss: 0.6466 | reward: -0.4764 | rev_kl: 1.4379 | stu_lens: 58.5000 | mixed_lens: 95.0000 | lr: 4.9881e-06 | scale: 2048.00 | time: 26.452 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    255/  5000| tot_loss: 1.6651 | rl_loss: 0.6439 | pt_loss: 1.0213 | pg_loss: 0.2329 | reg_loss: 0.4110 | reward: -0.4567 | rev_kl: 1.1183 | stu_lens: 78.0000 | mixed_lens: 94.5000 | lr: 4.9880e-06 | scale: 2048.00 | time: 26.448 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    256/  5000| tot_loss: 2.8230 | rl_loss: 0.8398 | pt_loss: 1.9832 | pg_loss: 0.4832 | reg_loss: 0.3566 | reward: 0.7342 | rev_kl: 1.1437 | stu_lens: 70.0000 | mixed_lens: 67.0000 | lr: 4.9878e-06 | scale: 2048.00 | time: 26.434 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    256/  5000| tot_loss: 2.4102 | rl_loss: 0.7427 | pt_loss: 1.6675 | pg_loss: 0.2873 | reg_loss: 0.4554 | reward: -0.5014 | rev_kl: 1.2624 | stu_lens: 90.0156 | mixed_lens: 90.7031 | lr: 4.9878e-06 | scale: 2048.00 | time: 26.434 | step time: 27.699
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    257/  5000| tot_loss: 2.4458 | rl_loss: 0.8835 | pt_loss: 1.5623 | pg_loss: 0.3357 | reg_loss: 0.5478 | reward: -0.5901 | rev_kl: 0.7601 | stu_lens: 35.5000 | mixed_lens: 84.5000 | lr: 4.9877e-06 | scale: 2048.00 | time: 26.472 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    258/  5000| tot_loss: 2.8931 | rl_loss: 1.4798 | pt_loss: 1.4133 | pg_loss: 0.2096 | reg_loss: 1.2701 | reward: -0.1761 | rev_kl: 0.9272 | stu_lens: 118.0000 | mixed_lens: 96.5000 | lr: 4.9875e-06 | scale: 2048.00 | time: 26.423 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    259/  5000| tot_loss: 2.2413 | rl_loss: 0.6988 | pt_loss: 1.5425 | pg_loss: 0.0298 | reg_loss: 0.6690 | reward: -0.1214 | rev_kl: 0.9177 | stu_lens: 91.5000 | mixed_lens: 79.5000 | lr: 4.9873e-06 | scale: 2048.00 | time: 26.545 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    260/  5000| tot_loss: 2.0677 | rl_loss: 0.8845 | pt_loss: 1.1832 | pg_loss: 0.0544 | reg_loss: 0.8301 | reward: -0.1289 | rev_kl: 0.6507 | stu_lens: 81.5000 | mixed_lens: 127.0000 | lr: 4.9872e-06 | scale: 2048.00 | time: 26.380 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    261/  5000| tot_loss: 3.0379 | rl_loss: 1.2860 | pt_loss: 1.7519 | pg_loss: 0.0954 | reg_loss: 1.1906 | reward: -0.2940 | rev_kl: 1.5202 | stu_lens: 97.5000 | mixed_lens: 124.0000 | lr: 4.9870e-06 | scale: 2048.00 | time: 26.470 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    262/  5000| tot_loss: 3.3803 | rl_loss: 1.6629 | pt_loss: 1.7174 | pg_loss: 0.5121 | reg_loss: 1.1508 | reward: 1.0061 | rev_kl: 0.9993 | stu_lens: 62.5000 | mixed_lens: 38.5000 | lr: 4.9869e-06 | scale: 2048.00 | time: 26.364 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    263/  5000| tot_loss: 3.2133 | rl_loss: 1.5768 | pt_loss: 1.6365 | pg_loss: 0.3335 | reg_loss: 1.2434 | reward: -0.8147 | rev_kl: 1.2848 | stu_lens: 100.5000 | mixed_lens: 82.5000 | lr: 4.9867e-06 | scale: 2048.00 | time: 26.391 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    264/  5000| tot_loss: 3.6133 | rl_loss: 1.7869 | pt_loss: 1.8264 | pg_loss: 0.4169 | reg_loss: 1.3700 | reward: -0.8442 | rev_kl: 0.8396 | stu_lens: 82.0000 | mixed_lens: 86.0000 | lr: 4.9865e-06 | scale: 2048.00 | time: 26.458 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    265/  5000| tot_loss: 2.8734 | rl_loss: 1.4708 | pt_loss: 1.4026 | pg_loss: 0.7576 | reg_loss: 0.7132 | reward: -0.5710 | rev_kl: 0.9286 | stu_lens: 117.5000 | mixed_lens: 35.5000 | lr: 4.9864e-06 | scale: 2048.00 | time: 26.431 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    266/  5000| tot_loss: 3.6164 | rl_loss: 1.7022 | pt_loss: 1.9143 | pg_loss: 0.4277 | reg_loss: 1.2745 | reward: -0.3809 | rev_kl: 1.3420 | stu_lens: 73.5000 | mixed_lens: 95.5000 | lr: 4.9862e-06 | scale: 2048.00 | time: 26.476 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    267/  5000| tot_loss: 3.4090 | rl_loss: 1.3313 | pt_loss: 2.0776 | pg_loss: 0.3541 | reg_loss: 0.9772 | reward: -0.0109 | rev_kl: 1.0070 | stu_lens: 65.0000 | mixed_lens: 70.5000 | lr: 4.9860e-06 | scale: 2048.00 | time: 26.402 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    268/  5000| tot_loss: 2.9889 | rl_loss: 1.5755 | pt_loss: 1.4134 | pg_loss: 0.5012 | reg_loss: 1.0743 | reward: -0.2040 | rev_kl: 0.6212 | stu_lens: 94.5000 | mixed_lens: 79.5000 | lr: 4.9859e-06 | scale: 2048.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    269/  5000| tot_loss: 2.9154 | rl_loss: 1.0863 | pt_loss: 1.8290 | pg_loss: 0.3922 | reg_loss: 0.6942 | reward: -0.3916 | rev_kl: 1.1938 | stu_lens: 46.5000 | mixed_lens: 93.0000 | lr: 4.9857e-06 | scale: 2048.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    270/  5000| tot_loss: 4.1223 | rl_loss: 2.5873 | pt_loss: 1.5349 | pg_loss: 1.3071 | reg_loss: 1.2802 | reward: -1.3920 | rev_kl: 1.2088 | stu_lens: 21.5000 | mixed_lens: 30.0000 | lr: 4.9855e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    271/  5000| tot_loss: 3.6617 | rl_loss: 1.9079 | pt_loss: 1.7538 | pg_loss: 0.6515 | reg_loss: 1.2564 | reward: -0.7128 | rev_kl: 1.2567 | stu_lens: 64.5000 | mixed_lens: 51.5000 | lr: 4.9853e-06 | scale: 2048.00 | time: 26.322 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    272/  5000| tot_loss: 2.8959 | rl_loss: 1.2906 | pt_loss: 1.6053 | pg_loss: 0.2142 | reg_loss: 1.0764 | reward: -0.4028 | rev_kl: 1.2819 | stu_lens: 128.0000 | mixed_lens: 85.5000 | lr: 4.9852e-06 | scale: 2048.00 | time: 26.261 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    272/  5000| tot_loss: 3.1585 | rl_loss: 1.4740 | pt_loss: 1.6845 | pg_loss: 0.3449 | reg_loss: 1.1291 | reward: -0.3559 | rev_kl: 1.1286 | stu_lens: 89.9688 | mixed_lens: 89.8750 | lr: 4.9852e-06 | scale: 2048.00 | time: 26.261 | step time: 27.658
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    273/  5000| tot_loss: 2.2423 | rl_loss: 0.8873 | pt_loss: 1.3550 | pg_loss: 0.0419 | reg_loss: 0.8454 | reward: -0.2919 | rev_kl: 0.3310 | stu_lens: 94.0000 | mixed_lens: 127.0000 | lr: 4.9850e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    274/  5000| tot_loss: 2.5187 | rl_loss: 0.9306 | pt_loss: 1.5881 | pg_loss: 0.1248 | reg_loss: 0.8058 | reward: -0.3066 | rev_kl: 1.0856 | stu_lens: 94.0000 | mixed_lens: 107.0000 | lr: 4.9848e-06 | scale: 2048.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    275/  5000| tot_loss: 2.9660 | rl_loss: 1.5554 | pt_loss: 1.4106 | pg_loss: 0.4114 | reg_loss: 1.1441 | reward: -0.6491 | rev_kl: 0.9220 | stu_lens: 90.0000 | mixed_lens: 85.0000 | lr: 4.9846e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    276/  5000| tot_loss: 2.7058 | rl_loss: 0.7464 | pt_loss: 1.9594 | pg_loss: -0.0038 | reg_loss: 0.7502 | reward: -0.2019 | rev_kl: 1.0446 | stu_lens: 100.0000 | mixed_lens: 128.0000 | lr: 4.9845e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    277/  5000| tot_loss: 2.8334 | rl_loss: 0.7152 | pt_loss: 2.1181 | pg_loss: 0.0436 | reg_loss: 0.6716 | reward: -0.2528 | rev_kl: 0.7892 | stu_lens: 77.0000 | mixed_lens: 121.0000 | lr: 4.9843e-06 | scale: 2048.00 | time: 26.345 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    278/  5000| tot_loss: 2.9340 | rl_loss: 0.9102 | pt_loss: 2.0238 | pg_loss: 0.1275 | reg_loss: 0.7827 | reward: -0.2168 | rev_kl: 0.9942 | stu_lens: 55.5000 | mixed_lens: 106.0000 | lr: 4.9841e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    279/  5000| tot_loss: 2.0215 | rl_loss: 0.5791 | pt_loss: 1.4424 | pg_loss: -0.0029 | reg_loss: 0.5821 | reward: -0.2432 | rev_kl: 0.8578 | stu_lens: 94.5000 | mixed_lens: 128.0000 | lr: 4.9839e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    280/  5000| tot_loss: 2.8368 | rl_loss: 0.8769 | pt_loss: 1.9599 | pg_loss: 0.1188 | reg_loss: 0.7581 | reward: -0.2618 | rev_kl: 0.8935 | stu_lens: 128.0000 | mixed_lens: 100.5000 | lr: 4.9837e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    281/  5000| tot_loss: 2.8444 | rl_loss: 0.9846 | pt_loss: 1.8597 | pg_loss: 0.4621 | reg_loss: 0.5225 | reward: -0.6008 | rev_kl: 1.1541 | stu_lens: 59.0000 | mixed_lens: 62.5000 | lr: 4.9836e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    282/  5000| tot_loss: 2.4510 | rl_loss: 0.6633 | pt_loss: 1.7877 | pg_loss: 0.0054 | reg_loss: 0.6579 | reward: -0.1530 | rev_kl: 0.8909 | stu_lens: 94.5000 | mixed_lens: 128.0000 | lr: 4.9834e-06 | scale: 2048.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    283/  5000| tot_loss: 2.5304 | rl_loss: 1.1557 | pt_loss: 1.3746 | pg_loss: 0.2815 | reg_loss: 0.8742 | reward: -0.4578 | rev_kl: 0.9543 | stu_lens: 81.5000 | mixed_lens: 84.5000 | lr: 4.9832e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    284/  5000| tot_loss: 3.1825 | rl_loss: 1.2405 | pt_loss: 1.9420 | pg_loss: 0.2855 | reg_loss: 0.9550 | reward: -1.3396 | rev_kl: 1.6718 | stu_lens: 74.0000 | mixed_lens: 77.0000 | lr: 4.9830e-06 | scale: 2048.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    285/  5000| tot_loss: 2.6657 | rl_loss: 0.9504 | pt_loss: 1.7152 | pg_loss: 0.6641 | reg_loss: 0.2863 | reward: -0.3111 | rev_kl: 1.4583 | stu_lens: 69.5000 | mixed_lens: 28.5000 | lr: 4.9828e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    286/  5000| tot_loss: 2.6162 | rl_loss: 0.8906 | pt_loss: 1.7256 | pg_loss: 0.1569 | reg_loss: 0.7337 | reward: -0.0806 | rev_kl: 0.9520 | stu_lens: 105.0000 | mixed_lens: 109.5000 | lr: 4.9826e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    287/  5000| tot_loss: 2.4027 | rl_loss: 0.9367 | pt_loss: 1.4660 | pg_loss: 0.0682 | reg_loss: 0.8685 | reward: -0.3041 | rev_kl: 1.1399 | stu_lens: 83.5000 | mixed_lens: 118.0000 | lr: 4.9824e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    288/  5000| tot_loss: 3.5304 | rl_loss: 1.5509 | pt_loss: 1.9795 | pg_loss: 0.7866 | reg_loss: 0.7643 | reward: -0.4746 | rev_kl: 0.9600 | stu_lens: 22.0000 | mixed_lens: 46.0000 | lr: 4.9822e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    288/  5000| tot_loss: 2.7472 | rl_loss: 1.0613 | pt_loss: 1.6859 | pg_loss: 0.3099 | reg_loss: 0.7515 | reward: -0.3339 | rev_kl: 1.0660 | stu_lens: 90.3281 | mixed_lens: 92.1875 | lr: 4.9822e-06 | scale: 2048.00 | time: 26.276 | step time: 27.553
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    289/  5000| tot_loss: 2.3707 | rl_loss: 0.6096 | pt_loss: 1.7611 | pg_loss: 0.0262 | reg_loss: 0.5833 | reward: -0.2719 | rev_kl: 1.1176 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9821e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    290/  5000| tot_loss: 2.0227 | rl_loss: 0.5118 | pt_loss: 1.5109 | pg_loss: 0.1880 | reg_loss: 0.3239 | reward: -0.6781 | rev_kl: 0.7226 | stu_lens: 100.5000 | mixed_lens: 82.5000 | lr: 4.9819e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    291/  5000| tot_loss: 4.3897 | rl_loss: 2.6710 | pt_loss: 1.7187 | pg_loss: 1.5868 | reg_loss: 1.0842 | reward: -0.8315 | rev_kl: 1.3136 | stu_lens: 43.0000 | mixed_lens: 51.5000 | lr: 4.9817e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    292/  5000| tot_loss: 2.9175 | rl_loss: 1.1334 | pt_loss: 1.7841 | pg_loss: 0.3067 | reg_loss: 0.8268 | reward: -0.6897 | rev_kl: 1.4039 | stu_lens: 89.0000 | mixed_lens: 83.0000 | lr: 4.9815e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    293/  5000| tot_loss: 2.1609 | rl_loss: 0.9317 | pt_loss: 1.2292 | pg_loss: 0.3590 | reg_loss: 0.5727 | reward: -0.4154 | rev_kl: 0.8499 | stu_lens: 75.5000 | mixed_lens: 81.0000 | lr: 4.9813e-06 | scale: 2048.00 | time: 26.341 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    294/  5000| tot_loss: 2.4008 | rl_loss: 0.3705 | pt_loss: 2.0303 | pg_loss: 0.0602 | reg_loss: 0.3103 | reward: -0.2551 | rev_kl: 1.1663 | stu_lens: 101.5000 | mixed_lens: 113.0000 | lr: 4.9811e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    295/  5000| tot_loss: 2.6134 | rl_loss: 0.8933 | pt_loss: 1.7201 | pg_loss: 0.1289 | reg_loss: 0.7644 | reward: -0.2987 | rev_kl: 0.5737 | stu_lens: 96.5000 | mixed_lens: 104.5000 | lr: 4.9809e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    296/  5000| tot_loss: 2.9712 | rl_loss: 0.7216 | pt_loss: 2.2496 | pg_loss: 0.3170 | reg_loss: 0.4046 | reward: -0.2126 | rev_kl: 0.7802 | stu_lens: 80.0000 | mixed_lens: 75.5000 | lr: 4.9807e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    297/  5000| tot_loss: 2.1326 | rl_loss: 0.5321 | pt_loss: 1.6005 | pg_loss: 0.2002 | reg_loss: 0.3319 | reward: -0.4830 | rev_kl: 1.0714 | stu_lens: 128.0000 | mixed_lens: 96.0000 | lr: 4.9805e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    298/  5000| tot_loss: 2.3949 | rl_loss: 0.7932 | pt_loss: 1.6016 | pg_loss: 0.4506 | reg_loss: 0.3426 | reward: -0.0606 | rev_kl: 0.7299 | stu_lens: 95.0000 | mixed_lens: 78.0000 | lr: 4.9803e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    299/  5000| tot_loss: 2.2140 | rl_loss: 0.4721 | pt_loss: 1.7419 | pg_loss: 0.1395 | reg_loss: 0.3326 | reward: 0.0283 | rev_kl: 0.9850 | stu_lens: 47.0000 | mixed_lens: 69.5000 | lr: 4.9801e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
                                 Evaluation #3                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Bob should leave Alice because his   │
│                                       │ chances of survival are 31% with     │
│                                       │ Alice and 9% without Alice. The      │
│                                       │ difference between the two numbers   │
│                                       │ is 22%. This is higher than the 11%  │
│                                       │ probability that Alice will survive  │
│                                       │ on her own. Therefore, Bob should    │
│                                       │ leave Alice.                         │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ mz kezboard tzpe z instead of y and  │
│                                       │ vice versa because mz kezboard doe   │
│                                       │ not support y and z are next to each │
│                                       │ other in the keyboard                │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support over 70 languages. You    │
│                                       │ can see the full list here:          │
│                                       │ https://www.lingo.com/languages      │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.208 | exact_match: 0.108 | rev_kl: 1.211 | lens: 86.167 | pt_loss: 1.097 | lm_loss: 1.194 | kd_loss: 1.001 
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    300/  5000| tot_loss: 2.0333 | rl_loss: 0.2697 | pt_loss: 1.7636 | pg_loss: 0.0092 | reg_loss: 0.2604 | reward: -0.1496 | rev_kl: 0.4819 | stu_lens: 105.5000 | mixed_lens: 128.0000 | lr: 4.9799e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    301/  5000| tot_loss: 2.2647 | rl_loss: 0.9895 | pt_loss: 1.2753 | pg_loss: 0.4634 | reg_loss: 0.5261 | reward: -0.5314 | rev_kl: 0.8584 | stu_lens: 128.0000 | mixed_lens: 80.5000 | lr: 4.9797e-06 | scale: 2048.00 | time: 26.398 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    302/  5000| tot_loss: 3.0396 | rl_loss: 0.9342 | pt_loss: 2.1054 | pg_loss: 0.3549 | reg_loss: 0.5793 | reward: -0.1791 | rev_kl: 1.9318 | stu_lens: 80.0000 | mixed_lens: 64.0000 | lr: 4.9795e-06 | scale: 2048.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    303/  5000| tot_loss: 2.3271 | rl_loss: 0.3112 | pt_loss: 2.0159 | pg_loss: -0.0095 | reg_loss: 0.3207 | reward: -0.0100 | rev_kl: 0.6509 | stu_lens: 102.5000 | mixed_lens: 128.0000 | lr: 4.9793e-06 | scale: 2048.00 | time: 26.378 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    304/  5000| tot_loss: 2.4832 | rl_loss: 0.8626 | pt_loss: 1.6206 | pg_loss: 0.4641 | reg_loss: 0.3985 | reward: -0.3455 | rev_kl: 1.4036 | stu_lens: 121.5000 | mixed_lens: 76.0000 | lr: 4.9791e-06 | scale: 2048.00 | time: 26.340 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    304/  5000| tot_loss: 2.5410 | rl_loss: 0.7782 | pt_loss: 1.7628 | pg_loss: 0.2788 | reg_loss: 0.4994 | reward: -0.3363 | rev_kl: 1.0705 | stu_lens: 92.0938 | mixed_lens: 92.2188 | lr: 4.9791e-06 | scale: 2048.00 | time: 26.340 | step time: 27.577
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    305/  5000| tot_loss: 2.2082 | rl_loss: 0.5937 | pt_loss: 1.6145 | pg_loss: 0.2192 | reg_loss: 0.3745 | reward: -0.4918 | rev_kl: 1.0705 | stu_lens: 112.0000 | mixed_lens: 85.5000 | lr: 4.9789e-06 | scale: 2048.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    306/  5000| tot_loss: 2.4714 | rl_loss: 0.4487 | pt_loss: 2.0228 | pg_loss: 0.0578 | reg_loss: 0.3909 | reward: -0.5457 | rev_kl: 0.8999 | stu_lens: 64.0000 | mixed_lens: 34.0000 | lr: 4.9786e-06 | scale: 2048.00 | time: 26.341 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    307/  5000| tot_loss: 2.6039 | rl_loss: 0.6311 | pt_loss: 1.9728 | pg_loss: 0.1583 | reg_loss: 0.4728 | reward: -0.1432 | rev_kl: 0.8086 | stu_lens: 113.0000 | mixed_lens: 100.0000 | lr: 4.9784e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    308/  5000| tot_loss: 2.6703 | rl_loss: 1.0576 | pt_loss: 1.6127 | pg_loss: 0.6371 | reg_loss: 0.4205 | reward: -0.3725 | rev_kl: 0.9873 | stu_lens: 108.0000 | mixed_lens: 74.0000 | lr: 4.9782e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    309/  5000| tot_loss: 3.1803 | rl_loss: 1.8363 | pt_loss: 1.3440 | pg_loss: 1.3173 | reg_loss: 0.5190 | reward: -0.3254 | rev_kl: 1.2913 | stu_lens: 32.0000 | mixed_lens: 27.0000 | lr: 4.9780e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    310/  5000| tot_loss: 3.0159 | rl_loss: 1.2643 | pt_loss: 1.7516 | pg_loss: 0.7061 | reg_loss: 0.5581 | reward: 0.9457 | rev_kl: 0.3686 | stu_lens: 35.0000 | mixed_lens: 47.5000 | lr: 4.9778e-06 | scale: 2048.00 | time: 26.340 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    311/  5000| tot_loss: 2.2775 | rl_loss: 0.4571 | pt_loss: 1.8204 | pg_loss: -0.0009 | reg_loss: 0.4580 | reward: -0.2240 | rev_kl: 1.0686 | stu_lens: 105.5000 | mixed_lens: 128.0000 | lr: 4.9776e-06 | scale: 2048.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    312/  5000| tot_loss: 2.4721 | rl_loss: 0.6326 | pt_loss: 1.8395 | pg_loss: 0.2684 | reg_loss: 0.3642 | reward: -0.1991 | rev_kl: 1.5501 | stu_lens: 121.5000 | mixed_lens: 92.0000 | lr: 4.9774e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    313/  5000| tot_loss: 2.2089 | rl_loss: 0.7010 | pt_loss: 1.5079 | pg_loss: 0.2074 | reg_loss: 0.4936 | reward: -0.2795 | rev_kl: 1.3519 | stu_lens: 95.5000 | mixed_lens: 99.0000 | lr: 4.9772e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    314/  5000| tot_loss: 2.2278 | rl_loss: 0.8487 | pt_loss: 1.3790 | pg_loss: 0.4907 | reg_loss: 0.3581 | reward: -0.2369 | rev_kl: 0.8189 | stu_lens: 31.0000 | mixed_lens: 71.0000 | lr: 4.9769e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    315/  5000| tot_loss: 1.7662 | rl_loss: 0.3681 | pt_loss: 1.3981 | pg_loss: -0.0106 | reg_loss: 0.3786 | reward: -0.2378 | rev_kl: 0.9978 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9767e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    316/  5000| tot_loss: 1.9657 | rl_loss: 0.2747 | pt_loss: 1.6911 | pg_loss: -0.0023 | reg_loss: 0.2770 | reward: -0.1189 | rev_kl: 0.7260 | stu_lens: 100.0000 | mixed_lens: 128.0000 | lr: 4.9765e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    317/  5000| tot_loss: 2.6010 | rl_loss: 0.7303 | pt_loss: 1.8707 | pg_loss: 0.3064 | reg_loss: 0.4240 | reward: -0.4861 | rev_kl: 1.3131 | stu_lens: 107.0000 | mixed_lens: 74.5000 | lr: 4.9763e-06 | scale: 2048.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    318/  5000| tot_loss: 2.3007 | rl_loss: 0.6035 | pt_loss: 1.6972 | pg_loss: 0.0791 | reg_loss: 0.5244 | reward: -0.3775 | rev_kl: 1.2459 | stu_lens: 65.5000 | mixed_lens: 110.0000 | lr: 4.9761e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    319/  5000| tot_loss: 3.3855 | rl_loss: 1.3124 | pt_loss: 2.0731 | pg_loss: 0.8186 | reg_loss: 0.4938 | reward: -0.6711 | rev_kl: 0.7934 | stu_lens: 128.0000 | mixed_lens: 54.5000 | lr: 4.9758e-06 | scale: 2048.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    320/  5000| tot_loss: 2.4145 | rl_loss: 0.6384 | pt_loss: 1.7760 | pg_loss: 0.1978 | reg_loss: 0.4406 | reward: -0.3989 | rev_kl: 1.0480 | stu_lens: 57.5000 | mixed_lens: 103.0000 | lr: 4.9756e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    320/  5000| tot_loss: 2.3849 | rl_loss: 0.6932 | pt_loss: 1.6916 | pg_loss: 0.2672 | reg_loss: 0.4260 | reward: -0.3029 | rev_kl: 1.0785 | stu_lens: 94.0000 | mixed_lens: 93.2500 | lr: 4.9756e-06 | scale: 2048.00 | time: 26.280 | step time: 27.546
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    321/  5000| tot_loss: 1.9640 | rl_loss: 0.1578 | pt_loss: 1.8061 | pg_loss: 0.0070 | reg_loss: 0.1508 | reward: -0.1338 | rev_kl: 0.6705 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9754e-06 | scale: 2048.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    322/  5000| tot_loss: 3.1008 | rl_loss: 1.5568 | pt_loss: 1.5441 | pg_loss: 0.2457 | reg_loss: 1.3111 | reward: -0.3025 | rev_kl: 0.8782 | stu_lens: 91.0000 | mixed_lens: 98.0000 | lr: 4.9752e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    323/  5000| tot_loss: 3.2336 | rl_loss: 1.0590 | pt_loss: 2.1746 | pg_loss: 0.3569 | reg_loss: 0.7021 | reward: -0.0913 | rev_kl: 0.8783 | stu_lens: 104.5000 | mixed_lens: 90.5000 | lr: 4.9749e-06 | scale: 2048.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    324/  5000| tot_loss: 4.8496 | rl_loss: 2.8713 | pt_loss: 1.9783 | pg_loss: 1.0400 | reg_loss: 1.8313 | reward: -0.6640 | rev_kl: 0.9670 | stu_lens: 26.0000 | mixed_lens: 43.5000 | lr: 4.9747e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    325/  5000| tot_loss: 1.8856 | rl_loss: 0.5773 | pt_loss: 1.3083 | pg_loss: 0.1620 | reg_loss: 0.4153 | reward: -0.1627 | rev_kl: 0.7124 | stu_lens: 100.0000 | mixed_lens: 69.0000 | lr: 4.9745e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    326/  5000| tot_loss: 3.3646 | rl_loss: 1.8122 | pt_loss: 1.5524 | pg_loss: 0.5843 | reg_loss: 1.2280 | reward: -0.1408 | rev_kl: 0.8288 | stu_lens: 27.5000 | mixed_lens: 56.0000 | lr: 4.9743e-06 | scale: 2048.00 | time: 26.348 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    327/  5000| tot_loss: 2.5238 | rl_loss: 1.0099 | pt_loss: 1.5138 | pg_loss: 0.1608 | reg_loss: 0.8491 | reward: -0.2830 | rev_kl: 0.9318 | stu_lens: 57.0000 | mixed_lens: 105.0000 | lr: 4.9740e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    328/  5000| tot_loss: 3.7098 | rl_loss: 2.1072 | pt_loss: 1.6026 | pg_loss: 1.1480 | reg_loss: 0.9592 | reward: -0.6441 | rev_kl: 1.1585 | stu_lens: 74.5000 | mixed_lens: 32.0000 | lr: 4.9738e-06 | scale: 2048.00 | time: 26.323 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    329/  5000| tot_loss: 3.7452 | rl_loss: 1.6900 | pt_loss: 2.0552 | pg_loss: 0.3990 | reg_loss: 1.2910 | reward: -0.5930 | rev_kl: 1.2515 | stu_lens: 92.5000 | mixed_lens: 95.5000 | lr: 4.9736e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    330/  5000| tot_loss: 3.9088 | rl_loss: 1.8757 | pt_loss: 2.0331 | pg_loss: 0.2566 | reg_loss: 1.6191 | reward: -0.5910 | rev_kl: 1.4636 | stu_lens: 128.0000 | mixed_lens: 106.5000 | lr: 4.9733e-06 | scale: 2048.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    331/  5000| tot_loss: 4.2933 | rl_loss: 2.6332 | pt_loss: 1.6601 | pg_loss: 0.9038 | reg_loss: 1.7294 | reward: -1.0934 | rev_kl: 1.6018 | stu_lens: 57.0000 | mixed_lens: 47.5000 | lr: 4.9731e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    332/  5000| tot_loss: 3.5285 | rl_loss: 1.8362 | pt_loss: 1.6923 | pg_loss: 0.2657 | reg_loss: 1.5705 | reward: -0.7233 | rev_kl: 1.3565 | stu_lens: 88.0000 | mixed_lens: 55.0000 | lr: 4.9729e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    333/  5000| tot_loss: 3.5007 | rl_loss: 1.3341 | pt_loss: 2.1667 | pg_loss: 0.1408 | reg_loss: 1.1933 | reward: -0.3496 | rev_kl: 1.0952 | stu_lens: 88.5000 | mixed_lens: 98.0000 | lr: 4.9726e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    334/  5000| tot_loss: 4.0873 | rl_loss: 2.1769 | pt_loss: 1.9104 | pg_loss: 0.4618 | reg_loss: 1.7150 | reward: -0.6368 | rev_kl: 1.7063 | stu_lens: 88.5000 | mixed_lens: 85.0000 | lr: 4.9724e-06 | scale: 2048.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    335/  5000| tot_loss: 2.9938 | rl_loss: 1.2507 | pt_loss: 1.7431 | pg_loss: 0.0742 | reg_loss: 1.1765 | reward: -0.3165 | rev_kl: 1.1801 | stu_lens: 81.0000 | mixed_lens: 123.0000 | lr: 4.9722e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    336/  5000| tot_loss: 2.6806 | rl_loss: 1.0230 | pt_loss: 1.6576 | pg_loss: 0.0910 | reg_loss: 0.9320 | reward: -0.1510 | rev_kl: 0.6578 | stu_lens: 82.5000 | mixed_lens: 120.0000 | lr: 4.9719e-06 | scale: 2048.00 | time: 26.307 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    336/  5000| tot_loss: 3.3028 | rl_loss: 1.5843 | pt_loss: 1.7185 | pg_loss: 0.3657 | reg_loss: 1.2186 | reward: -0.4399 | rev_kl: 1.1508 | stu_lens: 80.5312 | mixed_lens: 88.5625 | lr: 4.9719e-06 | scale: 2048.00 | time: 26.307 | step time: 27.554
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    337/  5000| tot_loss: 2.7917 | rl_loss: 1.0540 | pt_loss: 1.7376 | pg_loss: 0.1970 | reg_loss: 0.8571 | reward: -0.6134 | rev_kl: 0.6899 | stu_lens: 91.0000 | mixed_lens: 105.5000 | lr: 4.9717e-06 | scale: 2048.00 | time: 26.343 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    338/  5000| tot_loss: 3.2122 | rl_loss: 1.1807 | pt_loss: 2.0316 | pg_loss: 0.4121 | reg_loss: 0.7685 | reward: -0.3338 | rev_kl: 1.2823 | stu_lens: 29.5000 | mixed_lens: 49.0000 | lr: 4.9714e-06 | scale: 2048.00 | time: 26.365 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    339/  5000| tot_loss: 2.6134 | rl_loss: 1.2060 | pt_loss: 1.4074 | pg_loss: 0.1387 | reg_loss: 1.0673 | reward: -0.5539 | rev_kl: 1.5040 | stu_lens: 95.0000 | mixed_lens: 99.5000 | lr: 4.9712e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    340/  5000| tot_loss: 2.7029 | rl_loss: 0.9195 | pt_loss: 1.7835 | pg_loss: 0.2394 | reg_loss: 0.6801 | reward: -0.1799 | rev_kl: 0.2971 | stu_lens: 128.0000 | mixed_lens: 69.0000 | lr: 4.9710e-06 | scale: 2048.00 | time: 26.355 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    341/  5000| tot_loss: 2.7327 | rl_loss: 0.7213 | pt_loss: 2.0114 | pg_loss: 0.0316 | reg_loss: 0.6897 | reward: -0.2001 | rev_kl: 1.2439 | stu_lens: 71.0000 | mixed_lens: 123.5000 | lr: 4.9707e-06 | scale: 2048.00 | time: 26.315 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    342/  5000| tot_loss: 2.5926 | rl_loss: 0.7480 | pt_loss: 1.8445 | pg_loss: 0.0175 | reg_loss: 0.7306 | reward: -0.1658 | rev_kl: 1.0135 | stu_lens: 107.0000 | mixed_lens: 123.0000 | lr: 4.9705e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    343/  5000| tot_loss: 2.5135 | rl_loss: 1.0864 | pt_loss: 1.4272 | pg_loss: 0.1295 | reg_loss: 0.9569 | reward: -0.0692 | rev_kl: 1.1492 | stu_lens: 127.5000 | mixed_lens: 111.0000 | lr: 4.9702e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    344/  5000| tot_loss: 3.0451 | rl_loss: 1.7225 | pt_loss: 1.3226 | pg_loss: 0.4978 | reg_loss: 1.2247 | reward: -0.9230 | rev_kl: 0.8278 | stu_lens: 53.5000 | mixed_lens: 76.0000 | lr: 4.9700e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    345/  5000| tot_loss: 2.7208 | rl_loss: 0.9539 | pt_loss: 1.7669 | pg_loss: 0.2589 | reg_loss: 0.6950 | reward: -0.5749 | rev_kl: 0.8291 | stu_lens: 75.0000 | mixed_lens: 91.5000 | lr: 4.9697e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    346/  5000| tot_loss: 2.3094 | rl_loss: 1.0431 | pt_loss: 1.2662 | pg_loss: 0.0984 | reg_loss: 0.9447 | reward: -0.1562 | rev_kl: 1.4181 | stu_lens: 115.0000 | mixed_lens: 103.0000 | lr: 4.9695e-06 | scale: 2048.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    347/  5000| tot_loss: 3.6558 | rl_loss: 1.9530 | pt_loss: 1.7028 | pg_loss: 0.6546 | reg_loss: 1.2984 | reward: -1.1014 | rev_kl: 1.3298 | stu_lens: 63.5000 | mixed_lens: 58.0000 | lr: 4.9692e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    348/  5000| tot_loss: 2.5688 | rl_loss: 0.9120 | pt_loss: 1.6568 | pg_loss: 0.1527 | reg_loss: 0.7593 | reward: -0.3373 | rev_kl: 1.7672 | stu_lens: 51.5000 | mixed_lens: 111.5000 | lr: 4.9690e-06 | scale: 2048.00 | time: 26.343 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    349/  5000| tot_loss: 2.2819 | rl_loss: 0.6822 | pt_loss: 1.5997 | pg_loss: 0.0556 | reg_loss: 0.6266 | reward: -0.2529 | rev_kl: 0.5634 | stu_lens: 82.5000 | mixed_lens: 120.0000 | lr: 4.9687e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    350/  5000| tot_loss: 2.8008 | rl_loss: 0.9930 | pt_loss: 1.8078 | pg_loss: 0.2635 | reg_loss: 0.7295 | reward: -0.1265 | rev_kl: 0.8838 | stu_lens: 86.5000 | mixed_lens: 74.5000 | lr: 4.9685e-06 | scale: 2048.00 | time: 26.349 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    351/  5000| tot_loss: 2.8969 | rl_loss: 1.4645 | pt_loss: 1.4324 | pg_loss: 0.5340 | reg_loss: 0.9305 | reward: -0.6503 | rev_kl: 1.2560 | stu_lens: 81.5000 | mixed_lens: 70.0000 | lr: 4.9682e-06 | scale: 2048.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    352/  5000| tot_loss: 2.1798 | rl_loss: 1.0776 | pt_loss: 1.1022 | pg_loss: 0.3842 | reg_loss: 0.6935 | reward: -0.8481 | rev_kl: 1.2388 | stu_lens: 77.0000 | mixed_lens: 70.0000 | lr: 4.9680e-06 | scale: 2048.00 | time: 26.368 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    352/  5000| tot_loss: 2.8097 | rl_loss: 1.1447 | pt_loss: 1.6650 | pg_loss: 0.2843 | reg_loss: 0.8604 | reward: -0.4518 | rev_kl: 1.1066 | stu_lens: 79.8594 | mixed_lens: 88.9531 | lr: 4.9680e-06 | scale: 2048.00 | time: 26.368 | step time: 27.581
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    353/  5000| tot_loss: 2.7188 | rl_loss: 0.9882 | pt_loss: 1.7306 | pg_loss: 0.2430 | reg_loss: 0.7452 | reward: -0.4945 | rev_kl: 0.7086 | stu_lens: 115.0000 | mixed_lens: 99.5000 | lr: 4.9677e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    354/  5000| tot_loss: 2.2958 | rl_loss: 0.7761 | pt_loss: 1.5196 | pg_loss: 0.1626 | reg_loss: 0.6135 | reward: -0.1530 | rev_kl: 0.3395 | stu_lens: 107.5000 | mixed_lens: 110.0000 | lr: 4.9674e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    355/  5000| tot_loss: 1.9991 | rl_loss: 0.3203 | pt_loss: 1.6789 | pg_loss: 0.0027 | reg_loss: 0.3176 | reward: -0.1949 | rev_kl: 0.4617 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9672e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    356/  5000| tot_loss: 2.2271 | rl_loss: 0.5910 | pt_loss: 1.6362 | pg_loss: 0.0702 | reg_loss: 0.5208 | reward: -0.0957 | rev_kl: 0.8751 | stu_lens: 103.5000 | mixed_lens: 107.0000 | lr: 4.9669e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    357/  5000| tot_loss: 2.6198 | rl_loss: 0.8793 | pt_loss: 1.7405 | pg_loss: 0.1976 | reg_loss: 0.6817 | reward: -0.7833 | rev_kl: 0.8876 | stu_lens: 70.5000 | mixed_lens: 70.5000 | lr: 4.9667e-06 | scale: 2048.00 | time: 26.317 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    358/  5000| tot_loss: 3.2643 | rl_loss: 1.6349 | pt_loss: 1.6294 | pg_loss: 0.6507 | reg_loss: 0.9842 | reward: -0.5519 | rev_kl: 1.2441 | stu_lens: 62.0000 | mixed_lens: 52.5000 | lr: 4.9664e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    359/  5000| tot_loss: 2.5144 | rl_loss: 0.7376 | pt_loss: 1.7768 | pg_loss: 0.0234 | reg_loss: 0.7143 | reward: -0.2186 | rev_kl: 1.3175 | stu_lens: 108.0000 | mixed_lens: 128.0000 | lr: 4.9661e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    360/  5000| tot_loss: 2.6750 | rl_loss: 0.7703 | pt_loss: 1.9047 | pg_loss: 0.1329 | reg_loss: 0.6374 | reward: -0.3533 | rev_kl: 1.0531 | stu_lens: 71.5000 | mixed_lens: 95.0000 | lr: 4.9659e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    361/  5000| tot_loss: 3.3030 | rl_loss: 1.2109 | pt_loss: 2.0921 | pg_loss: 0.5964 | reg_loss: 0.6145 | reward: -0.5748 | rev_kl: 1.2174 | stu_lens: 103.5000 | mixed_lens: 62.0000 | lr: 4.9656e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    362/  5000| tot_loss: 2.8415 | rl_loss: 0.8558 | pt_loss: 1.9857 | pg_loss: 0.1560 | reg_loss: 0.6998 | reward: -0.5654 | rev_kl: 1.4113 | stu_lens: 128.0000 | mixed_lens: 106.5000 | lr: 4.9653e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    363/  5000| tot_loss: 2.4096 | rl_loss: 0.7701 | pt_loss: 1.6395 | pg_loss: 0.1120 | reg_loss: 0.6581 | reward: -0.4170 | rev_kl: 1.4246 | stu_lens: 83.5000 | mixed_lens: 113.0000 | lr: 4.9651e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    364/  5000| tot_loss: 2.5107 | rl_loss: 0.7235 | pt_loss: 1.7873 | pg_loss: 0.2294 | reg_loss: 0.4941 | reward: -0.6499 | rev_kl: 0.8317 | stu_lens: 101.5000 | mixed_lens: 70.0000 | lr: 4.9648e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    365/  5000| tot_loss: 2.3788 | rl_loss: 0.5068 | pt_loss: 1.8719 | pg_loss: 0.1075 | reg_loss: 0.3994 | reward: -0.4400 | rev_kl: 1.0128 | stu_lens: 78.5000 | mixed_lens: 110.5000 | lr: 4.9645e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    366/  5000| tot_loss: 3.1382 | rl_loss: 1.2194 | pt_loss: 1.9187 | pg_loss: 0.3050 | reg_loss: 0.9144 | reward: -0.5981 | rev_kl: 1.8369 | stu_lens: 128.0000 | mixed_lens: 90.5000 | lr: 4.9643e-06 | scale: 2048.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    367/  5000| tot_loss: 2.3565 | rl_loss: 0.8802 | pt_loss: 1.4763 | pg_loss: 0.1216 | reg_loss: 0.7586 | reward: -0.1788 | rev_kl: 1.5714 | stu_lens: 110.5000 | mixed_lens: 107.0000 | lr: 4.9640e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    368/  5000| tot_loss: 3.3530 | rl_loss: 1.8102 | pt_loss: 1.5429 | pg_loss: 0.9185 | reg_loss: 0.8917 | reward: -0.6801 | rev_kl: 0.9542 | stu_lens: 34.0000 | mixed_lens: 38.5000 | lr: 4.9637e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    368/  5000| tot_loss: 2.5389 | rl_loss: 0.8546 | pt_loss: 1.6842 | pg_loss: 0.2619 | reg_loss: 0.5928 | reward: -0.3915 | rev_kl: 1.0859 | stu_lens: 82.7969 | mixed_lens: 92.8594 | lr: 4.9637e-06 | scale: 2048.00 | time: 26.316 | step time: 27.562
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    369/  5000| tot_loss: 2.7278 | rl_loss: 0.5812 | pt_loss: 2.1467 | pg_loss: 0.1615 | reg_loss: 0.4196 | reward: -0.6809 | rev_kl: 1.3828 | stu_lens: 35.5000 | mixed_lens: 79.0000 | lr: 4.9635e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    370/  5000| tot_loss: 1.9844 | rl_loss: 0.3339 | pt_loss: 1.6504 | pg_loss: 0.0639 | reg_loss: 0.2700 | reward: -0.0704 | rev_kl: 0.5698 | stu_lens: 70.5000 | mixed_lens: 111.0000 | lr: 4.9632e-06 | scale: 2048.00 | time: 26.340 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    371/  5000| tot_loss: 2.8314 | rl_loss: 1.1396 | pt_loss: 1.6918 | pg_loss: 0.3444 | reg_loss: 0.7952 | reward: -0.6797 | rev_kl: 1.5625 | stu_lens: 67.0000 | mixed_lens: 86.5000 | lr: 4.9629e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    372/  5000| tot_loss: 1.8273 | rl_loss: 0.4002 | pt_loss: 1.4271 | pg_loss: 0.0777 | reg_loss: 0.3225 | reward: -0.3545 | rev_kl: 1.1814 | stu_lens: 95.0000 | mixed_lens: 115.0000 | lr: 4.9626e-06 | scale: 2048.00 | time: 26.329 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    373/  5000| tot_loss: 2.1080 | rl_loss: 0.6448 | pt_loss: 1.4632 | pg_loss: 0.1445 | reg_loss: 0.5003 | reward: -0.1194 | rev_kl: 1.4962 | stu_lens: 81.0000 | mixed_lens: 111.0000 | lr: 4.9624e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    374/  5000| tot_loss: 2.3204 | rl_loss: 0.6495 | pt_loss: 1.6708 | pg_loss: 0.2232 | reg_loss: 0.4264 | reward: -0.5267 | rev_kl: 1.3779 | stu_lens: 94.0000 | mixed_lens: 90.5000 | lr: 4.9621e-06 | scale: 2048.00 | time: 26.365 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    375/  5000| tot_loss: 2.4666 | rl_loss: 0.8193 | pt_loss: 1.6473 | pg_loss: 0.0806 | reg_loss: 0.7386 | reward: -0.1384 | rev_kl: 0.6907 | stu_lens: 108.0000 | mixed_lens: 118.5000 | lr: 4.9618e-06 | scale: 2048.00 | time: 26.354 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    376/  5000| tot_loss: 2.9445 | rl_loss: 1.3461 | pt_loss: 1.5985 | pg_loss: 0.6483 | reg_loss: 0.6977 | reward: -1.2552 | rev_kl: 2.0156 | stu_lens: 17.5000 | mixed_lens: 51.5000 | lr: 4.9615e-06 | scale: 2048.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    377/  5000| tot_loss: 2.5888 | rl_loss: 0.8227 | pt_loss: 1.7661 | pg_loss: 0.0184 | reg_loss: 0.8043 | reward: -0.3559 | rev_kl: 0.8894 | stu_lens: 80.5000 | mixed_lens: 124.0000 | lr: 4.9612e-06 | scale: 2048.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    378/  5000| tot_loss: 2.4529 | rl_loss: 0.4872 | pt_loss: 1.9657 | pg_loss: 0.1312 | reg_loss: 0.3560 | reward: -0.4535 | rev_kl: 1.1473 | stu_lens: 78.0000 | mixed_lens: 99.0000 | lr: 4.9610e-06 | scale: 2048.00 | time: 26.343 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    379/  5000| tot_loss: 3.0065 | rl_loss: 1.3484 | pt_loss: 1.6582 | pg_loss: 1.1525 | reg_loss: 0.1959 | reward: -0.5531 | rev_kl: 0.4546 | stu_lens: 8.5000 | mixed_lens: 22.5000 | lr: 4.9607e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    380/  5000| tot_loss: 2.5473 | rl_loss: 0.6305 | pt_loss: 1.9168 | pg_loss: 0.1786 | reg_loss: 0.4519 | reward: -0.4575 | rev_kl: 1.2033 | stu_lens: 82.5000 | mixed_lens: 98.5000 | lr: 4.9604e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    381/  5000| tot_loss: 3.2526 | rl_loss: 1.1934 | pt_loss: 2.0593 | pg_loss: 0.4751 | reg_loss: 0.7182 | reward: -0.2000 | rev_kl: 1.5632 | stu_lens: 64.0000 | mixed_lens: 66.0000 | lr: 4.9601e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    382/  5000| tot_loss: 2.5952 | rl_loss: 0.7134 | pt_loss: 1.8818 | pg_loss: 0.1801 | reg_loss: 0.5333 | reward: -0.2197 | rev_kl: 0.9596 | stu_lens: 77.0000 | mixed_lens: 78.0000 | lr: 4.9598e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    383/  5000| tot_loss: 2.1668 | rl_loss: 0.6104 | pt_loss: 1.5564 | pg_loss: 0.0775 | reg_loss: 0.5329 | reward: -0.4459 | rev_kl: 1.1929 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9595e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    384/  5000| tot_loss: 3.3747 | rl_loss: 1.3909 | pt_loss: 1.9838 | pg_loss: 0.5910 | reg_loss: 0.7999 | reward: -0.3958 | rev_kl: 0.9082 | stu_lens: 106.0000 | mixed_lens: 65.5000 | lr: 4.9592e-06 | scale: 2048.00 | time: 26.320 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    384/  5000| tot_loss: 2.4996 | rl_loss: 0.7665 | pt_loss: 1.7331 | pg_loss: 0.2696 | reg_loss: 0.4968 | reward: -0.4693 | rev_kl: 1.1657 | stu_lens: 79.3438 | mixed_lens: 89.5625 | lr: 4.9592e-06 | scale: 2048.00 | time: 26.320 | step time: 27.570
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    385/  5000| tot_loss: 2.3359 | rl_loss: 0.5964 | pt_loss: 1.7394 | pg_loss: 0.3726 | reg_loss: 0.2238 | reward: -0.2615 | rev_kl: 0.6083 | stu_lens: 50.0000 | mixed_lens: 70.5000 | lr: 4.9590e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    386/  5000| tot_loss: 3.8397 | rl_loss: 1.7728 | pt_loss: 2.0668 | pg_loss: 0.3943 | reg_loss: 1.3785 | reward: -0.4335 | rev_kl: 1.0724 | stu_lens: 60.0000 | mixed_lens: 83.5000 | lr: 4.9587e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    387/  5000| tot_loss: 3.4296 | rl_loss: 1.8484 | pt_loss: 1.5812 | pg_loss: 0.6682 | reg_loss: 1.1802 | reward: -1.0432 | rev_kl: 1.0944 | stu_lens: 47.0000 | mixed_lens: 52.5000 | lr: 4.9584e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    388/  5000| tot_loss: 3.2733 | rl_loss: 1.5166 | pt_loss: 1.7567 | pg_loss: 0.3301 | reg_loss: 1.1865 | reward: -0.2797 | rev_kl: 1.2803 | stu_lens: 128.0000 | mixed_lens: 85.5000 | lr: 4.9581e-06 | scale: 2048.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    389/  5000| tot_loss: 2.7363 | rl_loss: 1.4981 | pt_loss: 1.2382 | pg_loss: 0.0666 | reg_loss: 1.4315 | reward: -0.2035 | rev_kl: 1.1467 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9578e-06 | scale: 2048.00 | time: 26.359 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    390/  5000| tot_loss: 2.5163 | rl_loss: 0.8000 | pt_loss: 1.7163 | pg_loss: 0.0825 | reg_loss: 0.7175 | reward: -0.3605 | rev_kl: 0.9424 | stu_lens: 117.5000 | mixed_lens: 115.5000 | lr: 4.9575e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    391/  5000| tot_loss: 3.5890 | rl_loss: 1.8265 | pt_loss: 1.7625 | pg_loss: 0.3151 | reg_loss: 1.5114 | reward: -0.1941 | rev_kl: 1.3591 | stu_lens: 61.0000 | mixed_lens: 91.0000 | lr: 4.9572e-06 | scale: 2048.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    392/  5000| tot_loss: 3.2421 | rl_loss: 1.2572 | pt_loss: 1.9849 | pg_loss: 0.0813 | reg_loss: 1.1759 | reward: -0.1494 | rev_kl: 1.2504 | stu_lens: 128.0000 | mixed_lens: 119.5000 | lr: 4.9569e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    393/  5000| tot_loss: 3.7216 | rl_loss: 2.1334 | pt_loss: 1.5881 | pg_loss: 0.2528 | reg_loss: 1.8806 | reward: -1.0432 | rev_kl: 1.1810 | stu_lens: 26.5000 | mixed_lens: 24.5000 | lr: 4.9566e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    394/  5000| tot_loss: 2.7395 | rl_loss: 1.0846 | pt_loss: 1.6549 | pg_loss: 0.0842 | reg_loss: 1.0004 | reward: -0.1131 | rev_kl: 0.4754 | stu_lens: 128.0000 | mixed_lens: 121.0000 | lr: 4.9563e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    395/  5000| tot_loss: 2.2858 | rl_loss: 1.2632 | pt_loss: 1.0227 | pg_loss: 0.1111 | reg_loss: 1.1521 | reward: -0.4916 | rev_kl: 1.1900 | stu_lens: 128.0000 | mixed_lens: 90.0000 | lr: 4.9560e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    396/  5000| tot_loss: 3.4000 | rl_loss: 1.4453 | pt_loss: 1.9546 | pg_loss: 0.2199 | reg_loss: 1.2254 | reward: -0.2300 | rev_kl: 1.1239 | stu_lens: 107.5000 | mixed_lens: 108.0000 | lr: 4.9557e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    397/  5000| tot_loss: 2.8211 | rl_loss: 1.5324 | pt_loss: 1.2888 | pg_loss: 0.4555 | reg_loss: 1.0769 | reward: -0.4367 | rev_kl: 0.9669 | stu_lens: 38.0000 | mixed_lens: 74.0000 | lr: 4.9554e-06 | scale: 2048.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    398/  5000| tot_loss: 2.9221 | rl_loss: 1.4228 | pt_loss: 1.4994 | pg_loss: 0.3285 | reg_loss: 1.0942 | reward: -0.2938 | rev_kl: 1.0606 | stu_lens: 113.0000 | mixed_lens: 94.0000 | lr: 4.9551e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    399/  5000| tot_loss: 3.9063 | rl_loss: 2.0248 | pt_loss: 1.8815 | pg_loss: 0.4630 | reg_loss: 1.5618 | reward: -0.9343 | rev_kl: 0.8365 | stu_lens: 91.5000 | mixed_lens: 82.5000 | lr: 4.9548e-06 | scale: 2048.00 | time: 26.259 | step time: 0.000
                                 Evaluation #4                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ The expected value of survival is    │
│                                       │ 31% and the expected value of death  │
│                                       │ is 69%. If Bob leaves Alice, his     │
│                                       │ chances of survival improve by 9%,   │
│                                       │ which brings the expected value of   │
│                                       │ survival to 39%. If he stays with    │
│                                       │ Alice, his chances of survival       │
│                                       │ improve by 31%, which brings the     │
│                                       │ expected value of survival to 34%.   │
│                                       │ Since the expected value of survival │
│                                       │ is higher in the first case, Bob     │
│                                       │ should leave Alice.                  │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ I don't know. I just got this        │
│                                       │ keyboard.                            │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support over 100 languages,       │
│                                       │ including English, French, German,   │
│                                       │ Spanish, Italian, and Turkish.       │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.396 | exact_match: 0.323 | rev_kl: 1.200 | lens: 99.001 | pt_loss: 1.093 | lm_loss: 1.187 | kd_loss: 1.000 
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    400/  5000| tot_loss: 3.2185 | rl_loss: 1.4823 | pt_loss: 1.7362 | pg_loss: 0.0683 | reg_loss: 1.4140 | reward: -0.1951 | rev_kl: 0.9871 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9545e-06 | scale: 2048.00 | time: 26.323 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    400/  5000| tot_loss: 3.2105 | rl_loss: 1.5921 | pt_loss: 1.6184 | pg_loss: 0.3149 | reg_loss: 1.2771 | reward: -0.4737 | rev_kl: 1.1011 | stu_lens: 90.9375 | mixed_lens: 90.3594 | lr: 4.9545e-06 | scale: 2048.00 | time: 26.323 | step time: 27.539
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    401/  5000| tot_loss: 2.9867 | rl_loss: 1.4102 | pt_loss: 1.5765 | pg_loss: 0.1826 | reg_loss: 1.2276 | reward: -0.4672 | rev_kl: 1.3508 | stu_lens: 71.0000 | mixed_lens: 71.0000 | lr: 4.9542e-06 | scale: 2048.00 | time: 26.328 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    402/  5000| tot_loss: 2.2084 | rl_loss: 0.7222 | pt_loss: 1.4863 | pg_loss: 0.0021 | reg_loss: 0.7201 | reward: -0.3514 | rev_kl: 1.0618 | stu_lens: 98.0000 | mixed_lens: 128.0000 | lr: 4.9539e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    403/  5000| tot_loss: 3.5849 | rl_loss: 1.4427 | pt_loss: 2.1421 | pg_loss: 0.5317 | reg_loss: 0.9110 | reward: -0.4832 | rev_kl: 1.0105 | stu_lens: 83.0000 | mixed_lens: 75.0000 | lr: 4.9536e-06 | scale: 2048.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    404/  5000| tot_loss: 2.4860 | rl_loss: 0.6435 | pt_loss: 1.8424 | pg_loss: 0.1170 | reg_loss: 0.5265 | reward: -0.6244 | rev_kl: 1.6985 | stu_lens: 82.0000 | mixed_lens: 70.0000 | lr: 4.9533e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    405/  5000| tot_loss: 2.7503 | rl_loss: 0.9422 | pt_loss: 1.8081 | pg_loss: -0.0036 | reg_loss: 0.9459 | reward: -0.3531 | rev_kl: 1.1687 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9530e-06 | scale: 2048.00 | time: 26.381 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    406/  5000| tot_loss: 2.7441 | rl_loss: 0.8924 | pt_loss: 1.8517 | pg_loss: 0.0233 | reg_loss: 0.8691 | reward: -0.3596 | rev_kl: 1.3776 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9527e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    407/  5000| tot_loss: 2.6056 | rl_loss: 0.9685 | pt_loss: 1.6372 | pg_loss: 0.0174 | reg_loss: 0.9510 | reward: -0.3704 | rev_kl: 0.7928 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9524e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    408/  5000| tot_loss: 2.4708 | rl_loss: 0.8359 | pt_loss: 1.6349 | pg_loss: 0.0475 | reg_loss: 0.7884 | reward: -0.1671 | rev_kl: 1.2569 | stu_lens: 101.5000 | mixed_lens: 128.0000 | lr: 4.9520e-06 | scale: 2048.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    409/  5000| tot_loss: 3.3291 | rl_loss: 1.4929 | pt_loss: 1.8361 | pg_loss: 0.5963 | reg_loss: 0.8966 | reward: -0.9028 | rev_kl: 0.9950 | stu_lens: 73.0000 | mixed_lens: 76.5000 | lr: 4.9517e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    410/  5000| tot_loss: 2.7055 | rl_loss: 1.3989 | pt_loss: 1.3065 | pg_loss: 0.4607 | reg_loss: 0.9383 | reward: -1.2142 | rev_kl: 1.1652 | stu_lens: 71.0000 | mixed_lens: 75.5000 | lr: 4.9514e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    411/  5000| tot_loss: 2.9821 | rl_loss: 1.2810 | pt_loss: 1.7011 | pg_loss: 0.2962 | reg_loss: 0.9848 | reward: -0.6972 | rev_kl: 1.1022 | stu_lens: 78.0000 | mixed_lens: 76.0000 | lr: 4.9511e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    412/  5000| tot_loss: 3.6320 | rl_loss: 1.5321 | pt_loss: 2.0999 | pg_loss: 0.3612 | reg_loss: 1.1709 | reward: -0.1773 | rev_kl: 1.2210 | stu_lens: 83.5000 | mixed_lens: 61.0000 | lr: 4.9508e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    413/  5000| tot_loss: 3.3631 | rl_loss: 1.1352 | pt_loss: 2.2279 | pg_loss: 0.3133 | reg_loss: 0.8219 | reward: -0.8557 | rev_kl: 1.6001 | stu_lens: 70.0000 | mixed_lens: 61.0000 | lr: 4.9505e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    414/  5000| tot_loss: 2.3808 | rl_loss: 0.8905 | pt_loss: 1.4904 | pg_loss: 0.0670 | reg_loss: 0.8235 | reward: -0.2985 | rev_kl: 1.4094 | stu_lens: 107.5000 | mixed_lens: 122.0000 | lr: 4.9501e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    415/  5000| tot_loss: 2.6661 | rl_loss: 1.0085 | pt_loss: 1.6576 | pg_loss: 0.1676 | reg_loss: 0.8409 | reward: -0.2096 | rev_kl: 1.3295 | stu_lens: 87.0000 | mixed_lens: 111.5000 | lr: 4.9498e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    416/  5000| tot_loss: 2.4925 | rl_loss: 0.7358 | pt_loss: 1.7567 | pg_loss: 0.0447 | reg_loss: 0.6911 | reward: -0.2167 | rev_kl: 1.3842 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9495e-06 | scale: 2048.00 | time: 26.338 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    416/  5000| tot_loss: 2.9541 | rl_loss: 1.2222 | pt_loss: 1.7318 | pg_loss: 0.3262 | reg_loss: 0.8961 | reward: -0.5095 | rev_kl: 1.1452 | stu_lens: 89.0312 | mixed_lens: 86.6562 | lr: 4.9495e-06 | scale: 2048.00 | time: 26.338 | step time: 27.568
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    417/  5000| tot_loss: 2.6413 | rl_loss: 0.8734 | pt_loss: 1.7679 | pg_loss: 0.1679 | reg_loss: 0.7054 | reward: -0.2329 | rev_kl: 0.8532 | stu_lens: 128.0000 | mixed_lens: 108.0000 | lr: 4.9492e-06 | scale: 2048.00 | time: 26.367 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    418/  5000| tot_loss: 2.6766 | rl_loss: 1.1727 | pt_loss: 1.5038 | pg_loss: 0.4915 | reg_loss: 0.6813 | reward: -1.1014 | rev_kl: 0.9122 | stu_lens: 71.0000 | mixed_lens: 75.5000 | lr: 4.9489e-06 | scale: 2048.00 | time: 26.352 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    419/  5000| tot_loss: 1.8669 | rl_loss: 0.9453 | pt_loss: 0.9216 | pg_loss: 0.2276 | reg_loss: 0.7177 | reward: -0.8780 | rev_kl: 1.5936 | stu_lens: 65.0000 | mixed_lens: 81.5000 | lr: 4.9485e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    420/  5000| tot_loss: 2.5349 | rl_loss: 0.7874 | pt_loss: 1.7474 | pg_loss: 0.2851 | reg_loss: 0.5023 | reward: -0.3096 | rev_kl: 1.1206 | stu_lens: 89.5000 | mixed_lens: 87.5000 | lr: 4.9482e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    421/  5000| tot_loss: 2.3446 | rl_loss: 0.4310 | pt_loss: 1.9136 | pg_loss: 0.0543 | reg_loss: 0.3767 | reward: -0.1532 | rev_kl: 1.1392 | stu_lens: 128.0000 | mixed_lens: 122.0000 | lr: 4.9479e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    422/  5000| tot_loss: 3.2701 | rl_loss: 1.2313 | pt_loss: 2.0388 | pg_loss: 0.4352 | reg_loss: 0.7961 | reward: -0.4154 | rev_kl: 1.1044 | stu_lens: 99.5000 | mixed_lens: 75.5000 | lr: 4.9476e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    423/  5000| tot_loss: 2.7592 | rl_loss: 0.6391 | pt_loss: 2.1201 | pg_loss: 0.0598 | reg_loss: 0.5793 | reward: -0.3981 | rev_kl: 1.1286 | stu_lens: 117.5000 | mixed_lens: 115.5000 | lr: 4.9472e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    424/  5000| tot_loss: 2.2523 | rl_loss: 0.7522 | pt_loss: 1.5001 | pg_loss: 0.0124 | reg_loss: 0.7398 | reward: -0.1237 | rev_kl: 1.2083 | stu_lens: 22.5000 | mixed_lens: 68.0000 | lr: 4.9469e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    425/  5000| tot_loss: 2.2570 | rl_loss: 0.6501 | pt_loss: 1.6068 | pg_loss: 0.0463 | reg_loss: 0.6038 | reward: -0.1222 | rev_kl: 0.7579 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9466e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    426/  5000| tot_loss: 2.1049 | rl_loss: 0.5841 | pt_loss: 1.5208 | pg_loss: -0.0044 | reg_loss: 0.5884 | reward: -0.1592 | rev_kl: 0.7747 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9463e-06 | scale: 2048.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    427/  5000| tot_loss: 2.2271 | rl_loss: 0.5658 | pt_loss: 1.6613 | pg_loss: 0.1719 | reg_loss: 0.3940 | reward: -0.1058 | rev_kl: 0.7871 | stu_lens: 128.0000 | mixed_lens: 99.5000 | lr: 4.9459e-06 | scale: 2048.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    428/  5000| tot_loss: 2.7111 | rl_loss: 0.6978 | pt_loss: 2.0133 | pg_loss: 0.0146 | reg_loss: 0.6833 | reward: -0.4086 | rev_kl: 1.6671 | stu_lens: 99.5000 | mixed_lens: 128.0000 | lr: 4.9456e-06 | scale: 2048.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    429/  5000| tot_loss: 2.7446 | rl_loss: 0.9852 | pt_loss: 1.7594 | pg_loss: 0.4480 | reg_loss: 0.5372 | reward: -0.3108 | rev_kl: 1.0387 | stu_lens: 83.0000 | mixed_lens: 78.0000 | lr: 4.9453e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    430/  5000| tot_loss: 2.9113 | rl_loss: 1.0417 | pt_loss: 1.8696 | pg_loss: 0.3728 | reg_loss: 0.6688 | reward: -1.0179 | rev_kl: 1.2122 | stu_lens: 91.5000 | mixed_lens: 82.5000 | lr: 4.9449e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    431/  5000| tot_loss: 1.8775 | rl_loss: 0.5268 | pt_loss: 1.3508 | pg_loss: 0.0269 | reg_loss: 0.4999 | reward: -0.1999 | rev_kl: 1.4298 | stu_lens: 128.0000 | mixed_lens: 126.0000 | lr: 4.9446e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    432/  5000| tot_loss: 3.2150 | rl_loss: 1.0723 | pt_loss: 2.1427 | pg_loss: 0.4068 | reg_loss: 0.6655 | reward: -0.3860 | rev_kl: 0.9767 | stu_lens: 75.0000 | mixed_lens: 63.0000 | lr: 4.9443e-06 | scale: 2048.00 | time: 26.286 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    432/  5000| tot_loss: 2.5183 | rl_loss: 0.8828 | pt_loss: 1.6355 | pg_loss: 0.2903 | reg_loss: 0.5925 | reward: -0.4902 | rev_kl: 1.1510 | stu_lens: 96.2500 | mixed_lens: 92.4531 | lr: 4.9443e-06 | scale: 2048.00 | time: 26.286 | step time: 27.560
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    433/  5000| tot_loss: 4.1442 | rl_loss: 2.0906 | pt_loss: 2.0536 | pg_loss: 0.9155 | reg_loss: 1.1751 | reward: -0.2273 | rev_kl: 0.9121 | stu_lens: 31.5000 | mixed_lens: 39.5000 | lr: 4.9439e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    434/  5000| tot_loss: 2.7445 | rl_loss: 0.7858 | pt_loss: 1.9586 | pg_loss: 0.2770 | reg_loss: 0.5089 | reward: -0.3727 | rev_kl: 1.3154 | stu_lens: 69.5000 | mixed_lens: 83.5000 | lr: 4.9436e-06 | scale: 2048.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    435/  5000| tot_loss: 2.4868 | rl_loss: 0.5441 | pt_loss: 1.9427 | pg_loss: 0.2145 | reg_loss: 0.3296 | reward: -0.4091 | rev_kl: 0.8402 | stu_lens: 83.0000 | mixed_lens: 94.0000 | lr: 4.9432e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    436/  5000| tot_loss: 2.4612 | rl_loss: 0.9185 | pt_loss: 1.5427 | pg_loss: 0.2314 | reg_loss: 0.6871 | reward: -0.3170 | rev_kl: 1.5315 | stu_lens: 83.5000 | mixed_lens: 77.0000 | lr: 4.9429e-06 | scale: 2048.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    437/  5000| tot_loss: 2.4738 | rl_loss: 0.6310 | pt_loss: 1.8428 | pg_loss: 0.0379 | reg_loss: 0.5930 | reward: -0.1604 | rev_kl: 0.9725 | stu_lens: 87.0000 | mixed_lens: 121.0000 | lr: 4.9426e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    438/  5000| tot_loss: 2.3168 | rl_loss: 0.4690 | pt_loss: 1.8478 | pg_loss: 0.0191 | reg_loss: 0.4498 | reward: -0.4944 | rev_kl: 1.5439 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9422e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    439/  5000| tot_loss: 1.9481 | rl_loss: 0.4732 | pt_loss: 1.4749 | pg_loss: 0.0231 | reg_loss: 0.4501 | reward: -0.1668 | rev_kl: 1.3690 | stu_lens: 67.0000 | mixed_lens: 119.0000 | lr: 4.9419e-06 | scale: 2048.00 | time: 26.349 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    440/  5000| tot_loss: 1.9095 | rl_loss: 0.1090 | pt_loss: 1.8006 | pg_loss: -0.0347 | reg_loss: 0.1437 | reward: -0.3939 | rev_kl: 1.0693 | stu_lens: 102.0000 | mixed_lens: 89.0000 | lr: 4.9415e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    441/  5000| tot_loss: 2.0689 | rl_loss: 0.2609 | pt_loss: 1.8079 | pg_loss: 0.0059 | reg_loss: 0.2551 | reward: -0.1697 | rev_kl: 1.0355 | stu_lens: 107.5000 | mixed_lens: 128.0000 | lr: 4.9412e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    442/  5000| tot_loss: 3.1685 | rl_loss: 0.9947 | pt_loss: 2.1738 | pg_loss: 0.4332 | reg_loss: 0.5616 | reward: -0.5979 | rev_kl: 1.7123 | stu_lens: 82.0000 | mixed_lens: 85.0000 | lr: 4.9408e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    443/  5000| tot_loss: 2.5631 | rl_loss: 0.7754 | pt_loss: 1.7877 | pg_loss: 0.3545 | reg_loss: 0.4209 | reward: -0.9432 | rev_kl: 1.3034 | stu_lens: 44.5000 | mixed_lens: 76.5000 | lr: 4.9405e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    444/  5000| tot_loss: 2.3245 | rl_loss: 0.8255 | pt_loss: 1.4990 | pg_loss: 0.3128 | reg_loss: 0.5127 | reward: -2.2025 | rev_kl: 1.2609 | stu_lens: 78.5000 | mixed_lens: 58.0000 | lr: 4.9401e-06 | scale: 2048.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    445/  5000| tot_loss: 2.3635 | rl_loss: 0.8717 | pt_loss: 1.4918 | pg_loss: 0.4145 | reg_loss: 0.4572 | reward: -0.4224 | rev_kl: 1.0575 | stu_lens: 103.0000 | mixed_lens: 91.5000 | lr: 4.9398e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    446/  5000| tot_loss: 3.3828 | rl_loss: 1.9647 | pt_loss: 1.4182 | pg_loss: 1.0152 | reg_loss: 0.9495 | reward: -0.5434 | rev_kl: 0.8971 | stu_lens: 72.0000 | mixed_lens: 33.0000 | lr: 4.9394e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    447/  5000| tot_loss: 2.5110 | rl_loss: 0.7653 | pt_loss: 1.7457 | pg_loss: 0.1833 | reg_loss: 0.5821 | reward: -0.0896 | rev_kl: 0.9144 | stu_lens: 99.5000 | mixed_lens: 94.5000 | lr: 4.9391e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    448/  5000| tot_loss: 2.5813 | rl_loss: 0.6305 | pt_loss: 1.9508 | pg_loss: 0.1129 | reg_loss: 0.5176 | reward: -0.2843 | rev_kl: 1.1288 | stu_lens: 128.0000 | mixed_lens: 120.5000 | lr: 4.9387e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    448/  5000| tot_loss: 2.5229 | rl_loss: 0.7924 | pt_loss: 1.7305 | pg_loss: 0.2761 | reg_loss: 0.5163 | reward: -0.4868 | rev_kl: 1.1308 | stu_lens: 90.4062 | mixed_lens: 90.7031 | lr: 4.9387e-06 | scale: 2048.00 | time: 26.263 | step time: 27.528
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    449/  5000| tot_loss: 2.5881 | rl_loss: 0.8436 | pt_loss: 1.7445 | pg_loss: 0.1528 | reg_loss: 0.6908 | reward: -0.3320 | rev_kl: 0.8829 | stu_lens: 89.0000 | mixed_lens: 94.0000 | lr: 4.9384e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    450/  5000| tot_loss: 3.5821 | rl_loss: 1.7088 | pt_loss: 1.8733 | pg_loss: 0.0271 | reg_loss: 1.6817 | reward: -0.2359 | rev_kl: 0.6370 | stu_lens: 112.5000 | mixed_lens: 128.0000 | lr: 4.9380e-06 | scale: 2048.00 | time: 26.320 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    451/  5000| tot_loss: 3.3488 | rl_loss: 1.3936 | pt_loss: 1.9552 | pg_loss: 0.1010 | reg_loss: 1.2926 | reward: -0.2889 | rev_kl: 0.5556 | stu_lens: 50.0000 | mixed_lens: 124.0000 | lr: 4.9377e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    452/  5000| tot_loss: 2.6462 | rl_loss: 1.4245 | pt_loss: 1.2217 | pg_loss: 0.2195 | reg_loss: 1.2049 | reward: -0.4166 | rev_kl: 1.1515 | stu_lens: 65.0000 | mixed_lens: 94.0000 | lr: 4.9373e-06 | scale: 2048.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    453/  5000| tot_loss: 3.9956 | rl_loss: 2.0243 | pt_loss: 1.9713 | pg_loss: 0.5128 | reg_loss: 1.5115 | reward: -0.4476 | rev_kl: 1.2760 | stu_lens: 56.0000 | mixed_lens: 75.0000 | lr: 4.9370e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    454/  5000| tot_loss: 2.2852 | rl_loss: 0.9805 | pt_loss: 1.3047 | pg_loss: 0.1317 | reg_loss: 0.8489 | reward: -0.4321 | rev_kl: 1.2056 | stu_lens: 103.0000 | mixed_lens: 101.5000 | lr: 4.9366e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    455/  5000| tot_loss: 2.4870 | rl_loss: 1.0977 | pt_loss: 1.3893 | pg_loss: 0.0841 | reg_loss: 1.0136 | reward: -0.3129 | rev_kl: 1.2683 | stu_lens: 126.0000 | mixed_lens: 128.0000 | lr: 4.9362e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    456/  5000| tot_loss: 4.1988 | rl_loss: 2.4824 | pt_loss: 1.7164 | pg_loss: 1.0033 | reg_loss: 1.4791 | reward: -0.9873 | rev_kl: 0.6178 | stu_lens: 26.0000 | mixed_lens: 48.0000 | lr: 4.9359e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    457/  5000| tot_loss: 2.9482 | rl_loss: 1.1662 | pt_loss: 1.7820 | pg_loss: 0.0308 | reg_loss: 1.1354 | reward: -0.2112 | rev_kl: 1.2196 | stu_lens: 110.0000 | mixed_lens: 128.0000 | lr: 4.9355e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    458/  5000| tot_loss: 3.7246 | rl_loss: 1.8262 | pt_loss: 1.8984 | pg_loss: 0.3508 | reg_loss: 1.4754 | reward: -0.2563 | rev_kl: 1.6935 | stu_lens: 128.0000 | mixed_lens: 87.0000 | lr: 4.9352e-06 | scale: 2048.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    459/  5000| tot_loss: 3.8677 | rl_loss: 1.8657 | pt_loss: 2.0020 | pg_loss: 0.7060 | reg_loss: 1.1597 | reward: -0.0762 | rev_kl: 0.6769 | stu_lens: 81.0000 | mixed_lens: 48.0000 | lr: 4.9348e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    460/  5000| tot_loss: 2.8436 | rl_loss: 1.3363 | pt_loss: 1.5072 | pg_loss: 0.0285 | reg_loss: 1.3078 | reward: -0.2237 | rev_kl: 1.4166 | stu_lens: 80.5000 | mixed_lens: 128.0000 | lr: 4.9344e-06 | scale: 2048.00 | time: 26.353 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    461/  5000| tot_loss: 3.5954 | rl_loss: 1.8459 | pt_loss: 1.7495 | pg_loss: 0.6469 | reg_loss: 1.1990 | reward: -0.9341 | rev_kl: 0.9144 | stu_lens: 66.0000 | mixed_lens: 48.5000 | lr: 4.9341e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    462/  5000| tot_loss: 2.8456 | rl_loss: 1.1415 | pt_loss: 1.7041 | pg_loss: 0.0974 | reg_loss: 1.0441 | reward: -0.2264 | rev_kl: 1.2296 | stu_lens: 102.0000 | mixed_lens: 117.0000 | lr: 4.9337e-06 | scale: 2048.00 | time: 26.378 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    463/  5000| tot_loss: 3.6929 | rl_loss: 2.0300 | pt_loss: 1.6630 | pg_loss: 0.6907 | reg_loss: 1.3393 | reward: -0.6375 | rev_kl: 1.5221 | stu_lens: 89.0000 | mixed_lens: 57.0000 | lr: 4.9333e-06 | scale: 2048.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    464/  5000| tot_loss: 3.6638 | rl_loss: 1.6779 | pt_loss: 1.9859 | pg_loss: 0.3403 | reg_loss: 1.3376 | reward: -0.3845 | rev_kl: 1.5313 | stu_lens: 111.0000 | mixed_lens: 91.0000 | lr: 4.9330e-06 | scale: 2048.00 | time: 26.314 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    464/  5000| tot_loss: 3.2682 | rl_loss: 1.5811 | pt_loss: 1.6871 | pg_loss: 0.3585 | reg_loss: 1.2226 | reward: -0.4035 | rev_kl: 1.1411 | stu_lens: 91.0000 | mixed_lens: 91.6719 | lr: 4.9330e-06 | scale: 2048.00 | time: 26.314 | step time: 27.562
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    465/  5000| tot_loss: 3.8126 | rl_loss: 1.9506 | pt_loss: 1.8620 | pg_loss: 0.3373 | reg_loss: 1.6133 | reward: 0.1652 | rev_kl: 1.0218 | stu_lens: 81.0000 | mixed_lens: 34.5000 | lr: 4.9326e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    466/  5000| tot_loss: 2.2437 | rl_loss: 0.6931 | pt_loss: 1.5506 | pg_loss: 0.0847 | reg_loss: 0.6084 | reward: -0.3920 | rev_kl: 1.0945 | stu_lens: 90.0000 | mixed_lens: 88.5000 | lr: 4.9322e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    467/  5000| tot_loss: 2.9431 | rl_loss: 1.4598 | pt_loss: 1.4833 | pg_loss: 0.3065 | reg_loss: 1.1532 | reward: -0.2895 | rev_kl: 1.0199 | stu_lens: 108.0000 | mixed_lens: 89.5000 | lr: 4.9319e-06 | scale: 2048.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    468/  5000| tot_loss: 3.6366 | rl_loss: 1.7120 | pt_loss: 1.9246 | pg_loss: 0.5542 | reg_loss: 1.1578 | reward: -1.0020 | rev_kl: 1.1768 | stu_lens: 36.5000 | mixed_lens: 72.5000 | lr: 4.9315e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    469/  5000| tot_loss: 3.1122 | rl_loss: 1.0350 | pt_loss: 2.0772 | pg_loss: 0.2076 | reg_loss: 0.8274 | reward: -0.2685 | rev_kl: 1.6383 | stu_lens: 114.0000 | mixed_lens: 97.5000 | lr: 4.9311e-06 | scale: 2048.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    470/  5000| tot_loss: 2.9735 | rl_loss: 1.1689 | pt_loss: 1.8046 | pg_loss: 0.0739 | reg_loss: 1.0950 | reward: -0.1863 | rev_kl: 1.6329 | stu_lens: 64.0000 | mixed_lens: 117.5000 | lr: 4.9307e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    471/  5000| tot_loss: 2.2959 | rl_loss: 0.8262 | pt_loss: 1.4696 | pg_loss: 0.0615 | reg_loss: 0.7647 | reward: -0.1649 | rev_kl: 1.3652 | stu_lens: 128.0000 | mixed_lens: 108.5000 | lr: 4.9304e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    472/  5000| tot_loss: 2.8637 | rl_loss: 1.1300 | pt_loss: 1.7337 | pg_loss: 0.2615 | reg_loss: 0.8685 | reward: -0.4044 | rev_kl: 1.2560 | stu_lens: 83.5000 | mixed_lens: 84.0000 | lr: 4.9300e-06 | scale: 2048.00 | time: 26.348 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    473/  5000| tot_loss: 1.8733 | rl_loss: 0.4381 | pt_loss: 1.4352 | pg_loss: 0.1254 | reg_loss: 0.3126 | reward: -0.0183 | rev_kl: 0.6145 | stu_lens: 94.0000 | mixed_lens: 106.5000 | lr: 4.9296e-06 | scale: 2048.00 | time: 26.320 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    474/  5000| tot_loss: 3.2944 | rl_loss: 1.4690 | pt_loss: 1.8253 | pg_loss: 0.9323 | reg_loss: 0.5368 | reward: -0.7553 | rev_kl: 1.2814 | stu_lens: 75.5000 | mixed_lens: 35.5000 | lr: 4.9292e-06 | scale: 2048.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    475/  5000| tot_loss: 2.3991 | rl_loss: 0.5359 | pt_loss: 1.8632 | pg_loss: -0.0061 | reg_loss: 0.5420 | reward: -0.1912 | rev_kl: 0.5692 | stu_lens: 110.0000 | mixed_lens: 128.0000 | lr: 4.9289e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    476/  5000| tot_loss: 3.7393 | rl_loss: 1.5749 | pt_loss: 2.1644 | pg_loss: 0.6630 | reg_loss: 0.9119 | reward: -0.6870 | rev_kl: 1.5625 | stu_lens: 125.0000 | mixed_lens: 52.0000 | lr: 4.9285e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    477/  5000| tot_loss: 2.9300 | rl_loss: 0.8657 | pt_loss: 2.0643 | pg_loss: 0.1510 | reg_loss: 0.7147 | reward: -0.4350 | rev_kl: 1.3265 | stu_lens: 118.5000 | mixed_lens: 100.0000 | lr: 4.9281e-06 | scale: 2048.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    478/  5000| tot_loss: 2.7559 | rl_loss: 1.0187 | pt_loss: 1.7372 | pg_loss: 0.1121 | reg_loss: 0.9066 | reward: -0.3653 | rev_kl: 1.5064 | stu_lens: 102.0000 | mixed_lens: 117.0000 | lr: 4.9277e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    479/  5000| tot_loss: 3.0268 | rl_loss: 1.2050 | pt_loss: 1.8218 | pg_loss: 0.1772 | reg_loss: 1.0278 | reward: -0.4331 | rev_kl: 1.2429 | stu_lens: 97.0000 | mixed_lens: 99.5000 | lr: 4.9273e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    480/  5000| tot_loss: 3.9293 | rl_loss: 1.9253 | pt_loss: 2.0040 | pg_loss: 0.8831 | reg_loss: 1.0422 | reward: -0.0382 | rev_kl: 1.0560 | stu_lens: 81.0000 | mixed_lens: 45.5000 | lr: 4.9269e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    480/  5000| tot_loss: 2.9701 | rl_loss: 1.1913 | pt_loss: 1.7789 | pg_loss: 0.3429 | reg_loss: 0.8484 | reward: -0.3907 | rev_kl: 1.1469 | stu_lens: 92.2812 | mixed_lens: 87.2656 | lr: 4.9269e-06 | scale: 2048.00 | time: 26.276 | step time: 27.548
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    481/  5000| tot_loss: 2.1320 | rl_loss: 0.7399 | pt_loss: 1.3921 | pg_loss: 0.1535 | reg_loss: 0.5864 | reward: -0.4158 | rev_kl: 1.2877 | stu_lens: 101.5000 | mixed_lens: 93.5000 | lr: 4.9266e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    482/  5000| tot_loss: 3.0020 | rl_loss: 1.2461 | pt_loss: 1.7558 | pg_loss: 0.7386 | reg_loss: 0.5075 | reward: -0.6178 | rev_kl: 1.2974 | stu_lens: 91.0000 | mixed_lens: 50.0000 | lr: 4.9262e-06 | scale: 2048.00 | time: 26.370 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    483/  5000| tot_loss: 2.9003 | rl_loss: 0.8253 | pt_loss: 2.0751 | pg_loss: 0.2580 | reg_loss: 0.5673 | reward: -0.5012 | rev_kl: 2.2006 | stu_lens: 88.5000 | mixed_lens: 94.5000 | lr: 4.9258e-06 | scale: 2048.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    484/  5000| tot_loss: 2.7644 | rl_loss: 0.9908 | pt_loss: 1.7737 | pg_loss: 0.3238 | reg_loss: 0.6669 | reward: -0.2093 | rev_kl: 1.0430 | stu_lens: 88.5000 | mixed_lens: 86.0000 | lr: 4.9254e-06 | scale: 2048.00 | time: 26.343 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    485/  5000| tot_loss: 2.7111 | rl_loss: 1.0615 | pt_loss: 1.6497 | pg_loss: 0.3470 | reg_loss: 0.7145 | reward: -0.4010 | rev_kl: 1.2620 | stu_lens: 82.0000 | mixed_lens: 89.5000 | lr: 4.9250e-06 | scale: 2048.00 | time: 26.358 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    486/  5000| tot_loss: 3.0488 | rl_loss: 1.1272 | pt_loss: 1.9216 | pg_loss: 0.5041 | reg_loss: 0.6231 | reward: -0.3934 | rev_kl: 1.5078 | stu_lens: 124.5000 | mixed_lens: 64.5000 | lr: 4.9246e-06 | scale: 2048.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    487/  5000| tot_loss: 2.2908 | rl_loss: 0.5735 | pt_loss: 1.7174 | pg_loss: 0.2711 | reg_loss: 0.3023 | reward: -0.1002 | rev_kl: 0.8479 | stu_lens: 81.0000 | mixed_lens: 78.5000 | lr: 4.9242e-06 | scale: 2048.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    488/  5000| tot_loss: 2.4178 | rl_loss: 0.8450 | pt_loss: 1.5729 | pg_loss: 0.3405 | reg_loss: 0.5045 | reward: -0.5268 | rev_kl: 1.0673 | stu_lens: 76.0000 | mixed_lens: 91.0000 | lr: 4.9238e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    489/  5000| tot_loss: 2.4861 | rl_loss: 0.5107 | pt_loss: 1.9754 | pg_loss: 0.0801 | reg_loss: 0.4306 | reward: -0.3332 | rev_kl: 1.3098 | stu_lens: 112.0000 | mixed_lens: 105.5000 | lr: 4.9234e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    490/  5000| tot_loss: 2.2524 | rl_loss: 1.0453 | pt_loss: 1.2071 | pg_loss: 0.2211 | reg_loss: 0.8241 | reward: -1.0437 | rev_kl: 1.6102 | stu_lens: 74.0000 | mixed_lens: 81.5000 | lr: 4.9230e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    491/  5000| tot_loss: 2.1243 | rl_loss: 0.4458 | pt_loss: 1.6785 | pg_loss: 0.0200 | reg_loss: 0.4258 | reward: -0.3371 | rev_kl: 0.7888 | stu_lens: 93.0000 | mixed_lens: 128.0000 | lr: 4.9226e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    492/  5000| tot_loss: 2.5768 | rl_loss: 0.8210 | pt_loss: 1.7559 | pg_loss: 0.1437 | reg_loss: 0.6772 | reward: -0.3681 | rev_kl: 1.1154 | stu_lens: 106.0000 | mixed_lens: 116.5000 | lr: 4.9223e-06 | scale: 2048.00 | time: 26.357 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    493/  5000| tot_loss: 2.3609 | rl_loss: 0.6534 | pt_loss: 1.7075 | pg_loss: 0.0276 | reg_loss: 0.6257 | reward: -0.2269 | rev_kl: 0.8157 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9219e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    494/  5000| tot_loss: 1.7075 | rl_loss: 0.4348 | pt_loss: 1.2727 | pg_loss: 0.1436 | reg_loss: 0.2912 | reward: -0.2421 | rev_kl: 0.9892 | stu_lens: 84.5000 | mixed_lens: 101.0000 | lr: 4.9215e-06 | scale: 2048.00 | time: 26.344 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    495/  5000| tot_loss: 2.8630 | rl_loss: 0.5325 | pt_loss: 2.3305 | pg_loss: 0.0324 | reg_loss: 0.5001 | reward: -0.3894 | rev_kl: 1.3443 | stu_lens: 124.5000 | mixed_lens: 121.5000 | lr: 4.9211e-06 | scale: 2048.00 | time: 26.315 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    496/  5000| tot_loss: 2.1420 | rl_loss: 0.7944 | pt_loss: 1.3476 | pg_loss: 0.2372 | reg_loss: 0.5571 | reward: -0.5852 | rev_kl: 1.2164 | stu_lens: 110.0000 | mixed_lens: 89.0000 | lr: 4.9207e-06 | scale: 2048.00 | time: 26.387 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    496/  5000| tot_loss: 2.5306 | rl_loss: 0.8479 | pt_loss: 1.6828 | pg_loss: 0.2925 | reg_loss: 0.5554 | reward: -0.3953 | rev_kl: 1.1649 | stu_lens: 95.2344 | mixed_lens: 90.6875 | lr: 4.9207e-06 | scale: 2048.00 | time: 26.387 | step time: 27.580
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    497/  5000| tot_loss: 2.4916 | rl_loss: 0.7072 | pt_loss: 1.7844 | pg_loss: 0.1412 | reg_loss: 0.5660 | reward: -0.2584 | rev_kl: 1.4045 | stu_lens: 54.0000 | mixed_lens: 113.0000 | lr: 4.9203e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    498/  5000| tot_loss: 2.5878 | rl_loss: 0.9954 | pt_loss: 1.5924 | pg_loss: 0.4491 | reg_loss: 0.5463 | reward: -0.6285 | rev_kl: 1.5680 | stu_lens: 103.0000 | mixed_lens: 65.5000 | lr: 4.9199e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    499/  5000| tot_loss: 2.3399 | rl_loss: 0.8452 | pt_loss: 1.4947 | pg_loss: 0.3659 | reg_loss: 0.4793 | reward: -0.2570 | rev_kl: 0.9988 | stu_lens: 96.0000 | mixed_lens: 87.0000 | lr: 4.9195e-06 | scale: 2048.00 | time: 26.332 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/500
                                 Evaluation #5                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Bob should leave Alice. He has a 31% │
│                                       │ chance of survival if he stays with  │
│                                       │ Alice. But if he leaves Alice, he    │
│                                       │ has a 9% chance of survival. The 9%  │
│                                       │ chance of survival is better than    │
│                                       │ the 31% chance of survival. So Bob   │
│                                       │ should leave Alice.                  │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ mz kezboard tzpe z because z is the  │
│                                       │ last letter in the alphabet and mz   │
│                                       │ kezboard starts with mz. a is the    │
│                                       │ first letter in the alphabet and y   │
│                                       │ is the last letter in the alphabet.  │
│                                       │ so y comes before a.                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support 17 languages.             │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.192 | exact_match: 0.215 | rev_kl: 1.420 | lens: 85.159 | pt_loss: 1.092 | lm_loss: 1.184 | kd_loss: 1.001 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    500/  5000| tot_loss: 2.2584 | rl_loss: 0.6531 | pt_loss: 1.6053 | pg_loss: 0.2286 | reg_loss: 0.4245 | reward: -0.3870 | rev_kl: 0.7902 | stu_lens: 106.5000 | mixed_lens: 95.0000 | lr: 4.9190e-06 | scale: 2048.00 | time: 26.341 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    501/  5000| tot_loss: 2.9674 | rl_loss: 1.1594 | pt_loss: 1.8080 | pg_loss: 0.5998 | reg_loss: 0.5595 | reward: -0.2604 | rev_kl: 0.9835 | stu_lens: 80.0000 | mixed_lens: 40.5000 | lr: 4.9186e-06 | scale: 2048.00 | time: 26.370 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    502/  5000| tot_loss: 2.3341 | rl_loss: 1.0321 | pt_loss: 1.3021 | pg_loss: 0.6163 | reg_loss: 0.4158 | reward: -1.0846 | rev_kl: 1.2360 | stu_lens: 66.5000 | mixed_lens: 54.5000 | lr: 4.9182e-06 | scale: 2048.00 | time: 26.317 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    503/  5000| tot_loss: 2.4621 | rl_loss: 0.7907 | pt_loss: 1.6714 | pg_loss: 0.2183 | reg_loss: 0.5724 | reward: -0.6949 | rev_kl: 1.2730 | stu_lens: 99.5000 | mixed_lens: 102.0000 | lr: 4.9178e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    504/  5000| tot_loss: 2.1780 | rl_loss: 0.4423 | pt_loss: 1.7357 | pg_loss: 0.1500 | reg_loss: 0.2923 | reward: -0.3627 | rev_kl: 0.8928 | stu_lens: 128.0000 | mixed_lens: 101.5000 | lr: 4.9174e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    505/  5000| tot_loss: 2.3894 | rl_loss: 0.5162 | pt_loss: 1.8732 | pg_loss: 0.2363 | reg_loss: 0.2799 | reward: -0.4573 | rev_kl: 2.1200 | stu_lens: 68.5000 | mixed_lens: 94.0000 | lr: 4.9170e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    506/  5000| tot_loss: 2.4207 | rl_loss: 0.5677 | pt_loss: 1.8530 | pg_loss: 0.0776 | reg_loss: 0.4901 | reward: -0.3441 | rev_kl: 0.5539 | stu_lens: 112.5000 | mixed_lens: 99.5000 | lr: 4.9166e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    507/  5000| tot_loss: 2.4029 | rl_loss: 0.8661 | pt_loss: 1.5368 | pg_loss: 0.2351 | reg_loss: 0.6310 | reward: -0.2862 | rev_kl: 1.0681 | stu_lens: 97.0000 | mixed_lens: 87.5000 | lr: 4.9162e-06 | scale: 2048.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    508/  5000| tot_loss: 1.9578 | rl_loss: 0.4249 | pt_loss: 1.5328 | pg_loss: 0.0998 | reg_loss: 0.3251 | reward: -0.4400 | rev_kl: 0.9594 | stu_lens: 108.5000 | mixed_lens: 100.0000 | lr: 4.9158e-06 | scale: 2048.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    509/  5000| tot_loss: 2.4077 | rl_loss: 0.4697 | pt_loss: 1.9380 | pg_loss: 0.0716 | reg_loss: 0.3982 | reward: -0.1696 | rev_kl: 1.6159 | stu_lens: 68.0000 | mixed_lens: 117.0000 | lr: 4.9154e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    510/  5000| tot_loss: 2.1870 | rl_loss: 0.4616 | pt_loss: 1.7254 | pg_loss: 0.0944 | reg_loss: 0.3672 | reward: -0.2975 | rev_kl: 0.5996 | stu_lens: 70.5000 | mixed_lens: 120.0000 | lr: 4.9150e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    511/  5000| tot_loss: 2.9829 | rl_loss: 1.2142 | pt_loss: 1.7688 | pg_loss: 0.5182 | reg_loss: 0.6960 | reward: -0.0444 | rev_kl: 0.8641 | stu_lens: 81.0000 | mixed_lens: 78.5000 | lr: 4.9145e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    512/  5000| tot_loss: 2.1105 | rl_loss: 0.5699 | pt_loss: 1.5405 | pg_loss: 0.1606 | reg_loss: 0.4093 | reward: -0.4234 | rev_kl: 1.2368 | stu_lens: 97.5000 | mixed_lens: 100.0000 | lr: 4.9141e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    512/  5000| tot_loss: 2.3950 | rl_loss: 0.7142 | pt_loss: 1.6808 | pg_loss: 0.2706 | reg_loss: 0.4435 | reward: -0.4087 | rev_kl: 1.1267 | stu_lens: 91.3750 | mixed_lens: 91.2188 | lr: 4.9141e-06 | scale: 2048.00 | time: 26.304 | step time: 27.567
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    513/  5000| tot_loss: 2.3287 | rl_loss: 0.4064 | pt_loss: 1.9223 | pg_loss: -0.0084 | reg_loss: 0.4148 | reward: -0.2122 | rev_kl: 1.0795 | stu_lens: 126.0000 | mixed_lens: 128.0000 | lr: 4.9137e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    514/  5000| tot_loss: 2.1828 | rl_loss: 1.0294 | pt_loss: 1.1534 | pg_loss: 0.0506 | reg_loss: 0.9788 | reward: -0.0805 | rev_kl: 1.1629 | stu_lens: 118.0000 | mixed_lens: 128.0000 | lr: 4.9133e-06 | scale: 2048.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    515/  5000| tot_loss: 3.7137 | rl_loss: 1.9527 | pt_loss: 1.7610 | pg_loss: 0.4497 | reg_loss: 1.5030 | reward: -0.5064 | rev_kl: 0.9610 | stu_lens: 72.0000 | mixed_lens: 71.0000 | lr: 4.9129e-06 | scale: 2048.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    516/  5000| tot_loss: 3.2520 | rl_loss: 1.5493 | pt_loss: 1.7026 | pg_loss: 0.0418 | reg_loss: 1.5075 | reward: -0.5232 | rev_kl: 1.1446 | stu_lens: 126.0000 | mixed_lens: 128.0000 | lr: 4.9124e-06 | scale: 2048.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    517/  5000| tot_loss: 3.9695 | rl_loss: 2.2691 | pt_loss: 1.7004 | pg_loss: 0.6173 | reg_loss: 1.6517 | reward: 1.2000 | rev_kl: 2.0048 | stu_lens: 65.5000 | mixed_lens: 39.5000 | lr: 4.9120e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    518/  5000| tot_loss: 3.4191 | rl_loss: 1.8776 | pt_loss: 1.5415 | pg_loss: 0.3644 | reg_loss: 1.5131 | reward: -0.3730 | rev_kl: 1.0680 | stu_lens: 126.5000 | mixed_lens: 85.5000 | lr: 4.9116e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    519/  5000| tot_loss: 2.8685 | rl_loss: 0.8121 | pt_loss: 2.0565 | pg_loss: 0.0336 | reg_loss: 0.7785 | reward: -0.1513 | rev_kl: 0.9100 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9112e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    520/  5000| tot_loss: 3.2032 | rl_loss: 1.9454 | pt_loss: 1.2577 | pg_loss: 0.3257 | reg_loss: 1.6197 | reward: -0.7541 | rev_kl: 1.9021 | stu_lens: 106.0000 | mixed_lens: 97.5000 | lr: 4.9108e-06 | scale: 2048.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    521/  5000| tot_loss: 3.2072 | rl_loss: 1.4618 | pt_loss: 1.7453 | pg_loss: 0.1497 | reg_loss: 1.3121 | reward: -0.4173 | rev_kl: 1.2160 | stu_lens: 102.5000 | mixed_lens: 116.0000 | lr: 4.9103e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    522/  5000| tot_loss: 2.8445 | rl_loss: 1.6145 | pt_loss: 1.2300 | pg_loss: 0.6266 | reg_loss: 0.9879 | reward: -0.4032 | rev_kl: 0.6287 | stu_lens: 82.0000 | mixed_lens: 70.0000 | lr: 4.9099e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    523/  5000| tot_loss: 2.8403 | rl_loss: 1.0300 | pt_loss: 1.8103 | pg_loss: 0.0678 | reg_loss: 0.9622 | reward: -0.2277 | rev_kl: 1.3632 | stu_lens: 109.0000 | mixed_lens: 128.0000 | lr: 4.9095e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    524/  5000| tot_loss: 2.0048 | rl_loss: 0.5352 | pt_loss: 1.4695 | pg_loss: 0.1548 | reg_loss: 0.3805 | reward: -0.1945 | rev_kl: 1.0273 | stu_lens: 80.0000 | mixed_lens: 83.0000 | lr: 4.9091e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    525/  5000| tot_loss: 2.9629 | rl_loss: 1.5045 | pt_loss: 1.4584 | pg_loss: 0.0479 | reg_loss: 1.4566 | reward: -0.3663 | rev_kl: 1.5452 | stu_lens: 89.0000 | mixed_lens: 127.5000 | lr: 4.9086e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    526/  5000| tot_loss: 3.1775 | rl_loss: 1.0471 | pt_loss: 2.1304 | pg_loss: 0.0973 | reg_loss: 0.9498 | reward: -0.1771 | rev_kl: 0.5856 | stu_lens: 81.0000 | mixed_lens: 27.0000 | lr: 4.9082e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    527/  5000| tot_loss: 3.1523 | rl_loss: 1.7697 | pt_loss: 1.3826 | pg_loss: 0.2787 | reg_loss: 1.4910 | reward: -0.4160 | rev_kl: 0.9661 | stu_lens: 108.0000 | mixed_lens: 101.0000 | lr: 4.9078e-06 | scale: 2048.00 | time: 26.314 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    528/  5000| tot_loss: 3.5948 | rl_loss: 1.9292 | pt_loss: 1.6657 | pg_loss: 0.5597 | reg_loss: 1.3694 | reward: -1.2513 | rev_kl: 0.9666 | stu_lens: 72.5000 | mixed_lens: 69.0000 | lr: 4.9073e-06 | scale: 2048.00 | time: 26.336 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    528/  5000| tot_loss: 3.2122 | rl_loss: 1.5337 | pt_loss: 1.6785 | pg_loss: 0.3085 | reg_loss: 1.2252 | reward: -0.4117 | rev_kl: 1.1682 | stu_lens: 97.1406 | mixed_lens: 91.3438 | lr: 4.9073e-06 | scale: 2048.00 | time: 26.336 | step time: 27.569
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    529/  5000| tot_loss: 3.1691 | rl_loss: 1.4181 | pt_loss: 1.7510 | pg_loss: 0.2623 | reg_loss: 1.1558 | reward: -0.3306 | rev_kl: 1.2816 | stu_lens: 110.5000 | mixed_lens: 97.0000 | lr: 4.9069e-06 | scale: 2048.00 | time: 26.349 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    530/  5000| tot_loss: 3.0087 | rl_loss: 0.9363 | pt_loss: 2.0724 | pg_loss: 0.1498 | reg_loss: 0.7865 | reward: -0.2778 | rev_kl: 0.9068 | stu_lens: 128.0000 | mixed_lens: 102.0000 | lr: 4.9065e-06 | scale: 2048.00 | time: 26.352 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    531/  5000| tot_loss: 2.9645 | rl_loss: 1.2877 | pt_loss: 1.6768 | pg_loss: 0.4132 | reg_loss: 0.8745 | reward: -0.5691 | rev_kl: 0.7802 | stu_lens: 42.0000 | mixed_lens: 73.5000 | lr: 4.9060e-06 | scale: 2048.00 | time: 26.355 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    532/  5000| tot_loss: 3.1456 | rl_loss: 1.1989 | pt_loss: 1.9467 | pg_loss: 0.5402 | reg_loss: 0.6587 | reward: -0.8224 | rev_kl: 0.7842 | stu_lens: 66.5000 | mixed_lens: 66.5000 | lr: 4.9056e-06 | scale: 2048.00 | time: 26.349 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    533/  5000| tot_loss: 2.7690 | rl_loss: 0.7143 | pt_loss: 2.0547 | pg_loss: 0.0106 | reg_loss: 0.7037 | reward: -0.1356 | rev_kl: 1.2238 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9052e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    534/  5000| tot_loss: 2.9728 | rl_loss: 1.2557 | pt_loss: 1.7172 | pg_loss: 0.3697 | reg_loss: 0.8860 | reward: -0.3868 | rev_kl: 1.0050 | stu_lens: 90.5000 | mixed_lens: 78.0000 | lr: 4.9047e-06 | scale: 2048.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    535/  5000| tot_loss: 2.8048 | rl_loss: 0.8815 | pt_loss: 1.9233 | pg_loss: 0.0683 | reg_loss: 0.8132 | reward: -0.4348 | rev_kl: 0.9887 | stu_lens: 125.0000 | mixed_lens: 116.5000 | lr: 4.9043e-06 | scale: 2048.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    536/  5000| tot_loss: 2.6710 | rl_loss: 0.9326 | pt_loss: 1.7384 | pg_loss: 0.2876 | reg_loss: 0.6450 | reward: -0.3763 | rev_kl: 1.4533 | stu_lens: 54.5000 | mixed_lens: 83.0000 | lr: 4.9038e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    537/  5000| tot_loss: 2.8625 | rl_loss: 0.9824 | pt_loss: 1.8801 | pg_loss: 0.2135 | reg_loss: 0.7688 | reward: -0.3583 | rev_kl: 0.7913 | stu_lens: 125.0000 | mixed_lens: 99.5000 | lr: 4.9034e-06 | scale: 2048.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    538/  5000| tot_loss: 2.8520 | rl_loss: 1.0979 | pt_loss: 1.7541 | pg_loss: 0.3500 | reg_loss: 0.7479 | reward: -0.7219 | rev_kl: 1.7289 | stu_lens: 106.0000 | mixed_lens: 87.0000 | lr: 4.9030e-06 | scale: 2048.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    539/  5000| tot_loss: 2.7518 | rl_loss: 0.8310 | pt_loss: 1.9208 | pg_loss: 0.2509 | reg_loss: 0.5801 | reward: -0.2202 | rev_kl: 1.2224 | stu_lens: 127.0000 | mixed_lens: 89.5000 | lr: 4.9025e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    540/  5000| tot_loss: 2.8863 | rl_loss: 0.9689 | pt_loss: 1.9175 | pg_loss: 0.2224 | reg_loss: 0.7464 | reward: -0.2230 | rev_kl: 0.6022 | stu_lens: 104.0000 | mixed_lens: 99.5000 | lr: 4.9021e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    541/  5000| tot_loss: 2.1881 | rl_loss: 0.3341 | pt_loss: 1.8540 | pg_loss: 0.0270 | reg_loss: 0.3071 | reward: -0.2584 | rev_kl: 1.0935 | stu_lens: 94.0000 | mixed_lens: 128.0000 | lr: 4.9016e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    542/  5000| tot_loss: 2.8717 | rl_loss: 1.0939 | pt_loss: 1.7778 | pg_loss: 0.1574 | reg_loss: 0.9365 | reward: -0.5024 | rev_kl: 1.0425 | stu_lens: 128.0000 | mixed_lens: 102.5000 | lr: 4.9012e-06 | scale: 2048.00 | time: 26.347 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    543/  5000| tot_loss: 3.4445 | rl_loss: 1.6911 | pt_loss: 1.7533 | pg_loss: 0.9913 | reg_loss: 0.6998 | reward: -0.7495 | rev_kl: 1.5181 | stu_lens: 34.0000 | mixed_lens: 38.0000 | lr: 4.9007e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    544/  5000| tot_loss: 2.9919 | rl_loss: 0.9604 | pt_loss: 2.0315 | pg_loss: 0.0953 | reg_loss: 0.8651 | reward: -0.0600 | rev_kl: 1.1886 | stu_lens: 96.5000 | mixed_lens: 114.5000 | lr: 4.9003e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    544/  5000| tot_loss: 2.8419 | rl_loss: 0.9952 | pt_loss: 1.8467 | pg_loss: 0.2068 | reg_loss: 0.7884 | reward: -0.4626 | rev_kl: 1.1508 | stu_lens: 102.2344 | mixed_lens: 96.9062 | lr: 4.9003e-06 | scale: 2048.00 | time: 26.306 | step time: 27.579
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    545/  5000| tot_loss: 3.8905 | rl_loss: 2.1204 | pt_loss: 1.7701 | pg_loss: 1.1005 | reg_loss: 1.0199 | reward: 1.2105 | rev_kl: 1.9877 | stu_lens: 55.5000 | mixed_lens: 20.0000 | lr: 4.8998e-06 | scale: 2048.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    546/  5000| tot_loss: 2.4041 | rl_loss: 0.7936 | pt_loss: 1.6105 | pg_loss: 0.2449 | reg_loss: 0.5487 | reward: -0.2508 | rev_kl: 1.4021 | stu_lens: 80.0000 | mixed_lens: 83.0000 | lr: 4.8994e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    547/  5000| tot_loss: 1.9429 | rl_loss: 0.4570 | pt_loss: 1.4859 | pg_loss: 0.2177 | reg_loss: 0.2393 | reward: -0.3318 | rev_kl: 1.2328 | stu_lens: 67.0000 | mixed_lens: 92.0000 | lr: 4.8989e-06 | scale: 2048.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    548/  5000| tot_loss: 2.7374 | rl_loss: 1.3651 | pt_loss: 1.3724 | pg_loss: 0.9216 | reg_loss: 0.4435 | reward: 0.1217 | rev_kl: 1.5303 | stu_lens: 75.0000 | mixed_lens: 48.5000 | lr: 4.8985e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    549/  5000| tot_loss: 2.0958 | rl_loss: 0.6212 | pt_loss: 1.4745 | pg_loss: 0.1640 | reg_loss: 0.4572 | reward: -0.1360 | rev_kl: 0.8106 | stu_lens: 104.0000 | mixed_lens: 99.5000 | lr: 4.8980e-06 | scale: 2048.00 | time: 26.216 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    550/  5000| tot_loss: 2.2854 | rl_loss: 0.7173 | pt_loss: 1.5681 | pg_loss: 0.1902 | reg_loss: 0.5271 | reward: -0.3559 | rev_kl: 1.4065 | stu_lens: 128.0000 | mixed_lens: 107.0000 | lr: 4.8976e-06 | scale: 2048.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    551/  5000| tot_loss: 2.1114 | rl_loss: 0.4883 | pt_loss: 1.6231 | pg_loss: 0.0147 | reg_loss: 0.4736 | reward: -0.1595 | rev_kl: 1.0284 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8971e-06 | scale: 2048.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    552/  5000| tot_loss: 3.0919 | rl_loss: 0.8853 | pt_loss: 2.2067 | pg_loss: 0.2940 | reg_loss: 0.5913 | reward: -0.5257 | rev_kl: 0.5049 | stu_lens: 81.0000 | mixed_lens: 74.0000 | lr: 4.8967e-06 | scale: 2048.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    553/  5000| tot_loss: 2.7292 | rl_loss: 0.9535 | pt_loss: 1.7757 | pg_loss: 0.4412 | reg_loss: 0.5123 | reward: -0.3749 | rev_kl: 0.7211 | stu_lens: 102.5000 | mixed_lens: 79.0000 | lr: 4.8962e-06 | scale: 2048.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    554/  5000| tot_loss: 2.4128 | rl_loss: 0.7127 | pt_loss: 1.7001 | pg_loss: 0.0567 | reg_loss: 0.6560 | reward: -0.3773 | rev_kl: 1.1856 | stu_lens: 128.0000 | mixed_lens: 120.0000 | lr: 4.8958e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    555/  5000| tot_loss: 2.9453 | rl_loss: 0.9438 | pt_loss: 2.0015 | pg_loss: 0.2538 | reg_loss: 0.6900 | reward: -0.6078 | rev_kl: 1.1758 | stu_lens: 89.0000 | mixed_lens: 102.0000 | lr: 4.8953e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    556/  5000| tot_loss: 2.3588 | rl_loss: 0.4753 | pt_loss: 1.8835 | pg_loss: 0.0221 | reg_loss: 0.4531 | reward: -0.1419 | rev_kl: 1.0344 | stu_lens: 123.5000 | mixed_lens: 127.0000 | lr: 4.8948e-06 | scale: 2048.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    557/  5000| tot_loss: 2.4762 | rl_loss: 0.6906 | pt_loss: 1.7856 | pg_loss: 0.2498 | reg_loss: 0.4408 | reward: -0.3881 | rev_kl: 1.1096 | stu_lens: 107.5000 | mixed_lens: 85.5000 | lr: 4.8944e-06 | scale: 2048.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    558/  5000| tot_loss: 3.0900 | rl_loss: 0.9555 | pt_loss: 2.1345 | pg_loss: 0.2279 | reg_loss: 0.7277 | reward: -0.3908 | rev_kl: 1.1596 | stu_lens: 126.5000 | mixed_lens: 85.5000 | lr: 4.8939e-06 | scale: 2048.00 | time: 26.250 | step time: 0.000
[2023-12-18 21:17:54,277] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, but hysteresis is 3. Reducing hysteresis to 2
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    559/  5000| tot_loss: 2.8948 | rl_loss: 1.4628 | pt_loss: 1.4319 | pg_loss: 0.9050 | reg_loss: 0.5578 | reward: 1.2105 | rev_kl: 1.9877 | stu_lens: 55.5000 | mixed_lens: 20.0000 | lr: 4.8939e-06 | scale: 2048.00 | time: 2.834 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    560/  5000| tot_loss: 2.6706 | rl_loss: 1.0323 | pt_loss: 1.6383 | pg_loss: 0.4125 | reg_loss: 0.6197 | reward: -1.3522 | rev_kl: 0.8068 | stu_lens: 72.5000 | mixed_lens: 69.0000 | lr: 4.8935e-06 | scale: 2048.00 | time: 26.217 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    560/  5000| tot_loss: 2.6899 | rl_loss: 0.9134 | pt_loss: 1.7765 | pg_loss: 0.3618 | reg_loss: 0.5516 | reward: -0.3577 | rev_kl: 1.1794 | stu_lens: 98.3906 | mixed_lens: 89.9688 | lr: 4.8935e-06 | scale: 2048.00 | time: 26.217 | step time: 26.045
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    561/  5000| tot_loss: 2.1030 | rl_loss: 0.4667 | pt_loss: 1.6363 | pg_loss: -0.0112 | reg_loss: 0.4779 | reward: -0.2395 | rev_kl: 1.2238 | stu_lens: 94.0000 | mixed_lens: 128.0000 | lr: 4.8930e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    562/  5000| tot_loss: 2.3324 | rl_loss: 0.5869 | pt_loss: 1.7455 | pg_loss: 0.1294 | reg_loss: 0.4574 | reward: -0.0863 | rev_kl: 1.1829 | stu_lens: 128.0000 | mixed_lens: 101.0000 | lr: 4.8925e-06 | scale: 2048.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    563/  5000| tot_loss: 2.4974 | rl_loss: 0.6102 | pt_loss: 1.8872 | pg_loss: 0.0235 | reg_loss: 0.5867 | reward: -0.4091 | rev_kl: 1.4245 | stu_lens: 89.0000 | mixed_lens: 127.5000 | lr: 4.8921e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    564/  5000| tot_loss: 1.6758 | rl_loss: 0.3404 | pt_loss: 1.3354 | pg_loss: 0.1458 | reg_loss: 0.1945 | reward: -0.0916 | rev_kl: 0.3766 | stu_lens: 104.0000 | mixed_lens: 99.5000 | lr: 4.8916e-06 | scale: 2048.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    565/  5000| tot_loss: 2.0614 | rl_loss: 0.5905 | pt_loss: 1.4708 | pg_loss: 0.0963 | reg_loss: 0.4942 | reward: -0.3883 | rev_kl: 1.1167 | stu_lens: 125.0000 | mixed_lens: 116.5000 | lr: 4.8911e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    566/  5000| tot_loss: 2.4023 | rl_loss: 0.7641 | pt_loss: 1.6382 | pg_loss: 0.1224 | reg_loss: 0.6417 | reward: -0.3963 | rev_kl: 1.7260 | stu_lens: 67.0000 | mixed_lens: 92.0000 | lr: 4.8907e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    567/  5000| tot_loss: 2.6351 | rl_loss: 1.0271 | pt_loss: 1.6080 | pg_loss: 0.5459 | reg_loss: 0.4812 | reward: -0.4408 | rev_kl: 1.0389 | stu_lens: 117.5000 | mixed_lens: 60.5000 | lr: 4.8902e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    568/  5000| tot_loss: 2.3072 | rl_loss: 0.5236 | pt_loss: 1.7836 | pg_loss: 0.1636 | reg_loss: 0.3600 | reward: -0.4381 | rev_kl: 1.1638 | stu_lens: 97.0000 | mixed_lens: 104.5000 | lr: 4.8897e-06 | scale: 2048.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    569/  5000| tot_loss: 2.1703 | rl_loss: 0.3472 | pt_loss: 1.8230 | pg_loss: 0.0228 | reg_loss: 0.3244 | reward: -0.2242 | rev_kl: 1.3123 | stu_lens: 84.0000 | mixed_lens: 128.0000 | lr: 4.8892e-06 | scale: 2048.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    570/  5000| tot_loss: 2.0067 | rl_loss: 0.4657 | pt_loss: 1.5410 | pg_loss: 0.0106 | reg_loss: 0.4551 | reward: -0.2580 | rev_kl: 1.0915 | stu_lens: 102.5000 | mixed_lens: 128.0000 | lr: 4.8888e-06 | scale: 2048.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    571/  5000| tot_loss: 2.2287 | rl_loss: 0.5875 | pt_loss: 1.6412 | pg_loss: 0.3231 | reg_loss: 0.2644 | reward: -0.4417 | rev_kl: 0.7406 | stu_lens: 118.0000 | mixed_lens: 83.0000 | lr: 4.8883e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    572/  5000| tot_loss: 2.5815 | rl_loss: 0.3577 | pt_loss: 2.2238 | pg_loss: 0.0507 | reg_loss: 0.3070 | reward: -0.1896 | rev_kl: 1.1249 | stu_lens: 101.0000 | mixed_lens: 128.0000 | lr: 4.8878e-06 | scale: 2048.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    573/  5000| tot_loss: 2.0769 | rl_loss: 0.3431 | pt_loss: 1.7338 | pg_loss: 0.0125 | reg_loss: 0.3306 | reward: -0.2269 | rev_kl: 1.2411 | stu_lens: 123.5000 | mixed_lens: 127.0000 | lr: 4.8874e-06 | scale: 2048.00 | time: 26.314 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    574/  5000| tot_loss: 2.0758 | rl_loss: 0.3753 | pt_loss: 1.7005 | pg_loss: -0.0092 | reg_loss: 0.3845 | reward: -0.2815 | rev_kl: 1.2077 | stu_lens: 126.0000 | mixed_lens: 128.0000 | lr: 4.8869e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    575/  5000| tot_loss: 2.1200 | rl_loss: 0.5115 | pt_loss: 1.6085 | pg_loss: 0.1148 | reg_loss: 0.3967 | reward: -0.3194 | rev_kl: 1.1869 | stu_lens: 128.0000 | mixed_lens: 117.5000 | lr: 4.8864e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    576/  5000| tot_loss: 1.9991 | rl_loss: 0.4538 | pt_loss: 1.5454 | pg_loss: 0.0237 | reg_loss: 0.4301 | reward: -0.2270 | rev_kl: 1.0866 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8859e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    576/  5000| tot_loss: 2.3323 | rl_loss: 0.6804 | pt_loss: 1.6519 | pg_loss: 0.2340 | reg_loss: 0.4464 | reward: -0.3795 | rev_kl: 1.1856 | stu_lens: 100.0938 | mixed_lens: 96.4219 | lr: 4.8859e-06 | scale: 2048.00 | time: 26.284 | step time: 27.523
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    577/  5000| tot_loss: 2.5609 | rl_loss: 0.6143 | pt_loss: 1.9465 | pg_loss: 0.1435 | reg_loss: 0.4708 | reward: -0.3557 | rev_kl: 1.3995 | stu_lens: 110.5000 | mixed_lens: 76.0000 | lr: 4.8854e-06 | scale: 2048.00 | time: 26.336 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    578/  5000| tot_loss: 2.9935 | rl_loss: 1.4040 | pt_loss: 1.5896 | pg_loss: 0.2635 | reg_loss: 1.1405 | reward: -0.4700 | rev_kl: 1.2376 | stu_lens: 100.5000 | mixed_lens: 94.0000 | lr: 4.8850e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    579/  5000| tot_loss: 5.2536 | rl_loss: 3.4510 | pt_loss: 1.8026 | pg_loss: 1.4904 | reg_loss: 1.9606 | reward: -2.7417 | rev_kl: 1.3860 | stu_lens: 87.0000 | mixed_lens: 22.5000 | lr: 4.8845e-06 | scale: 2048.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    580/  5000| tot_loss: 4.5499 | rl_loss: 2.3372 | pt_loss: 2.2127 | pg_loss: 0.3345 | reg_loss: 2.0026 | reward: -0.0978 | rev_kl: 0.9389 | stu_lens: 99.5000 | mixed_lens: 74.0000 | lr: 4.8840e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    581/  5000| tot_loss: 4.1307 | rl_loss: 2.8289 | pt_loss: 1.3018 | pg_loss: 1.8842 | reg_loss: 0.9448 | reward: -1.4875 | rev_kl: 0.9019 | stu_lens: 12.0000 | mixed_lens: 12.0000 | lr: 4.8835e-06 | scale: 2048.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    582/  5000| tot_loss: 3.5533 | rl_loss: 1.8537 | pt_loss: 1.6996 | pg_loss: 0.1413 | reg_loss: 1.7124 | reward: -0.2171 | rev_kl: 0.9071 | stu_lens: 128.0000 | mixed_lens: 107.5000 | lr: 4.8830e-06 | scale: 2048.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    583/  5000| tot_loss: 4.1690 | rl_loss: 2.1622 | pt_loss: 2.0068 | pg_loss: 0.4175 | reg_loss: 1.7447 | reward: -0.5104 | rev_kl: 1.2506 | stu_lens: 125.0000 | mixed_lens: 91.0000 | lr: 4.8825e-06 | scale: 2048.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    584/  5000| tot_loss: 3.1809 | rl_loss: 1.2922 | pt_loss: 1.8887 | pg_loss: 0.0473 | reg_loss: 1.2449 | reward: -0.0707 | rev_kl: 1.0625 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8821e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    585/  5000| tot_loss: 2.2923 | rl_loss: 1.1909 | pt_loss: 1.1014 | pg_loss: 0.4267 | reg_loss: 0.7642 | reward: -0.2951 | rev_kl: 0.5239 | stu_lens: 41.5000 | mixed_lens: 74.0000 | lr: 4.8816e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    586/  5000| tot_loss: 2.8391 | rl_loss: 1.4882 | pt_loss: 1.3509 | pg_loss: 0.2827 | reg_loss: 1.2055 | reward: -0.2809 | rev_kl: 1.0394 | stu_lens: 100.5000 | mixed_lens: 96.0000 | lr: 4.8811e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    587/  5000| tot_loss: 4.2899 | rl_loss: 2.8374 | pt_loss: 1.4525 | pg_loss: 1.1894 | reg_loss: 1.6481 | reward: -0.9014 | rev_kl: 1.0273 | stu_lens: 71.0000 | mixed_lens: 33.0000 | lr: 4.8806e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    588/  5000| tot_loss: 3.0453 | rl_loss: 1.3687 | pt_loss: 1.6767 | pg_loss: 0.3450 | reg_loss: 1.0237 | reward: -0.4057 | rev_kl: 0.8384 | stu_lens: 92.0000 | mixed_lens: 91.5000 | lr: 4.8801e-06 | scale: 2048.00 | time: 26.352 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    589/  5000| tot_loss: 3.5876 | rl_loss: 1.8529 | pt_loss: 1.7346 | pg_loss: 0.3137 | reg_loss: 1.5392 | reward: -0.1991 | rev_kl: 0.8716 | stu_lens: 84.5000 | mixed_lens: 79.0000 | lr: 4.8796e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    590/  5000| tot_loss: 4.2820 | rl_loss: 2.0563 | pt_loss: 2.2257 | pg_loss: 0.2774 | reg_loss: 1.7788 | reward: -0.4213 | rev_kl: 1.2772 | stu_lens: 128.0000 | mixed_lens: 105.0000 | lr: 4.8791e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    591/  5000| tot_loss: 3.1654 | rl_loss: 1.3905 | pt_loss: 1.7749 | pg_loss: 0.2386 | reg_loss: 1.1519 | reward: -0.3315 | rev_kl: 0.8840 | stu_lens: 128.0000 | mixed_lens: 110.5000 | lr: 4.8786e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    592/  5000| tot_loss: 2.4771 | rl_loss: 1.1958 | pt_loss: 1.2813 | pg_loss: 0.0399 | reg_loss: 1.1559 | reward: -0.1530 | rev_kl: 0.7624 | stu_lens: 122.0000 | mixed_lens: 128.0000 | lr: 4.8781e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    592/  5000| tot_loss: 3.3828 | rl_loss: 1.6859 | pt_loss: 1.6970 | pg_loss: 0.4260 | reg_loss: 1.2599 | reward: -0.5054 | rev_kl: 1.0240 | stu_lens: 94.7656 | mixed_lens: 86.5469 | lr: 4.8781e-06 | scale: 2048.00 | time: 26.265 | step time: 27.547
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    593/  5000| tot_loss: 3.1226 | rl_loss: 1.1652 | pt_loss: 1.9574 | pg_loss: 0.1040 | reg_loss: 1.0612 | reward: -0.2385 | rev_kl: 1.3209 | stu_lens: 128.0000 | mixed_lens: 115.5000 | lr: 4.8776e-06 | scale: 2048.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    594/  5000| tot_loss: 3.2980 | rl_loss: 1.4723 | pt_loss: 1.8257 | pg_loss: 0.3502 | reg_loss: 1.1221 | reward: -0.9417 | rev_kl: 1.2257 | stu_lens: 87.0000 | mixed_lens: 79.5000 | lr: 4.8771e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    595/  5000| tot_loss: 1.5909 | rl_loss: 0.5216 | pt_loss: 1.0694 | pg_loss: 0.0117 | reg_loss: 0.5099 | reward: -0.2889 | rev_kl: 0.6659 | stu_lens: 73.0000 | mixed_lens: 128.0000 | lr: 4.8766e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    596/  5000| tot_loss: 3.4612 | rl_loss: 1.4568 | pt_loss: 2.0044 | pg_loss: 0.6996 | reg_loss: 0.7572 | reward: -1.7997 | rev_kl: 1.5562 | stu_lens: 69.5000 | mixed_lens: 53.0000 | lr: 4.8762e-06 | scale: 2048.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    597/  5000| tot_loss: 2.8493 | rl_loss: 0.7335 | pt_loss: 2.1158 | pg_loss: 0.0852 | reg_loss: 0.6483 | reward: -0.0393 | rev_kl: 0.9119 | stu_lens: 73.0000 | mixed_lens: 118.0000 | lr: 4.8757e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    598/  5000| tot_loss: 2.5578 | rl_loss: 1.3352 | pt_loss: 1.2226 | pg_loss: 0.4698 | reg_loss: 0.8654 | reward: -2.2834 | rev_kl: 1.0136 | stu_lens: 100.5000 | mixed_lens: 37.0000 | lr: 4.8752e-06 | scale: 2048.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    599/  5000| tot_loss: 2.7568 | rl_loss: 1.1073 | pt_loss: 1.6495 | pg_loss: 0.2565 | reg_loss: 0.8507 | reward: -0.4312 | rev_kl: 0.9901 | stu_lens: 83.5000 | mixed_lens: 88.0000 | lr: 4.8747e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
                                 Evaluation #6                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Bob should leave Alice, because his  │
│                                       │ chances of survival improve by 9%.   │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ MZ kezboard types z instead of y and │
│                                       │ vice versa because of the way the    │
│                                       │ keyboard is designed. The Y key is   │
│                                       │ in the upper left corner of the      │
│                                       │ keyboard and the Z key is in the     │
│                                       │ lower left corner of the keyboard.   │
│                                       │ When you type y, your index finger   │
│                                       │ is on the Y key and your middle      │
│                                       │ finger is on the Z key. When you     │
│                                       │ type z, your index finger is on the  │
│                                       │ Z key and your middle finger is on   │
│                                       │ the Y key.                           │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Two                                  │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.305 | exact_match: 0.215 | rev_kl: 1.131 | lens: 78.836 | pt_loss: 1.091 | lm_loss: 1.184 | kd_loss: 0.998 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    600/  5000| tot_loss: 2.4327 | rl_loss: 0.8130 | pt_loss: 1.6197 | pg_loss: 0.2773 | reg_loss: 0.5357 | reward: 0.0935 | rev_kl: 0.8684 | stu_lens: 99.5000 | mixed_lens: 74.0000 | lr: 4.8742e-06 | scale: 2048.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    601/  5000| tot_loss: 2.5662 | rl_loss: 0.8041 | pt_loss: 1.7621 | pg_loss: 0.1210 | reg_loss: 0.6831 | reward: -0.3291 | rev_kl: 0.8683 | stu_lens: 128.0000 | mixed_lens: 91.5000 | lr: 4.8736e-06 | scale: 2048.00 | time: 26.377 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    602/  5000| tot_loss: 2.1009 | rl_loss: 0.3705 | pt_loss: 1.7304 | pg_loss: -0.0126 | reg_loss: 0.3830 | reward: -0.1618 | rev_kl: 0.6089 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8731e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    603/  5000| tot_loss: 2.7398 | rl_loss: 0.9967 | pt_loss: 1.7432 | pg_loss: 0.2450 | reg_loss: 0.7517 | reward: -0.1967 | rev_kl: 0.9500 | stu_lens: 128.0000 | mixed_lens: 89.0000 | lr: 4.8726e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    604/  5000| tot_loss: 2.5358 | rl_loss: 1.0768 | pt_loss: 1.4590 | pg_loss: 0.2478 | reg_loss: 0.8290 | reward: -1.0625 | rev_kl: 1.2122 | stu_lens: 128.0000 | mixed_lens: 75.0000 | lr: 4.8721e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    605/  5000| tot_loss: 2.6394 | rl_loss: 1.1958 | pt_loss: 1.4436 | pg_loss: 0.2984 | reg_loss: 0.8974 | reward: -0.2420 | rev_kl: 1.0751 | stu_lens: 107.5000 | mixed_lens: 82.5000 | lr: 4.8716e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    606/  5000| tot_loss: 2.3234 | rl_loss: 0.8589 | pt_loss: 1.4645 | pg_loss: 0.2152 | reg_loss: 0.6437 | reward: -0.0976 | rev_kl: 0.8612 | stu_lens: 109.0000 | mixed_lens: 105.0000 | lr: 4.8711e-06 | scale: 2048.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    607/  5000| tot_loss: 2.5182 | rl_loss: 0.7299 | pt_loss: 1.7883 | pg_loss: 0.1137 | reg_loss: 0.6162 | reward: -0.0339 | rev_kl: 0.7593 | stu_lens: 65.0000 | mixed_lens: 70.5000 | lr: 4.8706e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    608/  5000| tot_loss: 2.1703 | rl_loss: 0.7956 | pt_loss: 1.3747 | pg_loss: -0.0040 | reg_loss: 0.7995 | reward: -0.3328 | rev_kl: 1.1375 | stu_lens: 99.5000 | mixed_lens: 128.0000 | lr: 4.8701e-06 | scale: 2048.00 | time: 26.250 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    608/  5000| tot_loss: 2.7404 | rl_loss: 1.0439 | pt_loss: 1.6965 | pg_loss: 0.2241 | reg_loss: 0.8198 | reward: -0.4381 | rev_kl: 1.0196 | stu_lens: 99.9688 | mixed_lens: 94.0156 | lr: 4.8701e-06 | scale: 2048.00 | time: 26.250 | step time: 27.570
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    609/  5000| tot_loss: 3.4658 | rl_loss: 1.7622 | pt_loss: 1.7037 | pg_loss: 0.9058 | reg_loss: 0.8564 | reward: 0.0143 | rev_kl: 2.7958 | stu_lens: 67.0000 | mixed_lens: 51.5000 | lr: 4.8696e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    610/  5000| tot_loss: 2.6618 | rl_loss: 0.8168 | pt_loss: 1.8450 | pg_loss: 0.2755 | reg_loss: 0.5414 | reward: -0.0114 | rev_kl: 0.6426 | stu_lens: 38.5000 | mixed_lens: 61.0000 | lr: 4.8691e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    611/  5000| tot_loss: 3.0734 | rl_loss: 1.4083 | pt_loss: 1.6652 | pg_loss: 0.4755 | reg_loss: 0.9327 | reward: -0.7465 | rev_kl: 1.5285 | stu_lens: 76.5000 | mixed_lens: 86.5000 | lr: 4.8686e-06 | scale: 2048.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    612/  5000| tot_loss: 2.9809 | rl_loss: 1.1872 | pt_loss: 1.7937 | pg_loss: 0.2424 | reg_loss: 0.9449 | reward: -0.2513 | rev_kl: 1.1370 | stu_lens: 125.0000 | mixed_lens: 91.5000 | lr: 4.8681e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    613/  5000| tot_loss: 2.6088 | rl_loss: 0.8226 | pt_loss: 1.7862 | pg_loss: 0.2382 | reg_loss: 0.5844 | reward: -0.2931 | rev_kl: 1.0981 | stu_lens: 109.0000 | mixed_lens: 105.0000 | lr: 4.8675e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    614/  5000| tot_loss: 2.1003 | rl_loss: 0.6370 | pt_loss: 1.4633 | pg_loss: 0.2698 | reg_loss: 0.3672 | reward: -0.2753 | rev_kl: 1.1860 | stu_lens: 103.0000 | mixed_lens: 98.5000 | lr: 4.8670e-06 | scale: 2048.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    615/  5000| tot_loss: 2.1657 | rl_loss: 0.7160 | pt_loss: 1.4497 | pg_loss: 0.2593 | reg_loss: 0.4567 | reward: -0.5287 | rev_kl: 0.9547 | stu_lens: 100.5000 | mixed_lens: 94.0000 | lr: 4.8665e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    616/  5000| tot_loss: 2.5043 | rl_loss: 1.0201 | pt_loss: 1.4842 | pg_loss: 0.4301 | reg_loss: 0.5900 | reward: -0.9037 | rev_kl: 1.1720 | stu_lens: 71.0000 | mixed_lens: 69.5000 | lr: 4.8660e-06 | scale: 2048.00 | time: 26.186 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    617/  5000| tot_loss: 2.4445 | rl_loss: 0.7466 | pt_loss: 1.6979 | pg_loss: 0.2503 | reg_loss: 0.4962 | reward: -0.0340 | rev_kl: 0.6563 | stu_lens: 84.5000 | mixed_lens: 79.0000 | lr: 4.8655e-06 | scale: 2048.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    618/  5000| tot_loss: 2.9069 | rl_loss: 0.6586 | pt_loss: 2.2483 | pg_loss: 0.1886 | reg_loss: 0.4700 | reward: -0.4090 | rev_kl: 0.9818 | stu_lens: 128.0000 | mixed_lens: 107.0000 | lr: 4.8650e-06 | scale: 2048.00 | time: 26.199 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    619/  5000| tot_loss: 2.6678 | rl_loss: 1.0174 | pt_loss: 1.6504 | pg_loss: 0.4065 | reg_loss: 0.6109 | reward: -0.1991 | rev_kl: 0.2366 | stu_lens: 70.5000 | mixed_lens: 70.5000 | lr: 4.8644e-06 | scale: 2048.00 | time: 26.209 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    620/  5000| tot_loss: 2.2878 | rl_loss: 0.3159 | pt_loss: 1.9719 | pg_loss: 0.1944 | reg_loss: 0.1215 | reward: 0.0967 | rev_kl: 0.6151 | stu_lens: 99.5000 | mixed_lens: 74.0000 | lr: 4.8639e-06 | scale: 2048.00 | time: 26.173 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    621/  5000| tot_loss: 3.1667 | rl_loss: 1.1235 | pt_loss: 2.0432 | pg_loss: 0.4218 | reg_loss: 0.7016 | reward: -0.4541 | rev_kl: 0.9024 | stu_lens: 73.5000 | mixed_lens: 84.5000 | lr: 4.8634e-06 | scale: 2048.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    622/  5000| tot_loss: 2.5912 | rl_loss: 1.4845 | pt_loss: 1.1067 | pg_loss: 0.8268 | reg_loss: 0.6577 | reward: -0.3072 | rev_kl: 0.6181 | stu_lens: 73.5000 | mixed_lens: 37.5000 | lr: 4.8629e-06 | scale: 2048.00 | time: 26.174 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    623/  5000| tot_loss: 2.5045 | rl_loss: 0.7604 | pt_loss: 1.7441 | pg_loss: 0.3716 | reg_loss: 0.3888 | reward: -0.8614 | rev_kl: 0.5050 | stu_lens: 55.0000 | mixed_lens: 85.5000 | lr: 4.8623e-06 | scale: 2048.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    624/  5000| tot_loss: 2.6935 | rl_loss: 0.6570 | pt_loss: 2.0366 | pg_loss: 0.1561 | reg_loss: 0.5008 | reward: -0.4472 | rev_kl: 1.0943 | stu_lens: 107.5000 | mixed_lens: 103.0000 | lr: 4.8618e-06 | scale: 2048.00 | time: 26.231 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    624/  5000| tot_loss: 2.5046 | rl_loss: 0.8335 | pt_loss: 1.6711 | pg_loss: 0.2863 | reg_loss: 0.5473 | reward: -0.4445 | rev_kl: 1.0866 | stu_lens: 97.0469 | mixed_lens: 89.7969 | lr: 4.8618e-06 | scale: 2048.00 | time: 26.231 | step time: 27.499
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    625/  5000| tot_loss: 2.3937 | rl_loss: 0.7144 | pt_loss: 1.6793 | pg_loss: 0.0130 | reg_loss: 0.7014 | reward: -0.3222 | rev_kl: 1.3301 | stu_lens: 99.5000 | mixed_lens: 128.0000 | lr: 4.8613e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    626/  5000| tot_loss: 2.6868 | rl_loss: 0.8768 | pt_loss: 1.8099 | pg_loss: 0.4724 | reg_loss: 0.4044 | reward: -0.0442 | rev_kl: 0.4266 | stu_lens: 71.0000 | mixed_lens: 71.0000 | lr: 4.8608e-06 | scale: 2048.00 | time: 26.195 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    627/  5000| tot_loss: 2.0979 | rl_loss: 0.5358 | pt_loss: 1.5621 | pg_loss: 0.1489 | reg_loss: 0.3869 | reward: -1.6572 | rev_kl: 1.4203 | stu_lens: 64.0000 | mixed_lens: 69.5000 | lr: 4.8602e-06 | scale: 2048.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    628/  5000| tot_loss: 2.2922 | rl_loss: 0.5526 | pt_loss: 1.7395 | pg_loss: 0.0494 | reg_loss: 0.5033 | reward: -0.1846 | rev_kl: 1.0976 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8597e-06 | scale: 2048.00 | time: 26.196 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    629/  5000| tot_loss: 2.6561 | rl_loss: 0.8006 | pt_loss: 1.8555 | pg_loss: 0.1835 | reg_loss: 0.6171 | reward: -0.2863 | rev_kl: 1.0977 | stu_lens: 128.0000 | mixed_lens: 91.5000 | lr: 4.8592e-06 | scale: 2048.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    630/  5000| tot_loss: 2.4154 | rl_loss: 0.4234 | pt_loss: 1.9921 | pg_loss: 0.1012 | reg_loss: 0.3222 | reward: -0.3854 | rev_kl: 1.0352 | stu_lens: 128.0000 | mixed_lens: 111.5000 | lr: 4.8586e-06 | scale: 2048.00 | time: 26.191 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    631/  5000| tot_loss: 2.4369 | rl_loss: 0.5772 | pt_loss: 1.8597 | pg_loss: 0.0272 | reg_loss: 0.5499 | reward: -0.2091 | rev_kl: 1.1660 | stu_lens: 128.0000 | mixed_lens: 115.5000 | lr: 4.8581e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    632/  5000| tot_loss: 1.6795 | rl_loss: 0.3438 | pt_loss: 1.3357 | pg_loss: 0.1947 | reg_loss: 0.1491 | reward: -0.1866 | rev_kl: 0.7768 | stu_lens: 107.5000 | mixed_lens: 103.0000 | lr: 4.8576e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    633/  5000| tot_loss: 2.8889 | rl_loss: 0.9273 | pt_loss: 1.9616 | pg_loss: 0.6642 | reg_loss: 0.2631 | reward: -0.4909 | rev_kl: 0.7580 | stu_lens: 46.0000 | mixed_lens: 40.0000 | lr: 4.8570e-06 | scale: 2048.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    634/  5000| tot_loss: 2.6102 | rl_loss: 0.7291 | pt_loss: 1.8811 | pg_loss: 0.1634 | reg_loss: 0.5657 | reward: -0.6209 | rev_kl: 1.0779 | stu_lens: 76.5000 | mixed_lens: 93.0000 | lr: 4.8565e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    635/  5000| tot_loss: 2.1039 | rl_loss: 0.6298 | pt_loss: 1.4741 | pg_loss: 0.0967 | reg_loss: 0.5330 | reward: -0.2147 | rev_kl: 0.8120 | stu_lens: 103.5000 | mixed_lens: 121.0000 | lr: 4.8560e-06 | scale: 2048.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    636/  5000| tot_loss: 2.0007 | rl_loss: 0.6221 | pt_loss: 1.3786 | pg_loss: 0.0373 | reg_loss: 0.5847 | reward: -0.5479 | rev_kl: 1.3769 | stu_lens: 128.0000 | mixed_lens: 121.5000 | lr: 4.8554e-06 | scale: 2048.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    637/  5000| tot_loss: 2.5861 | rl_loss: 0.6250 | pt_loss: 1.9611 | pg_loss: 0.1988 | reg_loss: 0.4262 | reward: -0.3007 | rev_kl: 1.2030 | stu_lens: 99.5000 | mixed_lens: 110.5000 | lr: 4.8549e-06 | scale: 2048.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    638/  5000| tot_loss: 2.4357 | rl_loss: 0.7020 | pt_loss: 1.7337 | pg_loss: 0.1486 | reg_loss: 0.5534 | reward: -0.3905 | rev_kl: 1.1625 | stu_lens: 125.0000 | mixed_lens: 112.0000 | lr: 4.8544e-06 | scale: 2048.00 | time: 26.194 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    639/  5000| tot_loss: 2.5644 | rl_loss: 0.9423 | pt_loss: 1.6222 | pg_loss: 0.2651 | reg_loss: 0.6772 | reward: -2.2386 | rev_kl: 0.6916 | stu_lens: 128.0000 | mixed_lens: 71.0000 | lr: 4.8538e-06 | scale: 2048.00 | time: 26.180 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    640/  5000| tot_loss: 2.4239 | rl_loss: 0.4797 | pt_loss: 1.9442 | pg_loss: 0.0181 | reg_loss: 0.4616 | reward: -0.3474 | rev_kl: 0.9696 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8533e-06 | scale: 2048.00 | time: 26.158 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    640/  5000| tot_loss: 2.4430 | rl_loss: 0.7549 | pt_loss: 1.6881 | pg_loss: 0.2857 | reg_loss: 0.4692 | reward: -0.4633 | rev_kl: 1.0790 | stu_lens: 95.1875 | mixed_lens: 90.5156 | lr: 4.8533e-06 | scale: 2048.00 | time: 26.158 | step time: 27.484
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    641/  5000| tot_loss: 1.9934 | rl_loss: 0.2541 | pt_loss: 1.7393 | pg_loss: 0.0012 | reg_loss: 0.2529 | reward: -0.3739 | rev_kl: 1.0320 | stu_lens: 105.0000 | mixed_lens: 128.0000 | lr: 4.8527e-06 | scale: 2048.00 | time: 26.205 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    642/  5000| tot_loss: 2.8825 | rl_loss: 1.4484 | pt_loss: 1.4341 | pg_loss: 0.3519 | reg_loss: 1.0965 | reward: -0.2747 | rev_kl: 2.8617 | stu_lens: 90.5000 | mixed_lens: 84.0000 | lr: 4.8522e-06 | scale: 2048.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    643/  5000| tot_loss: 3.5169 | rl_loss: 1.5020 | pt_loss: 2.0149 | pg_loss: 0.3150 | reg_loss: 1.1869 | reward: -0.9849 | rev_kl: 1.2075 | stu_lens: 67.5000 | mixed_lens: 60.0000 | lr: 4.8517e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    644/  5000| tot_loss: 2.6022 | rl_loss: 1.2549 | pt_loss: 1.3473 | pg_loss: 0.0465 | reg_loss: 1.2084 | reward: -0.2031 | rev_kl: 0.9174 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8511e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    645/  5000| tot_loss: 3.9123 | rl_loss: 2.1302 | pt_loss: 1.7821 | pg_loss: 0.6643 | reg_loss: 1.4659 | reward: -0.2371 | rev_kl: 0.7944 | stu_lens: 46.5000 | mixed_lens: 57.0000 | lr: 4.8506e-06 | scale: 2048.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    646/  5000| tot_loss: 3.2052 | rl_loss: 1.6127 | pt_loss: 1.5925 | pg_loss: 0.2441 | reg_loss: 1.3685 | reward: -0.4121 | rev_kl: 1.4094 | stu_lens: 119.0000 | mixed_lens: 97.5000 | lr: 4.8500e-06 | scale: 2048.00 | time: 26.180 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    647/  5000| tot_loss: 3.1238 | rl_loss: 1.5114 | pt_loss: 1.6125 | pg_loss: 0.2998 | reg_loss: 1.2116 | reward: -0.5529 | rev_kl: 1.1841 | stu_lens: 110.0000 | mixed_lens: 93.5000 | lr: 4.8495e-06 | scale: 2048.00 | time: 26.182 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    648/  5000| tot_loss: 3.6951 | rl_loss: 1.6881 | pt_loss: 2.0070 | pg_loss: 0.3559 | reg_loss: 1.3323 | reward: -0.1910 | rev_kl: 1.1383 | stu_lens: 93.5000 | mixed_lens: 86.0000 | lr: 4.8489e-06 | scale: 2048.00 | time: 26.154 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    649/  5000| tot_loss: 4.1571 | rl_loss: 2.1313 | pt_loss: 2.0258 | pg_loss: 0.9737 | reg_loss: 1.1576 | reward: -0.6191 | rev_kl: 1.3715 | stu_lens: 75.5000 | mixed_lens: 55.5000 | lr: 4.8484e-06 | scale: 2048.00 | time: 26.163 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    650/  5000| tot_loss: 3.1004 | rl_loss: 1.3484 | pt_loss: 1.7519 | pg_loss: 0.1789 | reg_loss: 1.1695 | reward: 0.0445 | rev_kl: 1.4953 | stu_lens: 56.0000 | mixed_lens: 65.5000 | lr: 4.8478e-06 | scale: 2048.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    651/  5000| tot_loss: 3.3153 | rl_loss: 1.3911 | pt_loss: 1.9241 | pg_loss: 0.2634 | reg_loss: 1.1277 | reward: -0.2840 | rev_kl: 0.6709 | stu_lens: 104.5000 | mixed_lens: 99.0000 | lr: 4.8473e-06 | scale: 2048.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    652/  5000| tot_loss: 3.7425 | rl_loss: 1.9809 | pt_loss: 1.7616 | pg_loss: 0.5693 | reg_loss: 1.4116 | reward: -0.3765 | rev_kl: 1.0372 | stu_lens: 87.0000 | mixed_lens: 82.5000 | lr: 4.8467e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    653/  5000| tot_loss: 3.0525 | rl_loss: 1.3040 | pt_loss: 1.7485 | pg_loss: 0.2916 | reg_loss: 1.0123 | reward: -0.3656 | rev_kl: 1.2218 | stu_lens: 82.5000 | mixed_lens: 94.5000 | lr: 4.8462e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    654/  5000| tot_loss: 3.3130 | rl_loss: 1.6404 | pt_loss: 1.6726 | pg_loss: 0.4518 | reg_loss: 1.1886 | reward: 0.3225 | rev_kl: 0.7380 | stu_lens: 74.5000 | mixed_lens: 70.0000 | lr: 4.8456e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    655/  5000| tot_loss: 2.8935 | rl_loss: 1.2084 | pt_loss: 1.6851 | pg_loss: 0.2743 | reg_loss: 0.9342 | reward: -0.4272 | rev_kl: 0.8794 | stu_lens: 92.0000 | mixed_lens: 92.5000 | lr: 4.8451e-06 | scale: 2048.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    656/  5000| tot_loss: 4.4649 | rl_loss: 2.6975 | pt_loss: 1.7673 | pg_loss: 1.1060 | reg_loss: 1.5915 | reward: -0.5221 | rev_kl: 1.8957 | stu_lens: 128.0000 | mixed_lens: 45.0000 | lr: 4.8445e-06 | scale: 2048.00 | time: 26.227 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    656/  5000| tot_loss: 3.3293 | rl_loss: 1.5729 | pt_loss: 1.7563 | pg_loss: 0.3806 | reg_loss: 1.1923 | reward: -0.4047 | rev_kl: 1.2292 | stu_lens: 89.2969 | mixed_lens: 83.2656 | lr: 4.8445e-06 | scale: 2048.00 | time: 26.227 | step time: 27.472
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    657/  5000| tot_loss: 2.9732 | rl_loss: 0.9515 | pt_loss: 2.0217 | pg_loss: 0.1684 | reg_loss: 0.7831 | reward: -0.4896 | rev_kl: 0.9123 | stu_lens: 124.0000 | mixed_lens: 85.0000 | lr: 4.8439e-06 | scale: 2048.00 | time: 26.164 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    658/  5000| tot_loss: 2.0699 | rl_loss: 0.6606 | pt_loss: 1.4093 | pg_loss: 0.0602 | reg_loss: 0.6003 | reward: -0.2451 | rev_kl: 1.2875 | stu_lens: 109.5000 | mixed_lens: 117.5000 | lr: 4.8434e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    659/  5000| tot_loss: 2.6556 | rl_loss: 0.6579 | pt_loss: 1.9977 | pg_loss: 0.0562 | reg_loss: 0.6017 | reward: -0.1923 | rev_kl: 1.1076 | stu_lens: 128.0000 | mixed_lens: 112.0000 | lr: 4.8428e-06 | scale: 2048.00 | time: 26.161 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    660/  5000| tot_loss: 2.6782 | rl_loss: 1.2431 | pt_loss: 1.4351 | pg_loss: 0.3532 | reg_loss: 0.8899 | reward: -0.2493 | rev_kl: 1.1564 | stu_lens: 72.0000 | mixed_lens: 83.5000 | lr: 4.8423e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    661/  5000| tot_loss: 2.8966 | rl_loss: 1.2319 | pt_loss: 1.6647 | pg_loss: 0.2877 | reg_loss: 0.9441 | reward: -1.0397 | rev_kl: 1.6225 | stu_lens: 25.5000 | mixed_lens: 55.0000 | lr: 4.8417e-06 | scale: 2048.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    662/  5000| tot_loss: 2.1128 | rl_loss: 0.6307 | pt_loss: 1.4820 | pg_loss: -0.0120 | reg_loss: 0.6428 | reward: -0.1832 | rev_kl: 1.0222 | stu_lens: 114.5000 | mixed_lens: 128.0000 | lr: 4.8411e-06 | scale: 2048.00 | time: 26.205 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    663/  5000| tot_loss: 2.6563 | rl_loss: 0.7284 | pt_loss: 1.9280 | pg_loss: 0.0794 | reg_loss: 0.6490 | reward: -0.2375 | rev_kl: 1.4247 | stu_lens: 91.0000 | mixed_lens: 113.5000 | lr: 4.8406e-06 | scale: 2048.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    664/  5000| tot_loss: 2.2180 | rl_loss: 0.6913 | pt_loss: 1.5267 | pg_loss: 0.2732 | reg_loss: 0.4181 | reward: -0.5322 | rev_kl: 0.8487 | stu_lens: 40.0000 | mixed_lens: 16.5000 | lr: 4.8400e-06 | scale: 2048.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    665/  5000| tot_loss: 3.0292 | rl_loss: 1.1949 | pt_loss: 1.8343 | pg_loss: 0.1301 | reg_loss: 1.0648 | reward: -0.4166 | rev_kl: 1.3195 | stu_lens: 100.5000 | mixed_lens: 107.0000 | lr: 4.8395e-06 | scale: 2048.00 | time: 26.345 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    666/  5000| tot_loss: 2.1051 | rl_loss: 0.8127 | pt_loss: 1.2925 | pg_loss: 0.2634 | reg_loss: 0.5493 | reward: -0.1522 | rev_kl: 0.7672 | stu_lens: 71.0000 | mixed_lens: 76.0000 | lr: 4.8389e-06 | scale: 2048.00 | time: 26.209 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    667/  5000| tot_loss: 2.8107 | rl_loss: 0.7745 | pt_loss: 2.0362 | pg_loss: 0.1840 | reg_loss: 0.5905 | reward: -0.4338 | rev_kl: 1.0328 | stu_lens: 92.0000 | mixed_lens: 92.5000 | lr: 4.8383e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    668/  5000| tot_loss: 2.5738 | rl_loss: 0.8310 | pt_loss: 1.7428 | pg_loss: 0.1802 | reg_loss: 0.6508 | reward: 0.1162 | rev_kl: 1.2635 | stu_lens: 70.5000 | mixed_lens: 68.5000 | lr: 4.8378e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    669/  5000| tot_loss: 2.8863 | rl_loss: 0.8583 | pt_loss: 2.0280 | pg_loss: 0.1592 | reg_loss: 0.6991 | reward: -0.1588 | rev_kl: 1.3322 | stu_lens: 101.5000 | mixed_lens: 99.0000 | lr: 4.8372e-06 | scale: 2048.00 | time: 26.163 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    670/  5000| tot_loss: 2.8046 | rl_loss: 0.9300 | pt_loss: 1.8745 | pg_loss: 0.2873 | reg_loss: 0.6428 | reward: 0.0296 | rev_kl: 2.0695 | stu_lens: 51.0000 | mixed_lens: 72.5000 | lr: 4.8366e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    671/  5000| tot_loss: 2.9194 | rl_loss: 0.9902 | pt_loss: 1.9292 | pg_loss: 0.1588 | reg_loss: 0.8315 | reward: -0.3560 | rev_kl: 1.5613 | stu_lens: 93.5000 | mixed_lens: 107.0000 | lr: 4.8361e-06 | scale: 2048.00 | time: 26.182 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    672/  5000| tot_loss: 2.7513 | rl_loss: 1.1598 | pt_loss: 1.5915 | pg_loss: 0.4649 | reg_loss: 0.6949 | reward: -0.3118 | rev_kl: 0.8236 | stu_lens: 87.0000 | mixed_lens: 83.0000 | lr: 4.8355e-06 | scale: 2048.00 | time: 26.201 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    672/  5000| tot_loss: 2.7893 | rl_loss: 1.0982 | pt_loss: 1.6911 | pg_loss: 0.3218 | reg_loss: 0.7764 | reward: -0.3940 | rev_kl: 1.1874 | stu_lens: 86.9375 | mixed_lens: 84.6250 | lr: 4.8355e-06 | scale: 2048.00 | time: 26.201 | step time: 27.515
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    673/  5000| tot_loss: 2.8490 | rl_loss: 1.4686 | pt_loss: 1.3804 | pg_loss: 0.6340 | reg_loss: 0.8346 | reward: -0.4651 | rev_kl: 1.7623 | stu_lens: 66.5000 | mixed_lens: 56.0000 | lr: 4.8349e-06 | scale: 2048.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    674/  5000| tot_loss: 3.0228 | rl_loss: 0.9564 | pt_loss: 2.0664 | pg_loss: 0.4049 | reg_loss: 0.5515 | reward: -0.6508 | rev_kl: 1.2383 | stu_lens: 68.5000 | mixed_lens: 39.0000 | lr: 4.8343e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    675/  5000| tot_loss: 3.0641 | rl_loss: 0.9670 | pt_loss: 2.0971 | pg_loss: 0.2505 | reg_loss: 0.7165 | reward: -0.3662 | rev_kl: 1.1120 | stu_lens: 76.5000 | mixed_lens: 87.5000 | lr: 4.8338e-06 | scale: 2048.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    676/  5000| tot_loss: 2.3300 | rl_loss: 1.0647 | pt_loss: 1.2653 | pg_loss: 0.4551 | reg_loss: 0.6096 | reward: -0.4628 | rev_kl: 1.2545 | stu_lens: 87.0000 | mixed_lens: 64.0000 | lr: 4.8332e-06 | scale: 2048.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    677/  5000| tot_loss: 2.8903 | rl_loss: 0.6884 | pt_loss: 2.2019 | pg_loss: 0.1151 | reg_loss: 0.5734 | reward: -0.2351 | rev_kl: 1.2791 | stu_lens: 97.0000 | mixed_lens: 118.0000 | lr: 4.8326e-06 | scale: 2048.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    678/  5000| tot_loss: 2.3580 | rl_loss: 0.6432 | pt_loss: 1.7148 | pg_loss: 0.1926 | reg_loss: 0.4506 | reward: -0.2881 | rev_kl: 0.5879 | stu_lens: 74.0000 | mixed_lens: 72.5000 | lr: 4.8320e-06 | scale: 2048.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    679/  5000| tot_loss: 3.2526 | rl_loss: 1.2103 | pt_loss: 2.0423 | pg_loss: 0.4525 | reg_loss: 0.7578 | reward: -0.2941 | rev_kl: 1.2198 | stu_lens: 56.0000 | mixed_lens: 74.5000 | lr: 4.8315e-06 | scale: 2048.00 | time: 26.159 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    680/  5000| tot_loss: 3.0480 | rl_loss: 1.0471 | pt_loss: 2.0009 | pg_loss: 0.3293 | reg_loss: 0.7179 | reward: -0.5782 | rev_kl: 1.1101 | stu_lens: 84.5000 | mixed_lens: 83.0000 | lr: 4.8309e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    681/  5000| tot_loss: 1.9870 | rl_loss: 0.7713 | pt_loss: 1.2157 | pg_loss: 0.3215 | reg_loss: 0.4498 | reward: -0.2269 | rev_kl: 1.2776 | stu_lens: 69.5000 | mixed_lens: 81.5000 | lr: 4.8303e-06 | scale: 2048.00 | time: 26.559 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    682/  5000| tot_loss: 2.6988 | rl_loss: 0.8485 | pt_loss: 1.8503 | pg_loss: 0.3590 | reg_loss: 0.4895 | reward: -0.4200 | rev_kl: 1.3319 | stu_lens: 92.0000 | mixed_lens: 73.0000 | lr: 4.8297e-06 | scale: 2048.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    683/  5000| tot_loss: 2.1250 | rl_loss: 0.3852 | pt_loss: 1.7398 | pg_loss: 0.0366 | reg_loss: 0.3487 | reward: -0.2147 | rev_kl: 0.8288 | stu_lens: 128.0000 | mixed_lens: 121.0000 | lr: 4.8291e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    684/  5000| tot_loss: 2.5764 | rl_loss: 0.4549 | pt_loss: 2.1215 | pg_loss: 0.0191 | reg_loss: 0.4357 | reward: -0.2733 | rev_kl: 1.3292 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8285e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    685/  5000| tot_loss: 2.6384 | rl_loss: 0.7387 | pt_loss: 1.8998 | pg_loss: 0.2684 | reg_loss: 0.4702 | reward: -0.3137 | rev_kl: 1.1319 | stu_lens: 128.0000 | mixed_lens: 82.5000 | lr: 4.8280e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    686/  5000| tot_loss: 2.0384 | rl_loss: 0.6954 | pt_loss: 1.3431 | pg_loss: 0.2920 | reg_loss: 0.4034 | reward: -0.6758 | rev_kl: 1.0727 | stu_lens: 114.0000 | mixed_lens: 83.5000 | lr: 4.8274e-06 | scale: 2048.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    687/  5000| tot_loss: 2.6770 | rl_loss: 1.1471 | pt_loss: 1.5299 | pg_loss: 0.6391 | reg_loss: 0.5080 | reward: -2.2917 | rev_kl: 0.3820 | stu_lens: 51.0000 | mixed_lens: 47.5000 | lr: 4.8268e-06 | scale: 2048.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    688/  5000| tot_loss: 3.1712 | rl_loss: 1.4663 | pt_loss: 1.7049 | pg_loss: 0.9487 | reg_loss: 0.5176 | reward: -0.3767 | rev_kl: 1.0117 | stu_lens: 25.5000 | mixed_lens: 40.0000 | lr: 4.8262e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    688/  5000| tot_loss: 2.6217 | rl_loss: 0.8600 | pt_loss: 1.7616 | pg_loss: 0.3232 | reg_loss: 0.5368 | reward: -0.4079 | rev_kl: 1.2661 | stu_lens: 87.5781 | mixed_lens: 80.4062 | lr: 4.8262e-06 | scale: 2048.00 | time: 26.237 | step time: 27.523
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    689/  5000| tot_loss: 3.2169 | rl_loss: 1.1801 | pt_loss: 2.0367 | pg_loss: 0.3970 | reg_loss: 0.7831 | reward: -0.4431 | rev_kl: 1.0719 | stu_lens: 72.0000 | mixed_lens: 86.0000 | lr: 4.8256e-06 | scale: 2048.00 | time: 26.209 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    690/  5000| tot_loss: 2.4967 | rl_loss: 0.8955 | pt_loss: 1.6013 | pg_loss: 0.3068 | reg_loss: 0.5887 | reward: -0.4511 | rev_kl: 1.0472 | stu_lens: 92.0000 | mixed_lens: 92.5000 | lr: 4.8250e-06 | scale: 2048.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    691/  5000| tot_loss: 2.3832 | rl_loss: 0.4250 | pt_loss: 1.9582 | pg_loss: 0.0534 | reg_loss: 0.3716 | reward: -0.2132 | rev_kl: 1.1890 | stu_lens: 109.5000 | mixed_lens: 121.0000 | lr: 4.8244e-06 | scale: 2048.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    692/  5000| tot_loss: 2.3840 | rl_loss: 0.8335 | pt_loss: 1.5505 | pg_loss: 0.2069 | reg_loss: 0.6266 | reward: -0.4529 | rev_kl: 1.1923 | stu_lens: 128.0000 | mixed_lens: 75.5000 | lr: 4.8239e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    693/  5000| tot_loss: 2.3581 | rl_loss: 0.5370 | pt_loss: 1.8210 | pg_loss: 0.0621 | reg_loss: 0.4750 | reward: -0.1668 | rev_kl: 0.9953 | stu_lens: 128.0000 | mixed_lens: 113.5000 | lr: 4.8233e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    694/  5000| tot_loss: 2.2392 | rl_loss: 0.4133 | pt_loss: 1.8259 | pg_loss: 0.0674 | reg_loss: 0.3459 | reward: -0.2826 | rev_kl: 2.8042 | stu_lens: 91.5000 | mixed_lens: 116.5000 | lr: 4.8227e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    695/  5000| tot_loss: 2.5023 | rl_loss: 0.9337 | pt_loss: 1.5686 | pg_loss: 0.4527 | reg_loss: 0.4810 | reward: 0.3955 | rev_kl: 1.0403 | stu_lens: 37.5000 | mixed_lens: 70.0000 | lr: 4.8221e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    696/  5000| tot_loss: 2.2748 | rl_loss: 0.5153 | pt_loss: 1.7595 | pg_loss: 0.1756 | reg_loss: 0.3397 | reward: -0.4617 | rev_kl: 1.2017 | stu_lens: 124.0000 | mixed_lens: 85.0000 | lr: 4.8215e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    697/  5000| tot_loss: 2.2404 | rl_loss: 0.4255 | pt_loss: 1.8149 | pg_loss: 0.1401 | reg_loss: 0.2855 | reward: 0.1335 | rev_kl: 1.1566 | stu_lens: 57.0000 | mixed_lens: 75.5000 | lr: 4.8209e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    698/  5000| tot_loss: 2.9314 | rl_loss: 1.0412 | pt_loss: 1.8901 | pg_loss: 0.4029 | reg_loss: 0.6384 | reward: -0.5240 | rev_kl: 1.2575 | stu_lens: 91.5000 | mixed_lens: 75.0000 | lr: 4.8203e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    699/  5000| tot_loss: 2.2013 | rl_loss: 0.5302 | pt_loss: 1.6711 | pg_loss: 0.2236 | reg_loss: 0.3065 | reward: -0.2722 | rev_kl: 1.6208 | stu_lens: 128.0000 | mixed_lens: 97.5000 | lr: 4.8197e-06 | scale: 2048.00 | time: 26.259 | step time: 0.000
                                 Evaluation #7                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Because Bob's chances of survival    │
│                                       │ are better if he leaves Alice, he    │
│                                       │ should leave her.                    │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ az and vz are opposites of each      │
│                                       │ other. y and z are opposites of each │
│                                       │ other. so mz kezboard tzpe z instead │
│                                       │ of y and vice versa.                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support over 35 languages. Please │
│                                       │ see our website for a full list.     │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.436 | exact_match: 0.108 | rev_kl: 1.179 | lens: 82.354 | pt_loss: 1.089 | lm_loss: 1.173 | kd_loss: 1.004 
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    700/  5000| tot_loss: 1.9306 | rl_loss: 0.5431 | pt_loss: 1.3875 | pg_loss: 0.0107 | reg_loss: 0.5324 | reward: -0.1872 | rev_kl: 1.1822 | stu_lens: 101.5000 | mixed_lens: 128.0000 | lr: 4.8191e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    701/  5000| tot_loss: 2.2268 | rl_loss: 0.8847 | pt_loss: 1.3421 | pg_loss: 0.5041 | reg_loss: 0.3806 | reward: -0.3251 | rev_kl: 1.4124 | stu_lens: 43.5000 | mixed_lens: 51.5000 | lr: 4.8185e-06 | scale: 2048.00 | time: 26.344 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    702/  5000| tot_loss: 2.4639 | rl_loss: 0.7078 | pt_loss: 1.7561 | pg_loss: 0.3678 | reg_loss: 0.3400 | reward: -0.8117 | rev_kl: 1.3937 | stu_lens: 119.0000 | mixed_lens: 79.0000 | lr: 4.8179e-06 | scale: 2048.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    703/  5000| tot_loss: 2.4354 | rl_loss: 0.9526 | pt_loss: 1.4827 | pg_loss: 0.4003 | reg_loss: 0.5524 | reward: -0.4616 | rev_kl: 1.1846 | stu_lens: 100.5000 | mixed_lens: 77.5000 | lr: 4.8173e-06 | scale: 2048.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    704/  5000| tot_loss: 2.8583 | rl_loss: 0.9289 | pt_loss: 1.9294 | pg_loss: 0.3071 | reg_loss: 0.6218 | reward: -0.2404 | rev_kl: 1.7245 | stu_lens: 87.5000 | mixed_lens: 85.0000 | lr: 4.8167e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    704/  5000| tot_loss: 2.4819 | rl_loss: 0.7931 | pt_loss: 1.6888 | pg_loss: 0.3086 | reg_loss: 0.4845 | reward: -0.4077 | rev_kl: 1.2471 | stu_lens: 86.2969 | mixed_lens: 81.2344 | lr: 4.8167e-06 | scale: 2048.00 | time: 26.289 | step time: 27.537
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    705/  5000| tot_loss: 1.5667 | rl_loss: 0.2842 | pt_loss: 1.2825 | pg_loss: 0.0035 | reg_loss: 0.2807 | reward: -0.1612 | rev_kl: 0.8700 | stu_lens: 110.0000 | mixed_lens: 128.0000 | lr: 4.8161e-06 | scale: 2048.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    706/  5000| tot_loss: 3.2894 | rl_loss: 1.4578 | pt_loss: 1.8315 | pg_loss: 0.1284 | reg_loss: 1.3294 | reward: -0.4690 | rev_kl: 1.0393 | stu_lens: 128.0000 | mixed_lens: 112.0000 | lr: 4.8155e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    707/  5000| tot_loss: 4.8241 | rl_loss: 2.6081 | pt_loss: 2.2160 | pg_loss: 1.1148 | reg_loss: 1.4934 | reward: -2.1751 | rev_kl: 0.7786 | stu_lens: 66.5000 | mixed_lens: 47.0000 | lr: 4.8149e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    708/  5000| tot_loss: 2.2927 | rl_loss: 0.7217 | pt_loss: 1.5710 | pg_loss: 0.0378 | reg_loss: 0.6839 | reward: -0.1616 | rev_kl: 0.9792 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8143e-06 | scale: 2048.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    709/  5000| tot_loss: 2.6856 | rl_loss: 1.2064 | pt_loss: 1.4792 | pg_loss: 0.0837 | reg_loss: 1.1226 | reward: -0.2975 | rev_kl: 0.9749 | stu_lens: 114.5000 | mixed_lens: 111.5000 | lr: 4.8137e-06 | scale: 2048.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    710/  5000| tot_loss: 3.0962 | rl_loss: 1.3678 | pt_loss: 1.7284 | pg_loss: 0.4702 | reg_loss: 0.8975 | reward: 0.0031 | rev_kl: 1.7421 | stu_lens: 63.0000 | mixed_lens: 72.5000 | lr: 4.8131e-06 | scale: 2048.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    711/  5000| tot_loss: 3.7197 | rl_loss: 1.9686 | pt_loss: 1.7511 | pg_loss: 0.0700 | reg_loss: 1.8986 | reward: -0.3905 | rev_kl: 1.3891 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8124e-06 | scale: 2048.00 | time: 26.211 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    712/  5000| tot_loss: 2.6773 | rl_loss: 1.1840 | pt_loss: 1.4933 | pg_loss: 0.0858 | reg_loss: 1.0982 | reward: -0.2748 | rev_kl: 1.0070 | stu_lens: 114.0000 | mixed_lens: 108.0000 | lr: 4.8118e-06 | scale: 2048.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    713/  5000| tot_loss: 2.9468 | rl_loss: 1.3321 | pt_loss: 1.6147 | pg_loss: 0.0289 | reg_loss: 1.3033 | reward: -0.1764 | rev_kl: 1.0691 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8112e-06 | scale: 2048.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    714/  5000| tot_loss: 3.0622 | rl_loss: 1.1296 | pt_loss: 1.9326 | pg_loss: 0.4390 | reg_loss: 0.6906 | reward: -0.0338 | rev_kl: 0.6804 | stu_lens: 73.5000 | mixed_lens: 73.5000 | lr: 4.8106e-06 | scale: 2048.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    715/  5000| tot_loss: 3.2700 | rl_loss: 1.2677 | pt_loss: 2.0023 | pg_loss: 0.3363 | reg_loss: 0.9314 | reward: -0.5179 | rev_kl: 1.4221 | stu_lens: 89.0000 | mixed_lens: 86.5000 | lr: 4.8100e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    716/  5000| tot_loss: 3.3166 | rl_loss: 1.2247 | pt_loss: 2.0919 | pg_loss: 0.0342 | reg_loss: 1.1906 | reward: -0.3926 | rev_kl: 0.7871 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8094e-06 | scale: 2048.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    717/  5000| tot_loss: 3.3324 | rl_loss: 1.5028 | pt_loss: 1.8296 | pg_loss: 0.1780 | reg_loss: 1.3248 | reward: -0.4345 | rev_kl: 0.9536 | stu_lens: 102.5000 | mixed_lens: 110.0000 | lr: 4.8088e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    718/  5000| tot_loss: 1.1159 | rl_loss: -0.7508 | pt_loss: 1.8667 | pg_loss: -1.2024 | reg_loss: 0.4516 | reward: -0.3856 | rev_kl: 0.4235 | stu_lens: 34.0000 | mixed_lens: 7.5000 | lr: 4.8082e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    719/  5000| tot_loss: 2.5595 | rl_loss: 1.3157 | pt_loss: 1.2438 | pg_loss: 0.5808 | reg_loss: 0.7349 | reward: -0.3383 | rev_kl: 0.7540 | stu_lens: 63.5000 | mixed_lens: 60.5000 | lr: 4.8075e-06 | scale: 2048.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    720/  5000| tot_loss: 3.0925 | rl_loss: 1.4727 | pt_loss: 1.6198 | pg_loss: 1.1212 | reg_loss: 0.3515 | reward: -1.2378 | rev_kl: 0.3137 | stu_lens: 7.5000 | mixed_lens: 6.0000 | lr: 4.8069e-06 | scale: 2048.00 | time: 26.245 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    720/  5000| tot_loss: 3.1572 | rl_loss: 1.4538 | pt_loss: 1.7035 | pg_loss: 0.3321 | reg_loss: 1.1216 | reward: -0.3991 | rev_kl: 1.0627 | stu_lens: 93.7344 | mixed_lens: 85.1562 | lr: 4.8069e-06 | scale: 2048.00 | time: 26.245 | step time: 27.518
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    721/  5000| tot_loss: 3.4850 | rl_loss: 1.4151 | pt_loss: 2.0699 | pg_loss: 0.2957 | reg_loss: 1.1194 | reward: -0.2693 | rev_kl: 1.0106 | stu_lens: 60.5000 | mixed_lens: 83.0000 | lr: 4.8063e-06 | scale: 2048.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    722/  5000| tot_loss: 2.7865 | rl_loss: 1.0203 | pt_loss: 1.7663 | pg_loss: 0.3353 | reg_loss: 0.6850 | reward: -0.3061 | rev_kl: 0.7839 | stu_lens: 85.5000 | mixed_lens: 83.0000 | lr: 4.8057e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    723/  5000| tot_loss: 2.7151 | rl_loss: 1.0061 | pt_loss: 1.7090 | pg_loss: 0.2147 | reg_loss: 0.7915 | reward: -0.1992 | rev_kl: 1.4203 | stu_lens: 36.5000 | mixed_lens: 56.5000 | lr: 4.8051e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    724/  5000| tot_loss: 2.5912 | rl_loss: 1.1587 | pt_loss: 1.4325 | pg_loss: 0.3462 | reg_loss: 0.8124 | reward: -0.5043 | rev_kl: 1.2160 | stu_lens: 82.5000 | mixed_lens: 82.0000 | lr: 4.8045e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    725/  5000| tot_loss: 2.6143 | rl_loss: 0.9152 | pt_loss: 1.6991 | pg_loss: 0.1898 | reg_loss: 0.7254 | reward: -0.2574 | rev_kl: 0.8692 | stu_lens: 97.5000 | mixed_lens: 94.5000 | lr: 4.8038e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    726/  5000| tot_loss: 2.5622 | rl_loss: 1.0659 | pt_loss: 1.4964 | pg_loss: 0.4553 | reg_loss: 0.6106 | reward: -0.4310 | rev_kl: 0.9729 | stu_lens: 43.0000 | mixed_lens: 69.0000 | lr: 4.8032e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    727/  5000| tot_loss: 2.6282 | rl_loss: 1.0569 | pt_loss: 1.5714 | pg_loss: 0.0016 | reg_loss: 1.0553 | reward: -0.4546 | rev_kl: 1.2079 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8026e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    728/  5000| tot_loss: 2.6915 | rl_loss: 0.6372 | pt_loss: 2.0543 | pg_loss: 0.1795 | reg_loss: 0.4577 | reward: -0.5349 | rev_kl: 1.0839 | stu_lens: 94.5000 | mixed_lens: 89.5000 | lr: 4.8020e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    729/  5000| tot_loss: 2.7148 | rl_loss: 0.8647 | pt_loss: 1.8501 | pg_loss: 0.5048 | reg_loss: 0.3599 | reward: -0.1567 | rev_kl: 0.4308 | stu_lens: 72.5000 | mixed_lens: 78.5000 | lr: 4.8013e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    730/  5000| tot_loss: 2.0862 | rl_loss: 0.6987 | pt_loss: 1.3875 | pg_loss: 0.1660 | reg_loss: 0.5327 | reward: -0.5198 | rev_kl: 0.6079 | stu_lens: 128.0000 | mixed_lens: 93.0000 | lr: 4.8007e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    731/  5000| tot_loss: 1.7612 | rl_loss: 0.4460 | pt_loss: 1.3151 | pg_loss: -0.0053 | reg_loss: 0.4513 | reward: -0.2376 | rev_kl: 1.0066 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8001e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    732/  5000| tot_loss: 2.5493 | rl_loss: 0.9358 | pt_loss: 1.6135 | pg_loss: 0.3933 | reg_loss: 0.5425 | reward: -1.5065 | rev_kl: 0.9090 | stu_lens: 63.5000 | mixed_lens: 27.0000 | lr: 4.7994e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    733/  5000| tot_loss: 2.5535 | rl_loss: 1.0017 | pt_loss: 1.5518 | pg_loss: 0.1682 | reg_loss: 0.8336 | reward: -0.2891 | rev_kl: 1.0572 | stu_lens: 128.0000 | mixed_lens: 101.0000 | lr: 4.7988e-06 | scale: 2048.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    734/  5000| tot_loss: 2.8100 | rl_loss: 0.8035 | pt_loss: 2.0065 | pg_loss: 0.0920 | reg_loss: 0.7115 | reward: -0.2310 | rev_kl: 1.5470 | stu_lens: 114.5000 | mixed_lens: 111.5000 | lr: 4.7982e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    735/  5000| tot_loss: 2.8451 | rl_loss: 1.2740 | pt_loss: 1.5710 | pg_loss: 0.8143 | reg_loss: 0.4597 | reward: -0.2125 | rev_kl: 0.8633 | stu_lens: 94.0000 | mixed_lens: 45.5000 | lr: 4.7976e-06 | scale: 2048.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    736/  5000| tot_loss: 2.8233 | rl_loss: 0.9672 | pt_loss: 1.8561 | pg_loss: 0.3679 | reg_loss: 0.5993 | reward: -0.6119 | rev_kl: 1.2042 | stu_lens: 72.0000 | mixed_lens: 71.5000 | lr: 4.7969e-06 | scale: 2048.00 | time: 26.242 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    736/  5000| tot_loss: 2.7309 | rl_loss: 1.0210 | pt_loss: 1.7099 | pg_loss: 0.2359 | reg_loss: 0.7852 | reward: -0.4238 | rev_kl: 1.0682 | stu_lens: 88.5312 | mixed_lens: 81.3750 | lr: 4.7969e-06 | scale: 2048.00 | time: 26.242 | step time: 27.519
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    737/  5000| tot_loss: 2.6936 | rl_loss: 1.0058 | pt_loss: 1.6878 | pg_loss: 0.4773 | reg_loss: 0.5285 | reward: -1.8130 | rev_kl: 0.6900 | stu_lens: 66.0000 | mixed_lens: 66.5000 | lr: 4.7963e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    738/  5000| tot_loss: 2.6162 | rl_loss: 0.8097 | pt_loss: 1.8065 | pg_loss: 0.0570 | reg_loss: 0.7527 | reward: -0.5393 | rev_kl: 1.0715 | stu_lens: 102.5000 | mixed_lens: 110.0000 | lr: 4.7957e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    739/  5000| tot_loss: 2.5262 | rl_loss: 0.4579 | pt_loss: 2.0683 | pg_loss: 0.0081 | reg_loss: 0.4498 | reward: -0.2878 | rev_kl: 0.6693 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7950e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    740/  5000| tot_loss: 3.2475 | rl_loss: 1.1875 | pt_loss: 2.0600 | pg_loss: 0.3367 | reg_loss: 0.8508 | reward: -0.7385 | rev_kl: 1.4351 | stu_lens: 128.0000 | mixed_lens: 89.5000 | lr: 4.7944e-06 | scale: 2048.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    741/  5000| tot_loss: 2.1396 | rl_loss: 0.6946 | pt_loss: 1.4450 | pg_loss: 0.1443 | reg_loss: 0.5503 | reward: -0.8979 | rev_kl: 2.4023 | stu_lens: 14.5000 | mixed_lens: 88.0000 | lr: 4.7937e-06 | scale: 2048.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    742/  5000| tot_loss: 1.9222 | rl_loss: 0.2007 | pt_loss: 1.7215 | pg_loss: -0.3203 | reg_loss: 0.5210 | reward: 1.8630 | rev_kl: 0.8616 | stu_lens: 68.0000 | mixed_lens: 15.0000 | lr: 4.7931e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    743/  5000| tot_loss: 2.9586 | rl_loss: 1.3362 | pt_loss: 1.6224 | pg_loss: 0.6560 | reg_loss: 0.6801 | reward: -0.6166 | rev_kl: 1.5787 | stu_lens: 89.0000 | mixed_lens: 59.5000 | lr: 4.7925e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    744/  5000| tot_loss: 2.5981 | rl_loss: 0.9635 | pt_loss: 1.6346 | pg_loss: 0.4716 | reg_loss: 0.4919 | reward: -0.1501 | rev_kl: 0.7496 | stu_lens: 69.0000 | mixed_lens: 70.0000 | lr: 4.7918e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    745/  5000| tot_loss: 2.7067 | rl_loss: 0.8169 | pt_loss: 1.8898 | pg_loss: 0.2743 | reg_loss: 0.5425 | reward: -0.6028 | rev_kl: 1.6599 | stu_lens: 58.5000 | mixed_lens: 55.0000 | lr: 4.7912e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    746/  5000| tot_loss: 2.5780 | rl_loss: 0.8767 | pt_loss: 1.7013 | pg_loss: 0.4439 | reg_loss: 0.4328 | reward: 0.0331 | rev_kl: 1.2361 | stu_lens: 90.5000 | mixed_lens: 72.5000 | lr: 4.7906e-06 | scale: 2048.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    747/  5000| tot_loss: 2.8037 | rl_loss: 1.3486 | pt_loss: 1.4551 | pg_loss: 0.4853 | reg_loss: 0.8633 | reward: -0.5864 | rev_kl: 0.7705 | stu_lens: 66.0000 | mixed_lens: 66.0000 | lr: 4.7899e-06 | scale: 2048.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    748/  5000| tot_loss: 2.0241 | rl_loss: 0.4232 | pt_loss: 1.6010 | pg_loss: 0.0518 | reg_loss: 0.3714 | reward: -0.2131 | rev_kl: 1.2379 | stu_lens: 128.0000 | mixed_lens: 115.5000 | lr: 4.7893e-06 | scale: 2048.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    749/  5000| tot_loss: 2.3970 | rl_loss: 0.8574 | pt_loss: 1.5396 | pg_loss: 0.3300 | reg_loss: 0.5274 | reward: -0.0574 | rev_kl: 0.7492 | stu_lens: 72.5000 | mixed_lens: 78.5000 | lr: 4.7886e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/750
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    750/  5000| tot_loss: 2.6614 | rl_loss: 0.5930 | pt_loss: 2.0684 | pg_loss: 0.0665 | reg_loss: 0.5265 | reward: -0.2694 | rev_kl: 1.0262 | stu_lens: 128.0000 | mixed_lens: 120.5000 | lr: 4.7880e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    751/  5000| tot_loss: 2.8960 | rl_loss: 1.1541 | pt_loss: 1.7419 | pg_loss: 0.3313 | reg_loss: 0.8228 | reward: -0.5109 | rev_kl: 0.8506 | stu_lens: 97.5000 | mixed_lens: 94.5000 | lr: 4.7873e-06 | scale: 2048.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    752/  5000| tot_loss: 1.3676 | rl_loss: 0.6147 | pt_loss: 0.7529 | pg_loss: -0.0094 | reg_loss: 0.6241 | reward: -0.1604 | rev_kl: 1.3813 | stu_lens: 103.0000 | mixed_lens: 128.0000 | lr: 4.7867e-06 | scale: 2048.00 | time: 26.259 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    752/  5000| tot_loss: 2.5813 | rl_loss: 0.8987 | pt_loss: 1.6825 | pg_loss: 0.3291 | reg_loss: 0.5696 | reward: -0.4799 | rev_kl: 1.0340 | stu_lens: 89.3750 | mixed_lens: 84.0625 | lr: 4.7867e-06 | scale: 2048.00 | time: 26.259 | step time: 27.536
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    753/  5000| tot_loss: 2.3670 | rl_loss: 0.7884 | pt_loss: 1.5786 | pg_loss: 0.1453 | reg_loss: 0.6431 | reward: -0.6275 | rev_kl: 1.3565 | stu_lens: 128.0000 | mixed_lens: 108.5000 | lr: 4.7860e-06 | scale: 2048.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    754/  5000| tot_loss: 2.4116 | rl_loss: 0.5581 | pt_loss: 1.8535 | pg_loss: 0.2016 | reg_loss: 0.3565 | reward: -0.2363 | rev_kl: 1.1248 | stu_lens: 126.5000 | mixed_lens: 90.0000 | lr: 4.7854e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    755/  5000| tot_loss: 3.2811 | rl_loss: 1.1301 | pt_loss: 2.1510 | pg_loss: 0.5846 | reg_loss: 0.5455 | reward: -1.0869 | rev_kl: 0.8978 | stu_lens: 65.0000 | mixed_lens: 65.0000 | lr: 4.7847e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    756/  5000| tot_loss: 2.1308 | rl_loss: 0.6864 | pt_loss: 1.4444 | pg_loss: 0.2289 | reg_loss: 0.4575 | reward: -0.6008 | rev_kl: 1.0237 | stu_lens: 128.0000 | mixed_lens: 101.0000 | lr: 4.7841e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    757/  5000| tot_loss: 1.8099 | rl_loss: 0.3723 | pt_loss: 1.4376 | pg_loss: 0.0861 | reg_loss: 0.2862 | reward: -0.4388 | rev_kl: 0.5190 | stu_lens: 128.0000 | mixed_lens: 112.0000 | lr: 4.7834e-06 | scale: 2048.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    758/  5000| tot_loss: 3.1079 | rl_loss: 1.1698 | pt_loss: 1.9382 | pg_loss: 0.6691 | reg_loss: 0.5007 | reward: -0.9765 | rev_kl: 2.7063 | stu_lens: 29.5000 | mixed_lens: 62.5000 | lr: 4.7828e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    759/  5000| tot_loss: 2.3041 | rl_loss: 0.8484 | pt_loss: 1.4556 | pg_loss: 0.2625 | reg_loss: 0.5859 | reward: -0.6142 | rev_kl: 1.1970 | stu_lens: 128.0000 | mixed_lens: 101.0000 | lr: 4.7821e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    760/  5000| tot_loss: 1.7638 | rl_loss: 0.3609 | pt_loss: 1.4029 | pg_loss: 0.1313 | reg_loss: 0.2297 | reward: -0.1625 | rev_kl: 0.7886 | stu_lens: 94.5000 | mixed_lens: 75.0000 | lr: 4.7815e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    761/  5000| tot_loss: 3.0152 | rl_loss: 1.0882 | pt_loss: 1.9270 | pg_loss: 0.2918 | reg_loss: 0.7964 | reward: -0.3512 | rev_kl: 1.0934 | stu_lens: 72.0000 | mixed_lens: 66.5000 | lr: 4.7808e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    762/  5000| tot_loss: 3.3021 | rl_loss: 0.8841 | pt_loss: 2.4181 | pg_loss: 0.4649 | reg_loss: 0.4191 | reward: 0.0235 | rev_kl: 1.5590 | stu_lens: 90.5000 | mixed_lens: 72.5000 | lr: 4.7802e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    763/  5000| tot_loss: 2.6373 | rl_loss: 0.9287 | pt_loss: 1.7086 | pg_loss: 0.3570 | reg_loss: 0.5717 | reward: 1.8178 | rev_kl: 0.7339 | stu_lens: 34.0000 | mixed_lens: 34.0000 | lr: 4.7795e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    764/  5000| tot_loss: 2.3140 | rl_loss: 0.5653 | pt_loss: 1.7487 | pg_loss: 0.0087 | reg_loss: 0.5566 | reward: -0.5522 | rev_kl: 0.5905 | stu_lens: 45.0000 | mixed_lens: 51.0000 | lr: 4.7788e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    765/  5000| tot_loss: 1.8446 | rl_loss: 0.3923 | pt_loss: 1.4523 | pg_loss: 0.0165 | reg_loss: 0.3759 | reward: -0.2758 | rev_kl: 1.5154 | stu_lens: 100.5000 | mixed_lens: 128.0000 | lr: 4.7782e-06 | scale: 2048.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    766/  5000| tot_loss: 3.2311 | rl_loss: 1.6021 | pt_loss: 1.6290 | pg_loss: 0.7632 | reg_loss: 0.8389 | reward: -1.0367 | rev_kl: 1.2259 | stu_lens: 81.0000 | mixed_lens: 19.0000 | lr: 4.7775e-06 | scale: 2048.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    767/  5000| tot_loss: 2.8425 | rl_loss: 1.1292 | pt_loss: 1.7133 | pg_loss: 0.5416 | reg_loss: 0.5876 | reward: -0.3110 | rev_kl: 0.7306 | stu_lens: 72.5000 | mixed_lens: 78.5000 | lr: 4.7769e-06 | scale: 2048.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    768/  5000| tot_loss: 2.9676 | rl_loss: 0.6088 | pt_loss: 2.3588 | pg_loss: 0.0829 | reg_loss: 0.5259 | reward: -0.4259 | rev_kl: 1.1240 | stu_lens: 94.5000 | mixed_lens: 113.0000 | lr: 4.7762e-06 | scale: 2048.00 | time: 26.322 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    768/  5000| tot_loss: 2.4128 | rl_loss: 0.7216 | pt_loss: 1.6912 | pg_loss: 0.2685 | reg_loss: 0.4531 | reward: -0.4002 | rev_kl: 1.0694 | stu_lens: 94.6719 | mixed_lens: 84.0312 | lr: 4.7762e-06 | scale: 2048.00 | time: 26.322 | step time: 27.543
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    769/  5000| tot_loss: 2.0505 | rl_loss: 0.7791 | pt_loss: 1.2714 | pg_loss: 0.3430 | reg_loss: 0.4361 | reward: -1.7934 | rev_kl: 0.8345 | stu_lens: 41.5000 | mixed_lens: 66.5000 | lr: 4.7755e-06 | scale: 2048.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    770/  5000| tot_loss: 3.1173 | rl_loss: 1.2873 | pt_loss: 1.8299 | pg_loss: 0.3416 | reg_loss: 0.9458 | reward: -1.2725 | rev_kl: 1.1646 | stu_lens: 71.0000 | mixed_lens: 71.0000 | lr: 4.7749e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    771/  5000| tot_loss: 3.6863 | rl_loss: 1.8549 | pt_loss: 1.8313 | pg_loss: 0.3159 | reg_loss: 1.5391 | reward: -0.5009 | rev_kl: 1.5757 | stu_lens: 86.0000 | mixed_lens: 87.0000 | lr: 4.7742e-06 | scale: 2048.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    772/  5000| tot_loss: 2.8494 | rl_loss: 1.3885 | pt_loss: 1.4609 | pg_loss: 0.2371 | reg_loss: 1.1514 | reward: -0.3721 | rev_kl: 0.9792 | stu_lens: 74.0000 | mixed_lens: 32.5000 | lr: 4.7735e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    773/  5000| tot_loss: 3.8484 | rl_loss: 2.0471 | pt_loss: 1.8013 | pg_loss: 0.6835 | reg_loss: 1.3635 | reward: -0.2161 | rev_kl: 1.1980 | stu_lens: 59.0000 | mixed_lens: 59.0000 | lr: 4.7729e-06 | scale: 2048.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    774/  5000| tot_loss: 3.0734 | rl_loss: 1.3283 | pt_loss: 1.7450 | pg_loss: 0.0432 | reg_loss: 1.2852 | reward: -0.0452 | rev_kl: 1.3052 | stu_lens: 55.5000 | mixed_lens: 128.0000 | lr: 4.7722e-06 | scale: 2048.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    775/  5000| tot_loss: 4.6360 | rl_loss: 2.9032 | pt_loss: 1.7329 | pg_loss: 0.8529 | reg_loss: 2.0502 | reward: -1.8013 | rev_kl: 0.9753 | stu_lens: 54.0000 | mixed_lens: 61.5000 | lr: 4.7715e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    776/  5000| tot_loss: 3.4540 | rl_loss: 1.7438 | pt_loss: 1.7101 | pg_loss: 0.1550 | reg_loss: 1.5888 | reward: -0.3454 | rev_kl: 1.3382 | stu_lens: 81.0000 | mixed_lens: 117.0000 | lr: 4.7709e-06 | scale: 2048.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    777/  5000| tot_loss: 3.0800 | rl_loss: 1.3740 | pt_loss: 1.7060 | pg_loss: 0.4046 | reg_loss: 0.9694 | reward: -0.2061 | rev_kl: 1.9067 | stu_lens: 47.0000 | mixed_lens: 79.5000 | lr: 4.7702e-06 | scale: 2048.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    778/  5000| tot_loss: 3.4107 | rl_loss: 1.7665 | pt_loss: 1.6442 | pg_loss: 0.6655 | reg_loss: 1.1010 | reward: -1.0755 | rev_kl: 0.7766 | stu_lens: 106.0000 | mixed_lens: 44.5000 | lr: 4.7695e-06 | scale: 2048.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    779/  5000| tot_loss: 2.8897 | rl_loss: 1.4467 | pt_loss: 1.4430 | pg_loss: 0.1082 | reg_loss: 1.3385 | reward: -0.2568 | rev_kl: 1.1944 | stu_lens: 115.0000 | mixed_lens: 119.5000 | lr: 4.7688e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    780/  5000| tot_loss: 4.1277 | rl_loss: 1.9689 | pt_loss: 2.1588 | pg_loss: 1.0464 | reg_loss: 0.9225 | reward: -0.3141 | rev_kl: 0.4755 | stu_lens: 75.0000 | mixed_lens: 31.0000 | lr: 4.7682e-06 | scale: 2048.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    781/  5000| tot_loss: 3.5523 | rl_loss: 1.9715 | pt_loss: 1.5807 | pg_loss: 0.4853 | reg_loss: 1.4862 | reward: -0.5664 | rev_kl: 1.7201 | stu_lens: 12.5000 | mixed_lens: 72.0000 | lr: 4.7675e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    782/  5000| tot_loss: 3.8009 | rl_loss: 1.8972 | pt_loss: 1.9038 | pg_loss: 0.5595 | reg_loss: 1.3376 | reward: -0.2712 | rev_kl: 2.3783 | stu_lens: 61.0000 | mixed_lens: 79.5000 | lr: 4.7668e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    783/  5000| tot_loss: 3.5238 | rl_loss: 1.4096 | pt_loss: 2.1142 | pg_loss: 0.0836 | reg_loss: 1.3260 | reward: -0.3585 | rev_kl: 0.8056 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7661e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    784/  5000| tot_loss: 3.6675 | rl_loss: 1.7791 | pt_loss: 1.8883 | pg_loss: 0.4257 | reg_loss: 1.3534 | reward: -0.3261 | rev_kl: 0.7284 | stu_lens: 43.5000 | mixed_lens: 66.0000 | lr: 4.7655e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    784/  5000| tot_loss: 3.3315 | rl_loss: 1.6156 | pt_loss: 1.7159 | pg_loss: 0.4559 | reg_loss: 1.1597 | reward: -0.4940 | rev_kl: 1.1007 | stu_lens: 76.2344 | mixed_lens: 77.7656 | lr: 4.7655e-06 | scale: 2048.00 | time: 26.255 | step time: 27.525
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    785/  5000| tot_loss: 2.5651 | rl_loss: 1.2254 | pt_loss: 1.3398 | pg_loss: 0.0703 | reg_loss: 1.1550 | reward: -0.2275 | rev_kl: 0.9586 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7648e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    786/  5000| tot_loss: 1.9962 | rl_loss: 0.3865 | pt_loss: 1.6097 | pg_loss: 0.0724 | reg_loss: 0.3141 | reward: -0.0927 | rev_kl: 0.8317 | stu_lens: 128.0000 | mixed_lens: 109.0000 | lr: 4.7641e-06 | scale: 2048.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    787/  5000| tot_loss: 3.0151 | rl_loss: 1.1683 | pt_loss: 1.8468 | pg_loss: 0.3834 | reg_loss: 0.7850 | reward: -0.2903 | rev_kl: 0.6477 | stu_lens: 75.0000 | mixed_lens: 75.5000 | lr: 4.7634e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    788/  5000| tot_loss: 3.2786 | rl_loss: 1.8150 | pt_loss: 1.4636 | pg_loss: 0.9551 | reg_loss: 0.8600 | reward: -0.5869 | rev_kl: 1.2909 | stu_lens: 32.0000 | mixed_lens: 41.5000 | lr: 4.7627e-06 | scale: 2048.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    789/  5000| tot_loss: 2.4965 | rl_loss: 1.0311 | pt_loss: 1.4655 | pg_loss: 0.3130 | reg_loss: 0.7181 | reward: -0.6849 | rev_kl: 1.1785 | stu_lens: 77.5000 | mixed_lens: 83.0000 | lr: 4.7621e-06 | scale: 2048.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    790/  5000| tot_loss: 2.9345 | rl_loss: 1.1285 | pt_loss: 1.8060 | pg_loss: 0.2715 | reg_loss: 0.8570 | reward: -0.3576 | rev_kl: 1.1667 | stu_lens: 101.0000 | mixed_lens: 82.5000 | lr: 4.7614e-06 | scale: 2048.00 | time: 26.205 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    791/  5000| tot_loss: 3.2586 | rl_loss: 1.3081 | pt_loss: 1.9505 | pg_loss: 0.2157 | reg_loss: 1.0924 | reward: -0.2688 | rev_kl: 1.2988 | stu_lens: 103.0000 | mixed_lens: 106.0000 | lr: 4.7607e-06 | scale: 2048.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    792/  5000| tot_loss: 2.8434 | rl_loss: 1.4087 | pt_loss: 1.4347 | pg_loss: 0.3619 | reg_loss: 1.0468 | reward: -0.2070 | rev_kl: 1.1687 | stu_lens: 85.0000 | mixed_lens: 85.5000 | lr: 4.7600e-06 | scale: 2048.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    793/  5000| tot_loss: 2.9302 | rl_loss: 1.4258 | pt_loss: 1.5044 | pg_loss: 0.7187 | reg_loss: 0.7071 | reward: -0.6797 | rev_kl: 0.5603 | stu_lens: 20.0000 | mixed_lens: 42.0000 | lr: 4.7593e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    794/  5000| tot_loss: 3.5936 | rl_loss: 1.3195 | pt_loss: 2.2741 | pg_loss: 0.1769 | reg_loss: 1.1426 | reward: -0.2884 | rev_kl: 1.1480 | stu_lens: 96.0000 | mixed_lens: 96.0000 | lr: 4.7586e-06 | scale: 2048.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    795/  5000| tot_loss: 3.1050 | rl_loss: 1.6633 | pt_loss: 1.4418 | pg_loss: 0.8596 | reg_loss: 0.8037 | reward: -0.7080 | rev_kl: 1.2774 | stu_lens: 58.5000 | mixed_lens: 55.5000 | lr: 4.7580e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    796/  5000| tot_loss: 2.3316 | rl_loss: 0.4960 | pt_loss: 1.8355 | pg_loss: 0.1327 | reg_loss: 0.3633 | reward: -0.4079 | rev_kl: 1.2673 | stu_lens: 79.0000 | mixed_lens: 80.5000 | lr: 4.7573e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    797/  5000| tot_loss: 2.8443 | rl_loss: 1.1033 | pt_loss: 1.7409 | pg_loss: 0.5028 | reg_loss: 0.6005 | reward: -0.2508 | rev_kl: 1.0209 | stu_lens: 43.5000 | mixed_lens: 71.0000 | lr: 4.7566e-06 | scale: 2048.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    798/  5000| tot_loss: 2.8299 | rl_loss: 1.0399 | pt_loss: 1.7900 | pg_loss: 0.0360 | reg_loss: 1.0039 | reward: -0.2423 | rev_kl: 1.5627 | stu_lens: 71.5000 | mixed_lens: 121.5000 | lr: 4.7559e-06 | scale: 2048.00 | time: 26.204 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    799/  5000| tot_loss: 4.1104 | rl_loss: 2.3074 | pt_loss: 1.8030 | pg_loss: 1.1727 | reg_loss: 1.1347 | reward: -1.8305 | rev_kl: 0.6455 | stu_lens: 72.0000 | mixed_lens: 25.0000 | lr: 4.7552e-06 | scale: 2048.00 | time: 26.231 | step time: 0.000
                                 Evaluation #8                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ It is better for Bob to leave Alice, │
│                                       │ as he has a greater chance of        │
│                                       │ survival.                            │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ The kezboard tzpe z instead of y and │
│                                       │ vice versa is a feature to help      │
│                                       │ users with typing on mobile devices. │
│                                       │ The kezboard tzpe z instead of y and │
│                                       │ vice versa allows users to type with │
│                                       │ one hand, without hitting the shift  │
│                                       │ key.                                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support over 85 languages.        │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.768 | exact_match: 0.215 | rev_kl: 1.104 | lens: 79.543 | pt_loss: 1.086 | lm_loss: 1.171 | kd_loss: 1.000 
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    800/  5000| tot_loss: 2.1658 | rl_loss: 0.9237 | pt_loss: 1.2421 | pg_loss: 0.0223 | reg_loss: 0.9013 | reward: -0.0962 | rev_kl: 1.2426 | stu_lens: 91.0000 | mixed_lens: 128.0000 | lr: 4.7545e-06 | scale: 2048.00 | time: 26.228 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    800/  5000| tot_loss: 2.8744 | rl_loss: 1.1639 | pt_loss: 1.7104 | pg_loss: 0.3556 | reg_loss: 0.8084 | reward: -0.4422 | rev_kl: 1.0679 | stu_lens: 79.4844 | mixed_lens: 80.8594 | lr: 4.7545e-06 | scale: 2048.00 | time: 26.228 | step time: 27.495
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    801/  5000| tot_loss: 2.3755 | rl_loss: 0.9450 | pt_loss: 1.4305 | pg_loss: 0.2001 | reg_loss: 0.7449 | reward: -0.1114 | rev_kl: 1.9927 | stu_lens: 95.5000 | mixed_lens: 105.5000 | lr: 4.7538e-06 | scale: 2048.00 | time: 26.329 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    802/  5000| tot_loss: 3.2033 | rl_loss: 1.5510 | pt_loss: 1.6523 | pg_loss: 0.7409 | reg_loss: 0.8101 | reward: -0.4011 | rev_kl: 1.3840 | stu_lens: 64.0000 | mixed_lens: 61.5000 | lr: 4.7531e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    803/  5000| tot_loss: 2.3789 | rl_loss: 0.7072 | pt_loss: 1.6718 | pg_loss: 0.2118 | reg_loss: 0.4954 | reward: -0.1786 | rev_kl: 1.8046 | stu_lens: 95.5000 | mixed_lens: 86.5000 | lr: 4.7524e-06 | scale: 2048.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    804/  5000| tot_loss: 2.3454 | rl_loss: 0.7639 | pt_loss: 1.5815 | pg_loss: 0.0509 | reg_loss: 0.7130 | reward: -0.2558 | rev_kl: 1.7423 | stu_lens: 71.5000 | mixed_lens: 121.5000 | lr: 4.7517e-06 | scale: 2048.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    805/  5000| tot_loss: 3.6391 | rl_loss: 1.8064 | pt_loss: 1.8327 | pg_loss: 1.3049 | reg_loss: 0.5015 | reward: -1.8147 | rev_kl: 0.2968 | stu_lens: 12.5000 | mixed_lens: 21.5000 | lr: 4.7510e-06 | scale: 2048.00 | time: 26.204 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    806/  5000| tot_loss: 3.6183 | rl_loss: 1.5005 | pt_loss: 2.1178 | pg_loss: 0.7801 | reg_loss: 0.7204 | reward: -0.7080 | rev_kl: 1.2774 | stu_lens: 58.5000 | mixed_lens: 55.5000 | lr: 4.7503e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    807/  5000| tot_loss: 2.8357 | rl_loss: 1.1390 | pt_loss: 1.6967 | pg_loss: 0.4685 | reg_loss: 0.6705 | reward: -0.2033 | rev_kl: 0.4471 | stu_lens: 128.0000 | mixed_lens: 37.0000 | lr: 4.7496e-06 | scale: 2048.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    808/  5000| tot_loss: 2.5769 | rl_loss: 0.7719 | pt_loss: 1.8050 | pg_loss: 0.4225 | reg_loss: 0.3493 | reward: -0.3080 | rev_kl: 0.5333 | stu_lens: 18.0000 | mixed_lens: 50.0000 | lr: 4.7489e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    809/  5000| tot_loss: 2.9104 | rl_loss: 1.4345 | pt_loss: 1.4758 | pg_loss: 0.6415 | reg_loss: 0.7931 | reward: -0.4000 | rev_kl: 1.2015 | stu_lens: 66.0000 | mixed_lens: 51.5000 | lr: 4.7482e-06 | scale: 2048.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    810/  5000| tot_loss: 2.2104 | rl_loss: 0.4186 | pt_loss: 1.7918 | pg_loss: 0.0163 | reg_loss: 0.4023 | reward: -0.0252 | rev_kl: 0.9286 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7475e-06 | scale: 2048.00 | time: 26.329 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    811/  5000| tot_loss: 3.2921 | rl_loss: 1.0899 | pt_loss: 2.2022 | pg_loss: 0.6368 | reg_loss: 0.4531 | reward: -1.2222 | rev_kl: 1.2898 | stu_lens: 79.5000 | mixed_lens: 39.0000 | lr: 4.7468e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    812/  5000| tot_loss: 2.1739 | rl_loss: 0.8577 | pt_loss: 1.3162 | pg_loss: 0.3118 | reg_loss: 0.5459 | reward: -0.3780 | rev_kl: 1.4124 | stu_lens: 33.0000 | mixed_lens: 76.0000 | lr: 4.7461e-06 | scale: 2048.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    813/  5000| tot_loss: 2.9327 | rl_loss: 0.9900 | pt_loss: 1.9428 | pg_loss: 0.2709 | reg_loss: 0.7191 | reward: -0.3674 | rev_kl: 1.7550 | stu_lens: 68.5000 | mixed_lens: 88.0000 | lr: 4.7454e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    814/  5000| tot_loss: 2.2200 | rl_loss: 0.5872 | pt_loss: 1.6328 | pg_loss: 0.0274 | reg_loss: 0.5598 | reward: -0.2923 | rev_kl: 1.0751 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7447e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    815/  5000| tot_loss: 2.1574 | rl_loss: 0.6673 | pt_loss: 1.4901 | pg_loss: -0.0016 | reg_loss: 0.6688 | reward: -0.3979 | rev_kl: 1.0481 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7440e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    816/  5000| tot_loss: 2.3009 | rl_loss: 0.7306 | pt_loss: 1.5702 | pg_loss: 0.4344 | reg_loss: 0.2963 | reward: -0.1439 | rev_kl: 0.8099 | stu_lens: 71.0000 | mixed_lens: 71.0000 | lr: 4.7433e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    816/  5000| tot_loss: 2.6097 | rl_loss: 0.9375 | pt_loss: 1.6722 | pg_loss: 0.3392 | reg_loss: 0.5983 | reward: -0.4242 | rev_kl: 1.1642 | stu_lens: 80.6875 | mixed_lens: 84.2656 | lr: 4.7433e-06 | scale: 2048.00 | time: 26.257 | step time: 27.524
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    817/  5000| tot_loss: 3.1227 | rl_loss: 1.2591 | pt_loss: 1.8636 | pg_loss: 0.6682 | reg_loss: 0.5909 | reward: -0.6552 | rev_kl: 1.2824 | stu_lens: 86.0000 | mixed_lens: 55.0000 | lr: 4.7426e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    818/  5000| tot_loss: 2.4349 | rl_loss: 0.7112 | pt_loss: 1.7238 | pg_loss: 0.3842 | reg_loss: 0.3269 | reward: -0.4450 | rev_kl: 0.9440 | stu_lens: 55.5000 | mixed_lens: 55.5000 | lr: 4.7419e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    819/  5000| tot_loss: 2.3924 | rl_loss: 0.5226 | pt_loss: 1.8698 | pg_loss: 0.0679 | reg_loss: 0.4547 | reward: -0.2315 | rev_kl: 0.9602 | stu_lens: 103.0000 | mixed_lens: 114.0000 | lr: 4.7412e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    820/  5000| tot_loss: 3.1114 | rl_loss: 1.0026 | pt_loss: 2.1088 | pg_loss: 0.5635 | reg_loss: 0.4392 | reward: -0.4248 | rev_kl: 1.2183 | stu_lens: 30.0000 | mixed_lens: 60.5000 | lr: 4.7405e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    821/  5000| tot_loss: 2.1792 | rl_loss: 0.5366 | pt_loss: 1.6426 | pg_loss: 0.0002 | reg_loss: 0.5364 | reward: -0.4010 | rev_kl: 1.6396 | stu_lens: 111.5000 | mixed_lens: 128.0000 | lr: 4.7398e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    822/  5000| tot_loss: 1.8387 | rl_loss: 0.4488 | pt_loss: 1.3899 | pg_loss: 0.1226 | reg_loss: 0.3263 | reward: -0.2626 | rev_kl: 1.1866 | stu_lens: 128.0000 | mixed_lens: 109.0000 | lr: 4.7390e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    823/  5000| tot_loss: 2.0754 | rl_loss: 0.5476 | pt_loss: 1.5278 | pg_loss: 0.1249 | reg_loss: 0.4227 | reward: -0.4947 | rev_kl: 0.9132 | stu_lens: 106.0000 | mixed_lens: 94.5000 | lr: 4.7383e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    824/  5000| tot_loss: 2.3464 | rl_loss: 0.4176 | pt_loss: 1.9288 | pg_loss: 0.0641 | reg_loss: 0.3535 | reward: -0.3469 | rev_kl: 1.1519 | stu_lens: 107.0000 | mixed_lens: 120.0000 | lr: 4.7376e-06 | scale: 2048.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    825/  5000| tot_loss: 2.4255 | rl_loss: 0.6472 | pt_loss: 1.7782 | pg_loss: 0.3170 | reg_loss: 0.3302 | reward: -1.2392 | rev_kl: 1.3769 | stu_lens: 111.5000 | mixed_lens: 71.0000 | lr: 4.7369e-06 | scale: 2048.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    826/  5000| tot_loss: 2.3596 | rl_loss: 0.7454 | pt_loss: 1.6142 | pg_loss: 0.2315 | reg_loss: 0.5139 | reward: -0.4296 | rev_kl: 1.1430 | stu_lens: 103.0000 | mixed_lens: 88.5000 | lr: 4.7362e-06 | scale: 2048.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    827/  5000| tot_loss: 3.2316 | rl_loss: 1.0568 | pt_loss: 2.1748 | pg_loss: 0.7869 | reg_loss: 0.2699 | reward: -0.1130 | rev_kl: 0.6734 | stu_lens: 82.5000 | mixed_lens: 46.5000 | lr: 4.7355e-06 | scale: 2048.00 | time: 26.207 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    828/  5000| tot_loss: 2.4782 | rl_loss: 0.6925 | pt_loss: 1.7857 | pg_loss: 0.4296 | reg_loss: 0.2629 | reward: 0.2598 | rev_kl: 1.0763 | stu_lens: 46.0000 | mixed_lens: 41.0000 | lr: 4.7347e-06 | scale: 2048.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    829/  5000| tot_loss: 3.0280 | rl_loss: 1.4302 | pt_loss: 1.5978 | pg_loss: 0.7316 | reg_loss: 0.6986 | reward: -1.7540 | rev_kl: 0.9344 | stu_lens: 72.0000 | mixed_lens: 58.5000 | lr: 4.7340e-06 | scale: 2048.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    830/  5000| tot_loss: 2.2421 | rl_loss: 0.2880 | pt_loss: 1.9542 | pg_loss: -0.0241 | reg_loss: 0.3121 | reward: -0.0953 | rev_kl: 0.9345 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7333e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    831/  5000| tot_loss: 2.4769 | rl_loss: 0.8405 | pt_loss: 1.6364 | pg_loss: 0.3019 | reg_loss: 0.5386 | reward: -0.1864 | rev_kl: 1.9920 | stu_lens: 82.5000 | mixed_lens: 97.0000 | lr: 4.7326e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    832/  5000| tot_loss: 3.0750 | rl_loss: 1.5698 | pt_loss: 1.5051 | pg_loss: 0.5686 | reg_loss: 1.0012 | reward: -1.1364 | rev_kl: 1.0803 | stu_lens: 128.0000 | mixed_lens: 34.0000 | lr: 4.7319e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    832/  5000| tot_loss: 2.5442 | rl_loss: 0.8102 | pt_loss: 1.7340 | pg_loss: 0.3549 | reg_loss: 0.4554 | reward: -0.4493 | rev_kl: 1.1015 | stu_lens: 79.2344 | mixed_lens: 79.0312 | lr: 4.7319e-06 | scale: 2048.00 | time: 26.279 | step time: 27.525
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    833/  5000| tot_loss: 2.0066 | rl_loss: 0.4638 | pt_loss: 1.5428 | pg_loss: 0.2339 | reg_loss: 0.2299 | reward: -0.1815 | rev_kl: 0.9256 | stu_lens: 74.0000 | mixed_lens: 76.5000 | lr: 4.7311e-06 | scale: 2048.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    834/  5000| tot_loss: 2.9328 | rl_loss: 0.9590 | pt_loss: 1.9738 | pg_loss: 0.2686 | reg_loss: 0.6904 | reward: 0.1702 | rev_kl: 0.9205 | stu_lens: 79.0000 | mixed_lens: 45.5000 | lr: 4.7304e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    835/  5000| tot_loss: 3.0402 | rl_loss: 1.5077 | pt_loss: 1.5325 | pg_loss: 0.2509 | reg_loss: 1.2568 | reward: 0.1662 | rev_kl: 0.7804 | stu_lens: 113.0000 | mixed_lens: 92.0000 | lr: 4.7297e-06 | scale: 2048.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    836/  5000| tot_loss: 3.0141 | rl_loss: 2.1298 | pt_loss: 0.8843 | pg_loss: 0.6238 | reg_loss: 1.5060 | reward: -0.6417 | rev_kl: 0.6687 | stu_lens: 67.5000 | mixed_lens: 47.5000 | lr: 4.7290e-06 | scale: 2048.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    837/  5000| tot_loss: 2.7982 | rl_loss: 1.2224 | pt_loss: 1.5758 | pg_loss: 0.0574 | reg_loss: 1.1649 | reward: -0.2045 | rev_kl: 1.2423 | stu_lens: 80.0000 | mixed_lens: 128.0000 | lr: 4.7282e-06 | scale: 2048.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    838/  5000| tot_loss: 3.6383 | rl_loss: 1.7087 | pt_loss: 1.9296 | pg_loss: 0.2234 | reg_loss: 1.4852 | reward: -0.4196 | rev_kl: 0.7247 | stu_lens: 77.5000 | mixed_lens: 91.5000 | lr: 4.7275e-06 | scale: 2048.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    839/  5000| tot_loss: 3.5978 | rl_loss: 1.8510 | pt_loss: 1.7467 | pg_loss: 0.0436 | reg_loss: 1.8075 | reward: -0.3205 | rev_kl: 1.6241 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7268e-06 | scale: 2048.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    840/  5000| tot_loss: 3.2093 | rl_loss: 1.3964 | pt_loss: 1.8129 | pg_loss: 0.4144 | reg_loss: 0.9819 | reward: -0.1534 | rev_kl: 0.7927 | stu_lens: 87.0000 | mixed_lens: 86.0000 | lr: 4.7261e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    841/  5000| tot_loss: 3.4214 | rl_loss: 1.7887 | pt_loss: 1.6327 | pg_loss: 0.3368 | reg_loss: 1.4520 | reward: -0.2874 | rev_kl: 1.6325 | stu_lens: 69.5000 | mixed_lens: 84.0000 | lr: 4.7253e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    842/  5000| tot_loss: 4.0573 | rl_loss: 2.2805 | pt_loss: 1.7768 | pg_loss: 0.7871 | reg_loss: 1.4934 | reward: -0.8893 | rev_kl: 2.2377 | stu_lens: 87.0000 | mixed_lens: 54.5000 | lr: 4.7246e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    843/  5000| tot_loss: 3.2005 | rl_loss: 1.7640 | pt_loss: 1.4365 | pg_loss: 0.5556 | reg_loss: 1.2084 | reward: -0.4062 | rev_kl: 1.0628 | stu_lens: 49.5000 | mixed_lens: 70.0000 | lr: 4.7239e-06 | scale: 2048.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    844/  5000| tot_loss: 3.0443 | rl_loss: 1.2471 | pt_loss: 1.7972 | pg_loss: 0.2196 | reg_loss: 1.0275 | reward: -0.7098 | rev_kl: 1.0296 | stu_lens: 65.5000 | mixed_lens: 71.5000 | lr: 4.7231e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    845/  5000| tot_loss: 2.7624 | rl_loss: 1.0443 | pt_loss: 1.7181 | pg_loss: 0.2355 | reg_loss: 0.8088 | reward: -0.2769 | rev_kl: 1.0814 | stu_lens: 95.0000 | mixed_lens: 92.5000 | lr: 4.7224e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    846/  5000| tot_loss: 2.6210 | rl_loss: 1.3967 | pt_loss: 1.2243 | pg_loss: 0.2949 | reg_loss: 1.1017 | reward: -0.3652 | rev_kl: 1.3675 | stu_lens: 91.0000 | mixed_lens: 89.0000 | lr: 4.7217e-06 | scale: 2048.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    847/  5000| tot_loss: 3.0925 | rl_loss: 1.3030 | pt_loss: 1.7895 | pg_loss: 0.0616 | reg_loss: 1.2415 | reward: -0.2476 | rev_kl: 1.0630 | stu_lens: 70.5000 | mixed_lens: 128.0000 | lr: 4.7209e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    848/  5000| tot_loss: 3.1512 | rl_loss: 1.5073 | pt_loss: 1.6438 | pg_loss: 0.3491 | reg_loss: 1.1582 | reward: -0.3660 | rev_kl: 0.7039 | stu_lens: 128.0000 | mixed_lens: 88.0000 | lr: 4.7202e-06 | scale: 2048.00 | time: 26.270 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    848/  5000| tot_loss: 3.1445 | rl_loss: 1.4391 | pt_loss: 1.7054 | pg_loss: 0.3246 | reg_loss: 1.1145 | reward: -0.3828 | rev_kl: 1.1735 | stu_lens: 85.7500 | mixed_lens: 85.6562 | lr: 4.7202e-06 | scale: 2048.00 | time: 26.270 | step time: 27.517
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    849/  5000| tot_loss: 3.3590 | rl_loss: 1.6797 | pt_loss: 1.6793 | pg_loss: 0.0604 | reg_loss: 1.6192 | reward: -0.1384 | rev_kl: 3.3290 | stu_lens: 85.5000 | mixed_lens: 127.5000 | lr: 4.7195e-06 | scale: 2048.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    850/  5000| tot_loss: 3.1648 | rl_loss: 1.4121 | pt_loss: 1.7527 | pg_loss: 0.4601 | reg_loss: 0.9520 | reward: -0.5254 | rev_kl: 2.2381 | stu_lens: 62.5000 | mixed_lens: 76.0000 | lr: 4.7187e-06 | scale: 2048.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    851/  5000| tot_loss: 3.0436 | rl_loss: 1.3226 | pt_loss: 1.7211 | pg_loss: 0.8192 | reg_loss: 0.5033 | reward: -1.0109 | rev_kl: 0.3705 | stu_lens: 19.0000 | mixed_lens: 35.0000 | lr: 4.7180e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    852/  5000| tot_loss: 2.7083 | rl_loss: 0.9282 | pt_loss: 1.7800 | pg_loss: 0.1885 | reg_loss: 0.7398 | reward: -0.4726 | rev_kl: 1.0494 | stu_lens: 75.5000 | mixed_lens: 100.0000 | lr: 4.7172e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    853/  5000| tot_loss: 2.3673 | rl_loss: 0.5349 | pt_loss: 1.8324 | pg_loss: 0.0008 | reg_loss: 0.5341 | reward: -0.3044 | rev_kl: 0.7950 | stu_lens: 102.0000 | mixed_lens: 120.5000 | lr: 4.7165e-06 | scale: 2048.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    854/  5000| tot_loss: 3.1577 | rl_loss: 1.4373 | pt_loss: 1.7205 | pg_loss: 0.4840 | reg_loss: 0.9532 | reward: -0.8457 | rev_kl: 1.2959 | stu_lens: 51.5000 | mixed_lens: 72.0000 | lr: 4.7158e-06 | scale: 2048.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    855/  5000| tot_loss: 2.8130 | rl_loss: 1.2432 | pt_loss: 1.5697 | pg_loss: 0.3736 | reg_loss: 0.8696 | reward: -0.5209 | rev_kl: 1.6221 | stu_lens: 89.5000 | mixed_lens: 62.5000 | lr: 4.7150e-06 | scale: 2048.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    856/  5000| tot_loss: 2.2778 | rl_loss: 0.6746 | pt_loss: 1.6032 | pg_loss: 0.3538 | reg_loss: 0.3207 | reward: -1.0686 | rev_kl: 1.1715 | stu_lens: 128.0000 | mixed_lens: 38.0000 | lr: 4.7143e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    857/  5000| tot_loss: 2.8280 | rl_loss: 1.0814 | pt_loss: 1.7466 | pg_loss: 0.6319 | reg_loss: 0.4495 | reward: -0.3139 | rev_kl: 0.7432 | stu_lens: 70.0000 | mixed_lens: 52.0000 | lr: 4.7135e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    858/  5000| tot_loss: 2.5940 | rl_loss: 0.9294 | pt_loss: 1.6646 | pg_loss: 0.1910 | reg_loss: 0.7385 | reward: -0.2311 | rev_kl: 1.5711 | stu_lens: 106.0000 | mixed_lens: 103.5000 | lr: 4.7128e-06 | scale: 2048.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    859/  5000| tot_loss: 2.6270 | rl_loss: 0.9567 | pt_loss: 1.6703 | pg_loss: 0.1229 | reg_loss: 0.8338 | reward: -0.0985 | rev_kl: 1.1289 | stu_lens: 110.5000 | mixed_lens: 98.0000 | lr: 4.7120e-06 | scale: 2048.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    860/  5000| tot_loss: 2.5297 | rl_loss: 0.9226 | pt_loss: 1.6071 | pg_loss: 0.2156 | reg_loss: 0.7069 | reward: 0.0306 | rev_kl: 0.7166 | stu_lens: 128.0000 | mixed_lens: 92.0000 | lr: 4.7113e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    861/  5000| tot_loss: 2.8527 | rl_loss: 0.9132 | pt_loss: 1.9395 | pg_loss: 0.2073 | reg_loss: 0.7059 | reward: -0.1331 | rev_kl: 1.5206 | stu_lens: 92.5000 | mixed_lens: 124.0000 | lr: 4.7105e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    862/  5000| tot_loss: 2.2552 | rl_loss: 1.0048 | pt_loss: 1.2505 | pg_loss: 0.0170 | reg_loss: 0.9878 | reward: -0.2993 | rev_kl: 1.5984 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7098e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    863/  5000| tot_loss: 2.4094 | rl_loss: 0.6349 | pt_loss: 1.7745 | pg_loss: 0.1289 | reg_loss: 0.5060 | reward: -0.5831 | rev_kl: 1.5679 | stu_lens: 75.5000 | mixed_lens: 102.0000 | lr: 4.7090e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    864/  5000| tot_loss: 2.9390 | rl_loss: 0.9456 | pt_loss: 1.9934 | pg_loss: 0.1772 | reg_loss: 0.7684 | reward: -0.3585 | rev_kl: 0.9866 | stu_lens: 125.0000 | mixed_lens: 108.5000 | lr: 4.7083e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    864/  5000| tot_loss: 2.7858 | rl_loss: 1.0588 | pt_loss: 1.7269 | pg_loss: 0.2830 | reg_loss: 0.7759 | reward: -0.3681 | rev_kl: 1.2921 | stu_lens: 84.9531 | mixed_lens: 87.6562 | lr: 4.7083e-06 | scale: 2048.00 | time: 26.299 | step time: 27.538
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    865/  5000| tot_loss: 3.1298 | rl_loss: 1.3828 | pt_loss: 1.7471 | pg_loss: 0.6981 | reg_loss: 0.6847 | reward: -0.6302 | rev_kl: 1.5185 | stu_lens: 58.0000 | mixed_lens: 55.0000 | lr: 4.7075e-06 | scale: 2048.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    866/  5000| tot_loss: 2.0304 | rl_loss: 0.4048 | pt_loss: 1.6256 | pg_loss: 0.0742 | reg_loss: 0.3306 | reward: -0.2196 | rev_kl: 2.1708 | stu_lens: 124.0000 | mixed_lens: 128.0000 | lr: 4.7068e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    867/  5000| tot_loss: 2.2832 | rl_loss: 0.6418 | pt_loss: 1.6414 | pg_loss: 0.2087 | reg_loss: 0.4331 | reward: 0.0213 | rev_kl: 1.0305 | stu_lens: 112.5000 | mixed_lens: 103.5000 | lr: 4.7060e-06 | scale: 2048.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    868/  5000| tot_loss: 3.5967 | rl_loss: 1.6189 | pt_loss: 1.9778 | pg_loss: 1.2328 | reg_loss: 0.3861 | reward: -0.7136 | rev_kl: 1.0420 | stu_lens: 37.5000 | mixed_lens: 36.5000 | lr: 4.7053e-06 | scale: 2048.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    869/  5000| tot_loss: 2.9827 | rl_loss: 1.5027 | pt_loss: 1.4800 | pg_loss: 1.1931 | reg_loss: 0.3096 | reward: -0.4908 | rev_kl: 0.4861 | stu_lens: 56.5000 | mixed_lens: 35.5000 | lr: 4.7045e-06 | scale: 2048.00 | time: 26.201 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    870/  5000| tot_loss: 1.1207 | rl_loss: -0.2090 | pt_loss: 1.3297 | pg_loss: -0.5345 | reg_loss: 0.3255 | reward: -0.7554 | rev_kl: 0.7668 | stu_lens: 14.5000 | mixed_lens: 17.0000 | lr: 4.7038e-06 | scale: 2048.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    871/  5000| tot_loss: 2.8884 | rl_loss: 1.4334 | pt_loss: 1.4550 | pg_loss: 0.6805 | reg_loss: 0.7529 | reward: -0.8293 | rev_kl: 0.9286 | stu_lens: 77.5000 | mixed_lens: 54.0000 | lr: 4.7030e-06 | scale: 2048.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    872/  5000| tot_loss: 2.3522 | rl_loss: 0.8645 | pt_loss: 1.4877 | pg_loss: 0.2549 | reg_loss: 0.6096 | reward: -0.2287 | rev_kl: 1.5616 | stu_lens: 29.5000 | mixed_lens: 93.5000 | lr: 4.7022e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    873/  5000| tot_loss: 3.1537 | rl_loss: 1.1449 | pt_loss: 2.0089 | pg_loss: 0.3510 | reg_loss: 0.7938 | reward: -0.0011 | rev_kl: 1.4269 | stu_lens: 92.5000 | mixed_lens: 89.5000 | lr: 4.7015e-06 | scale: 2048.00 | time: 26.322 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    874/  5000| tot_loss: 2.8375 | rl_loss: 0.9160 | pt_loss: 1.9214 | pg_loss: 0.1180 | reg_loss: 0.7980 | reward: -0.4769 | rev_kl: 1.3794 | stu_lens: 80.0000 | mixed_lens: 101.0000 | lr: 4.7007e-06 | scale: 2048.00 | time: 26.328 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    875/  5000| tot_loss: 2.3391 | rl_loss: 0.6185 | pt_loss: 1.7207 | pg_loss: 0.3015 | reg_loss: 0.3169 | reward: 0.1291 | rev_kl: 1.1093 | stu_lens: 96.5000 | mixed_lens: 58.0000 | lr: 4.7000e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    876/  5000| tot_loss: 2.4184 | rl_loss: 0.8262 | pt_loss: 1.5922 | pg_loss: 0.3635 | reg_loss: 0.4627 | reward: -0.2021 | rev_kl: 1.5358 | stu_lens: 52.0000 | mixed_lens: 76.5000 | lr: 4.6992e-06 | scale: 2048.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    877/  5000| tot_loss: 2.6282 | rl_loss: 0.5628 | pt_loss: 2.0654 | pg_loss: 0.0411 | reg_loss: 0.5217 | reward: -0.3547 | rev_kl: 0.7224 | stu_lens: 102.0000 | mixed_lens: 120.5000 | lr: 4.6984e-06 | scale: 2048.00 | time: 26.225 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    878/  5000| tot_loss: 1.8232 | rl_loss: 0.2356 | pt_loss: 1.5875 | pg_loss: 0.0902 | reg_loss: 0.1454 | reward: -0.1738 | rev_kl: 0.4755 | stu_lens: 72.5000 | mixed_lens: 68.5000 | lr: 4.6977e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    879/  5000| tot_loss: 2.7712 | rl_loss: 0.9400 | pt_loss: 1.8311 | pg_loss: 0.2901 | reg_loss: 0.6499 | reward: -0.4092 | rev_kl: 1.7607 | stu_lens: 116.0000 | mixed_lens: 88.0000 | lr: 4.6969e-06 | scale: 2048.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    880/  5000| tot_loss: 2.7548 | rl_loss: 0.9598 | pt_loss: 1.7950 | pg_loss: 0.4711 | reg_loss: 0.4887 | reward: -0.4173 | rev_kl: 1.1957 | stu_lens: 61.5000 | mixed_lens: 74.0000 | lr: 4.6961e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    880/  5000| tot_loss: 2.4568 | rl_loss: 0.7502 | pt_loss: 1.7066 | pg_loss: 0.2460 | reg_loss: 0.5042 | reward: -0.3708 | rev_kl: 1.2111 | stu_lens: 86.8438 | mixed_lens: 83.9688 | lr: 4.6961e-06 | scale: 2048.00 | time: 26.263 | step time: 27.524
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    881/  5000| tot_loss: 3.1842 | rl_loss: 1.3520 | pt_loss: 1.8322 | pg_loss: 0.7486 | reg_loss: 0.6034 | reward: -1.1770 | rev_kl: 1.5056 | stu_lens: 19.5000 | mixed_lens: 44.0000 | lr: 4.6954e-06 | scale: 2048.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    882/  5000| tot_loss: 1.7095 | rl_loss: 0.4301 | pt_loss: 1.2794 | pg_loss: -0.0172 | reg_loss: 0.4473 | reward: -0.1268 | rev_kl: 2.8998 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6946e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    883/  5000| tot_loss: 2.4536 | rl_loss: 0.7098 | pt_loss: 1.7438 | pg_loss: 0.1751 | reg_loss: 0.5347 | reward: -0.3577 | rev_kl: 2.5283 | stu_lens: 87.0000 | mixed_lens: 107.0000 | lr: 4.6938e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    884/  5000| tot_loss: 1.8883 | rl_loss: 0.3870 | pt_loss: 1.5013 | pg_loss: 0.0781 | reg_loss: 0.3089 | reward: -0.1206 | rev_kl: 0.8260 | stu_lens: 86.0000 | mixed_lens: 110.5000 | lr: 4.6931e-06 | scale: 2048.00 | time: 26.367 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    885/  5000| tot_loss: 2.9554 | rl_loss: 0.7377 | pt_loss: 2.2177 | pg_loss: 0.3796 | reg_loss: 0.3581 | reward: 0.0200 | rev_kl: 0.9416 | stu_lens: 81.5000 | mixed_lens: 58.5000 | lr: 4.6923e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    886/  5000| tot_loss: 2.5485 | rl_loss: 0.4941 | pt_loss: 2.0544 | pg_loss: 0.1468 | reg_loss: 0.3473 | reward: -0.4187 | rev_kl: 0.8837 | stu_lens: 122.5000 | mixed_lens: 100.0000 | lr: 4.6915e-06 | scale: 2048.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    887/  5000| tot_loss: 2.4235 | rl_loss: 0.5805 | pt_loss: 1.8430 | pg_loss: 0.2638 | reg_loss: 0.3167 | reward: -0.4004 | rev_kl: 0.8706 | stu_lens: 86.0000 | mixed_lens: 67.0000 | lr: 4.6908e-06 | scale: 2048.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    888/  5000| tot_loss: 2.6845 | rl_loss: 0.8904 | pt_loss: 1.7940 | pg_loss: 0.2635 | reg_loss: 0.6270 | reward: -0.6153 | rev_kl: 1.8960 | stu_lens: 40.0000 | mixed_lens: 97.5000 | lr: 4.6900e-06 | scale: 2048.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    889/  5000| tot_loss: 2.2021 | rl_loss: 0.7858 | pt_loss: 1.4163 | pg_loss: 0.1548 | reg_loss: 0.6310 | reward: -0.4196 | rev_kl: 0.7247 | stu_lens: 77.5000 | mixed_lens: 91.5000 | lr: 4.6892e-06 | scale: 2048.00 | time: 26.200 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    890/  5000| tot_loss: 1.5917 | rl_loss: 0.2571 | pt_loss: 1.3346 | pg_loss: 0.0892 | reg_loss: 0.1679 | reward: -0.4267 | rev_kl: 0.9128 | stu_lens: 128.0000 | mixed_lens: 88.0000 | lr: 4.6884e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    891/  5000| tot_loss: 2.2520 | rl_loss: 0.4655 | pt_loss: 1.7865 | pg_loss: 0.1217 | reg_loss: 0.3438 | reward: -0.3072 | rev_kl: 1.2259 | stu_lens: 91.5000 | mixed_lens: 108.5000 | lr: 4.6877e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    892/  5000| tot_loss: 2.7977 | rl_loss: 1.0336 | pt_loss: 1.7641 | pg_loss: 0.4664 | reg_loss: 0.5672 | reward: -0.4356 | rev_kl: 1.5255 | stu_lens: 72.0000 | mixed_lens: 55.0000 | lr: 4.6869e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    893/  5000| tot_loss: 2.6748 | rl_loss: 1.0421 | pt_loss: 1.6327 | pg_loss: 0.5651 | reg_loss: 0.4770 | reward: -0.4214 | rev_kl: 0.7681 | stu_lens: 111.5000 | mixed_lens: 74.5000 | lr: 4.6861e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    894/  5000| tot_loss: 2.1088 | rl_loss: 0.4576 | pt_loss: 1.6512 | pg_loss: 0.0004 | reg_loss: 0.4572 | reward: -0.0476 | rev_kl: 1.0753 | stu_lens: 113.0000 | mixed_lens: 128.0000 | lr: 4.6853e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    895/  5000| tot_loss: 2.4742 | rl_loss: 0.7018 | pt_loss: 1.7724 | pg_loss: 0.4769 | reg_loss: 0.2249 | reward: -0.4202 | rev_kl: 0.9000 | stu_lens: 74.5000 | mixed_lens: 56.5000 | lr: 4.6846e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    896/  5000| tot_loss: 2.4524 | rl_loss: 0.4379 | pt_loss: 2.0145 | pg_loss: 0.0448 | reg_loss: 0.3931 | reward: -0.3679 | rev_kl: 2.1784 | stu_lens: 107.5000 | mixed_lens: 128.0000 | lr: 4.6838e-06 | scale: 2048.00 | time: 26.323 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    896/  5000| tot_loss: 2.3664 | rl_loss: 0.6701 | pt_loss: 1.6963 | pg_loss: 0.2319 | reg_loss: 0.4382 | reward: -0.4104 | rev_kl: 1.2728 | stu_lens: 86.5312 | mixed_lens: 87.5000 | lr: 4.6838e-06 | scale: 2048.00 | time: 26.323 | step time: 27.536
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    897/  5000| tot_loss: 4.7600 | rl_loss: 2.9987 | pt_loss: 1.7613 | pg_loss: 1.8982 | reg_loss: 1.1006 | reward: -0.5673 | rev_kl: 0.5275 | stu_lens: 39.0000 | mixed_lens: 15.5000 | lr: 4.6830e-06 | scale: 2048.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    898/  5000| tot_loss: 3.3140 | rl_loss: 1.3211 | pt_loss: 1.9928 | pg_loss: 0.0487 | reg_loss: 1.2724 | reward: -0.3841 | rev_kl: 1.1291 | stu_lens: 128.0000 | mixed_lens: 123.5000 | lr: 4.6822e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    899/  5000| tot_loss: 3.6929 | rl_loss: 1.9344 | pt_loss: 1.7585 | pg_loss: 0.5111 | reg_loss: 1.4234 | reward: -1.6703 | rev_kl: 1.6817 | stu_lens: 92.0000 | mixed_lens: 72.0000 | lr: 4.6814e-06 | scale: 2048.00 | time: 26.215 | step time: 0.000
                                 Evaluation #9                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Bob should leave Alice, as his       │
│                                       │ chances of survival improve by 9%.   │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ mz kezboard tzpe z instead of y and  │
│                                       │ vice versa is a typing error. The    │
│                                       │ correct typing is mz kezboard typer  │
│                                       │ z instead of y and vice versa.       │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support 30+ languages including   │
│                                       │ English, Spanish, French, German,    │
│                                       │ Italian, Portuguese, Arabic, Greek,  │
│                                       │ Russian, and Japanese.               │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.774 | exact_match: 0.215 | rev_kl: 1.189 | lens: 84.917 | pt_loss: 1.084 | lm_loss: 1.168 | kd_loss: 0.999 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    900/  5000| tot_loss: 2.8556 | rl_loss: 1.3636 | pt_loss: 1.4921 | pg_loss: 0.3720 | reg_loss: 0.9916 | reward: -0.5045 | rev_kl: 0.8387 | stu_lens: 85.5000 | mixed_lens: 76.0000 | lr: 4.6807e-06 | scale: 2048.00 | time: 26.202 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    901/  5000| tot_loss: 3.9606 | rl_loss: 2.0503 | pt_loss: 1.9103 | pg_loss: 0.7878 | reg_loss: 1.2625 | reward: -0.2656 | rev_kl: 0.8367 | stu_lens: 44.5000 | mixed_lens: 65.0000 | lr: 4.6799e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    902/  5000| tot_loss: 3.2491 | rl_loss: 1.1986 | pt_loss: 2.0505 | pg_loss: 0.2969 | reg_loss: 0.9017 | reward: -0.3267 | rev_kl: 0.7627 | stu_lens: 92.0000 | mixed_lens: 89.5000 | lr: 4.6791e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    903/  5000| tot_loss: 3.1404 | rl_loss: 1.6023 | pt_loss: 1.5381 | pg_loss: 0.1134 | reg_loss: 1.4889 | reward: -0.2034 | rev_kl: 1.3368 | stu_lens: 88.0000 | mixed_lens: 119.0000 | lr: 4.6783e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    904/  5000| tot_loss: 3.2616 | rl_loss: 1.2849 | pt_loss: 1.9767 | pg_loss: 0.0693 | reg_loss: 1.2156 | reward: -0.1712 | rev_kl: 1.2076 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6775e-06 | scale: 2048.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    905/  5000| tot_loss: 3.0840 | rl_loss: 1.3042 | pt_loss: 1.7798 | pg_loss: 0.0415 | reg_loss: 1.2627 | reward: -0.2577 | rev_kl: 1.0277 | stu_lens: 87.0000 | mixed_lens: 128.0000 | lr: 4.6767e-06 | scale: 2048.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    906/  5000| tot_loss: 3.1224 | rl_loss: 1.7856 | pt_loss: 1.3368 | pg_loss: 0.3373 | reg_loss: 1.4482 | reward: -0.6044 | rev_kl: 1.3335 | stu_lens: 128.0000 | mixed_lens: 79.0000 | lr: 4.6759e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    907/  5000| tot_loss: 2.6006 | rl_loss: 0.8192 | pt_loss: 1.7814 | pg_loss: 0.0703 | reg_loss: 0.7489 | reward: -0.1562 | rev_kl: 2.1769 | stu_lens: 78.0000 | mixed_lens: 122.5000 | lr: 4.6751e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    908/  5000| tot_loss: 3.4753 | rl_loss: 1.7999 | pt_loss: 1.6754 | pg_loss: 0.0981 | reg_loss: 1.7019 | reward: -0.3779 | rev_kl: 1.1783 | stu_lens: 74.5000 | mixed_lens: 117.0000 | lr: 4.6744e-06 | scale: 2048.00 | time: 26.323 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    909/  5000| tot_loss: 4.7597 | rl_loss: 2.9790 | pt_loss: 1.7807 | pg_loss: 2.1265 | reg_loss: 0.8525 | reward: -1.7738 | rev_kl: 0.8883 | stu_lens: 72.0000 | mixed_lens: 10.5000 | lr: 4.6736e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    910/  5000| tot_loss: 2.5258 | rl_loss: 1.3576 | pt_loss: 1.1682 | pg_loss: 0.1017 | reg_loss: 1.2559 | reward: -0.1852 | rev_kl: 1.5346 | stu_lens: 100.5000 | mixed_lens: 122.5000 | lr: 4.6728e-06 | scale: 2048.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    911/  5000| tot_loss: 3.0124 | rl_loss: 1.3166 | pt_loss: 1.6958 | pg_loss: 0.1093 | reg_loss: 1.2073 | reward: -0.1945 | rev_kl: 1.0439 | stu_lens: 108.0000 | mixed_lens: 116.5000 | lr: 4.6720e-06 | scale: 2048.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    912/  5000| tot_loss: 3.9761 | rl_loss: 2.0953 | pt_loss: 1.8808 | pg_loss: 0.4304 | reg_loss: 1.6648 | reward: -0.1924 | rev_kl: 1.4841 | stu_lens: 76.0000 | mixed_lens: 93.5000 | lr: 4.6712e-06 | scale: 2048.00 | time: 26.246 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    912/  5000| tot_loss: 3.3885 | rl_loss: 1.6536 | pt_loss: 1.7349 | pg_loss: 0.4438 | reg_loss: 1.2098 | reward: -0.4381 | rev_kl: 1.1562 | stu_lens: 88.7812 | mixed_lens: 86.8750 | lr: 4.6712e-06 | scale: 2048.00 | time: 26.246 | step time: 27.538
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    913/  5000| tot_loss: 3.7613 | rl_loss: 1.7132 | pt_loss: 2.0481 | pg_loss: 0.3134 | reg_loss: 1.3998 | reward: 0.1118 | rev_kl: 1.1340 | stu_lens: 67.0000 | mixed_lens: 68.5000 | lr: 4.6704e-06 | scale: 2048.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    914/  5000| tot_loss: 2.8901 | rl_loss: 1.3307 | pt_loss: 1.5593 | pg_loss: 0.3517 | reg_loss: 0.9790 | reward: -1.6629 | rev_kl: 0.7438 | stu_lens: 128.0000 | mixed_lens: 63.0000 | lr: 4.6696e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    915/  5000| tot_loss: 2.5734 | rl_loss: 0.7744 | pt_loss: 1.7991 | pg_loss: 0.2047 | reg_loss: 0.5697 | reward: -0.1448 | rev_kl: 0.8877 | stu_lens: 113.5000 | mixed_lens: 93.5000 | lr: 4.6688e-06 | scale: 2048.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    916/  5000| tot_loss: 2.5524 | rl_loss: 1.1363 | pt_loss: 1.4161 | pg_loss: 0.3530 | reg_loss: 0.7833 | reward: -0.5985 | rev_kl: 1.5887 | stu_lens: 73.5000 | mixed_lens: 72.5000 | lr: 4.6680e-06 | scale: 2048.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    917/  5000| tot_loss: 2.6223 | rl_loss: 0.8727 | pt_loss: 1.7496 | pg_loss: -0.0044 | reg_loss: 0.8771 | reward: -0.1752 | rev_kl: 1.1682 | stu_lens: 117.0000 | mixed_lens: 128.0000 | lr: 4.6672e-06 | scale: 2048.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    918/  5000| tot_loss: 4.1234 | rl_loss: 1.8486 | pt_loss: 2.2749 | pg_loss: 1.1384 | reg_loss: 0.7102 | reward: -1.4435 | rev_kl: 0.6283 | stu_lens: 66.5000 | mixed_lens: 8.5000 | lr: 4.6664e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    919/  5000| tot_loss: 2.5365 | rl_loss: 0.9845 | pt_loss: 1.5519 | pg_loss: 0.2081 | reg_loss: 0.7764 | reward: -0.2870 | rev_kl: 1.2854 | stu_lens: 85.0000 | mixed_lens: 95.5000 | lr: 4.6656e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    920/  5000| tot_loss: 2.9814 | rl_loss: 1.0217 | pt_loss: 1.9597 | pg_loss: 0.1999 | reg_loss: 0.8218 | reward: -0.3052 | rev_kl: 0.6452 | stu_lens: 77.0000 | mixed_lens: 77.0000 | lr: 4.6648e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    921/  5000| tot_loss: 3.2757 | rl_loss: 1.0148 | pt_loss: 2.2608 | pg_loss: 0.2599 | reg_loss: 0.7550 | reward: -0.3204 | rev_kl: 1.0290 | stu_lens: 105.0000 | mixed_lens: 98.0000 | lr: 4.6640e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    922/  5000| tot_loss: 2.4479 | rl_loss: 0.9997 | pt_loss: 1.4481 | pg_loss: 0.3650 | reg_loss: 0.6348 | reward: -0.4989 | rev_kl: 1.1674 | stu_lens: 112.0000 | mixed_lens: 65.0000 | lr: 4.6632e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    923/  5000| tot_loss: 3.2472 | rl_loss: 1.6732 | pt_loss: 1.5740 | pg_loss: 0.7835 | reg_loss: 0.8896 | reward: -0.2139 | rev_kl: 1.1643 | stu_lens: 92.0000 | mixed_lens: 44.0000 | lr: 4.6624e-06 | scale: 2048.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    924/  5000| tot_loss: 3.1237 | rl_loss: 1.3754 | pt_loss: 1.7484 | pg_loss: 0.6823 | reg_loss: 0.6931 | reward: -1.6462 | rev_kl: 1.5220 | stu_lens: 52.0000 | mixed_lens: 63.0000 | lr: 4.6616e-06 | scale: 2048.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    925/  5000| tot_loss: 2.8055 | rl_loss: 1.2057 | pt_loss: 1.5998 | pg_loss: 0.1068 | reg_loss: 1.0990 | reward: -0.2673 | rev_kl: 0.5345 | stu_lens: 24.5000 | mixed_lens: 111.5000 | lr: 4.6608e-06 | scale: 2048.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    926/  5000| tot_loss: 3.0051 | rl_loss: 0.9593 | pt_loss: 2.0458 | pg_loss: -0.0033 | reg_loss: 0.9626 | reward: -0.3556 | rev_kl: 1.4581 | stu_lens: 98.0000 | mixed_lens: 128.0000 | lr: 4.6600e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    927/  5000| tot_loss: 2.0939 | rl_loss: 0.9768 | pt_loss: 1.1171 | pg_loss: 0.1045 | reg_loss: 0.8723 | reward: -0.1038 | rev_kl: 1.6318 | stu_lens: 93.5000 | mixed_lens: 99.0000 | lr: 4.6592e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    928/  5000| tot_loss: 2.5240 | rl_loss: 0.4768 | pt_loss: 2.0472 | pg_loss: 0.2000 | reg_loss: 0.2768 | reward: -0.4919 | rev_kl: 2.5278 | stu_lens: 85.5000 | mixed_lens: 76.0000 | lr: 4.6584e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    928/  5000| tot_loss: 2.8805 | rl_loss: 1.1084 | pt_loss: 1.7721 | pg_loss: 0.2806 | reg_loss: 0.8278 | reward: -0.3991 | rev_kl: 1.1967 | stu_lens: 87.5469 | mixed_lens: 87.5938 | lr: 4.6584e-06 | scale: 2048.00 | time: 26.311 | step time: 27.518
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    929/  5000| tot_loss: 2.8609 | rl_loss: 1.3818 | pt_loss: 1.4791 | pg_loss: 0.5711 | reg_loss: 0.8107 | reward: -0.6375 | rev_kl: 1.1251 | stu_lens: 72.0000 | mixed_lens: 72.0000 | lr: 4.6575e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    930/  5000| tot_loss: 2.3843 | rl_loss: 0.6478 | pt_loss: 1.7365 | pg_loss: 0.0440 | reg_loss: 0.6038 | reward: -0.3348 | rev_kl: 1.4320 | stu_lens: 108.0000 | mixed_lens: 116.5000 | lr: 4.6567e-06 | scale: 2048.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    931/  5000| tot_loss: 2.2118 | rl_loss: 0.6228 | pt_loss: 1.5890 | pg_loss: -0.0124 | reg_loss: 0.6352 | reward: -0.3288 | rev_kl: 1.0152 | stu_lens: 115.0000 | mixed_lens: 128.0000 | lr: 4.6559e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    932/  5000| tot_loss: 2.6424 | rl_loss: 0.7416 | pt_loss: 1.9008 | pg_loss: 0.4280 | reg_loss: 0.3136 | reward: -0.3961 | rev_kl: 0.8459 | stu_lens: 63.5000 | mixed_lens: 73.5000 | lr: 4.6551e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    933/  5000| tot_loss: 2.6899 | rl_loss: 0.8001 | pt_loss: 1.8897 | pg_loss: 0.2107 | reg_loss: 0.5894 | reward: 0.3374 | rev_kl: 1.3535 | stu_lens: 35.5000 | mixed_lens: 56.5000 | lr: 4.6543e-06 | scale: 2048.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    934/  5000| tot_loss: 3.1763 | rl_loss: 1.2264 | pt_loss: 1.9499 | pg_loss: 0.5671 | reg_loss: 0.6592 | reward: -0.6834 | rev_kl: 1.5244 | stu_lens: 65.5000 | mixed_lens: 69.5000 | lr: 4.6535e-06 | scale: 2048.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    935/  5000| tot_loss: 3.6345 | rl_loss: 1.8256 | pt_loss: 1.8089 | pg_loss: 1.2306 | reg_loss: 0.5949 | reward: -0.8814 | rev_kl: 0.8810 | stu_lens: 72.0000 | mixed_lens: 29.5000 | lr: 4.6527e-06 | scale: 2048.00 | time: 26.196 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    936/  5000| tot_loss: 2.8877 | rl_loss: 1.4127 | pt_loss: 1.4750 | pg_loss: 0.9478 | reg_loss: 0.4649 | reward: -1.5466 | rev_kl: 1.8170 | stu_lens: 57.5000 | mixed_lens: 43.0000 | lr: 4.6519e-06 | scale: 2048.00 | time: 26.196 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    937/  5000| tot_loss: 2.6783 | rl_loss: 0.8488 | pt_loss: 1.8295 | pg_loss: 0.2608 | reg_loss: 0.5880 | reward: -0.6044 | rev_kl: 1.3335 | stu_lens: 128.0000 | mixed_lens: 79.0000 | lr: 4.6510e-06 | scale: 2048.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    938/  5000| tot_loss: 1.2080 | rl_loss: -0.2662 | pt_loss: 1.4741 | pg_loss: -0.6120 | reg_loss: 0.3459 | reward: -0.0234 | rev_kl: 0.8050 | stu_lens: 5.5000 | mixed_lens: 10.5000 | lr: 4.6502e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    939/  5000| tot_loss: 2.8835 | rl_loss: 0.7330 | pt_loss: 2.1505 | pg_loss: 0.0267 | reg_loss: 0.7063 | reward: -0.1424 | rev_kl: 1.1584 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6494e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    940/  5000| tot_loss: 2.6764 | rl_loss: 0.8093 | pt_loss: 1.8672 | pg_loss: 0.1702 | reg_loss: 0.6390 | reward: -0.4680 | rev_kl: 1.5780 | stu_lens: 128.0000 | mixed_lens: 89.5000 | lr: 4.6486e-06 | scale: 2048.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    941/  5000| tot_loss: 2.3148 | rl_loss: 0.4738 | pt_loss: 1.8411 | pg_loss: 0.0194 | reg_loss: 0.4544 | reward: -0.1837 | rev_kl: 0.8262 | stu_lens: 128.0000 | mixed_lens: 113.5000 | lr: 4.6478e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    942/  5000| tot_loss: 2.4145 | rl_loss: 0.7863 | pt_loss: 1.6281 | pg_loss: 0.2161 | reg_loss: 0.5702 | reward: -0.1455 | rev_kl: 1.5012 | stu_lens: 113.5000 | mixed_lens: 93.5000 | lr: 4.6469e-06 | scale: 2048.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    943/  5000| tot_loss: 2.0316 | rl_loss: 0.9081 | pt_loss: 1.1236 | pg_loss: 0.4216 | reg_loss: 0.4865 | reward: -0.3137 | rev_kl: 0.7012 | stu_lens: 66.0000 | mixed_lens: 77.0000 | lr: 4.6461e-06 | scale: 2048.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    944/  5000| tot_loss: 2.7168 | rl_loss: 1.0404 | pt_loss: 1.6763 | pg_loss: 0.3440 | reg_loss: 0.6964 | reward: -0.5959 | rev_kl: 1.3569 | stu_lens: 85.0000 | mixed_lens: 88.5000 | lr: 4.6453e-06 | scale: 2048.00 | time: 26.229 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    944/  5000| tot_loss: 2.5618 | rl_loss: 0.8691 | pt_loss: 1.6927 | pg_loss: 0.3041 | reg_loss: 0.5650 | reward: -0.4600 | rev_kl: 1.1640 | stu_lens: 87.1562 | mixed_lens: 82.8281 | lr: 4.6453e-06 | scale: 2048.00 | time: 26.229 | step time: 27.506
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    945/  5000| tot_loss: 2.2052 | rl_loss: 0.5173 | pt_loss: 1.6880 | pg_loss: 0.0104 | reg_loss: 0.5068 | reward: -0.2721 | rev_kl: 1.5012 | stu_lens: 98.0000 | mixed_lens: 127.5000 | lr: 4.6445e-06 | scale: 2048.00 | time: 26.196 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    946/  5000| tot_loss: 3.0484 | rl_loss: 1.1511 | pt_loss: 1.8974 | pg_loss: 0.6975 | reg_loss: 0.4535 | reward: -0.2656 | rev_kl: 0.8367 | stu_lens: 44.5000 | mixed_lens: 65.0000 | lr: 4.6437e-06 | scale: 2048.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    947/  5000| tot_loss: 2.9970 | rl_loss: 1.2453 | pt_loss: 1.7518 | pg_loss: 0.6804 | reg_loss: 0.5649 | reward: -0.6127 | rev_kl: 1.3691 | stu_lens: 42.0000 | mixed_lens: 56.0000 | lr: 4.6428e-06 | scale: 2048.00 | time: 26.216 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    948/  5000| tot_loss: 3.2602 | rl_loss: 1.3484 | pt_loss: 1.9119 | pg_loss: 0.7998 | reg_loss: 0.5486 | reward: 0.1489 | rev_kl: 0.9433 | stu_lens: 19.0000 | mixed_lens: 21.0000 | lr: 4.6420e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    949/  5000| tot_loss: 2.7335 | rl_loss: 0.6547 | pt_loss: 2.0788 | pg_loss: 0.3226 | reg_loss: 0.3321 | reward: -0.6159 | rev_kl: 0.7424 | stu_lens: 106.5000 | mixed_lens: 65.0000 | lr: 4.6412e-06 | scale: 2048.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    950/  5000| tot_loss: 2.4353 | rl_loss: 0.5512 | pt_loss: 1.8840 | pg_loss: 0.1313 | reg_loss: 0.4200 | reward: -0.5698 | rev_kl: 1.5252 | stu_lens: 71.5000 | mixed_lens: 108.0000 | lr: 4.6403e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    951/  5000| tot_loss: 2.1535 | rl_loss: 0.6117 | pt_loss: 1.5417 | pg_loss: 0.1188 | reg_loss: 0.4929 | reward: -0.4575 | rev_kl: 1.3683 | stu_lens: 105.0000 | mixed_lens: 98.0000 | lr: 4.6395e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    952/  5000| tot_loss: 1.9366 | rl_loss: 0.5481 | pt_loss: 1.3885 | pg_loss: 0.0417 | reg_loss: 0.5064 | reward: -1.6171 | rev_kl: 0.9326 | stu_lens: 128.0000 | mixed_lens: 67.5000 | lr: 4.6387e-06 | scale: 2048.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    953/  5000| tot_loss: 1.9254 | rl_loss: 0.3434 | pt_loss: 1.5820 | pg_loss: 0.0170 | reg_loss: 0.3264 | reward: -0.2077 | rev_kl: 0.5328 | stu_lens: 128.0000 | mixed_lens: 123.5000 | lr: 4.6379e-06 | scale: 2048.00 | time: 26.198 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    954/  5000| tot_loss: 2.8716 | rl_loss: 0.9439 | pt_loss: 1.9278 | pg_loss: 0.1875 | reg_loss: 0.7564 | reward: -0.2820 | rev_kl: 1.7587 | stu_lens: 113.5000 | mixed_lens: 93.5000 | lr: 4.6370e-06 | scale: 2048.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    955/  5000| tot_loss: 2.5786 | rl_loss: 0.9885 | pt_loss: 1.5901 | pg_loss: 0.8626 | reg_loss: 0.1258 | reward: -1.8578 | rev_kl: 1.1971 | stu_lens: 49.5000 | mixed_lens: 20.0000 | lr: 4.6362e-06 | scale: 2048.00 | time: 26.184 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    956/  5000| tot_loss: 1.7943 | rl_loss: 0.2760 | pt_loss: 1.5182 | pg_loss: 0.0669 | reg_loss: 0.2091 | reward: -0.3588 | rev_kl: 0.6929 | stu_lens: 123.5000 | mixed_lens: 112.0000 | lr: 4.6354e-06 | scale: 2048.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    957/  5000| tot_loss: 2.7542 | rl_loss: 0.8518 | pt_loss: 1.9024 | pg_loss: 0.3524 | reg_loss: 0.4994 | reward: -0.1377 | rev_kl: 0.9312 | stu_lens: 73.0000 | mixed_lens: 72.5000 | lr: 4.6345e-06 | scale: 2048.00 | time: 26.199 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    958/  5000| tot_loss: 2.0403 | rl_loss: 0.7718 | pt_loss: 1.2685 | pg_loss: 0.2852 | reg_loss: 0.4866 | reward: -0.1836 | rev_kl: 1.3609 | stu_lens: 48.0000 | mixed_lens: 75.5000 | lr: 4.6337e-06 | scale: 2048.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    959/  5000| tot_loss: 2.5422 | rl_loss: 0.6189 | pt_loss: 1.9233 | pg_loss: 0.2568 | reg_loss: 0.3621 | reward: -0.2290 | rev_kl: 1.1548 | stu_lens: 78.0000 | mixed_lens: 90.0000 | lr: 4.6329e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    960/  5000| tot_loss: 2.6407 | rl_loss: 0.8915 | pt_loss: 1.7492 | pg_loss: 0.3365 | reg_loss: 0.5549 | reward: -0.3681 | rev_kl: 1.0528 | stu_lens: 92.0000 | mixed_lens: 89.5000 | lr: 4.6320e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    960/  5000| tot_loss: 2.4951 | rl_loss: 0.7626 | pt_loss: 1.7325 | pg_loss: 0.2969 | reg_loss: 0.4657 | reward: -0.4356 | rev_kl: 1.2015 | stu_lens: 89.8438 | mixed_lens: 87.4844 | lr: 4.6320e-06 | scale: 2048.00 | time: 26.279 | step time: 27.488
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    961/  5000| tot_loss: 2.2120 | rl_loss: 0.5024 | pt_loss: 1.7096 | pg_loss: 0.0253 | reg_loss: 0.4771 | reward: -0.2226 | rev_kl: 1.1269 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6312e-06 | scale: 2048.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    962/  5000| tot_loss: 2.7586 | rl_loss: 1.2759 | pt_loss: 1.4827 | pg_loss: 0.3273 | reg_loss: 0.9487 | reward: -0.1794 | rev_kl: 0.5856 | stu_lens: 90.0000 | mixed_lens: 91.5000 | lr: 4.6303e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    963/  5000| tot_loss: 4.0889 | rl_loss: 2.4415 | pt_loss: 1.6474 | pg_loss: 0.9039 | reg_loss: 1.5376 | reward: -0.5913 | rev_kl: 1.0587 | stu_lens: 58.5000 | mixed_lens: 61.0000 | lr: 4.6295e-06 | scale: 2048.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    964/  5000| tot_loss: 2.8613 | rl_loss: 1.5043 | pt_loss: 1.3570 | pg_loss: 0.2008 | reg_loss: 1.3035 | reward: -0.2778 | rev_kl: 1.3475 | stu_lens: 89.5000 | mixed_lens: 109.5000 | lr: 4.6287e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    965/  5000| tot_loss: 3.1650 | rl_loss: 1.9054 | pt_loss: 1.2596 | pg_loss: 0.1453 | reg_loss: 1.7601 | reward: -0.5917 | rev_kl: 1.4648 | stu_lens: 106.5000 | mixed_lens: 110.5000 | lr: 4.6278e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    966/  5000| tot_loss: 3.3741 | rl_loss: 1.5572 | pt_loss: 1.8169 | pg_loss: 0.3283 | reg_loss: 1.2289 | reward: -0.8602 | rev_kl: 1.2335 | stu_lens: 55.0000 | mixed_lens: 82.5000 | lr: 4.6270e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    967/  5000| tot_loss: 2.8539 | rl_loss: 1.8895 | pt_loss: 0.9645 | pg_loss: 0.6372 | reg_loss: 1.2523 | reward: -0.6065 | rev_kl: 0.9424 | stu_lens: 84.5000 | mixed_lens: 57.0000 | lr: 4.6261e-06 | scale: 2048.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    968/  5000| tot_loss: 4.0247 | rl_loss: 2.2094 | pt_loss: 1.8152 | pg_loss: 0.7219 | reg_loss: 1.4875 | reward: 0.0275 | rev_kl: 0.7811 | stu_lens: 43.5000 | mixed_lens: 50.0000 | lr: 4.6253e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    969/  5000| tot_loss: 2.9624 | rl_loss: 1.1966 | pt_loss: 1.7657 | pg_loss: 0.0283 | reg_loss: 1.1683 | reward: -0.3097 | rev_kl: 2.2280 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6245e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    970/  5000| tot_loss: 2.4203 | rl_loss: 1.3058 | pt_loss: 1.1145 | pg_loss: 0.0284 | reg_loss: 1.2774 | reward: 0.1961 | rev_kl: 1.0187 | stu_lens: 49.0000 | mixed_lens: 44.0000 | lr: 4.6236e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    971/  5000| tot_loss: 3.3604 | rl_loss: 2.0066 | pt_loss: 1.3538 | pg_loss: 0.6721 | reg_loss: 1.3345 | reward: 0.2597 | rev_kl: 1.0110 | stu_lens: 47.0000 | mixed_lens: 67.5000 | lr: 4.6228e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    972/  5000| tot_loss: 3.2897 | rl_loss: 1.6964 | pt_loss: 1.5932 | pg_loss: 0.2535 | reg_loss: 1.4430 | reward: -0.2804 | rev_kl: 1.2591 | stu_lens: 114.0000 | mixed_lens: 102.0000 | lr: 4.6219e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    973/  5000| tot_loss: 2.8510 | rl_loss: 1.6234 | pt_loss: 1.2276 | pg_loss: 0.3609 | reg_loss: 1.2625 | reward: -0.2094 | rev_kl: 1.2672 | stu_lens: 123.5000 | mixed_lens: 97.0000 | lr: 4.6211e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    974/  5000| tot_loss: 3.4055 | rl_loss: 1.5804 | pt_loss: 1.8251 | pg_loss: 0.1723 | reg_loss: 1.4081 | reward: -0.4813 | rev_kl: 0.9836 | stu_lens: 127.0000 | mixed_lens: 99.0000 | lr: 4.6202e-06 | scale: 2048.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    975/  5000| tot_loss: 2.9948 | rl_loss: 1.2737 | pt_loss: 1.7210 | pg_loss: 0.1778 | reg_loss: 1.0960 | reward: -0.3368 | rev_kl: 0.9108 | stu_lens: 89.0000 | mixed_lens: 111.5000 | lr: 4.6194e-06 | scale: 2048.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    976/  5000| tot_loss: 4.1722 | rl_loss: 2.1639 | pt_loss: 2.0082 | pg_loss: 1.1059 | reg_loss: 1.0580 | reward: -0.6552 | rev_kl: 0.8184 | stu_lens: 38.5000 | mixed_lens: 34.0000 | lr: 4.6185e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    976/  5000| tot_loss: 3.2035 | rl_loss: 1.5640 | pt_loss: 1.6395 | pg_loss: 0.3256 | reg_loss: 1.2384 | reward: -0.3424 | rev_kl: 1.1313 | stu_lens: 80.8906 | mixed_lens: 89.9375 | lr: 4.6185e-06 | scale: 2048.00 | time: 26.292 | step time: 27.534
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    977/  5000| tot_loss: 2.7840 | rl_loss: 1.0427 | pt_loss: 1.7413 | pg_loss: 0.0539 | reg_loss: 0.9888 | reward: -0.1935 | rev_kl: 0.9934 | stu_lens: 89.0000 | mixed_lens: 128.0000 | lr: 4.6177e-06 | scale: 2048.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    978/  5000| tot_loss: 2.6418 | rl_loss: 1.0014 | pt_loss: 1.6404 | pg_loss: 0.1272 | reg_loss: 0.8742 | reward: -0.2825 | rev_kl: 1.4349 | stu_lens: 85.0000 | mixed_lens: 108.0000 | lr: 4.6168e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    979/  5000| tot_loss: 3.2913 | rl_loss: 1.3681 | pt_loss: 1.9232 | pg_loss: 0.8798 | reg_loss: 0.4883 | reward: -0.4032 | rev_kl: 0.8941 | stu_lens: 77.0000 | mixed_lens: 46.0000 | lr: 4.6160e-06 | scale: 2048.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    980/  5000| tot_loss: 2.5259 | rl_loss: 0.9872 | pt_loss: 1.5387 | pg_loss: 0.0159 | reg_loss: 0.9713 | reward: -0.3835 | rev_kl: 0.8253 | stu_lens: 70.5000 | mixed_lens: 128.0000 | lr: 4.6151e-06 | scale: 2048.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    981/  5000| tot_loss: 2.9760 | rl_loss: 1.2913 | pt_loss: 1.6848 | pg_loss: 0.3090 | reg_loss: 0.9822 | reward: -0.2799 | rev_kl: 1.1146 | stu_lens: 76.0000 | mixed_lens: 89.5000 | lr: 4.6142e-06 | scale: 2048.00 | time: 26.202 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    982/  5000| tot_loss: 3.1136 | rl_loss: 1.2047 | pt_loss: 1.9089 | pg_loss: 0.3723 | reg_loss: 0.8324 | reward: -0.3503 | rev_kl: 2.0800 | stu_lens: 128.0000 | mixed_lens: 98.5000 | lr: 4.6134e-06 | scale: 2048.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    983/  5000| tot_loss: 2.8462 | rl_loss: 0.8522 | pt_loss: 1.9940 | pg_loss: 0.2832 | reg_loss: 0.5690 | reward: -0.1513 | rev_kl: 0.9604 | stu_lens: 91.5000 | mixed_lens: 90.5000 | lr: 4.6125e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    984/  5000| tot_loss: 2.1648 | rl_loss: 0.7282 | pt_loss: 1.4366 | pg_loss: 0.0057 | reg_loss: 0.7225 | reward: -0.1874 | rev_kl: 1.2775 | stu_lens: 85.0000 | mixed_lens: 128.0000 | lr: 4.6117e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    985/  5000| tot_loss: 3.0832 | rl_loss: 1.5343 | pt_loss: 1.5488 | pg_loss: 0.6038 | reg_loss: 0.9305 | reward: -0.8919 | rev_kl: 1.4590 | stu_lens: 36.0000 | mixed_lens: 51.0000 | lr: 4.6108e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    986/  5000| tot_loss: 2.6582 | rl_loss: 0.9285 | pt_loss: 1.7297 | pg_loss: 0.1872 | reg_loss: 0.7413 | reward: -0.3011 | rev_kl: 1.0201 | stu_lens: 84.0000 | mixed_lens: 100.0000 | lr: 4.6100e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    987/  5000| tot_loss: 3.4989 | rl_loss: 1.5487 | pt_loss: 1.9502 | pg_loss: 0.4279 | reg_loss: 1.1208 | reward: -0.8125 | rev_kl: 1.0564 | stu_lens: 73.5000 | mixed_lens: 67.0000 | lr: 4.6091e-06 | scale: 2048.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    988/  5000| tot_loss: 2.8237 | rl_loss: 1.0862 | pt_loss: 1.7375 | pg_loss: 0.3335 | reg_loss: 0.7527 | reward: -0.1755 | rev_kl: 1.1772 | stu_lens: 71.0000 | mixed_lens: 82.5000 | lr: 4.6082e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    989/  5000| tot_loss: 3.0522 | rl_loss: 1.3263 | pt_loss: 1.7259 | pg_loss: 0.4609 | reg_loss: 0.8654 | reward: -0.3815 | rev_kl: 1.1623 | stu_lens: 39.0000 | mixed_lens: 75.0000 | lr: 4.6074e-06 | scale: 2048.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    990/  5000| tot_loss: 2.3775 | rl_loss: 1.1590 | pt_loss: 1.2185 | pg_loss: 0.6242 | reg_loss: 0.5348 | reward: 0.2082 | rev_kl: 0.9768 | stu_lens: 18.0000 | mixed_lens: 67.5000 | lr: 4.6065e-06 | scale: 2048.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    991/  5000| tot_loss: 2.7110 | rl_loss: 1.1067 | pt_loss: 1.6042 | pg_loss: 0.2040 | reg_loss: 0.9027 | reward: -0.1634 | rev_kl: 1.2096 | stu_lens: 50.5000 | mixed_lens: 54.5000 | lr: 4.6057e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    992/  5000| tot_loss: 1.7619 | rl_loss: 0.6427 | pt_loss: 1.1192 | pg_loss: 0.0660 | reg_loss: 0.5767 | reward: -0.4319 | rev_kl: 1.0984 | stu_lens: 89.0000 | mixed_lens: 93.5000 | lr: 4.6048e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    992/  5000| tot_loss: 2.7945 | rl_loss: 1.1172 | pt_loss: 1.6774 | pg_loss: 0.3221 | reg_loss: 0.7951 | reward: -0.3523 | rev_kl: 1.1529 | stu_lens: 78.9531 | mixed_lens: 87.8750 | lr: 4.6048e-06 | scale: 2048.00 | time: 26.281 | step time: 27.511
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    993/  5000| tot_loss: 3.4002 | rl_loss: 1.1246 | pt_loss: 2.2756 | pg_loss: 0.3172 | reg_loss: 0.8075 | reward: -0.4998 | rev_kl: 0.9282 | stu_lens: 89.5000 | mixed_lens: 80.5000 | lr: 4.6039e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    994/  5000| tot_loss: 1.9962 | rl_loss: 0.6325 | pt_loss: 1.3637 | pg_loss: 0.2724 | reg_loss: 0.3600 | reward: -0.2572 | rev_kl: 2.0299 | stu_lens: 74.0000 | mixed_lens: 83.5000 | lr: 4.6031e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    995/  5000| tot_loss: 2.1869 | rl_loss: 0.6422 | pt_loss: 1.5447 | pg_loss: 0.0680 | reg_loss: 0.5742 | reward: -0.1108 | rev_kl: 1.2580 | stu_lens: 100.5000 | mixed_lens: 120.5000 | lr: 4.6022e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    996/  5000| tot_loss: 2.2845 | rl_loss: 0.8163 | pt_loss: 1.4682 | pg_loss: 0.1845 | reg_loss: 0.6318 | reward: -0.6489 | rev_kl: 1.5067 | stu_lens: 128.0000 | mixed_lens: 97.0000 | lr: 4.6013e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    997/  5000| tot_loss: 2.1809 | rl_loss: 0.6166 | pt_loss: 1.5643 | pg_loss: 0.0087 | reg_loss: 0.6080 | reward: -0.2583 | rev_kl: 1.1617 | stu_lens: 100.0000 | mixed_lens: 128.0000 | lr: 4.6005e-06 | scale: 2048.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    998/  5000| tot_loss: 2.2268 | rl_loss: 0.7586 | pt_loss: 1.4683 | pg_loss: 0.2949 | reg_loss: 0.4637 | reward: -0.4576 | rev_kl: 0.9310 | stu_lens: 89.5000 | mixed_lens: 83.5000 | lr: 4.5996e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    999/  5000| tot_loss: 2.4702 | rl_loss: 0.4625 | pt_loss: 2.0078 | pg_loss: 0.0487 | reg_loss: 0.4138 | reward: -0.0925 | rev_kl: 0.7391 | stu_lens: 87.0000 | mixed_lens: 45.0000 | lr: 4.5987e-06 | scale: 2048.00 | time: 26.206 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/1000
                                 Evaluation #10                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Bob should leave Alice, because his  │
│                                       │ chances of surviving are higher if   │
│                                       │ he does. If he stays with Alice,     │
│                                       │ they have a 31% chance of survival,  │
│                                       │ which is not good. But if he leaves  │
│                                       │ her, he has a 9% chance of survival, │
│                                       │ which is better. So Bob should leave │
│                                       │ Alice, and try to find help.         │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ mz kezboard tzpe z instead of y and  │
│                                       │ vice versa is a typing error that is │
│                                       │ commonly made by people who are used │
│                                       │ to typing on a qwerty keyboard. On a │
│                                       │ qwerty keyboard, the keys are        │
│                                       │ arranged in a grid pattern with the  │
│                                       │ rows of keys being aligned           │
│                                       │ vertically and the columns of keys   │
│                                       │ being aligned horizontally. The keys │
│                                       │ in the top row are assigned the      │
│                                       │ letters a,s,d,f,j,k,l,; and the keys │
│                                       │ in the bottom row are assigned the   │
│                                       │ letters h,n,m,r,t,u,v,w,x,y          │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support over 100 languages.       │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.359 | exact_match: 0.108 | rev_kl: 1.142 | lens: 86.484 | pt_loss: 1.083 | lm_loss: 1.169 | kd_loss: 0.998 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1000/  5000| tot_loss: 2.7775 | rl_loss: 1.0458 | pt_loss: 1.7317 | pg_loss: 0.4007 | reg_loss: 0.6451 | reward: -0.2026 | rev_kl: 1.0868 | stu_lens: 42.5000 | mixed_lens: 61.5000 | lr: 4.5978e-06 | scale: 2048.00 | time: 26.220 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1001/  5000| tot_loss: 3.5100 | rl_loss: 1.4708 | pt_loss: 2.0392 | pg_loss: 0.7215 | reg_loss: 0.7493 | reward: -0.2603 | rev_kl: 0.9846 | stu_lens: 128.0000 | mixed_lens: 66.0000 | lr: 4.5970e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1002/  5000| tot_loss: 2.8464 | rl_loss: 1.0716 | pt_loss: 1.7748 | pg_loss: 0.4729 | reg_loss: 0.5988 | reward: -0.4389 | rev_kl: 1.1394 | stu_lens: 100.0000 | mixed_lens: 65.0000 | lr: 4.5961e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1003/  5000| tot_loss: 2.8656 | rl_loss: 1.4347 | pt_loss: 1.4310 | pg_loss: 0.7633 | reg_loss: 0.6713 | reward: -0.7160 | rev_kl: 0.5393 | stu_lens: 14.5000 | mixed_lens: 35.0000 | lr: 4.5952e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1004/  5000| tot_loss: 2.4066 | rl_loss: 0.6518 | pt_loss: 1.7549 | pg_loss: 0.1540 | reg_loss: 0.4978 | reward: -0.4582 | rev_kl: 1.1235 | stu_lens: 105.5000 | mixed_lens: 93.5000 | lr: 4.5943e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1005/  5000| tot_loss: 2.8563 | rl_loss: 0.9785 | pt_loss: 1.8778 | pg_loss: 0.1798 | reg_loss: 0.7987 | reward: -0.2550 | rev_kl: 1.4281 | stu_lens: 84.5000 | mixed_lens: 105.0000 | lr: 4.5935e-06 | scale: 2048.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1006/  5000| tot_loss: 2.7321 | rl_loss: 0.9503 | pt_loss: 1.7818 | pg_loss: 0.1298 | reg_loss: 0.8205 | reward: -0.1276 | rev_kl: 1.2975 | stu_lens: 67.0000 | mixed_lens: 55.5000 | lr: 4.5926e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1007/  5000| tot_loss: 2.9064 | rl_loss: 1.1714 | pt_loss: 1.7350 | pg_loss: 0.5701 | reg_loss: 0.6013 | reward: 0.2164 | rev_kl: 0.6722 | stu_lens: 53.5000 | mixed_lens: 41.5000 | lr: 4.5917e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1008/  5000| tot_loss: 2.3295 | rl_loss: 0.6574 | pt_loss: 1.6721 | pg_loss: 0.0769 | reg_loss: 0.5805 | reward: -0.1851 | rev_kl: 1.0676 | stu_lens: 96.5000 | mixed_lens: 102.5000 | lr: 4.5908e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1008/  5000| tot_loss: 2.5312 | rl_loss: 0.8512 | pt_loss: 1.6800 | pg_loss: 0.2629 | reg_loss: 0.5883 | reward: -0.3660 | rev_kl: 1.1413 | stu_lens: 80.0312 | mixed_lens: 87.5469 | lr: 4.5908e-06 | scale: 2048.00 | time: 26.254 | step time: 27.539
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1009/  5000| tot_loss: 2.4088 | rl_loss: 0.5922 | pt_loss: 1.8166 | pg_loss: 0.0406 | reg_loss: 0.5516 | reward: -0.3369 | rev_kl: 1.8511 | stu_lens: 96.0000 | mixed_lens: 124.5000 | lr: 4.5900e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1010/  5000| tot_loss: 2.2729 | rl_loss: 0.5624 | pt_loss: 1.7105 | pg_loss: 0.0917 | reg_loss: 0.4707 | reward: -0.5191 | rev_kl: 1.1750 | stu_lens: 78.5000 | mixed_lens: 99.0000 | lr: 4.5891e-06 | scale: 2048.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1011/  5000| tot_loss: 2.5949 | rl_loss: 0.5846 | pt_loss: 2.0103 | pg_loss: 0.1051 | reg_loss: 0.4796 | reward: -0.5249 | rev_kl: 1.1216 | stu_lens: 72.5000 | mixed_lens: 107.5000 | lr: 4.5882e-06 | scale: 2048.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1012/  5000| tot_loss: 2.6908 | rl_loss: 0.9347 | pt_loss: 1.7561 | pg_loss: 0.5910 | reg_loss: 0.3437 | reward: -0.2836 | rev_kl: 0.7641 | stu_lens: 48.5000 | mixed_lens: 75.0000 | lr: 4.5873e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1013/  5000| tot_loss: 1.9283 | rl_loss: 0.7820 | pt_loss: 1.1463 | pg_loss: 0.1954 | reg_loss: 0.5866 | reward: -0.3549 | rev_kl: 1.0571 | stu_lens: 103.0000 | mixed_lens: 104.0000 | lr: 4.5864e-06 | scale: 2048.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1014/  5000| tot_loss: 2.3225 | rl_loss: 0.5865 | pt_loss: 1.7359 | pg_loss: 0.2010 | reg_loss: 0.3856 | reward: 0.3076 | rev_kl: 1.0677 | stu_lens: 39.5000 | mixed_lens: 54.0000 | lr: 4.5855e-06 | scale: 2048.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1015/  5000| tot_loss: 2.2579 | rl_loss: 0.6254 | pt_loss: 1.6325 | pg_loss: 0.2633 | reg_loss: 0.3621 | reward: -0.3074 | rev_kl: 1.9188 | stu_lens: 93.0000 | mixed_lens: 90.5000 | lr: 4.5847e-06 | scale: 2048.00 | time: 26.344 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1016/  5000| tot_loss: 2.3829 | rl_loss: 0.7765 | pt_loss: 1.6064 | pg_loss: 0.1989 | reg_loss: 0.5776 | reward: -0.4732 | rev_kl: 0.6899 | stu_lens: 127.0000 | mixed_lens: 93.5000 | lr: 4.5838e-06 | scale: 2048.00 | time: 26.362 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1017/  5000| tot_loss: 2.0439 | rl_loss: 0.6380 | pt_loss: 1.4058 | pg_loss: 0.1806 | reg_loss: 0.4574 | reward: -0.2346 | rev_kl: 0.9414 | stu_lens: 112.5000 | mixed_lens: 102.0000 | lr: 4.5829e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1018/  5000| tot_loss: 2.6903 | rl_loss: 1.2278 | pt_loss: 1.4625 | pg_loss: 0.5067 | reg_loss: 0.7211 | reward: -0.7607 | rev_kl: 1.1229 | stu_lens: 24.5000 | mixed_lens: 56.5000 | lr: 4.5820e-06 | scale: 2048.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1019/  5000| tot_loss: 3.0426 | rl_loss: 0.9141 | pt_loss: 2.1286 | pg_loss: 0.4704 | reg_loss: 0.4437 | reward: 0.1527 | rev_kl: 1.2353 | stu_lens: 35.5000 | mixed_lens: 67.5000 | lr: 4.5811e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1020/  5000| tot_loss: 2.3379 | rl_loss: 0.6680 | pt_loss: 1.6699 | pg_loss: 0.1738 | reg_loss: 0.4942 | reward: -0.6067 | rev_kl: 1.0088 | stu_lens: 100.0000 | mixed_lens: 114.0000 | lr: 4.5802e-06 | scale: 2048.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1021/  5000| tot_loss: 2.1800 | rl_loss: 0.3570 | pt_loss: 1.8230 | pg_loss: 0.0054 | reg_loss: 0.3516 | reward: -0.1684 | rev_kl: 1.6521 | stu_lens: 98.0000 | mixed_lens: 128.0000 | lr: 4.5793e-06 | scale: 2048.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1022/  5000| tot_loss: 2.9996 | rl_loss: 1.0550 | pt_loss: 1.9446 | pg_loss: 0.3858 | reg_loss: 0.6693 | reward: -0.4670 | rev_kl: 1.1276 | stu_lens: 84.5000 | mixed_lens: 70.5000 | lr: 4.5785e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1023/  5000| tot_loss: 2.5583 | rl_loss: 0.9942 | pt_loss: 1.5641 | pg_loss: 0.3663 | reg_loss: 0.6279 | reward: -0.6024 | rev_kl: 1.0813 | stu_lens: 89.5000 | mixed_lens: 79.0000 | lr: 4.5776e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1024/  5000| tot_loss: 2.2713 | rl_loss: 0.6014 | pt_loss: 1.6699 | pg_loss: 0.2508 | reg_loss: 0.3506 | reward: -0.3093 | rev_kl: 1.0815 | stu_lens: 97.5000 | mixed_lens: 74.5000 | lr: 4.5767e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1024/  5000| tot_loss: 2.4351 | rl_loss: 0.7488 | pt_loss: 1.6862 | pg_loss: 0.2552 | reg_loss: 0.4936 | reward: -0.3595 | rev_kl: 1.1737 | stu_lens: 80.7344 | mixed_lens: 90.2188 | lr: 4.5767e-06 | scale: 2048.00 | time: 26.311 | step time: 27.533
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1025/  5000| tot_loss: 2.3563 | rl_loss: 0.9177 | pt_loss: 1.4385 | pg_loss: 0.4260 | reg_loss: 0.4918 | reward: -0.3466 | rev_kl: 1.0944 | stu_lens: 68.0000 | mixed_lens: 81.5000 | lr: 4.5758e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1026/  5000| tot_loss: 3.0331 | rl_loss: 1.3376 | pt_loss: 1.6955 | pg_loss: 0.0975 | reg_loss: 1.2401 | reward: -0.3162 | rev_kl: 1.1904 | stu_lens: 102.5000 | mixed_lens: 116.0000 | lr: 4.5749e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1027/  5000| tot_loss: 2.3057 | rl_loss: 1.1931 | pt_loss: 1.1126 | pg_loss: 0.0424 | reg_loss: 1.1508 | reward: -0.2103 | rev_kl: 0.9874 | stu_lens: 86.0000 | mixed_lens: 128.0000 | lr: 4.5740e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1028/  5000| tot_loss: 4.1446 | rl_loss: 2.2993 | pt_loss: 1.8453 | pg_loss: 0.6607 | reg_loss: 1.6386 | reward: -0.5667 | rev_kl: 0.5908 | stu_lens: 84.0000 | mixed_lens: 67.5000 | lr: 4.5731e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1029/  5000| tot_loss: 4.1145 | rl_loss: 2.6137 | pt_loss: 1.5008 | pg_loss: 1.3925 | reg_loss: 1.2212 | reward: -0.6486 | rev_kl: 1.0378 | stu_lens: 57.5000 | mixed_lens: 31.0000 | lr: 4.5722e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1030/  5000| tot_loss: 2.9947 | rl_loss: 1.3293 | pt_loss: 1.6654 | pg_loss: 0.1914 | reg_loss: 1.1379 | reward: -0.1655 | rev_kl: 1.0502 | stu_lens: 117.5000 | mixed_lens: 107.0000 | lr: 4.5713e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1031/  5000| tot_loss: 3.4850 | rl_loss: 1.7971 | pt_loss: 1.6880 | pg_loss: 0.8813 | reg_loss: 0.9158 | reward: -0.6758 | rev_kl: 1.0647 | stu_lens: 36.5000 | mixed_lens: 44.5000 | lr: 4.5704e-06 | scale: 2048.00 | time: 26.354 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1032/  5000| tot_loss: 2.8370 | rl_loss: 1.0005 | pt_loss: 1.8365 | pg_loss: 0.0327 | reg_loss: 0.9679 | reward: -0.2901 | rev_kl: 0.4555 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5695e-06 | scale: 2048.00 | time: 26.328 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1033/  5000| tot_loss: 3.2074 | rl_loss: 1.7030 | pt_loss: 1.5044 | pg_loss: 0.2986 | reg_loss: 1.4044 | reward: -0.3787 | rev_kl: 1.2757 | stu_lens: 102.5000 | mixed_lens: 99.0000 | lr: 4.5686e-06 | scale: 2048.00 | time: 26.369 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1034/  5000| tot_loss: 3.4019 | rl_loss: 1.6632 | pt_loss: 1.7387 | pg_loss: 0.5535 | reg_loss: 1.1098 | reward: -0.2314 | rev_kl: 1.0963 | stu_lens: 47.0000 | mixed_lens: 72.0000 | lr: 4.5677e-06 | scale: 2048.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1035/  5000| tot_loss: 3.1173 | rl_loss: 1.4973 | pt_loss: 1.6200 | pg_loss: 0.2503 | reg_loss: 1.2470 | reward: -0.1552 | rev_kl: 1.0213 | stu_lens: 120.5000 | mixed_lens: 101.5000 | lr: 4.5668e-06 | scale: 2048.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1036/  5000| tot_loss: 3.0330 | rl_loss: 1.1139 | pt_loss: 1.9191 | pg_loss: 0.0802 | reg_loss: 1.0337 | reward: -0.3588 | rev_kl: 1.0921 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 4.5659e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1037/  5000| tot_loss: 3.8413 | rl_loss: 1.9618 | pt_loss: 1.8794 | pg_loss: 0.3492 | reg_loss: 1.6127 | reward: -0.5347 | rev_kl: 1.5724 | stu_lens: 87.5000 | mixed_lens: 91.0000 | lr: 4.5650e-06 | scale: 2048.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1038/  5000| tot_loss: 3.2483 | rl_loss: 1.6362 | pt_loss: 1.6121 | pg_loss: 0.2422 | reg_loss: 1.3940 | reward: -0.2388 | rev_kl: 1.1133 | stu_lens: 116.5000 | mixed_lens: 109.5000 | lr: 4.5641e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1039/  5000| tot_loss: 2.4376 | rl_loss: 1.1508 | pt_loss: 1.2868 | pg_loss: 0.2627 | reg_loss: 0.8881 | reward: -0.1835 | rev_kl: 1.0543 | stu_lens: 120.5000 | mixed_lens: 88.0000 | lr: 4.5632e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1040/  5000| tot_loss: 3.5052 | rl_loss: 1.8280 | pt_loss: 1.6772 | pg_loss: 0.3757 | reg_loss: 1.4524 | reward: -1.3538 | rev_kl: 1.3718 | stu_lens: 43.0000 | mixed_lens: 69.0000 | lr: 4.5623e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1040/  5000| tot_loss: 3.2009 | rl_loss: 1.5543 | pt_loss: 1.6466 | pg_loss: 0.3682 | reg_loss: 1.1862 | reward: -0.4872 | rev_kl: 1.1442 | stu_lens: 87.6562 | mixed_lens: 91.3594 | lr: 4.5623e-06 | scale: 2048.00 | time: 26.280 | step time: 27.571
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1041/  5000| tot_loss: 3.3054 | rl_loss: 1.8058 | pt_loss: 1.4996 | pg_loss: 0.1604 | reg_loss: 1.6454 | reward: -0.4647 | rev_kl: 1.3352 | stu_lens: 128.0000 | mixed_lens: 111.0000 | lr: 4.5614e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1042/  5000| tot_loss: 2.6438 | rl_loss: 0.9472 | pt_loss: 1.6966 | pg_loss: 0.2219 | reg_loss: 0.7253 | reward: -0.2692 | rev_kl: 1.0739 | stu_lens: 80.5000 | mixed_lens: 99.0000 | lr: 4.5605e-06 | scale: 2048.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1043/  5000| tot_loss: 3.0872 | rl_loss: 1.2976 | pt_loss: 1.7896 | pg_loss: 0.4450 | reg_loss: 0.8526 | reward: -0.5687 | rev_kl: 1.0440 | stu_lens: 116.5000 | mixed_lens: 75.0000 | lr: 4.5596e-06 | scale: 2048.00 | time: 26.336 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1044/  5000| tot_loss: 3.8877 | rl_loss: 2.1021 | pt_loss: 1.7856 | pg_loss: 1.0651 | reg_loss: 1.0369 | reward: -1.6929 | rev_kl: 1.2266 | stu_lens: 100.0000 | mixed_lens: 36.5000 | lr: 4.5586e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1045/  5000| tot_loss: 2.7435 | rl_loss: 1.0877 | pt_loss: 1.6558 | pg_loss: 0.2133 | reg_loss: 0.8744 | reward: -0.3482 | rev_kl: 1.1574 | stu_lens: 105.5000 | mixed_lens: 100.0000 | lr: 4.5577e-06 | scale: 2048.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1046/  5000| tot_loss: 2.8201 | rl_loss: 1.0012 | pt_loss: 1.8188 | pg_loss: 0.2527 | reg_loss: 0.7485 | reward: -0.3701 | rev_kl: 1.3504 | stu_lens: 69.5000 | mixed_lens: 100.0000 | lr: 4.5568e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1047/  5000| tot_loss: 2.9757 | rl_loss: 1.0150 | pt_loss: 1.9606 | pg_loss: 0.3968 | reg_loss: 0.6182 | reward: -0.2808 | rev_kl: 1.0672 | stu_lens: 87.5000 | mixed_lens: 64.5000 | lr: 4.5559e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1048/  5000| tot_loss: 2.5962 | rl_loss: 0.6871 | pt_loss: 1.9091 | pg_loss: -0.0004 | reg_loss: 0.6875 | reward: -0.1046 | rev_kl: 1.0924 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5550e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1049/  5000| tot_loss: 2.3833 | rl_loss: 1.3144 | pt_loss: 1.0689 | pg_loss: 0.2282 | reg_loss: 1.0862 | reward: -0.5836 | rev_kl: 1.0217 | stu_lens: 85.5000 | mixed_lens: 107.0000 | lr: 4.5541e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1050/  5000| tot_loss: 2.2682 | rl_loss: 0.7130 | pt_loss: 1.5552 | pg_loss: 0.2823 | reg_loss: 0.4306 | reward: -0.3725 | rev_kl: 1.0605 | stu_lens: 111.5000 | mixed_lens: 88.0000 | lr: 4.5532e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1051/  5000| tot_loss: 2.6672 | rl_loss: 0.7677 | pt_loss: 1.8995 | pg_loss: 0.1819 | reg_loss: 0.5858 | reward: -0.4606 | rev_kl: 1.3239 | stu_lens: 108.0000 | mixed_lens: 99.0000 | lr: 4.5523e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1052/  5000| tot_loss: 2.5099 | rl_loss: 1.0444 | pt_loss: 1.4655 | pg_loss: 0.1861 | reg_loss: 0.8582 | reward: -0.7486 | rev_kl: 1.5030 | stu_lens: 38.0000 | mixed_lens: 82.5000 | lr: 4.5513e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1053/  5000| tot_loss: 1.8992 | rl_loss: 0.9707 | pt_loss: 0.9285 | pg_loss: 0.1037 | reg_loss: 0.8670 | reward: -0.4248 | rev_kl: 1.3603 | stu_lens: 108.0000 | mixed_lens: 115.0000 | lr: 4.5504e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1054/  5000| tot_loss: 2.2286 | rl_loss: 0.8324 | pt_loss: 1.3962 | pg_loss: 0.1753 | reg_loss: 0.6571 | reward: -0.3515 | rev_kl: 0.7156 | stu_lens: 88.5000 | mixed_lens: 76.5000 | lr: 4.5495e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1055/  5000| tot_loss: 2.6507 | rl_loss: 1.0353 | pt_loss: 1.6154 | pg_loss: 0.2029 | reg_loss: 0.8323 | reward: -0.3157 | rev_kl: 0.9758 | stu_lens: 87.5000 | mixed_lens: 87.0000 | lr: 4.5486e-06 | scale: 2048.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1056/  5000| tot_loss: 2.8080 | rl_loss: 0.9569 | pt_loss: 1.8511 | pg_loss: 0.1398 | reg_loss: 0.8171 | reward: -0.2285 | rev_kl: 1.0669 | stu_lens: 120.0000 | mixed_lens: 92.0000 | lr: 4.5477e-06 | scale: 2048.00 | time: 26.317 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1056/  5000| tot_loss: 2.7382 | rl_loss: 1.0710 | pt_loss: 1.6672 | pg_loss: 0.2444 | reg_loss: 0.8266 | reward: -0.4995 | rev_kl: 1.2129 | stu_lens: 91.5781 | mixed_lens: 93.7031 | lr: 4.5477e-06 | scale: 2048.00 | time: 26.317 | step time: 27.568
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1057/  5000| tot_loss: 2.2302 | rl_loss: 0.5149 | pt_loss: 1.7152 | pg_loss: 0.2856 | reg_loss: 0.2294 | reward: -0.4922 | rev_kl: 0.3573 | stu_lens: 82.0000 | mixed_lens: 79.0000 | lr: 4.5468e-06 | scale: 2048.00 | time: 26.320 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1058/  5000| tot_loss: 2.3247 | rl_loss: 0.5851 | pt_loss: 1.7396 | pg_loss: 0.1551 | reg_loss: 0.4299 | reward: -0.5934 | rev_kl: 1.5100 | stu_lens: 108.0000 | mixed_lens: 111.0000 | lr: 4.5458e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1059/  5000| tot_loss: 1.5571 | rl_loss: 0.5874 | pt_loss: 0.9697 | pg_loss: 0.1222 | reg_loss: 0.4652 | reward: -0.3669 | rev_kl: 1.5744 | stu_lens: 84.5000 | mixed_lens: 109.5000 | lr: 4.5449e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1060/  5000| tot_loss: 3.2724 | rl_loss: 1.1755 | pt_loss: 2.0969 | pg_loss: 0.4466 | reg_loss: 0.7290 | reward: -0.6958 | rev_kl: 1.1612 | stu_lens: 106.5000 | mixed_lens: 90.0000 | lr: 4.5440e-06 | scale: 2048.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1061/  5000| tot_loss: 2.1590 | rl_loss: 0.6806 | pt_loss: 1.4784 | pg_loss: 0.0107 | reg_loss: 0.6699 | reward: -0.2433 | rev_kl: 1.2569 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5431e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1062/  5000| tot_loss: 2.5146 | rl_loss: 0.9360 | pt_loss: 1.5786 | pg_loss: 0.2883 | reg_loss: 0.6477 | reward: -0.6253 | rev_kl: 1.0685 | stu_lens: 108.0000 | mixed_lens: 93.5000 | lr: 4.5421e-06 | scale: 2048.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1063/  5000| tot_loss: 2.1988 | rl_loss: 0.6381 | pt_loss: 1.5607 | pg_loss: 0.0026 | reg_loss: 0.6354 | reward: -0.4250 | rev_kl: 1.5630 | stu_lens: 62.0000 | mixed_lens: 128.0000 | lr: 4.5412e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1064/  5000| tot_loss: 2.9810 | rl_loss: 0.8242 | pt_loss: 2.1568 | pg_loss: 0.3410 | reg_loss: 0.4832 | reward: -0.4695 | rev_kl: 0.5885 | stu_lens: 60.0000 | mixed_lens: 79.0000 | lr: 4.5403e-06 | scale: 2048.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1065/  5000| tot_loss: 2.5515 | rl_loss: 0.7175 | pt_loss: 1.8340 | pg_loss: 0.0354 | reg_loss: 0.6821 | reward: -0.1616 | rev_kl: 1.2576 | stu_lens: 65.0000 | mixed_lens: 128.0000 | lr: 4.5394e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1066/  5000| tot_loss: 2.6148 | rl_loss: 0.5601 | pt_loss: 2.0547 | pg_loss: 0.0009 | reg_loss: 0.5591 | reward: -0.2538 | rev_kl: 0.9210 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5384e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1067/  5000| tot_loss: 3.1367 | rl_loss: 1.3568 | pt_loss: 1.7799 | pg_loss: 0.5765 | reg_loss: 0.7803 | reward: -1.1721 | rev_kl: 1.1445 | stu_lens: 68.5000 | mixed_lens: 36.5000 | lr: 4.5375e-06 | scale: 2048.00 | time: 26.327 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1068/  5000| tot_loss: 2.2809 | rl_loss: 0.5878 | pt_loss: 1.6931 | pg_loss: 0.0264 | reg_loss: 0.5614 | reward: -0.2446 | rev_kl: 1.0541 | stu_lens: 101.5000 | mixed_lens: 126.0000 | lr: 4.5366e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1069/  5000| tot_loss: 2.8316 | rl_loss: 1.1419 | pt_loss: 1.6897 | pg_loss: 0.5189 | reg_loss: 0.6230 | reward: -0.3967 | rev_kl: 1.3197 | stu_lens: 80.0000 | mixed_lens: 71.0000 | lr: 4.5357e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1070/  5000| tot_loss: 2.2629 | rl_loss: 0.4710 | pt_loss: 1.7919 | pg_loss: -0.0159 | reg_loss: 0.4869 | reward: -0.2551 | rev_kl: 1.3788 | stu_lens: 120.0000 | mixed_lens: 128.0000 | lr: 4.5347e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1071/  5000| tot_loss: 2.8228 | rl_loss: 1.1716 | pt_loss: 1.6512 | pg_loss: 0.5768 | reg_loss: 0.5947 | reward: -0.7334 | rev_kl: 1.1122 | stu_lens: 27.5000 | mixed_lens: 51.0000 | lr: 4.5338e-06 | scale: 2048.00 | time: 26.315 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1072/  5000| tot_loss: 2.4362 | rl_loss: 1.0378 | pt_loss: 1.3984 | pg_loss: 0.6442 | reg_loss: 0.3937 | reward: -0.5444 | rev_kl: 1.2265 | stu_lens: 49.0000 | mixed_lens: 59.0000 | lr: 4.5329e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1072/  5000| tot_loss: 2.5059 | rl_loss: 0.8518 | pt_loss: 1.6541 | pg_loss: 0.2854 | reg_loss: 0.5664 | reward: -0.5040 | rev_kl: 1.1541 | stu_lens: 89.6562 | mixed_lens: 93.0469 | lr: 4.5329e-06 | scale: 2048.00 | time: 26.253 | step time: 27.551
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1073/  5000| tot_loss: 2.3838 | rl_loss: 0.3817 | pt_loss: 2.0020 | pg_loss: 0.0658 | reg_loss: 0.3159 | reward: -0.3160 | rev_kl: 1.5353 | stu_lens: 111.0000 | mixed_lens: 116.0000 | lr: 4.5319e-06 | scale: 2048.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1074/  5000| tot_loss: 3.6442 | rl_loss: 1.4573 | pt_loss: 2.1869 | pg_loss: 0.6678 | reg_loss: 0.7895 | reward: -1.5369 | rev_kl: 1.1183 | stu_lens: 79.0000 | mixed_lens: 68.5000 | lr: 4.5310e-06 | scale: 2048.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1075/  5000| tot_loss: 2.6352 | rl_loss: 0.8704 | pt_loss: 1.7648 | pg_loss: 0.3902 | reg_loss: 0.4801 | reward: -0.3117 | rev_kl: 1.3269 | stu_lens: 91.0000 | mixed_lens: 80.5000 | lr: 4.5301e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1076/  5000| tot_loss: 2.2886 | rl_loss: 0.6125 | pt_loss: 1.6761 | pg_loss: 0.3683 | reg_loss: 0.2442 | reward: -0.4588 | rev_kl: 1.0306 | stu_lens: 64.0000 | mixed_lens: 96.0000 | lr: 4.5291e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1077/  5000| tot_loss: 2.5130 | rl_loss: 0.5704 | pt_loss: 1.9427 | pg_loss: 0.0138 | reg_loss: 0.5566 | reward: -0.1448 | rev_kl: 1.6390 | stu_lens: 113.5000 | mixed_lens: 128.0000 | lr: 4.5282e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1078/  5000| tot_loss: 2.1772 | rl_loss: 0.5115 | pt_loss: 1.6657 | pg_loss: 0.1730 | reg_loss: 0.3385 | reward: -0.2718 | rev_kl: 1.3412 | stu_lens: 90.5000 | mixed_lens: 107.0000 | lr: 4.5272e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1079/  5000| tot_loss: 2.5702 | rl_loss: 0.8498 | pt_loss: 1.7204 | pg_loss: 0.6160 | reg_loss: 0.2338 | reward: -0.4913 | rev_kl: 1.1225 | stu_lens: 100.5000 | mixed_lens: 71.0000 | lr: 4.5263e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1080/  5000| tot_loss: 2.2877 | rl_loss: 0.6541 | pt_loss: 1.6336 | pg_loss: 0.1190 | reg_loss: 0.5351 | reward: -0.2827 | rev_kl: 0.4185 | stu_lens: 84.0000 | mixed_lens: 102.0000 | lr: 4.5254e-06 | scale: 2048.00 | time: 26.204 | step time: 0.000
[2023-12-19 04:02:27,636] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, but hysteresis is 2. Reducing hysteresis to 1
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1081/  5000| tot_loss: 2.1005 | rl_loss: 0.5035 | pt_loss: 1.5970 | pg_loss: 0.1100 | reg_loss: 0.3935 | reward: -0.3523 | rev_kl: 1.6968 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 4.5254e-06 | scale: 2048.00 | time: 2.850 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1082/  5000| tot_loss: 2.5671 | rl_loss: 0.6404 | pt_loss: 1.9267 | pg_loss: 0.1622 | reg_loss: 0.4782 | reward: -0.5049 | rev_kl: 1.5717 | stu_lens: 103.5000 | mixed_lens: 96.0000 | lr: 4.5244e-06 | scale: 2048.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1083/  5000| tot_loss: 2.4579 | rl_loss: 0.6529 | pt_loss: 1.8050 | pg_loss: 0.1183 | reg_loss: 0.5346 | reward: -0.1624 | rev_kl: 1.0730 | stu_lens: 104.0000 | mixed_lens: 92.0000 | lr: 4.5235e-06 | scale: 2048.00 | time: 26.205 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1084/  5000| tot_loss: 2.1888 | rl_loss: 0.6065 | pt_loss: 1.5823 | pg_loss: 0.2520 | reg_loss: 0.3545 | reward: -0.3157 | rev_kl: 0.9758 | stu_lens: 87.5000 | mixed_lens: 87.0000 | lr: 4.5225e-06 | scale: 2048.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1085/  5000| tot_loss: 2.5885 | rl_loss: 0.7526 | pt_loss: 1.8359 | pg_loss: 0.3724 | reg_loss: 0.3802 | reward: -0.3298 | rev_kl: 1.1806 | stu_lens: 82.5000 | mixed_lens: 67.0000 | lr: 4.5216e-06 | scale: 2048.00 | time: 26.188 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1086/  5000| tot_loss: 2.4563 | rl_loss: 0.7142 | pt_loss: 1.7422 | pg_loss: 0.1493 | reg_loss: 0.5649 | reward: -0.9531 | rev_kl: 1.1700 | stu_lens: 68.5000 | mixed_lens: 68.5000 | lr: 4.5207e-06 | scale: 2048.00 | time: 26.204 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1087/  5000| tot_loss: 2.4043 | rl_loss: 0.5621 | pt_loss: 1.8422 | pg_loss: 0.2451 | reg_loss: 0.3169 | reward: -0.3400 | rev_kl: 1.5842 | stu_lens: 70.5000 | mixed_lens: 91.0000 | lr: 4.5197e-06 | scale: 2048.00 | time: 26.190 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1088/  5000| tot_loss: 2.3220 | rl_loss: 0.3989 | pt_loss: 1.9231 | pg_loss: 0.0019 | reg_loss: 0.3970 | reward: -0.2760 | rev_kl: 1.2935 | stu_lens: 119.0000 | mixed_lens: 128.0000 | lr: 4.5188e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1088/  5000| tot_loss: 2.4645 | rl_loss: 0.6942 | pt_loss: 1.7704 | pg_loss: 0.2682 | reg_loss: 0.4259 | reward: -0.4573 | rev_kl: 1.1867 | stu_lens: 92.6562 | mixed_lens: 95.1406 | lr: 4.5188e-06 | scale: 2048.00 | time: 26.275 | step time: 26.035
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1089/  5000| tot_loss: 1.8165 | rl_loss: 0.7398 | pt_loss: 1.0767 | pg_loss: 0.3365 | reg_loss: 0.4034 | reward: -1.3793 | rev_kl: 1.3209 | stu_lens: 60.0000 | mixed_lens: 66.5000 | lr: 4.5178e-06 | scale: 2048.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1090/  5000| tot_loss: 3.5824 | rl_loss: 1.5360 | pt_loss: 2.0464 | pg_loss: 0.0457 | reg_loss: 1.4903 | reward: -0.4131 | rev_kl: 2.2510 | stu_lens: 118.5000 | mixed_lens: 128.0000 | lr: 4.5169e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1091/  5000| tot_loss: 5.1883 | rl_loss: 3.2474 | pt_loss: 1.9410 | pg_loss: 1.9826 | reg_loss: 1.2647 | reward: 0.3975 | rev_kl: 1.8036 | stu_lens: 35.5000 | mixed_lens: 18.0000 | lr: 4.5159e-06 | scale: 2048.00 | time: 26.209 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1092/  5000| tot_loss: 2.9252 | rl_loss: 1.0233 | pt_loss: 1.9019 | pg_loss: 0.2177 | reg_loss: 0.8056 | reward: -0.3394 | rev_kl: 0.5822 | stu_lens: 92.5000 | mixed_lens: 88.0000 | lr: 4.5150e-06 | scale: 2048.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1093/  5000| tot_loss: 3.4828 | rl_loss: 1.5790 | pt_loss: 1.9037 | pg_loss: 0.1083 | reg_loss: 1.4707 | reward: -0.4284 | rev_kl: 1.2426 | stu_lens: 122.5000 | mixed_lens: 116.5000 | lr: 4.5140e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1094/  5000| tot_loss: 2.6830 | rl_loss: 1.3575 | pt_loss: 1.3255 | pg_loss: 0.0626 | reg_loss: 1.2948 | reward: -0.3532 | rev_kl: 1.0524 | stu_lens: 128.0000 | mixed_lens: 127.0000 | lr: 4.5131e-06 | scale: 2048.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1095/  5000| tot_loss: 3.1412 | rl_loss: 1.3648 | pt_loss: 1.7764 | pg_loss: 0.0671 | reg_loss: 1.2977 | reward: -0.2985 | rev_kl: 0.8431 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5121e-06 | scale: 2048.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1096/  5000| tot_loss: 2.9230 | rl_loss: 1.3166 | pt_loss: 1.6064 | pg_loss: 0.1833 | reg_loss: 1.1333 | reward: -0.3019 | rev_kl: 0.4958 | stu_lens: 128.0000 | mixed_lens: 101.0000 | lr: 4.5112e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1097/  5000| tot_loss: 3.7661 | rl_loss: 1.8750 | pt_loss: 1.8911 | pg_loss: 0.5942 | reg_loss: 1.2808 | reward: -0.5515 | rev_kl: 1.2764 | stu_lens: 119.5000 | mixed_lens: 75.5000 | lr: 4.5102e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1098/  5000| tot_loss: 2.9325 | rl_loss: 1.3196 | pt_loss: 1.6129 | pg_loss: 0.2274 | reg_loss: 1.0923 | reward: -0.4994 | rev_kl: 1.2992 | stu_lens: 128.0000 | mixed_lens: 89.5000 | lr: 4.5093e-06 | scale: 2048.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1099/  5000| tot_loss: 3.7781 | rl_loss: 1.8566 | pt_loss: 1.9215 | pg_loss: 1.1379 | reg_loss: 0.7186 | reward: -0.4219 | rev_kl: 0.8582 | stu_lens: 31.0000 | mixed_lens: 10.5000 | lr: 4.5083e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
                                 Evaluation #11                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Bob should leave Alice. His chances  │
│                                       │ of survival improve by 9% if he      │
│                                       │ leaves Alice. So in this case, it is │
│                                       │ optimal for Bob to leave Alice and   │
│                                       │ try to find safety on his own.       │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ It is a typing tool that allows you  │
│                                       │ to type in the language of your      │
│                                       │ choice. It has a number of different │
│                                       │ keyboards that you can use,          │
│                                       │ including a QWERTY keyboard, a       │
│                                       │ DVORAK keyboard, and a numeric       │
│                                       │ keypad. It also has a number of      │
│                                       │ other tools to help you type more    │
│                                       │ quickly and accurately, such as a    │
│                                       │ word prediction tool and a text      │
│                                       │ replacement tool.                    │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support 7 languages: English,     │
│                                       │ Spanish, French, German, Italian,    │
│                                       │ Portuguese, and Dutch.               │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.216 | exact_match: 0.000 | rev_kl: 1.106 | lens: 88.592 | pt_loss: 1.082 | lm_loss: 1.166 | kd_loss: 0.998 
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1100/  5000| tot_loss: 3.2972 | rl_loss: 1.1077 | pt_loss: 2.1895 | pg_loss: 0.0288 | reg_loss: 1.0789 | reward: -0.1541 | rev_kl: 1.1143 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5074e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1101/  5000| tot_loss: 2.7855 | rl_loss: 0.8605 | pt_loss: 1.9250 | pg_loss: 0.0465 | reg_loss: 0.8140 | reward: -0.2136 | rev_kl: 0.8585 | stu_lens: 115.5000 | mixed_lens: 128.0000 | lr: 4.5064e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1102/  5000| tot_loss: 3.7413 | rl_loss: 2.2421 | pt_loss: 1.4992 | pg_loss: 0.7638 | reg_loss: 1.4783 | reward: -0.3516 | rev_kl: 1.7183 | stu_lens: 53.0000 | mixed_lens: 52.5000 | lr: 4.5054e-06 | scale: 2048.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1103/  5000| tot_loss: 2.5995 | rl_loss: 1.1995 | pt_loss: 1.4000 | pg_loss: 0.5267 | reg_loss: 0.6728 | reward: -0.2202 | rev_kl: 0.6013 | stu_lens: 55.5000 | mixed_lens: 65.0000 | lr: 4.5045e-06 | scale: 2048.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1104/  5000| tot_loss: 3.0651 | rl_loss: 1.5719 | pt_loss: 1.4932 | pg_loss: 0.1465 | reg_loss: 1.4255 | reward: -0.1957 | rev_kl: 1.3814 | stu_lens: 128.0000 | mixed_lens: 117.5000 | lr: 4.5035e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1104/  5000| tot_loss: 3.2292 | rl_loss: 1.5266 | pt_loss: 1.7027 | pg_loss: 0.3643 | reg_loss: 1.1623 | reward: -0.4269 | rev_kl: 1.1399 | stu_lens: 89.9375 | mixed_lens: 82.3281 | lr: 4.5035e-06 | scale: 2048.00 | time: 26.257 | step time: 27.516
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1105/  5000| tot_loss: 3.8841 | rl_loss: 2.8532 | pt_loss: 1.0309 | pg_loss: 1.6481 | reg_loss: 1.2052 | reward: -0.5001 | rev_kl: 1.2477 | stu_lens: 15.0000 | mixed_lens: 22.5000 | lr: 4.5026e-06 | scale: 2048.00 | time: 26.209 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1106/  5000| tot_loss: 2.8379 | rl_loss: 0.9566 | pt_loss: 1.8813 | pg_loss: 0.5810 | reg_loss: 0.3755 | reward: -0.2355 | rev_kl: 0.6323 | stu_lens: 65.0000 | mixed_lens: 65.0000 | lr: 4.5016e-06 | scale: 2048.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1107/  5000| tot_loss: 2.7651 | rl_loss: 1.1160 | pt_loss: 1.6491 | pg_loss: 0.4640 | reg_loss: 0.6520 | reward: -0.3604 | rev_kl: 1.0291 | stu_lens: 128.0000 | mixed_lens: 74.0000 | lr: 4.5007e-06 | scale: 2048.00 | time: 26.206 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1108/  5000| tot_loss: 2.7499 | rl_loss: 1.0851 | pt_loss: 1.6648 | pg_loss: 0.3085 | reg_loss: 0.7766 | reward: -0.7764 | rev_kl: 1.5790 | stu_lens: 110.0000 | mixed_lens: 98.5000 | lr: 4.4997e-06 | scale: 2048.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1109/  5000| tot_loss: 2.9748 | rl_loss: 1.3018 | pt_loss: 1.6731 | pg_loss: 0.5006 | reg_loss: 0.8012 | reward: -0.7251 | rev_kl: 1.3785 | stu_lens: 90.5000 | mixed_lens: 64.5000 | lr: 4.4987e-06 | scale: 2048.00 | time: 26.192 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1110/  5000| tot_loss: 2.7834 | rl_loss: 0.7022 | pt_loss: 2.0813 | pg_loss: 0.0224 | reg_loss: 0.6797 | reward: -0.2447 | rev_kl: 0.9814 | stu_lens: 118.5000 | mixed_lens: 128.0000 | lr: 4.4978e-06 | scale: 2048.00 | time: 26.207 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1111/  5000| tot_loss: 2.6860 | rl_loss: 1.0474 | pt_loss: 1.6386 | pg_loss: 0.0412 | reg_loss: 1.0062 | reward: -0.2511 | rev_kl: 1.6037 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4968e-06 | scale: 2048.00 | time: 26.190 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1112/  5000| tot_loss: 2.7507 | rl_loss: 0.9845 | pt_loss: 1.7662 | pg_loss: 0.1550 | reg_loss: 0.8295 | reward: -0.4222 | rev_kl: 1.2900 | stu_lens: 122.5000 | mixed_lens: 105.5000 | lr: 4.4958e-06 | scale: 2048.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1113/  5000| tot_loss: 2.7333 | rl_loss: 0.9157 | pt_loss: 1.8177 | pg_loss: -0.0100 | reg_loss: 0.9257 | reward: -0.1460 | rev_kl: 1.0683 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4949e-06 | scale: 2048.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1114/  5000| tot_loss: 2.5661 | rl_loss: 0.8786 | pt_loss: 1.6875 | pg_loss: 0.0319 | reg_loss: 0.8467 | reward: -0.4047 | rev_kl: 0.8948 | stu_lens: 85.0000 | mixed_lens: 23.5000 | lr: 4.4939e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1115/  5000| tot_loss: 3.1717 | rl_loss: 1.4044 | pt_loss: 1.7673 | pg_loss: 0.5020 | reg_loss: 0.9024 | reward: -0.3770 | rev_kl: 1.0984 | stu_lens: 73.5000 | mixed_lens: 72.5000 | lr: 4.4929e-06 | scale: 2048.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1116/  5000| tot_loss: 3.2828 | rl_loss: 1.5020 | pt_loss: 1.7808 | pg_loss: 0.7107 | reg_loss: 0.7913 | reward: -0.0490 | rev_kl: 1.4668 | stu_lens: 66.0000 | mixed_lens: 63.0000 | lr: 4.4920e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1117/  5000| tot_loss: 1.8864 | rl_loss: 0.7829 | pt_loss: 1.1035 | pg_loss: 0.6123 | reg_loss: 0.1706 | reward: -0.4431 | rev_kl: 0.1309 | stu_lens: 12.0000 | mixed_lens: 12.0000 | lr: 4.4910e-06 | scale: 2048.00 | time: 26.197 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1118/  5000| tot_loss: 2.0789 | rl_loss: 0.4043 | pt_loss: 1.6746 | pg_loss: 0.1273 | reg_loss: 0.2770 | reward: -0.3679 | rev_kl: 1.0428 | stu_lens: 86.5000 | mixed_lens: 66.0000 | lr: 4.4900e-06 | scale: 2048.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1119/  5000| tot_loss: 3.3258 | rl_loss: 1.4490 | pt_loss: 1.8768 | pg_loss: 0.4272 | reg_loss: 1.0219 | reward: -0.6279 | rev_kl: 1.0862 | stu_lens: 75.5000 | mixed_lens: 78.0000 | lr: 4.4891e-06 | scale: 2048.00 | time: 26.190 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1120/  5000| tot_loss: 3.3485 | rl_loss: 1.2112 | pt_loss: 2.1373 | pg_loss: 0.3630 | reg_loss: 0.8482 | reward: -0.3913 | rev_kl: 1.6106 | stu_lens: 75.5000 | mixed_lens: 83.0000 | lr: 4.4881e-06 | scale: 2048.00 | time: 26.207 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1120/  5000| tot_loss: 2.8591 | rl_loss: 1.1628 | pt_loss: 1.6963 | pg_loss: 0.3831 | reg_loss: 0.7797 | reward: -0.4084 | rev_kl: 1.1567 | stu_lens: 85.3438 | mixed_lens: 78.9688 | lr: 4.4881e-06 | scale: 2048.00 | time: 26.207 | step time: 27.482
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1121/  5000| tot_loss: 2.5655 | rl_loss: 0.8768 | pt_loss: 1.6887 | pg_loss: 0.2544 | reg_loss: 0.6224 | reward: -0.3838 | rev_kl: 1.0011 | stu_lens: 92.0000 | mixed_lens: 37.0000 | lr: 4.4871e-06 | scale: 2048.00 | time: 26.187 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1122/  5000| tot_loss: 2.2122 | rl_loss: 0.7186 | pt_loss: 1.4936 | pg_loss: 0.4145 | reg_loss: 0.3041 | reward: -0.0779 | rev_kl: 1.0168 | stu_lens: 66.0000 | mixed_lens: 73.5000 | lr: 4.4861e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1123/  5000| tot_loss: 2.2255 | rl_loss: 0.5979 | pt_loss: 1.6276 | pg_loss: 0.2095 | reg_loss: 0.3884 | reward: -0.5797 | rev_kl: 1.3363 | stu_lens: 113.0000 | mixed_lens: 104.5000 | lr: 4.4852e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1124/  5000| tot_loss: 2.2068 | rl_loss: 0.7655 | pt_loss: 1.4413 | pg_loss: 0.2607 | reg_loss: 0.5048 | reward: -0.4611 | rev_kl: 1.5948 | stu_lens: 128.0000 | mixed_lens: 97.0000 | lr: 4.4842e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1125/  5000| tot_loss: 2.7522 | rl_loss: 0.8451 | pt_loss: 1.9071 | pg_loss: 0.2102 | reg_loss: 0.6349 | reward: -0.5064 | rev_kl: 1.6514 | stu_lens: 115.0000 | mixed_lens: 107.0000 | lr: 4.4832e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1126/  5000| tot_loss: 3.1056 | rl_loss: 1.7267 | pt_loss: 1.3789 | pg_loss: 0.7218 | reg_loss: 1.0049 | reward: -0.2898 | rev_kl: 1.1140 | stu_lens: 83.0000 | mixed_lens: 50.0000 | lr: 4.4822e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1127/  5000| tot_loss: 2.4088 | rl_loss: 0.6920 | pt_loss: 1.7168 | pg_loss: 0.2591 | reg_loss: 0.4328 | reward: -0.0708 | rev_kl: 0.9820 | stu_lens: 76.0000 | mixed_lens: 77.5000 | lr: 4.4813e-06 | scale: 2048.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1128/  5000| tot_loss: 2.9644 | rl_loss: 1.0413 | pt_loss: 1.9230 | pg_loss: 0.5216 | reg_loss: 0.5198 | reward: -0.2943 | rev_kl: 0.5856 | stu_lens: 65.0000 | mixed_lens: 65.0000 | lr: 4.4803e-06 | scale: 2048.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1129/  5000| tot_loss: 2.6094 | rl_loss: 1.1207 | pt_loss: 1.4887 | pg_loss: 0.4326 | reg_loss: 0.6881 | reward: -0.5381 | rev_kl: 0.9303 | stu_lens: 99.5000 | mixed_lens: 78.0000 | lr: 4.4793e-06 | scale: 2048.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1130/  5000| tot_loss: 2.9618 | rl_loss: 1.1267 | pt_loss: 1.8351 | pg_loss: 0.6948 | reg_loss: 0.4319 | reward: -0.5355 | rev_kl: 2.4750 | stu_lens: 56.5000 | mixed_lens: 47.0000 | lr: 4.4783e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1131/  5000| tot_loss: 2.6356 | rl_loss: 0.8155 | pt_loss: 1.8201 | pg_loss: 0.0620 | reg_loss: 0.7535 | reward: -0.3410 | rev_kl: 1.0108 | stu_lens: 128.0000 | mixed_lens: 118.5000 | lr: 4.4774e-06 | scale: 2048.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1132/  5000| tot_loss: 2.5307 | rl_loss: 0.7301 | pt_loss: 1.8005 | pg_loss: 0.1922 | reg_loss: 0.5379 | reward: -0.1989 | rev_kl: 1.1474 | stu_lens: 121.0000 | mixed_lens: 72.5000 | lr: 4.4764e-06 | scale: 2048.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1133/  5000| tot_loss: 2.6135 | rl_loss: 0.8609 | pt_loss: 1.7527 | pg_loss: 0.2725 | reg_loss: 0.5884 | reward: -0.5517 | rev_kl: 1.1064 | stu_lens: 128.0000 | mixed_lens: 89.5000 | lr: 4.4754e-06 | scale: 2048.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1134/  5000| tot_loss: 2.5244 | rl_loss: 0.6198 | pt_loss: 1.9047 | pg_loss: 0.1633 | reg_loss: 0.4564 | reward: -0.4696 | rev_kl: 1.9852 | stu_lens: 86.0000 | mixed_lens: 104.5000 | lr: 4.4744e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1135/  5000| tot_loss: 2.7687 | rl_loss: 0.9352 | pt_loss: 1.8335 | pg_loss: 0.2881 | reg_loss: 0.6471 | reward: -0.3899 | rev_kl: 0.7091 | stu_lens: 73.5000 | mixed_lens: 95.5000 | lr: 4.4734e-06 | scale: 2048.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1136/  5000| tot_loss: 2.0883 | rl_loss: 0.5521 | pt_loss: 1.5362 | pg_loss: 0.1858 | reg_loss: 0.3663 | reward: -0.2861 | rev_kl: 0.6386 | stu_lens: 90.5000 | mixed_lens: 101.5000 | lr: 4.4724e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1136/  5000| tot_loss: 2.5260 | rl_loss: 0.8585 | pt_loss: 1.6675 | pg_loss: 0.3485 | reg_loss: 0.5100 | reward: -0.4215 | rev_kl: 1.1552 | stu_lens: 88.6094 | mixed_lens: 79.1406 | lr: 4.4724e-06 | scale: 2048.00 | time: 26.271 | step time: 27.513
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1137/  5000| tot_loss: 2.4759 | rl_loss: 0.9520 | pt_loss: 1.5240 | pg_loss: 0.3692 | reg_loss: 0.5827 | reward: -0.2177 | rev_kl: 1.1624 | stu_lens: 120.5000 | mixed_lens: 65.0000 | lr: 4.4715e-06 | scale: 2048.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1138/  5000| tot_loss: 2.1162 | rl_loss: 0.3902 | pt_loss: 1.7260 | pg_loss: 0.2020 | reg_loss: 0.1882 | reward: -0.4764 | rev_kl: 0.5312 | stu_lens: 85.5000 | mixed_lens: 67.5000 | lr: 4.4705e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1139/  5000| tot_loss: 2.3577 | rl_loss: 0.5577 | pt_loss: 1.8000 | pg_loss: 0.0212 | reg_loss: 0.5365 | reward: -0.2871 | rev_kl: 1.7606 | stu_lens: 122.5000 | mixed_lens: 128.0000 | lr: 4.4695e-06 | scale: 2048.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1140/  5000| tot_loss: 2.5081 | rl_loss: 0.6439 | pt_loss: 1.8641 | pg_loss: 0.1101 | reg_loss: 0.5338 | reward: -0.4514 | rev_kl: 1.6869 | stu_lens: 128.0000 | mixed_lens: 116.5000 | lr: 4.4685e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1141/  5000| tot_loss: 2.2885 | rl_loss: 0.9009 | pt_loss: 1.3877 | pg_loss: 0.4117 | reg_loss: 0.4892 | reward: -0.5729 | rev_kl: 1.2467 | stu_lens: 119.5000 | mixed_lens: 88.0000 | lr: 4.4675e-06 | scale: 2048.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1142/  5000| tot_loss: 3.5158 | rl_loss: 1.5953 | pt_loss: 1.9205 | pg_loss: 1.1714 | reg_loss: 0.4239 | reward: -0.3912 | rev_kl: 1.3416 | stu_lens: 45.0000 | mixed_lens: 22.0000 | lr: 4.4665e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1143/  5000| tot_loss: 3.5011 | rl_loss: 1.3047 | pt_loss: 2.1964 | pg_loss: 0.7653 | reg_loss: 0.5394 | reward: -0.4452 | rev_kl: 0.8281 | stu_lens: 67.5000 | mixed_lens: 67.5000 | lr: 4.4655e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1144/  5000| tot_loss: 2.4719 | rl_loss: 0.6550 | pt_loss: 1.8168 | pg_loss: 0.1958 | reg_loss: 0.4592 | reward: -0.2791 | rev_kl: 1.8137 | stu_lens: 75.5000 | mixed_lens: 83.0000 | lr: 4.4645e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1145/  5000| tot_loss: 2.7349 | rl_loss: 0.8212 | pt_loss: 1.9137 | pg_loss: 0.4676 | reg_loss: 0.3536 | reward: -0.4512 | rev_kl: 1.4570 | stu_lens: 128.0000 | mixed_lens: 64.0000 | lr: 4.4635e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1146/  5000| tot_loss: 1.8785 | rl_loss: 0.4057 | pt_loss: 1.4728 | pg_loss: -0.0041 | reg_loss: 0.4099 | reward: -0.1214 | rev_kl: 1.2987 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4625e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1147/  5000| tot_loss: 2.5492 | rl_loss: 0.6959 | pt_loss: 1.8534 | pg_loss: 0.1989 | reg_loss: 0.4969 | reward: -0.3793 | rev_kl: 1.0288 | stu_lens: 86.5000 | mixed_lens: 66.0000 | lr: 4.4616e-06 | scale: 2048.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1148/  5000| tot_loss: 1.7116 | rl_loss: 0.3842 | pt_loss: 1.3274 | pg_loss: 0.0182 | reg_loss: 0.3660 | reward: -0.3992 | rev_kl: 1.7136 | stu_lens: 118.5000 | mixed_lens: 128.0000 | lr: 4.4606e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1149/  5000| tot_loss: 2.2027 | rl_loss: 0.3679 | pt_loss: 1.8348 | pg_loss: 0.0548 | reg_loss: 0.3131 | reward: -0.0577 | rev_kl: 0.6450 | stu_lens: 92.5000 | mixed_lens: 110.5000 | lr: 4.4596e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1150/  5000| tot_loss: 2.0128 | rl_loss: 0.6761 | pt_loss: 1.3367 | pg_loss: 0.0944 | reg_loss: 0.5817 | reward: -0.3558 | rev_kl: 1.2439 | stu_lens: 112.5000 | mixed_lens: 119.5000 | lr: 4.4586e-06 | scale: 2048.00 | time: 26.225 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1151/  5000| tot_loss: 2.4917 | rl_loss: 1.0405 | pt_loss: 1.4512 | pg_loss: 0.7763 | reg_loss: 0.2642 | reward: 0.4356 | rev_kl: 1.6651 | stu_lens: 80.5000 | mixed_lens: 46.0000 | lr: 4.4576e-06 | scale: 2048.00 | time: 26.212 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1152/  5000| tot_loss: 2.3380 | rl_loss: 0.5437 | pt_loss: 1.7943 | pg_loss: 0.1235 | reg_loss: 0.4202 | reward: -0.4991 | rev_kl: 1.4976 | stu_lens: 115.0000 | mixed_lens: 107.0000 | lr: 4.4566e-06 | scale: 2048.00 | time: 26.228 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1152/  5000| tot_loss: 2.3134 | rl_loss: 0.6620 | pt_loss: 1.6514 | pg_loss: 0.2604 | reg_loss: 0.4016 | reward: -0.3310 | rev_kl: 1.1341 | stu_lens: 93.4062 | mixed_lens: 80.6406 | lr: 4.4566e-06 | scale: 2048.00 | time: 26.228 | step time: 27.516
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1153/  5000| tot_loss: 2.8973 | rl_loss: 0.9391 | pt_loss: 1.9582 | pg_loss: 0.5689 | reg_loss: 0.3701 | reward: -0.8410 | rev_kl: 1.4669 | stu_lens: 73.5000 | mixed_lens: 68.0000 | lr: 4.4556e-06 | scale: 2048.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1154/  5000| tot_loss: 2.9784 | rl_loss: 1.3637 | pt_loss: 1.6147 | pg_loss: 0.0462 | reg_loss: 1.3175 | reward: -0.1781 | rev_kl: 1.1606 | stu_lens: 100.0000 | mixed_lens: 128.0000 | lr: 4.4546e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1155/  5000| tot_loss: 4.0839 | rl_loss: 1.8095 | pt_loss: 2.2745 | pg_loss: 0.3099 | reg_loss: 1.4995 | reward: -0.3428 | rev_kl: 0.7340 | stu_lens: 107.0000 | mixed_lens: 100.0000 | lr: 4.4536e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1156/  5000| tot_loss: 3.6600 | rl_loss: 2.1716 | pt_loss: 1.4883 | pg_loss: 0.4674 | reg_loss: 1.7042 | reward: -0.3040 | rev_kl: 1.2963 | stu_lens: 128.0000 | mixed_lens: 83.0000 | lr: 4.4526e-06 | scale: 2048.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1157/  5000| tot_loss: 2.9812 | rl_loss: 1.6511 | pt_loss: 1.3301 | pg_loss: 0.1972 | reg_loss: 1.4539 | reward: -0.3870 | rev_kl: 0.9651 | stu_lens: 46.5000 | mixed_lens: 109.0000 | lr: 4.4516e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1158/  5000| tot_loss: 2.8495 | rl_loss: 1.1595 | pt_loss: 1.6900 | pg_loss: 0.3741 | reg_loss: 0.7853 | reward: -0.3294 | rev_kl: 0.5703 | stu_lens: 101.5000 | mixed_lens: 62.5000 | lr: 4.4506e-06 | scale: 2048.00 | time: 26.211 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1159/  5000| tot_loss: 3.5931 | rl_loss: 1.8501 | pt_loss: 1.7430 | pg_loss: 0.3541 | reg_loss: 1.4960 | reward: -0.2584 | rev_kl: 1.2583 | stu_lens: 77.0000 | mixed_lens: 87.5000 | lr: 4.4496e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1160/  5000| tot_loss: 2.8377 | rl_loss: 1.2131 | pt_loss: 1.6246 | pg_loss: 0.1067 | reg_loss: 1.1064 | reward: -0.1888 | rev_kl: 1.3999 | stu_lens: 116.0000 | mixed_lens: 112.0000 | lr: 4.4486e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1161/  5000| tot_loss: 3.9542 | rl_loss: 1.8107 | pt_loss: 2.1435 | pg_loss: 0.4538 | reg_loss: 1.3570 | reward: -0.4514 | rev_kl: 0.9293 | stu_lens: 110.5000 | mixed_lens: 76.5000 | lr: 4.4476e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1162/  5000| tot_loss: 2.0259 | rl_loss: 0.2921 | pt_loss: 1.7338 | pg_loss: 0.0654 | reg_loss: 0.2267 | reward: -0.0469 | rev_kl: 0.2634 | stu_lens: 72.5000 | mixed_lens: 72.5000 | lr: 4.4466e-06 | scale: 2048.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1163/  5000| tot_loss: 2.4884 | rl_loss: 0.9555 | pt_loss: 1.5329 | pg_loss: 0.1351 | reg_loss: 0.8203 | reward: -0.1101 | rev_kl: 2.5489 | stu_lens: 71.5000 | mixed_lens: 120.5000 | lr: 4.4456e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1164/  5000| tot_loss: 2.8514 | rl_loss: 1.0934 | pt_loss: 1.7580 | pg_loss: 0.5105 | reg_loss: 0.5830 | reward: -0.4093 | rev_kl: 0.7262 | stu_lens: 126.0000 | mixed_lens: 67.5000 | lr: 4.4445e-06 | scale: 2048.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1165/  5000| tot_loss: 2.8783 | rl_loss: 1.3244 | pt_loss: 1.5539 | pg_loss: 0.4460 | reg_loss: 0.8784 | reward: -0.0777 | rev_kl: 0.7492 | stu_lens: 102.0000 | mixed_lens: 73.0000 | lr: 4.4435e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1166/  5000| tot_loss: 3.2317 | rl_loss: 1.7738 | pt_loss: 1.4579 | pg_loss: 1.0150 | reg_loss: 0.7588 | reward: -1.6211 | rev_kl: 0.3851 | stu_lens: 69.5000 | mixed_lens: 21.5000 | lr: 4.4425e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1167/  5000| tot_loss: 3.1164 | rl_loss: 1.1824 | pt_loss: 1.9340 | pg_loss: 0.1573 | reg_loss: 1.0251 | reward: -0.1791 | rev_kl: 0.8476 | stu_lens: 86.0000 | mixed_lens: 95.0000 | lr: 4.4415e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1168/  5000| tot_loss: 3.2948 | rl_loss: 1.9934 | pt_loss: 1.3015 | pg_loss: 0.3112 | reg_loss: 1.6822 | reward: -0.3186 | rev_kl: 1.5508 | stu_lens: 74.5000 | mixed_lens: 82.5000 | lr: 4.4405e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1168/  5000| tot_loss: 3.2198 | rl_loss: 1.5256 | pt_loss: 1.6943 | pg_loss: 0.3999 | reg_loss: 1.1257 | reward: -0.4518 | rev_kl: 1.0549 | stu_lens: 89.4688 | mixed_lens: 81.1406 | lr: 4.4405e-06 | scale: 2048.00 | time: 26.321 | step time: 27.526
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1169/  5000| tot_loss: 2.9244 | rl_loss: 1.5136 | pt_loss: 1.4109 | pg_loss: 0.3104 | reg_loss: 1.2032 | reward: -0.3881 | rev_kl: 0.8900 | stu_lens: 45.5000 | mixed_lens: 75.5000 | lr: 4.4395e-06 | scale: 2048.00 | time: 26.396 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1170/  5000| tot_loss: 2.3051 | rl_loss: 0.5542 | pt_loss: 1.7509 | pg_loss: 0.1014 | reg_loss: 0.4528 | reward: -0.0762 | rev_kl: 0.8114 | stu_lens: 101.5000 | mixed_lens: 100.5000 | lr: 4.4385e-06 | scale: 2048.00 | time: 26.347 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1171/  5000| tot_loss: 2.6850 | rl_loss: 1.2548 | pt_loss: 1.4301 | pg_loss: 0.4823 | reg_loss: 0.7725 | reward: -0.3559 | rev_kl: 1.1799 | stu_lens: 72.0000 | mixed_lens: 68.0000 | lr: 4.4375e-06 | scale: 2048.00 | time: 26.383 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1172/  5000| tot_loss: 2.0205 | rl_loss: 1.0585 | pt_loss: 0.9620 | pg_loss: 0.3616 | reg_loss: 0.6969 | reward: 0.1302 | rev_kl: 0.8910 | stu_lens: 102.0000 | mixed_lens: 58.5000 | lr: 4.4365e-06 | scale: 2048.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1173/  5000| tot_loss: 3.0644 | rl_loss: 1.4320 | pt_loss: 1.6324 | pg_loss: 0.6926 | reg_loss: 0.7394 | reward: -0.5764 | rev_kl: 0.8929 | stu_lens: 80.0000 | mixed_lens: 57.5000 | lr: 4.4354e-06 | scale: 2048.00 | time: 26.355 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1174/  5000| tot_loss: 3.2283 | rl_loss: 1.4636 | pt_loss: 1.7647 | pg_loss: 0.5087 | reg_loss: 0.9549 | reward: -0.5894 | rev_kl: 1.0352 | stu_lens: 128.0000 | mixed_lens: 82.0000 | lr: 4.4344e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1175/  5000| tot_loss: 2.7532 | rl_loss: 0.9872 | pt_loss: 1.7660 | pg_loss: -0.0152 | reg_loss: 1.0024 | reward: -0.4001 | rev_kl: 1.6026 | stu_lens: 97.5000 | mixed_lens: 128.0000 | lr: 4.4334e-06 | scale: 2048.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1176/  5000| tot_loss: 3.4311 | rl_loss: 1.7738 | pt_loss: 1.6573 | pg_loss: 0.6471 | reg_loss: 1.1266 | reward: -0.5972 | rev_kl: 1.3637 | stu_lens: 104.0000 | mixed_lens: 59.0000 | lr: 4.4324e-06 | scale: 2048.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1177/  5000| tot_loss: 3.3590 | rl_loss: 1.5944 | pt_loss: 1.7647 | pg_loss: 0.4174 | reg_loss: 1.1769 | reward: 0.0268 | rev_kl: 0.4951 | stu_lens: 39.0000 | mixed_lens: 67.0000 | lr: 4.4314e-06 | scale: 2048.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1178/  5000| tot_loss: 2.9888 | rl_loss: 0.9237 | pt_loss: 2.0650 | pg_loss: 0.0760 | reg_loss: 0.8478 | reward: -0.3143 | rev_kl: 1.2845 | stu_lens: 112.0000 | mixed_lens: 128.0000 | lr: 4.4304e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1179/  5000| tot_loss: 2.7612 | rl_loss: 0.9032 | pt_loss: 1.8581 | pg_loss: 0.2049 | reg_loss: 0.6983 | reward: -0.2729 | rev_kl: 1.2642 | stu_lens: 56.5000 | mixed_lens: 93.0000 | lr: 4.4293e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1180/  5000| tot_loss: 2.6482 | rl_loss: 0.8467 | pt_loss: 1.8015 | pg_loss: 0.0348 | reg_loss: 0.8119 | reward: -0.1927 | rev_kl: 1.3205 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4283e-06 | scale: 2048.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1181/  5000| tot_loss: 2.4843 | rl_loss: 0.8271 | pt_loss: 1.6571 | pg_loss: 0.1274 | reg_loss: 0.6998 | reward: -0.3405 | rev_kl: 1.3924 | stu_lens: 110.5000 | mixed_lens: 101.0000 | lr: 4.4273e-06 | scale: 2048.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1182/  5000| tot_loss: 2.5516 | rl_loss: 0.8648 | pt_loss: 1.6868 | pg_loss: 0.2128 | reg_loss: 0.6520 | reward: -0.1882 | rev_kl: 0.9093 | stu_lens: 52.5000 | mixed_lens: 82.5000 | lr: 4.4263e-06 | scale: 2048.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1183/  5000| tot_loss: 2.0277 | rl_loss: 0.8895 | pt_loss: 1.1383 | pg_loss: 0.3457 | reg_loss: 0.5438 | reward: -0.4309 | rev_kl: 2.5622 | stu_lens: 69.5000 | mixed_lens: 86.5000 | lr: 4.4253e-06 | scale: 2048.00 | time: 26.364 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1184/  5000| tot_loss: 2.1654 | rl_loss: 0.2847 | pt_loss: 1.8807 | pg_loss: -0.2854 | reg_loss: 0.5701 | reward: -0.2270 | rev_kl: 0.6359 | stu_lens: 72.5000 | mixed_lens: 43.0000 | lr: 4.4242e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1184/  5000| tot_loss: 2.7349 | rl_loss: 1.0751 | pt_loss: 1.6598 | pg_loss: 0.2839 | reg_loss: 0.7913 | reward: -0.3425 | rev_kl: 1.0983 | stu_lens: 93.8906 | mixed_lens: 85.2031 | lr: 4.4242e-06 | scale: 2048.00 | time: 26.321 | step time: 27.584
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1185/  5000| tot_loss: 3.6310 | rl_loss: 1.7042 | pt_loss: 1.9268 | pg_loss: 1.0905 | reg_loss: 0.6137 | reward: -1.4901 | rev_kl: 0.6516 | stu_lens: 52.0000 | mixed_lens: 31.0000 | lr: 4.4232e-06 | scale: 2048.00 | time: 26.329 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1186/  5000| tot_loss: 2.6714 | rl_loss: 0.9846 | pt_loss: 1.6869 | pg_loss: 0.4604 | reg_loss: 0.5241 | reward: -0.5861 | rev_kl: 1.0743 | stu_lens: 112.0000 | mixed_lens: 83.0000 | lr: 4.4222e-06 | scale: 2048.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1187/  5000| tot_loss: 2.3758 | rl_loss: 0.7542 | pt_loss: 1.6216 | pg_loss: 0.2373 | reg_loss: 0.5169 | reward: -0.3335 | rev_kl: 0.8550 | stu_lens: 128.0000 | mixed_lens: 85.0000 | lr: 4.4212e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1188/  5000| tot_loss: 2.8757 | rl_loss: 1.0399 | pt_loss: 1.8358 | pg_loss: 0.4380 | reg_loss: 0.6020 | reward: -0.3187 | rev_kl: 1.0525 | stu_lens: 101.5000 | mixed_lens: 66.5000 | lr: 4.4201e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1189/  5000| tot_loss: 3.3266 | rl_loss: 1.6421 | pt_loss: 1.6844 | pg_loss: 0.9324 | reg_loss: 0.7097 | reward: -0.1651 | rev_kl: 0.5690 | stu_lens: 7.5000 | mixed_lens: 48.0000 | lr: 4.4191e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1190/  5000| tot_loss: 2.4869 | rl_loss: 0.8041 | pt_loss: 1.6829 | pg_loss: 0.2113 | reg_loss: 0.5928 | reward: -0.1080 | rev_kl: 1.5214 | stu_lens: 126.0000 | mixed_lens: 94.0000 | lr: 4.4181e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1191/  5000| tot_loss: 3.0941 | rl_loss: 1.2748 | pt_loss: 1.8193 | pg_loss: 0.7083 | reg_loss: 0.5665 | reward: -0.7187 | rev_kl: 1.1723 | stu_lens: 75.0000 | mixed_lens: 58.0000 | lr: 4.4171e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1192/  5000| tot_loss: 2.4621 | rl_loss: 0.7424 | pt_loss: 1.7197 | pg_loss: 0.3370 | reg_loss: 0.4054 | reward: -1.4883 | rev_kl: 0.9704 | stu_lens: 69.5000 | mixed_lens: 68.0000 | lr: 4.4160e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1193/  5000| tot_loss: 2.3004 | rl_loss: 0.6948 | pt_loss: 1.6055 | pg_loss: 0.0315 | reg_loss: 0.6633 | reward: -0.1866 | rev_kl: 0.9274 | stu_lens: 100.0000 | mixed_lens: 128.0000 | lr: 4.4150e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1194/  5000| tot_loss: 2.8232 | rl_loss: 1.3450 | pt_loss: 1.4782 | pg_loss: 0.6679 | reg_loss: 0.6772 | reward: -0.3950 | rev_kl: 0.9736 | stu_lens: 96.0000 | mixed_lens: 44.5000 | lr: 4.4140e-06 | scale: 2048.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1195/  5000| tot_loss: 2.4423 | rl_loss: 0.6896 | pt_loss: 1.7528 | pg_loss: 0.1934 | reg_loss: 0.4962 | reward: -0.0683 | rev_kl: 1.4040 | stu_lens: 116.0000 | mixed_lens: 83.5000 | lr: 4.4129e-06 | scale: 2048.00 | time: 26.412 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1196/  5000| tot_loss: 2.2596 | rl_loss: 0.6050 | pt_loss: 1.6546 | pg_loss: 0.1557 | reg_loss: 0.4493 | reward: -0.2455 | rev_kl: 0.8415 | stu_lens: 102.0000 | mixed_lens: 78.5000 | lr: 4.4119e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1197/  5000| tot_loss: 3.1072 | rl_loss: 1.0119 | pt_loss: 2.0953 | pg_loss: 0.0055 | reg_loss: 1.0064 | reward: -0.2784 | rev_kl: 0.6260 | stu_lens: 86.5000 | mixed_lens: 128.0000 | lr: 4.4109e-06 | scale: 2048.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1198/  5000| tot_loss: 2.8695 | rl_loss: 0.5778 | pt_loss: 2.2916 | pg_loss: 0.1491 | reg_loss: 0.4288 | reward: -0.3719 | rev_kl: 1.2218 | stu_lens: 103.0000 | mixed_lens: 104.0000 | lr: 4.4098e-06 | scale: 2048.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1199/  5000| tot_loss: 2.3417 | rl_loss: 0.5631 | pt_loss: 1.7787 | pg_loss: 0.2797 | reg_loss: 0.2833 | reward: -0.1233 | rev_kl: 0.5592 | stu_lens: 42.0000 | mixed_lens: 72.5000 | lr: 4.4088e-06 | scale: 2048.00 | time: 26.320 | step time: 0.000
                                 Evaluation #12                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ The optimal solution is to leave     │
│                                       │ Alice. Bob's chances of survival     │
│                                       │ increase by 9%, which is better than │
│                                       │ 31%.                                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ mz kezboard tzpe z instead of y and  │
│                                       │ vice versa is a feature of some      │
│                                       │ keyboards that allows you to type    │
│                                       │ letters that are not on the          │
│                                       │ keyboard. To use this feature, press │
│                                       │ and release the key that you want to │
│                                       │ type. Then, press and release the    │
│                                       │ key that you want to type. Finally,  │
│                                       │ press and release the key that you   │
│                                       │ want to type.                        │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support over 100 languages.       │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.844 | exact_match: 0.215 | rev_kl: 1.448 | lens: 79.076 | pt_loss: 1.082 | lm_loss: 1.166 | kd_loss: 0.999 
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1200/  5000| tot_loss: 2.6002 | rl_loss: 1.0484 | pt_loss: 1.5518 | pg_loss: 0.3742 | reg_loss: 0.6743 | reward: -0.2584 | rev_kl: 1.2583 | stu_lens: 77.0000 | mixed_lens: 87.5000 | lr: 4.4078e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1200/  5000| tot_loss: 2.6683 | rl_loss: 0.9055 | pt_loss: 1.7628 | pg_loss: 0.3697 | reg_loss: 0.5358 | reward: -0.4430 | rev_kl: 1.0472 | stu_lens: 90.7812 | mixed_lens: 78.6250 | lr: 4.4078e-06 | scale: 2048.00 | time: 26.290 | step time: 27.576
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1201/  5000| tot_loss: 2.1692 | rl_loss: 0.8886 | pt_loss: 1.2806 | pg_loss: 0.0185 | reg_loss: 0.8701 | reward: -0.1135 | rev_kl: 1.4035 | stu_lens: 86.0000 | mixed_lens: 128.0000 | lr: 4.4067e-06 | scale: 2048.00 | time: 26.379 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1202/  5000| tot_loss: 2.7751 | rl_loss: 1.0933 | pt_loss: 1.6819 | pg_loss: 0.7276 | reg_loss: 0.3656 | reward: -0.4962 | rev_kl: 0.9335 | stu_lens: 110.5000 | mixed_lens: 48.0000 | lr: 4.4057e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1203/  5000| tot_loss: 3.5592 | rl_loss: 1.5739 | pt_loss: 1.9853 | pg_loss: 0.5508 | reg_loss: 1.0231 | reward: -0.0304 | rev_kl: 0.7803 | stu_lens: 72.5000 | mixed_lens: 72.5000 | lr: 4.4047e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1204/  5000| tot_loss: 2.8238 | rl_loss: 0.9180 | pt_loss: 1.9058 | pg_loss: 0.4668 | reg_loss: 0.4512 | reward: -0.3559 | rev_kl: 1.1799 | stu_lens: 72.0000 | mixed_lens: 68.0000 | lr: 4.4036e-06 | scale: 2048.00 | time: 26.174 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1205/  5000| tot_loss: 3.1794 | rl_loss: 1.1430 | pt_loss: 2.0364 | pg_loss: 0.6621 | reg_loss: 0.4809 | reward: -0.1775 | rev_kl: 0.8430 | stu_lens: 104.0000 | mixed_lens: 49.0000 | lr: 4.4026e-06 | scale: 2048.00 | time: 26.192 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1206/  5000| tot_loss: 2.4504 | rl_loss: 0.6444 | pt_loss: 1.8060 | pg_loss: 0.1686 | reg_loss: 0.4758 | reward: -0.5065 | rev_kl: 1.3561 | stu_lens: 87.0000 | mixed_lens: 104.0000 | lr: 4.4015e-06 | scale: 2048.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1207/  5000| tot_loss: 1.6482 | rl_loss: 0.6990 | pt_loss: 0.9491 | pg_loss: 0.1941 | reg_loss: 0.5049 | reward: -0.3946 | rev_kl: 1.1255 | stu_lens: 128.0000 | mixed_lens: 94.0000 | lr: 4.4005e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1208/  5000| tot_loss: 1.9142 | rl_loss: 0.3829 | pt_loss: 1.5312 | pg_loss: 0.1893 | reg_loss: 0.1937 | reward: -0.5544 | rev_kl: 1.0479 | stu_lens: 97.5000 | mixed_lens: 83.0000 | lr: 4.3995e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1209/  5000| tot_loss: 1.2898 | rl_loss: 0.0257 | pt_loss: 1.2641 | pg_loss: -0.3751 | reg_loss: 0.4007 | reward: -0.1514 | rev_kl: 0.6417 | stu_lens: 67.0000 | mixed_lens: 37.5000 | lr: 4.3984e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1210/  5000| tot_loss: 2.4817 | rl_loss: 0.6488 | pt_loss: 1.8329 | pg_loss: 0.1975 | reg_loss: 0.4513 | reward: -0.5049 | rev_kl: 0.6862 | stu_lens: 63.5000 | mixed_lens: 86.0000 | lr: 4.3974e-06 | scale: 2048.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1211/  5000| tot_loss: 2.0952 | rl_loss: 0.4027 | pt_loss: 1.6925 | pg_loss: 0.2736 | reg_loss: 0.1290 | reward: -0.3417 | rev_kl: 0.4718 | stu_lens: 128.0000 | mixed_lens: 63.5000 | lr: 4.3963e-06 | scale: 2048.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1212/  5000| tot_loss: 3.2632 | rl_loss: 1.4139 | pt_loss: 1.8492 | pg_loss: 0.7157 | reg_loss: 0.6983 | reward: -0.7644 | rev_kl: 1.1779 | stu_lens: 73.5000 | mixed_lens: 30.0000 | lr: 4.3953e-06 | scale: 2048.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1213/  5000| tot_loss: 2.3330 | rl_loss: 0.7904 | pt_loss: 1.5425 | pg_loss: 0.2022 | reg_loss: 0.5882 | reward: -0.1631 | rev_kl: 1.4236 | stu_lens: 84.5000 | mixed_lens: 82.0000 | lr: 4.3942e-06 | scale: 2048.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1214/  5000| tot_loss: 2.6270 | rl_loss: 0.9771 | pt_loss: 1.6499 | pg_loss: 0.2818 | reg_loss: 0.6954 | reward: -0.5328 | rev_kl: 1.0489 | stu_lens: 109.5000 | mixed_lens: 97.5000 | lr: 4.3932e-06 | scale: 2048.00 | time: 26.202 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1215/  5000| tot_loss: 2.0320 | rl_loss: 0.5153 | pt_loss: 1.5167 | pg_loss: 0.2287 | reg_loss: 0.2866 | reward: -0.3168 | rev_kl: 0.8342 | stu_lens: 86.5000 | mixed_lens: 76.0000 | lr: 4.3921e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1216/  5000| tot_loss: 2.1441 | rl_loss: 0.4053 | pt_loss: 1.7388 | pg_loss: 0.0139 | reg_loss: 0.3913 | reward: -0.1104 | rev_kl: 1.1507 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3911e-06 | scale: 2048.00 | time: 26.206 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1216/  5000| tot_loss: 2.4728 | rl_loss: 0.7644 | pt_loss: 1.7084 | pg_loss: 0.2865 | reg_loss: 0.4779 | reward: -0.4016 | rev_kl: 1.0719 | stu_lens: 91.7500 | mixed_lens: 81.8281 | lr: 4.3911e-06 | scale: 2048.00 | time: 26.206 | step time: 27.512
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1217/  5000| tot_loss: 2.9728 | rl_loss: 0.6773 | pt_loss: 2.2954 | pg_loss: 0.2450 | reg_loss: 0.4324 | reward: -0.2167 | rev_kl: 0.8434 | stu_lens: 80.0000 | mixed_lens: 100.0000 | lr: 4.3900e-06 | scale: 2048.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1218/  5000| tot_loss: 2.6997 | rl_loss: 1.3679 | pt_loss: 1.3318 | pg_loss: 0.3380 | reg_loss: 1.0299 | reward: -0.2982 | rev_kl: 0.9656 | stu_lens: 102.0000 | mixed_lens: 85.0000 | lr: 4.3890e-06 | scale: 2048.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1219/  5000| tot_loss: 3.7344 | rl_loss: 2.1132 | pt_loss: 1.6212 | pg_loss: 0.9423 | reg_loss: 1.1709 | reward: -0.5250 | rev_kl: 0.8031 | stu_lens: 69.5000 | mixed_lens: 37.5000 | lr: 4.3879e-06 | scale: 2048.00 | time: 26.195 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1220/  5000| tot_loss: 3.0079 | rl_loss: 1.6769 | pt_loss: 1.3310 | pg_loss: 0.2799 | reg_loss: 1.3971 | reward: -0.2554 | rev_kl: 2.4737 | stu_lens: 70.0000 | mixed_lens: 91.5000 | lr: 4.3869e-06 | scale: 2048.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1221/  5000| tot_loss: 3.1980 | rl_loss: 1.8413 | pt_loss: 1.3567 | pg_loss: 0.3892 | reg_loss: 1.4521 | reward: -0.4216 | rev_kl: 0.8652 | stu_lens: 86.0000 | mixed_lens: 66.5000 | lr: 4.3858e-06 | scale: 2048.00 | time: 26.172 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1222/  5000| tot_loss: 3.7795 | rl_loss: 1.9499 | pt_loss: 1.8296 | pg_loss: 0.7432 | reg_loss: 1.2067 | reward: -1.0237 | rev_kl: 0.8360 | stu_lens: 72.0000 | mixed_lens: 68.0000 | lr: 4.3848e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1223/  5000| tot_loss: 3.3749 | rl_loss: 1.7463 | pt_loss: 1.6285 | pg_loss: 0.4213 | reg_loss: 1.3251 | reward: -0.9835 | rev_kl: 1.3161 | stu_lens: 35.0000 | mixed_lens: 70.5000 | lr: 4.3837e-06 | scale: 2048.00 | time: 26.206 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1224/  5000| tot_loss: 3.1645 | rl_loss: 1.3783 | pt_loss: 1.7862 | pg_loss: 0.0398 | reg_loss: 1.3385 | reward: -0.0858 | rev_kl: 1.3514 | stu_lens: 87.5000 | mixed_lens: 128.0000 | lr: 4.3827e-06 | scale: 2048.00 | time: 26.192 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1225/  5000| tot_loss: 3.1266 | rl_loss: 1.3928 | pt_loss: 1.7337 | pg_loss: 0.4193 | reg_loss: 0.9735 | reward: -0.7964 | rev_kl: 1.1083 | stu_lens: 70.0000 | mixed_lens: 73.5000 | lr: 4.3816e-06 | scale: 2048.00 | time: 26.191 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1226/  5000| tot_loss: 3.0045 | rl_loss: 1.2267 | pt_loss: 1.7778 | pg_loss: 0.0704 | reg_loss: 1.1563 | reward: -0.0856 | rev_kl: 0.6900 | stu_lens: 78.5000 | mixed_lens: 123.0000 | lr: 4.3806e-06 | scale: 2048.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1227/  5000| tot_loss: 2.8833 | rl_loss: 1.4349 | pt_loss: 1.4485 | pg_loss: 0.1038 | reg_loss: 1.3311 | reward: -0.2960 | rev_kl: 1.3301 | stu_lens: 128.0000 | mixed_lens: 121.0000 | lr: 4.3795e-06 | scale: 2048.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1228/  5000| tot_loss: 2.8740 | rl_loss: 1.3830 | pt_loss: 1.4910 | pg_loss: 0.2974 | reg_loss: 1.0856 | reward: -0.1701 | rev_kl: 0.7032 | stu_lens: 104.5000 | mixed_lens: 92.0000 | lr: 4.3785e-06 | scale: 2048.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1229/  5000| tot_loss: 3.7852 | rl_loss: 2.2182 | pt_loss: 1.5670 | pg_loss: 0.8856 | reg_loss: 1.3326 | reward: -0.5192 | rev_kl: 0.9374 | stu_lens: 37.0000 | mixed_lens: 54.5000 | lr: 4.3774e-06 | scale: 2048.00 | time: 26.191 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1230/  5000| tot_loss: 3.5577 | rl_loss: 1.5176 | pt_loss: 2.0401 | pg_loss: 0.2630 | reg_loss: 1.2546 | reward: -0.5686 | rev_kl: 1.0294 | stu_lens: 100.0000 | mixed_lens: 92.0000 | lr: 4.3763e-06 | scale: 2048.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1231/  5000| tot_loss: 3.5799 | rl_loss: 1.5280 | pt_loss: 2.0519 | pg_loss: 0.3559 | reg_loss: 1.1721 | reward: -0.7704 | rev_kl: 1.2443 | stu_lens: 73.0000 | mixed_lens: 78.5000 | lr: 4.3753e-06 | scale: 2048.00 | time: 26.177 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1232/  5000| tot_loss: 2.4304 | rl_loss: 0.8709 | pt_loss: 1.5594 | pg_loss: 0.2414 | reg_loss: 0.6295 | reward: -0.2231 | rev_kl: 1.3804 | stu_lens: 96.5000 | mixed_lens: 58.5000 | lr: 4.3742e-06 | scale: 2048.00 | time: 26.203 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1232/  5000| tot_loss: 3.2641 | rl_loss: 1.5306 | pt_loss: 1.7335 | pg_loss: 0.3690 | reg_loss: 1.1616 | reward: -0.6484 | rev_kl: 1.2117 | stu_lens: 83.5000 | mixed_lens: 84.0156 | lr: 4.3742e-06 | scale: 2048.00 | time: 26.203 | step time: 27.475
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1233/  5000| tot_loss: 3.0157 | rl_loss: 1.3862 | pt_loss: 1.6295 | pg_loss: 0.5153 | reg_loss: 0.8709 | reward: -0.5225 | rev_kl: 0.6877 | stu_lens: 52.5000 | mixed_lens: 54.0000 | lr: 4.3732e-06 | scale: 2048.00 | time: 26.207 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1234/  5000| tot_loss: 3.8265 | rl_loss: 1.8734 | pt_loss: 1.9531 | pg_loss: 1.0757 | reg_loss: 0.7976 | reward: -1.0351 | rev_kl: 1.4949 | stu_lens: 82.5000 | mixed_lens: 33.5000 | lr: 4.3721e-06 | scale: 2048.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1235/  5000| tot_loss: 2.7912 | rl_loss: 1.0182 | pt_loss: 1.7730 | pg_loss: 0.2207 | reg_loss: 0.7975 | reward: -0.6189 | rev_kl: 2.0726 | stu_lens: 56.0000 | mixed_lens: 82.5000 | lr: 4.3710e-06 | scale: 2048.00 | time: 26.192 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1236/  5000| tot_loss: 1.7629 | rl_loss: 0.4865 | pt_loss: 1.2764 | pg_loss: 0.0747 | reg_loss: 0.4118 | reward: -0.4022 | rev_kl: 0.4815 | stu_lens: 126.5000 | mixed_lens: 114.0000 | lr: 4.3700e-06 | scale: 2048.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1237/  5000| tot_loss: 2.0944 | rl_loss: 1.0514 | pt_loss: 1.0430 | pg_loss: 0.2680 | reg_loss: 0.7834 | reward: -0.5668 | rev_kl: 1.0956 | stu_lens: 128.0000 | mixed_lens: 89.0000 | lr: 4.3689e-06 | scale: 2048.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1238/  5000| tot_loss: 2.8628 | rl_loss: 1.0983 | pt_loss: 1.7644 | pg_loss: 0.4311 | reg_loss: 0.6672 | reward: -8.1631 | rev_kl: 3.7932 | stu_lens: 25.5000 | mixed_lens: 46.5000 | lr: 4.3678e-06 | scale: 2048.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1239/  5000| tot_loss: 2.6490 | rl_loss: 1.4938 | pt_loss: 1.1552 | pg_loss: 0.4139 | reg_loss: 1.0799 | reward: -0.6023 | rev_kl: 1.8257 | stu_lens: 91.5000 | mixed_lens: 89.0000 | lr: 4.3668e-06 | scale: 2048.00 | time: 26.193 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1240/  5000| tot_loss: 2.6655 | rl_loss: 0.7011 | pt_loss: 1.9643 | pg_loss: 0.1788 | reg_loss: 0.5223 | reward: -0.7963 | rev_kl: 0.8554 | stu_lens: 96.0000 | mixed_lens: 62.5000 | lr: 4.3657e-06 | scale: 2048.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1241/  5000| tot_loss: 2.3503 | rl_loss: 0.7988 | pt_loss: 1.5515 | pg_loss: 0.2578 | reg_loss: 0.5410 | reward: 1.0237 | rev_kl: 1.1156 | stu_lens: 66.0000 | mixed_lens: 63.0000 | lr: 4.3646e-06 | scale: 2048.00 | time: 26.171 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1242/  5000| tot_loss: 3.1537 | rl_loss: 1.2666 | pt_loss: 1.8871 | pg_loss: 0.7399 | reg_loss: 0.5267 | reward: -0.0900 | rev_kl: 0.3599 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 4.3636e-06 | scale: 2048.00 | time: 26.197 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1243/  5000| tot_loss: 2.7980 | rl_loss: 1.2090 | pt_loss: 1.5890 | pg_loss: 0.2458 | reg_loss: 0.9632 | reward: -0.8616 | rev_kl: 1.9958 | stu_lens: 116.5000 | mixed_lens: 84.0000 | lr: 4.3625e-06 | scale: 2048.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1244/  5000| tot_loss: 2.4188 | rl_loss: 0.6270 | pt_loss: 1.7919 | pg_loss: 0.0012 | reg_loss: 0.6258 | reward: -0.1617 | rev_kl: 0.7235 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3614e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1245/  5000| tot_loss: 2.0467 | rl_loss: 0.7471 | pt_loss: 1.2996 | pg_loss: 0.1543 | reg_loss: 0.5928 | reward: -0.3336 | rev_kl: 1.0079 | stu_lens: 63.0000 | mixed_lens: 85.0000 | lr: 4.3604e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1246/  5000| tot_loss: 2.2035 | rl_loss: 0.6858 | pt_loss: 1.5176 | pg_loss: 0.1894 | reg_loss: 0.4965 | reward: -0.3699 | rev_kl: 0.3116 | stu_lens: 93.5000 | mixed_lens: 77.0000 | lr: 4.3593e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1247/  5000| tot_loss: 2.9740 | rl_loss: 1.6362 | pt_loss: 1.3379 | pg_loss: 0.8974 | reg_loss: 0.7387 | reward: -0.4434 | rev_kl: 1.3256 | stu_lens: 100.5000 | mixed_lens: 37.5000 | lr: 4.3582e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1248/  5000| tot_loss: 2.5863 | rl_loss: 0.9991 | pt_loss: 1.5872 | pg_loss: 0.0257 | reg_loss: 0.9734 | reward: -0.0593 | rev_kl: 1.1074 | stu_lens: 112.0000 | mixed_lens: 123.0000 | lr: 4.3571e-06 | scale: 2048.00 | time: 26.334 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1248/  5000| tot_loss: 2.7412 | rl_loss: 1.1210 | pt_loss: 1.6202 | pg_loss: 0.3488 | reg_loss: 0.7722 | reward: -0.6845 | rev_kl: 1.2228 | stu_lens: 83.3594 | mixed_lens: 79.9375 | lr: 4.3571e-06 | scale: 2048.00 | time: 26.334 | step time: 27.496
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1249/  5000| tot_loss: 2.5931 | rl_loss: 0.9581 | pt_loss: 1.6350 | pg_loss: 0.3168 | reg_loss: 0.6413 | reward: -0.3754 | rev_kl: 0.4348 | stu_lens: 26.0000 | mixed_lens: 82.0000 | lr: 4.3561e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/1250
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1250/  5000| tot_loss: 2.5351 | rl_loss: 0.8896 | pt_loss: 1.6455 | pg_loss: 0.4025 | reg_loss: 0.4871 | reward: -0.4068 | rev_kl: 0.5002 | stu_lens: 58.0000 | mixed_lens: 80.0000 | lr: 4.3550e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1251/  5000| tot_loss: 2.6385 | rl_loss: 0.8617 | pt_loss: 1.7768 | pg_loss: 0.3199 | reg_loss: 0.5417 | reward: -0.3730 | rev_kl: 0.8064 | stu_lens: 67.0000 | mixed_lens: 65.5000 | lr: 4.3539e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1252/  5000| tot_loss: 2.6251 | rl_loss: 0.8070 | pt_loss: 1.8181 | pg_loss: 0.3378 | reg_loss: 0.4692 | reward: -0.7782 | rev_kl: 1.1329 | stu_lens: 116.5000 | mixed_lens: 84.0000 | lr: 4.3528e-06 | scale: 2048.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1253/  5000| tot_loss: 2.6214 | rl_loss: 0.8677 | pt_loss: 1.7536 | pg_loss: 0.2112 | reg_loss: 0.6565 | reward: -0.5269 | rev_kl: 1.8431 | stu_lens: 80.0000 | mixed_lens: 89.0000 | lr: 4.3518e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1254/  5000| tot_loss: 2.2441 | rl_loss: 0.3685 | pt_loss: 1.8756 | pg_loss: 0.0032 | reg_loss: 0.3653 | reward: -0.1386 | rev_kl: 0.5819 | stu_lens: 94.5000 | mixed_lens: 128.0000 | lr: 4.3507e-06 | scale: 2048.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1255/  5000| tot_loss: 2.9637 | rl_loss: 0.9242 | pt_loss: 2.0395 | pg_loss: 0.2171 | reg_loss: 0.7071 | reward: -0.3073 | rev_kl: 1.4254 | stu_lens: 96.5000 | mixed_lens: 85.0000 | lr: 4.3496e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1256/  5000| tot_loss: 2.6333 | rl_loss: 0.6237 | pt_loss: 2.0097 | pg_loss: 0.1598 | reg_loss: 0.4638 | reward: -0.6693 | rev_kl: 0.7920 | stu_lens: 100.0000 | mixed_lens: 92.0000 | lr: 4.3485e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1257/  5000| tot_loss: 3.3548 | rl_loss: 1.5647 | pt_loss: 1.7900 | pg_loss: 1.3577 | reg_loss: 0.2071 | reward: -1.2076 | rev_kl: 0.6721 | stu_lens: 27.5000 | mixed_lens: 18.5000 | lr: 4.3475e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1258/  5000| tot_loss: 2.6291 | rl_loss: 0.7734 | pt_loss: 1.8557 | pg_loss: 0.3027 | reg_loss: 0.4707 | reward: -0.1306 | rev_kl: 1.1065 | stu_lens: 64.0000 | mixed_lens: 92.0000 | lr: 4.3464e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1259/  5000| tot_loss: 2.4976 | rl_loss: 0.6411 | pt_loss: 1.8564 | pg_loss: 0.3568 | reg_loss: 0.2844 | reward: -0.3759 | rev_kl: 1.1289 | stu_lens: 128.0000 | mixed_lens: 64.5000 | lr: 4.3453e-06 | scale: 2048.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1260/  5000| tot_loss: 3.3191 | rl_loss: 1.8629 | pt_loss: 1.4562 | pg_loss: 1.3963 | reg_loss: 0.4666 | reward: -8.8117 | rev_kl: 4.3937 | stu_lens: 55.0000 | mixed_lens: 10.5000 | lr: 4.3442e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1261/  5000| tot_loss: 2.8898 | rl_loss: 1.2574 | pt_loss: 1.6324 | pg_loss: 0.6895 | reg_loss: 0.5679 | reward: -0.5118 | rev_kl: 1.2903 | stu_lens: 51.0000 | mixed_lens: 45.0000 | lr: 4.3431e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1262/  5000| tot_loss: 1.8878 | rl_loss: 0.3262 | pt_loss: 1.5616 | pg_loss: 0.0147 | reg_loss: 0.3115 | reward: -0.1417 | rev_kl: 0.5011 | stu_lens: 128.0000 | mixed_lens: 114.5000 | lr: 4.3420e-06 | scale: 2048.00 | time: 26.354 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1263/  5000| tot_loss: 2.2906 | rl_loss: 0.5720 | pt_loss: 1.7186 | pg_loss: 0.0225 | reg_loss: 0.5495 | reward: -0.1846 | rev_kl: 0.7806 | stu_lens: 80.0000 | mixed_lens: 128.0000 | lr: 4.3410e-06 | scale: 2048.00 | time: 26.341 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1264/  5000| tot_loss: 2.6546 | rl_loss: 1.0705 | pt_loss: 1.5840 | pg_loss: 0.2333 | reg_loss: 0.8372 | reward: -0.6763 | rev_kl: 1.3974 | stu_lens: 99.5000 | mixed_lens: 88.5000 | lr: 4.3399e-06 | scale: 2048.00 | time: 26.360 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1264/  5000| tot_loss: 2.6000 | rl_loss: 0.9134 | pt_loss: 1.6865 | pg_loss: 0.3742 | reg_loss: 0.5392 | reward: -0.6626 | rev_kl: 1.1827 | stu_lens: 79.9688 | mixed_lens: 81.8281 | lr: 4.3399e-06 | scale: 2048.00 | time: 26.360 | step time: 27.567
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1265/  5000| tot_loss: 2.7143 | rl_loss: 0.6049 | pt_loss: 2.1094 | pg_loss: 0.0741 | reg_loss: 0.5309 | reward: -0.3062 | rev_kl: 1.0891 | stu_lens: 128.0000 | mixed_lens: 113.5000 | lr: 4.3388e-06 | scale: 2048.00 | time: 26.320 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1266/  5000| tot_loss: 2.4882 | rl_loss: 0.4984 | pt_loss: 1.9898 | pg_loss: 0.1494 | reg_loss: 0.3490 | reward: -0.4137 | rev_kl: 0.9746 | stu_lens: 87.0000 | mixed_lens: 105.0000 | lr: 4.3377e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1267/  5000| tot_loss: 3.6460 | rl_loss: 2.0930 | pt_loss: 1.5530 | pg_loss: 1.6689 | reg_loss: 0.4241 | reward: -1.6415 | rev_kl: 0.9442 | stu_lens: 60.5000 | mixed_lens: 26.0000 | lr: 4.3366e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1268/  5000| tot_loss: 1.8203 | rl_loss: 0.3600 | pt_loss: 1.4603 | pg_loss: 0.0277 | reg_loss: 0.3323 | reward: -0.1392 | rev_kl: 0.8675 | stu_lens: 112.0000 | mixed_lens: 126.0000 | lr: 4.3355e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1269/  5000| tot_loss: 2.7934 | rl_loss: 0.9927 | pt_loss: 1.8007 | pg_loss: 0.3857 | reg_loss: 0.6070 | reward: -0.4298 | rev_kl: 1.2365 | stu_lens: 86.5000 | mixed_lens: 88.0000 | lr: 4.3344e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1270/  5000| tot_loss: 2.5827 | rl_loss: 1.0577 | pt_loss: 1.5250 | pg_loss: 0.5201 | reg_loss: 0.5376 | reward: -1.3886 | rev_kl: 1.6422 | stu_lens: 68.5000 | mixed_lens: 51.5000 | lr: 4.3334e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1271/  5000| tot_loss: 3.2977 | rl_loss: 1.5766 | pt_loss: 1.7211 | pg_loss: 1.2397 | reg_loss: 0.3369 | reward: -0.9460 | rev_kl: 1.4765 | stu_lens: 113.5000 | mixed_lens: 29.0000 | lr: 4.3323e-06 | scale: 2048.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1272/  5000| tot_loss: 2.0775 | rl_loss: 0.8088 | pt_loss: 1.2687 | pg_loss: 0.2698 | reg_loss: 0.5390 | reward: -0.8019 | rev_kl: 0.8592 | stu_lens: 98.5000 | mixed_lens: 78.0000 | lr: 4.3312e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1273/  5000| tot_loss: 2.3517 | rl_loss: 0.3406 | pt_loss: 2.0111 | pg_loss: 0.0033 | reg_loss: 0.3373 | reward: -0.2152 | rev_kl: 0.7191 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3301e-06 | scale: 2048.00 | time: 26.420 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1274/  5000| tot_loss: 2.3361 | rl_loss: 0.8730 | pt_loss: 1.4631 | pg_loss: 0.2433 | reg_loss: 0.6298 | reward: -0.4005 | rev_kl: 1.7761 | stu_lens: 74.0000 | mixed_lens: 108.0000 | lr: 4.3290e-06 | scale: 2048.00 | time: 26.375 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1275/  5000| tot_loss: 3.1066 | rl_loss: 1.3809 | pt_loss: 1.7257 | pg_loss: 0.6942 | reg_loss: 0.6867 | reward: -0.7024 | rev_kl: 1.4800 | stu_lens: 37.5000 | mixed_lens: 51.0000 | lr: 4.3279e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1276/  5000| tot_loss: 2.5843 | rl_loss: 0.6927 | pt_loss: 1.8916 | pg_loss: 0.2207 | reg_loss: 0.4721 | reward: -0.3474 | rev_kl: 0.9903 | stu_lens: 102.0000 | mixed_lens: 98.5000 | lr: 4.3268e-06 | scale: 2048.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1277/  5000| tot_loss: 1.6113 | rl_loss: 0.4680 | pt_loss: 1.1433 | pg_loss: 0.0575 | reg_loss: 0.4105 | reward: -0.1728 | rev_kl: 0.9392 | stu_lens: 109.5000 | mixed_lens: 112.0000 | lr: 4.3257e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1278/  5000| tot_loss: 2.3671 | rl_loss: 0.4531 | pt_loss: 1.9140 | pg_loss: 0.1324 | reg_loss: 0.3207 | reward: -0.1829 | rev_kl: 1.9509 | stu_lens: 62.5000 | mixed_lens: 104.5000 | lr: 4.3246e-06 | scale: 2048.00 | time: 26.357 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1279/  5000| tot_loss: 2.5772 | rl_loss: 0.5584 | pt_loss: 2.0188 | pg_loss: 0.1165 | reg_loss: 0.4420 | reward: -0.4829 | rev_kl: 0.7864 | stu_lens: 127.0000 | mixed_lens: 97.0000 | lr: 4.3235e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1280/  5000| tot_loss: 2.7741 | rl_loss: 0.7433 | pt_loss: 2.0308 | pg_loss: 0.3602 | reg_loss: 0.3830 | reward: -0.4874 | rev_kl: 1.3419 | stu_lens: 52.0000 | mixed_lens: 70.5000 | lr: 4.3224e-06 | scale: 2048.00 | time: 26.323 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1280/  5000| tot_loss: 2.6213 | rl_loss: 0.7992 | pt_loss: 1.8221 | pg_loss: 0.3444 | reg_loss: 0.4548 | reward: -0.6635 | rev_kl: 1.2375 | stu_lens: 85.4844 | mixed_lens: 83.8125 | lr: 4.3224e-06 | scale: 2048.00 | time: 26.323 | step time: 27.574
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1281/  5000| tot_loss: 2.3744 | rl_loss: 1.1285 | pt_loss: 1.2459 | pg_loss: 0.6558 | reg_loss: 0.4727 | reward: -0.6000 | rev_kl: 1.5113 | stu_lens: 61.0000 | mixed_lens: 45.0000 | lr: 4.3213e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1282/  5000| tot_loss: 3.5700 | rl_loss: 1.5153 | pt_loss: 2.0547 | pg_loss: 0.0548 | reg_loss: 1.4605 | reward: -0.2808 | rev_kl: 1.1382 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3202e-06 | scale: 2048.00 | time: 26.390 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1283/  5000| tot_loss: 2.8475 | rl_loss: 1.4492 | pt_loss: 1.3983 | pg_loss: 0.0456 | reg_loss: 1.4036 | reward: -0.1658 | rev_kl: 1.1535 | stu_lens: 88.5000 | mixed_lens: 128.0000 | lr: 4.3191e-06 | scale: 2048.00 | time: 26.320 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1284/  5000| tot_loss: 3.8292 | rl_loss: 1.8282 | pt_loss: 2.0010 | pg_loss: 0.5405 | reg_loss: 1.2877 | reward: -0.5950 | rev_kl: 0.9962 | stu_lens: 49.0000 | mixed_lens: 38.0000 | lr: 4.3180e-06 | scale: 2048.00 | time: 26.343 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1285/  5000| tot_loss: 3.5725 | rl_loss: 1.5198 | pt_loss: 2.0527 | pg_loss: 0.2812 | reg_loss: 1.2386 | reward: -0.4621 | rev_kl: 1.4032 | stu_lens: 128.0000 | mixed_lens: 88.0000 | lr: 4.3169e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1286/  5000| tot_loss: 3.1110 | rl_loss: 1.2115 | pt_loss: 1.8995 | pg_loss: 0.1894 | reg_loss: 1.0221 | reward: -0.3553 | rev_kl: 0.8814 | stu_lens: 128.0000 | mixed_lens: 108.0000 | lr: 4.3158e-06 | scale: 2048.00 | time: 26.343 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1287/  5000| tot_loss: 2.7832 | rl_loss: 1.2270 | pt_loss: 1.5561 | pg_loss: 0.1680 | reg_loss: 1.0590 | reward: -0.5278 | rev_kl: 1.3609 | stu_lens: 122.5000 | mixed_lens: 106.0000 | lr: 4.3147e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1288/  5000| tot_loss: 2.9328 | rl_loss: 1.1362 | pt_loss: 1.7966 | pg_loss: 0.0419 | reg_loss: 1.0942 | reward: -0.2116 | rev_kl: 1.8432 | stu_lens: 128.0000 | mixed_lens: 125.5000 | lr: 4.3136e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1289/  5000| tot_loss: 3.1134 | rl_loss: 1.6014 | pt_loss: 1.5119 | pg_loss: 0.2138 | reg_loss: 1.3876 | reward: -0.3461 | rev_kl: 1.0414 | stu_lens: 90.0000 | mixed_lens: 95.5000 | lr: 4.3125e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1290/  5000| tot_loss: 2.9217 | rl_loss: 1.3538 | pt_loss: 1.5679 | pg_loss: 0.2608 | reg_loss: 1.0930 | reward: -0.5592 | rev_kl: 1.0854 | stu_lens: 69.5000 | mixed_lens: 77.5000 | lr: 4.3114e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1291/  5000| tot_loss: 2.5772 | rl_loss: 1.2545 | pt_loss: 1.3227 | pg_loss: 0.0454 | reg_loss: 1.2090 | reward: -0.1896 | rev_kl: 1.3774 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3103e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1292/  5000| tot_loss: 3.8995 | rl_loss: 1.7944 | pt_loss: 2.1051 | pg_loss: 0.2259 | reg_loss: 1.5685 | reward: -0.3463 | rev_kl: 1.0748 | stu_lens: 51.5000 | mixed_lens: 111.0000 | lr: 4.3092e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1293/  5000| tot_loss: 2.8284 | rl_loss: 0.9611 | pt_loss: 1.8673 | pg_loss: 0.0747 | reg_loss: 0.8864 | reward: -0.1662 | rev_kl: 0.8892 | stu_lens: 79.5000 | mixed_lens: 124.5000 | lr: 4.3081e-06 | scale: 2048.00 | time: 26.314 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1294/  5000| tot_loss: 3.4321 | rl_loss: 2.1533 | pt_loss: 1.2787 | pg_loss: 0.4269 | reg_loss: 1.7264 | reward: -0.3712 | rev_kl: 1.9026 | stu_lens: 64.5000 | mixed_lens: 83.5000 | lr: 4.3070e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1295/  5000| tot_loss: 3.9140 | rl_loss: 2.7129 | pt_loss: 1.2011 | pg_loss: 0.8239 | reg_loss: 1.8891 | reward: -1.1302 | rev_kl: 0.9783 | stu_lens: 45.5000 | mixed_lens: 64.5000 | lr: 4.3059e-06 | scale: 2048.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1296/  5000| tot_loss: 3.1678 | rl_loss: 1.7304 | pt_loss: 1.4373 | pg_loss: 0.2911 | reg_loss: 1.4393 | reward: -0.4145 | rev_kl: 1.5166 | stu_lens: 104.5000 | mixed_lens: 104.5000 | lr: 4.3048e-06 | scale: 2048.00 | time: 26.322 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1296/  5000| tot_loss: 3.2062 | rl_loss: 1.5473 | pt_loss: 1.6589 | pg_loss: 0.3210 | reg_loss: 1.2262 | reward: -0.4378 | rev_kl: 1.2360 | stu_lens: 87.5781 | mixed_lens: 94.6094 | lr: 4.3048e-06 | scale: 2048.00 | time: 26.322 | step time: 27.575
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1297/  5000| tot_loss: 3.8290 | rl_loss: 1.7033 | pt_loss: 2.1257 | pg_loss: 0.4558 | reg_loss: 1.2475 | reward: -0.9991 | rev_kl: 0.7355 | stu_lens: 75.0000 | mixed_lens: 71.0000 | lr: 4.3037e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1298/  5000| tot_loss: 2.7960 | rl_loss: 1.0747 | pt_loss: 1.7212 | pg_loss: 0.2630 | reg_loss: 0.8117 | reward: -0.4590 | rev_kl: 1.5333 | stu_lens: 67.0000 | mixed_lens: 89.0000 | lr: 4.3026e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1299/  5000| tot_loss: 2.6708 | rl_loss: 0.9501 | pt_loss: 1.7207 | pg_loss: 0.2271 | reg_loss: 0.7230 | reward: -0.4726 | rev_kl: 0.6314 | stu_lens: 72.0000 | mixed_lens: 71.5000 | lr: 4.3014e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
                                 Evaluation #13                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Bob should leave Alice. There is a   │
│                                       │ 31% chance that they will both       │
│                                       │ survive if Bob carries Alice to      │
│                                       │ safety. But if Bob leaves Alice, his │
│                                       │ chances improve by 9%. So, overall,  │
│                                       │ Bob has a 39.8% chance of survival.  │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ i dont know i am just trying to      │
│                                       │ learn                                │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support over 100 languages.       │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.265 | exact_match: 0.215 | rev_kl: 1.310 | lens: 83.660 | pt_loss: 1.082 | lm_loss: 1.165 | kd_loss: 0.999 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1300/  5000| tot_loss: 2.5483 | rl_loss: 0.8755 | pt_loss: 1.6729 | pg_loss: 0.0266 | reg_loss: 0.8489 | reward: -0.1887 | rev_kl: 1.3490 | stu_lens: 128.0000 | mixed_lens: 122.0000 | lr: 4.3003e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1301/  5000| tot_loss: 2.7578 | rl_loss: 1.0830 | pt_loss: 1.6748 | pg_loss: 0.2219 | reg_loss: 0.8611 | reward: -0.4881 | rev_kl: 0.8526 | stu_lens: 78.5000 | mixed_lens: 92.5000 | lr: 4.2992e-06 | scale: 2048.00 | time: 26.347 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1302/  5000| tot_loss: 3.0682 | rl_loss: 1.1313 | pt_loss: 1.9369 | pg_loss: 0.0260 | reg_loss: 1.1053 | reward: -0.4734 | rev_kl: 1.4688 | stu_lens: 90.5000 | mixed_lens: 113.5000 | lr: 4.2981e-06 | scale: 2048.00 | time: 26.382 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1303/  5000| tot_loss: 2.5779 | rl_loss: 0.7496 | pt_loss: 1.8283 | pg_loss: -0.0116 | reg_loss: 0.7612 | reward: -0.2552 | rev_kl: 0.9206 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.2970e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1304/  5000| tot_loss: 3.0473 | rl_loss: 1.3155 | pt_loss: 1.7318 | pg_loss: 0.2628 | reg_loss: 1.0528 | reward: -0.4997 | rev_kl: 1.8530 | stu_lens: 84.5000 | mixed_lens: 100.0000 | lr: 4.2959e-06 | scale: 2048.00 | time: 26.363 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1305/  5000| tot_loss: 2.7270 | rl_loss: 0.9217 | pt_loss: 1.8052 | pg_loss: 0.0592 | reg_loss: 0.8625 | reward: -0.2739 | rev_kl: 1.1028 | stu_lens: 70.0000 | mixed_lens: 118.0000 | lr: 4.2948e-06 | scale: 2048.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1306/  5000| tot_loss: 3.0357 | rl_loss: 1.4798 | pt_loss: 1.5559 | pg_loss: 0.5174 | reg_loss: 0.9624 | reward: -0.9477 | rev_kl: 0.8864 | stu_lens: 75.0000 | mixed_lens: 68.5000 | lr: 4.2936e-06 | scale: 2048.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1307/  5000| tot_loss: 4.5755 | rl_loss: 2.6500 | pt_loss: 1.9256 | pg_loss: 1.6241 | reg_loss: 1.0258 | reward: -0.4973 | rev_kl: 1.1613 | stu_lens: 72.0000 | mixed_lens: 15.5000 | lr: 4.2925e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1308/  5000| tot_loss: 2.6032 | rl_loss: 0.8200 | pt_loss: 1.7832 | pg_loss: 0.0524 | reg_loss: 0.7676 | reward: -0.2085 | rev_kl: 1.4376 | stu_lens: 59.0000 | mixed_lens: 120.0000 | lr: 4.2914e-06 | scale: 2048.00 | time: 26.328 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1309/  5000| tot_loss: 3.0055 | rl_loss: 0.9347 | pt_loss: 2.0708 | pg_loss: 0.2050 | reg_loss: 0.7297 | reward: -0.3953 | rev_kl: 1.4543 | stu_lens: 102.0000 | mixed_lens: 108.0000 | lr: 4.2903e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1310/  5000| tot_loss: 2.4673 | rl_loss: 0.8542 | pt_loss: 1.6131 | pg_loss: 0.0994 | reg_loss: 0.7547 | reward: -0.1082 | rev_kl: 1.2086 | stu_lens: 88.5000 | mixed_lens: 116.5000 | lr: 4.2892e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1311/  5000| tot_loss: 2.6772 | rl_loss: 0.8515 | pt_loss: 1.8257 | pg_loss: 0.0356 | reg_loss: 0.8160 | reward: -0.2311 | rev_kl: 1.6946 | stu_lens: 99.0000 | mixed_lens: 128.0000 | lr: 4.2880e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1312/  5000| tot_loss: 2.0457 | rl_loss: 0.5261 | pt_loss: 1.5196 | pg_loss: 0.0616 | reg_loss: 0.4644 | reward: -0.5004 | rev_kl: 1.2625 | stu_lens: 122.5000 | mixed_lens: 106.0000 | lr: 4.2869e-06 | scale: 2048.00 | time: 26.339 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1312/  5000| tot_loss: 2.8802 | rl_loss: 1.0943 | pt_loss: 1.7859 | pg_loss: 0.2714 | reg_loss: 0.8229 | reward: -0.4577 | rev_kl: 1.2731 | stu_lens: 88.6094 | mixed_lens: 94.9062 | lr: 4.2869e-06 | scale: 2048.00 | time: 26.339 | step time: 27.579
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1313/  5000| tot_loss: 2.9276 | rl_loss: 1.4002 | pt_loss: 1.5273 | pg_loss: 0.4456 | reg_loss: 0.9546 | reward: -0.9806 | rev_kl: 0.7557 | stu_lens: 23.5000 | mixed_lens: 68.0000 | lr: 4.2858e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1314/  5000| tot_loss: 2.8798 | rl_loss: 1.0054 | pt_loss: 1.8744 | pg_loss: 0.4863 | reg_loss: 0.5191 | reward: -0.5543 | rev_kl: 0.9671 | stu_lens: 104.5000 | mixed_lens: 83.5000 | lr: 4.2847e-06 | scale: 2048.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1315/  5000| tot_loss: 2.3039 | rl_loss: 0.5600 | pt_loss: 1.7440 | pg_loss: -0.0015 | reg_loss: 0.5614 | reward: -0.2619 | rev_kl: 0.9316 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.2836e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1316/  5000| tot_loss: 2.4066 | rl_loss: 0.4730 | pt_loss: 1.9336 | pg_loss: 0.1343 | reg_loss: 0.3388 | reward: -0.3231 | rev_kl: 1.2714 | stu_lens: 49.5000 | mixed_lens: 105.5000 | lr: 4.2824e-06 | scale: 2048.00 | time: 26.343 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1317/  5000| tot_loss: 2.1958 | rl_loss: 0.4805 | pt_loss: 1.7154 | pg_loss: 0.1549 | reg_loss: 0.3256 | reward: -0.5057 | rev_kl: 0.9695 | stu_lens: 102.5000 | mixed_lens: 92.5000 | lr: 4.2813e-06 | scale: 2048.00 | time: 26.351 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1318/  5000| tot_loss: 2.4822 | rl_loss: 0.4607 | pt_loss: 2.0215 | pg_loss: 0.2431 | reg_loss: 0.2176 | reward: -1.0931 | rev_kl: 0.9325 | stu_lens: 69.5000 | mixed_lens: 49.0000 | lr: 4.2802e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1319/  5000| tot_loss: 3.0952 | rl_loss: 1.6058 | pt_loss: 1.4894 | pg_loss: 0.8547 | reg_loss: 0.7511 | reward: -0.4639 | rev_kl: 0.4484 | stu_lens: 47.5000 | mixed_lens: 47.0000 | lr: 4.2791e-06 | scale: 2048.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1320/  5000| tot_loss: 2.6483 | rl_loss: 0.8787 | pt_loss: 1.7696 | pg_loss: 0.2127 | reg_loss: 0.6660 | reward: -0.3630 | rev_kl: 1.2643 | stu_lens: 96.5000 | mixed_lens: 98.0000 | lr: 4.2779e-06 | scale: 2048.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1321/  5000| tot_loss: 2.7071 | rl_loss: 0.7729 | pt_loss: 1.9342 | pg_loss: 0.3376 | reg_loss: 0.4353 | reward: -0.7383 | rev_kl: 0.6864 | stu_lens: 114.0000 | mixed_lens: 73.0000 | lr: 4.2768e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1322/  5000| tot_loss: 3.1914 | rl_loss: 1.5258 | pt_loss: 1.6655 | pg_loss: 0.5938 | reg_loss: 0.9320 | reward: -0.5960 | rev_kl: 2.0011 | stu_lens: 46.0000 | mixed_lens: 65.5000 | lr: 4.2757e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1323/  5000| tot_loss: 2.9759 | rl_loss: 1.0794 | pt_loss: 1.8965 | pg_loss: 0.5955 | reg_loss: 0.4840 | reward: -0.6904 | rev_kl: 1.5304 | stu_lens: 38.5000 | mixed_lens: 31.5000 | lr: 4.2746e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1324/  5000| tot_loss: 2.9981 | rl_loss: 0.8912 | pt_loss: 2.1069 | pg_loss: 0.1054 | reg_loss: 0.7858 | reward: -0.3068 | rev_kl: 0.6496 | stu_lens: 40.0000 | mixed_lens: 115.5000 | lr: 4.2734e-06 | scale: 2048.00 | time: 26.322 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1325/  5000| tot_loss: 2.4835 | rl_loss: 0.6981 | pt_loss: 1.7853 | pg_loss: 0.1052 | reg_loss: 0.5930 | reward: -0.2276 | rev_kl: 1.3129 | stu_lens: 58.5000 | mixed_lens: 120.0000 | lr: 4.2723e-06 | scale: 2048.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1326/  5000| tot_loss: 2.2084 | rl_loss: 0.6218 | pt_loss: 1.5867 | pg_loss: 0.0927 | reg_loss: 0.5291 | reward: -0.0971 | rev_kl: 1.3612 | stu_lens: 106.0000 | mixed_lens: 116.5000 | lr: 4.2712e-06 | scale: 2048.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1327/  5000| tot_loss: 2.3720 | rl_loss: 0.6541 | pt_loss: 1.7179 | pg_loss: 0.0554 | reg_loss: 0.5987 | reward: -0.2057 | rev_kl: 1.3251 | stu_lens: 99.0000 | mixed_lens: 128.0000 | lr: 4.2700e-06 | scale: 2048.00 | time: 26.366 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1328/  5000| tot_loss: 1.9853 | rl_loss: 0.5322 | pt_loss: 1.4530 | pg_loss: 0.0073 | reg_loss: 0.5249 | reward: -0.2889 | rev_kl: 0.8924 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.2689e-06 | scale: 2048.00 | time: 26.349 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1328/  5000| tot_loss: 2.5545 | rl_loss: 0.8209 | pt_loss: 1.7337 | pg_loss: 0.2249 | reg_loss: 0.5960 | reward: -0.4497 | rev_kl: 1.2278 | stu_lens: 85.1094 | mixed_lens: 96.9219 | lr: 4.2689e-06 | scale: 2048.00 | time: 26.349 | step time: 27.588
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1329/  5000| tot_loss: 2.8506 | rl_loss: 0.8459 | pt_loss: 2.0047 | pg_loss: 0.3992 | reg_loss: 0.4467 | reward: -0.7023 | rev_kl: 0.8371 | stu_lens: 54.5000 | mixed_lens: 48.0000 | lr: 4.2678e-06 | scale: 2048.00 | time: 26.349 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1330/  5000| tot_loss: 2.3114 | rl_loss: 0.4284 | pt_loss: 1.8830 | pg_loss: 0.0586 | reg_loss: 0.3699 | reward: -0.2069 | rev_kl: 1.0147 | stu_lens: 108.0000 | mixed_lens: 111.5000 | lr: 4.2666e-06 | scale: 2048.00 | time: 26.345 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1331/  5000| tot_loss: 2.0374 | rl_loss: 0.6700 | pt_loss: 1.3674 | pg_loss: 0.1535 | reg_loss: 0.5165 | reward: -0.5559 | rev_kl: 1.3111 | stu_lens: 82.0000 | mixed_lens: 70.5000 | lr: 4.2655e-06 | scale: 2048.00 | time: 26.395 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1332/  5000| tot_loss: 1.9593 | rl_loss: 0.7050 | pt_loss: 1.2543 | pg_loss: 0.3183 | reg_loss: 0.3867 | reward: -0.5249 | rev_kl: 1.4091 | stu_lens: 82.5000 | mixed_lens: 86.5000 | lr: 4.2644e-06 | scale: 2048.00 | time: 26.353 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1333/  5000| tot_loss: 2.3492 | rl_loss: 0.4955 | pt_loss: 1.8537 | pg_loss: 0.0622 | reg_loss: 0.4333 | reward: -0.2488 | rev_kl: 1.3341 | stu_lens: 99.0000 | mixed_lens: 122.0000 | lr: 4.2632e-06 | scale: 2048.00 | time: 26.315 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1334/  5000| tot_loss: 2.3565 | rl_loss: 0.8190 | pt_loss: 1.5375 | pg_loss: 0.3017 | reg_loss: 0.5173 | reward: -0.4310 | rev_kl: 0.6462 | stu_lens: 80.5000 | mixed_lens: 79.5000 | lr: 4.2621e-06 | scale: 2048.00 | time: 26.315 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1335/  5000| tot_loss: 2.9433 | rl_loss: 0.9370 | pt_loss: 2.0062 | pg_loss: 0.4074 | reg_loss: 0.5296 | reward: -0.9233 | rev_kl: 0.9848 | stu_lens: 61.0000 | mixed_lens: 79.0000 | lr: 4.2610e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1336/  5000| tot_loss: 1.4764 | rl_loss: 0.6655 | pt_loss: 0.8109 | pg_loss: 0.0310 | reg_loss: 0.6345 | reward: -0.2318 | rev_kl: 1.0501 | stu_lens: 115.5000 | mixed_lens: 125.5000 | lr: 4.2598e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1337/  5000| tot_loss: 2.2502 | rl_loss: 0.7825 | pt_loss: 1.4677 | pg_loss: 0.3442 | reg_loss: 0.4383 | reward: -0.4420 | rev_kl: 1.4246 | stu_lens: 57.5000 | mixed_lens: 98.5000 | lr: 4.2587e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1338/  5000| tot_loss: 2.0061 | rl_loss: 0.5857 | pt_loss: 1.4204 | pg_loss: 0.0118 | reg_loss: 0.5739 | reward: -0.1658 | rev_kl: 1.1535 | stu_lens: 88.5000 | mixed_lens: 128.0000 | lr: 4.2575e-06 | scale: 2048.00 | time: 26.328 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1339/  5000| tot_loss: 2.0814 | rl_loss: 0.5434 | pt_loss: 1.5380 | pg_loss: 0.0637 | reg_loss: 0.4797 | reward: -0.3823 | rev_kl: 1.3147 | stu_lens: 128.0000 | mixed_lens: 125.5000 | lr: 4.2564e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1340/  5000| tot_loss: 2.7343 | rl_loss: 0.6529 | pt_loss: 2.0814 | pg_loss: 0.2540 | reg_loss: 0.3989 | reward: -0.9073 | rev_kl: 1.3829 | stu_lens: 84.0000 | mixed_lens: 74.0000 | lr: 4.2553e-06 | scale: 2048.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1341/  5000| tot_loss: 2.3483 | rl_loss: 0.6513 | pt_loss: 1.6970 | pg_loss: 0.0944 | reg_loss: 0.5569 | reward: -0.5236 | rev_kl: 1.1868 | stu_lens: 70.5000 | mixed_lens: 92.5000 | lr: 4.2541e-06 | scale: 2048.00 | time: 26.378 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1342/  5000| tot_loss: 2.1863 | rl_loss: 0.3621 | pt_loss: 1.8243 | pg_loss: 0.1012 | reg_loss: 0.2608 | reward: -0.2787 | rev_kl: 1.0764 | stu_lens: 112.5000 | mixed_lens: 115.5000 | lr: 4.2530e-06 | scale: 2048.00 | time: 26.348 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1343/  5000| tot_loss: 2.0843 | rl_loss: 0.3393 | pt_loss: 1.7450 | pg_loss: 0.1099 | reg_loss: 0.2294 | reward: -0.3253 | rev_kl: 1.2122 | stu_lens: 122.5000 | mixed_lens: 106.0000 | lr: 4.2518e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1344/  5000| tot_loss: 2.4547 | rl_loss: 0.5681 | pt_loss: 1.8866 | pg_loss: 0.0021 | reg_loss: 0.5660 | reward: -1.0603 | rev_kl: 1.0584 | stu_lens: 75.0000 | mixed_lens: 71.0000 | lr: 4.2507e-06 | scale: 2048.00 | time: 26.329 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1344/  5000| tot_loss: 2.3981 | rl_loss: 0.6887 | pt_loss: 1.7094 | pg_loss: 0.2184 | reg_loss: 0.4703 | reward: -0.4615 | rev_kl: 1.2806 | stu_lens: 89.7812 | mixed_lens: 95.5469 | lr: 4.2507e-06 | scale: 2048.00 | time: 26.329 | step time: 27.592
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1345/  5000| tot_loss: 2.2857 | rl_loss: 0.5110 | pt_loss: 1.7747 | pg_loss: 0.0396 | reg_loss: 0.4715 | reward: -0.1724 | rev_kl: 0.9654 | stu_lens: 73.5000 | mixed_lens: 124.5000 | lr: 4.2495e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1346/  5000| tot_loss: 3.1008 | rl_loss: 0.9184 | pt_loss: 2.1825 | pg_loss: 0.1400 | reg_loss: 0.7783 | reward: -0.2189 | rev_kl: 0.6656 | stu_lens: 91.0000 | mixed_lens: 101.5000 | lr: 4.2484e-06 | scale: 2048.00 | time: 26.358 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1347/  5000| tot_loss: 2.8314 | rl_loss: 1.2890 | pt_loss: 1.5424 | pg_loss: 0.0499 | reg_loss: 1.2391 | reward: -0.1695 | rev_kl: 1.3605 | stu_lens: 89.0000 | mixed_lens: 128.0000 | lr: 4.2472e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1348/  5000| tot_loss: 3.4963 | rl_loss: 1.1387 | pt_loss: 2.3576 | pg_loss: 0.2072 | reg_loss: 0.9315 | reward: -0.6469 | rev_kl: 1.1773 | stu_lens: 128.0000 | mixed_lens: 89.0000 | lr: 4.2461e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1349/  5000| tot_loss: 3.4604 | rl_loss: 1.2274 | pt_loss: 2.2329 | pg_loss: 0.0737 | reg_loss: 1.1538 | reward: -0.3186 | rev_kl: 1.0183 | stu_lens: 100.0000 | mixed_lens: 119.5000 | lr: 4.2450e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1350/  5000| tot_loss: 3.5346 | rl_loss: 1.9307 | pt_loss: 1.6039 | pg_loss: 0.2584 | reg_loss: 1.6723 | reward: -0.4870 | rev_kl: 1.5471 | stu_lens: 128.0000 | mixed_lens: 98.5000 | lr: 4.2438e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1351/  5000| tot_loss: 2.9438 | rl_loss: 1.6173 | pt_loss: 1.3264 | pg_loss: 0.3206 | reg_loss: 1.2967 | reward: -0.6509 | rev_kl: 1.0552 | stu_lens: 108.0000 | mixed_lens: 91.0000 | lr: 4.2427e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1352/  5000| tot_loss: 3.1305 | rl_loss: 1.1318 | pt_loss: 1.9987 | pg_loss: 0.0306 | reg_loss: 1.1011 | reward: -0.3136 | rev_kl: 1.0634 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.2415e-06 | scale: 2048.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1353/  5000| tot_loss: 2.9305 | rl_loss: 1.5581 | pt_loss: 1.3723 | pg_loss: 0.3245 | reg_loss: 1.2337 | reward: -0.5008 | rev_kl: 1.1483 | stu_lens: 97.5000 | mixed_lens: 94.0000 | lr: 4.2404e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1354/  5000| tot_loss: 4.4264 | rl_loss: 2.4038 | pt_loss: 2.0226 | pg_loss: 0.6623 | reg_loss: 1.7415 | reward: -0.5826 | rev_kl: 0.9294 | stu_lens: 56.0000 | mixed_lens: 61.0000 | lr: 4.2392e-06 | scale: 2048.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1355/  5000| tot_loss: 3.0488 | rl_loss: 1.1171 | pt_loss: 1.9317 | pg_loss: 0.4122 | reg_loss: 0.7049 | reward: -0.0795 | rev_kl: 0.5473 | stu_lens: 70.5000 | mixed_lens: 77.5000 | lr: 4.2381e-06 | scale: 2048.00 | time: 26.357 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1356/  5000| tot_loss: 3.0574 | rl_loss: 1.7579 | pt_loss: 1.2995 | pg_loss: 0.0826 | reg_loss: 1.6753 | reward: -0.2626 | rev_kl: 1.3505 | stu_lens: 119.0000 | mixed_lens: 123.0000 | lr: 4.2369e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1357/  5000| tot_loss: 3.1619 | rl_loss: 1.8313 | pt_loss: 1.3306 | pg_loss: 0.3087 | reg_loss: 1.5226 | reward: -0.6749 | rev_kl: 1.1907 | stu_lens: 97.0000 | mixed_lens: 79.0000 | lr: 4.2357e-06 | scale: 2048.00 | time: 26.348 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1358/  5000| tot_loss: 4.3664 | rl_loss: 3.0408 | pt_loss: 1.3256 | pg_loss: 0.9230 | reg_loss: 2.1178 | reward: -1.6933 | rev_kl: 1.2153 | stu_lens: 80.5000 | mixed_lens: 34.0000 | lr: 4.2346e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1359/  5000| tot_loss: 3.9948 | rl_loss: 2.5009 | pt_loss: 1.4939 | pg_loss: 1.0323 | reg_loss: 1.4687 | reward: -0.2825 | rev_kl: 1.2901 | stu_lens: 96.5000 | mixed_lens: 48.0000 | lr: 4.2334e-06 | scale: 2048.00 | time: 26.317 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1360/  5000| tot_loss: 3.2078 | rl_loss: 1.4717 | pt_loss: 1.7362 | pg_loss: 0.6185 | reg_loss: 0.8531 | reward: -0.4252 | rev_kl: 0.7776 | stu_lens: 87.0000 | mixed_lens: 56.0000 | lr: 4.2323e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1360/  5000| tot_loss: 3.2311 | rl_loss: 1.5297 | pt_loss: 1.7014 | pg_loss: 0.3938 | reg_loss: 1.1359 | reward: -0.4653 | rev_kl: 1.0210 | stu_lens: 87.7188 | mixed_lens: 84.7969 | lr: 4.2323e-06 | scale: 2048.00 | time: 26.294 | step time: 27.574
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1361/  5000| tot_loss: 2.9057 | rl_loss: 1.3349 | pt_loss: 1.5708 | pg_loss: 0.0613 | reg_loss: 1.2735 | reward: -0.1593 | rev_kl: 1.1511 | stu_lens: 84.0000 | mixed_lens: 128.0000 | lr: 4.2311e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1362/  5000| tot_loss: 4.1638 | rl_loss: 2.3526 | pt_loss: 1.8112 | pg_loss: 1.1210 | reg_loss: 1.2315 | reward: -0.4763 | rev_kl: 0.6491 | stu_lens: 45.0000 | mixed_lens: 31.5000 | lr: 4.2300e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1363/  5000| tot_loss: 2.9615 | rl_loss: 1.1491 | pt_loss: 1.8124 | pg_loss: 0.2696 | reg_loss: 0.8795 | reward: -0.9738 | rev_kl: 1.0853 | stu_lens: 55.5000 | mixed_lens: 72.0000 | lr: 4.2288e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1364/  5000| tot_loss: 2.4813 | rl_loss: 0.8408 | pt_loss: 1.6405 | pg_loss: 0.1619 | reg_loss: 0.6789 | reward: -0.3208 | rev_kl: 1.2260 | stu_lens: 92.5000 | mixed_lens: 99.5000 | lr: 4.2277e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1365/  5000| tot_loss: 2.5747 | rl_loss: 0.9921 | pt_loss: 1.5826 | pg_loss: 0.1436 | reg_loss: 0.8485 | reward: -0.3229 | rev_kl: 1.0957 | stu_lens: 94.5000 | mixed_lens: 101.5000 | lr: 4.2265e-06 | scale: 2048.00 | time: 26.359 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1366/  5000| tot_loss: 2.3767 | rl_loss: 0.8567 | pt_loss: 1.5200 | pg_loss: 0.1753 | reg_loss: 0.6813 | reward: -0.2587 | rev_kl: 1.1693 | stu_lens: 98.5000 | mixed_lens: 94.5000 | lr: 4.2253e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1367/  5000| tot_loss: 2.5964 | rl_loss: 0.6227 | pt_loss: 1.9737 | pg_loss: 0.2190 | reg_loss: 0.4037 | reward: -0.5147 | rev_kl: 0.9193 | stu_lens: 92.0000 | mixed_lens: 75.0000 | lr: 4.2242e-06 | scale: 2048.00 | time: 26.347 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1368/  5000| tot_loss: 3.6545 | rl_loss: 1.9034 | pt_loss: 1.7510 | pg_loss: 0.8509 | reg_loss: 1.0525 | reward: -0.5044 | rev_kl: 1.0220 | stu_lens: 86.5000 | mixed_lens: 56.5000 | lr: 4.2230e-06 | scale: 2048.00 | time: 26.393 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1369/  5000| tot_loss: 2.1527 | rl_loss: 0.6809 | pt_loss: 1.4718 | pg_loss: 0.0833 | reg_loss: 0.5977 | reward: -0.1921 | rev_kl: 0.6193 | stu_lens: 95.5000 | mixed_lens: 113.5000 | lr: 4.2219e-06 | scale: 2048.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1370/  5000| tot_loss: 2.9092 | rl_loss: 1.5131 | pt_loss: 1.3961 | pg_loss: 0.8398 | reg_loss: 0.6733 | reward: -0.3725 | rev_kl: 0.6554 | stu_lens: 29.0000 | mixed_lens: 46.5000 | lr: 4.2207e-06 | scale: 2048.00 | time: 26.365 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1371/  5000| tot_loss: 2.2844 | rl_loss: 1.0356 | pt_loss: 1.2488 | pg_loss: -0.0015 | reg_loss: 1.0370 | reward: -0.3435 | rev_kl: 0.9818 | stu_lens: 106.0000 | mixed_lens: 128.0000 | lr: 4.2195e-06 | scale: 2048.00 | time: 26.370 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1372/  5000| tot_loss: 2.3901 | rl_loss: 1.0380 | pt_loss: 1.3522 | pg_loss: 0.1719 | reg_loss: 0.8660 | reward: -0.3098 | rev_kl: 1.0654 | stu_lens: 87.0000 | mixed_lens: 97.5000 | lr: 4.2184e-06 | scale: 2048.00 | time: 26.364 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1373/  5000| tot_loss: 2.9936 | rl_loss: 1.1584 | pt_loss: 1.8351 | pg_loss: 0.4673 | reg_loss: 0.6912 | reward: -0.7366 | rev_kl: 1.5917 | stu_lens: 12.0000 | mixed_lens: 68.5000 | lr: 4.2172e-06 | scale: 2048.00 | time: 26.360 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1374/  5000| tot_loss: 2.6975 | rl_loss: 0.7645 | pt_loss: 1.9330 | pg_loss: 0.3990 | reg_loss: 0.3655 | reward: -1.1291 | rev_kl: 0.4781 | stu_lens: 65.0000 | mixed_lens: 65.0000 | lr: 4.2160e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1375/  5000| tot_loss: 2.7762 | rl_loss: 1.1459 | pt_loss: 1.6303 | pg_loss: 0.2374 | reg_loss: 0.9085 | reward: -0.7412 | rev_kl: 1.7891 | stu_lens: 128.0000 | mixed_lens: 89.0000 | lr: 4.2149e-06 | scale: 2048.00 | time: 26.353 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1376/  5000| tot_loss: 2.4123 | rl_loss: 0.7918 | pt_loss: 1.6204 | pg_loss: 0.0317 | reg_loss: 0.7602 | reward: -0.2235 | rev_kl: 1.1201 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.2137e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1376/  5000| tot_loss: 2.7494 | rl_loss: 1.0612 | pt_loss: 1.6882 | pg_loss: 0.2885 | reg_loss: 0.7728 | reward: -0.4636 | rev_kl: 1.0413 | stu_lens: 86.9688 | mixed_lens: 86.7188 | lr: 4.2137e-06 | scale: 2048.00 | time: 26.331 | step time: 27.606
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1377/  5000| tot_loss: 2.9004 | rl_loss: 0.9050 | pt_loss: 1.9954 | pg_loss: 0.2005 | reg_loss: 0.7045 | reward: -0.1278 | rev_kl: 1.0055 | stu_lens: 108.5000 | mixed_lens: 99.5000 | lr: 4.2125e-06 | scale: 2048.00 | time: 26.347 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1378/  5000| tot_loss: 2.1834 | rl_loss: 0.5893 | pt_loss: 1.5941 | pg_loss: 0.0381 | reg_loss: 0.5512 | reward: -0.2946 | rev_kl: 1.4135 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.2114e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1379/  5000| tot_loss: 2.7193 | rl_loss: 0.8622 | pt_loss: 1.8571 | pg_loss: 0.2326 | reg_loss: 0.6297 | reward: -0.6109 | rev_kl: 1.0632 | stu_lens: 105.5000 | mixed_lens: 92.0000 | lr: 4.2102e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1380/  5000| tot_loss: 2.8723 | rl_loss: 1.1452 | pt_loss: 1.7271 | pg_loss: 0.3507 | reg_loss: 0.7945 | reward: -0.5628 | rev_kl: 0.9438 | stu_lens: 128.0000 | mixed_lens: 53.0000 | lr: 4.2090e-06 | scale: 2048.00 | time: 26.320 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1381/  5000| tot_loss: 1.6802 | rl_loss: 0.2813 | pt_loss: 1.3989 | pg_loss: 0.1094 | reg_loss: 0.1720 | reward: -0.1405 | rev_kl: 0.8542 | stu_lens: 100.5000 | mixed_lens: 90.0000 | lr: 4.2079e-06 | scale: 2048.00 | time: 26.374 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1382/  5000| tot_loss: 2.2789 | rl_loss: 0.4882 | pt_loss: 1.7907 | pg_loss: 0.1285 | reg_loss: 0.3597 | reward: -0.3229 | rev_kl: 0.8163 | stu_lens: 123.5000 | mixed_lens: 110.5000 | lr: 4.2067e-06 | scale: 2048.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1383/  5000| tot_loss: 2.2074 | rl_loss: 1.0239 | pt_loss: 1.1835 | pg_loss: 0.4699 | reg_loss: 0.5540 | reward: -0.1332 | rev_kl: 0.6029 | stu_lens: 31.5000 | mixed_lens: 77.5000 | lr: 4.2055e-06 | scale: 2048.00 | time: 26.364 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1384/  5000| tot_loss: 1.8602 | rl_loss: 0.6090 | pt_loss: 1.2512 | pg_loss: 0.0349 | reg_loss: 0.5741 | reward: -0.3766 | rev_kl: 1.6219 | stu_lens: 84.0000 | mixed_lens: 128.0000 | lr: 4.2043e-06 | scale: 2048.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1385/  5000| tot_loss: 2.3393 | rl_loss: 0.7455 | pt_loss: 1.5937 | pg_loss: 0.5072 | reg_loss: 0.2384 | reward: -1.2506 | rev_kl: 0.9142 | stu_lens: 37.0000 | mixed_lens: 56.5000 | lr: 4.2032e-06 | scale: 2048.00 | time: 26.359 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1386/  5000| tot_loss: 2.8429 | rl_loss: 0.8852 | pt_loss: 1.9577 | pg_loss: 0.3754 | reg_loss: 0.5099 | reward: -0.5622 | rev_kl: 1.3462 | stu_lens: 51.5000 | mixed_lens: 82.0000 | lr: 4.2020e-06 | scale: 2048.00 | time: 26.320 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1387/  5000| tot_loss: 3.2097 | rl_loss: 1.5107 | pt_loss: 1.6990 | pg_loss: 0.8388 | reg_loss: 0.6720 | reward: -0.3593 | rev_kl: 1.0265 | stu_lens: 74.0000 | mixed_lens: 50.0000 | lr: 4.2008e-06 | scale: 2048.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1388/  5000| tot_loss: 2.9060 | rl_loss: 1.0613 | pt_loss: 1.8448 | pg_loss: 0.1474 | reg_loss: 0.9138 | reward: -0.4172 | rev_kl: 1.6821 | stu_lens: 83.5000 | mixed_lens: 99.5000 | lr: 4.1996e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1389/  5000| tot_loss: 2.8187 | rl_loss: 1.3007 | pt_loss: 1.5180 | pg_loss: 0.5784 | reg_loss: 0.7223 | reward: -1.0027 | rev_kl: 1.1444 | stu_lens: 53.0000 | mixed_lens: 43.5000 | lr: 4.1985e-06 | scale: 2048.00 | time: 26.355 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1390/  5000| tot_loss: 2.9411 | rl_loss: 0.7620 | pt_loss: 2.1792 | pg_loss: 0.1545 | reg_loss: 0.6074 | reward: -0.3455 | rev_kl: 1.3259 | stu_lens: 94.5000 | mixed_lens: 101.5000 | lr: 4.1973e-06 | scale: 2048.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1391/  5000| tot_loss: 2.6823 | rl_loss: 0.8900 | pt_loss: 1.7922 | pg_loss: 0.3149 | reg_loss: 0.5751 | reward: -0.5999 | rev_kl: 1.3216 | stu_lens: 49.0000 | mixed_lens: 80.5000 | lr: 4.1961e-06 | scale: 2048.00 | time: 26.349 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1392/  5000| tot_loss: 2.4596 | rl_loss: 0.6303 | pt_loss: 1.8293 | pg_loss: 0.3247 | reg_loss: 0.3056 | reward: -0.3170 | rev_kl: 0.8676 | stu_lens: 78.5000 | mixed_lens: 77.5000 | lr: 4.1949e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1392/  5000| tot_loss: 2.5669 | rl_loss: 0.8071 | pt_loss: 1.7597 | pg_loss: 0.2768 | reg_loss: 0.5304 | reward: -0.4318 | rev_kl: 1.0488 | stu_lens: 90.4219 | mixed_lens: 88.1094 | lr: 4.1949e-06 | scale: 2048.00 | time: 26.298 | step time: 27.597
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1393/  5000| tot_loss: 3.1552 | rl_loss: 1.5434 | pt_loss: 1.6118 | pg_loss: 0.7401 | reg_loss: 0.8033 | reward: -0.9177 | rev_kl: 1.5042 | stu_lens: 92.0000 | mixed_lens: 36.0000 | lr: 4.1938e-06 | scale: 2048.00 | time: 26.357 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1394/  5000| tot_loss: 3.0022 | rl_loss: 1.0845 | pt_loss: 1.9177 | pg_loss: 0.5173 | reg_loss: 0.5671 | reward: -0.3107 | rev_kl: 0.8802 | stu_lens: 100.5000 | mixed_lens: 60.5000 | lr: 4.1926e-06 | scale: 2048.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1395/  5000| tot_loss: 3.8584 | rl_loss: 1.0220 | pt_loss: 2.8364 | pg_loss: 0.5640 | reg_loss: 0.4580 | reward: -0.5363 | rev_kl: 1.0016 | stu_lens: 82.0000 | mixed_lens: 68.5000 | lr: 4.1914e-06 | scale: 2048.00 | time: 26.385 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1396/  5000| tot_loss: 3.6979 | rl_loss: 2.5546 | pt_loss: 1.1433 | pg_loss: 1.8089 | reg_loss: 0.7457 | reward: -1.3893 | rev_kl: 0.9143 | stu_lens: 20.0000 | mixed_lens: 19.0000 | lr: 4.1902e-06 | scale: 2048.00 | time: 26.385 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1397/  5000| tot_loss: 2.3957 | rl_loss: 0.4227 | pt_loss: 1.9730 | pg_loss: 0.1781 | reg_loss: 0.2446 | reward: -0.4261 | rev_kl: 1.1798 | stu_lens: 105.5000 | mixed_lens: 94.0000 | lr: 4.1890e-06 | scale: 2048.00 | time: 26.392 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1398/  5000| tot_loss: 2.2534 | rl_loss: 0.4035 | pt_loss: 1.8499 | pg_loss: 0.1698 | reg_loss: 0.2337 | reward: -0.2554 | rev_kl: 0.8547 | stu_lens: 128.0000 | mixed_lens: 100.0000 | lr: 4.1879e-06 | scale: 2048.00 | time: 26.350 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1399/  5000| tot_loss: 1.7743 | rl_loss: 0.8009 | pt_loss: 0.9734 | pg_loss: 0.1845 | reg_loss: 0.6164 | reward: -0.6231 | rev_kl: 1.2530 | stu_lens: 128.0000 | mixed_lens: 89.0000 | lr: 4.1867e-06 | scale: 2048.00 | time: 26.361 | step time: 0.000
                                 Evaluation #14                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Yes, Bob should leave Alice. His     │
│                                       │ chances of survival are better if he │
│                                       │ leaves her. He can try to find       │
│                                       │ another way to safety. If he         │
│                                       │ doesn't, he has a 31% chance of      │
│                                       │ survival. But if he does, his        │
│                                       │ chances improve to 9%.               │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ mz kezboard tzpe z instead of y and  │
│                                       │ vice versa is due to the keyboard    │
│                                       │ being mapped to other languages. In  │
│                                       │ this case, z is mapped to y in       │
│                                       │ English and vice versa.              │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support 12 languages.             │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.032 | exact_match: 0.215 | rev_kl: 1.109 | lens: 86.978 | pt_loss: 1.082 | lm_loss: 1.164 | kd_loss: 1.001 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1400/  5000| tot_loss: 2.3069 | rl_loss: 0.5693 | pt_loss: 1.7376 | pg_loss: 0.3022 | reg_loss: 0.2671 | reward: -0.1313 | rev_kl: 0.2951 | stu_lens: 70.5000 | mixed_lens: 77.5000 | lr: 4.1855e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1401/  5000| tot_loss: 2.0636 | rl_loss: 0.4316 | pt_loss: 1.6319 | pg_loss: 0.0144 | reg_loss: 0.4172 | reward: -0.1662 | rev_kl: 0.8944 | stu_lens: 128.0000 | mixed_lens: 123.0000 | lr: 4.1843e-06 | scale: 2048.00 | time: 26.362 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1402/  5000| tot_loss: 1.6331 | rl_loss: 0.6406 | pt_loss: 0.9925 | pg_loss: 0.2071 | reg_loss: 0.4335 | reward: -0.1798 | rev_kl: 1.1562 | stu_lens: 127.5000 | mixed_lens: 103.5000 | lr: 4.1831e-06 | scale: 2048.00 | time: 26.314 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1403/  5000| tot_loss: 2.4552 | rl_loss: 0.6944 | pt_loss: 1.7608 | pg_loss: 0.3229 | reg_loss: 0.3715 | reward: -0.4081 | rev_kl: 1.3191 | stu_lens: 66.0000 | mixed_lens: 79.5000 | lr: 4.1819e-06 | scale: 2048.00 | time: 26.338 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1404/  5000| tot_loss: 2.5247 | rl_loss: 0.5891 | pt_loss: 1.9355 | pg_loss: 0.1790 | reg_loss: 0.4101 | reward: -0.3065 | rev_kl: 1.0570 | stu_lens: 109.0000 | mixed_lens: 84.0000 | lr: 4.1808e-06 | scale: 2048.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1405/  5000| tot_loss: 2.8873 | rl_loss: 1.0881 | pt_loss: 1.7992 | pg_loss: 0.4051 | reg_loss: 0.6830 | reward: -0.5072 | rev_kl: 0.9875 | stu_lens: 78.5000 | mixed_lens: 77.5000 | lr: 4.1796e-06 | scale: 2048.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1406/  5000| tot_loss: 2.7238 | rl_loss: 1.0890 | pt_loss: 1.6348 | pg_loss: 0.6522 | reg_loss: 0.4368 | reward: -0.9221 | rev_kl: 1.2513 | stu_lens: 46.0000 | mixed_lens: 43.5000 | lr: 4.1784e-06 | scale: 2048.00 | time: 26.368 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1407/  5000| tot_loss: 1.9757 | rl_loss: 0.5495 | pt_loss: 1.4263 | pg_loss: 0.2686 | reg_loss: 0.2809 | reward: -0.5060 | rev_kl: 0.9297 | stu_lens: 71.5000 | mixed_lens: 88.5000 | lr: 4.1772e-06 | scale: 2048.00 | time: 26.379 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1408/  5000| tot_loss: 1.9483 | rl_loss: 0.3344 | pt_loss: 1.6139 | pg_loss: 0.0213 | reg_loss: 0.3130 | reward: -0.1246 | rev_kl: 0.9803 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1760e-06 | scale: 2048.00 | time: 26.436 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1408/  5000| tot_loss: 2.5105 | rl_loss: 0.8150 | pt_loss: 1.6955 | pg_loss: 0.3319 | reg_loss: 0.4830 | reward: -0.4598 | rev_kl: 1.0626 | stu_lens: 90.9844 | mixed_lens: 86.3750 | lr: 4.1760e-06 | scale: 2048.00 | time: 26.436 | step time: 27.624
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1409/  5000| tot_loss: 3.0124 | rl_loss: 0.6526 | pt_loss: 2.3598 | pg_loss: 0.2216 | reg_loss: 0.4311 | reward: -0.4803 | rev_kl: 0.8565 | stu_lens: 73.0000 | mixed_lens: 75.0000 | lr: 4.1748e-06 | scale: 2048.00 | time: 26.423 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1410/  5000| tot_loss: 3.4552 | rl_loss: 1.4191 | pt_loss: 2.0361 | pg_loss: 0.2409 | reg_loss: 1.1782 | reward: -0.1546 | rev_kl: 0.8811 | stu_lens: 114.5000 | mixed_lens: 92.0000 | lr: 4.1736e-06 | scale: 2048.00 | time: 26.413 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1411/  5000| tot_loss: 3.0599 | rl_loss: 1.4203 | pt_loss: 1.6396 | pg_loss: 0.1295 | reg_loss: 1.2908 | reward: -0.2645 | rev_kl: 1.5073 | stu_lens: 125.0000 | mixed_lens: 121.0000 | lr: 4.1724e-06 | scale: 2048.00 | time: 26.414 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1412/  5000| tot_loss: 3.3147 | rl_loss: 1.5030 | pt_loss: 1.8117 | pg_loss: 0.1723 | reg_loss: 1.3307 | reward: -0.2119 | rev_kl: 1.1660 | stu_lens: 110.0000 | mixed_lens: 105.5000 | lr: 4.1712e-06 | scale: 2048.00 | time: 26.367 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1413/  5000| tot_loss: 3.5736 | rl_loss: 1.7943 | pt_loss: 1.7793 | pg_loss: 0.3881 | reg_loss: 1.4062 | reward: -0.6153 | rev_kl: 0.9248 | stu_lens: 102.5000 | mixed_lens: 90.5000 | lr: 4.1700e-06 | scale: 2048.00 | time: 26.353 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1414/  5000| tot_loss: 2.4462 | rl_loss: 0.9386 | pt_loss: 1.5076 | pg_loss: 0.0718 | reg_loss: 0.8668 | reward: -0.1257 | rev_kl: 0.9253 | stu_lens: 68.5000 | mixed_lens: 128.0000 | lr: 4.1689e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1415/  5000| tot_loss: 2.6744 | rl_loss: 1.0914 | pt_loss: 1.5830 | pg_loss: 0.0580 | reg_loss: 1.0334 | reward: -0.2145 | rev_kl: 1.1354 | stu_lens: 117.5000 | mixed_lens: 124.0000 | lr: 4.1677e-06 | scale: 2048.00 | time: 26.380 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1416/  5000| tot_loss: 3.3274 | rl_loss: 1.7793 | pt_loss: 1.5480 | pg_loss: 0.1747 | reg_loss: 1.6046 | reward: -0.5569 | rev_kl: 1.9369 | stu_lens: 128.0000 | mixed_lens: 112.5000 | lr: 4.1665e-06 | scale: 2048.00 | time: 26.340 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1417/  5000| tot_loss: 4.8144 | rl_loss: 2.8515 | pt_loss: 1.9628 | pg_loss: 1.2906 | reg_loss: 1.5609 | reward: -0.7077 | rev_kl: 0.6683 | stu_lens: 28.0000 | mixed_lens: 24.5000 | lr: 4.1653e-06 | scale: 2048.00 | time: 26.383 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1418/  5000| tot_loss: 2.9589 | rl_loss: 1.1098 | pt_loss: 1.8491 | pg_loss: 0.3967 | reg_loss: 0.7131 | reward: -0.2055 | rev_kl: 0.2535 | stu_lens: 69.5000 | mixed_lens: 71.5000 | lr: 4.1641e-06 | scale: 2048.00 | time: 26.419 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1419/  5000| tot_loss: 2.8959 | rl_loss: 1.2462 | pt_loss: 1.6497 | pg_loss: 0.1524 | reg_loss: 1.0938 | reward: -0.2221 | rev_kl: 0.7910 | stu_lens: 111.5000 | mixed_lens: 94.0000 | lr: 4.1629e-06 | scale: 2048.00 | time: 26.430 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1420/  5000| tot_loss: 3.0259 | rl_loss: 1.0204 | pt_loss: 2.0055 | pg_loss: 0.0248 | reg_loss: 0.9955 | reward: -0.1830 | rev_kl: 1.4790 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1617e-06 | scale: 2048.00 | time: 26.391 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1421/  5000| tot_loss: 3.2888 | rl_loss: 1.7585 | pt_loss: 1.5303 | pg_loss: 0.2404 | reg_loss: 1.5181 | reward: -0.3960 | rev_kl: 0.8874 | stu_lens: 54.5000 | mixed_lens: 82.0000 | lr: 4.1605e-06 | scale: 2048.00 | time: 26.439 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1422/  5000| tot_loss: 3.8566 | rl_loss: 2.1857 | pt_loss: 1.6709 | pg_loss: 0.5111 | reg_loss: 1.6746 | reward: -2.1846 | rev_kl: 1.9007 | stu_lens: 26.5000 | mixed_lens: 74.5000 | lr: 4.1593e-06 | scale: 2048.00 | time: 26.442 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1423/  5000| tot_loss: 3.4941 | rl_loss: 1.5030 | pt_loss: 1.9912 | pg_loss: 0.6519 | reg_loss: 0.8511 | reward: -1.1797 | rev_kl: 0.4596 | stu_lens: 67.0000 | mixed_lens: 61.0000 | lr: 4.1581e-06 | scale: 2048.00 | time: 26.462 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1424/  5000| tot_loss: 3.7151 | rl_loss: 2.0465 | pt_loss: 1.6686 | pg_loss: 0.4643 | reg_loss: 1.5822 | reward: -1.8507 | rev_kl: 2.0158 | stu_lens: 71.0000 | mixed_lens: 72.0000 | lr: 4.1569e-06 | scale: 2048.00 | time: 26.432 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1424/  5000| tot_loss: 3.2405 | rl_loss: 1.5503 | pt_loss: 1.6901 | pg_loss: 0.3849 | reg_loss: 1.1654 | reward: -0.5438 | rev_kl: 1.2106 | stu_lens: 81.7188 | mixed_lens: 82.5000 | lr: 4.1569e-06 | scale: 2048.00 | time: 26.432 | step time: 27.666
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1425/  5000| tot_loss: 2.9515 | rl_loss: 1.5896 | pt_loss: 1.3618 | pg_loss: 0.3166 | reg_loss: 1.2730 | reward: -0.5269 | rev_kl: 1.4572 | stu_lens: 72.5000 | mixed_lens: 77.0000 | lr: 4.1557e-06 | scale: 2048.00 | time: 26.446 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1426/  5000| tot_loss: 3.0827 | rl_loss: 1.0777 | pt_loss: 2.0050 | pg_loss: 0.3027 | reg_loss: 0.7750 | reward: -0.2257 | rev_kl: 1.4066 | stu_lens: 49.0000 | mixed_lens: 92.0000 | lr: 4.1545e-06 | scale: 2048.00 | time: 26.429 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1427/  5000| tot_loss: 4.2681 | rl_loss: 2.2049 | pt_loss: 2.0633 | pg_loss: 0.7146 | reg_loss: 1.4903 | reward: -2.2146 | rev_kl: 1.4112 | stu_lens: 82.0000 | mixed_lens: 52.0000 | lr: 4.1533e-06 | scale: 2048.00 | time: 26.417 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1428/  5000| tot_loss: 3.0052 | rl_loss: 1.1975 | pt_loss: 1.8077 | pg_loss: 0.2265 | reg_loss: 0.9710 | reward: -0.2763 | rev_kl: 1.0436 | stu_lens: 97.5000 | mixed_lens: 93.5000 | lr: 4.1521e-06 | scale: 2048.00 | time: 26.391 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1429/  5000| tot_loss: 2.7763 | rl_loss: 1.1435 | pt_loss: 1.6328 | pg_loss: 0.4346 | reg_loss: 0.7090 | reward: -0.9525 | rev_kl: 1.3348 | stu_lens: 76.0000 | mixed_lens: 26.0000 | lr: 4.1509e-06 | scale: 2048.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1430/  5000| tot_loss: 2.6881 | rl_loss: 0.8683 | pt_loss: 1.8198 | pg_loss: 0.1802 | reg_loss: 0.6882 | reward: -0.1433 | rev_kl: 1.4111 | stu_lens: 125.0000 | mixed_lens: 103.5000 | lr: 4.1497e-06 | scale: 2048.00 | time: 26.361 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1431/  5000| tot_loss: 2.2803 | rl_loss: 0.5553 | pt_loss: 1.7250 | pg_loss: 0.0823 | reg_loss: 0.4730 | reward: -0.2996 | rev_kl: 0.7756 | stu_lens: 128.0000 | mixed_lens: 94.0000 | lr: 4.1485e-06 | scale: 2048.00 | time: 26.414 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1432/  5000| tot_loss: 2.3078 | rl_loss: 1.1165 | pt_loss: 1.1912 | pg_loss: 0.3027 | reg_loss: 0.8139 | reward: -0.4642 | rev_kl: 1.0004 | stu_lens: 87.0000 | mixed_lens: 82.0000 | lr: 4.1473e-06 | scale: 2048.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1433/  5000| tot_loss: 3.3328 | rl_loss: 1.2499 | pt_loss: 2.0828 | pg_loss: 0.3518 | reg_loss: 0.8981 | reward: -1.1669 | rev_kl: 1.3256 | stu_lens: 65.0000 | mixed_lens: 81.5000 | lr: 4.1461e-06 | scale: 2048.00 | time: 26.388 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1434/  5000| tot_loss: 2.5483 | rl_loss: 0.8077 | pt_loss: 1.7405 | pg_loss: 0.1811 | reg_loss: 0.6267 | reward: -0.2568 | rev_kl: 1.3755 | stu_lens: 89.5000 | mixed_lens: 89.5000 | lr: 4.1448e-06 | scale: 2048.00 | time: 26.367 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1435/  5000| tot_loss: 2.6098 | rl_loss: 0.6286 | pt_loss: 1.9813 | pg_loss: 0.2071 | reg_loss: 0.4215 | reward: -0.0611 | rev_kl: 0.7037 | stu_lens: 128.0000 | mixed_lens: 98.0000 | lr: 4.1436e-06 | scale: 2048.00 | time: 26.398 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1436/  5000| tot_loss: 2.6039 | rl_loss: 0.8648 | pt_loss: 1.7391 | pg_loss: -0.0129 | reg_loss: 0.8777 | reward: -0.2231 | rev_kl: 0.9706 | stu_lens: 101.5000 | mixed_lens: 128.0000 | lr: 4.1424e-06 | scale: 2048.00 | time: 26.395 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1437/  5000| tot_loss: 2.3936 | rl_loss: 0.7902 | pt_loss: 1.6033 | pg_loss: 0.0380 | reg_loss: 0.7523 | reward: -0.1056 | rev_kl: 1.4944 | stu_lens: 111.5000 | mixed_lens: 128.0000 | lr: 4.1412e-06 | scale: 2048.00 | time: 26.475 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1438/  5000| tot_loss: 2.7745 | rl_loss: 1.0323 | pt_loss: 1.7422 | pg_loss: 0.0502 | reg_loss: 0.9821 | reward: -0.1781 | rev_kl: 1.7778 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1400e-06 | scale: 2048.00 | time: 26.398 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1439/  5000| tot_loss: 3.1653 | rl_loss: 1.6119 | pt_loss: 1.5534 | pg_loss: 0.5992 | reg_loss: 1.0127 | reward: -0.1576 | rev_kl: 1.0180 | stu_lens: 75.0000 | mixed_lens: 63.0000 | lr: 4.1388e-06 | scale: 2048.00 | time: 26.451 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1440/  5000| tot_loss: 3.0640 | rl_loss: 1.2234 | pt_loss: 1.8406 | pg_loss: 0.2615 | reg_loss: 0.9619 | reward: -0.3501 | rev_kl: 1.3707 | stu_lens: 99.0000 | mixed_lens: 103.0000 | lr: 4.1376e-06 | scale: 2048.00 | time: 26.415 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1440/  5000| tot_loss: 2.8293 | rl_loss: 1.1400 | pt_loss: 1.6892 | pg_loss: 0.3300 | reg_loss: 0.8100 | reward: -0.5301 | rev_kl: 1.2195 | stu_lens: 81.4531 | mixed_lens: 80.2969 | lr: 4.1376e-06 | scale: 2048.00 | time: 26.415 | step time: 27.667
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1441/  5000| tot_loss: 2.4088 | rl_loss: 0.5777 | pt_loss: 1.8310 | pg_loss: 0.0791 | reg_loss: 0.4986 | reward: -0.3048 | rev_kl: 1.0099 | stu_lens: 87.5000 | mixed_lens: 119.0000 | lr: 4.1364e-06 | scale: 2048.00 | time: 26.461 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1442/  5000| tot_loss: 2.0751 | rl_loss: 0.6002 | pt_loss: 1.4749 | pg_loss: 0.2261 | reg_loss: 0.3741 | reward: -0.2411 | rev_kl: 1.3380 | stu_lens: 86.5000 | mixed_lens: 92.0000 | lr: 4.1352e-06 | scale: 2048.00 | time: 26.431 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1443/  5000| tot_loss: 2.8107 | rl_loss: 1.0654 | pt_loss: 1.7453 | pg_loss: 0.3271 | reg_loss: 0.7383 | reward: -2.1765 | rev_kl: 1.4229 | stu_lens: 56.0000 | mixed_lens: 74.5000 | lr: 4.1340e-06 | scale: 2048.00 | time: 26.453 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1444/  5000| tot_loss: 2.4168 | rl_loss: 0.4946 | pt_loss: 1.9222 | pg_loss: 0.0094 | reg_loss: 0.4853 | reward: -0.2348 | rev_kl: 1.6714 | stu_lens: 90.5000 | mixed_lens: 128.0000 | lr: 4.1327e-06 | scale: 2048.00 | time: 26.414 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1445/  5000| tot_loss: 2.2001 | rl_loss: 0.7006 | pt_loss: 1.4995 | pg_loss: 0.0008 | reg_loss: 0.6998 | reward: -0.1331 | rev_kl: 1.4770 | stu_lens: 72.0000 | mixed_lens: 69.5000 | lr: 4.1315e-06 | scale: 2048.00 | time: 26.420 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1446/  5000| tot_loss: 3.6446 | rl_loss: 1.7121 | pt_loss: 1.9325 | pg_loss: 1.1395 | reg_loss: 0.5726 | reward: -1.0756 | rev_kl: 1.0123 | stu_lens: 29.0000 | mixed_lens: 31.0000 | lr: 4.1303e-06 | scale: 2048.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1447/  5000| tot_loss: 1.8228 | rl_loss: 0.4442 | pt_loss: 1.3786 | pg_loss: 0.0010 | reg_loss: 0.4432 | reward: -0.0377 | rev_kl: 1.5193 | stu_lens: 126.5000 | mixed_lens: 128.0000 | lr: 4.1291e-06 | scale: 2048.00 | time: 26.422 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1448/  5000| tot_loss: 2.1563 | rl_loss: 0.7932 | pt_loss: 1.3631 | pg_loss: 0.1929 | reg_loss: 0.6003 | reward: -0.1551 | rev_kl: 1.8836 | stu_lens: 87.5000 | mixed_lens: 105.5000 | lr: 4.1279e-06 | scale: 2048.00 | time: 26.419 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1449/  5000| tot_loss: 2.5560 | rl_loss: 0.5962 | pt_loss: 1.9598 | pg_loss: 0.0126 | reg_loss: 0.5836 | reward: -0.1263 | rev_kl: 1.6858 | stu_lens: 72.5000 | mixed_lens: 128.0000 | lr: 4.1267e-06 | scale: 2048.00 | time: 26.364 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1450/  5000| tot_loss: 3.2037 | rl_loss: 1.3331 | pt_loss: 1.8706 | pg_loss: 0.8550 | reg_loss: 0.4781 | reward: -0.6864 | rev_kl: 0.8527 | stu_lens: 34.0000 | mixed_lens: 51.0000 | lr: 4.1254e-06 | scale: 2048.00 | time: 26.345 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1451/  5000| tot_loss: 1.9169 | rl_loss: 0.4237 | pt_loss: 1.4932 | pg_loss: 0.3341 | reg_loss: 0.0896 | reward: -0.3764 | rev_kl: 0.7543 | stu_lens: 93.5000 | mixed_lens: 63.5000 | lr: 4.1242e-06 | scale: 2048.00 | time: 26.371 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1452/  5000| tot_loss: 3.9197 | rl_loss: 1.9099 | pt_loss: 2.0098 | pg_loss: 0.8349 | reg_loss: 1.0750 | reward: -2.0973 | rev_kl: 2.1205 | stu_lens: 39.0000 | mixed_lens: 29.0000 | lr: 4.1230e-06 | scale: 2048.00 | time: 26.379 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1453/  5000| tot_loss: 2.5981 | rl_loss: 0.5467 | pt_loss: 2.0514 | pg_loss: 0.0821 | reg_loss: 0.4646 | reward: -0.2561 | rev_kl: 0.7693 | stu_lens: 119.5000 | mixed_lens: 117.5000 | lr: 4.1218e-06 | scale: 2048.00 | time: 26.411 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1454/  5000| tot_loss: 2.2646 | rl_loss: 0.6593 | pt_loss: 1.6052 | pg_loss: 0.2268 | reg_loss: 0.4326 | reward: -0.7398 | rev_kl: 1.2137 | stu_lens: 86.0000 | mixed_lens: 82.0000 | lr: 4.1206e-06 | scale: 2048.00 | time: 26.405 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1455/  5000| tot_loss: 1.7808 | rl_loss: -0.0402 | pt_loss: 1.8210 | pg_loss: -0.2154 | reg_loss: 0.1752 | reward: -0.2675 | rev_kl: 0.2302 | stu_lens: 70.0000 | mixed_lens: 36.5000 | lr: 4.1194e-06 | scale: 2048.00 | time: 26.412 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1456/  5000| tot_loss: 3.2615 | rl_loss: 1.4921 | pt_loss: 1.7694 | pg_loss: 0.7346 | reg_loss: 0.7575 | reward: -0.9181 | rev_kl: 0.1972 | stu_lens: 67.0000 | mixed_lens: 21.5000 | lr: 4.1181e-06 | scale: 2048.00 | time: 26.427 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1456/  5000| tot_loss: 2.5679 | rl_loss: 0.8486 | pt_loss: 1.7193 | pg_loss: 0.2984 | reg_loss: 0.5502 | reward: -0.5187 | rev_kl: 1.1899 | stu_lens: 80.9688 | mixed_lens: 81.4531 | lr: 4.1181e-06 | scale: 2048.00 | time: 26.427 | step time: 27.671
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1457/  5000| tot_loss: 2.2496 | rl_loss: 0.6529 | pt_loss: 1.5967 | pg_loss: 0.0196 | reg_loss: 0.6333 | reward: -0.1844 | rev_kl: 1.0232 | stu_lens: 111.5000 | mixed_lens: 127.5000 | lr: 4.1169e-06 | scale: 2048.00 | time: 26.438 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1458/  5000| tot_loss: 2.3054 | rl_loss: 0.8380 | pt_loss: 1.4674 | pg_loss: 0.4430 | reg_loss: 0.3949 | reward: -1.8918 | rev_kl: 1.9906 | stu_lens: 71.0000 | mixed_lens: 72.0000 | lr: 4.1157e-06 | scale: 2048.00 | time: 26.411 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1459/  5000| tot_loss: 2.2121 | rl_loss: 0.4348 | pt_loss: 1.7773 | pg_loss: 0.0667 | reg_loss: 0.3681 | reward: -0.2145 | rev_kl: 1.1354 | stu_lens: 117.5000 | mixed_lens: 124.0000 | lr: 4.1145e-06 | scale: 2048.00 | time: 26.412 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1460/  5000| tot_loss: 2.4025 | rl_loss: 0.6017 | pt_loss: 1.8008 | pg_loss: 0.0323 | reg_loss: 0.5694 | reward: -0.1975 | rev_kl: 1.5904 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1132e-06 | scale: 2048.00 | time: 26.388 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1461/  5000| tot_loss: 2.4427 | rl_loss: 0.4984 | pt_loss: 1.9444 | pg_loss: 0.1655 | reg_loss: 0.3329 | reward: -0.7339 | rev_kl: 0.8992 | stu_lens: 86.0000 | mixed_lens: 82.0000 | lr: 4.1120e-06 | scale: 2048.00 | time: 26.391 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1462/  5000| tot_loss: 2.5199 | rl_loss: 0.7304 | pt_loss: 1.7895 | pg_loss: 0.3294 | reg_loss: 0.4010 | reward: -0.2644 | rev_kl: 0.8971 | stu_lens: 104.5000 | mixed_lens: 91.5000 | lr: 4.1108e-06 | scale: 2048.00 | time: 26.369 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1463/  5000| tot_loss: 2.1288 | rl_loss: 0.4010 | pt_loss: 1.7278 | pg_loss: -0.0055 | reg_loss: 0.4065 | reward: -0.1098 | rev_kl: 1.3643 | stu_lens: 126.5000 | mixed_lens: 128.0000 | lr: 4.1096e-06 | scale: 2048.00 | time: 26.388 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1464/  5000| tot_loss: 2.5822 | rl_loss: 1.0795 | pt_loss: 1.5027 | pg_loss: 0.5260 | reg_loss: 0.5535 | reward: -0.6122 | rev_kl: 1.3361 | stu_lens: 102.5000 | mixed_lens: 72.0000 | lr: 4.1083e-06 | scale: 2048.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1465/  5000| tot_loss: 3.1773 | rl_loss: 1.4646 | pt_loss: 1.7127 | pg_loss: 0.6432 | reg_loss: 0.8214 | reward: -2.5318 | rev_kl: 1.3764 | stu_lens: 82.0000 | mixed_lens: 59.0000 | lr: 4.1071e-06 | scale: 2048.00 | time: 26.382 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1466/  5000| tot_loss: 2.3363 | rl_loss: 0.6618 | pt_loss: 1.6744 | pg_loss: 0.0190 | reg_loss: 0.6429 | reward: -0.2259 | rev_kl: 1.6868 | stu_lens: 111.5000 | mixed_lens: 128.0000 | lr: 4.1059e-06 | scale: 2048.00 | time: 26.350 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1467/  5000| tot_loss: 3.2122 | rl_loss: 1.2840 | pt_loss: 1.9282 | pg_loss: 0.6668 | reg_loss: 0.6172 | reward: -1.2049 | rev_kl: 1.3139 | stu_lens: 91.0000 | mixed_lens: 59.0000 | lr: 4.1046e-06 | scale: 2048.00 | time: 26.365 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1468/  5000| tot_loss: 3.2224 | rl_loss: 1.1199 | pt_loss: 2.1025 | pg_loss: 0.3677 | reg_loss: 0.7522 | reward: -0.0359 | rev_kl: 0.7854 | stu_lens: 101.5000 | mixed_lens: 78.5000 | lr: 4.1034e-06 | scale: 2048.00 | time: 26.352 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1469/  5000| tot_loss: 3.0641 | rl_loss: 1.0097 | pt_loss: 2.0543 | pg_loss: 0.5631 | reg_loss: 0.4467 | reward: -0.7461 | rev_kl: 1.3134 | stu_lens: 35.5000 | mixed_lens: 38.5000 | lr: 4.1022e-06 | scale: 2048.00 | time: 26.378 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1470/  5000| tot_loss: 1.3360 | rl_loss: -0.0953 | pt_loss: 1.4313 | pg_loss: -0.2312 | reg_loss: 0.1359 | reward: -0.1689 | rev_kl: 0.1209 | stu_lens: 75.0000 | mixed_lens: 41.0000 | lr: 4.1010e-06 | scale: 2048.00 | time: 26.480 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1471/  5000| tot_loss: 2.3084 | rl_loss: 0.8007 | pt_loss: 1.5077 | pg_loss: 0.2740 | reg_loss: 0.5266 | reward: -1.0155 | rev_kl: 1.3667 | stu_lens: 76.0000 | mixed_lens: 75.5000 | lr: 4.0997e-06 | scale: 2048.00 | time: 26.398 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1472/  5000| tot_loss: 4.2105 | rl_loss: 2.3519 | pt_loss: 1.8586 | pg_loss: 1.9200 | reg_loss: 0.4319 | reward: -1.0791 | rev_kl: 0.1515 | stu_lens: 9.0000 | mixed_lens: 13.5000 | lr: 4.0985e-06 | scale: 2048.00 | time: 26.418 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1472/  5000| tot_loss: 2.5033 | rl_loss: 0.7833 | pt_loss: 1.7200 | pg_loss: 0.3115 | reg_loss: 0.4717 | reward: -0.5186 | rev_kl: 1.1975 | stu_lens: 87.5938 | mixed_lens: 86.7812 | lr: 4.0985e-06 | scale: 2048.00 | time: 26.418 | step time: 27.655
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1473/  5000| tot_loss: 0.9871 | rl_loss: -0.3272 | pt_loss: 1.3143 | pg_loss: -0.6608 | reg_loss: 0.3335 | reward: -0.4730 | rev_kl: 0.7404 | stu_lens: 19.0000 | mixed_lens: 17.0000 | lr: 4.0973e-06 | scale: 2048.00 | time: 26.433 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1474/  5000| tot_loss: 5.6454 | rl_loss: 3.8072 | pt_loss: 1.8383 | pg_loss: 2.3826 | reg_loss: 1.4246 | reward: -1.0762 | rev_kl: 0.9926 | stu_lens: 11.5000 | mixed_lens: 11.5000 | lr: 4.0960e-06 | scale: 2048.00 | time: 26.411 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1475/  5000| tot_loss: 3.1381 | rl_loss: 1.6257 | pt_loss: 1.5124 | pg_loss: 0.2061 | reg_loss: 1.4195 | reward: -0.4546 | rev_kl: 1.3339 | stu_lens: 75.5000 | mixed_lens: 114.0000 | lr: 4.0948e-06 | scale: 2048.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1476/  5000| tot_loss: 2.9757 | rl_loss: 1.4567 | pt_loss: 1.5191 | pg_loss: 0.1726 | reg_loss: 1.2841 | reward: -0.4065 | rev_kl: 1.0582 | stu_lens: 93.0000 | mixed_lens: 105.0000 | lr: 4.0936e-06 | scale: 2048.00 | time: 26.433 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1477/  5000| tot_loss: 3.3833 | rl_loss: 1.3855 | pt_loss: 1.9978 | pg_loss: 0.0385 | reg_loss: 1.3470 | reward: -0.2239 | rev_kl: 0.6214 | stu_lens: 99.0000 | mixed_lens: 128.0000 | lr: 4.0923e-06 | scale: 2048.00 | time: 26.405 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1478/  5000| tot_loss: 3.9270 | rl_loss: 2.0135 | pt_loss: 1.9135 | pg_loss: 0.2911 | reg_loss: 1.7224 | reward: -0.7608 | rev_kl: 1.7252 | stu_lens: 100.5000 | mixed_lens: 77.5000 | lr: 4.0911e-06 | scale: 2048.00 | time: 26.424 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1479/  5000| tot_loss: 3.3923 | rl_loss: 1.8898 | pt_loss: 1.5026 | pg_loss: 0.4891 | reg_loss: 1.4006 | reward: -0.4662 | rev_kl: 0.9018 | stu_lens: 89.5000 | mixed_lens: 69.5000 | lr: 4.0899e-06 | scale: 2048.00 | time: 26.413 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1480/  5000| tot_loss: 2.7964 | rl_loss: 1.5171 | pt_loss: 1.2793 | pg_loss: 0.3778 | reg_loss: 1.1394 | reward: -1.1795 | rev_kl: 1.1474 | stu_lens: 69.0000 | mixed_lens: 70.5000 | lr: 4.0886e-06 | scale: 2048.00 | time: 26.433 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1481/  5000| tot_loss: 3.8844 | rl_loss: 1.8683 | pt_loss: 2.0161 | pg_loss: 0.3979 | reg_loss: 1.4704 | reward: -2.4565 | rev_kl: 1.2926 | stu_lens: 128.0000 | mixed_lens: 68.0000 | lr: 4.0874e-06 | scale: 2048.00 | time: 26.377 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1482/  5000| tot_loss: 1.6101 | rl_loss: 0.6416 | pt_loss: 0.9685 | pg_loss: 0.2732 | reg_loss: 0.3684 | reward: -0.4651 | rev_kl: 0.9467 | stu_lens: 80.0000 | mixed_lens: 75.5000 | lr: 4.0861e-06 | scale: 2048.00 | time: 26.429 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1483/  5000| tot_loss: 2.3915 | rl_loss: 1.0209 | pt_loss: 1.3706 | pg_loss: 0.1163 | reg_loss: 0.9047 | reward: -0.1447 | rev_kl: 0.9404 | stu_lens: 125.5000 | mixed_lens: 97.0000 | lr: 4.0849e-06 | scale: 2048.00 | time: 26.399 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1484/  5000| tot_loss: 2.3141 | rl_loss: 1.1606 | pt_loss: 1.1534 | pg_loss: 0.1115 | reg_loss: 1.0491 | reward: -0.2298 | rev_kl: 1.6580 | stu_lens: 128.0000 | mixed_lens: 106.5000 | lr: 4.0837e-06 | scale: 2048.00 | time: 26.415 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1485/  5000| tot_loss: 3.7320 | rl_loss: 1.8553 | pt_loss: 1.8766 | pg_loss: 0.4222 | reg_loss: 1.4331 | reward: -0.5045 | rev_kl: 1.1723 | stu_lens: 55.0000 | mixed_lens: 88.0000 | lr: 4.0824e-06 | scale: 2048.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1486/  5000| tot_loss: 2.7941 | rl_loss: 1.6192 | pt_loss: 1.1749 | pg_loss: 0.0768 | reg_loss: 1.5424 | reward: -0.1953 | rev_kl: 0.8804 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.0812e-06 | scale: 2048.00 | time: 26.413 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1487/  5000| tot_loss: 2.6020 | rl_loss: 0.7785 | pt_loss: 1.8235 | pg_loss: 0.0154 | reg_loss: 0.7631 | reward: 0.6294 | rev_kl: 0.4954 | stu_lens: 64.0000 | mixed_lens: 69.5000 | lr: 4.0799e-06 | scale: 2048.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1488/  5000| tot_loss: 3.2382 | rl_loss: 1.5634 | pt_loss: 1.6748 | pg_loss: 0.0509 | reg_loss: 1.5125 | reward: -0.3304 | rev_kl: 1.5774 | stu_lens: 84.0000 | mixed_lens: 128.0000 | lr: 4.0787e-06 | scale: 2048.00 | time: 26.423 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1488/  5000| tot_loss: 3.0884 | rl_loss: 1.5085 | pt_loss: 1.5799 | pg_loss: 0.3563 | reg_loss: 1.1522 | reward: -0.4855 | rev_kl: 1.0903 | stu_lens: 83.8594 | mixed_lens: 83.6094 | lr: 4.0787e-06 | scale: 2048.00 | time: 26.423 | step time: 27.675
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1489/  5000| tot_loss: 3.8374 | rl_loss: 1.7892 | pt_loss: 2.0481 | pg_loss: 0.5475 | reg_loss: 1.2418 | reward: -0.6524 | rev_kl: 1.1897 | stu_lens: 71.5000 | mixed_lens: 71.5000 | lr: 4.0774e-06 | scale: 2048.00 | time: 26.394 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1490/  5000| tot_loss: 2.7836 | rl_loss: 1.0268 | pt_loss: 1.7568 | pg_loss: 0.1775 | reg_loss: 0.8493 | reward: -0.2880 | rev_kl: 1.3595 | stu_lens: 95.5000 | mixed_lens: 89.0000 | lr: 4.0762e-06 | scale: 2048.00 | time: 26.460 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1491/  5000| tot_loss: 2.5629 | rl_loss: 1.1030 | pt_loss: 1.4599 | pg_loss: 0.2208 | reg_loss: 0.8821 | reward: -0.5157 | rev_kl: 0.8649 | stu_lens: 72.5000 | mixed_lens: 94.0000 | lr: 4.0750e-06 | scale: 2048.00 | time: 26.404 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1492/  5000| tot_loss: 2.3362 | rl_loss: 0.7239 | pt_loss: 1.6123 | pg_loss: 0.2109 | reg_loss: 0.5130 | reward: -0.2417 | rev_kl: 0.8453 | stu_lens: 125.5000 | mixed_lens: 81.0000 | lr: 4.0737e-06 | scale: 2048.00 | time: 26.479 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1493/  5000| tot_loss: 2.9760 | rl_loss: 0.8921 | pt_loss: 2.0839 | pg_loss: 0.3201 | reg_loss: 0.5719 | reward: -0.2556 | rev_kl: 1.4426 | stu_lens: 75.0000 | mixed_lens: 73.5000 | lr: 4.0725e-06 | scale: 2048.00 | time: 26.408 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1494/  5000| tot_loss: 3.0114 | rl_loss: 1.1606 | pt_loss: 1.8509 | pg_loss: 0.2544 | reg_loss: 0.9061 | reward: -0.3546 | rev_kl: 1.0714 | stu_lens: 115.5000 | mixed_lens: 83.0000 | lr: 4.0712e-06 | scale: 2048.00 | time: 26.401 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1495/  5000| tot_loss: 3.1224 | rl_loss: 1.2769 | pt_loss: 1.8455 | pg_loss: 0.6285 | reg_loss: 0.6484 | reward: -0.4642 | rev_kl: 0.9535 | stu_lens: 37.0000 | mixed_lens: 64.5000 | lr: 4.0700e-06 | scale: 2048.00 | time: 26.411 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1496/  5000| tot_loss: 2.1447 | rl_loss: 0.8157 | pt_loss: 1.3290 | pg_loss: 0.0440 | reg_loss: 0.7717 | reward: -0.2704 | rev_kl: 0.9888 | stu_lens: 63.5000 | mixed_lens: 114.0000 | lr: 4.0687e-06 | scale: 2048.00 | time: 26.451 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1497/  5000| tot_loss: 2.1796 | rl_loss: 0.8438 | pt_loss: 1.3358 | pg_loss: 0.0210 | reg_loss: 0.8228 | reward: -0.2081 | rev_kl: 1.3748 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.0675e-06 | scale: 2048.00 | time: 26.433 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1498/  5000| tot_loss: 2.5864 | rl_loss: 0.7682 | pt_loss: 1.8182 | pg_loss: 0.0304 | reg_loss: 0.7378 | reward: -0.1841 | rev_kl: 1.2630 | stu_lens: 128.0000 | mixed_lens: 118.0000 | lr: 4.0662e-06 | scale: 2048.00 | time: 26.447 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1499/  5000| tot_loss: 2.8312 | rl_loss: 1.1093 | pt_loss: 1.7219 | pg_loss: 0.3149 | reg_loss: 0.7945 | reward: 0.5270 | rev_kl: 0.8294 | stu_lens: 82.0000 | mixed_lens: 69.5000 | lr: 4.0650e-06 | scale: 2048.00 | time: 26.410 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/1500
                                 Evaluation #15                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Bob should leave Alice, because his  │
│                                       │ chances of survival are 31% vs. 9%.  │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ It's a kezboard, not a keyboard.     │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support over 2000 languages.      │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.843 | exact_match: 0.215 | rev_kl: 1.162 | lens: 75.277 | pt_loss: 1.081 | lm_loss: 1.165 | kd_loss: 0.997 
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1500/  5000| tot_loss: 1.4706 | rl_loss: 0.1372 | pt_loss: 1.3334 | pg_loss: -0.0809 | reg_loss: 0.2181 | reward: -0.0011 | rev_kl: 0.6647 | stu_lens: 82.5000 | mixed_lens: 69.0000 | lr: 4.0637e-06 | scale: 2048.00 | time: 26.477 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1501/  5000| tot_loss: 2.6288 | rl_loss: 1.0197 | pt_loss: 1.6090 | pg_loss: 0.2382 | reg_loss: 0.7816 | reward: -0.3890 | rev_kl: 2.0288 | stu_lens: 96.5000 | mixed_lens: 84.0000 | lr: 4.0625e-06 | scale: 2048.00 | time: 26.420 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1502/  5000| tot_loss: 2.2774 | rl_loss: 0.7491 | pt_loss: 1.5283 | pg_loss: -0.0072 | reg_loss: 0.7563 | reward: -0.1690 | rev_kl: 0.7565 | stu_lens: 119.5000 | mixed_lens: 128.0000 | lr: 4.0612e-06 | scale: 2048.00 | time: 26.414 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1503/  5000| tot_loss: 2.7567 | rl_loss: 1.0753 | pt_loss: 1.6814 | pg_loss: 0.1750 | reg_loss: 0.9003 | reward: -0.3039 | rev_kl: 1.0511 | stu_lens: 128.0000 | mixed_lens: 94.0000 | lr: 4.0600e-06 | scale: 2048.00 | time: 26.438 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1504/  5000| tot_loss: 3.0751 | rl_loss: 1.5238 | pt_loss: 1.5513 | pg_loss: 0.7166 | reg_loss: 0.8072 | reward: -0.2414 | rev_kl: 1.1364 | stu_lens: 96.5000 | mixed_lens: 53.0000 | lr: 4.0587e-06 | scale: 2048.00 | time: 26.450 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1504/  5000| tot_loss: 2.8189 | rl_loss: 1.0828 | pt_loss: 1.7362 | pg_loss: 0.2866 | reg_loss: 0.7962 | reward: -0.4167 | rev_kl: 1.1245 | stu_lens: 86.8906 | mixed_lens: 87.4219 | lr: 4.0587e-06 | scale: 2048.00 | time: 26.450 | step time: 27.693
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1505/  5000| tot_loss: 2.7055 | rl_loss: 1.2084 | pt_loss: 1.4971 | pg_loss: 0.3391 | reg_loss: 0.8693 | reward: -0.4967 | rev_kl: 0.9402 | stu_lens: 102.0000 | mixed_lens: 96.0000 | lr: 4.0575e-06 | scale: 2048.00 | time: 26.501 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1506/  5000| tot_loss: 2.0082 | rl_loss: 0.4933 | pt_loss: 1.5149 | pg_loss: 0.1348 | reg_loss: 0.3585 | reward: -0.4337 | rev_kl: 0.7500 | stu_lens: 104.0000 | mixed_lens: 94.5000 | lr: 4.0562e-06 | scale: 2048.00 | time: 26.472 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1507/  5000| tot_loss: 2.3879 | rl_loss: 0.8416 | pt_loss: 1.5463 | pg_loss: 0.2594 | reg_loss: 0.5821 | reward: -0.3216 | rev_kl: 0.7547 | stu_lens: 128.0000 | mixed_lens: 94.0000 | lr: 4.0550e-06 | scale: 2048.00 | time: 26.414 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1508/  5000| tot_loss: 2.8889 | rl_loss: 0.9207 | pt_loss: 1.9682 | pg_loss: 0.3248 | reg_loss: 0.5959 | reward: -0.4454 | rev_kl: 0.9575 | stu_lens: 67.5000 | mixed_lens: 82.0000 | lr: 4.0537e-06 | scale: 2048.00 | time: 26.430 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1509/  5000| tot_loss: 2.2319 | rl_loss: 0.6166 | pt_loss: 1.6153 | pg_loss: 0.0151 | reg_loss: 0.6015 | reward: -0.2037 | rev_kl: 1.0289 | stu_lens: 99.0000 | mixed_lens: 128.0000 | lr: 4.0525e-06 | scale: 2048.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1510/  5000| tot_loss: 2.2712 | rl_loss: 0.5814 | pt_loss: 1.6898 | pg_loss: 0.0065 | reg_loss: 0.5749 | reward: -0.1704 | rev_kl: 1.1474 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.0512e-06 | scale: 2048.00 | time: 26.415 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1511/  5000| tot_loss: 2.7597 | rl_loss: 1.0589 | pt_loss: 1.7008 | pg_loss: 0.3173 | reg_loss: 0.7416 | reward: -0.6743 | rev_kl: 1.1733 | stu_lens: 48.0000 | mixed_lens: 72.5000 | lr: 4.0499e-06 | scale: 2048.00 | time: 26.385 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1512/  5000| tot_loss: 2.1454 | rl_loss: 0.3447 | pt_loss: 1.8007 | pg_loss: 0.1840 | reg_loss: 0.1607 | reward: -1.1538 | rev_kl: 0.6618 | stu_lens: 69.0000 | mixed_lens: 70.5000 | lr: 4.0487e-06 | scale: 2048.00 | time: 26.420 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1513/  5000| tot_loss: 2.6483 | rl_loss: 0.8918 | pt_loss: 1.7565 | pg_loss: 0.5206 | reg_loss: 0.3712 | reward: -0.5436 | rev_kl: 1.2611 | stu_lens: 89.5000 | mixed_lens: 69.5000 | lr: 4.0474e-06 | scale: 2048.00 | time: 26.398 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1514/  5000| tot_loss: 2.5497 | rl_loss: 0.7548 | pt_loss: 1.7949 | pg_loss: 0.2714 | reg_loss: 0.4834 | reward: -0.5817 | rev_kl: 1.3665 | stu_lens: 92.0000 | mixed_lens: 73.5000 | lr: 4.0462e-06 | scale: 2048.00 | time: 26.417 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1515/  5000| tot_loss: 2.2475 | rl_loss: 0.6536 | pt_loss: 1.5939 | pg_loss: 0.3124 | reg_loss: 0.3411 | reward: -0.4566 | rev_kl: 0.7329 | stu_lens: 51.0000 | mixed_lens: 81.0000 | lr: 4.0449e-06 | scale: 2048.00 | time: 26.375 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1516/  5000| tot_loss: 2.9056 | rl_loss: 0.8213 | pt_loss: 2.0843 | pg_loss: 0.1802 | reg_loss: 0.6411 | reward: -0.3173 | rev_kl: 1.4166 | stu_lens: 107.5000 | mixed_lens: 104.5000 | lr: 4.0436e-06 | scale: 2048.00 | time: 26.404 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1517/  5000| tot_loss: 2.3191 | rl_loss: 0.5442 | pt_loss: 1.7748 | pg_loss: 0.0501 | reg_loss: 0.4941 | reward: -0.3241 | rev_kl: 1.7162 | stu_lens: 110.5000 | mixed_lens: 118.0000 | lr: 4.0424e-06 | scale: 2048.00 | time: 26.373 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1518/  5000| tot_loss: 2.4753 | rl_loss: 0.8579 | pt_loss: 1.6173 | pg_loss: 0.0504 | reg_loss: 0.8075 | reward: -0.3291 | rev_kl: 1.8144 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.0411e-06 | scale: 2048.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1519/  5000| tot_loss: 2.2219 | rl_loss: 0.3485 | pt_loss: 1.8734 | pg_loss: 0.0996 | reg_loss: 0.2488 | reward: -0.1100 | rev_kl: 0.8604 | stu_lens: 102.0000 | mixed_lens: 58.0000 | lr: 4.0399e-06 | scale: 2048.00 | time: 26.391 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1520/  5000| tot_loss: 2.1344 | rl_loss: 0.7009 | pt_loss: 1.4336 | pg_loss: 0.2879 | reg_loss: 0.4130 | reward: -0.4939 | rev_kl: 2.1238 | stu_lens: 59.0000 | mixed_lens: 101.0000 | lr: 4.0386e-06 | scale: 2048.00 | time: 26.407 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1520/  5000| tot_loss: 2.4209 | rl_loss: 0.7467 | pt_loss: 1.6742 | pg_loss: 0.2327 | reg_loss: 0.5141 | reward: -0.5436 | rev_kl: 1.0962 | stu_lens: 88.7344 | mixed_lens: 85.1562 | lr: 4.0386e-06 | scale: 2048.00 | time: 26.407 | step time: 27.675
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1521/  5000| tot_loss: 3.1479 | rl_loss: 1.1220 | pt_loss: 2.0259 | pg_loss: 0.4071 | reg_loss: 0.7149 | reward: -0.9098 | rev_kl: 0.8232 | stu_lens: 73.5000 | mixed_lens: 85.0000 | lr: 4.0373e-06 | scale: 2048.00 | time: 26.434 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1522/  5000| tot_loss: 1.5712 | rl_loss: 0.3540 | pt_loss: 1.2172 | pg_loss: 0.0662 | reg_loss: 0.2878 | reward: -0.4082 | rev_kl: 0.9036 | stu_lens: 100.0000 | mixed_lens: 119.0000 | lr: 4.0361e-06 | scale: 2048.00 | time: 26.455 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1523/  5000| tot_loss: 2.4371 | rl_loss: 0.5868 | pt_loss: 1.8504 | pg_loss: 0.2193 | reg_loss: 0.3675 | reward: -0.1701 | rev_kl: 0.8929 | stu_lens: 46.0000 | mixed_lens: 73.5000 | lr: 4.0348e-06 | scale: 2048.00 | time: 26.437 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1524/  5000| tot_loss: 2.5634 | rl_loss: 0.7066 | pt_loss: 1.8569 | pg_loss: 0.2121 | reg_loss: 0.4945 | reward: -0.4628 | rev_kl: 1.3915 | stu_lens: 112.5000 | mixed_lens: 94.5000 | lr: 4.0335e-06 | scale: 2048.00 | time: 26.454 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1525/  5000| tot_loss: 2.0942 | rl_loss: 0.6665 | pt_loss: 1.4277 | pg_loss: 0.2591 | reg_loss: 0.4074 | reward: -0.4034 | rev_kl: 1.3512 | stu_lens: 41.0000 | mixed_lens: 100.0000 | lr: 4.0323e-06 | scale: 2048.00 | time: 26.419 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1526/  5000| tot_loss: 1.8832 | rl_loss: 0.5898 | pt_loss: 1.2934 | pg_loss: 0.1927 | reg_loss: 0.3971 | reward: -0.3177 | rev_kl: 0.8648 | stu_lens: 102.0000 | mixed_lens: 93.5000 | lr: 4.0310e-06 | scale: 2048.00 | time: 26.440 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1527/  5000| tot_loss: 2.2676 | rl_loss: 0.6274 | pt_loss: 1.6402 | pg_loss: 0.3499 | reg_loss: 0.2775 | reward: -0.3877 | rev_kl: 0.8610 | stu_lens: 66.0000 | mixed_lens: 30.5000 | lr: 4.0297e-06 | scale: 2048.00 | time: 26.442 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1528/  5000| tot_loss: 2.9710 | rl_loss: 1.2682 | pt_loss: 1.7028 | pg_loss: 0.4093 | reg_loss: 0.8589 | reward: -0.7011 | rev_kl: 1.0995 | stu_lens: 79.5000 | mixed_lens: 28.5000 | lr: 4.0285e-06 | scale: 2048.00 | time: 26.504 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1529/  5000| tot_loss: 1.8359 | rl_loss: 0.3334 | pt_loss: 1.5025 | pg_loss: 0.0222 | reg_loss: 0.3112 | reward: -0.2983 | rev_kl: 1.1307 | stu_lens: 91.5000 | mixed_lens: 126.0000 | lr: 4.0272e-06 | scale: 2048.00 | time: 26.417 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1530/  5000| tot_loss: 2.2559 | rl_loss: 0.5934 | pt_loss: 1.6624 | pg_loss: 0.1572 | reg_loss: 0.4362 | reward: -0.1419 | rev_kl: 1.6506 | stu_lens: 116.5000 | mixed_lens: 94.5000 | lr: 4.0259e-06 | scale: 2048.00 | time: 26.438 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1531/  5000| tot_loss: 2.9292 | rl_loss: 0.9184 | pt_loss: 2.0108 | pg_loss: 0.2747 | reg_loss: 0.6437 | reward: -0.4130 | rev_kl: 1.7295 | stu_lens: 128.0000 | mixed_lens: 94.0000 | lr: 4.0247e-06 | scale: 2048.00 | time: 26.414 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1532/  5000| tot_loss: 2.5878 | rl_loss: 0.4468 | pt_loss: 2.1409 | pg_loss: 0.1029 | reg_loss: 0.3439 | reward: -0.3847 | rev_kl: 1.4230 | stu_lens: 84.0000 | mixed_lens: 112.0000 | lr: 4.0234e-06 | scale: 2048.00 | time: 26.437 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1533/  5000| tot_loss: 2.4591 | rl_loss: 0.3620 | pt_loss: 2.0971 | pg_loss: 0.0329 | reg_loss: 0.3291 | reward: -0.3313 | rev_kl: 0.8375 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.0221e-06 | scale: 2048.00 | time: 26.416 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1534/  5000| tot_loss: 3.9514 | rl_loss: 2.2098 | pt_loss: 1.7416 | pg_loss: 1.5893 | reg_loss: 0.6205 | reward: -0.5164 | rev_kl: 1.0772 | stu_lens: 18.5000 | mixed_lens: 20.0000 | lr: 4.0208e-06 | scale: 2048.00 | time: 26.423 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1535/  5000| tot_loss: 2.0369 | rl_loss: 0.5157 | pt_loss: 1.5212 | pg_loss: 0.1793 | reg_loss: 0.3364 | reward: -1.0210 | rev_kl: 1.0662 | stu_lens: 72.0000 | mixed_lens: 72.5000 | lr: 4.0196e-06 | scale: 2048.00 | time: 26.422 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1536/  5000| tot_loss: 2.2437 | rl_loss: 0.5249 | pt_loss: 1.7188 | pg_loss: 0.0633 | reg_loss: 0.4616 | reward: -0.2432 | rev_kl: 1.2053 | stu_lens: 128.0000 | mixed_lens: 125.5000 | lr: 4.0183e-06 | scale: 2048.00 | time: 26.475 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1536/  5000| tot_loss: 2.4903 | rl_loss: 0.7821 | pt_loss: 1.7082 | pg_loss: 0.3039 | reg_loss: 0.4782 | reward: -0.4804 | rev_kl: 1.1101 | stu_lens: 89.3438 | mixed_lens: 87.8125 | lr: 4.0183e-06 | scale: 2048.00 | time: 26.475 | step time: 27.702
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1537/  5000| tot_loss: 2.0121 | rl_loss: 0.5121 | pt_loss: 1.5000 | pg_loss: 0.3448 | reg_loss: 0.1673 | reward: -0.4294 | rev_kl: 0.8728 | stu_lens: 80.0000 | mixed_lens: 75.5000 | lr: 4.0170e-06 | scale: 2048.00 | time: 26.403 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1538/  5000| tot_loss: 3.2479 | rl_loss: 1.5731 | pt_loss: 1.6749 | pg_loss: 0.5937 | reg_loss: 0.9794 | reward: -0.2082 | rev_kl: 1.3288 | stu_lens: 53.0000 | mixed_lens: 61.5000 | lr: 4.0158e-06 | scale: 2048.00 | time: 26.448 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1539/  5000| tot_loss: 2.8414 | rl_loss: 1.1935 | pt_loss: 1.6478 | pg_loss: 0.1418 | reg_loss: 1.0517 | reward: -0.2916 | rev_kl: 0.9814 | stu_lens: 73.0000 | mixed_lens: 74.0000 | lr: 4.0145e-06 | scale: 2048.00 | time: 26.461 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1540/  5000| tot_loss: 3.8606 | rl_loss: 2.0553 | pt_loss: 1.8053 | pg_loss: 0.6927 | reg_loss: 1.3626 | reward: -2.4104 | rev_kl: 0.9189 | stu_lens: 65.0000 | mixed_lens: 65.0000 | lr: 4.0132e-06 | scale: 2048.00 | time: 26.460 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1541/  5000| tot_loss: 2.8690 | rl_loss: 1.2567 | pt_loss: 1.6124 | pg_loss: 0.0559 | reg_loss: 1.2007 | reward: -0.2031 | rev_kl: 1.0228 | stu_lens: 110.0000 | mixed_lens: 128.0000 | lr: 4.0119e-06 | scale: 2048.00 | time: 26.451 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1542/  5000| tot_loss: 2.6911 | rl_loss: 1.0168 | pt_loss: 1.6743 | pg_loss: 0.1937 | reg_loss: 0.8231 | reward: -0.3329 | rev_kl: 0.8960 | stu_lens: 121.5000 | mixed_lens: 102.0000 | lr: 4.0106e-06 | scale: 2048.00 | time: 26.409 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1543/  5000| tot_loss: 3.5470 | rl_loss: 2.0405 | pt_loss: 1.5064 | pg_loss: 0.5275 | reg_loss: 1.5130 | reward: -0.5830 | rev_kl: 1.2537 | stu_lens: 74.5000 | mixed_lens: 78.5000 | lr: 4.0094e-06 | scale: 2048.00 | time: 26.522 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1544/  5000| tot_loss: 4.0330 | rl_loss: 2.5112 | pt_loss: 1.5217 | pg_loss: 1.3380 | reg_loss: 1.1733 | reward: -0.6245 | rev_kl: 0.7727 | stu_lens: 13.5000 | mixed_lens: 19.0000 | lr: 4.0081e-06 | scale: 2048.00 | time: 26.656 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1545/  5000| tot_loss: 3.3474 | rl_loss: 1.8318 | pt_loss: 1.5156 | pg_loss: 0.7481 | reg_loss: 1.0836 | reward: -0.2818 | rev_kl: 0.3551 | stu_lens: 43.5000 | mixed_lens: 44.5000 | lr: 4.0068e-06 | scale: 2048.00 | time: 26.433 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1546/  5000| tot_loss: 2.5842 | rl_loss: 1.3602 | pt_loss: 1.2240 | pg_loss: 0.1604 | reg_loss: 1.1998 | reward: -0.3350 | rev_kl: 1.0689 | stu_lens: 92.5000 | mixed_lens: 91.5000 | lr: 4.0055e-06 | scale: 2048.00 | time: 26.495 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1547/  5000| tot_loss: 4.5523 | rl_loss: 2.7604 | pt_loss: 1.7919 | pg_loss: 1.6075 | reg_loss: 1.1529 | reward: -1.1024 | rev_kl: 1.3151 | stu_lens: 28.5000 | mixed_lens: 26.0000 | lr: 4.0043e-06 | scale: 2048.00 | time: 26.427 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1548/  5000| tot_loss: 2.9923 | rl_loss: 1.3892 | pt_loss: 1.6031 | pg_loss: 0.2237 | reg_loss: 1.1655 | reward: -0.3000 | rev_kl: 1.2884 | stu_lens: 89.0000 | mixed_lens: 93.5000 | lr: 4.0030e-06 | scale: 2048.00 | time: 26.478 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1549/  5000| tot_loss: 3.7591 | rl_loss: 1.9177 | pt_loss: 1.8414 | pg_loss: 0.9110 | reg_loss: 1.0067 | reward: -0.3003 | rev_kl: 0.8449 | stu_lens: 91.0000 | mixed_lens: 54.0000 | lr: 4.0017e-06 | scale: 2048.00 | time: 26.512 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1550/  5000| tot_loss: 3.7161 | rl_loss: 1.7076 | pt_loss: 2.0085 | pg_loss: 0.4843 | reg_loss: 1.2232 | reward: 0.5777 | rev_kl: 1.1424 | stu_lens: 83.5000 | mixed_lens: 66.5000 | lr: 4.0004e-06 | scale: 2048.00 | time: 26.483 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1551/  5000| tot_loss: 3.4097 | rl_loss: 1.6996 | pt_loss: 1.7101 | pg_loss: 0.0962 | reg_loss: 1.6034 | reward: -0.3417 | rev_kl: 1.4001 | stu_lens: 128.0000 | mixed_lens: 112.0000 | lr: 3.9991e-06 | scale: 2048.00 | time: 26.438 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1552/  5000| tot_loss: 3.5980 | rl_loss: 1.7516 | pt_loss: 1.8464 | pg_loss: 0.2135 | reg_loss: 1.5381 | reward: -0.4636 | rev_kl: 0.9083 | stu_lens: 70.5000 | mixed_lens: 102.0000 | lr: 3.9978e-06 | scale: 2048.00 | time: 26.481 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1552/  5000| tot_loss: 3.2544 | rl_loss: 1.5551 | pt_loss: 1.6993 | pg_loss: 0.4787 | reg_loss: 1.0764 | reward: -0.5124 | rev_kl: 1.0488 | stu_lens: 79.7344 | mixed_lens: 79.3594 | lr: 3.9978e-06 | scale: 2048.00 | time: 26.481 | step time: 27.732
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1553/  5000| tot_loss: 2.5245 | rl_loss: 0.7935 | pt_loss: 1.7310 | pg_loss: 0.0466 | reg_loss: 0.7469 | reward: -0.2964 | rev_kl: 0.8443 | stu_lens: 107.0000 | mixed_lens: 128.0000 | lr: 3.9966e-06 | scale: 2048.00 | time: 26.455 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1554/  5000| tot_loss: 2.5501 | rl_loss: 0.9504 | pt_loss: 1.5998 | pg_loss: 0.3345 | reg_loss: 0.6159 | reward: -0.4940 | rev_kl: 1.0691 | stu_lens: 73.0000 | mixed_lens: 73.0000 | lr: 3.9953e-06 | scale: 2048.00 | time: 26.468 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1555/  5000| tot_loss: 2.3020 | rl_loss: 0.5573 | pt_loss: 1.7447 | pg_loss: 0.2784 | reg_loss: 0.2788 | reward: -0.2522 | rev_kl: 1.0556 | stu_lens: 128.0000 | mixed_lens: 94.0000 | lr: 3.9940e-06 | scale: 2048.00 | time: 26.439 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1556/  5000| tot_loss: 5.7899 | rl_loss: 3.2856 | pt_loss: 2.5042 | pg_loss: 1.8701 | reg_loss: 1.4155 | reward: -2.0722 | rev_kl: 1.3098 | stu_lens: 26.5000 | mixed_lens: 15.0000 | lr: 3.9927e-06 | scale: 2048.00 | time: 26.460 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1557/  5000| tot_loss: 3.5527 | rl_loss: 1.6299 | pt_loss: 1.9227 | pg_loss: 1.1701 | reg_loss: 0.4598 | reward: -0.4188 | rev_kl: 0.2089 | stu_lens: 68.0000 | mixed_lens: 31.5000 | lr: 3.9914e-06 | scale: 2048.00 | time: 26.428 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1558/  5000| tot_loss: 2.1301 | rl_loss: 0.7645 | pt_loss: 1.3656 | pg_loss: 0.1328 | reg_loss: 0.6317 | reward: -0.3887 | rev_kl: 1.2447 | stu_lens: 84.5000 | mixed_lens: 91.5000 | lr: 3.9901e-06 | scale: 2048.00 | time: 26.450 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1559/  5000| tot_loss: 2.4713 | rl_loss: 0.8417 | pt_loss: 1.6296 | pg_loss: 0.1111 | reg_loss: 0.7306 | reward: -0.2302 | rev_kl: 0.8914 | stu_lens: 84.0000 | mixed_lens: 109.0000 | lr: 3.9888e-06 | scale: 2048.00 | time: 26.414 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1560/  5000| tot_loss: 2.4638 | rl_loss: 0.6506 | pt_loss: 1.8132 | pg_loss: 0.0672 | reg_loss: 0.5834 | reward: -0.3728 | rev_kl: 0.8901 | stu_lens: 88.0000 | mixed_lens: 121.5000 | lr: 3.9876e-06 | scale: 2048.00 | time: 26.460 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1561/  5000| tot_loss: 2.8256 | rl_loss: 1.3936 | pt_loss: 1.4320 | pg_loss: 0.5518 | reg_loss: 0.8418 | reward: -0.5666 | rev_kl: 0.4037 | stu_lens: 39.0000 | mixed_lens: 67.5000 | lr: 3.9863e-06 | scale: 2048.00 | time: 26.466 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1562/  5000| tot_loss: 2.5964 | rl_loss: 0.7298 | pt_loss: 1.8666 | pg_loss: 0.0236 | reg_loss: 0.7061 | reward: -0.1986 | rev_kl: 0.7685 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.9850e-06 | scale: 2048.00 | time: 26.453 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1563/  5000| tot_loss: 2.8934 | rl_loss: 1.0958 | pt_loss: 1.7976 | pg_loss: 0.4480 | reg_loss: 0.6478 | reward: -0.8637 | rev_kl: 1.4733 | stu_lens: 51.0000 | mixed_lens: 70.5000 | lr: 3.9837e-06 | scale: 2048.00 | time: 26.449 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1564/  5000| tot_loss: 2.4704 | rl_loss: 0.8428 | pt_loss: 1.6276 | pg_loss: 0.1638 | reg_loss: 0.6791 | reward: -0.3015 | rev_kl: 0.8900 | stu_lens: 100.5000 | mixed_lens: 102.0000 | lr: 3.9824e-06 | scale: 2048.00 | time: 26.431 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1565/  5000| tot_loss: 2.4612 | rl_loss: 1.0776 | pt_loss: 1.3837 | pg_loss: 0.2450 | reg_loss: 0.8325 | reward: -0.7488 | rev_kl: 1.5752 | stu_lens: 67.0000 | mixed_lens: 74.5000 | lr: 3.9811e-06 | scale: 2048.00 | time: 26.438 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1566/  5000| tot_loss: 3.1105 | rl_loss: 1.5590 | pt_loss: 1.5515 | pg_loss: 0.6258 | reg_loss: 0.9331 | reward: -0.3295 | rev_kl: 1.1809 | stu_lens: 103.0000 | mixed_lens: 48.0000 | lr: 3.9798e-06 | scale: 2048.00 | time: 26.448 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1567/  5000| tot_loss: 2.0748 | rl_loss: 0.4838 | pt_loss: 1.5911 | pg_loss: -0.0050 | reg_loss: 0.4888 | reward: -0.3932 | rev_kl: 0.7176 | stu_lens: 107.0000 | mixed_lens: 128.0000 | lr: 3.9785e-06 | scale: 2048.00 | time: 26.452 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1568/  5000| tot_loss: 2.8000 | rl_loss: 0.9718 | pt_loss: 1.8282 | pg_loss: 0.2752 | reg_loss: 0.6965 | reward: -0.2415 | rev_kl: 1.0422 | stu_lens: 76.5000 | mixed_lens: 82.0000 | lr: 3.9772e-06 | scale: 2048.00 | time: 26.500 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1568/  5000| tot_loss: 2.7782 | rl_loss: 1.0665 | pt_loss: 1.7117 | pg_loss: 0.3804 | reg_loss: 0.6861 | reward: -0.4434 | rev_kl: 1.0396 | stu_lens: 81.0625 | mixed_lens: 81.9531 | lr: 3.9772e-06 | scale: 2048.00 | time: 26.500 | step time: 27.711
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1569/  5000| tot_loss: 2.6971 | rl_loss: 0.7955 | pt_loss: 1.9016 | pg_loss: 0.0681 | reg_loss: 0.7274 | reward: -0.2057 | rev_kl: 0.4587 | stu_lens: 114.0000 | mixed_lens: 116.5000 | lr: 3.9759e-06 | scale: 2048.00 | time: 26.495 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1570/  5000| tot_loss: 1.8956 | rl_loss: 0.7688 | pt_loss: 1.1269 | pg_loss: 0.2805 | reg_loss: 0.4883 | reward: -0.3784 | rev_kl: 1.4179 | stu_lens: 86.0000 | mixed_lens: 83.5000 | lr: 3.9746e-06 | scale: 2048.00 | time: 26.519 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1571/  5000| tot_loss: 2.9487 | rl_loss: 0.9157 | pt_loss: 2.0329 | pg_loss: 0.3177 | reg_loss: 0.5980 | reward: -0.6072 | rev_kl: 0.6564 | stu_lens: 52.0000 | mixed_lens: 79.5000 | lr: 3.9734e-06 | scale: 2048.00 | time: 26.501 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1572/  5000| tot_loss: 2.7234 | rl_loss: 0.8955 | pt_loss: 1.8279 | pg_loss: 0.1617 | reg_loss: 0.7338 | reward: -0.2992 | rev_kl: 1.1831 | stu_lens: 126.0000 | mixed_lens: 99.0000 | lr: 3.9721e-06 | scale: 2048.00 | time: 26.486 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1573/  5000| tot_loss: 2.5633 | rl_loss: 1.4635 | pt_loss: 1.0998 | pg_loss: 0.8660 | reg_loss: 0.5974 | reward: -0.4433 | rev_kl: 1.6012 | stu_lens: 45.0000 | mixed_lens: 55.5000 | lr: 3.9708e-06 | scale: 2048.00 | time: 26.468 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1574/  5000| tot_loss: 2.4590 | rl_loss: 0.5592 | pt_loss: 1.8998 | pg_loss: 0.2556 | reg_loss: 0.3035 | reward: -0.4832 | rev_kl: 0.8000 | stu_lens: 114.5000 | mixed_lens: 85.0000 | lr: 3.9695e-06 | scale: 2048.00 | time: 26.485 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1575/  5000| tot_loss: 3.1609 | rl_loss: 1.7799 | pt_loss: 1.3809 | pg_loss: 1.1007 | reg_loss: 0.6792 | reward: -0.7148 | rev_kl: 1.5263 | stu_lens: 42.0000 | mixed_lens: 38.5000 | lr: 3.9682e-06 | scale: 2048.00 | time: 26.449 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1576/  5000| tot_loss: 2.9856 | rl_loss: 1.5188 | pt_loss: 1.4668 | pg_loss: 0.8428 | reg_loss: 0.6759 | reward: -0.2448 | rev_kl: 1.3331 | stu_lens: 74.5000 | mixed_lens: 46.0000 | lr: 3.9669e-06 | scale: 2048.00 | time: 26.473 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1577/  5000| tot_loss: 2.7368 | rl_loss: 1.2599 | pt_loss: 1.4769 | pg_loss: 0.7049 | reg_loss: 0.5550 | reward: -2.4686 | rev_kl: 0.5833 | stu_lens: 37.5000 | mixed_lens: 39.0000 | lr: 3.9656e-06 | scale: 2048.00 | time: 26.407 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1578/  5000| tot_loss: 2.6654 | rl_loss: 0.8466 | pt_loss: 1.8188 | pg_loss: 0.2048 | reg_loss: 0.6418 | reward: -0.4184 | rev_kl: 0.8489 | stu_lens: 77.0000 | mixed_lens: 105.5000 | lr: 3.9643e-06 | scale: 2048.00 | time: 26.424 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1579/  5000| tot_loss: 1.8607 | rl_loss: 0.4585 | pt_loss: 1.4022 | pg_loss: 0.2499 | reg_loss: 0.2086 | reward: -0.2522 | rev_kl: 1.0556 | stu_lens: 128.0000 | mixed_lens: 94.0000 | lr: 3.9630e-06 | scale: 2048.00 | time: 26.393 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1580/  5000| tot_loss: 2.1652 | rl_loss: 0.5732 | pt_loss: 1.5920 | pg_loss: 0.2356 | reg_loss: 0.3375 | reward: -0.1347 | rev_kl: 0.3128 | stu_lens: 57.0000 | mixed_lens: 97.0000 | lr: 3.9617e-06 | scale: 2048.00 | time: 26.429 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1581/  5000| tot_loss: 2.4735 | rl_loss: 0.5298 | pt_loss: 1.9437 | pg_loss: 0.2735 | reg_loss: 0.2563 | reward: -0.3014 | rev_kl: 0.4497 | stu_lens: 71.0000 | mixed_lens: 70.5000 | lr: 3.9604e-06 | scale: 2048.00 | time: 26.423 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1582/  5000| tot_loss: 2.9315 | rl_loss: 1.2544 | pt_loss: 1.6772 | pg_loss: 0.4658 | reg_loss: 0.7886 | reward: -0.8476 | rev_kl: 1.0402 | stu_lens: 79.0000 | mixed_lens: 69.5000 | lr: 3.9591e-06 | scale: 2048.00 | time: 26.448 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1583/  5000| tot_loss: 2.4732 | rl_loss: 0.5730 | pt_loss: 1.9002 | pg_loss: 0.0481 | reg_loss: 0.5249 | reward: -0.3559 | rev_kl: 0.8213 | stu_lens: 67.0000 | mixed_lens: 121.5000 | lr: 3.9578e-06 | scale: 2048.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1584/  5000| tot_loss: 1.8219 | rl_loss: 0.3790 | pt_loss: 1.4430 | pg_loss: 0.0398 | reg_loss: 0.3391 | reward: -0.1472 | rev_kl: 1.0005 | stu_lens: 120.0000 | mixed_lens: 128.0000 | lr: 3.9565e-06 | scale: 2048.00 | time: 26.435 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1584/  5000| tot_loss: 2.6145 | rl_loss: 0.9132 | pt_loss: 1.7013 | pg_loss: 0.4138 | reg_loss: 0.4994 | reward: -0.5523 | rev_kl: 1.0043 | stu_lens: 78.6875 | mixed_lens: 79.1562 | lr: 3.9565e-06 | scale: 2048.00 | time: 26.435 | step time: 27.712
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1585/  5000| tot_loss: 2.3063 | rl_loss: 0.6821 | pt_loss: 1.6242 | pg_loss: 0.1063 | reg_loss: 0.5758 | reward: -0.3252 | rev_kl: 1.2903 | stu_lens: 118.5000 | mixed_lens: 112.0000 | lr: 3.9552e-06 | scale: 2048.00 | time: 26.450 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1586/  5000| tot_loss: 1.8378 | rl_loss: 0.4327 | pt_loss: 1.4050 | pg_loss: 0.1599 | reg_loss: 0.2728 | reward: -0.1165 | rev_kl: 1.0017 | stu_lens: 115.5000 | mixed_lens: 109.0000 | lr: 3.9539e-06 | scale: 2048.00 | time: 26.524 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1587/  5000| tot_loss: 2.0709 | rl_loss: 0.5648 | pt_loss: 1.5061 | pg_loss: 0.4264 | reg_loss: 0.1384 | reward: -0.2740 | rev_kl: 1.0906 | stu_lens: 103.0000 | mixed_lens: 65.5000 | lr: 3.9526e-06 | scale: 2048.00 | time: 26.418 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1588/  5000| tot_loss: 2.4637 | rl_loss: 0.4969 | pt_loss: 1.9668 | pg_loss: -0.0049 | reg_loss: 0.5018 | reward: -0.0628 | rev_kl: 1.2764 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.9512e-06 | scale: 2048.00 | time: 26.490 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1589/  5000| tot_loss: 2.1409 | rl_loss: 0.4339 | pt_loss: 1.7070 | pg_loss: 0.1405 | reg_loss: 0.2935 | reward: -0.3329 | rev_kl: 0.8960 | stu_lens: 121.5000 | mixed_lens: 102.0000 | lr: 3.9499e-06 | scale: 2048.00 | time: 26.457 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1590/  5000| tot_loss: 3.8286 | rl_loss: 1.8700 | pt_loss: 1.9586 | pg_loss: 1.3245 | reg_loss: 0.5455 | reward: -0.9327 | rev_kl: 1.3692 | stu_lens: 21.5000 | mixed_lens: 19.5000 | lr: 3.9486e-06 | scale: 2048.00 | time: 26.492 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1591/  5000| tot_loss: 2.7705 | rl_loss: 0.7014 | pt_loss: 2.0691 | pg_loss: 0.1696 | reg_loss: 0.5318 | reward: -0.3130 | rev_kl: 0.6383 | stu_lens: 128.0000 | mixed_lens: 99.0000 | lr: 3.9473e-06 | scale: 2048.00 | time: 26.461 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1592/  5000| tot_loss: 2.1581 | rl_loss: 0.5464 | pt_loss: 1.6117 | pg_loss: 0.1567 | reg_loss: 0.3896 | reward: -0.3165 | rev_kl: 1.3982 | stu_lens: 98.5000 | mixed_lens: 93.5000 | lr: 3.9460e-06 | scale: 2048.00 | time: 26.520 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1593/  5000| tot_loss: 2.4410 | rl_loss: 0.5483 | pt_loss: 1.8927 | pg_loss: 0.0545 | reg_loss: 0.4938 | reward: -0.3531 | rev_kl: 1.2161 | stu_lens: 88.0000 | mixed_lens: 121.5000 | lr: 3.9447e-06 | scale: 2048.00 | time: 26.447 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1594/  5000| tot_loss: 1.9577 | rl_loss: 0.2689 | pt_loss: 1.6887 | pg_loss: 0.0477 | reg_loss: 0.2212 | reward: -0.4185 | rev_kl: 1.1670 | stu_lens: 105.5000 | mixed_lens: 119.0000 | lr: 3.9434e-06 | scale: 2048.00 | time: 26.467 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1595/  5000| tot_loss: 2.9285 | rl_loss: 1.0261 | pt_loss: 1.9025 | pg_loss: 0.4375 | reg_loss: 0.5886 | reward: 0.5742 | rev_kl: 1.2463 | stu_lens: 81.5000 | mixed_lens: 55.0000 | lr: 3.9421e-06 | scale: 2048.00 | time: 26.429 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1596/  5000| tot_loss: 3.2724 | rl_loss: 1.5989 | pt_loss: 1.6735 | pg_loss: 1.2037 | reg_loss: 0.3952 | reward: -0.8198 | rev_kl: 1.2658 | stu_lens: 67.0000 | mixed_lens: 41.5000 | lr: 3.9408e-06 | scale: 2048.00 | time: 26.482 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1597/  5000| tot_loss: 1.6882 | rl_loss: 0.2964 | pt_loss: 1.3919 | pg_loss: -0.0170 | reg_loss: 0.3134 | reward: -0.3682 | rev_kl: 1.0800 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.9395e-06 | scale: 2048.00 | time: 26.428 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1598/  5000| tot_loss: 1.9536 | rl_loss: 0.3196 | pt_loss: 1.6340 | pg_loss: 0.0005 | reg_loss: 0.3191 | reward: -0.4117 | rev_kl: 1.5839 | stu_lens: 79.0000 | mixed_lens: 128.0000 | lr: 3.9382e-06 | scale: 2048.00 | time: 26.446 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1599/  5000| tot_loss: 2.5255 | rl_loss: 1.1519 | pt_loss: 1.3736 | pg_loss: 0.6718 | reg_loss: 0.4802 | reward: -0.3057 | rev_kl: 1.0470 | stu_lens: 53.5000 | mixed_lens: 46.0000 | lr: 3.9369e-06 | scale: 2048.00 | time: 26.414 | step time: 0.000
                                 Evaluation #16                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Here is a simple rule of thumb: if   │
│                                       │ the chance of survival for both of   │
│                                       │ you is higher if you both go to      │
│                                       │ safety, then it is likely that you   │
│                                       │ should both go to safety.            │
│                                       │                                      │
│                                       │ In this case, Alice and Bob both     │
│                                       │ stand a 31% chance of survival if    │
│                                       │ they go to safety. And Bob's chance  │
│                                       │ of survival improves by 9% if he     │
│                                       │ leaves Alice behind. So, it is       │
│                                       │ likely that Bob should leave Alice   │
│                                       │ behind.                              │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ mz kezboard tzpe z instead of y and  │
│                                       │ vice versa is a typo. The correct    │
│                                       │ spelling is mz keyboard type z       │
│                                       │ instead of y and vice versa.         │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support over 100 languages.       │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.981 | exact_match: 0.215 | rev_kl: 1.108 | lens: 87.850 | pt_loss: 1.080 | lm_loss: 1.164 | kd_loss: 0.997 
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1600/  5000| tot_loss: 2.4921 | rl_loss: 0.9614 | pt_loss: 1.5308 | pg_loss: 0.3111 | reg_loss: 0.6502 | reward: -0.1053 | rev_kl: 0.7979 | stu_lens: 62.5000 | mixed_lens: 68.5000 | lr: 3.9355e-06 | scale: 2048.00 | time: 26.431 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1600/  5000| tot_loss: 2.4652 | rl_loss: 0.7611 | pt_loss: 1.7041 | pg_loss: 0.3550 | reg_loss: 0.4061 | reward: -0.4234 | rev_kl: 1.0819 | stu_lens: 85.7812 | mixed_lens: 84.5625 | lr: 3.9355e-06 | scale: 2048.00 | time: 26.431 | step time: 27.719
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1601/  5000| tot_loss: 3.8466 | rl_loss: 2.5742 | pt_loss: 1.2724 | pg_loss: 2.2460 | reg_loss: 0.3282 | reward: -2.7805 | rev_kl: 0.6948 | stu_lens: 17.0000 | mixed_lens: 16.5000 | lr: 3.9342e-06 | scale: 2048.00 | time: 26.504 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1602/  5000| tot_loss: 3.8381 | rl_loss: 2.0130 | pt_loss: 1.8251 | pg_loss: 0.6136 | reg_loss: 1.3995 | reward: -0.4049 | rev_kl: 0.6681 | stu_lens: 79.5000 | mixed_lens: 68.5000 | lr: 3.9329e-06 | scale: 2048.00 | time: 26.488 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1603/  5000| tot_loss: 4.3087 | rl_loss: 2.4986 | pt_loss: 1.8101 | pg_loss: 0.8399 | reg_loss: 1.6587 | reward: -0.1640 | rev_kl: 0.7466 | stu_lens: 40.5000 | mixed_lens: 53.0000 | lr: 3.9316e-06 | scale: 2048.00 | time: 26.450 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1604/  5000| tot_loss: 3.6585 | rl_loss: 1.7159 | pt_loss: 1.9426 | pg_loss: 0.4952 | reg_loss: 1.2207 | reward: -0.7860 | rev_kl: 0.8240 | stu_lens: 53.5000 | mixed_lens: 69.5000 | lr: 3.9303e-06 | scale: 2048.00 | time: 26.465 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1605/  5000| tot_loss: 3.0853 | rl_loss: 1.3967 | pt_loss: 1.6886 | pg_loss: 0.3662 | reg_loss: 1.0305 | reward: -1.1150 | rev_kl: 0.9952 | stu_lens: 70.0000 | mixed_lens: 72.5000 | lr: 3.9290e-06 | scale: 2048.00 | time: 26.485 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1606/  5000| tot_loss: 2.2965 | rl_loss: 0.7946 | pt_loss: 1.5020 | pg_loss: 0.1338 | reg_loss: 0.6607 | reward: -0.3057 | rev_kl: 1.1136 | stu_lens: 78.0000 | mixed_lens: 86.0000 | lr: 3.9277e-06 | scale: 2048.00 | time: 26.456 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1607/  5000| tot_loss: 2.1589 | rl_loss: 1.3255 | pt_loss: 0.8334 | pg_loss: 0.0533 | reg_loss: 1.2722 | reward: -0.1741 | rev_kl: 0.9177 | stu_lens: 101.0000 | mixed_lens: 128.0000 | lr: 3.9263e-06 | scale: 2048.00 | time: 26.474 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1608/  5000| tot_loss: 3.7151 | rl_loss: 1.7673 | pt_loss: 1.9478 | pg_loss: 0.3341 | reg_loss: 1.4332 | reward: -0.4043 | rev_kl: 1.7392 | stu_lens: 121.5000 | mixed_lens: 91.0000 | lr: 3.9250e-06 | scale: 2048.00 | time: 26.466 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1609/  5000| tot_loss: 3.9228 | rl_loss: 1.9598 | pt_loss: 1.9630 | pg_loss: 0.5530 | reg_loss: 1.4068 | reward: -0.1673 | rev_kl: 2.0092 | stu_lens: 114.5000 | mixed_lens: 41.5000 | lr: 3.9237e-06 | scale: 2048.00 | time: 26.480 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1610/  5000| tot_loss: 2.8582 | rl_loss: 1.2491 | pt_loss: 1.6090 | pg_loss: 0.0447 | reg_loss: 1.2044 | reward: -0.2517 | rev_kl: 0.8194 | stu_lens: 122.5000 | mixed_lens: 128.0000 | lr: 3.9224e-06 | scale: 2048.00 | time: 26.476 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1611/  5000| tot_loss: 2.8768 | rl_loss: 1.1997 | pt_loss: 1.6771 | pg_loss: 0.1508 | reg_loss: 1.0489 | reward: -0.0631 | rev_kl: 0.6670 | stu_lens: 113.5000 | mixed_lens: 86.5000 | lr: 3.9211e-06 | scale: 2048.00 | time: 26.501 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1612/  5000| tot_loss: 3.5292 | rl_loss: 2.0537 | pt_loss: 1.4755 | pg_loss: 0.7318 | reg_loss: 1.3219 | reward: -0.6359 | rev_kl: 0.7169 | stu_lens: 67.5000 | mixed_lens: 67.0000 | lr: 3.9198e-06 | scale: 2048.00 | time: 26.435 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1613/  5000| tot_loss: 4.4749 | rl_loss: 2.4962 | pt_loss: 1.9787 | pg_loss: 0.9317 | reg_loss: 1.5645 | reward: -1.0050 | rev_kl: 1.2876 | stu_lens: 50.5000 | mixed_lens: 32.5000 | lr: 3.9184e-06 | scale: 2048.00 | time: 26.542 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1614/  5000| tot_loss: 3.3303 | rl_loss: 1.6600 | pt_loss: 1.6704 | pg_loss: 0.2405 | reg_loss: 1.4195 | reward: -0.3812 | rev_kl: 1.3182 | stu_lens: 122.0000 | mixed_lens: 103.0000 | lr: 3.9171e-06 | scale: 2048.00 | time: 26.436 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1615/  5000| tot_loss: 3.3469 | rl_loss: 1.7222 | pt_loss: 1.6247 | pg_loss: 0.0944 | reg_loss: 1.6278 | reward: -0.2046 | rev_kl: 1.3270 | stu_lens: 91.5000 | mixed_lens: 125.5000 | lr: 3.9158e-06 | scale: 2048.00 | time: 26.457 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1616/  5000| tot_loss: 2.9246 | rl_loss: 0.9858 | pt_loss: 1.9387 | pg_loss: 0.0745 | reg_loss: 0.9113 | reward: -0.3517 | rev_kl: 1.1093 | stu_lens: 101.5000 | mixed_lens: 117.5000 | lr: 3.9145e-06 | scale: 2048.00 | time: 26.423 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1616/  5000| tot_loss: 3.2468 | rl_loss: 1.5539 | pt_loss: 1.6929 | pg_loss: 0.3687 | reg_loss: 1.1852 | reward: -0.4787 | rev_kl: 1.1321 | stu_lens: 92.3281 | mixed_lens: 85.1875 | lr: 3.9145e-06 | scale: 2048.00 | time: 26.423 | step time: 27.736
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1617/  5000| tot_loss: 2.5857 | rl_loss: 1.0333 | pt_loss: 1.5524 | pg_loss: 0.0772 | reg_loss: 0.9561 | reward: -0.1741 | rev_kl: 0.8108 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.9132e-06 | scale: 2048.00 | time: 26.436 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1618/  5000| tot_loss: 3.6463 | rl_loss: 1.8346 | pt_loss: 1.8117 | pg_loss: 0.6921 | reg_loss: 1.1425 | reward: -0.4395 | rev_kl: 0.8167 | stu_lens: 70.5000 | mixed_lens: 68.5000 | lr: 3.9118e-06 | scale: 2048.00 | time: 26.409 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1619/  5000| tot_loss: 2.6224 | rl_loss: 1.0756 | pt_loss: 1.5468 | pg_loss: -0.0014 | reg_loss: 1.0771 | reward: -0.3044 | rev_kl: 1.2557 | stu_lens: 119.5000 | mixed_lens: 125.5000 | lr: 3.9105e-06 | scale: 2048.00 | time: 26.428 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1620/  5000| tot_loss: 3.1846 | rl_loss: 1.3577 | pt_loss: 1.8269 | pg_loss: 0.4537 | reg_loss: 0.9040 | reward: -0.3036 | rev_kl: 1.3376 | stu_lens: 110.0000 | mixed_lens: 65.5000 | lr: 3.9092e-06 | scale: 2048.00 | time: 26.412 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1621/  5000| tot_loss: 2.5833 | rl_loss: 0.4181 | pt_loss: 2.1652 | pg_loss: 0.0609 | reg_loss: 0.3572 | reward: -0.0347 | rev_kl: 0.9200 | stu_lens: 90.0000 | mixed_lens: 92.0000 | lr: 3.9079e-06 | scale: 2048.00 | time: 26.434 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1622/  5000| tot_loss: 3.1399 | rl_loss: 1.2123 | pt_loss: 1.9276 | pg_loss: 0.4110 | reg_loss: 0.8013 | reward: -0.5475 | rev_kl: 1.1449 | stu_lens: 96.5000 | mixed_lens: 75.5000 | lr: 3.9065e-06 | scale: 2048.00 | time: 26.447 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1623/  5000| tot_loss: 2.4831 | rl_loss: 0.6221 | pt_loss: 1.8610 | pg_loss: 0.0553 | reg_loss: 0.5668 | reward: -0.6819 | rev_kl: 1.3526 | stu_lens: 121.0000 | mixed_lens: 79.5000 | lr: 3.9052e-06 | scale: 2048.00 | time: 26.437 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1624/  5000| tot_loss: 2.5865 | rl_loss: 0.7908 | pt_loss: 1.7957 | pg_loss: 0.0032 | reg_loss: 0.7875 | reward: -0.1385 | rev_kl: 1.1582 | stu_lens: 112.0000 | mixed_lens: 128.0000 | lr: 3.9039e-06 | scale: 2048.00 | time: 26.434 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1625/  5000| tot_loss: 2.4857 | rl_loss: 1.1686 | pt_loss: 1.3171 | pg_loss: 0.3040 | reg_loss: 0.8646 | reward: -0.3716 | rev_kl: 1.3249 | stu_lens: 121.0000 | mixed_lens: 99.5000 | lr: 3.9026e-06 | scale: 2048.00 | time: 26.463 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1626/  5000| tot_loss: 2.9845 | rl_loss: 1.0406 | pt_loss: 1.9439 | pg_loss: 0.5412 | reg_loss: 0.4994 | reward: 0.0185 | rev_kl: 0.5463 | stu_lens: 54.0000 | mixed_lens: 68.5000 | lr: 3.9012e-06 | scale: 2048.00 | time: 26.455 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1627/  5000| tot_loss: 2.8919 | rl_loss: 1.2539 | pt_loss: 1.6380 | pg_loss: 0.4229 | reg_loss: 0.8310 | reward: -0.6216 | rev_kl: 1.4758 | stu_lens: 105.5000 | mixed_lens: 72.0000 | lr: 3.8999e-06 | scale: 2048.00 | time: 26.497 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1628/  5000| tot_loss: 2.5625 | rl_loss: 1.2471 | pt_loss: 1.3154 | pg_loss: 0.5797 | reg_loss: 0.6673 | reward: -0.3756 | rev_kl: 1.5638 | stu_lens: 98.0000 | mixed_lens: 53.0000 | lr: 3.8986e-06 | scale: 2048.00 | time: 26.467 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1629/  5000| tot_loss: 2.6415 | rl_loss: 0.9584 | pt_loss: 1.6831 | pg_loss: 0.2217 | reg_loss: 0.7367 | reward: -0.1131 | rev_kl: 1.9454 | stu_lens: 100.0000 | mixed_lens: 94.5000 | lr: 3.8972e-06 | scale: 2048.00 | time: 26.506 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1630/  5000| tot_loss: 2.7852 | rl_loss: 1.2991 | pt_loss: 1.4861 | pg_loss: 0.2687 | reg_loss: 1.0304 | reward: -0.0425 | rev_kl: 1.8894 | stu_lens: 93.0000 | mixed_lens: 98.5000 | lr: 3.8959e-06 | scale: 2048.00 | time: 26.472 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1631/  5000| tot_loss: 3.6447 | rl_loss: 1.7704 | pt_loss: 1.8742 | pg_loss: 0.8033 | reg_loss: 0.9672 | reward: -0.6106 | rev_kl: 1.9622 | stu_lens: 77.5000 | mixed_lens: 44.5000 | lr: 3.8946e-06 | scale: 2048.00 | time: 26.522 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1632/  5000| tot_loss: 1.9846 | rl_loss: 0.4800 | pt_loss: 1.5046 | pg_loss: 0.0803 | reg_loss: 0.3997 | reward: -0.1899 | rev_kl: 0.3151 | stu_lens: 128.0000 | mixed_lens: 86.5000 | lr: 3.8933e-06 | scale: 2048.00 | time: 26.461 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1632/  5000| tot_loss: 2.7361 | rl_loss: 1.0166 | pt_loss: 1.7195 | pg_loss: 0.2383 | reg_loss: 0.7783 | reward: -0.4152 | rev_kl: 1.1762 | stu_lens: 97.2812 | mixed_lens: 89.1094 | lr: 3.8933e-06 | scale: 2048.00 | time: 26.461 | step time: 27.714
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1633/  5000| tot_loss: 2.1220 | rl_loss: 0.7672 | pt_loss: 1.3548 | pg_loss: 0.0573 | reg_loss: 0.7100 | reward: -0.3667 | rev_kl: 1.0435 | stu_lens: 128.0000 | mixed_lens: 118.5000 | lr: 3.8919e-06 | scale: 2048.00 | time: 26.481 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1634/  5000| tot_loss: 2.2146 | rl_loss: 0.1304 | pt_loss: 2.0842 | pg_loss: -0.0100 | reg_loss: 0.1404 | reward: -0.0858 | rev_kl: 0.4572 | stu_lens: 125.0000 | mixed_lens: 128.0000 | lr: 3.8906e-06 | scale: 2048.00 | time: 26.446 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1635/  5000| tot_loss: 2.4068 | rl_loss: 0.6083 | pt_loss: 1.7985 | pg_loss: 0.1184 | reg_loss: 0.4899 | reward: -0.5840 | rev_kl: 0.1663 | stu_lens: 67.5000 | mixed_lens: 25.5000 | lr: 3.8893e-06 | scale: 2048.00 | time: 26.469 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1636/  5000| tot_loss: 1.5506 | rl_loss: 0.7369 | pt_loss: 0.8138 | pg_loss: 0.1311 | reg_loss: 0.6057 | reward: 0.0864 | rev_kl: 2.1868 | stu_lens: 107.5000 | mixed_lens: 79.0000 | lr: 3.8879e-06 | scale: 2048.00 | time: 26.461 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1637/  5000| tot_loss: 2.3701 | rl_loss: 0.8999 | pt_loss: 1.4702 | pg_loss: 0.5185 | reg_loss: 0.3815 | reward: -1.1013 | rev_kl: 1.0684 | stu_lens: 32.0000 | mixed_lens: 53.5000 | lr: 3.8866e-06 | scale: 2048.00 | time: 26.458 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1638/  5000| tot_loss: 2.3697 | rl_loss: 0.7304 | pt_loss: 1.6393 | pg_loss: 0.2417 | reg_loss: 0.4887 | reward: -0.9361 | rev_kl: 1.1488 | stu_lens: 82.5000 | mixed_lens: 85.0000 | lr: 3.8853e-06 | scale: 2048.00 | time: 26.427 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1639/  5000| tot_loss: 2.5116 | rl_loss: 0.8989 | pt_loss: 1.6127 | pg_loss: 0.2033 | reg_loss: 0.6956 | reward: -0.3386 | rev_kl: 1.1905 | stu_lens: 80.5000 | mixed_lens: 102.0000 | lr: 3.8839e-06 | scale: 2048.00 | time: 26.449 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1640/  5000| tot_loss: 2.1903 | rl_loss: 0.6583 | pt_loss: 1.5320 | pg_loss: 0.1500 | reg_loss: 0.5083 | reward: -0.1886 | rev_kl: 1.2456 | stu_lens: 106.0000 | mixed_lens: 103.0000 | lr: 3.8826e-06 | scale: 2048.00 | time: 26.416 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1641/  5000| tot_loss: 1.8233 | rl_loss: -0.1733 | pt_loss: 1.9966 | pg_loss: -0.3114 | reg_loss: 0.1381 | reward: -0.3194 | rev_kl: 0.0750 | stu_lens: 27.0000 | mixed_lens: 9.0000 | lr: 3.8813e-06 | scale: 2048.00 | time: 26.447 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1642/  5000| tot_loss: 1.8591 | rl_loss: 0.7668 | pt_loss: 1.0923 | pg_loss: 0.2358 | reg_loss: 0.5310 | reward: -0.4606 | rev_kl: 1.4126 | stu_lens: 104.0000 | mixed_lens: 78.0000 | lr: 3.8799e-06 | scale: 2048.00 | time: 26.423 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1643/  5000| tot_loss: 2.1178 | rl_loss: 0.4703 | pt_loss: 1.6475 | pg_loss: 0.0073 | reg_loss: 0.4630 | reward: -0.2216 | rev_kl: 0.7525 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8786e-06 | scale: 2048.00 | time: 26.488 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1644/  5000| tot_loss: 2.8532 | rl_loss: 0.9739 | pt_loss: 1.8793 | pg_loss: 0.2865 | reg_loss: 0.6874 | reward: -0.4284 | rev_kl: 2.1585 | stu_lens: 105.5000 | mixed_lens: 100.5000 | lr: 3.8772e-06 | scale: 2048.00 | time: 26.470 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1645/  5000| tot_loss: 2.3259 | rl_loss: 0.7637 | pt_loss: 1.5622 | pg_loss: 0.2024 | reg_loss: 0.5613 | reward: -0.3873 | rev_kl: 1.4715 | stu_lens: 72.5000 | mixed_lens: 86.0000 | lr: 3.8759e-06 | scale: 2048.00 | time: 26.470 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1646/  5000| tot_loss: 1.5059 | rl_loss: 0.4436 | pt_loss: 1.0623 | pg_loss: 0.0273 | reg_loss: 0.4163 | reward: -0.1593 | rev_kl: 0.7206 | stu_lens: 128.0000 | mixed_lens: 118.5000 | lr: 3.8746e-06 | scale: 2048.00 | time: 26.480 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1647/  5000| tot_loss: 2.7691 | rl_loss: 0.7516 | pt_loss: 2.0175 | pg_loss: 0.2300 | reg_loss: 0.5216 | reward: -0.6205 | rev_kl: 1.0151 | stu_lens: 123.5000 | mixed_lens: 79.5000 | lr: 3.8732e-06 | scale: 2048.00 | time: 26.501 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1648/  5000| tot_loss: 2.3985 | rl_loss: 0.3347 | pt_loss: 2.0638 | pg_loss: -0.0118 | reg_loss: 0.3465 | reward: -0.2228 | rev_kl: 0.7949 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8719e-06 | scale: 2048.00 | time: 26.463 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1648/  5000| tot_loss: 2.3815 | rl_loss: 0.7131 | pt_loss: 1.6684 | pg_loss: 0.1922 | reg_loss: 0.5209 | reward: -0.3699 | rev_kl: 1.1311 | stu_lens: 99.5156 | mixed_lens: 88.8281 | lr: 3.8719e-06 | scale: 2048.00 | time: 26.463 | step time: 27.718
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1649/  5000| tot_loss: 2.2896 | rl_loss: 0.7504 | pt_loss: 1.5392 | pg_loss: -0.0063 | reg_loss: 0.7567 | reward: -0.2087 | rev_kl: 1.2573 | stu_lens: 112.0000 | mixed_lens: 128.0000 | lr: 3.8705e-06 | scale: 2048.00 | time: 26.504 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1650/  5000| tot_loss: 2.2984 | rl_loss: 0.5451 | pt_loss: 1.7532 | pg_loss: 0.2149 | reg_loss: 0.3303 | reward: -0.3166 | rev_kl: 1.3663 | stu_lens: 121.5000 | mixed_lens: 100.5000 | lr: 3.8692e-06 | scale: 2048.00 | time: 26.459 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1651/  5000| tot_loss: 2.4536 | rl_loss: 0.7234 | pt_loss: 1.7302 | pg_loss: 0.2474 | reg_loss: 0.4760 | reward: -0.5054 | rev_kl: 0.9415 | stu_lens: 120.0000 | mixed_lens: 94.5000 | lr: 3.8679e-06 | scale: 2048.00 | time: 26.495 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1652/  5000| tot_loss: 2.1389 | rl_loss: 0.4773 | pt_loss: 1.6616 | pg_loss: -0.0045 | reg_loss: 0.4818 | reward: -0.2891 | rev_kl: 0.8973 | stu_lens: 122.5000 | mixed_lens: 128.0000 | lr: 3.8665e-06 | scale: 2048.00 | time: 26.482 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1653/  5000| tot_loss: 1.7025 | rl_loss: 0.2554 | pt_loss: 1.4472 | pg_loss: -0.1201 | reg_loss: 0.3755 | reward: -0.3711 | rev_kl: 1.4637 | stu_lens: 102.0000 | mixed_lens: 43.0000 | lr: 3.8652e-06 | scale: 2048.00 | time: 26.526 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1654/  5000| tot_loss: 2.3768 | rl_loss: 0.6056 | pt_loss: 1.7712 | pg_loss: -0.0019 | reg_loss: 0.6075 | reward: -0.3233 | rev_kl: 1.0693 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8638e-06 | scale: 2048.00 | time: 26.517 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1655/  5000| tot_loss: 1.6780 | rl_loss: 0.4320 | pt_loss: 1.2460 | pg_loss: 0.0032 | reg_loss: 0.4287 | reward: -0.2589 | rev_kl: 0.8442 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8625e-06 | scale: 2048.00 | time: 26.550 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1656/  5000| tot_loss: 2.1780 | rl_loss: 0.4601 | pt_loss: 1.7179 | pg_loss: 0.0515 | reg_loss: 0.4086 | reward: -0.1822 | rev_kl: 1.3078 | stu_lens: 90.0000 | mixed_lens: 109.0000 | lr: 3.8611e-06 | scale: 2048.00 | time: 26.504 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1657/  5000| tot_loss: 2.3260 | rl_loss: 0.6791 | pt_loss: 1.6469 | pg_loss: 0.2203 | reg_loss: 0.4588 | reward: -0.3242 | rev_kl: 1.0110 | stu_lens: 128.0000 | mixed_lens: 94.0000 | lr: 3.8598e-06 | scale: 2048.00 | time: 26.511 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1658/  5000| tot_loss: 2.1255 | rl_loss: 0.3778 | pt_loss: 1.7477 | pg_loss: 0.0222 | reg_loss: 0.3556 | reward: -0.2411 | rev_kl: 0.7292 | stu_lens: 121.0000 | mixed_lens: 128.0000 | lr: 3.8585e-06 | scale: 2048.00 | time: 26.493 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1659/  5000| tot_loss: 1.9658 | rl_loss: 0.3424 | pt_loss: 1.6234 | pg_loss: 0.0195 | reg_loss: 0.3229 | reward: -0.2851 | rev_kl: 0.9419 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8571e-06 | scale: 2048.00 | time: 26.509 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1660/  5000| tot_loss: 2.0617 | rl_loss: 0.4296 | pt_loss: 1.6321 | pg_loss: -0.0020 | reg_loss: 0.4316 | reward: -0.1817 | rev_kl: 0.9443 | stu_lens: 123.5000 | mixed_lens: 128.0000 | lr: 3.8558e-06 | scale: 2048.00 | time: 26.482 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1661/  5000| tot_loss: 2.2939 | rl_loss: 0.2806 | pt_loss: 2.0133 | pg_loss: -0.0057 | reg_loss: 0.2863 | reward: -0.1952 | rev_kl: 1.1707 | stu_lens: 112.0000 | mixed_lens: 128.0000 | lr: 3.8544e-06 | scale: 2048.00 | time: 26.498 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1662/  5000| tot_loss: 2.1631 | rl_loss: 0.3207 | pt_loss: 1.8424 | pg_loss: 0.1968 | reg_loss: 0.1239 | reward: -1.3563 | rev_kl: 1.3455 | stu_lens: 63.5000 | mixed_lens: 66.5000 | lr: 3.8531e-06 | scale: 2048.00 | time: 26.477 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1663/  5000| tot_loss: 2.2425 | rl_loss: 0.4272 | pt_loss: 1.8153 | pg_loss: 0.0805 | reg_loss: 0.3467 | reward: -0.3252 | rev_kl: 0.9229 | stu_lens: 108.5000 | mixed_lens: 117.5000 | lr: 3.8517e-06 | scale: 2048.00 | time: 26.495 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1664/  5000| tot_loss: 3.6769 | rl_loss: 1.9463 | pt_loss: 1.7307 | pg_loss: 1.6444 | reg_loss: 0.3018 | reward: -1.3363 | rev_kl: 1.2301 | stu_lens: 26.0000 | mixed_lens: 16.5000 | lr: 3.8504e-06 | scale: 2048.00 | time: 26.476 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1664/  5000| tot_loss: 2.4295 | rl_loss: 0.6712 | pt_loss: 1.7584 | pg_loss: 0.2287 | reg_loss: 0.4425 | reward: -0.4662 | rev_kl: 1.1782 | stu_lens: 94.2656 | mixed_lens: 86.8281 | lr: 3.8504e-06 | scale: 2048.00 | time: 26.476 | step time: 27.758
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1665/  5000| tot_loss: 2.2751 | rl_loss: 0.4369 | pt_loss: 1.8382 | pg_loss: 0.1256 | reg_loss: 0.3113 | reward: -0.0216 | rev_kl: 1.7407 | stu_lens: 112.0000 | mixed_lens: 110.0000 | lr: 3.8490e-06 | scale: 2048.00 | time: 26.506 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1666/  5000| tot_loss: 3.1639 | rl_loss: 1.1733 | pt_loss: 1.9906 | pg_loss: 0.0430 | reg_loss: 1.1304 | reward: -0.2128 | rev_kl: 1.3073 | stu_lens: 86.5000 | mixed_lens: 128.0000 | lr: 3.8477e-06 | scale: 2048.00 | time: 26.533 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1667/  5000| tot_loss: 4.0184 | rl_loss: 2.2153 | pt_loss: 1.8031 | pg_loss: 0.4390 | reg_loss: 1.7763 | reward: -0.4461 | rev_kl: 1.5613 | stu_lens: 85.5000 | mixed_lens: 93.0000 | lr: 3.8463e-06 | scale: 2048.00 | time: 26.477 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1668/  5000| tot_loss: 3.3288 | rl_loss: 1.6158 | pt_loss: 1.7130 | pg_loss: 0.9267 | reg_loss: 0.6891 | reward: -0.4264 | rev_kl: 1.2458 | stu_lens: 73.0000 | mixed_lens: 18.5000 | lr: 3.8450e-06 | scale: 2048.00 | time: 26.450 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1669/  5000| tot_loss: 2.5833 | rl_loss: 1.2166 | pt_loss: 1.3667 | pg_loss: 0.0249 | reg_loss: 1.1917 | reward: -0.2074 | rev_kl: 1.1045 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8436e-06 | scale: 2048.00 | time: 26.495 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1670/  5000| tot_loss: 3.0886 | rl_loss: 1.2389 | pt_loss: 1.8497 | pg_loss: 0.0901 | reg_loss: 1.1488 | reward: -0.1807 | rev_kl: 0.8391 | stu_lens: 106.0000 | mixed_lens: 128.0000 | lr: 3.8423e-06 | scale: 2048.00 | time: 26.475 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1671/  5000| tot_loss: 4.1413 | rl_loss: 2.0703 | pt_loss: 2.0709 | pg_loss: 0.6705 | reg_loss: 1.3998 | reward: 0.0127 | rev_kl: 0.6735 | stu_lens: 42.0000 | mixed_lens: 63.5000 | lr: 3.8409e-06 | scale: 2048.00 | time: 26.497 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1672/  5000| tot_loss: 4.0711 | rl_loss: 2.6059 | pt_loss: 1.4652 | pg_loss: 1.1059 | reg_loss: 1.5000 | reward: -0.6188 | rev_kl: 1.0296 | stu_lens: 16.0000 | mixed_lens: 53.5000 | lr: 3.8396e-06 | scale: 2048.00 | time: 26.453 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1673/  5000| tot_loss: 3.1598 | rl_loss: 1.5292 | pt_loss: 1.6305 | pg_loss: 0.1706 | reg_loss: 1.3586 | reward: -0.0983 | rev_kl: 1.3940 | stu_lens: 89.0000 | mixed_lens: 103.0000 | lr: 3.8382e-06 | scale: 2048.00 | time: 26.488 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1674/  5000| tot_loss: 3.6815 | rl_loss: 2.3628 | pt_loss: 1.3186 | pg_loss: 1.6405 | reg_loss: 0.7224 | reward: -0.9642 | rev_kl: 1.1734 | stu_lens: 33.5000 | mixed_lens: 20.5000 | lr: 3.8369e-06 | scale: 2048.00 | time: 26.435 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1675/  5000| tot_loss: 3.3979 | rl_loss: 1.5389 | pt_loss: 1.8590 | pg_loss: 0.0552 | reg_loss: 1.4838 | reward: -0.2699 | rev_kl: 1.2960 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8355e-06 | scale: 2048.00 | time: 26.457 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1676/  5000| tot_loss: 3.3731 | rl_loss: 1.6842 | pt_loss: 1.6889 | pg_loss: 0.3492 | reg_loss: 1.3351 | reward: -0.3455 | rev_kl: 0.8323 | stu_lens: 63.5000 | mixed_lens: 83.5000 | lr: 3.8341e-06 | scale: 2048.00 | time: 26.431 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1677/  5000| tot_loss: 3.5047 | rl_loss: 1.4134 | pt_loss: 2.0913 | pg_loss: 0.2839 | reg_loss: 1.1295 | reward: -0.1664 | rev_kl: 0.8379 | stu_lens: 87.0000 | mixed_lens: 93.5000 | lr: 3.8328e-06 | scale: 2048.00 | time: 26.480 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1678/  5000| tot_loss: 3.8274 | rl_loss: 1.8695 | pt_loss: 1.9579 | pg_loss: 0.5410 | reg_loss: 1.3285 | reward: -0.5285 | rev_kl: 1.2347 | stu_lens: 65.0000 | mixed_lens: 67.5000 | lr: 3.8314e-06 | scale: 2048.00 | time: 26.465 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1679/  5000| tot_loss: 2.4837 | rl_loss: 1.3615 | pt_loss: 1.1223 | pg_loss: 0.2000 | reg_loss: 1.1615 | reward: -0.0808 | rev_kl: 1.0928 | stu_lens: 128.0000 | mixed_lens: 113.5000 | lr: 3.8301e-06 | scale: 2048.00 | time: 26.501 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1680/  5000| tot_loss: 2.6700 | rl_loss: 0.7170 | pt_loss: 1.9531 | pg_loss: 0.2379 | reg_loss: 0.4791 | reward: -0.5122 | rev_kl: 0.6187 | stu_lens: 15.0000 | mixed_lens: 86.5000 | lr: 3.8287e-06 | scale: 2048.00 | time: 26.478 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1680/  5000| tot_loss: 3.1979 | rl_loss: 1.5515 | pt_loss: 1.6464 | pg_loss: 0.3911 | reg_loss: 1.1604 | reward: -0.5191 | rev_kl: 1.0328 | stu_lens: 85.7656 | mixed_lens: 90.6875 | lr: 3.8287e-06 | scale: 2048.00 | time: 26.478 | step time: 27.738
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1681/  5000| tot_loss: 5.0306 | rl_loss: 3.0304 | pt_loss: 2.0002 | pg_loss: 1.3720 | reg_loss: 1.6584 | reward: -2.3296 | rev_kl: 0.4667 | stu_lens: 65.5000 | mixed_lens: 34.0000 | lr: 3.8274e-06 | scale: 2048.00 | time: 26.503 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1682/  5000| tot_loss: 2.8689 | rl_loss: 1.1273 | pt_loss: 1.7416 | pg_loss: 0.1092 | reg_loss: 1.0181 | reward: -0.2669 | rev_kl: 1.4466 | stu_lens: 111.5000 | mixed_lens: 103.0000 | lr: 3.8260e-06 | scale: 2048.00 | time: 26.528 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1683/  5000| tot_loss: 2.8923 | rl_loss: 1.1630 | pt_loss: 1.7294 | pg_loss: 0.3791 | reg_loss: 0.7839 | reward: -0.5104 | rev_kl: 1.4375 | stu_lens: 86.0000 | mixed_lens: 86.0000 | lr: 3.8246e-06 | scale: 2048.00 | time: 26.555 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1684/  5000| tot_loss: 3.6827 | rl_loss: 1.8522 | pt_loss: 1.8305 | pg_loss: 0.9358 | reg_loss: 0.9164 | reward: -0.7134 | rev_kl: 0.9367 | stu_lens: 37.5000 | mixed_lens: 46.0000 | lr: 3.8233e-06 | scale: 2048.00 | time: 26.528 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1685/  5000| tot_loss: 2.4491 | rl_loss: 0.7289 | pt_loss: 1.7202 | pg_loss: 0.1577 | reg_loss: 0.5712 | reward: -0.7145 | rev_kl: 0.6678 | stu_lens: 87.5000 | mixed_lens: 71.0000 | lr: 3.8219e-06 | scale: 2048.00 | time: 26.547 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1686/  5000| tot_loss: 2.2915 | rl_loss: 1.0030 | pt_loss: 1.2886 | pg_loss: 0.2510 | reg_loss: 0.7520 | reward: 0.0030 | rev_kl: 1.2159 | stu_lens: 102.5000 | mixed_lens: 69.0000 | lr: 3.8206e-06 | scale: 2048.00 | time: 26.531 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1687/  5000| tot_loss: 2.2019 | rl_loss: 0.4134 | pt_loss: 1.7885 | pg_loss: -0.0013 | reg_loss: 0.4147 | reward: -0.1557 | rev_kl: 1.1436 | stu_lens: 34.5000 | mixed_lens: 128.0000 | lr: 3.8192e-06 | scale: 2048.00 | time: 26.574 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1688/  5000| tot_loss: 2.7353 | rl_loss: 1.2132 | pt_loss: 1.5221 | pg_loss: 0.4462 | reg_loss: 0.7670 | reward: -0.3062 | rev_kl: 1.1390 | stu_lens: 60.5000 | mixed_lens: 79.0000 | lr: 3.8178e-06 | scale: 2048.00 | time: 26.524 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1689/  5000| tot_loss: 4.0641 | rl_loss: 2.4689 | pt_loss: 1.5952 | pg_loss: 1.6713 | reg_loss: 0.7976 | reward: -1.2186 | rev_kl: 0.4355 | stu_lens: 31.5000 | mixed_lens: 23.5000 | lr: 3.8165e-06 | scale: 2048.00 | time: 26.636 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1690/  5000| tot_loss: 2.6868 | rl_loss: 1.0508 | pt_loss: 1.6360 | pg_loss: 0.2045 | reg_loss: 0.8464 | reward: -0.3167 | rev_kl: 1.1755 | stu_lens: 128.0000 | mixed_lens: 97.0000 | lr: 3.8151e-06 | scale: 2048.00 | time: 26.515 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1691/  5000| tot_loss: 3.0076 | rl_loss: 1.0962 | pt_loss: 1.9113 | pg_loss: 0.1824 | reg_loss: 0.9138 | reward: -4.7719 | rev_kl: 1.3089 | stu_lens: 69.0000 | mixed_lens: 69.0000 | lr: 3.8138e-06 | scale: 2048.00 | time: 26.530 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1692/  5000| tot_loss: 3.3428 | rl_loss: 2.0322 | pt_loss: 1.3105 | pg_loss: 1.2454 | reg_loss: 0.7869 | reward: -0.7449 | rev_kl: 0.5774 | stu_lens: 4.0000 | mixed_lens: 26.0000 | lr: 3.8124e-06 | scale: 2048.00 | time: 26.469 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1693/  5000| tot_loss: 1.9405 | rl_loss: 0.5328 | pt_loss: 1.4077 | pg_loss: 0.0763 | reg_loss: 0.4565 | reward: -0.2506 | rev_kl: 0.9376 | stu_lens: 128.0000 | mixed_lens: 119.0000 | lr: 3.8110e-06 | scale: 2048.00 | time: 26.494 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1694/  5000| tot_loss: 2.6908 | rl_loss: 1.0419 | pt_loss: 1.6489 | pg_loss: 0.0340 | reg_loss: 1.0080 | reward: -0.2974 | rev_kl: 1.0344 | stu_lens: 95.5000 | mixed_lens: 128.0000 | lr: 3.8097e-06 | scale: 2048.00 | time: 26.463 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1695/  5000| tot_loss: 2.1732 | rl_loss: 0.6528 | pt_loss: 1.5203 | pg_loss: 0.0105 | reg_loss: 0.6423 | reward: -0.1813 | rev_kl: 1.0129 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8083e-06 | scale: 2048.00 | time: 26.481 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1696/  5000| tot_loss: 3.4415 | rl_loss: 1.3256 | pt_loss: 2.1158 | pg_loss: 0.6210 | reg_loss: 0.7046 | reward: -0.5168 | rev_kl: 1.1845 | stu_lens: 73.0000 | mixed_lens: 58.5000 | lr: 3.8069e-06 | scale: 2048.00 | time: 26.494 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1696/  5000| tot_loss: 2.8975 | rl_loss: 1.2014 | pt_loss: 1.6961 | pg_loss: 0.3825 | reg_loss: 0.8189 | reward: -0.6671 | rev_kl: 1.1010 | stu_lens: 81.8750 | mixed_lens: 84.5469 | lr: 3.8069e-06 | scale: 2048.00 | time: 26.494 | step time: 27.785
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1697/  5000| tot_loss: 2.2564 | rl_loss: 0.5799 | pt_loss: 1.6765 | pg_loss: 0.1162 | reg_loss: 0.4637 | reward: -0.1693 | rev_kl: 0.6460 | stu_lens: 105.0000 | mixed_lens: 114.0000 | lr: 3.8056e-06 | scale: 2048.00 | time: 26.481 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1698/  5000| tot_loss: 2.6510 | rl_loss: 0.8501 | pt_loss: 1.8009 | pg_loss: 0.0037 | reg_loss: 0.8464 | reward: -0.4178 | rev_kl: 1.1373 | stu_lens: 75.5000 | mixed_lens: 123.5000 | lr: 3.8042e-06 | scale: 2048.00 | time: 26.449 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1699/  5000| tot_loss: 1.6073 | rl_loss: -0.1714 | pt_loss: 1.7787 | pg_loss: -0.5446 | reg_loss: 0.3732 | reward: -0.2770 | rev_kl: 0.7458 | stu_lens: 96.5000 | mixed_lens: 21.5000 | lr: 3.8028e-06 | scale: 2048.00 | time: 26.474 | step time: 0.000
                                 Evaluation #17                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Yes, Bob should leave Alice. He has  │
│                                       │ a 9% chance of survival if he leaves │
│                                       │ Alice, compared to a 31% chance of   │
│                                       │ survival if he stays with Alice.     │
│                                       │ Since Bob cannot possibly survive if │
│                                       │ he stays with Alice, he should leave │
│                                       │ her and try to find safety on his    │
│                                       │ own.                                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ mz kezboard tzpe z instead of y and  │
│                                       │ vice versa is a typo. It should be   │
│                                       │ mz kezboard tzpe y instead of z and  │
│                                       │ vice versa.                          │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support 50+ languages. Please     │
│                                       │ check our website for the complete   │
│                                       │ list.                                │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.777 | exact_match: 0.215 | rev_kl: 1.129 | lens: 89.090 | pt_loss: 1.079 | lm_loss: 1.160 | kd_loss: 0.997 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1700/  5000| tot_loss: 2.0467 | rl_loss: 0.3993 | pt_loss: 1.6474 | pg_loss: 0.0492 | reg_loss: 0.3501 | reward: -0.3534 | rev_kl: 0.8312 | stu_lens: 58.5000 | mixed_lens: 121.0000 | lr: 3.8015e-06 | scale: 2048.00 | time: 26.441 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1701/  5000| tot_loss: 2.4942 | rl_loss: 0.4846 | pt_loss: 2.0095 | pg_loss: 0.2098 | reg_loss: 0.2748 | reward: -0.1923 | rev_kl: 0.5119 | stu_lens: 128.0000 | mixed_lens: 88.0000 | lr: 3.8001e-06 | scale: 2048.00 | time: 26.570 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1702/  5000| tot_loss: 2.8787 | rl_loss: 0.9521 | pt_loss: 1.9266 | pg_loss: 0.3765 | reg_loss: 0.5757 | reward: -0.7500 | rev_kl: 1.3011 | stu_lens: 73.5000 | mixed_lens: 69.5000 | lr: 3.7987e-06 | scale: 2048.00 | time: 26.529 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1703/  5000| tot_loss: 2.1113 | rl_loss: 0.4271 | pt_loss: 1.6842 | pg_loss: 0.0196 | reg_loss: 0.4074 | reward: -0.1264 | rev_kl: 0.7547 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7974e-06 | scale: 2048.00 | time: 26.549 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1704/  5000| tot_loss: 2.9537 | rl_loss: 1.5073 | pt_loss: 1.4464 | pg_loss: 1.2849 | reg_loss: 0.2224 | reward: -2.3654 | rev_kl: 0.6741 | stu_lens: 27.0000 | mixed_lens: 26.0000 | lr: 3.7960e-06 | scale: 2048.00 | time: 26.518 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1705/  5000| tot_loss: 2.3556 | rl_loss: 0.6032 | pt_loss: 1.7524 | pg_loss: 0.0800 | reg_loss: 0.5232 | reward: -0.1349 | rev_kl: 1.0378 | stu_lens: 84.5000 | mixed_lens: 103.5000 | lr: 3.7946e-06 | scale: 2048.00 | time: 26.541 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1706/  5000| tot_loss: 2.4679 | rl_loss: 0.8454 | pt_loss: 1.6225 | pg_loss: 0.7871 | reg_loss: 0.0583 | reward: -0.7390 | rev_kl: 1.0102 | stu_lens: 73.0000 | mixed_lens: 26.5000 | lr: 3.7932e-06 | scale: 2048.00 | time: 26.530 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1707/  5000| tot_loss: 2.5292 | rl_loss: 1.0649 | pt_loss: 1.4643 | pg_loss: 0.4986 | reg_loss: 0.5663 | reward: -0.5152 | rev_kl: 1.7690 | stu_lens: 86.0000 | mixed_lens: 86.0000 | lr: 3.7919e-06 | scale: 2048.00 | time: 26.546 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1708/  5000| tot_loss: 2.5424 | rl_loss: 0.6914 | pt_loss: 1.8510 | pg_loss: 0.0306 | reg_loss: 0.6608 | reward: -0.2690 | rev_kl: 1.0874 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7905e-06 | scale: 2048.00 | time: 26.552 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1709/  5000| tot_loss: 2.9284 | rl_loss: 0.8773 | pt_loss: 2.0510 | pg_loss: 0.2353 | reg_loss: 0.6420 | reward: -0.3013 | rev_kl: 1.2737 | stu_lens: 85.5000 | mixed_lens: 93.0000 | lr: 3.7891e-06 | scale: 2048.00 | time: 26.541 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1710/  5000| tot_loss: 2.5025 | rl_loss: 0.5640 | pt_loss: 1.9384 | pg_loss: 0.1822 | reg_loss: 0.3818 | reward: -0.4914 | rev_kl: 2.3939 | stu_lens: 68.0000 | mixed_lens: 85.5000 | lr: 3.7877e-06 | scale: 2048.00 | time: 26.495 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1711/  5000| tot_loss: 2.4046 | rl_loss: 0.7244 | pt_loss: 1.6802 | pg_loss: 0.2275 | reg_loss: 0.4969 | reward: -0.3810 | rev_kl: 1.1802 | stu_lens: 65.5000 | mixed_lens: 79.0000 | lr: 3.7864e-06 | scale: 2048.00 | time: 26.516 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1712/  5000| tot_loss: 3.0068 | rl_loss: 1.2217 | pt_loss: 1.7851 | pg_loss: 0.5826 | reg_loss: 0.6391 | reward: -4.9590 | rev_kl: 1.2315 | stu_lens: 69.0000 | mixed_lens: 35.5000 | lr: 3.7850e-06 | scale: 2048.00 | time: 26.494 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1712/  5000| tot_loss: 2.5661 | rl_loss: 0.8272 | pt_loss: 1.7390 | pg_loss: 0.2753 | reg_loss: 0.5519 | reward: -0.5968 | rev_kl: 1.0542 | stu_lens: 83.6250 | mixed_lens: 89.1406 | lr: 3.7850e-06 | scale: 2048.00 | time: 26.494 | step time: 27.783
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1713/  5000| tot_loss: 2.8920 | rl_loss: 0.6549 | pt_loss: 2.2370 | pg_loss: 0.0645 | reg_loss: 0.5904 | reward: -0.1119 | rev_kl: 1.0563 | stu_lens: 128.0000 | mixed_lens: 113.5000 | lr: 3.7836e-06 | scale: 2048.00 | time: 26.526 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1714/  5000| tot_loss: 2.1669 | rl_loss: 0.3619 | pt_loss: 1.8050 | pg_loss: 0.0841 | reg_loss: 0.2779 | reward: -0.1756 | rev_kl: 0.8571 | stu_lens: 97.5000 | mixed_lens: 94.5000 | lr: 3.7822e-06 | scale: 2048.00 | time: 26.489 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1715/  5000| tot_loss: 2.7389 | rl_loss: 0.8640 | pt_loss: 1.8748 | pg_loss: 0.2602 | reg_loss: 0.6038 | reward: -0.5490 | rev_kl: 0.8305 | stu_lens: 74.5000 | mixed_lens: 76.0000 | lr: 3.7809e-06 | scale: 2048.00 | time: 26.497 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1716/  5000| tot_loss: 2.7045 | rl_loss: 0.4639 | pt_loss: 2.2406 | pg_loss: 0.0205 | reg_loss: 0.4435 | reward: -0.2331 | rev_kl: 1.4364 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7795e-06 | scale: 2048.00 | time: 26.451 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1717/  5000| tot_loss: 2.6939 | rl_loss: 0.6045 | pt_loss: 2.0895 | pg_loss: 0.2036 | reg_loss: 0.4009 | reward: -0.4636 | rev_kl: 1.0393 | stu_lens: 128.0000 | mixed_lens: 94.5000 | lr: 3.7781e-06 | scale: 2048.00 | time: 26.504 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1718/  5000| tot_loss: 2.3596 | rl_loss: 0.5777 | pt_loss: 1.7820 | pg_loss: 0.3027 | reg_loss: 0.2750 | reward: -0.1733 | rev_kl: 0.3369 | stu_lens: 67.5000 | mixed_lens: 68.0000 | lr: 3.7767e-06 | scale: 2048.00 | time: 26.466 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1719/  5000| tot_loss: 1.8877 | rl_loss: 0.5441 | pt_loss: 1.3436 | pg_loss: 0.2989 | reg_loss: 0.2452 | reward: -0.2227 | rev_kl: 1.0396 | stu_lens: 119.5000 | mixed_lens: 93.5000 | lr: 3.7754e-06 | scale: 2048.00 | time: 26.542 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1720/  5000| tot_loss: 1.7595 | rl_loss: 0.5542 | pt_loss: 1.2053 | pg_loss: 0.0210 | reg_loss: 0.5333 | reward: -0.2949 | rev_kl: 1.3524 | stu_lens: 105.5000 | mixed_lens: 128.0000 | lr: 3.7740e-06 | scale: 2048.00 | time: 26.484 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1721/  5000| tot_loss: 2.3604 | rl_loss: 0.6594 | pt_loss: 1.7010 | pg_loss: 0.1373 | reg_loss: 0.5221 | reward: -0.2318 | rev_kl: 0.9018 | stu_lens: 128.0000 | mixed_lens: 114.0000 | lr: 3.7726e-06 | scale: 2048.00 | time: 26.499 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1722/  5000| tot_loss: 2.6191 | rl_loss: 0.9352 | pt_loss: 1.6839 | pg_loss: 0.5015 | reg_loss: 0.4337 | reward: -0.4107 | rev_kl: 0.8527 | stu_lens: 82.0000 | mixed_lens: 63.0000 | lr: 3.7712e-06 | scale: 2048.00 | time: 26.487 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1723/  5000| tot_loss: 2.6232 | rl_loss: 0.6926 | pt_loss: 1.9306 | pg_loss: 0.2776 | reg_loss: 0.4150 | reward: -0.2735 | rev_kl: 1.3996 | stu_lens: 85.5000 | mixed_lens: 93.0000 | lr: 3.7698e-06 | scale: 2048.00 | time: 26.501 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1724/  5000| tot_loss: 2.2121 | rl_loss: 0.9691 | pt_loss: 1.2430 | pg_loss: 0.5277 | reg_loss: 0.4414 | reward: -0.2729 | rev_kl: 0.7774 | stu_lens: 75.0000 | mixed_lens: 69.0000 | lr: 3.7685e-06 | scale: 2048.00 | time: 26.477 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1725/  5000| tot_loss: 2.2585 | rl_loss: 0.4176 | pt_loss: 1.8409 | pg_loss: -0.0090 | reg_loss: 0.4266 | reward: -0.2606 | rev_kl: 1.1601 | stu_lens: 86.5000 | mixed_lens: 128.0000 | lr: 3.7671e-06 | scale: 2048.00 | time: 26.543 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1726/  5000| tot_loss: 1.9120 | rl_loss: 0.6655 | pt_loss: 1.2465 | pg_loss: 0.0471 | reg_loss: 0.6184 | reward: -0.3072 | rev_kl: 1.3676 | stu_lens: 95.5000 | mixed_lens: 128.0000 | lr: 3.7657e-06 | scale: 2048.00 | time: 26.508 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1727/  5000| tot_loss: 2.4335 | rl_loss: 0.9379 | pt_loss: 1.4955 | pg_loss: 0.7030 | reg_loss: 0.2349 | reward: -0.7618 | rev_kl: 0.9249 | stu_lens: 43.5000 | mixed_lens: 34.0000 | lr: 3.7643e-06 | scale: 2048.00 | time: 26.526 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1728/  5000| tot_loss: 1.7371 | rl_loss: 0.3986 | pt_loss: 1.3385 | pg_loss: 0.0224 | reg_loss: 0.3762 | reward: -0.1308 | rev_kl: 0.7514 | stu_lens: 105.0000 | mixed_lens: 128.0000 | lr: 3.7629e-06 | scale: 2048.00 | time: 26.529 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1728/  5000| tot_loss: 2.4555 | rl_loss: 0.7694 | pt_loss: 1.6861 | pg_loss: 0.3183 | reg_loss: 0.4511 | reward: -0.6057 | rev_kl: 1.0362 | stu_lens: 83.7812 | mixed_lens: 86.6719 | lr: 3.7629e-06 | scale: 2048.00 | time: 26.529 | step time: 27.763
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1729/  5000| tot_loss: 1.8475 | rl_loss: 0.2801 | pt_loss: 1.5673 | pg_loss: 0.0236 | reg_loss: 0.2566 | reward: -0.1502 | rev_kl: 1.4014 | stu_lens: 76.0000 | mixed_lens: 128.0000 | lr: 3.7615e-06 | scale: 2048.00 | time: 26.523 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1730/  5000| tot_loss: 3.1459 | rl_loss: 1.1788 | pt_loss: 1.9671 | pg_loss: 0.4422 | reg_loss: 0.7366 | reward: -0.4887 | rev_kl: 0.6557 | stu_lens: 119.5000 | mixed_lens: 57.5000 | lr: 3.7602e-06 | scale: 2048.00 | time: 26.467 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1731/  5000| tot_loss: 2.6440 | rl_loss: 0.9106 | pt_loss: 1.7334 | pg_loss: 0.0309 | reg_loss: 0.8797 | reward: -0.3491 | rev_kl: 0.8759 | stu_lens: 75.5000 | mixed_lens: 128.0000 | lr: 3.7588e-06 | scale: 2048.00 | time: 26.498 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1732/  5000| tot_loss: 3.7706 | rl_loss: 1.7949 | pt_loss: 1.9756 | pg_loss: 0.2680 | reg_loss: 1.5270 | reward: -0.4062 | rev_kl: 0.9440 | stu_lens: 128.0000 | mixed_lens: 71.0000 | lr: 3.7574e-06 | scale: 2048.00 | time: 26.446 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1733/  5000| tot_loss: 3.1579 | rl_loss: 1.5149 | pt_loss: 1.6430 | pg_loss: 0.2366 | reg_loss: 1.2783 | reward: -0.5255 | rev_kl: 1.2558 | stu_lens: 70.5000 | mixed_lens: 89.0000 | lr: 3.7560e-06 | scale: 2048.00 | time: 26.468 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1734/  5000| tot_loss: 3.7014 | rl_loss: 2.0857 | pt_loss: 1.6157 | pg_loss: 0.8353 | reg_loss: 1.2503 | reward: -0.3889 | rev_kl: 1.5974 | stu_lens: 45.0000 | mixed_lens: 56.0000 | lr: 3.7546e-06 | scale: 2048.00 | time: 26.470 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1735/  5000| tot_loss: 2.9871 | rl_loss: 0.9335 | pt_loss: 2.0536 | pg_loss: 0.0443 | reg_loss: 0.8892 | reward: 0.1030 | rev_kl: 1.1846 | stu_lens: 72.0000 | mixed_lens: 128.0000 | lr: 3.7532e-06 | scale: 2048.00 | time: 26.494 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1736/  5000| tot_loss: 2.4048 | rl_loss: 1.0431 | pt_loss: 1.3617 | pg_loss: 0.1587 | reg_loss: 0.8844 | reward: -0.1174 | rev_kl: 0.6722 | stu_lens: 51.0000 | mixed_lens: 84.0000 | lr: 3.7519e-06 | scale: 2048.00 | time: 26.468 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1737/  5000| tot_loss: 3.4060 | rl_loss: 1.1792 | pt_loss: 2.2268 | pg_loss: 0.5796 | reg_loss: 0.5996 | reward: -0.1615 | rev_kl: 1.3968 | stu_lens: 46.5000 | mixed_lens: 53.0000 | lr: 3.7505e-06 | scale: 2048.00 | time: 26.537 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1738/  5000| tot_loss: 3.5553 | rl_loss: 1.8438 | pt_loss: 1.7115 | pg_loss: 0.2518 | reg_loss: 1.5920 | reward: -0.2635 | rev_kl: 0.9325 | stu_lens: 128.0000 | mixed_lens: 94.0000 | lr: 3.7491e-06 | scale: 2048.00 | time: 26.514 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1739/  5000| tot_loss: 2.5569 | rl_loss: 0.8597 | pt_loss: 1.6972 | pg_loss: 0.3341 | reg_loss: 0.5256 | reward: -0.4465 | rev_kl: 1.0722 | stu_lens: 67.0000 | mixed_lens: 75.0000 | lr: 3.7477e-06 | scale: 2048.00 | time: 26.559 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1740/  5000| tot_loss: 3.4979 | rl_loss: 1.7077 | pt_loss: 1.7902 | pg_loss: 0.2990 | reg_loss: 1.4087 | reward: -0.2450 | rev_kl: 0.9702 | stu_lens: 105.5000 | mixed_lens: 97.0000 | lr: 3.7463e-06 | scale: 2048.00 | time: 26.532 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1741/  5000| tot_loss: 2.8773 | rl_loss: 1.4631 | pt_loss: 1.4141 | pg_loss: 0.1602 | reg_loss: 1.3030 | reward: -0.1070 | rev_kl: 1.3028 | stu_lens: 112.0000 | mixed_lens: 108.5000 | lr: 3.7449e-06 | scale: 2048.00 | time: 26.534 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1742/  5000| tot_loss: 2.4851 | rl_loss: 0.8722 | pt_loss: 1.6130 | pg_loss: 0.0343 | reg_loss: 0.8378 | reward: -0.2360 | rev_kl: 0.8239 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7435e-06 | scale: 2048.00 | time: 26.512 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1743/  5000| tot_loss: 2.7112 | rl_loss: 1.1625 | pt_loss: 1.5486 | pg_loss: 0.0410 | reg_loss: 1.1215 | reward: -0.0047 | rev_kl: 0.5057 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7421e-06 | scale: 2048.00 | time: 26.527 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1744/  5000| tot_loss: 3.4272 | rl_loss: 1.5629 | pt_loss: 1.8644 | pg_loss: 0.3429 | reg_loss: 1.2200 | reward: -0.4244 | rev_kl: 0.7344 | stu_lens: 41.5000 | mixed_lens: 87.5000 | lr: 3.7407e-06 | scale: 2048.00 | time: 26.499 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1744/  5000| tot_loss: 3.1092 | rl_loss: 1.4010 | pt_loss: 1.7082 | pg_loss: 0.2836 | reg_loss: 1.1174 | reward: -0.2611 | rev_kl: 1.1903 | stu_lens: 84.9219 | mixed_lens: 89.7969 | lr: 3.7407e-06 | scale: 2048.00 | time: 26.499 | step time: 27.760
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1745/  5000| tot_loss: 2.5718 | rl_loss: 1.2765 | pt_loss: 1.2953 | pg_loss: 0.0514 | reg_loss: 1.2251 | reward: -0.2435 | rev_kl: 1.1388 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7393e-06 | scale: 2048.00 | time: 26.531 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1746/  5000| tot_loss: 2.6244 | rl_loss: 0.8099 | pt_loss: 1.8145 | pg_loss: 0.0453 | reg_loss: 0.7646 | reward: -0.1865 | rev_kl: 0.8582 | stu_lens: 92.5000 | mixed_lens: 124.5000 | lr: 3.7380e-06 | scale: 2048.00 | time: 26.494 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1747/  5000| tot_loss: 3.0695 | rl_loss: 1.3643 | pt_loss: 1.7053 | pg_loss: 0.5497 | reg_loss: 0.8146 | reward: -0.5666 | rev_kl: 0.8890 | stu_lens: 128.0000 | mixed_lens: 32.0000 | lr: 3.7366e-06 | scale: 2048.00 | time: 26.508 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1748/  5000| tot_loss: 2.7708 | rl_loss: 1.3147 | pt_loss: 1.4561 | pg_loss: 0.2285 | reg_loss: 1.0862 | reward: -0.3223 | rev_kl: 0.7990 | stu_lens: 77.0000 | mixed_lens: 87.5000 | lr: 3.7352e-06 | scale: 2048.00 | time: 26.482 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1749/  5000| tot_loss: 2.4597 | rl_loss: 1.0752 | pt_loss: 1.3845 | pg_loss: 0.2858 | reg_loss: 0.7894 | reward: -0.2704 | rev_kl: 1.1253 | stu_lens: 109.0000 | mixed_lens: 72.0000 | lr: 3.7338e-06 | scale: 2048.00 | time: 26.501 | step time: 0.000
[2023-12-19 13:00:59,377] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, reducing to 1024
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/1750
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1750/  5000| tot_loss: 2.3547 | rl_loss: 0.5241 | pt_loss: 1.8307 | pg_loss: 0.0426 | reg_loss: 0.4815 | reward: -0.2236 | rev_kl: 0.7904 | stu_lens: 101.0000 | mixed_lens: 128.0000 | lr: 3.7338e-06 | scale: 1024.00 | time: 2.833 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1751/  5000| tot_loss: 2.1707 | rl_loss: 0.7460 | pt_loss: 1.4247 | pg_loss: 0.0074 | reg_loss: 0.7386 | reward: -0.3901 | rev_kl: 1.5603 | stu_lens: 92.5000 | mixed_lens: 128.0000 | lr: 3.7324e-06 | scale: 1024.00 | time: 26.498 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1752/  5000| tot_loss: 2.5403 | rl_loss: 0.5989 | pt_loss: 1.9414 | pg_loss: 0.1373 | reg_loss: 0.4615 | reward: -0.3352 | rev_kl: 0.4483 | stu_lens: 95.0000 | mixed_lens: 97.0000 | lr: 3.7310e-06 | scale: 1024.00 | time: 26.492 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1753/  5000| tot_loss: 2.2483 | rl_loss: 0.7443 | pt_loss: 1.5040 | pg_loss: 0.0282 | reg_loss: 0.7161 | reward: -0.1505 | rev_kl: 1.2317 | stu_lens: 93.0000 | mixed_lens: 128.0000 | lr: 3.7296e-06 | scale: 1024.00 | time: 26.470 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1754/  5000| tot_loss: 2.6975 | rl_loss: 0.9018 | pt_loss: 1.7958 | pg_loss: -0.0005 | reg_loss: 0.9023 | reward: -0.2338 | rev_kl: 1.4876 | stu_lens: 94.0000 | mixed_lens: 128.0000 | lr: 3.7282e-06 | scale: 1024.00 | time: 26.530 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1755/  5000| tot_loss: 3.2970 | rl_loss: 1.5595 | pt_loss: 1.7375 | pg_loss: 0.6963 | reg_loss: 0.8632 | reward: -0.3072 | rev_kl: 1.6108 | stu_lens: 43.5000 | mixed_lens: 43.5000 | lr: 3.7268e-06 | scale: 1024.00 | time: 26.512 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1756/  5000| tot_loss: 2.1653 | rl_loss: 0.6538 | pt_loss: 1.5115 | pg_loss: 0.3646 | reg_loss: 0.2893 | reward: -0.2781 | rev_kl: 0.9980 | stu_lens: 52.0000 | mixed_lens: 57.5000 | lr: 3.7254e-06 | scale: 1024.00 | time: 26.558 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1757/  5000| tot_loss: 1.9654 | rl_loss: 0.1715 | pt_loss: 1.7939 | pg_loss: -0.0386 | reg_loss: 0.2101 | reward: -0.1012 | rev_kl: 0.4696 | stu_lens: 120.0000 | mixed_lens: 99.5000 | lr: 3.7240e-06 | scale: 1024.00 | time: 26.557 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1758/  5000| tot_loss: 2.6850 | rl_loss: 1.0507 | pt_loss: 1.6343 | pg_loss: 0.1618 | reg_loss: 0.8889 | reward: -0.1353 | rev_kl: 0.9961 | stu_lens: 128.0000 | mixed_lens: 94.0000 | lr: 3.7226e-06 | scale: 1024.00 | time: 26.537 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1759/  5000| tot_loss: 2.9192 | rl_loss: 1.0824 | pt_loss: 1.8368 | pg_loss: 0.2564 | reg_loss: 0.8260 | reward: -0.1370 | rev_kl: 0.9283 | stu_lens: 78.0000 | mixed_lens: 84.0000 | lr: 3.7212e-06 | scale: 1024.00 | time: 26.557 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1760/  5000| tot_loss: 2.6977 | rl_loss: 0.8221 | pt_loss: 1.8756 | pg_loss: 0.0511 | reg_loss: 0.7710 | reward: -0.2225 | rev_kl: 1.1297 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7198e-06 | scale: 1024.00 | time: 26.502 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1760/  5000| tot_loss: 2.8212 | rl_loss: 1.1505 | pt_loss: 1.6707 | pg_loss: 0.3850 | reg_loss: 0.7656 | reward: -0.2522 | rev_kl: 1.1746 | stu_lens: 88.0938 | mixed_lens: 91.6875 | lr: 3.7198e-06 | scale: 1024.00 | time: 26.502 | step time: 26.286
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1761/  5000| tot_loss: 3.9153 | rl_loss: 2.5414 | pt_loss: 1.3738 | pg_loss: 2.2702 | reg_loss: 0.2712 | reward: -0.3295 | rev_kl: 0.7633 | stu_lens: 6.5000 | mixed_lens: 14.5000 | lr: 3.7184e-06 | scale: 1024.00 | time: 26.528 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1762/  5000| tot_loss: 2.1142 | rl_loss: 0.7063 | pt_loss: 1.4079 | pg_loss: 0.0465 | reg_loss: 0.6598 | reward: -0.2492 | rev_kl: 1.7770 | stu_lens: 120.0000 | mixed_lens: 128.0000 | lr: 3.7170e-06 | scale: 1024.00 | time: 26.507 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1763/  5000| tot_loss: 2.5950 | rl_loss: 0.9419 | pt_loss: 1.6531 | pg_loss: 0.3878 | reg_loss: 0.5540 | reward: -0.5435 | rev_kl: 0.9204 | stu_lens: 75.5000 | mixed_lens: 71.0000 | lr: 3.7156e-06 | scale: 1024.00 | time: 26.524 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1764/  5000| tot_loss: 1.8527 | rl_loss: 0.5723 | pt_loss: 1.2805 | pg_loss: 0.1522 | reg_loss: 0.4200 | reward: 0.5093 | rev_kl: 1.2372 | stu_lens: 71.5000 | mixed_lens: 66.0000 | lr: 3.7142e-06 | scale: 1024.00 | time: 26.535 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1765/  5000| tot_loss: 2.4580 | rl_loss: 0.7203 | pt_loss: 1.7377 | pg_loss: 0.0011 | reg_loss: 0.7193 | reward: -0.2973 | rev_kl: 1.3623 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7128e-06 | scale: 1024.00 | time: 26.535 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1766/  5000| tot_loss: 2.3345 | rl_loss: 0.7814 | pt_loss: 1.5531 | pg_loss: 0.0991 | reg_loss: 0.6823 | reward: -0.2448 | rev_kl: 1.0789 | stu_lens: 70.0000 | mixed_lens: 119.0000 | lr: 3.7114e-06 | scale: 1024.00 | time: 26.522 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1767/  5000| tot_loss: 2.7823 | rl_loss: 0.9667 | pt_loss: 1.8156 | pg_loss: 0.4824 | reg_loss: 0.4843 | reward: -0.2922 | rev_kl: 0.5708 | stu_lens: 72.5000 | mixed_lens: 73.0000 | lr: 3.7100e-06 | scale: 1024.00 | time: 26.539 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1768/  5000| tot_loss: 2.6258 | rl_loss: 0.8240 | pt_loss: 1.8018 | pg_loss: 0.1517 | reg_loss: 0.6723 | reward: -0.2307 | rev_kl: 1.0377 | stu_lens: 120.0000 | mixed_lens: 108.5000 | lr: 3.7086e-06 | scale: 1024.00 | time: 26.517 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1769/  5000| tot_loss: 1.9447 | rl_loss: 0.4440 | pt_loss: 1.5007 | pg_loss: 0.0426 | reg_loss: 0.4014 | reward: -0.1306 | rev_kl: 1.6986 | stu_lens: 83.5000 | mixed_lens: 59.0000 | lr: 3.7072e-06 | scale: 1024.00 | time: 26.539 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1770/  5000| tot_loss: 1.7219 | rl_loss: 0.4766 | pt_loss: 1.2453 | pg_loss: 0.1769 | reg_loss: 0.2997 | reward: -0.3138 | rev_kl: 5.5749 | stu_lens: 90.0000 | mixed_lens: 87.5000 | lr: 3.7058e-06 | scale: 1024.00 | time: 26.557 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1771/  5000| tot_loss: 2.1027 | rl_loss: 0.8786 | pt_loss: 1.2240 | pg_loss: 0.2025 | reg_loss: 0.6761 | reward: 0.1539 | rev_kl: 0.9398 | stu_lens: 100.0000 | mixed_lens: 73.5000 | lr: 3.7044e-06 | scale: 1024.00 | time: 26.529 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1772/  5000| tot_loss: 3.4431 | rl_loss: 1.2095 | pt_loss: 2.2336 | pg_loss: 0.3734 | reg_loss: 0.8361 | reward: -0.2193 | rev_kl: 0.5404 | stu_lens: 27.0000 | mixed_lens: 43.5000 | lr: 3.7030e-06 | scale: 1024.00 | time: 26.502 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1773/  5000| tot_loss: 3.0813 | rl_loss: 1.1866 | pt_loss: 1.8947 | pg_loss: 0.3821 | reg_loss: 0.8045 | reward: -0.2426 | rev_kl: 1.6899 | stu_lens: 55.5000 | mixed_lens: 77.0000 | lr: 3.7016e-06 | scale: 1024.00 | time: 26.529 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1774/  5000| tot_loss: 1.9802 | rl_loss: 0.4833 | pt_loss: 1.4969 | pg_loss: 0.1119 | reg_loss: 0.3714 | reward: -0.3010 | rev_kl: 0.8477 | stu_lens: 86.5000 | mixed_lens: 109.5000 | lr: 3.7002e-06 | scale: 1024.00 | time: 26.504 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1775/  5000| tot_loss: 2.4504 | rl_loss: 0.9370 | pt_loss: 1.5134 | pg_loss: 0.1774 | reg_loss: 0.7596 | reward: -0.1402 | rev_kl: 1.7561 | stu_lens: 94.0000 | mixed_lens: 102.0000 | lr: 3.6988e-06 | scale: 1024.00 | time: 26.523 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1776/  5000| tot_loss: 2.2919 | rl_loss: 0.9904 | pt_loss: 1.3015 | pg_loss: 0.6610 | reg_loss: 0.3294 | reward: -0.3585 | rev_kl: 0.9692 | stu_lens: 37.0000 | mixed_lens: 45.5000 | lr: 3.6974e-06 | scale: 1024.00 | time: 26.503 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1776/  5000| tot_loss: 2.4752 | rl_loss: 0.8487 | pt_loss: 1.6266 | pg_loss: 0.3077 | reg_loss: 0.5410 | reward: -0.2432 | rev_kl: 1.2037 | stu_lens: 85.9062 | mixed_lens: 87.2812 | lr: 3.6974e-06 | scale: 1024.00 | time: 26.503 | step time: 27.787
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1777/  5000| tot_loss: 2.1683 | rl_loss: 1.0306 | pt_loss: 1.1377 | pg_loss: 0.6508 | reg_loss: 0.3798 | reward: -0.7627 | rev_kl: 0.5391 | stu_lens: 101.0000 | mixed_lens: 69.5000 | lr: 3.6959e-06 | scale: 1024.00 | time: 26.524 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1778/  5000| tot_loss: 3.5624 | rl_loss: 1.9579 | pt_loss: 1.6044 | pg_loss: 1.4788 | reg_loss: 0.4791 | reward: -0.6779 | rev_kl: 0.6077 | stu_lens: 73.5000 | mixed_lens: 25.5000 | lr: 3.6945e-06 | scale: 1024.00 | time: 26.480 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1779/  5000| tot_loss: 2.7485 | rl_loss: 1.1052 | pt_loss: 1.6433 | pg_loss: 0.4136 | reg_loss: 0.6917 | reward: -0.2998 | rev_kl: 1.0716 | stu_lens: 128.0000 | mixed_lens: 71.0000 | lr: 3.6931e-06 | scale: 1024.00 | time: 26.498 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1780/  5000| tot_loss: 2.2802 | rl_loss: 0.6049 | pt_loss: 1.6753 | pg_loss: -0.0109 | reg_loss: 0.6158 | reward: -0.1205 | rev_kl: 1.2344 | stu_lens: 94.0000 | mixed_lens: 128.0000 | lr: 3.6917e-06 | scale: 1024.00 | time: 26.492 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1781/  5000| tot_loss: 2.9205 | rl_loss: 1.2269 | pt_loss: 1.6936 | pg_loss: 0.6604 | reg_loss: 0.5665 | reward: -0.7697 | rev_kl: 0.7863 | stu_lens: 120.0000 | mixed_lens: 50.0000 | lr: 3.6903e-06 | scale: 1024.00 | time: 26.486 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1782/  5000| tot_loss: 2.2064 | rl_loss: 0.6800 | pt_loss: 1.5264 | pg_loss: 0.3008 | reg_loss: 0.3793 | reward: -0.5140 | rev_kl: 1.5011 | stu_lens: 67.0000 | mixed_lens: 75.0000 | lr: 3.6889e-06 | scale: 1024.00 | time: 26.533 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1783/  5000| tot_loss: 1.8400 | rl_loss: 0.3646 | pt_loss: 1.4754 | pg_loss: 0.0281 | reg_loss: 0.3365 | reward: -0.1235 | rev_kl: 0.9332 | stu_lens: 120.0000 | mixed_lens: 99.5000 | lr: 3.6875e-06 | scale: 1024.00 | time: 26.558 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1784/  5000| tot_loss: 2.1343 | rl_loss: 0.5083 | pt_loss: 1.6260 | pg_loss: 0.0106 | reg_loss: 0.4977 | reward: -0.2879 | rev_kl: 1.6249 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6861e-06 | scale: 1024.00 | time: 26.522 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1785/  5000| tot_loss: 2.5762 | rl_loss: 1.0188 | pt_loss: 1.5573 | pg_loss: 0.5011 | reg_loss: 0.5177 | reward: -0.4417 | rev_kl: 1.3542 | stu_lens: 75.0000 | mixed_lens: 63.0000 | lr: 3.6847e-06 | scale: 1024.00 | time: 26.551 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1786/  5000| tot_loss: 1.8806 | rl_loss: 0.4145 | pt_loss: 1.4662 | pg_loss: 0.0078 | reg_loss: 0.4067 | reward: -0.2889 | rev_kl: 1.1420 | stu_lens: 70.5000 | mixed_lens: 128.0000 | lr: 3.6833e-06 | scale: 1024.00 | time: 26.525 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1787/  5000| tot_loss: 1.9467 | rl_loss: 0.4721 | pt_loss: 1.4747 | pg_loss: 0.0005 | reg_loss: 0.4716 | reward: -0.3005 | rev_kl: 1.2220 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6818e-06 | scale: 1024.00 | time: 26.606 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1788/  5000| tot_loss: 1.7412 | rl_loss: 0.7135 | pt_loss: 1.0278 | pg_loss: 0.0807 | reg_loss: 0.6328 | reward: -0.4734 | rev_kl: 1.2716 | stu_lens: 90.5000 | mixed_lens: 116.0000 | lr: 3.6804e-06 | scale: 1024.00 | time: 26.568 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1789/  5000| tot_loss: 2.0905 | rl_loss: 0.4938 | pt_loss: 1.5966 | pg_loss: 0.2335 | reg_loss: 0.2603 | reward: -0.3657 | rev_kl: 5.7869 | stu_lens: 90.0000 | mixed_lens: 87.5000 | lr: 3.6790e-06 | scale: 1024.00 | time: 26.541 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1790/  5000| tot_loss: 2.6752 | rl_loss: 1.0975 | pt_loss: 1.5778 | pg_loss: 0.5377 | reg_loss: 0.5597 | reward: -0.3930 | rev_kl: 0.4585 | stu_lens: 32.0000 | mixed_lens: 39.5000 | lr: 3.6776e-06 | scale: 1024.00 | time: 26.581 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1791/  5000| tot_loss: 2.6685 | rl_loss: 0.6037 | pt_loss: 2.0648 | pg_loss: 0.0419 | reg_loss: 0.5618 | reward: -0.1633 | rev_kl: 0.9053 | stu_lens: 85.5000 | mixed_lens: 122.5000 | lr: 3.6762e-06 | scale: 1024.00 | time: 26.630 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1792/  5000| tot_loss: 2.7686 | rl_loss: 0.7737 | pt_loss: 1.9949 | pg_loss: 0.3475 | reg_loss: 0.4262 | reward: -0.3236 | rev_kl: 1.8968 | stu_lens: 56.0000 | mixed_lens: 87.5000 | lr: 3.6748e-06 | scale: 1024.00 | time: 26.592 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1792/  5000| tot_loss: 2.3470 | rl_loss: 0.7078 | pt_loss: 1.6392 | pg_loss: 0.2542 | reg_loss: 0.4536 | reward: -0.2745 | rev_kl: 1.1848 | stu_lens: 85.7031 | mixed_lens: 92.3438 | lr: 3.6748e-06 | scale: 1024.00 | time: 26.592 | step time: 27.805
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1793/  5000| tot_loss: 2.2966 | rl_loss: 0.5572 | pt_loss: 1.7394 | pg_loss: 0.1560 | reg_loss: 0.4012 | reward: -0.0822 | rev_kl: 0.4044 | stu_lens: 67.5000 | mixed_lens: 67.5000 | lr: 3.6734e-06 | scale: 1024.00 | time: 26.582 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1794/  5000| tot_loss: 3.0155 | rl_loss: 1.2165 | pt_loss: 1.7989 | pg_loss: 0.3961 | reg_loss: 0.8204 | reward: -0.8027 | rev_kl: 0.6299 | stu_lens: 102.0000 | mixed_lens: 72.5000 | lr: 3.6719e-06 | scale: 1024.00 | time: 26.594 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1795/  5000| tot_loss: 3.4521 | rl_loss: 2.3509 | pt_loss: 1.1012 | pg_loss: 1.3009 | reg_loss: 1.0500 | reward: -0.7616 | rev_kl: 2.6869 | stu_lens: 28.0000 | mixed_lens: 33.5000 | lr: 3.6705e-06 | scale: 1024.00 | time: 26.526 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1796/  5000| tot_loss: 4.1266 | rl_loss: 2.4933 | pt_loss: 1.6332 | pg_loss: 0.8853 | reg_loss: 1.6080 | reward: -0.2407 | rev_kl: 1.6025 | stu_lens: 38.5000 | mixed_lens: 39.5000 | lr: 3.6691e-06 | scale: 1024.00 | time: 26.539 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1797/  5000| tot_loss: 3.0663 | rl_loss: 1.7348 | pt_loss: 1.3315 | pg_loss: 0.3022 | reg_loss: 1.4326 | reward: -0.8439 | rev_kl: 1.4127 | stu_lens: 112.0000 | mixed_lens: 89.0000 | lr: 3.6677e-06 | scale: 1024.00 | time: 26.519 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1798/  5000| tot_loss: 3.2977 | rl_loss: 1.5626 | pt_loss: 1.7351 | pg_loss: 0.2599 | reg_loss: 1.3027 | reward: -0.4117 | rev_kl: 9.0174 | stu_lens: 56.5000 | mixed_lens: 63.0000 | lr: 3.6663e-06 | scale: 1024.00 | time: 26.582 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1799/  5000| tot_loss: 3.0869 | rl_loss: 1.4568 | pt_loss: 1.6301 | pg_loss: 0.4374 | reg_loss: 1.0194 | reward: -0.0387 | rev_kl: 0.9470 | stu_lens: 106.0000 | mixed_lens: 75.5000 | lr: 3.6649e-06 | scale: 1024.00 | time: 26.525 | step time: 0.000
                                 Evaluation #18                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Yes, Bob should leave Alice. He has  │
│                                       │ a 31% chance of survival if he stays │
│                                       │ with Alice, and a 9% chance if he    │
│                                       │ leaves her.                          │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ The kezboard is a keyboard that uses │
│                                       │ a keyboard layout that is optimized  │
│                                       │ for typing Hanzi. The keyboard       │
│                                       │ layout is based on the QWERTY        │
│                                       │ keyboard and has the same key        │
│                                       │ layout. The keys are arranged in a   │
│                                       │ grid with the exception of the space │
│                                       │ bar which is in the top left corner. │
│                                       │ The keys along the top row are not   │
│                                       │ laid out in a straight line but are  │
│                                       │ curved towards the middle. This      │
│                                       │ results in a key layout that is      │
│                                       │ optimized for typing Chinese         │
│                                       │ characters. The kezboard does not    │
│                                       │ use a keyerem that is optimized for  │
│                                       │ typing English words. Instead it     │
│                                       │ uses a keyerem that is optimized for │
│                                       │ typing Chinese words                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support over 100 languages,       │
│                                       │ including Arabic, Chinese, English,  │
│                                       │ French, German, Italian, Japanese,   │
│                                       │ Korean, Polish, Portuguese, Russian, │
│                                       │ and Spanish.                         │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.487 | exact_match: 0.323 | rev_kl: 1.113 | lens: 87.198 | pt_loss: 1.078 | lm_loss: 1.160 | kd_loss: 0.997 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1800/  5000| tot_loss: 2.8132 | rl_loss: 1.2066 | pt_loss: 1.6066 | pg_loss: 0.5485 | reg_loss: 0.6581 | reward: -0.1313 | rev_kl: 3.1534 | stu_lens: 27.5000 | mixed_lens: 72.5000 | lr: 3.6634e-06 | scale: 1024.00 | time: 26.598 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1801/  5000| tot_loss: 3.4122 | rl_loss: 1.4810 | pt_loss: 1.9312 | pg_loss: 0.7040 | reg_loss: 0.7770 | reward: -0.2572 | rev_kl: 0.8012 | stu_lens: 31.5000 | mixed_lens: 30.0000 | lr: 3.6620e-06 | scale: 1024.00 | time: 26.660 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1802/  5000| tot_loss: 2.7352 | rl_loss: 1.2289 | pt_loss: 1.5063 | pg_loss: 0.0900 | reg_loss: 1.1389 | reward: -0.1616 | rev_kl: 0.8712 | stu_lens: 74.5000 | mixed_lens: 128.0000 | lr: 3.6606e-06 | scale: 1024.00 | time: 26.633 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1803/  5000| tot_loss: 3.3370 | rl_loss: 1.3000 | pt_loss: 2.0371 | pg_loss: 0.0741 | reg_loss: 1.2259 | reward: -0.1551 | rev_kl: 1.2069 | stu_lens: 86.0000 | mixed_lens: 125.5000 | lr: 3.6592e-06 | scale: 1024.00 | time: 26.578 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1804/  5000| tot_loss: 3.0069 | rl_loss: 1.5866 | pt_loss: 1.4202 | pg_loss: 0.2925 | reg_loss: 1.2942 | reward: -0.7447 | rev_kl: 1.3679 | stu_lens: 113.5000 | mixed_lens: 85.5000 | lr: 3.6578e-06 | scale: 1024.00 | time: 26.587 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1805/  5000| tot_loss: 3.1177 | rl_loss: 1.4700 | pt_loss: 1.6478 | pg_loss: 0.4460 | reg_loss: 1.0240 | reward: -0.3095 | rev_kl: 1.8580 | stu_lens: 38.0000 | mixed_lens: 87.0000 | lr: 3.6563e-06 | scale: 1024.00 | time: 26.568 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1806/  5000| tot_loss: 3.1349 | rl_loss: 1.1207 | pt_loss: 2.0141 | pg_loss: 0.2332 | reg_loss: 0.8875 | reward: -0.3977 | rev_kl: 1.0864 | stu_lens: 56.0000 | mixed_lens: 94.5000 | lr: 3.6549e-06 | scale: 1024.00 | time: 26.575 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1807/  5000| tot_loss: 3.8995 | rl_loss: 2.0698 | pt_loss: 1.8298 | pg_loss: 0.8218 | reg_loss: 1.2480 | reward: -0.6865 | rev_kl: 1.3616 | stu_lens: 88.0000 | mixed_lens: 64.0000 | lr: 3.6535e-06 | scale: 1024.00 | time: 26.531 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1808/  5000| tot_loss: 3.4357 | rl_loss: 1.6491 | pt_loss: 1.7867 | pg_loss: 0.4236 | reg_loss: 1.2255 | reward: -0.8483 | rev_kl: 1.0255 | stu_lens: 122.0000 | mixed_lens: 80.5000 | lr: 3.6521e-06 | scale: 1024.00 | time: 26.525 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1808/  5000| tot_loss: 3.1666 | rl_loss: 1.5158 | pt_loss: 1.6509 | pg_loss: 0.4113 | reg_loss: 1.1045 | reward: -0.3565 | rev_kl: 1.4532 | stu_lens: 76.2344 | mixed_lens: 77.0781 | lr: 3.6521e-06 | scale: 1024.00 | time: 26.525 | step time: 27.834
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1809/  5000| tot_loss: 3.4474 | rl_loss: 1.6475 | pt_loss: 1.7999 | pg_loss: 0.3096 | reg_loss: 1.3380 | reward: -0.7727 | rev_kl: 2.3204 | stu_lens: 74.0000 | mixed_lens: 93.5000 | lr: 3.6507e-06 | scale: 1024.00 | time: 26.551 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1810/  5000| tot_loss: 2.2748 | rl_loss: 1.0663 | pt_loss: 1.2086 | pg_loss: 0.1374 | reg_loss: 0.9289 | reward: -0.3509 | rev_kl: 1.0532 | stu_lens: 31.5000 | mixed_lens: 83.0000 | lr: 3.6492e-06 | scale: 1024.00 | time: 26.507 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1811/  5000| tot_loss: 4.3996 | rl_loss: 2.6039 | pt_loss: 1.7957 | pg_loss: 1.4895 | reg_loss: 1.1144 | reward: -0.8804 | rev_kl: 1.3433 | stu_lens: 76.0000 | mixed_lens: 24.0000 | lr: 3.6478e-06 | scale: 1024.00 | time: 26.575 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1812/  5000| tot_loss: 3.2765 | rl_loss: 1.7570 | pt_loss: 1.5195 | pg_loss: 0.7016 | reg_loss: 1.0553 | reward: -0.8630 | rev_kl: 1.4961 | stu_lens: 128.0000 | mixed_lens: 57.0000 | lr: 3.6464e-06 | scale: 1024.00 | time: 26.540 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1813/  5000| tot_loss: 2.6133 | rl_loss: 0.9556 | pt_loss: 1.6577 | pg_loss: 0.2325 | reg_loss: 0.7232 | reward: -0.6723 | rev_kl: 1.0547 | stu_lens: 92.5000 | mixed_lens: 64.5000 | lr: 3.6450e-06 | scale: 1024.00 | time: 26.562 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1814/  5000| tot_loss: 3.0808 | rl_loss: 1.3306 | pt_loss: 1.7503 | pg_loss: 0.3127 | reg_loss: 1.0178 | reward: -0.0974 | rev_kl: 1.7118 | stu_lens: 67.0000 | mixed_lens: 96.5000 | lr: 3.6435e-06 | scale: 1024.00 | time: 26.569 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1815/  5000| tot_loss: 2.2016 | rl_loss: 0.6867 | pt_loss: 1.5149 | pg_loss: 0.2522 | reg_loss: 0.4345 | reward: -0.1876 | rev_kl: 3.0747 | stu_lens: 50.5000 | mixed_lens: 72.5000 | lr: 3.6421e-06 | scale: 1024.00 | time: 26.558 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1816/  5000| tot_loss: 2.1786 | rl_loss: 0.6738 | pt_loss: 1.5048 | pg_loss: 0.0800 | reg_loss: 0.5939 | reward: -0.1256 | rev_kl: 1.0273 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6407e-06 | scale: 1024.00 | time: 26.518 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1817/  5000| tot_loss: 3.6654 | rl_loss: 1.5035 | pt_loss: 2.1619 | pg_loss: 0.7495 | reg_loss: 0.7540 | reward: -0.6680 | rev_kl: 8.9625 | stu_lens: 52.0000 | mixed_lens: 63.5000 | lr: 3.6393e-06 | scale: 1024.00 | time: 26.542 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1818/  5000| tot_loss: 2.9753 | rl_loss: 1.1467 | pt_loss: 1.8285 | pg_loss: 0.6575 | reg_loss: 0.4892 | reward: -0.4528 | rev_kl: 1.7487 | stu_lens: 9.5000 | mixed_lens: 30.0000 | lr: 3.6378e-06 | scale: 1024.00 | time: 26.517 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1819/  5000| tot_loss: 2.9374 | rl_loss: 1.2255 | pt_loss: 1.7119 | pg_loss: 0.5507 | reg_loss: 0.6748 | reward: -1.0867 | rev_kl: 0.8502 | stu_lens: 73.5000 | mixed_lens: 58.5000 | lr: 3.6364e-06 | scale: 1024.00 | time: 26.621 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1820/  5000| tot_loss: 2.4405 | rl_loss: 0.9601 | pt_loss: 1.4804 | pg_loss: 0.2561 | reg_loss: 0.7040 | reward: -0.0720 | rev_kl: 0.8165 | stu_lens: 120.5000 | mixed_lens: 80.5000 | lr: 3.6350e-06 | scale: 1024.00 | time: 26.529 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1821/  5000| tot_loss: 2.2537 | rl_loss: 0.6911 | pt_loss: 1.5627 | pg_loss: 0.3194 | reg_loss: 0.3717 | reward: -0.8778 | rev_kl: 0.9026 | stu_lens: 122.0000 | mixed_lens: 85.5000 | lr: 3.6335e-06 | scale: 1024.00 | time: 26.448 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1822/  5000| tot_loss: 2.9439 | rl_loss: 1.2204 | pt_loss: 1.7235 | pg_loss: 0.3258 | reg_loss: 0.8946 | reward: -0.2599 | rev_kl: 2.5013 | stu_lens: 68.5000 | mixed_lens: 86.5000 | lr: 3.6321e-06 | scale: 1024.00 | time: 26.436 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1823/  5000| tot_loss: 2.4755 | rl_loss: 0.6766 | pt_loss: 1.7989 | pg_loss: 0.0464 | reg_loss: 0.6302 | reward: -0.2408 | rev_kl: 0.9682 | stu_lens: 104.5000 | mixed_lens: 121.5000 | lr: 3.6307e-06 | scale: 1024.00 | time: 26.459 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1824/  5000| tot_loss: 2.8431 | rl_loss: 1.0537 | pt_loss: 1.7894 | pg_loss: 0.2619 | reg_loss: 0.7918 | reward: -0.1250 | rev_kl: 0.8494 | stu_lens: 77.0000 | mixed_lens: 79.5000 | lr: 3.6293e-06 | scale: 1024.00 | time: 26.429 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1824/  5000| tot_loss: 2.8681 | rl_loss: 1.1855 | pt_loss: 1.6826 | pg_loss: 0.3952 | reg_loss: 0.7902 | reward: -0.4042 | rev_kl: 1.5519 | stu_lens: 80.5781 | mixed_lens: 80.0938 | lr: 3.6293e-06 | scale: 1024.00 | time: 26.429 | step time: 27.782
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1825/  5000| tot_loss: 2.4395 | rl_loss: 0.6038 | pt_loss: 1.8357 | pg_loss: 0.0645 | reg_loss: 0.5393 | reward: -0.1804 | rev_kl: 1.0521 | stu_lens: 75.0000 | mixed_lens: 112.0000 | lr: 3.6278e-06 | scale: 1024.00 | time: 26.452 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1826/  5000| tot_loss: 2.7309 | rl_loss: 1.0740 | pt_loss: 1.6569 | pg_loss: 0.4978 | reg_loss: 0.5763 | reward: -0.0595 | rev_kl: 1.1778 | stu_lens: 71.5000 | mixed_lens: 47.0000 | lr: 3.6264e-06 | scale: 1024.00 | time: 26.515 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1827/  5000| tot_loss: 2.1863 | rl_loss: 0.6908 | pt_loss: 1.4954 | pg_loss: 0.3711 | reg_loss: 0.3197 | reward: 2.4774 | rev_kl: 1.5374 | stu_lens: 67.0000 | mixed_lens: 65.0000 | lr: 3.6250e-06 | scale: 1024.00 | time: 26.537 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1828/  5000| tot_loss: 2.9718 | rl_loss: 1.3617 | pt_loss: 1.6101 | pg_loss: 1.0035 | reg_loss: 0.3581 | reward: -1.5334 | rev_kl: 1.0392 | stu_lens: 106.0000 | mixed_lens: 46.5000 | lr: 3.6235e-06 | scale: 1024.00 | time: 26.483 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1829/  5000| tot_loss: 2.4117 | rl_loss: 0.7120 | pt_loss: 1.6997 | pg_loss: 0.3721 | reg_loss: 0.3399 | reward: -0.0912 | rev_kl: 0.6079 | stu_lens: 120.5000 | mixed_lens: 85.5000 | lr: 3.6221e-06 | scale: 1024.00 | time: 26.500 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1830/  5000| tot_loss: 2.1091 | rl_loss: 0.6617 | pt_loss: 1.4474 | pg_loss: 0.0223 | reg_loss: 0.6394 | reward: -0.3825 | rev_kl: 1.4923 | stu_lens: 38.5000 | mixed_lens: 128.0000 | lr: 3.6207e-06 | scale: 1024.00 | time: 26.493 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1831/  5000| tot_loss: 2.8618 | rl_loss: 1.0157 | pt_loss: 1.8461 | pg_loss: 0.7836 | reg_loss: 0.2321 | reward: -0.0887 | rev_kl: 1.7325 | stu_lens: 21.0000 | mixed_lens: 40.0000 | lr: 3.6192e-06 | scale: 1024.00 | time: 26.539 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1832/  5000| tot_loss: 2.6475 | rl_loss: 0.8099 | pt_loss: 1.8377 | pg_loss: 0.2034 | reg_loss: 0.6064 | reward: -0.2839 | rev_kl: 0.6703 | stu_lens: 93.5000 | mixed_lens: 95.0000 | lr: 3.6178e-06 | scale: 1024.00 | time: 26.485 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1833/  5000| tot_loss: 2.4341 | rl_loss: 0.9725 | pt_loss: 1.4617 | pg_loss: 0.3364 | reg_loss: 0.6361 | reward: -0.4172 | rev_kl: 1.6751 | stu_lens: 67.5000 | mixed_lens: 71.0000 | lr: 3.6164e-06 | scale: 1024.00 | time: 26.535 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1834/  5000| tot_loss: 2.1771 | rl_loss: 0.8325 | pt_loss: 1.3446 | pg_loss: 0.2170 | reg_loss: 0.6155 | reward: -0.9445 | rev_kl: 1.0954 | stu_lens: 45.0000 | mixed_lens: 75.0000 | lr: 3.6149e-06 | scale: 1024.00 | time: 26.548 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1835/  5000| tot_loss: 2.5729 | rl_loss: 0.8961 | pt_loss: 1.6768 | pg_loss: 0.3728 | reg_loss: 0.5233 | reward: -0.1550 | rev_kl: 0.9118 | stu_lens: 128.0000 | mixed_lens: 75.5000 | lr: 3.6135e-06 | scale: 1024.00 | time: 26.602 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1836/  5000| tot_loss: 2.3711 | rl_loss: 0.4666 | pt_loss: 1.9045 | pg_loss: 0.0052 | reg_loss: 0.4614 | reward: -0.1466 | rev_kl: 1.0206 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6121e-06 | scale: 1024.00 | time: 26.535 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1837/  5000| tot_loss: 2.6632 | rl_loss: 0.9732 | pt_loss: 1.6901 | pg_loss: 0.5427 | reg_loss: 0.4305 | reward: -0.9169 | rev_kl: 0.9736 | stu_lens: 100.5000 | mixed_lens: 70.5000 | lr: 3.6106e-06 | scale: 1024.00 | time: 26.590 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1838/  5000| tot_loss: 2.4543 | rl_loss: 0.5815 | pt_loss: 1.8728 | pg_loss: 0.0067 | reg_loss: 0.5748 | reward: -0.0912 | rev_kl: 0.9727 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6092e-06 | scale: 1024.00 | time: 26.560 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1839/  5000| tot_loss: 2.3806 | rl_loss: 0.6359 | pt_loss: 1.7447 | pg_loss: 0.3593 | reg_loss: 0.2766 | reward: 0.0165 | rev_kl: 0.7768 | stu_lens: 58.0000 | mixed_lens: 75.5000 | lr: 3.6078e-06 | scale: 1024.00 | time: 26.578 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1840/  5000| tot_loss: 2.3515 | rl_loss: 1.0445 | pt_loss: 1.3070 | pg_loss: 0.6104 | reg_loss: 0.4341 | reward: -0.8380 | rev_kl: 1.2186 | stu_lens: 44.0000 | mixed_lens: 46.5000 | lr: 3.6063e-06 | scale: 1024.00 | time: 26.528 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1840/  5000| tot_loss: 2.5298 | rl_loss: 0.8787 | pt_loss: 1.6512 | pg_loss: 0.3455 | reg_loss: 0.5332 | reward: -0.3692 | rev_kl: 1.5030 | stu_lens: 75.7812 | mixed_lens: 79.4531 | lr: 3.6063e-06 | scale: 1024.00 | time: 26.528 | step time: 27.791
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1841/  5000| tot_loss: 1.7191 | rl_loss: 0.4888 | pt_loss: 1.2302 | pg_loss: -0.0047 | reg_loss: 0.4935 | reward: -0.2673 | rev_kl: 1.2004 | stu_lens: 91.5000 | mixed_lens: 128.0000 | lr: 3.6049e-06 | scale: 1024.00 | time: 26.578 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1842/  5000| tot_loss: 2.0048 | rl_loss: 0.5646 | pt_loss: 1.4402 | pg_loss: 0.0168 | reg_loss: 0.5479 | reward: -0.4626 | rev_kl: 1.5050 | stu_lens: 93.5000 | mixed_lens: 128.0000 | lr: 3.6034e-06 | scale: 1024.00 | time: 26.546 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1843/  5000| tot_loss: 2.5264 | rl_loss: 0.8522 | pt_loss: 1.6742 | pg_loss: 0.1416 | reg_loss: 0.7106 | reward: -0.4364 | rev_kl: 1.3725 | stu_lens: 39.5000 | mixed_lens: 94.5000 | lr: 3.6020e-06 | scale: 1024.00 | time: 26.573 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1844/  5000| tot_loss: 2.5392 | rl_loss: 0.8813 | pt_loss: 1.6579 | pg_loss: 0.3065 | reg_loss: 0.5748 | reward: -0.0645 | rev_kl: 1.0973 | stu_lens: 128.0000 | mixed_lens: 79.5000 | lr: 3.6006e-06 | scale: 1024.00 | time: 26.521 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1845/  5000| tot_loss: 2.0509 | rl_loss: 0.5319 | pt_loss: 1.5190 | pg_loss: -0.0046 | reg_loss: 0.5365 | reward: -0.4147 | rev_kl: 1.3537 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5991e-06 | scale: 1024.00 | time: 26.538 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1846/  5000| tot_loss: 2.3542 | rl_loss: 0.3275 | pt_loss: 2.0267 | pg_loss: 0.0613 | reg_loss: 0.2661 | reward: -0.2846 | rev_kl: 1.0735 | stu_lens: 69.0000 | mixed_lens: 85.5000 | lr: 3.5977e-06 | scale: 1024.00 | time: 26.534 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1847/  5000| tot_loss: 2.2662 | rl_loss: 0.5084 | pt_loss: 1.7577 | pg_loss: 0.0342 | reg_loss: 0.4743 | reward: -0.2313 | rev_kl: 1.1151 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5962e-06 | scale: 1024.00 | time: 26.514 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1848/  5000| tot_loss: 2.9308 | rl_loss: 1.1033 | pt_loss: 1.8275 | pg_loss: 1.0340 | reg_loss: 0.0693 | reward: -0.4340 | rev_kl: 2.8842 | stu_lens: 15.0000 | mixed_lens: 20.5000 | lr: 3.5948e-06 | scale: 1024.00 | time: 26.510 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1849/  5000| tot_loss: 2.4004 | rl_loss: 0.8122 | pt_loss: 1.5882 | pg_loss: 0.3160 | reg_loss: 0.4962 | reward: -0.9177 | rev_kl: 0.8968 | stu_lens: 65.0000 | mixed_lens: 77.5000 | lr: 3.5934e-06 | scale: 1024.00 | time: 26.510 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1850/  5000| tot_loss: 1.9251 | rl_loss: 0.6207 | pt_loss: 1.3044 | pg_loss: 0.1741 | reg_loss: 0.4466 | reward: -0.3878 | rev_kl: 1.4088 | stu_lens: 65.0000 | mixed_lens: 71.0000 | lr: 3.5919e-06 | scale: 1024.00 | time: 26.518 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1851/  5000| tot_loss: 2.2301 | rl_loss: 0.7118 | pt_loss: 1.5182 | pg_loss: 0.4223 | reg_loss: 0.2895 | reward: -0.6732 | rev_kl: 1.0485 | stu_lens: 128.0000 | mixed_lens: 71.0000 | lr: 3.5905e-06 | scale: 1024.00 | time: 26.531 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1852/  5000| tot_loss: 2.6733 | rl_loss: 1.0110 | pt_loss: 1.6624 | pg_loss: 0.5934 | reg_loss: 0.4176 | reward: -0.8246 | rev_kl: 0.6982 | stu_lens: 57.0000 | mixed_lens: 50.5000 | lr: 3.5890e-06 | scale: 1024.00 | time: 26.473 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1853/  5000| tot_loss: 2.3950 | rl_loss: 0.5612 | pt_loss: 1.8337 | pg_loss: 0.0346 | reg_loss: 0.5267 | reward: -0.3101 | rev_kl: 1.5042 | stu_lens: 62.5000 | mixed_lens: 124.5000 | lr: 3.5876e-06 | scale: 1024.00 | time: 26.497 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1854/  5000| tot_loss: 2.7143 | rl_loss: 1.1304 | pt_loss: 1.5839 | pg_loss: 0.4159 | reg_loss: 0.7146 | reward: -1.1762 | rev_kl: 1.4001 | stu_lens: 30.0000 | mixed_lens: 55.5000 | lr: 3.5862e-06 | scale: 1024.00 | time: 26.465 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1855/  5000| tot_loss: 3.1302 | rl_loss: 1.2255 | pt_loss: 1.9047 | pg_loss: 0.6427 | reg_loss: 0.5829 | reward: -0.2562 | rev_kl: 0.8336 | stu_lens: 111.5000 | mixed_lens: 55.0000 | lr: 3.5847e-06 | scale: 1024.00 | time: 26.494 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1856/  5000| tot_loss: 3.6934 | rl_loss: 1.8277 | pt_loss: 1.8657 | pg_loss: 0.9110 | reg_loss: 0.9167 | reward: -1.3338 | rev_kl: 1.4556 | stu_lens: 112.0000 | mixed_lens: 46.5000 | lr: 3.5833e-06 | scale: 1024.00 | time: 26.509 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1856/  5000| tot_loss: 2.4360 | rl_loss: 0.7908 | pt_loss: 1.6451 | pg_loss: 0.3309 | reg_loss: 0.4599 | reward: -0.4225 | rev_kl: 1.4697 | stu_lens: 78.2188 | mixed_lens: 80.5000 | lr: 3.5833e-06 | scale: 1024.00 | time: 26.509 | step time: 27.780
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1857/  5000| tot_loss: 2.4536 | rl_loss: 0.5264 | pt_loss: 1.9272 | pg_loss: -0.0030 | reg_loss: 0.5294 | reward: -0.0945 | rev_kl: 1.4772 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5818e-06 | scale: 1024.00 | time: 26.493 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1858/  5000| tot_loss: 4.0471 | rl_loss: 1.7320 | pt_loss: 2.3151 | pg_loss: 0.0591 | reg_loss: 1.6730 | reward: -0.3590 | rev_kl: 1.2425 | stu_lens: 106.0000 | mixed_lens: 128.0000 | lr: 3.5804e-06 | scale: 1024.00 | time: 26.505 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1859/  5000| tot_loss: 2.6698 | rl_loss: 0.7812 | pt_loss: 1.8886 | pg_loss: 0.1167 | reg_loss: 0.6645 | reward: -0.1867 | rev_kl: 0.8308 | stu_lens: 82.0000 | mixed_lens: 96.5000 | lr: 3.5789e-06 | scale: 1024.00 | time: 26.512 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1860/  5000| tot_loss: 3.2024 | rl_loss: 1.3320 | pt_loss: 1.8704 | pg_loss: 0.0351 | reg_loss: 1.2969 | reward: -0.2359 | rev_kl: 1.7754 | stu_lens: 21.5000 | mixed_lens: 128.0000 | lr: 3.5775e-06 | scale: 1024.00 | time: 26.465 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1861/  5000| tot_loss: 2.4486 | rl_loss: 0.9338 | pt_loss: 1.5148 | pg_loss: 0.0645 | reg_loss: 0.8693 | reward: -0.1012 | rev_kl: 0.6501 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5760e-06 | scale: 1024.00 | time: 26.488 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1862/  5000| tot_loss: 3.2533 | rl_loss: 1.4270 | pt_loss: 1.8264 | pg_loss: 0.5151 | reg_loss: 0.9119 | reward: -1.2362 | rev_kl: 0.5002 | stu_lens: 128.0000 | mixed_lens: 49.5000 | lr: 3.5746e-06 | scale: 1024.00 | time: 26.466 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1863/  5000| tot_loss: 3.8230 | rl_loss: 2.1324 | pt_loss: 1.6906 | pg_loss: 0.5356 | reg_loss: 1.5968 | reward: -0.6974 | rev_kl: 1.1492 | stu_lens: 77.0000 | mixed_lens: 77.5000 | lr: 3.5731e-06 | scale: 1024.00 | time: 26.511 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1864/  5000| tot_loss: 2.9297 | rl_loss: 1.2305 | pt_loss: 1.6992 | pg_loss: 0.2757 | reg_loss: 0.9548 | reward: 0.0638 | rev_kl: 1.2814 | stu_lens: 69.5000 | mixed_lens: 81.0000 | lr: 3.5717e-06 | scale: 1024.00 | time: 26.487 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1865/  5000| tot_loss: 4.1863 | rl_loss: 2.5472 | pt_loss: 1.6392 | pg_loss: 0.8751 | reg_loss: 1.6721 | reward: -1.1062 | rev_kl: 1.1819 | stu_lens: 45.5000 | mixed_lens: 65.0000 | lr: 3.5702e-06 | scale: 1024.00 | time: 26.508 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1866/  5000| tot_loss: 2.0241 | rl_loss: 0.9633 | pt_loss: 1.0608 | pg_loss: 0.0772 | reg_loss: 0.8861 | reward: -0.3068 | rev_kl: 0.7869 | stu_lens: 67.5000 | mixed_lens: 75.0000 | lr: 3.5688e-06 | scale: 1024.00 | time: 26.510 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1867/  5000| tot_loss: 3.5960 | rl_loss: 1.5262 | pt_loss: 2.0698 | pg_loss: 0.3370 | reg_loss: 1.1891 | reward: -0.3454 | rev_kl: 1.3852 | stu_lens: 66.0000 | mixed_lens: 91.5000 | lr: 3.5673e-06 | scale: 1024.00 | time: 26.572 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1868/  5000| tot_loss: 3.5766 | rl_loss: 1.6858 | pt_loss: 1.8908 | pg_loss: 0.2475 | reg_loss: 1.4383 | reward: -0.3191 | rev_kl: 0.7835 | stu_lens: 128.0000 | mixed_lens: 85.5000 | lr: 3.5659e-06 | scale: 1024.00 | time: 26.569 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1869/  5000| tot_loss: 2.5878 | rl_loss: 1.3187 | pt_loss: 1.2691 | pg_loss: 0.1649 | reg_loss: 1.1538 | reward: -0.2527 | rev_kl: 1.1179 | stu_lens: 88.5000 | mixed_lens: 114.0000 | lr: 3.5644e-06 | scale: 1024.00 | time: 26.545 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1870/  5000| tot_loss: 3.5165 | rl_loss: 1.8498 | pt_loss: 1.6667 | pg_loss: 0.7444 | reg_loss: 1.1055 | reward: -0.7342 | rev_kl: 0.4812 | stu_lens: 128.0000 | mixed_lens: 69.5000 | lr: 3.5630e-06 | scale: 1024.00 | time: 26.519 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1871/  5000| tot_loss: 2.7601 | rl_loss: 1.1874 | pt_loss: 1.5727 | pg_loss: 0.0607 | reg_loss: 1.1267 | reward: -0.1247 | rev_kl: 1.0082 | stu_lens: 125.5000 | mixed_lens: 128.0000 | lr: 3.5615e-06 | scale: 1024.00 | time: 26.555 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1872/  5000| tot_loss: 3.1838 | rl_loss: 2.0130 | pt_loss: 1.1708 | pg_loss: 0.5327 | reg_loss: 1.4803 | reward: -0.6153 | rev_kl: 0.5406 | stu_lens: 122.0000 | mixed_lens: 70.5000 | lr: 3.5601e-06 | scale: 1024.00 | time: 26.510 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1872/  5000| tot_loss: 3.1485 | rl_loss: 1.4837 | pt_loss: 1.6648 | pg_loss: 0.3275 | reg_loss: 1.1562 | reward: -0.4018 | rev_kl: 1.0298 | stu_lens: 89.9688 | mixed_lens: 91.0156 | lr: 3.5601e-06 | scale: 1024.00 | time: 26.510 | step time: 27.774
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1873/  5000| tot_loss: 3.2006 | rl_loss: 1.2740 | pt_loss: 1.9266 | pg_loss: 0.0663 | reg_loss: 1.2077 | reward: -0.3093 | rev_kl: 0.7131 | stu_lens: 128.0000 | mixed_lens: 122.5000 | lr: 3.5586e-06 | scale: 1024.00 | time: 26.541 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1874/  5000| tot_loss: 2.5748 | rl_loss: 0.9394 | pt_loss: 1.6354 | pg_loss: 0.1264 | reg_loss: 0.8130 | reward: -0.4647 | rev_kl: 1.0451 | stu_lens: 108.0000 | mixed_lens: 98.0000 | lr: 3.5572e-06 | scale: 1024.00 | time: 26.522 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1875/  5000| tot_loss: 2.8713 | rl_loss: 1.1798 | pt_loss: 1.6915 | pg_loss: 0.0679 | reg_loss: 1.1119 | reward: -0.4977 | rev_kl: 1.6367 | stu_lens: 108.5000 | mixed_lens: 116.0000 | lr: 3.5557e-06 | scale: 1024.00 | time: 26.532 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1876/  5000| tot_loss: 2.5949 | rl_loss: 0.7178 | pt_loss: 1.8771 | pg_loss: 0.1705 | reg_loss: 0.5473 | reward: -0.8749 | rev_kl: 0.8739 | stu_lens: 128.0000 | mixed_lens: 66.5000 | lr: 3.5543e-06 | scale: 1024.00 | time: 26.527 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1877/  5000| tot_loss: 2.6470 | rl_loss: 0.8439 | pt_loss: 1.8032 | pg_loss: 0.0508 | reg_loss: 0.7931 | reward: -0.2038 | rev_kl: 1.0950 | stu_lens: 82.5000 | mixed_lens: 114.0000 | lr: 3.5528e-06 | scale: 1024.00 | time: 26.596 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1878/  5000| tot_loss: 2.9174 | rl_loss: 1.3871 | pt_loss: 1.5303 | pg_loss: 0.5070 | reg_loss: 0.8801 | reward: -0.6030 | rev_kl: 0.8530 | stu_lens: 79.0000 | mixed_lens: 52.0000 | lr: 3.5514e-06 | scale: 1024.00 | time: 26.548 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1879/  5000| tot_loss: 2.6867 | rl_loss: 1.0791 | pt_loss: 1.6075 | pg_loss: 0.4562 | reg_loss: 0.6230 | reward: -0.8956 | rev_kl: 0.9504 | stu_lens: 77.0000 | mixed_lens: 22.0000 | lr: 3.5499e-06 | scale: 1024.00 | time: 26.553 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1880/  5000| tot_loss: 2.0121 | rl_loss: 0.7940 | pt_loss: 1.2181 | pg_loss: 0.0080 | reg_loss: 0.7859 | reward: -0.1195 | rev_kl: 0.9888 | stu_lens: 122.0000 | mixed_lens: 128.0000 | lr: 3.5485e-06 | scale: 1024.00 | time: 26.535 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1881/  5000| tot_loss: 2.4618 | rl_loss: 0.9710 | pt_loss: 1.4908 | pg_loss: 0.5212 | reg_loss: 0.4497 | reward: -1.0789 | rev_kl: 0.5696 | stu_lens: 65.0000 | mixed_lens: 65.0000 | lr: 3.5470e-06 | scale: 1024.00 | time: 26.555 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1882/  5000| tot_loss: 2.8698 | rl_loss: 1.3649 | pt_loss: 1.5049 | pg_loss: 0.1593 | reg_loss: 1.2055 | reward: -0.2523 | rev_kl: 1.0328 | stu_lens: 88.5000 | mixed_lens: 61.0000 | lr: 3.5456e-06 | scale: 1024.00 | time: 26.532 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1883/  5000| tot_loss: 2.8020 | rl_loss: 1.1655 | pt_loss: 1.6365 | pg_loss: 0.5286 | reg_loss: 0.6369 | reward: -0.3128 | rev_kl: 0.8331 | stu_lens: 78.5000 | mixed_lens: 80.0000 | lr: 3.5441e-06 | scale: 1024.00 | time: 26.541 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1884/  5000| tot_loss: 2.7295 | rl_loss: 1.0649 | pt_loss: 1.6645 | pg_loss: 0.3511 | reg_loss: 0.7138 | reward: -0.5987 | rev_kl: 0.5998 | stu_lens: 53.5000 | mixed_lens: 70.5000 | lr: 3.5426e-06 | scale: 1024.00 | time: 26.520 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1885/  5000| tot_loss: 2.4099 | rl_loss: 0.5705 | pt_loss: 1.8394 | pg_loss: 0.0971 | reg_loss: 0.4734 | reward: -0.1647 | rev_kl: 0.6576 | stu_lens: 128.0000 | mixed_lens: 107.0000 | lr: 3.5412e-06 | scale: 1024.00 | time: 26.553 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1886/  5000| tot_loss: 2.6634 | rl_loss: 0.7349 | pt_loss: 1.9285 | pg_loss: 0.0021 | reg_loss: 0.7328 | reward: -0.1270 | rev_kl: 0.8434 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5397e-06 | scale: 1024.00 | time: 26.515 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1887/  5000| tot_loss: 2.5051 | rl_loss: 0.5150 | pt_loss: 1.9901 | pg_loss: 0.1914 | reg_loss: 0.3236 | reward: -0.4532 | rev_kl: 0.9222 | stu_lens: 91.5000 | mixed_lens: 91.0000 | lr: 3.5383e-06 | scale: 1024.00 | time: 26.542 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1888/  5000| tot_loss: 2.8797 | rl_loss: 1.1526 | pt_loss: 1.7271 | pg_loss: 0.4372 | reg_loss: 0.7154 | reward: -0.3900 | rev_kl: 1.1812 | stu_lens: 64.0000 | mixed_lens: 64.5000 | lr: 3.5368e-06 | scale: 1024.00 | time: 26.546 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1888/  5000| tot_loss: 2.6509 | rl_loss: 0.9530 | pt_loss: 1.6979 | pg_loss: 0.2180 | reg_loss: 0.7350 | reward: -0.4107 | rev_kl: 0.9316 | stu_lens: 94.9688 | mixed_lens: 94.2188 | lr: 3.5368e-06 | scale: 1024.00 | time: 26.546 | step time: 27.803
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1889/  5000| tot_loss: 3.0903 | rl_loss: 1.2040 | pt_loss: 1.8862 | pg_loss: 0.2452 | reg_loss: 0.9589 | reward: -0.3630 | rev_kl: 1.3779 | stu_lens: 49.5000 | mixed_lens: 95.5000 | lr: 3.5354e-06 | scale: 1024.00 | time: 26.508 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1890/  5000| tot_loss: 2.8969 | rl_loss: 1.1623 | pt_loss: 1.7346 | pg_loss: 0.3521 | reg_loss: 0.8102 | reward: -0.6035 | rev_kl: 1.3925 | stu_lens: 102.5000 | mixed_lens: 94.5000 | lr: 3.5339e-06 | scale: 1024.00 | time: 26.474 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1891/  5000| tot_loss: 1.5014 | rl_loss: -0.1791 | pt_loss: 1.6805 | pg_loss: -0.2390 | reg_loss: 0.0599 | reward: -1.1114 | rev_kl: 0.4088 | stu_lens: 11.5000 | mixed_lens: 13.5000 | lr: 3.5324e-06 | scale: 1024.00 | time: 26.490 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1892/  5000| tot_loss: 2.6730 | rl_loss: 1.0165 | pt_loss: 1.6565 | pg_loss: 0.3477 | reg_loss: 0.6688 | reward: -0.8477 | rev_kl: 0.9892 | stu_lens: 128.0000 | mixed_lens: 67.5000 | lr: 3.5310e-06 | scale: 1024.00 | time: 26.471 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1893/  5000| tot_loss: 2.3335 | rl_loss: 0.6310 | pt_loss: 1.7025 | pg_loss: 0.2819 | reg_loss: 0.3491 | reward: -0.9307 | rev_kl: 0.9817 | stu_lens: 92.5000 | mixed_lens: 79.0000 | lr: 3.5295e-06 | scale: 1024.00 | time: 26.525 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1894/  5000| tot_loss: 2.7869 | rl_loss: 0.8141 | pt_loss: 1.9728 | pg_loss: 0.2460 | reg_loss: 0.5681 | reward: -0.3911 | rev_kl: 1.1890 | stu_lens: 90.0000 | mixed_lens: 91.5000 | lr: 3.5281e-06 | scale: 1024.00 | time: 26.514 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1895/  5000| tot_loss: 2.4917 | rl_loss: 0.9201 | pt_loss: 1.5716 | pg_loss: 0.0892 | reg_loss: 0.8309 | reward: -0.2605 | rev_kl: 0.8240 | stu_lens: 69.5000 | mixed_lens: 107.0000 | lr: 3.5266e-06 | scale: 1024.00 | time: 26.544 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1896/  5000| tot_loss: 1.9384 | rl_loss: 0.4695 | pt_loss: 1.4689 | pg_loss: -0.0121 | reg_loss: 0.4816 | reward: -0.2434 | rev_kl: 0.8455 | stu_lens: 104.0000 | mixed_lens: 128.0000 | lr: 3.5251e-06 | scale: 1024.00 | time: 26.546 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1897/  5000| tot_loss: 2.1494 | rl_loss: 0.6848 | pt_loss: 1.4645 | pg_loss: 0.0915 | reg_loss: 0.5933 | reward: -0.6231 | rev_kl: 0.5639 | stu_lens: 128.0000 | mixed_lens: 73.0000 | lr: 3.5237e-06 | scale: 1024.00 | time: 26.537 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1898/  5000| tot_loss: 3.1491 | rl_loss: 1.0906 | pt_loss: 2.0585 | pg_loss: 0.4859 | reg_loss: 0.6047 | reward: -0.2557 | rev_kl: 0.7227 | stu_lens: 70.5000 | mixed_lens: 70.5000 | lr: 3.5222e-06 | scale: 1024.00 | time: 26.577 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1899/  5000| tot_loss: 2.2027 | rl_loss: 0.8327 | pt_loss: 1.3700 | pg_loss: 0.2023 | reg_loss: 0.6304 | reward: -0.4428 | rev_kl: 0.3257 | stu_lens: 128.0000 | mixed_lens: 47.0000 | lr: 3.5207e-06 | scale: 1024.00 | time: 26.558 | step time: 0.000
                                 Evaluation #19                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Yes, Bob should leave Alice. He has  │
│                                       │ a 31% chance of survival, which is   │
│                                       │ better than 10%.                     │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ mz kezboard tzpe z instead of y and  │
│                                       │ vice versa is a result of mz         │
│                                       │ kezboard tzpe z being mapped to the  │
│                                       │ y key and vice versa. This is a      │
│                                       │ common mapping for keyboards where   │
│                                       │ the keys are arranged in a single    │
│                                       │ row.                                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support 52 languages.             │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.212 | exact_match: 0.215 | rev_kl: 1.116 | lens: 82.679 | pt_loss: 1.077 | lm_loss: 1.159 | kd_loss: 0.995 
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1900/  5000| tot_loss: 2.2771 | rl_loss: 0.2701 | pt_loss: 2.0070 | pg_loss: -0.2154 | reg_loss: 0.4855 | reward: -0.2189 | rev_kl: 1.0440 | stu_lens: 115.5000 | mixed_lens: 37.5000 | lr: 3.5193e-06 | scale: 1024.00 | time: 26.538 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1901/  5000| tot_loss: 2.3333 | rl_loss: 0.5973 | pt_loss: 1.7360 | pg_loss: 0.1603 | reg_loss: 0.4369 | reward: -0.2063 | rev_kl: 0.8795 | stu_lens: 99.5000 | mixed_lens: 101.0000 | lr: 3.5178e-06 | scale: 1024.00 | time: 26.588 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1902/  5000| tot_loss: 2.6551 | rl_loss: 1.0721 | pt_loss: 1.5830 | pg_loss: 0.3719 | reg_loss: 0.7003 | reward: -0.8766 | rev_kl: 1.2834 | stu_lens: 77.0000 | mixed_lens: 65.5000 | lr: 3.5164e-06 | scale: 1024.00 | time: 26.579 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1903/  5000| tot_loss: 1.9339 | rl_loss: 0.2000 | pt_loss: 1.7339 | pg_loss: -0.0006 | reg_loss: 0.2005 | reward: -0.0434 | rev_kl: 0.4268 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5149e-06 | scale: 1024.00 | time: 26.500 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1904/  5000| tot_loss: 2.2238 | rl_loss: 1.0595 | pt_loss: 1.1643 | pg_loss: 0.3226 | reg_loss: 0.7369 | reward: -0.9434 | rev_kl: 0.5870 | stu_lens: 128.0000 | mixed_lens: 80.5000 | lr: 3.5134e-06 | scale: 1024.00 | time: 26.515 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1904/  5000| tot_loss: 2.4238 | rl_loss: 0.7773 | pt_loss: 1.6465 | pg_loss: 0.2127 | reg_loss: 0.5647 | reward: -0.4375 | rev_kl: 0.9611 | stu_lens: 87.8594 | mixed_lens: 88.5469 | lr: 3.5134e-06 | scale: 1024.00 | time: 26.515 | step time: 27.789
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1905/  5000| tot_loss: 2.3851 | rl_loss: 0.4211 | pt_loss: 1.9640 | pg_loss: -0.0130 | reg_loss: 0.4341 | reward: -0.1658 | rev_kl: 0.8895 | stu_lens: 122.0000 | mixed_lens: 128.0000 | lr: 3.5120e-06 | scale: 1024.00 | time: 26.482 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1906/  5000| tot_loss: 2.2423 | rl_loss: 0.6179 | pt_loss: 1.6244 | pg_loss: 0.1051 | reg_loss: 0.5128 | reward: -0.5250 | rev_kl: 1.3939 | stu_lens: 92.0000 | mixed_lens: 116.0000 | lr: 3.5105e-06 | scale: 1024.00 | time: 26.520 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1907/  5000| tot_loss: 2.6523 | rl_loss: 0.8215 | pt_loss: 1.8308 | pg_loss: 0.4125 | reg_loss: 0.4089 | reward: -0.6359 | rev_kl: 0.8668 | stu_lens: 102.0000 | mixed_lens: 70.5000 | lr: 3.5090e-06 | scale: 1024.00 | time: 26.478 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1908/  5000| tot_loss: 2.7049 | rl_loss: 0.6109 | pt_loss: 2.0940 | pg_loss: 0.2020 | reg_loss: 0.4089 | reward: -0.0526 | rev_kl: 1.1436 | stu_lens: 115.5000 | mixed_lens: 72.0000 | lr: 3.5076e-06 | scale: 1024.00 | time: 26.506 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1909/  5000| tot_loss: 2.3430 | rl_loss: 0.5612 | pt_loss: 1.7818 | pg_loss: 0.1080 | reg_loss: 0.4532 | reward: -0.2528 | rev_kl: 0.7748 | stu_lens: 125.5000 | mixed_lens: 106.5000 | lr: 3.5061e-06 | scale: 1024.00 | time: 26.482 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1910/  5000| tot_loss: 2.4265 | rl_loss: 0.8521 | pt_loss: 1.5744 | pg_loss: 0.3925 | reg_loss: 0.4596 | reward: -0.5211 | rev_kl: 0.4715 | stu_lens: 128.0000 | mixed_lens: 94.5000 | lr: 3.5046e-06 | scale: 1024.00 | time: 26.503 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1911/  5000| tot_loss: 2.9475 | rl_loss: 1.3233 | pt_loss: 1.6243 | pg_loss: 0.9653 | reg_loss: 0.3580 | reward: -1.0804 | rev_kl: 0.2352 | stu_lens: 74.5000 | mixed_lens: 29.0000 | lr: 3.5032e-06 | scale: 1024.00 | time: 26.482 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1912/  5000| tot_loss: 2.5932 | rl_loss: 0.7094 | pt_loss: 1.8839 | pg_loss: 0.1291 | reg_loss: 0.5803 | reward: -0.2956 | rev_kl: 1.4527 | stu_lens: 62.5000 | mixed_lens: 93.5000 | lr: 3.5017e-06 | scale: 1024.00 | time: 26.506 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1913/  5000| tot_loss: 2.2986 | rl_loss: 0.4649 | pt_loss: 1.8337 | pg_loss: 0.0258 | reg_loss: 0.4391 | reward: -0.3323 | rev_kl: 0.9029 | stu_lens: 101.0000 | mixed_lens: 128.0000 | lr: 3.5002e-06 | scale: 1024.00 | time: 26.538 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1914/  5000| tot_loss: 1.8659 | rl_loss: 0.2952 | pt_loss: 1.5707 | pg_loss: 0.0410 | reg_loss: 0.2542 | reward: -0.4794 | rev_kl: 0.7492 | stu_lens: 128.0000 | mixed_lens: 97.0000 | lr: 3.4988e-06 | scale: 1024.00 | time: 26.505 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1915/  5000| tot_loss: 2.5052 | rl_loss: 0.3821 | pt_loss: 2.1231 | pg_loss: 0.1117 | reg_loss: 0.2704 | reward: -0.3361 | rev_kl: 0.6414 | stu_lens: 85.5000 | mixed_lens: 80.0000 | lr: 3.4973e-06 | scale: 1024.00 | time: 26.484 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1916/  5000| tot_loss: 2.2023 | rl_loss: 0.5937 | pt_loss: 1.6087 | pg_loss: 0.3443 | reg_loss: 0.2494 | reward: -0.1910 | rev_kl: 1.1819 | stu_lens: 75.0000 | mixed_lens: 98.5000 | lr: 3.4958e-06 | scale: 1024.00 | time: 26.521 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1917/  5000| tot_loss: 2.6281 | rl_loss: 1.1705 | pt_loss: 1.4576 | pg_loss: 0.3750 | reg_loss: 0.7955 | reward: -0.3720 | rev_kl: 0.5730 | stu_lens: 17.0000 | mixed_lens: 80.0000 | lr: 3.4943e-06 | scale: 1024.00 | time: 26.485 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1918/  5000| tot_loss: 1.6356 | rl_loss: 0.3449 | pt_loss: 1.2907 | pg_loss: -0.0043 | reg_loss: 0.3492 | reward: -0.0993 | rev_kl: 0.8783 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4929e-06 | scale: 1024.00 | time: 26.531 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1919/  5000| tot_loss: 2.6662 | rl_loss: 0.8450 | pt_loss: 1.8212 | pg_loss: 0.2192 | reg_loss: 0.6258 | reward: -0.7032 | rev_kl: 1.4765 | stu_lens: 91.5000 | mixed_lens: 91.0000 | lr: 3.4914e-06 | scale: 1024.00 | time: 26.535 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1920/  5000| tot_loss: 2.1084 | rl_loss: 0.7018 | pt_loss: 1.4066 | pg_loss: 0.1281 | reg_loss: 0.5737 | reward: -0.4418 | rev_kl: 1.0196 | stu_lens: 128.0000 | mixed_lens: 98.0000 | lr: 3.4899e-06 | scale: 1024.00 | time: 26.574 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1920/  5000| tot_loss: 2.3776 | rl_loss: 0.6676 | pt_loss: 1.7100 | pg_loss: 0.2273 | reg_loss: 0.4403 | reward: -0.4239 | rev_kl: 0.9518 | stu_lens: 93.1719 | mixed_lens: 92.2188 | lr: 3.4899e-06 | scale: 1024.00 | time: 26.574 | step time: 27.770
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1921/  5000| tot_loss: 2.6639 | rl_loss: 0.5285 | pt_loss: 2.1354 | pg_loss: 0.0281 | reg_loss: 0.5004 | reward: -0.1494 | rev_kl: 1.0454 | stu_lens: 104.0000 | mixed_lens: 128.0000 | lr: 3.4885e-06 | scale: 1024.00 | time: 26.545 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1922/  5000| tot_loss: 3.7260 | rl_loss: 2.1113 | pt_loss: 1.6147 | pg_loss: 0.7566 | reg_loss: 1.3547 | reward: -0.0861 | rev_kl: 0.9684 | stu_lens: 36.0000 | mixed_lens: 59.5000 | lr: 3.4870e-06 | scale: 1024.00 | time: 26.585 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1923/  5000| tot_loss: 3.5226 | rl_loss: 1.6778 | pt_loss: 1.8448 | pg_loss: 0.4271 | reg_loss: 1.2507 | reward: -0.2220 | rev_kl: 1.4438 | stu_lens: 82.0000 | mixed_lens: 84.5000 | lr: 3.4855e-06 | scale: 1024.00 | time: 26.545 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1924/  5000| tot_loss: 3.3042 | rl_loss: 1.4331 | pt_loss: 1.8712 | pg_loss: 0.5600 | reg_loss: 0.8730 | reward: -0.7143 | rev_kl: 1.2702 | stu_lens: 112.0000 | mixed_lens: 47.0000 | lr: 3.4840e-06 | scale: 1024.00 | time: 26.560 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1925/  5000| tot_loss: 3.7852 | rl_loss: 1.6981 | pt_loss: 2.0871 | pg_loss: 0.2810 | reg_loss: 1.4171 | reward: -0.3653 | rev_kl: 1.2092 | stu_lens: 125.0000 | mixed_lens: 103.5000 | lr: 3.4826e-06 | scale: 1024.00 | time: 26.584 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1926/  5000| tot_loss: 3.7416 | rl_loss: 2.1792 | pt_loss: 1.5624 | pg_loss: 0.2713 | reg_loss: 1.9079 | reward: -0.5621 | rev_kl: 1.1706 | stu_lens: 80.5000 | mixed_lens: 85.0000 | lr: 3.4811e-06 | scale: 1024.00 | time: 26.601 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1927/  5000| tot_loss: 2.6566 | rl_loss: 1.1024 | pt_loss: 1.5541 | pg_loss: 0.5707 | reg_loss: 0.5317 | reward: -0.0946 | rev_kl: 0.9913 | stu_lens: 76.5000 | mixed_lens: 42.0000 | lr: 3.4796e-06 | scale: 1024.00 | time: 26.563 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1928/  5000| tot_loss: 2.7642 | rl_loss: 1.1606 | pt_loss: 1.6037 | pg_loss: 0.3177 | reg_loss: 0.8429 | reward: -0.3486 | rev_kl: 0.9823 | stu_lens: 90.5000 | mixed_lens: 87.0000 | lr: 3.4781e-06 | scale: 1024.00 | time: 26.573 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1929/  5000| tot_loss: 3.3486 | rl_loss: 1.7732 | pt_loss: 1.5754 | pg_loss: 0.4641 | reg_loss: 1.3091 | reward: -0.5645 | rev_kl: 0.9599 | stu_lens: 65.0000 | mixed_lens: 73.0000 | lr: 3.4767e-06 | scale: 1024.00 | time: 26.567 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1930/  5000| tot_loss: 4.3355 | rl_loss: 2.4453 | pt_loss: 1.8902 | pg_loss: 0.9601 | reg_loss: 1.4851 | reward: -0.2011 | rev_kl: 0.9338 | stu_lens: 68.5000 | mixed_lens: 48.0000 | lr: 3.4752e-06 | scale: 1024.00 | time: 26.556 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1931/  5000| tot_loss: 3.4222 | rl_loss: 1.6442 | pt_loss: 1.7780 | pg_loss: 0.4998 | reg_loss: 1.1445 | reward: -0.5100 | rev_kl: 1.0794 | stu_lens: 96.5000 | mixed_lens: 73.0000 | lr: 3.4737e-06 | scale: 1024.00 | time: 26.600 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1932/  5000| tot_loss: 3.7359 | rl_loss: 1.6883 | pt_loss: 2.0476 | pg_loss: 0.4725 | reg_loss: 1.2158 | reward: -0.9677 | rev_kl: 2.8382 | stu_lens: 17.5000 | mixed_lens: 63.5000 | lr: 3.4722e-06 | scale: 1024.00 | time: 26.556 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1933/  5000| tot_loss: 4.0632 | rl_loss: 2.2261 | pt_loss: 1.8371 | pg_loss: 0.5283 | reg_loss: 1.6979 | reward: -0.8941 | rev_kl: 1.0649 | stu_lens: 57.5000 | mixed_lens: 61.5000 | lr: 3.4708e-06 | scale: 1024.00 | time: 26.572 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1934/  5000| tot_loss: 3.0610 | rl_loss: 1.5201 | pt_loss: 1.5410 | pg_loss: 0.2756 | reg_loss: 1.2444 | reward: -0.2910 | rev_kl: 1.1928 | stu_lens: 127.0000 | mixed_lens: 99.5000 | lr: 3.4693e-06 | scale: 1024.00 | time: 26.533 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1935/  5000| tot_loss: 4.6679 | rl_loss: 2.9470 | pt_loss: 1.7209 | pg_loss: 1.1536 | reg_loss: 1.7934 | reward: -0.5223 | rev_kl: 2.2614 | stu_lens: 42.0000 | mixed_lens: 40.0000 | lr: 3.4678e-06 | scale: 1024.00 | time: 26.611 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1936/  5000| tot_loss: 5.8860 | rl_loss: 4.5147 | pt_loss: 1.3713 | pg_loss: 2.3477 | reg_loss: 2.1670 | reward: 0.0145 | rev_kl: 1.0869 | stu_lens: 41.0000 | mixed_lens: 13.0000 | lr: 3.4663e-06 | scale: 1024.00 | time: 26.557 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1936/  5000| tot_loss: 3.5338 | rl_loss: 1.8516 | pt_loss: 1.6822 | pg_loss: 0.5176 | reg_loss: 1.3339 | reward: -0.4568 | rev_kl: 1.2672 | stu_lens: 78.1875 | mixed_lens: 71.2500 | lr: 3.4663e-06 | scale: 1024.00 | time: 26.557 | step time: 27.832
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1937/  5000| tot_loss: 3.4454 | rl_loss: 2.0010 | pt_loss: 1.4445 | pg_loss: 0.3275 | reg_loss: 1.6735 | reward: -0.1832 | rev_kl: 1.1110 | stu_lens: 88.5000 | mixed_lens: 95.5000 | lr: 3.4648e-06 | scale: 1024.00 | time: 26.555 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1938/  5000| tot_loss: 3.2392 | rl_loss: 1.3530 | pt_loss: 1.8862 | pg_loss: 0.1823 | reg_loss: 1.1707 | reward: -0.3575 | rev_kl: 1.4210 | stu_lens: 128.0000 | mixed_lens: 107.5000 | lr: 3.4634e-06 | scale: 1024.00 | time: 26.540 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1939/  5000| tot_loss: 2.5941 | rl_loss: 0.9690 | pt_loss: 1.6251 | pg_loss: 0.0932 | reg_loss: 0.8758 | reward: -0.1593 | rev_kl: 1.1688 | stu_lens: 62.0000 | mixed_lens: 120.5000 | lr: 3.4619e-06 | scale: 1024.00 | time: 26.564 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1940/  5000| tot_loss: 2.6163 | rl_loss: 1.0243 | pt_loss: 1.5920 | pg_loss: 0.2348 | reg_loss: 0.7895 | reward: -0.4370 | rev_kl: 1.7906 | stu_lens: 93.0000 | mixed_lens: 82.5000 | lr: 3.4604e-06 | scale: 1024.00 | time: 26.516 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1941/  5000| tot_loss: 3.4312 | rl_loss: 1.4829 | pt_loss: 1.9483 | pg_loss: 0.2589 | reg_loss: 1.2240 | reward: -0.4650 | rev_kl: 1.5147 | stu_lens: 98.0000 | mixed_lens: 83.0000 | lr: 3.4589e-06 | scale: 1024.00 | time: 26.552 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1942/  5000| tot_loss: 2.8330 | rl_loss: 1.5258 | pt_loss: 1.3071 | pg_loss: 0.3476 | reg_loss: 1.1783 | reward: -0.5744 | rev_kl: 0.7790 | stu_lens: 67.5000 | mixed_lens: 89.0000 | lr: 3.4574e-06 | scale: 1024.00 | time: 26.527 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1943/  5000| tot_loss: 2.5219 | rl_loss: 0.8275 | pt_loss: 1.6944 | pg_loss: 0.1275 | reg_loss: 0.7000 | reward: -0.3630 | rev_kl: 1.4950 | stu_lens: 128.0000 | mixed_lens: 100.5000 | lr: 3.4560e-06 | scale: 1024.00 | time: 26.518 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1944/  5000| tot_loss: 7.1061 | rl_loss: 5.3972 | pt_loss: 1.7089 | pg_loss: 4.8060 | reg_loss: 0.5912 | reward: -0.2910 | rev_kl: 1.4764 | stu_lens: 2.0000 | mixed_lens: 2.5000 | lr: 3.4545e-06 | scale: 1024.00 | time: 26.569 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1945/  5000| tot_loss: 2.9328 | rl_loss: 1.0616 | pt_loss: 1.8712 | pg_loss: 0.2183 | reg_loss: 0.8433 | reward: -0.4262 | rev_kl: 1.5279 | stu_lens: 91.0000 | mixed_lens: 96.5000 | lr: 3.4530e-06 | scale: 1024.00 | time: 26.560 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1946/  5000| tot_loss: 3.1160 | rl_loss: 1.3020 | pt_loss: 1.8140 | pg_loss: 0.5704 | reg_loss: 0.7316 | reward: -0.5568 | rev_kl: 1.3735 | stu_lens: 60.0000 | mixed_lens: 42.5000 | lr: 3.4515e-06 | scale: 1024.00 | time: 26.534 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1947/  5000| tot_loss: 2.7594 | rl_loss: 1.1385 | pt_loss: 1.6209 | pg_loss: 0.4192 | reg_loss: 0.7193 | reward: -0.8975 | rev_kl: 1.1794 | stu_lens: 91.0000 | mixed_lens: 75.5000 | lr: 3.4500e-06 | scale: 1024.00 | time: 26.542 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1948/  5000| tot_loss: 2.6849 | rl_loss: 1.1378 | pt_loss: 1.5471 | pg_loss: 0.4222 | reg_loss: 0.7156 | reward: -0.5781 | rev_kl: 0.8530 | stu_lens: 87.5000 | mixed_lens: 81.5000 | lr: 3.4486e-06 | scale: 1024.00 | time: 26.538 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1949/  5000| tot_loss: 3.1806 | rl_loss: 1.3440 | pt_loss: 1.8366 | pg_loss: 0.2352 | reg_loss: 1.1088 | reward: -0.5238 | rev_kl: 0.9773 | stu_lens: 89.5000 | mixed_lens: 92.5000 | lr: 3.4471e-06 | scale: 1024.00 | time: 26.570 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1950/  5000| tot_loss: 3.3043 | rl_loss: 1.3067 | pt_loss: 1.9977 | pg_loss: 0.4269 | reg_loss: 0.8797 | reward: 0.6162 | rev_kl: 1.1419 | stu_lens: 76.0000 | mixed_lens: 65.5000 | lr: 3.4456e-06 | scale: 1024.00 | time: 26.542 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1951/  5000| tot_loss: 3.1941 | rl_loss: 0.9328 | pt_loss: 2.2613 | pg_loss: 0.4979 | reg_loss: 0.4349 | reward: -0.6667 | rev_kl: 1.7428 | stu_lens: 26.0000 | mixed_lens: 18.5000 | lr: 3.4441e-06 | scale: 1024.00 | time: 26.559 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1952/  5000| tot_loss: 3.1417 | rl_loss: 1.4243 | pt_loss: 1.7174 | pg_loss: 0.5080 | reg_loss: 0.9163 | reward: -0.4284 | rev_kl: 1.2762 | stu_lens: 74.0000 | mixed_lens: 74.5000 | lr: 3.4426e-06 | scale: 1024.00 | time: 26.530 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1952/  5000| tot_loss: 3.1324 | rl_loss: 1.4291 | pt_loss: 1.7032 | pg_loss: 0.5543 | reg_loss: 0.8749 | reward: -0.4410 | rev_kl: 1.2866 | stu_lens: 72.8906 | mixed_lens: 68.7969 | lr: 3.4426e-06 | scale: 1024.00 | time: 26.530 | step time: 27.804
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1953/  5000| tot_loss: 3.5796 | rl_loss: 1.1702 | pt_loss: 2.4095 | pg_loss: 0.2250 | reg_loss: 0.9452 | reward: -0.5231 | rev_kl: 1.1264 | stu_lens: 113.5000 | mixed_lens: 82.5000 | lr: 3.4411e-06 | scale: 1024.00 | time: 26.550 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1954/  5000| tot_loss: 2.8071 | rl_loss: 1.7388 | pt_loss: 1.0683 | pg_loss: 1.1765 | reg_loss: 0.5622 | reward: -0.5338 | rev_kl: 1.1158 | stu_lens: 45.5000 | mixed_lens: 32.0000 | lr: 3.4397e-06 | scale: 1024.00 | time: 26.556 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1955/  5000| tot_loss: 2.2401 | rl_loss: 0.4736 | pt_loss: 1.7666 | pg_loss: 0.0418 | reg_loss: 0.4318 | reward: 0.5336 | rev_kl: 0.7251 | stu_lens: 79.0000 | mixed_lens: 69.5000 | lr: 3.4382e-06 | scale: 1024.00 | time: 26.556 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1956/  5000| tot_loss: 2.5933 | rl_loss: 1.1474 | pt_loss: 1.4459 | pg_loss: 0.5086 | reg_loss: 0.6388 | reward: -0.3550 | rev_kl: 2.0881 | stu_lens: 44.0000 | mixed_lens: 58.0000 | lr: 3.4367e-06 | scale: 1024.00 | time: 26.565 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1957/  5000| tot_loss: 2.4459 | rl_loss: 0.7453 | pt_loss: 1.7006 | pg_loss: 0.2783 | reg_loss: 0.4670 | reward: -0.3466 | rev_kl: 1.1936 | stu_lens: 93.5000 | mixed_lens: 80.0000 | lr: 3.4352e-06 | scale: 1024.00 | time: 26.573 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1958/  5000| tot_loss: 3.6660 | rl_loss: 1.4056 | pt_loss: 2.2605 | pg_loss: 0.9687 | reg_loss: 0.4368 | reward: -0.2866 | rev_kl: 0.9150 | stu_lens: 67.5000 | mixed_lens: 46.5000 | lr: 3.4337e-06 | scale: 1024.00 | time: 26.550 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1959/  5000| tot_loss: 3.5060 | rl_loss: 1.2181 | pt_loss: 2.2880 | pg_loss: 0.6765 | reg_loss: 0.5416 | reward: -0.5586 | rev_kl: 0.9216 | stu_lens: 108.0000 | mixed_lens: 63.5000 | lr: 3.4322e-06 | scale: 1024.00 | time: 26.552 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1960/  5000| tot_loss: 3.9801 | rl_loss: 2.2182 | pt_loss: 1.7619 | pg_loss: 1.6550 | reg_loss: 0.5632 | reward: -1.1483 | rev_kl: 0.8254 | stu_lens: 53.0000 | mixed_lens: 23.5000 | lr: 3.4307e-06 | scale: 1024.00 | time: 26.572 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1961/  5000| tot_loss: 2.5528 | rl_loss: 0.7659 | pt_loss: 1.7869 | pg_loss: 0.3605 | reg_loss: 0.4054 | reward: -0.7089 | rev_kl: 1.0447 | stu_lens: 82.0000 | mixed_lens: 60.0000 | lr: 3.4292e-06 | scale: 1024.00 | time: 26.593 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1962/  5000| tot_loss: 2.3699 | rl_loss: 0.6029 | pt_loss: 1.7670 | pg_loss: 0.1459 | reg_loss: 0.4570 | reward: 0.0450 | rev_kl: 0.7757 | stu_lens: 109.0000 | mixed_lens: 81.5000 | lr: 3.4278e-06 | scale: 1024.00 | time: 26.528 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1963/  5000| tot_loss: 2.7647 | rl_loss: 0.9508 | pt_loss: 1.8139 | pg_loss: 0.6745 | reg_loss: 0.2763 | reward: -0.8947 | rev_kl: 1.2802 | stu_lens: 76.5000 | mixed_lens: 33.5000 | lr: 3.4263e-06 | scale: 1024.00 | time: 26.634 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1964/  5000| tot_loss: 2.8317 | rl_loss: 1.0707 | pt_loss: 1.7611 | pg_loss: 0.4585 | reg_loss: 0.6122 | reward: -0.0518 | rev_kl: 0.6428 | stu_lens: 26.0000 | mixed_lens: 65.0000 | lr: 3.4248e-06 | scale: 1024.00 | time: 26.640 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1965/  5000| tot_loss: 2.3595 | rl_loss: 0.6809 | pt_loss: 1.6787 | pg_loss: 0.2219 | reg_loss: 0.4589 | reward: -0.6862 | rev_kl: 1.3816 | stu_lens: 71.5000 | mixed_lens: 67.5000 | lr: 3.4233e-06 | scale: 1024.00 | time: 26.634 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1966/  5000| tot_loss: 2.2974 | rl_loss: 0.9883 | pt_loss: 1.3091 | pg_loss: 0.1490 | reg_loss: 0.8393 | reward: -0.5377 | rev_kl: 0.4183 | stu_lens: 62.5000 | mixed_lens: 96.5000 | lr: 3.4218e-06 | scale: 1024.00 | time: 26.588 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1967/  5000| tot_loss: 2.5309 | rl_loss: 0.9690 | pt_loss: 1.5619 | pg_loss: 0.2760 | reg_loss: 0.6930 | reward: -0.5130 | rev_kl: 1.3478 | stu_lens: 55.0000 | mixed_lens: 84.5000 | lr: 3.4203e-06 | scale: 1024.00 | time: 26.653 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1968/  5000| tot_loss: 2.3428 | rl_loss: 0.8428 | pt_loss: 1.5000 | pg_loss: 0.2234 | reg_loss: 0.6194 | reward: -0.5241 | rev_kl: 1.3980 | stu_lens: 71.0000 | mixed_lens: 80.0000 | lr: 3.4188e-06 | scale: 1024.00 | time: 26.637 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1968/  5000| tot_loss: 2.8373 | rl_loss: 1.1083 | pt_loss: 1.7290 | pg_loss: 0.4849 | reg_loss: 0.6234 | reward: -0.4808 | rev_kl: 1.2470 | stu_lens: 76.4531 | mixed_lens: 68.2031 | lr: 3.4188e-06 | scale: 1024.00 | time: 26.637 | step time: 27.846
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1969/  5000| tot_loss: 2.1287 | rl_loss: 0.5201 | pt_loss: 1.6086 | pg_loss: 0.1000 | reg_loss: 0.4201 | reward: -0.4508 | rev_kl: 1.7706 | stu_lens: 105.0000 | mixed_lens: 107.0000 | lr: 3.4173e-06 | scale: 1024.00 | time: 26.629 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1970/  5000| tot_loss: 3.2197 | rl_loss: 1.0577 | pt_loss: 2.1620 | pg_loss: 0.5412 | reg_loss: 0.5165 | reward: -0.3550 | rev_kl: 2.0881 | stu_lens: 44.0000 | mixed_lens: 58.0000 | lr: 3.4158e-06 | scale: 1024.00 | time: 26.594 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1971/  5000| tot_loss: 2.4263 | rl_loss: 0.7083 | pt_loss: 1.7180 | pg_loss: 0.3092 | reg_loss: 0.3991 | reward: -0.4175 | rev_kl: 1.3492 | stu_lens: 58.5000 | mixed_lens: 94.0000 | lr: 3.4143e-06 | scale: 1024.00 | time: 26.619 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1972/  5000| tot_loss: 2.4473 | rl_loss: 0.9641 | pt_loss: 1.4832 | pg_loss: 0.5149 | reg_loss: 0.4492 | reward: -0.9000 | rev_kl: 1.0919 | stu_lens: 55.0000 | mixed_lens: 64.5000 | lr: 3.4129e-06 | scale: 1024.00 | time: 26.617 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1973/  5000| tot_loss: 2.3446 | rl_loss: 0.7575 | pt_loss: 1.5871 | pg_loss: 0.1793 | reg_loss: 0.5782 | reward: -0.3805 | rev_kl: 0.7958 | stu_lens: 128.0000 | mixed_lens: 101.5000 | lr: 3.4114e-06 | scale: 1024.00 | time: 26.546 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1974/  5000| tot_loss: 3.8792 | rl_loss: 2.1913 | pt_loss: 1.6879 | pg_loss: 1.7300 | reg_loss: 0.4612 | reward: -0.7821 | rev_kl: 0.8369 | stu_lens: 32.0000 | mixed_lens: 16.0000 | lr: 3.4099e-06 | scale: 1024.00 | time: 26.580 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1975/  5000| tot_loss: 2.3026 | rl_loss: 0.6249 | pt_loss: 1.6776 | pg_loss: 0.2074 | reg_loss: 0.4175 | reward: -0.4270 | rev_kl: 1.0856 | stu_lens: 93.0000 | mixed_lens: 94.5000 | lr: 3.4084e-06 | scale: 1024.00 | time: 26.600 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1976/  5000| tot_loss: 3.6878 | rl_loss: 1.8868 | pt_loss: 1.8009 | pg_loss: 1.1917 | reg_loss: 0.6952 | reward: -0.3614 | rev_kl: 2.0815 | stu_lens: 65.0000 | mixed_lens: 16.0000 | lr: 3.4069e-06 | scale: 1024.00 | time: 26.576 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1977/  5000| tot_loss: 2.2529 | rl_loss: 0.9930 | pt_loss: 1.2599 | pg_loss: 0.6255 | reg_loss: 0.3675 | reward: -0.3328 | rev_kl: 1.3348 | stu_lens: 30.5000 | mixed_lens: 45.0000 | lr: 3.4054e-06 | scale: 1024.00 | time: 26.595 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1978/  5000| tot_loss: 2.3373 | rl_loss: 0.6169 | pt_loss: 1.7204 | pg_loss: 0.2568 | reg_loss: 0.3601 | reward: -0.5066 | rev_kl: 1.8304 | stu_lens: 70.0000 | mixed_lens: 82.5000 | lr: 3.4039e-06 | scale: 1024.00 | time: 26.583 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1979/  5000| tot_loss: 2.1456 | rl_loss: 0.8639 | pt_loss: 1.2818 | pg_loss: 0.2500 | reg_loss: 0.6139 | reward: -0.5231 | rev_kl: 1.1264 | stu_lens: 113.5000 | mixed_lens: 82.5000 | lr: 3.4024e-06 | scale: 1024.00 | time: 26.593 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1980/  5000| tot_loss: 2.9847 | rl_loss: 1.2163 | pt_loss: 1.7684 | pg_loss: 0.6096 | reg_loss: 0.6067 | reward: -1.0003 | rev_kl: 0.9208 | stu_lens: 75.0000 | mixed_lens: 41.0000 | lr: 3.4009e-06 | scale: 1024.00 | time: 26.588 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1981/  5000| tot_loss: 2.4348 | rl_loss: 0.8880 | pt_loss: 1.5468 | pg_loss: 0.2814 | reg_loss: 0.6066 | reward: -0.7234 | rev_kl: 1.4244 | stu_lens: 76.0000 | mixed_lens: 85.0000 | lr: 3.3994e-06 | scale: 1024.00 | time: 26.582 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1982/  5000| tot_loss: 2.7704 | rl_loss: 1.0625 | pt_loss: 1.7079 | pg_loss: 0.5726 | reg_loss: 0.4900 | reward: -0.3884 | rev_kl: 1.7078 | stu_lens: 56.0000 | mixed_lens: 58.0000 | lr: 3.3979e-06 | scale: 1024.00 | time: 26.588 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1983/  5000| tot_loss: 1.9215 | rl_loss: 0.4165 | pt_loss: 1.5049 | pg_loss: 0.0245 | reg_loss: 0.3920 | reward: -0.1528 | rev_kl: 1.1494 | stu_lens: 70.0000 | mixed_lens: 128.0000 | lr: 3.3964e-06 | scale: 1024.00 | time: 26.588 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1984/  5000| tot_loss: 2.8870 | rl_loss: 0.6065 | pt_loss: 2.2805 | pg_loss: 0.2107 | reg_loss: 0.3958 | reward: -0.5911 | rev_kl: 0.6817 | stu_lens: 55.0000 | mixed_lens: 96.5000 | lr: 3.3949e-06 | scale: 1024.00 | time: 26.557 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1984/  5000| tot_loss: 2.5474 | rl_loss: 0.9202 | pt_loss: 1.6271 | pg_loss: 0.4256 | reg_loss: 0.4947 | reward: -0.4790 | rev_kl: 1.3172 | stu_lens: 76.3281 | mixed_lens: 70.2344 | lr: 3.3949e-06 | scale: 1024.00 | time: 26.557 | step time: 27.850
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1985/  5000| tot_loss: 2.9622 | rl_loss: 1.0491 | pt_loss: 1.9130 | pg_loss: 0.6050 | reg_loss: 0.4442 | reward: -0.2809 | rev_kl: 1.3571 | stu_lens: 96.0000 | mixed_lens: 66.5000 | lr: 3.3934e-06 | scale: 1024.00 | time: 26.569 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1986/  5000| tot_loss: 3.0086 | rl_loss: 0.8633 | pt_loss: 2.1453 | pg_loss: 0.1063 | reg_loss: 0.7570 | reward: -0.1561 | rev_kl: 1.1281 | stu_lens: 64.0000 | mixed_lens: 111.0000 | lr: 3.3919e-06 | scale: 1024.00 | time: 26.588 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1987/  5000| tot_loss: 3.2185 | rl_loss: 1.7277 | pt_loss: 1.4908 | pg_loss: 0.6275 | reg_loss: 1.1002 | reward: -1.3989 | rev_kl: 1.1363 | stu_lens: 63.0000 | mixed_lens: 31.5000 | lr: 3.3904e-06 | scale: 1024.00 | time: 26.547 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1988/  5000| tot_loss: 5.5004 | rl_loss: 3.8529 | pt_loss: 1.6476 | pg_loss: 1.8794 | reg_loss: 1.9735 | reward: -2.6620 | rev_kl: 0.4773 | stu_lens: 69.5000 | mixed_lens: 14.0000 | lr: 3.3889e-06 | scale: 1024.00 | time: 26.535 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1989/  5000| tot_loss: 3.0975 | rl_loss: 1.6526 | pt_loss: 1.4448 | pg_loss: 0.4515 | reg_loss: 1.2012 | reward: -0.4518 | rev_kl: 1.6778 | stu_lens: 87.0000 | mixed_lens: 82.0000 | lr: 3.3874e-06 | scale: 1024.00 | time: 26.573 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1990/  5000| tot_loss: 3.1084 | rl_loss: 1.3770 | pt_loss: 1.7314 | pg_loss: 0.3965 | reg_loss: 0.9805 | reward: -0.7414 | rev_kl: 0.8867 | stu_lens: 76.0000 | mixed_lens: 40.5000 | lr: 3.3859e-06 | scale: 1024.00 | time: 26.539 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1991/  5000| tot_loss: 2.2246 | rl_loss: 0.6666 | pt_loss: 1.5580 | pg_loss: 0.2336 | reg_loss: 0.4329 | reward: -1.2025 | rev_kl: 0.4901 | stu_lens: 111.5000 | mixed_lens: 74.0000 | lr: 3.3844e-06 | scale: 1024.00 | time: 26.564 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1992/  5000| tot_loss: 2.9150 | rl_loss: 1.3008 | pt_loss: 1.6142 | pg_loss: 0.2027 | reg_loss: 1.0981 | reward: -0.3156 | rev_kl: 0.9498 | stu_lens: 80.5000 | mixed_lens: 100.5000 | lr: 3.3829e-06 | scale: 1024.00 | time: 26.535 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1993/  5000| tot_loss: 2.4973 | rl_loss: 1.0769 | pt_loss: 1.4203 | pg_loss: 0.1224 | reg_loss: 0.9545 | reward: -0.1439 | rev_kl: 0.8274 | stu_lens: 119.0000 | mixed_lens: 117.5000 | lr: 3.3814e-06 | scale: 1024.00 | time: 26.557 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1994/  5000| tot_loss: 3.1508 | rl_loss: 1.6899 | pt_loss: 1.4610 | pg_loss: 0.1938 | reg_loss: 1.4961 | reward: -0.3481 | rev_kl: 1.4664 | stu_lens: 128.0000 | mixed_lens: 106.5000 | lr: 3.3799e-06 | scale: 1024.00 | time: 26.537 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1995/  5000| tot_loss: 3.3529 | rl_loss: 2.0683 | pt_loss: 1.2846 | pg_loss: 0.5309 | reg_loss: 1.5374 | reward: -0.8610 | rev_kl: 1.0153 | stu_lens: 79.0000 | mixed_lens: 70.0000 | lr: 3.3784e-06 | scale: 1024.00 | time: 26.646 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1996/  5000| tot_loss: 2.6785 | rl_loss: 1.3912 | pt_loss: 1.2872 | pg_loss: 0.1493 | reg_loss: 1.2419 | reward: -0.3556 | rev_kl: 1.0947 | stu_lens: 97.0000 | mixed_lens: 116.5000 | lr: 3.3769e-06 | scale: 1024.00 | time: 26.626 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1997/  5000| tot_loss: 3.5750 | rl_loss: 1.8096 | pt_loss: 1.7654 | pg_loss: 0.3032 | reg_loss: 1.5065 | reward: -0.7140 | rev_kl: 0.9319 | stu_lens: 90.5000 | mixed_lens: 78.5000 | lr: 3.3754e-06 | scale: 1024.00 | time: 26.641 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1998/  5000| tot_loss: 3.0651 | rl_loss: 1.5790 | pt_loss: 1.4861 | pg_loss: 0.3104 | reg_loss: 1.2686 | reward: -0.3525 | rev_kl: 1.3580 | stu_lens: 72.5000 | mixed_lens: 89.5000 | lr: 3.3739e-06 | scale: 1024.00 | time: 26.618 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1999/  5000| tot_loss: 4.8126 | rl_loss: 3.1375 | pt_loss: 1.6751 | pg_loss: 1.2538 | reg_loss: 1.8837 | reward: -0.9955 | rev_kl: 1.3919 | stu_lens: 73.0000 | mixed_lens: 34.5000 | lr: 3.3724e-06 | scale: 1024.00 | time: 26.657 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/2000
                                 Evaluation #20                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Yes, Bob should leave Alice. He has  │
│                                       │ a 31% chance of survival if he       │
│                                       │ remains with Alice, but a 9% chance  │
│                                       │ of survival if he leaves her.        │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ mz kezboard tzpe z instead of y and  │
│                                       │ vice versa is a typing error.        │
│                                       │                                      │
│                                       │ You can check the keyboard layout of │
│                                       │ your computer and change it if       │
│                                       │ needed. Otherwise, you can type with │
│                                       │ the dictionary keyboards provided by │
│                                       │ Google.                              │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support 91 languages.             │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.349 | exact_match: 0.215 | rev_kl: 1.137 | lens: 84.998 | pt_loss: 1.077 | lm_loss: 1.159 | kd_loss: 0.995 
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2000/  5000| tot_loss: 3.6933 | rl_loss: 2.0250 | pt_loss: 1.6683 | pg_loss: 0.3332 | reg_loss: 1.6917 | reward: -0.5986 | rev_kl: 1.1507 | stu_lens: 128.0000 | mixed_lens: 95.0000 | lr: 3.3709e-06 | scale: 1024.00 | time: 26.615 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2000/  5000| tot_loss: 3.4485 | rl_loss: 1.7694 | pt_loss: 1.6791 | pg_loss: 0.5398 | reg_loss: 1.2296 | reward: -0.6206 | rev_kl: 1.2578 | stu_lens: 85.8281 | mixed_lens: 77.7969 | lr: 3.3709e-06 | scale: 1024.00 | time: 26.615 | step time: 27.843
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2001/  5000| tot_loss: 3.2561 | rl_loss: 1.5725 | pt_loss: 1.6836 | pg_loss: 0.3424 | reg_loss: 1.2301 | reward: -0.6050 | rev_kl: 0.9208 | stu_lens: 72.5000 | mixed_lens: 87.5000 | lr: 3.3694e-06 | scale: 1024.00 | time: 26.674 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2002/  5000| tot_loss: 3.3941 | rl_loss: 1.3392 | pt_loss: 2.0549 | pg_loss: 0.4228 | reg_loss: 0.9164 | reward: -0.4564 | rev_kl: 1.1478 | stu_lens: 128.0000 | mixed_lens: 78.0000 | lr: 3.3679e-06 | scale: 1024.00 | time: 26.574 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2003/  5000| tot_loss: 2.3331 | rl_loss: 0.7319 | pt_loss: 1.6012 | pg_loss: 0.0084 | reg_loss: 0.7236 | reward: -0.2690 | rev_kl: 0.5965 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.3664e-06 | scale: 1024.00 | time: 26.611 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2004/  5000| tot_loss: 2.8371 | rl_loss: 1.2484 | pt_loss: 1.5887 | pg_loss: 0.4226 | reg_loss: 0.8259 | reward: -0.2657 | rev_kl: 1.1143 | stu_lens: 83.5000 | mixed_lens: 79.5000 | lr: 3.3649e-06 | scale: 1024.00 | time: 26.557 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2005/  5000| tot_loss: 3.0205 | rl_loss: 1.4367 | pt_loss: 1.5839 | pg_loss: 0.4674 | reg_loss: 0.9693 | reward: 0.0402 | rev_kl: 1.0024 | stu_lens: 110.5000 | mixed_lens: 74.5000 | lr: 3.3634e-06 | scale: 1024.00 | time: 26.594 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2006/  5000| tot_loss: 3.8204 | rl_loss: 1.9496 | pt_loss: 1.8708 | pg_loss: 0.5673 | reg_loss: 1.3823 | reward: -1.4180 | rev_kl: 1.1465 | stu_lens: 66.5000 | mixed_lens: 66.5000 | lr: 3.3619e-06 | scale: 1024.00 | time: 26.616 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2007/  5000| tot_loss: 2.4050 | rl_loss: 0.5494 | pt_loss: 1.8556 | pg_loss: 0.0066 | reg_loss: 0.5428 | reward: -0.1517 | rev_kl: 4.2250 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.3604e-06 | scale: 1024.00 | time: 26.609 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2008/  5000| tot_loss: 2.1636 | rl_loss: 0.7226 | pt_loss: 1.4411 | pg_loss: 0.1683 | reg_loss: 0.5542 | reward: -0.4425 | rev_kl: 0.9589 | stu_lens: 65.5000 | mixed_lens: 93.0000 | lr: 3.3589e-06 | scale: 1024.00 | time: 26.568 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2009/  5000| tot_loss: 3.6932 | rl_loss: 2.0574 | pt_loss: 1.6358 | pg_loss: 0.8519 | reg_loss: 1.2055 | reward: -0.7185 | rev_kl: 1.1382 | stu_lens: 95.5000 | mixed_lens: 55.0000 | lr: 3.3574e-06 | scale: 1024.00 | time: 26.592 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2010/  5000| tot_loss: 2.4900 | rl_loss: 0.8648 | pt_loss: 1.6252 | pg_loss: 0.0858 | reg_loss: 0.7790 | reward: -0.1666 | rev_kl: 1.0040 | stu_lens: 119.0000 | mixed_lens: 117.5000 | lr: 3.3559e-06 | scale: 1024.00 | time: 26.536 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2011/  5000| tot_loss: 2.8657 | rl_loss: 1.5553 | pt_loss: 1.3104 | pg_loss: 0.5181 | reg_loss: 1.0372 | reward: -0.5199 | rev_kl: 0.9006 | stu_lens: 70.0000 | mixed_lens: 69.5000 | lr: 3.3544e-06 | scale: 1024.00 | time: 26.586 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2012/  5000| tot_loss: 3.9631 | rl_loss: 2.4219 | pt_loss: 1.5412 | pg_loss: 1.3508 | reg_loss: 1.0712 | reward: -1.1815 | rev_kl: 1.0557 | stu_lens: 14.0000 | mixed_lens: 31.0000 | lr: 3.3529e-06 | scale: 1024.00 | time: 26.554 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2013/  5000| tot_loss: 2.6917 | rl_loss: 0.4968 | pt_loss: 2.1949 | pg_loss: 0.1446 | reg_loss: 0.3522 | reward: -0.3097 | rev_kl: 0.8508 | stu_lens: 128.0000 | mixed_lens: 93.5000 | lr: 3.3514e-06 | scale: 1024.00 | time: 26.582 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2014/  5000| tot_loss: 3.5114 | rl_loss: 1.6772 | pt_loss: 1.8343 | pg_loss: 0.4134 | reg_loss: 1.2638 | reward: -1.8060 | rev_kl: 1.6557 | stu_lens: 71.5000 | mixed_lens: 65.5000 | lr: 3.3499e-06 | scale: 1024.00 | time: 26.554 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2015/  5000| tot_loss: 3.1661 | rl_loss: 1.4531 | pt_loss: 1.7130 | pg_loss: 0.5527 | reg_loss: 0.9003 | reward: -0.8939 | rev_kl: 1.0086 | stu_lens: 72.5000 | mixed_lens: 67.5000 | lr: 3.3484e-06 | scale: 1024.00 | time: 26.567 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2016/  5000| tot_loss: 2.6762 | rl_loss: 0.7692 | pt_loss: 1.9070 | pg_loss: 0.1751 | reg_loss: 0.5941 | reward: -0.6449 | rev_kl: 1.1589 | stu_lens: 36.5000 | mixed_lens: 75.0000 | lr: 3.3468e-06 | scale: 1024.00 | time: 26.607 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2016/  5000| tot_loss: 3.0417 | rl_loss: 1.3236 | pt_loss: 1.7181 | pg_loss: 0.4253 | reg_loss: 0.8983 | reward: -0.6410 | rev_kl: 1.2747 | stu_lens: 88.4219 | mixed_lens: 82.8750 | lr: 3.3468e-06 | scale: 1024.00 | time: 26.607 | step time: 27.853
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2017/  5000| tot_loss: 2.2863 | rl_loss: 0.3400 | pt_loss: 1.9462 | pg_loss: 0.0371 | reg_loss: 0.3030 | reward: -0.2032 | rev_kl: 0.6386 | stu_lens: 83.0000 | mixed_lens: 99.0000 | lr: 3.3453e-06 | scale: 1024.00 | time: 26.614 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2018/  5000| tot_loss: 3.1521 | rl_loss: 1.4265 | pt_loss: 1.7256 | pg_loss: 0.5463 | reg_loss: 0.8802 | reward: -0.6693 | rev_kl: 0.9758 | stu_lens: 95.5000 | mixed_lens: 72.0000 | lr: 3.3438e-06 | scale: 1024.00 | time: 26.547 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2019/  5000| tot_loss: 2.9707 | rl_loss: 1.2476 | pt_loss: 1.7231 | pg_loss: 0.5640 | reg_loss: 0.6836 | reward: -0.4672 | rev_kl: 1.5337 | stu_lens: 73.5000 | mixed_lens: 48.0000 | lr: 3.3423e-06 | scale: 1024.00 | time: 26.570 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2020/  5000| tot_loss: 2.3744 | rl_loss: 1.0313 | pt_loss: 1.3431 | pg_loss: 0.4683 | reg_loss: 0.5630 | reward: -0.5772 | rev_kl: 0.6130 | stu_lens: 28.5000 | mixed_lens: 57.5000 | lr: 3.3408e-06 | scale: 1024.00 | time: 26.560 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2021/  5000| tot_loss: 1.9783 | rl_loss: 0.2604 | pt_loss: 1.7179 | pg_loss: 0.1204 | reg_loss: 0.1400 | reward: -0.2363 | rev_kl: 0.6846 | stu_lens: 67.0000 | mixed_lens: 79.5000 | lr: 3.3393e-06 | scale: 1024.00 | time: 26.560 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2022/  5000| tot_loss: 1.6715 | rl_loss: 0.4939 | pt_loss: 1.1776 | pg_loss: -0.0046 | reg_loss: 0.4985 | reward: -0.2702 | rev_kl: 1.5442 | stu_lens: 120.0000 | mixed_lens: 128.0000 | lr: 3.3378e-06 | scale: 1024.00 | time: 26.540 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2023/  5000| tot_loss: 2.7326 | rl_loss: 1.1227 | pt_loss: 1.6099 | pg_loss: 0.5608 | reg_loss: 0.5618 | reward: -0.4209 | rev_kl: 1.2149 | stu_lens: 46.5000 | mixed_lens: 58.0000 | lr: 3.3363e-06 | scale: 1024.00 | time: 26.554 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2024/  5000| tot_loss: 2.1211 | rl_loss: 0.5927 | pt_loss: 1.5284 | pg_loss: 0.1755 | reg_loss: 0.4173 | reward: -0.4425 | rev_kl: 0.9589 | stu_lens: 65.5000 | mixed_lens: 93.0000 | lr: 3.3348e-06 | scale: 1024.00 | time: 26.536 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2025/  5000| tot_loss: 2.6866 | rl_loss: 1.0875 | pt_loss: 1.5991 | pg_loss: 0.3902 | reg_loss: 0.6973 | reward: -1.0660 | rev_kl: 0.8567 | stu_lens: 69.5000 | mixed_lens: 69.5000 | lr: 3.3333e-06 | scale: 1024.00 | time: 26.569 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2026/  5000| tot_loss: 2.2423 | rl_loss: 1.0726 | pt_loss: 1.1697 | pg_loss: 0.4610 | reg_loss: 0.6116 | reward: -0.6437 | rev_kl: 1.0576 | stu_lens: 103.0000 | mixed_lens: 82.5000 | lr: 3.3317e-06 | scale: 1024.00 | time: 26.559 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2027/  5000| tot_loss: 1.7551 | rl_loss: 0.7668 | pt_loss: 0.9883 | pg_loss: 0.2331 | reg_loss: 0.5337 | reward: -0.4008 | rev_kl: 1.0152 | stu_lens: 128.0000 | mixed_lens: 93.5000 | lr: 3.3302e-06 | scale: 1024.00 | time: 26.555 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2028/  5000| tot_loss: 2.0908 | rl_loss: 0.5264 | pt_loss: 1.5644 | pg_loss: 0.1351 | reg_loss: 0.3913 | reward: -0.6623 | rev_kl: 1.4373 | stu_lens: 26.5000 | mixed_lens: 100.5000 | lr: 3.3287e-06 | scale: 1024.00 | time: 26.578 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2029/  5000| tot_loss: 3.0194 | rl_loss: 1.2595 | pt_loss: 1.7599 | pg_loss: 0.5291 | reg_loss: 0.7304 | reward: -0.3624 | rev_kl: 1.5246 | stu_lens: 106.0000 | mixed_lens: 79.5000 | lr: 3.3272e-06 | scale: 1024.00 | time: 26.596 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2030/  5000| tot_loss: 3.3233 | rl_loss: 2.0366 | pt_loss: 1.2868 | pg_loss: 1.3254 | reg_loss: 0.7112 | reward: -1.2256 | rev_kl: 0.9248 | stu_lens: 60.5000 | mixed_lens: 30.0000 | lr: 3.3257e-06 | scale: 1024.00 | time: 26.536 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2031/  5000| tot_loss: 3.1206 | rl_loss: 1.2851 | pt_loss: 1.8354 | pg_loss: 0.6207 | reg_loss: 0.6645 | reward: -0.6133 | rev_kl: 1.4489 | stu_lens: 82.5000 | mixed_lens: 64.0000 | lr: 3.3242e-06 | scale: 1024.00 | time: 26.556 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2032/  5000| tot_loss: 1.8639 | rl_loss: 0.3289 | pt_loss: 1.5349 | pg_loss: 0.0811 | reg_loss: 0.2478 | reward: -0.2887 | rev_kl: 4.1621 | stu_lens: 83.0000 | mixed_lens: 99.0000 | lr: 3.3227e-06 | scale: 1024.00 | time: 26.543 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2032/  5000| tot_loss: 2.4767 | rl_loss: 0.8783 | pt_loss: 1.5984 | pg_loss: 0.3174 | reg_loss: 0.5609 | reward: -0.6044 | rev_kl: 1.2291 | stu_lens: 89.8594 | mixed_lens: 84.0625 | lr: 3.3227e-06 | scale: 1024.00 | time: 26.543 | step time: 27.822
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2033/  5000| tot_loss: 3.5028 | rl_loss: 1.6999 | pt_loss: 1.8028 | pg_loss: 0.8053 | reg_loss: 0.8946 | reward: -1.2122 | rev_kl: 1.7752 | stu_lens: 79.0000 | mixed_lens: 49.5000 | lr: 3.3212e-06 | scale: 1024.00 | time: 26.568 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2034/  5000| tot_loss: 2.5053 | rl_loss: 0.8724 | pt_loss: 1.6329 | pg_loss: 0.2639 | reg_loss: 0.6085 | reward: -0.3880 | rev_kl: 0.8480 | stu_lens: 95.0000 | mixed_lens: 82.0000 | lr: 3.3196e-06 | scale: 1024.00 | time: 26.539 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2035/  5000| tot_loss: 2.2640 | rl_loss: 0.4338 | pt_loss: 1.8302 | pg_loss: 0.1827 | reg_loss: 0.2511 | reward: -0.2623 | rev_kl: 1.0353 | stu_lens: 128.0000 | mixed_lens: 106.5000 | lr: 3.3181e-06 | scale: 1024.00 | time: 26.590 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2036/  5000| tot_loss: 2.5319 | rl_loss: 0.6575 | pt_loss: 1.8744 | pg_loss: 0.0625 | reg_loss: 0.5950 | reward: -0.1611 | rev_kl: 0.9391 | stu_lens: 128.0000 | mixed_lens: 118.0000 | lr: 3.3166e-06 | scale: 1024.00 | time: 26.578 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2037/  5000| tot_loss: 1.5582 | rl_loss: 0.3551 | pt_loss: 1.2032 | pg_loss: 0.1754 | reg_loss: 0.1796 | reward: -0.3099 | rev_kl: 0.9064 | stu_lens: 77.5000 | mixed_lens: 103.0000 | lr: 3.3151e-06 | scale: 1024.00 | time: 26.590 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2038/  5000| tot_loss: 2.5720 | rl_loss: 1.1861 | pt_loss: 1.3858 | pg_loss: 0.4909 | reg_loss: 0.6952 | reward: -0.3021 | rev_kl: 2.1230 | stu_lens: 73.5000 | mixed_lens: 64.5000 | lr: 3.3136e-06 | scale: 1024.00 | time: 26.576 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2039/  5000| tot_loss: 2.4427 | rl_loss: 0.7298 | pt_loss: 1.7129 | pg_loss: 0.2032 | reg_loss: 0.5266 | reward: -0.9004 | rev_kl: 1.3492 | stu_lens: 70.0000 | mixed_lens: 58.0000 | lr: 3.3121e-06 | scale: 1024.00 | time: 26.656 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2040/  5000| tot_loss: 2.2078 | rl_loss: 0.4734 | pt_loss: 1.7344 | pg_loss: 0.1830 | reg_loss: 0.2904 | reward: -0.5982 | rev_kl: 1.3094 | stu_lens: 75.5000 | mixed_lens: 91.0000 | lr: 3.3106e-06 | scale: 1024.00 | time: 26.609 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2041/  5000| tot_loss: 2.9279 | rl_loss: 1.5273 | pt_loss: 1.4006 | pg_loss: 0.9590 | reg_loss: 0.5682 | reward: -0.4981 | rev_kl: 0.8670 | stu_lens: 51.0000 | mixed_lens: 43.5000 | lr: 3.3090e-06 | scale: 1024.00 | time: 26.617 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2042/  5000| tot_loss: 1.7738 | rl_loss: 0.7007 | pt_loss: 1.0731 | pg_loss: 0.2715 | reg_loss: 0.4292 | reward: -0.2891 | rev_kl: 1.4066 | stu_lens: 128.0000 | mixed_lens: 96.0000 | lr: 3.3075e-06 | scale: 1024.00 | time: 26.572 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2043/  5000| tot_loss: 2.3768 | rl_loss: 0.6649 | pt_loss: 1.7119 | pg_loss: 0.1344 | reg_loss: 0.5306 | reward: -0.3556 | rev_kl: 1.0947 | stu_lens: 97.0000 | mixed_lens: 116.5000 | lr: 3.3060e-06 | scale: 1024.00 | time: 26.634 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2044/  5000| tot_loss: 2.3768 | rl_loss: 0.5205 | pt_loss: 1.8563 | pg_loss: 0.1103 | reg_loss: 0.4103 | reward: -0.4597 | rev_kl: 1.0098 | stu_lens: 83.0000 | mixed_lens: 99.0000 | lr: 3.3045e-06 | scale: 1024.00 | time: 26.544 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2045/  5000| tot_loss: 2.1368 | rl_loss: 0.6108 | pt_loss: 1.5259 | pg_loss: 0.3280 | reg_loss: 0.2829 | reward: -0.9693 | rev_kl: 0.6963 | stu_lens: 69.5000 | mixed_lens: 69.5000 | lr: 3.3030e-06 | scale: 1024.00 | time: 26.617 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2046/  5000| tot_loss: 2.9057 | rl_loss: 0.8452 | pt_loss: 2.0605 | pg_loss: 0.4597 | reg_loss: 0.3855 | reward: -0.7031 | rev_kl: 1.4947 | stu_lens: 44.0000 | mixed_lens: 76.5000 | lr: 3.3014e-06 | scale: 1024.00 | time: 26.576 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2047/  5000| tot_loss: 2.9789 | rl_loss: 1.1061 | pt_loss: 1.8728 | pg_loss: 0.7794 | reg_loss: 0.3267 | reward: -1.7523 | rev_kl: 1.6325 | stu_lens: 71.5000 | mixed_lens: 31.0000 | lr: 3.2999e-06 | scale: 1024.00 | time: 26.594 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2048/  5000| tot_loss: 3.3995 | rl_loss: 1.5438 | pt_loss: 1.8557 | pg_loss: 0.6397 | reg_loss: 0.9041 | reward: -0.8055 | rev_kl: 1.6680 | stu_lens: 89.5000 | mixed_lens: 59.5000 | lr: 3.2984e-06 | scale: 1024.00 | time: 26.609 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2048/  5000| tot_loss: 2.5762 | rl_loss: 0.8750 | pt_loss: 1.7012 | pg_loss: 0.3844 | reg_loss: 0.4906 | reward: -0.6628 | rev_kl: 1.2941 | stu_lens: 87.3281 | mixed_lens: 79.4688 | lr: 3.2984e-06 | scale: 1024.00 | time: 26.609 | step time: 27.853
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2049/  5000| tot_loss: 1.7753 | rl_loss: 0.5261 | pt_loss: 1.2491 | pg_loss: 0.1967 | reg_loss: 0.3295 | reward: -0.3089 | rev_kl: 1.0575 | stu_lens: 94.0000 | mixed_lens: 105.0000 | lr: 3.2969e-06 | scale: 1024.00 | time: 26.634 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2050/  5000| tot_loss: 3.2868 | rl_loss: 1.4305 | pt_loss: 1.8563 | pg_loss: 0.2809 | reg_loss: 1.1496 | reward: -0.4692 | rev_kl: 1.1039 | stu_lens: 77.0000 | mixed_lens: 89.0000 | lr: 3.2954e-06 | scale: 1024.00 | time: 26.659 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2051/  5000| tot_loss: 3.1545 | rl_loss: 1.3370 | pt_loss: 1.8175 | pg_loss: 0.0867 | reg_loss: 1.2503 | reward: -0.2883 | rev_kl: 1.4553 | stu_lens: 51.5000 | mixed_lens: 124.5000 | lr: 3.2939e-06 | scale: 1024.00 | time: 26.581 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2052/  5000| tot_loss: 3.8156 | rl_loss: 1.6579 | pt_loss: 2.1577 | pg_loss: 0.2271 | reg_loss: 1.4308 | reward: -0.6220 | rev_kl: 0.9783 | stu_lens: 79.0000 | mixed_lens: 82.5000 | lr: 3.2923e-06 | scale: 1024.00 | time: 26.595 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2053/  5000| tot_loss: 3.8709 | rl_loss: 1.8083 | pt_loss: 2.0626 | pg_loss: 0.2603 | reg_loss: 1.5481 | reward: -0.4060 | rev_kl: 1.5331 | stu_lens: 111.0000 | mixed_lens: 88.5000 | lr: 3.2908e-06 | scale: 1024.00 | time: 26.550 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2054/  5000| tot_loss: 3.2825 | rl_loss: 1.4501 | pt_loss: 1.8324 | pg_loss: 0.3881 | reg_loss: 1.0620 | reward: -0.3651 | rev_kl: 1.5462 | stu_lens: 69.5000 | mixed_lens: 62.0000 | lr: 3.2893e-06 | scale: 1024.00 | time: 26.572 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2055/  5000| tot_loss: 4.0812 | rl_loss: 2.2944 | pt_loss: 1.7868 | pg_loss: 0.7341 | reg_loss: 1.5603 | reward: -0.8169 | rev_kl: 1.4342 | stu_lens: 88.5000 | mixed_lens: 72.0000 | lr: 3.2878e-06 | scale: 1024.00 | time: 26.578 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2056/  5000| tot_loss: 3.9129 | rl_loss: 1.8863 | pt_loss: 2.0266 | pg_loss: 0.4663 | reg_loss: 1.4200 | reward: -0.5873 | rev_kl: 1.5313 | stu_lens: 76.5000 | mixed_lens: 81.5000 | lr: 3.2862e-06 | scale: 1024.00 | time: 26.600 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2057/  5000| tot_loss: 2.6713 | rl_loss: 1.2011 | pt_loss: 1.4702 | pg_loss: 0.0448 | reg_loss: 1.1564 | reward: -0.1653 | rev_kl: 1.0550 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.2847e-06 | scale: 1024.00 | time: 26.584 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2058/  5000| tot_loss: 2.8627 | rl_loss: 1.2863 | pt_loss: 1.5764 | pg_loss: 0.1942 | reg_loss: 1.0921 | reward: -0.4212 | rev_kl: 1.4013 | stu_lens: 82.5000 | mixed_lens: 103.0000 | lr: 3.2832e-06 | scale: 1024.00 | time: 26.610 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2059/  5000| tot_loss: 3.1129 | rl_loss: 1.2341 | pt_loss: 1.8788 | pg_loss: 0.1986 | reg_loss: 1.0355 | reward: -0.2330 | rev_kl: 1.4426 | stu_lens: 85.0000 | mixed_lens: 105.0000 | lr: 3.2817e-06 | scale: 1024.00 | time: 26.570 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2060/  5000| tot_loss: 2.9153 | rl_loss: 1.2185 | pt_loss: 1.6968 | pg_loss: 0.3557 | reg_loss: 0.8628 | reward: -0.1542 | rev_kl: 0.9550 | stu_lens: 84.5000 | mixed_lens: 94.0000 | lr: 3.2802e-06 | scale: 1024.00 | time: 26.620 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2061/  5000| tot_loss: 2.4773 | rl_loss: 1.3561 | pt_loss: 1.1212 | pg_loss: 0.0704 | reg_loss: 1.2857 | reward: -0.1642 | rev_kl: 1.2600 | stu_lens: 118.5000 | mixed_lens: 126.0000 | lr: 3.2786e-06 | scale: 1024.00 | time: 26.590 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2062/  5000| tot_loss: 3.3899 | rl_loss: 1.9835 | pt_loss: 1.4064 | pg_loss: 0.4958 | reg_loss: 1.4878 | reward: -0.9115 | rev_kl: 0.7233 | stu_lens: 118.0000 | mixed_lens: 72.5000 | lr: 3.2771e-06 | scale: 1024.00 | time: 26.605 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2063/  5000| tot_loss: 3.4514 | rl_loss: 1.6985 | pt_loss: 1.7529 | pg_loss: 0.0708 | reg_loss: 1.6277 | reward: -0.3309 | rev_kl: 1.2405 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.2756e-06 | scale: 1024.00 | time: 26.599 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2064/  5000| tot_loss: 3.4165 | rl_loss: 1.2378 | pt_loss: 2.1786 | pg_loss: 0.3540 | reg_loss: 0.8839 | reward: -0.3783 | rev_kl: 1.4097 | stu_lens: 97.0000 | mixed_lens: 88.0000 | lr: 3.2741e-06 | scale: 1024.00 | time: 26.603 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2064/  5000| tot_loss: 3.2147 | rl_loss: 1.4562 | pt_loss: 1.7585 | pg_loss: 0.2940 | reg_loss: 1.1622 | reward: -0.3511 | rev_kl: 1.1608 | stu_lens: 87.2188 | mixed_lens: 92.6406 | lr: 3.2741e-06 | scale: 1024.00 | time: 26.603 | step time: 27.855
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2065/  5000| tot_loss: 3.6696 | rl_loss: 2.3353 | pt_loss: 1.3343 | pg_loss: 1.3310 | reg_loss: 1.0042 | reward: -0.8770 | rev_kl: 0.9241 | stu_lens: 50.5000 | mixed_lens: 28.5000 | lr: 3.2725e-06 | scale: 1024.00 | time: 26.580 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2066/  5000| tot_loss: 4.3685 | rl_loss: 2.3785 | pt_loss: 1.9900 | pg_loss: 1.0557 | reg_loss: 1.3229 | reward: -0.6749 | rev_kl: 0.6355 | stu_lens: 14.0000 | mixed_lens: 18.0000 | lr: 3.2710e-06 | scale: 1024.00 | time: 26.618 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2067/  5000| tot_loss: 2.6947 | rl_loss: 1.1268 | pt_loss: 1.5679 | pg_loss: 0.2696 | reg_loss: 0.8572 | reward: -0.4102 | rev_kl: 1.6994 | stu_lens: 85.0000 | mixed_lens: 105.0000 | lr: 3.2695e-06 | scale: 1024.00 | time: 26.591 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2068/  5000| tot_loss: 4.1090 | rl_loss: 1.7173 | pt_loss: 2.3917 | pg_loss: 1.0674 | reg_loss: 0.6499 | reward: -0.5982 | rev_kl: 1.4526 | stu_lens: 16.0000 | mixed_lens: 28.5000 | lr: 3.2680e-06 | scale: 1024.00 | time: 26.696 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2069/  5000| tot_loss: 2.0842 | rl_loss: 0.7077 | pt_loss: 1.3765 | pg_loss: 0.1948 | reg_loss: 0.5129 | reward: -0.0916 | rev_kl: 1.5409 | stu_lens: 111.5000 | mixed_lens: 94.0000 | lr: 3.2664e-06 | scale: 1024.00 | time: 26.586 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2070/  5000| tot_loss: 2.4981 | rl_loss: 0.8054 | pt_loss: 1.6927 | pg_loss: 0.0231 | reg_loss: 0.7823 | reward: -0.3849 | rev_kl: 1.4254 | stu_lens: 108.5000 | mixed_lens: 128.0000 | lr: 3.2649e-06 | scale: 1024.00 | time: 26.614 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2071/  5000| tot_loss: 3.8890 | rl_loss: 1.7103 | pt_loss: 2.1788 | pg_loss: 0.6652 | reg_loss: 1.0451 | reward: -0.7183 | rev_kl: 1.2392 | stu_lens: 51.5000 | mixed_lens: 67.5000 | lr: 3.2634e-06 | scale: 1024.00 | time: 26.675 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2072/  5000| tot_loss: 3.0446 | rl_loss: 0.9689 | pt_loss: 2.0757 | pg_loss: 0.2001 | reg_loss: 0.7689 | reward: -0.3631 | rev_kl: 1.4927 | stu_lens: 111.0000 | mixed_lens: 88.5000 | lr: 3.2619e-06 | scale: 1024.00 | time: 26.598 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2073/  5000| tot_loss: 2.7445 | rl_loss: 0.9698 | pt_loss: 1.7747 | pg_loss: 0.2520 | reg_loss: 0.7178 | reward: -0.5374 | rev_kl: 1.0191 | stu_lens: 52.5000 | mixed_lens: 88.0000 | lr: 3.2603e-06 | scale: 1024.00 | time: 26.577 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2074/  5000| tot_loss: 2.7005 | rl_loss: 0.8292 | pt_loss: 1.8713 | pg_loss: 0.0519 | reg_loss: 0.7773 | reward: -0.2550 | rev_kl: 0.9399 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.2588e-06 | scale: 1024.00 | time: 26.643 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2075/  5000| tot_loss: 2.8433 | rl_loss: 0.7678 | pt_loss: 2.0755 | pg_loss: 0.0186 | reg_loss: 0.7492 | reward: -0.3962 | rev_kl: 1.4197 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.2573e-06 | scale: 1024.00 | time: 26.597 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2076/  5000| tot_loss: 2.4696 | rl_loss: 1.2041 | pt_loss: 1.2654 | pg_loss: 0.2824 | reg_loss: 0.9218 | reward: -0.4918 | rev_kl: 1.2205 | stu_lens: 96.0000 | mixed_lens: 98.0000 | lr: 3.2558e-06 | scale: 1024.00 | time: 26.652 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2077/  5000| tot_loss: 2.9884 | rl_loss: 1.3672 | pt_loss: 1.6212 | pg_loss: 0.3975 | reg_loss: 0.9697 | reward: -0.6276 | rev_kl: 0.7388 | stu_lens: 79.0000 | mixed_lens: 39.0000 | lr: 3.2542e-06 | scale: 1024.00 | time: 26.575 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2078/  5000| tot_loss: 2.9349 | rl_loss: 1.2481 | pt_loss: 1.6868 | pg_loss: 0.2377 | reg_loss: 1.0104 | reward: -0.1313 | rev_kl: 1.7815 | stu_lens: 69.5000 | mixed_lens: 75.5000 | lr: 3.2527e-06 | scale: 1024.00 | time: 26.615 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2079/  5000| tot_loss: 2.0538 | rl_loss: 0.5060 | pt_loss: 1.5478 | pg_loss: 0.0881 | reg_loss: 0.4179 | reward: -0.3823 | rev_kl: 0.8683 | stu_lens: 128.0000 | mixed_lens: 114.5000 | lr: 3.2512e-06 | scale: 1024.00 | time: 26.591 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2080/  5000| tot_loss: 3.4094 | rl_loss: 1.1499 | pt_loss: 2.2595 | pg_loss: 0.4620 | reg_loss: 0.6879 | reward: -0.5280 | rev_kl: 0.8705 | stu_lens: 50.5000 | mixed_lens: 46.0000 | lr: 3.2496e-06 | scale: 1024.00 | time: 26.635 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2080/  5000| tot_loss: 2.9231 | rl_loss: 1.1905 | pt_loss: 1.7326 | pg_loss: 0.3872 | reg_loss: 0.8033 | reward: -0.4550 | rev_kl: 1.1877 | stu_lens: 78.9688 | mixed_lens: 81.8594 | lr: 3.2496e-06 | scale: 1024.00 | time: 26.635 | step time: 27.874
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2081/  5000| tot_loss: 1.9788 | rl_loss: 0.6134 | pt_loss: 1.3654 | pg_loss: -0.0064 | reg_loss: 0.6199 | reward: -0.2251 | rev_kl: 0.8704 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.2481e-06 | scale: 1024.00 | time: 26.597 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2082/  5000| tot_loss: 2.5218 | rl_loss: 1.3140 | pt_loss: 1.2078 | pg_loss: 0.4005 | reg_loss: 0.9136 | reward: -1.0032 | rev_kl: 0.9001 | stu_lens: 106.0000 | mixed_lens: 60.0000 | lr: 3.2466e-06 | scale: 1024.00 | time: 26.632 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2083/  5000| tot_loss: 2.7177 | rl_loss: 0.8945 | pt_loss: 1.8232 | pg_loss: 0.2489 | reg_loss: 0.6456 | reward: -0.3897 | rev_kl: 1.5946 | stu_lens: 60.0000 | mixed_lens: 76.0000 | lr: 3.2451e-06 | scale: 1024.00 | time: 26.576 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2084/  5000| tot_loss: 2.3370 | rl_loss: 0.8182 | pt_loss: 1.5187 | pg_loss: 0.3256 | reg_loss: 0.4927 | reward: -0.3110 | rev_kl: 0.7808 | stu_lens: 34.0000 | mixed_lens: 80.5000 | lr: 3.2435e-06 | scale: 1024.00 | time: 26.618 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2085/  5000| tot_loss: 2.6185 | rl_loss: 0.8965 | pt_loss: 1.7220 | pg_loss: 0.1857 | reg_loss: 0.7108 | reward: -0.3026 | rev_kl: 1.9044 | stu_lens: 85.0000 | mixed_lens: 105.0000 | lr: 3.2420e-06 | scale: 1024.00 | time: 26.591 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2086/  5000| tot_loss: 2.6662 | rl_loss: 0.7236 | pt_loss: 1.9426 | pg_loss: 0.2180 | reg_loss: 0.5056 | reward: -0.3360 | rev_kl: 1.0895 | stu_lens: 101.0000 | mixed_lens: 87.0000 | lr: 3.2405e-06 | scale: 1024.00 | time: 26.628 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2087/  5000| tot_loss: 2.7784 | rl_loss: 0.7379 | pt_loss: 2.0405 | pg_loss: 0.1507 | reg_loss: 0.5872 | reward: -0.1875 | rev_kl: 1.2122 | stu_lens: 98.0000 | mixed_lens: 109.5000 | lr: 3.2389e-06 | scale: 1024.00 | time: 26.592 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2088/  5000| tot_loss: 3.0640 | rl_loss: 1.2600 | pt_loss: 1.8039 | pg_loss: 0.7200 | reg_loss: 0.5400 | reward: -0.8702 | rev_kl: 1.0375 | stu_lens: 68.0000 | mixed_lens: 67.5000 | lr: 3.2374e-06 | scale: 1024.00 | time: 26.599 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2089/  5000| tot_loss: 2.8527 | rl_loss: 0.9087 | pt_loss: 1.9440 | pg_loss: 0.3487 | reg_loss: 0.5599 | reward: -0.6077 | rev_kl: 1.3014 | stu_lens: 111.0000 | mixed_lens: 75.0000 | lr: 3.2359e-06 | scale: 1024.00 | time: 26.602 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2090/  5000| tot_loss: 1.6628 | rl_loss: 0.3998 | pt_loss: 1.2631 | pg_loss: 0.0208 | reg_loss: 0.3790 | reward: -0.1311 | rev_kl: 1.2387 | stu_lens: 74.0000 | mixed_lens: 128.0000 | lr: 3.2343e-06 | scale: 1024.00 | time: 26.628 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2091/  5000| tot_loss: 1.7585 | rl_loss: 0.4263 | pt_loss: 1.3322 | pg_loss: -0.0103 | reg_loss: 0.4366 | reward: -0.0945 | rev_kl: 1.1595 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.2328e-06 | scale: 1024.00 | time: 26.622 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2092/  5000| tot_loss: 2.6279 | rl_loss: 1.1097 | pt_loss: 1.5181 | pg_loss: 0.6240 | reg_loss: 0.4857 | reward: -1.4138 | rev_kl: 1.6087 | stu_lens: 41.0000 | mixed_lens: 65.0000 | lr: 3.2313e-06 | scale: 1024.00 | time: 26.604 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2093/  5000| tot_loss: 1.9758 | rl_loss: 0.5334 | pt_loss: 1.4424 | pg_loss: 0.1744 | reg_loss: 0.3590 | reward: -0.0749 | rev_kl: 1.3449 | stu_lens: 69.5000 | mixed_lens: 75.5000 | lr: 3.2297e-06 | scale: 1024.00 | time: 26.578 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2094/  5000| tot_loss: 2.3606 | rl_loss: 0.6327 | pt_loss: 1.7279 | pg_loss: 0.1384 | reg_loss: 0.4943 | reward: -0.4592 | rev_kl: 1.2844 | stu_lens: 69.0000 | mixed_lens: 108.0000 | lr: 3.2282e-06 | scale: 1024.00 | time: 26.604 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2095/  5000| tot_loss: 2.2904 | rl_loss: 0.6167 | pt_loss: 1.6738 | pg_loss: 0.2689 | reg_loss: 0.3477 | reward: -0.4000 | rev_kl: 1.0360 | stu_lens: 80.0000 | mixed_lens: 91.5000 | lr: 3.2267e-06 | scale: 1024.00 | time: 26.572 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2096/  5000| tot_loss: 2.1980 | rl_loss: 0.4687 | pt_loss: 1.7294 | pg_loss: 0.2178 | reg_loss: 0.2508 | reward: -0.3651 | rev_kl: 0.8559 | stu_lens: 96.0000 | mixed_lens: 98.0000 | lr: 3.2251e-06 | scale: 1024.00 | time: 26.776 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2096/  5000| tot_loss: 2.4726 | rl_loss: 0.8246 | pt_loss: 1.6480 | pg_loss: 0.2670 | reg_loss: 0.5576 | reward: -0.3992 | rev_kl: 1.1369 | stu_lens: 83.3906 | mixed_lens: 87.7969 | lr: 3.2251e-06 | scale: 1024.00 | time: 26.776 | step time: 27.870
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2097/  5000| tot_loss: 2.7848 | rl_loss: 0.8373 | pt_loss: 1.9475 | pg_loss: 0.2725 | reg_loss: 0.5648 | reward: -0.4410 | rev_kl: 0.9596 | stu_lens: 65.5000 | mixed_lens: 88.0000 | lr: 3.2236e-06 | scale: 1024.00 | time: 26.578 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2098/  5000| tot_loss: 2.4884 | rl_loss: 0.7968 | pt_loss: 1.6916 | pg_loss: 0.2220 | reg_loss: 0.5748 | reward: -0.4991 | rev_kl: 0.9381 | stu_lens: 96.5000 | mixed_lens: 89.0000 | lr: 3.2221e-06 | scale: 1024.00 | time: 26.761 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2099/  5000| tot_loss: 2.5545 | rl_loss: 0.7402 | pt_loss: 1.8143 | pg_loss: 0.2460 | reg_loss: 0.4942 | reward: -0.2504 | rev_kl: 0.9760 | stu_lens: 101.0000 | mixed_lens: 88.0000 | lr: 3.2205e-06 | scale: 1024.00 | time: 26.576 | step time: 0.000
                                 Evaluation #21                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Yes, Bob should leave Alice. His     │
│                                       │ chances of survival are 9% higher if │
│                                       │ he leaves her.                       │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ It is a typing error. The keyboard   │
│                                       │ has external keys for typing y and z │
│                                       │ but the keyboard layout is such that │
│                                       │ the keys for y and z are in the same │
│                                       │ position.                            │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support 90+ languages.            │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.452 | exact_match: 0.323 | rev_kl: 1.127 | lens: 82.061 | pt_loss: 1.075 | lm_loss: 1.157 | kd_loss: 0.994 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2100/  5000| tot_loss: 2.2420 | rl_loss: 0.9876 | pt_loss: 1.2544 | pg_loss: 0.3362 | reg_loss: 0.6514 | reward: -0.7652 | rev_kl: 0.8629 | stu_lens: 128.0000 | mixed_lens: 87.5000 | lr: 3.2190e-06 | scale: 1024.00 | time: 26.638 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2101/  5000| tot_loss: 2.3315 | rl_loss: 1.2220 | pt_loss: 1.1096 | pg_loss: 0.7742 | reg_loss: 0.4478 | reward: -0.6062 | rev_kl: 0.9021 | stu_lens: 78.5000 | mixed_lens: 59.0000 | lr: 3.2175e-06 | scale: 1024.00 | time: 26.781 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2102/  5000| tot_loss: 2.0384 | rl_loss: 0.3171 | pt_loss: 1.7212 | pg_loss: 0.0013 | reg_loss: 0.3158 | reward: -0.2657 | rev_kl: 1.2685 | stu_lens: 63.0000 | mixed_lens: 128.0000 | lr: 3.2159e-06 | scale: 1024.00 | time: 26.639 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2103/  5000| tot_loss: 2.6523 | rl_loss: 1.2472 | pt_loss: 1.4051 | pg_loss: 0.6726 | reg_loss: 0.5746 | reward: -0.8253 | rev_kl: 1.4512 | stu_lens: 27.5000 | mixed_lens: 36.0000 | lr: 3.2144e-06 | scale: 1024.00 | time: 26.623 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2104/  5000| tot_loss: 2.1971 | rl_loss: 0.4591 | pt_loss: 1.7380 | pg_loss: 0.0400 | reg_loss: 0.4191 | reward: -0.0770 | rev_kl: 1.6411 | stu_lens: 118.5000 | mixed_lens: 126.0000 | lr: 3.2129e-06 | scale: 1024.00 | time: 26.643 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2105/  5000| tot_loss: 2.3321 | rl_loss: 0.7491 | pt_loss: 1.5830 | pg_loss: 0.1667 | reg_loss: 0.5824 | reward: -0.3181 | rev_kl: 1.6396 | stu_lens: 95.0000 | mixed_lens: 116.0000 | lr: 3.2113e-06 | scale: 1024.00 | time: 26.686 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2106/  5000| tot_loss: 3.3480 | rl_loss: 1.4845 | pt_loss: 1.8635 | pg_loss: 0.8065 | reg_loss: 0.6780 | reward: -1.0257 | rev_kl: 1.1136 | stu_lens: 38.5000 | mixed_lens: 33.5000 | lr: 3.2098e-06 | scale: 1024.00 | time: 26.668 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2107/  5000| tot_loss: 1.8397 | rl_loss: 0.5812 | pt_loss: 1.2585 | pg_loss: 0.1684 | reg_loss: 0.4128 | reward: -0.2261 | rev_kl: 0.9911 | stu_lens: 114.5000 | mixed_lens: 112.5000 | lr: 3.2082e-06 | scale: 1024.00 | time: 26.670 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2108/  5000| tot_loss: 1.8474 | rl_loss: 0.3784 | pt_loss: 1.4689 | pg_loss: 0.0123 | reg_loss: 0.3661 | reward: -0.1773 | rev_kl: 1.0748 | stu_lens: 128.0000 | mixed_lens: 126.5000 | lr: 3.2067e-06 | scale: 1024.00 | time: 26.633 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2109/  5000| tot_loss: 1.7913 | rl_loss: 0.5431 | pt_loss: 1.2482 | pg_loss: 0.2935 | reg_loss: 0.2497 | reward: -0.2269 | rev_kl: 0.4765 | stu_lens: 78.5000 | mixed_lens: 80.5000 | lr: 3.2052e-06 | scale: 1024.00 | time: 26.667 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2110/  5000| tot_loss: 2.5446 | rl_loss: 1.0022 | pt_loss: 1.5424 | pg_loss: 0.5704 | reg_loss: 0.4318 | reward: -0.7551 | rev_kl: 0.7804 | stu_lens: 98.0000 | mixed_lens: 69.5000 | lr: 3.2036e-06 | scale: 1024.00 | time: 26.615 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2111/  5000| tot_loss: 2.6047 | rl_loss: 0.5040 | pt_loss: 2.1006 | pg_loss: 0.3011 | reg_loss: 0.2029 | reward: -0.2788 | rev_kl: 0.8814 | stu_lens: 53.0000 | mixed_lens: 59.5000 | lr: 3.2021e-06 | scale: 1024.00 | time: 26.647 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2112/  5000| tot_loss: 2.5337 | rl_loss: 0.6511 | pt_loss: 1.8827 | pg_loss: 0.2831 | reg_loss: 0.3680 | reward: -0.3368 | rev_kl: 0.9177 | stu_lens: 55.0000 | mixed_lens: 91.5000 | lr: 3.2006e-06 | scale: 1024.00 | time: 26.694 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2112/  5000| tot_loss: 2.4487 | rl_loss: 0.7876 | pt_loss: 1.6611 | pg_loss: 0.3136 | reg_loss: 0.4740 | reward: -0.4225 | rev_kl: 1.1508 | stu_lens: 83.8906 | mixed_lens: 87.5625 | lr: 3.2006e-06 | scale: 1024.00 | time: 26.694 | step time: 27.909
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2113/  5000| tot_loss: 2.2659 | rl_loss: 0.5437 | pt_loss: 1.7222 | pg_loss: 0.1609 | reg_loss: 0.3828 | reward: -0.4155 | rev_kl: 1.1636 | stu_lens: 128.0000 | mixed_lens: 103.0000 | lr: 3.1990e-06 | scale: 1024.00 | time: 26.652 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2114/  5000| tot_loss: 2.9466 | rl_loss: 1.5035 | pt_loss: 1.4431 | pg_loss: 0.1082 | reg_loss: 1.3953 | reward: -0.1196 | rev_kl: 1.4599 | stu_lens: 128.0000 | mixed_lens: 121.5000 | lr: 3.1975e-06 | scale: 1024.00 | time: 26.693 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2115/  5000| tot_loss: 2.2805 | rl_loss: 1.2047 | pt_loss: 1.0758 | pg_loss: 0.0959 | reg_loss: 1.1088 | reward: 0.0400 | rev_kl: 0.9595 | stu_lens: 102.0000 | mixed_lens: 114.5000 | lr: 3.1959e-06 | scale: 1024.00 | time: 26.695 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2116/  5000| tot_loss: 3.4803 | rl_loss: 1.5194 | pt_loss: 1.9609 | pg_loss: 0.0494 | reg_loss: 1.4701 | reward: -0.3433 | rev_kl: 1.1827 | stu_lens: 121.0000 | mixed_lens: 128.0000 | lr: 3.1944e-06 | scale: 1024.00 | time: 26.645 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2117/  5000| tot_loss: 3.1502 | rl_loss: 1.6141 | pt_loss: 1.5361 | pg_loss: 0.0774 | reg_loss: 1.5366 | reward: -0.3312 | rev_kl: 1.3119 | stu_lens: 122.5000 | mixed_lens: 128.0000 | lr: 3.1929e-06 | scale: 1024.00 | time: 26.628 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2118/  5000| tot_loss: 2.9971 | rl_loss: 1.3446 | pt_loss: 1.6526 | pg_loss: 0.2895 | reg_loss: 1.0550 | reward: -0.1673 | rev_kl: 0.3932 | stu_lens: 100.0000 | mixed_lens: 81.0000 | lr: 3.1913e-06 | scale: 1024.00 | time: 26.940 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2119/  5000| tot_loss: 3.4182 | rl_loss: 1.4763 | pt_loss: 1.9419 | pg_loss: 0.3565 | reg_loss: 1.1198 | reward: -0.4335 | rev_kl: 1.0474 | stu_lens: 90.0000 | mixed_lens: 78.5000 | lr: 3.1898e-06 | scale: 1024.00 | time: 26.635 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2120/  5000| tot_loss: 4.0320 | rl_loss: 1.6934 | pt_loss: 2.3386 | pg_loss: 0.0720 | reg_loss: 1.6214 | reward: -0.4672 | rev_kl: 1.7645 | stu_lens: 87.5000 | mixed_lens: 128.0000 | lr: 3.1882e-06 | scale: 1024.00 | time: 26.626 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2121/  5000| tot_loss: 2.5327 | rl_loss: 0.8876 | pt_loss: 1.6450 | pg_loss: 0.1190 | reg_loss: 0.7686 | reward: -0.2387 | rev_kl: 0.7847 | stu_lens: 97.5000 | mixed_lens: 113.0000 | lr: 3.1867e-06 | scale: 1024.00 | time: 26.641 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2122/  5000| tot_loss: 3.4147 | rl_loss: 1.8344 | pt_loss: 1.5803 | pg_loss: 0.4091 | reg_loss: 1.4252 | reward: -0.3674 | rev_kl: 1.1771 | stu_lens: 63.0000 | mixed_lens: 84.0000 | lr: 3.1852e-06 | scale: 1024.00 | time: 26.782 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2123/  5000| tot_loss: 2.8873 | rl_loss: 1.3137 | pt_loss: 1.5736 | pg_loss: 0.1563 | reg_loss: 1.1575 | reward: -0.1676 | rev_kl: 0.9454 | stu_lens: 94.5000 | mixed_lens: 103.0000 | lr: 3.1836e-06 | scale: 1024.00 | time: 26.635 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2124/  5000| tot_loss: 3.2748 | rl_loss: 1.7202 | pt_loss: 1.5546 | pg_loss: 0.2836 | reg_loss: 1.4366 | reward: -0.4993 | rev_kl: 1.0030 | stu_lens: 98.5000 | mixed_lens: 91.5000 | lr: 3.1821e-06 | scale: 1024.00 | time: 26.628 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2125/  5000| tot_loss: 2.5343 | rl_loss: 1.0574 | pt_loss: 1.4769 | pg_loss: 0.4259 | reg_loss: 0.6315 | reward: -0.3309 | rev_kl: 0.5962 | stu_lens: 98.5000 | mixed_lens: 65.0000 | lr: 3.1805e-06 | scale: 1024.00 | time: 26.693 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2126/  5000| tot_loss: 3.5474 | rl_loss: 1.6211 | pt_loss: 1.9263 | pg_loss: 0.3547 | reg_loss: 1.2663 | reward: -0.3818 | rev_kl: 0.8150 | stu_lens: 66.0000 | mixed_lens: 66.5000 | lr: 3.1790e-06 | scale: 1024.00 | time: 26.663 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2127/  5000| tot_loss: 3.2739 | rl_loss: 1.6037 | pt_loss: 1.6701 | pg_loss: 0.1913 | reg_loss: 1.4125 | reward: -0.3545 | rev_kl: 0.9430 | stu_lens: 84.5000 | mixed_lens: 94.0000 | lr: 3.1774e-06 | scale: 1024.00 | time: 26.606 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2128/  5000| tot_loss: 3.5271 | rl_loss: 1.5672 | pt_loss: 1.9600 | pg_loss: 0.3062 | reg_loss: 1.2610 | reward: -1.1355 | rev_kl: 0.6495 | stu_lens: 79.0000 | mixed_lens: 68.5000 | lr: 3.1759e-06 | scale: 1024.00 | time: 26.627 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2128/  5000| tot_loss: 3.1008 | rl_loss: 1.3763 | pt_loss: 1.7245 | pg_loss: 0.2750 | reg_loss: 1.1013 | reward: -0.3421 | rev_kl: 1.0926 | stu_lens: 92.7969 | mixed_lens: 92.8438 | lr: 3.1759e-06 | scale: 1024.00 | time: 26.627 | step time: 27.913
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2129/  5000| tot_loss: 2.8774 | rl_loss: 1.0731 | pt_loss: 1.8044 | pg_loss: 0.2911 | reg_loss: 0.7820 | reward: -0.3075 | rev_kl: 1.1199 | stu_lens: 89.5000 | mixed_lens: 96.0000 | lr: 3.1744e-06 | scale: 1024.00 | time: 26.696 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2130/  5000| tot_loss: 2.8120 | rl_loss: 0.8509 | pt_loss: 1.9610 | pg_loss: 0.2168 | reg_loss: 0.6341 | reward: -0.5395 | rev_kl: 0.6765 | stu_lens: 98.5000 | mixed_lens: 91.5000 | lr: 3.1728e-06 | scale: 1024.00 | time: 26.626 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2131/  5000| tot_loss: 1.8110 | rl_loss: 0.6733 | pt_loss: 1.1378 | pg_loss: 0.0060 | reg_loss: 0.6672 | reward: -0.2375 | rev_kl: 1.1299 | stu_lens: 111.5000 | mixed_lens: 128.0000 | lr: 3.1713e-06 | scale: 1024.00 | time: 26.619 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2132/  5000| tot_loss: 2.4726 | rl_loss: 0.8230 | pt_loss: 1.6496 | pg_loss: -0.0128 | reg_loss: 0.8357 | reward: -0.3064 | rev_kl: 1.0683 | stu_lens: 106.5000 | mixed_lens: 128.0000 | lr: 3.1697e-06 | scale: 1024.00 | time: 26.637 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2133/  5000| tot_loss: 2.4799 | rl_loss: 0.9836 | pt_loss: 1.4963 | pg_loss: 0.1158 | reg_loss: 0.8678 | reward: -0.4707 | rev_kl: 1.1217 | stu_lens: 54.0000 | mixed_lens: 112.0000 | lr: 3.1682e-06 | scale: 1024.00 | time: 26.735 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2134/  5000| tot_loss: 2.8732 | rl_loss: 1.0440 | pt_loss: 1.8292 | pg_loss: 0.0458 | reg_loss: 0.9982 | reward: -0.3665 | rev_kl: 1.5303 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.1666e-06 | scale: 1024.00 | time: 26.639 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2135/  5000| tot_loss: 2.0425 | rl_loss: 0.7334 | pt_loss: 1.3091 | pg_loss: 0.0423 | reg_loss: 0.6912 | reward: -0.3750 | rev_kl: 1.1491 | stu_lens: 87.5000 | mixed_lens: 128.0000 | lr: 3.1651e-06 | scale: 1024.00 | time: 26.651 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2136/  5000| tot_loss: 3.0366 | rl_loss: 0.8407 | pt_loss: 2.1959 | pg_loss: 0.1819 | reg_loss: 0.6588 | reward: -0.1713 | rev_kl: 1.1295 | stu_lens: 97.0000 | mixed_lens: 107.0000 | lr: 3.1635e-06 | scale: 1024.00 | time: 26.654 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2137/  5000| tot_loss: 2.8238 | rl_loss: 0.9335 | pt_loss: 1.8904 | pg_loss: 0.2272 | reg_loss: 0.7062 | reward: -0.2841 | rev_kl: 0.9407 | stu_lens: 90.5000 | mixed_lens: 102.5000 | lr: 3.1620e-06 | scale: 1024.00 | time: 26.784 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2138/  5000| tot_loss: 3.1118 | rl_loss: 1.2496 | pt_loss: 1.8623 | pg_loss: 0.7396 | reg_loss: 0.5100 | reward: 0.2628 | rev_kl: 0.8932 | stu_lens: 31.0000 | mixed_lens: 46.5000 | lr: 3.1605e-06 | scale: 1024.00 | time: 26.627 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2139/  5000| tot_loss: 2.1880 | rl_loss: 0.6139 | pt_loss: 1.5741 | pg_loss: 0.1661 | reg_loss: 0.4478 | reward: -0.2401 | rev_kl: 1.0634 | stu_lens: 90.5000 | mixed_lens: 96.0000 | lr: 3.1589e-06 | scale: 1024.00 | time: 26.648 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2140/  5000| tot_loss: 2.8342 | rl_loss: 1.3485 | pt_loss: 1.4857 | pg_loss: 0.5610 | reg_loss: 0.7875 | reward: -0.7106 | rev_kl: 0.7470 | stu_lens: 66.0000 | mixed_lens: 39.5000 | lr: 3.1574e-06 | scale: 1024.00 | time: 26.746 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2141/  5000| tot_loss: 2.6949 | rl_loss: 1.2038 | pt_loss: 1.4911 | pg_loss: 0.2670 | reg_loss: 0.9368 | reward: -0.6050 | rev_kl: 1.4807 | stu_lens: 109.0000 | mixed_lens: 88.5000 | lr: 3.1558e-06 | scale: 1024.00 | time: 26.653 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2142/  5000| tot_loss: 2.6809 | rl_loss: 0.8056 | pt_loss: 1.8753 | pg_loss: 0.0795 | reg_loss: 0.7261 | reward: -0.0713 | rev_kl: 0.9298 | stu_lens: 94.5000 | mixed_lens: 108.5000 | lr: 3.1543e-06 | scale: 1024.00 | time: 26.645 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2143/  5000| tot_loss: 2.9137 | rl_loss: 0.9970 | pt_loss: 1.9167 | pg_loss: 0.2190 | reg_loss: 0.7781 | reward: -0.7337 | rev_kl: 1.7938 | stu_lens: 69.5000 | mixed_lens: 64.5000 | lr: 3.1527e-06 | scale: 1024.00 | time: 26.668 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2144/  5000| tot_loss: 3.9767 | rl_loss: 2.3569 | pt_loss: 1.6198 | pg_loss: 1.6949 | reg_loss: 0.6619 | reward: -1.7042 | rev_kl: 0.5260 | stu_lens: 21.5000 | mixed_lens: 10.5000 | lr: 3.1512e-06 | scale: 1024.00 | time: 26.641 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2144/  5000| tot_loss: 2.7181 | rl_loss: 1.0269 | pt_loss: 1.6912 | pg_loss: 0.2593 | reg_loss: 0.7676 | reward: -0.3568 | rev_kl: 1.1060 | stu_lens: 97.0938 | mixed_lens: 94.8438 | lr: 3.1512e-06 | scale: 1024.00 | time: 26.641 | step time: 27.905
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2145/  5000| tot_loss: 3.0815 | rl_loss: 1.0441 | pt_loss: 2.0374 | pg_loss: 0.1522 | reg_loss: 0.8919 | reward: -0.3349 | rev_kl: 1.3211 | stu_lens: 89.0000 | mixed_lens: 103.0000 | lr: 3.1496e-06 | scale: 1024.00 | time: 26.639 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2146/  5000| tot_loss: 3.1463 | rl_loss: 0.7341 | pt_loss: 2.4122 | pg_loss: 0.2633 | reg_loss: 0.4708 | reward: -0.4905 | rev_kl: 1.2638 | stu_lens: 109.0000 | mixed_lens: 62.5000 | lr: 3.1481e-06 | scale: 1024.00 | time: 26.641 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2147/  5000| tot_loss: 3.1463 | rl_loss: 1.2710 | pt_loss: 1.8753 | pg_loss: 0.7403 | reg_loss: 0.5307 | reward: -0.5897 | rev_kl: 1.5714 | stu_lens: 90.5000 | mixed_lens: 63.5000 | lr: 3.1465e-06 | scale: 1024.00 | time: 26.651 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2148/  5000| tot_loss: 2.1482 | rl_loss: 0.6944 | pt_loss: 1.4538 | pg_loss: 0.1873 | reg_loss: 0.5071 | reward: -0.4387 | rev_kl: 1.1828 | stu_lens: 53.5000 | mixed_lens: 106.0000 | lr: 3.1450e-06 | scale: 1024.00 | time: 26.623 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2149/  5000| tot_loss: 2.2031 | rl_loss: 0.7900 | pt_loss: 1.4131 | pg_loss: 0.3380 | reg_loss: 0.4520 | reward: -0.3285 | rev_kl: 0.9910 | stu_lens: 103.5000 | mixed_lens: 84.5000 | lr: 3.1434e-06 | scale: 1024.00 | time: 26.655 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2150/  5000| tot_loss: 2.9577 | rl_loss: 1.1695 | pt_loss: 1.7881 | pg_loss: 0.3860 | reg_loss: 0.7835 | reward: -0.6856 | rev_kl: 1.1061 | stu_lens: 92.0000 | mixed_lens: 77.0000 | lr: 3.1419e-06 | scale: 1024.00 | time: 26.629 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2151/  5000| tot_loss: 3.0515 | rl_loss: 1.4092 | pt_loss: 1.6423 | pg_loss: 0.7756 | reg_loss: 0.6336 | reward: -0.5603 | rev_kl: 0.9005 | stu_lens: 128.0000 | mixed_lens: 61.0000 | lr: 3.1403e-06 | scale: 1024.00 | time: 26.671 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2152/  5000| tot_loss: 1.8746 | rl_loss: 0.7146 | pt_loss: 1.1601 | pg_loss: 0.2174 | reg_loss: 0.4972 | reward: -0.0120 | rev_kl: 1.4602 | stu_lens: 113.0000 | mixed_lens: 83.5000 | lr: 3.1388e-06 | scale: 1024.00 | time: 26.650 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2153/  5000| tot_loss: 2.4241 | rl_loss: 0.8423 | pt_loss: 1.5818 | pg_loss: 0.3633 | reg_loss: 0.4791 | reward: -0.2883 | rev_kl: 1.1187 | stu_lens: 55.0000 | mixed_lens: 86.0000 | lr: 3.1372e-06 | scale: 1024.00 | time: 26.692 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2154/  5000| tot_loss: 2.7758 | rl_loss: 0.7635 | pt_loss: 2.0123 | pg_loss: 0.1161 | reg_loss: 0.6475 | reward: -0.1717 | rev_kl: 1.3422 | stu_lens: 128.0000 | mixed_lens: 111.5000 | lr: 3.1357e-06 | scale: 1024.00 | time: 26.667 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2155/  5000| tot_loss: 2.4986 | rl_loss: 0.3968 | pt_loss: 2.1018 | pg_loss: 0.0905 | reg_loss: 0.3063 | reward: -0.1585 | rev_kl: 0.6475 | stu_lens: 65.0000 | mixed_lens: 58.5000 | lr: 3.1341e-06 | scale: 1024.00 | time: 26.670 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2156/  5000| tot_loss: 1.9628 | rl_loss: 0.3948 | pt_loss: 1.5680 | pg_loss: 0.0041 | reg_loss: 0.3907 | reward: -0.2032 | rev_kl: 0.8189 | stu_lens: 104.0000 | mixed_lens: 128.0000 | lr: 3.1326e-06 | scale: 1024.00 | time: 26.668 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2157/  5000| tot_loss: 2.2967 | rl_loss: 0.6945 | pt_loss: 1.6022 | pg_loss: 0.0232 | reg_loss: 0.6712 | reward: -0.1317 | rev_kl: 1.2996 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.1310e-06 | scale: 1024.00 | time: 26.655 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2158/  5000| tot_loss: 3.0115 | rl_loss: 1.0625 | pt_loss: 1.9490 | pg_loss: 0.2370 | reg_loss: 0.8254 | reward: -0.8483 | rev_kl: 2.0108 | stu_lens: 69.5000 | mixed_lens: 90.5000 | lr: 3.1295e-06 | scale: 1024.00 | time: 26.640 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2159/  5000| tot_loss: 2.2671 | rl_loss: 0.2871 | pt_loss: 1.9800 | pg_loss: 0.0719 | reg_loss: 0.2152 | reward: -0.3559 | rev_kl: 1.5329 | stu_lens: 102.5000 | mixed_lens: 97.5000 | lr: 3.1279e-06 | scale: 1024.00 | time: 26.606 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2160/  5000| tot_loss: 2.4313 | rl_loss: 0.5358 | pt_loss: 1.8956 | pg_loss: 0.0146 | reg_loss: 0.5211 | reward: -0.4908 | rev_kl: 0.4346 | stu_lens: 47.5000 | mixed_lens: 60.5000 | lr: 3.1264e-06 | scale: 1024.00 | time: 26.643 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2160/  5000| tot_loss: 2.5408 | rl_loss: 0.7889 | pt_loss: 1.7519 | pg_loss: 0.2607 | reg_loss: 0.5282 | reward: -0.3729 | rev_kl: 1.0692 | stu_lens: 94.2188 | mixed_lens: 91.9375 | lr: 3.1264e-06 | scale: 1024.00 | time: 26.643 | step time: 27.885
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2161/  5000| tot_loss: 2.4103 | rl_loss: 0.7790 | pt_loss: 1.6313 | pg_loss: 0.1797 | reg_loss: 0.5993 | reward: 0.3522 | rev_kl: 1.2235 | stu_lens: 67.5000 | mixed_lens: 71.0000 | lr: 3.1248e-06 | scale: 1024.00 | time: 26.662 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2162/  5000| tot_loss: 2.5467 | rl_loss: 0.7877 | pt_loss: 1.7589 | pg_loss: 0.3263 | reg_loss: 0.4614 | reward: -0.4489 | rev_kl: 1.4494 | stu_lens: 128.0000 | mixed_lens: 95.5000 | lr: 3.1233e-06 | scale: 1024.00 | time: 26.651 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2163/  5000| tot_loss: 2.5684 | rl_loss: 0.4273 | pt_loss: 2.1410 | pg_loss: 0.0137 | reg_loss: 0.4137 | reward: -0.0239 | rev_kl: 0.9842 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.1217e-06 | scale: 1024.00 | time: 26.844 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2164/  5000| tot_loss: 3.0370 | rl_loss: 1.2792 | pt_loss: 1.7578 | pg_loss: 0.6225 | reg_loss: 0.6568 | reward: 0.1687 | rev_kl: 1.4628 | stu_lens: 78.5000 | mixed_lens: 71.0000 | lr: 3.1202e-06 | scale: 1024.00 | time: 26.670 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2165/  5000| tot_loss: 1.7209 | rl_loss: 0.4630 | pt_loss: 1.2579 | pg_loss: 0.1362 | reg_loss: 0.3268 | reward: -0.5879 | rev_kl: 1.8698 | stu_lens: 59.0000 | mixed_lens: 96.5000 | lr: 3.1186e-06 | scale: 1024.00 | time: 26.696 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2166/  5000| tot_loss: 1.9444 | rl_loss: 0.4082 | pt_loss: 1.5363 | pg_loss: 0.0605 | reg_loss: 0.3476 | reward: -0.1159 | rev_kl: 1.0038 | stu_lens: 115.0000 | mixed_lens: 121.5000 | lr: 3.1171e-06 | scale: 1024.00 | time: 26.663 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2167/  5000| tot_loss: 2.6870 | rl_loss: 0.4372 | pt_loss: 2.2498 | pg_loss: 0.1811 | reg_loss: 0.2561 | reward: -0.2427 | rev_kl: 0.7413 | stu_lens: 128.0000 | mixed_lens: 102.5000 | lr: 3.1155e-06 | scale: 1024.00 | time: 26.692 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2168/  5000| tot_loss: 2.2303 | rl_loss: 0.6461 | pt_loss: 1.5842 | pg_loss: 0.1528 | reg_loss: 0.4933 | reward: -0.3179 | rev_kl: 0.9735 | stu_lens: 94.0000 | mixed_lens: 105.0000 | lr: 3.1140e-06 | scale: 1024.00 | time: 26.692 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2169/  5000| tot_loss: 2.2956 | rl_loss: 0.7377 | pt_loss: 1.5579 | pg_loss: 0.1595 | reg_loss: 0.5782 | reward: -0.7471 | rev_kl: 1.7869 | stu_lens: 69.5000 | mixed_lens: 90.5000 | lr: 3.1124e-06 | scale: 1024.00 | time: 26.710 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2170/  5000| tot_loss: 2.1632 | rl_loss: 0.4997 | pt_loss: 1.6635 | pg_loss: 0.0087 | reg_loss: 0.4910 | reward: -0.1394 | rev_kl: 1.5439 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.1109e-06 | scale: 1024.00 | time: 26.683 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2171/  5000| tot_loss: 2.0582 | rl_loss: 0.4104 | pt_loss: 1.6479 | pg_loss: 0.0322 | reg_loss: 0.3781 | reward: -0.2725 | rev_kl: 1.0038 | stu_lens: 93.0000 | mixed_lens: 122.0000 | lr: 3.1093e-06 | scale: 1024.00 | time: 26.697 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2172/  5000| tot_loss: 1.5701 | rl_loss: 0.5124 | pt_loss: 1.0577 | pg_loss: 0.0708 | reg_loss: 0.4416 | reward: -0.1598 | rev_kl: 0.7817 | stu_lens: 98.5000 | mixed_lens: 106.5000 | lr: 3.1077e-06 | scale: 1024.00 | time: 26.678 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2173/  5000| tot_loss: 2.1371 | rl_loss: 0.6137 | pt_loss: 1.5234 | pg_loss: 0.1013 | reg_loss: 0.5124 | reward: -0.2457 | rev_kl: 1.1417 | stu_lens: 128.0000 | mixed_lens: 110.0000 | lr: 3.1062e-06 | scale: 1024.00 | time: 26.692 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2174/  5000| tot_loss: 2.4615 | rl_loss: 0.5654 | pt_loss: 1.8961 | pg_loss: 0.0030 | reg_loss: 0.5624 | reward: -0.4094 | rev_kl: 1.2309 | stu_lens: 122.5000 | mixed_lens: 128.0000 | lr: 3.1046e-06 | scale: 1024.00 | time: 26.664 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2175/  5000| tot_loss: 2.0095 | rl_loss: 0.5419 | pt_loss: 1.4677 | pg_loss: 0.1572 | reg_loss: 0.3847 | reward: -0.1497 | rev_kl: 1.1523 | stu_lens: 104.0000 | mixed_lens: 102.0000 | lr: 3.1031e-06 | scale: 1024.00 | time: 26.684 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2176/  5000| tot_loss: 2.2627 | rl_loss: 0.6316 | pt_loss: 1.6312 | pg_loss: 0.3075 | reg_loss: 0.3240 | reward: -0.1709 | rev_kl: 1.2630 | stu_lens: 128.0000 | mixed_lens: 75.0000 | lr: 3.1015e-06 | scale: 1024.00 | time: 26.632 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2176/  5000| tot_loss: 2.3938 | rl_loss: 0.6904 | pt_loss: 1.7035 | pg_loss: 0.2491 | reg_loss: 0.4412 | reward: -0.3211 | rev_kl: 1.0903 | stu_lens: 94.6250 | mixed_lens: 94.2500 | lr: 3.1015e-06 | scale: 1024.00 | time: 26.632 | step time: 27.921
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2177/  5000| tot_loss: 2.1243 | rl_loss: 0.5552 | pt_loss: 1.5691 | pg_loss: 0.3265 | reg_loss: 0.2287 | reward: -0.2608 | rev_kl: 0.7628 | stu_lens: 76.5000 | mixed_lens: 86.0000 | lr: 3.1000e-06 | scale: 1024.00 | time: 26.674 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2178/  5000| tot_loss: 3.2120 | rl_loss: 1.3391 | pt_loss: 1.8729 | pg_loss: 0.1155 | reg_loss: 1.2235 | reward: -0.2452 | rev_kl: 1.0462 | stu_lens: 116.0000 | mixed_lens: 117.0000 | lr: 3.0984e-06 | scale: 1024.00 | time: 26.725 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2179/  5000| tot_loss: 3.9048 | rl_loss: 2.1775 | pt_loss: 1.7273 | pg_loss: 0.9289 | reg_loss: 1.2487 | reward: -0.5322 | rev_kl: 0.9280 | stu_lens: 65.0000 | mixed_lens: 46.0000 | lr: 3.0969e-06 | scale: 1024.00 | time: 26.708 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2180/  5000| tot_loss: 3.0743 | rl_loss: 1.4113 | pt_loss: 1.6630 | pg_loss: 0.2975 | reg_loss: 1.1139 | reward: -0.4049 | rev_kl: 0.8003 | stu_lens: 110.0000 | mixed_lens: 88.0000 | lr: 3.0953e-06 | scale: 1024.00 | time: 26.694 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2181/  5000| tot_loss: 3.5680 | rl_loss: 1.8543 | pt_loss: 1.7136 | pg_loss: 0.7248 | reg_loss: 1.1296 | reward: -0.5209 | rev_kl: 1.4575 | stu_lens: 52.0000 | mixed_lens: 56.0000 | lr: 3.0937e-06 | scale: 1024.00 | time: 26.649 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2182/  5000| tot_loss: 3.4469 | rl_loss: 1.8170 | pt_loss: 1.6299 | pg_loss: 0.7654 | reg_loss: 1.0516 | reward: -0.7319 | rev_kl: 0.5858 | stu_lens: 90.0000 | mixed_lens: 42.5000 | lr: 3.0922e-06 | scale: 1024.00 | time: 26.664 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2183/  5000| tot_loss: 3.0614 | rl_loss: 0.9937 | pt_loss: 2.0677 | pg_loss: 0.0467 | reg_loss: 0.9470 | reward: -0.0910 | rev_kl: 0.8115 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.0906e-06 | scale: 1024.00 | time: 26.679 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2184/  5000| tot_loss: 2.8327 | rl_loss: 1.3360 | pt_loss: 1.4967 | pg_loss: 0.0333 | reg_loss: 1.3027 | reward: -0.2534 | rev_kl: 1.5935 | stu_lens: 122.5000 | mixed_lens: 128.0000 | lr: 3.0891e-06 | scale: 1024.00 | time: 26.749 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2185/  5000| tot_loss: 3.8098 | rl_loss: 2.1702 | pt_loss: 1.6396 | pg_loss: 0.6097 | reg_loss: 1.5605 | reward: -0.3203 | rev_kl: 1.5205 | stu_lens: 79.0000 | mixed_lens: 65.5000 | lr: 3.0875e-06 | scale: 1024.00 | time: 26.669 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2186/  5000| tot_loss: 3.2700 | rl_loss: 2.1077 | pt_loss: 1.1623 | pg_loss: 1.0970 | reg_loss: 1.0107 | reward: -0.6086 | rev_kl: 1.1339 | stu_lens: 22.5000 | mixed_lens: 35.5000 | lr: 3.0860e-06 | scale: 1024.00 | time: 26.681 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2187/  5000| tot_loss: 2.9145 | rl_loss: 1.7010 | pt_loss: 1.2135 | pg_loss: 0.4018 | reg_loss: 1.2992 | reward: -0.5477 | rev_kl: 0.8748 | stu_lens: 94.5000 | mixed_lens: 85.5000 | lr: 3.0844e-06 | scale: 1024.00 | time: 26.793 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2188/  5000| tot_loss: 3.4497 | rl_loss: 1.7384 | pt_loss: 1.7113 | pg_loss: 0.4936 | reg_loss: 1.2448 | reward: -0.2396 | rev_kl: 1.3243 | stu_lens: 78.0000 | mixed_lens: 66.5000 | lr: 3.0828e-06 | scale: 1024.00 | time: 26.673 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2189/  5000| tot_loss: 2.0903 | rl_loss: 0.6343 | pt_loss: 1.4560 | pg_loss: 0.0476 | reg_loss: 0.5867 | reward: -0.1518 | rev_kl: 0.5086 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.0813e-06 | scale: 1024.00 | time: 26.723 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2190/  5000| tot_loss: 3.1668 | rl_loss: 1.1152 | pt_loss: 2.0516 | pg_loss: 0.2885 | reg_loss: 0.8267 | reward: -0.3998 | rev_kl: 0.6105 | stu_lens: 82.0000 | mixed_lens: 34.5000 | lr: 3.0797e-06 | scale: 1024.00 | time: 26.700 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2191/  5000| tot_loss: 4.4865 | rl_loss: 2.8272 | pt_loss: 1.6594 | pg_loss: 1.7065 | reg_loss: 1.1207 | reward: -0.4434 | rev_kl: 0.1353 | stu_lens: 11.0000 | mixed_lens: 23.0000 | lr: 3.0782e-06 | scale: 1024.00 | time: 26.878 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2192/  5000| tot_loss: 3.6198 | rl_loss: 1.6934 | pt_loss: 1.9264 | pg_loss: 0.3210 | reg_loss: 1.3723 | reward: -0.3310 | rev_kl: 1.7753 | stu_lens: 128.0000 | mixed_lens: 97.0000 | lr: 3.0766e-06 | scale: 1024.00 | time: 26.666 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2192/  5000| tot_loss: 3.1941 | rl_loss: 1.5244 | pt_loss: 1.6696 | pg_loss: 0.4304 | reg_loss: 1.0941 | reward: -0.5213 | rev_kl: 1.0672 | stu_lens: 90.2344 | mixed_lens: 81.1094 | lr: 3.0766e-06 | scale: 1024.00 | time: 26.666 | step time: 27.936
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2193/  5000| tot_loss: 3.5352 | rl_loss: 1.9685 | pt_loss: 1.5667 | pg_loss: 0.4818 | reg_loss: 1.4866 | reward: -4.5739 | rev_kl: 0.7301 | stu_lens: 73.0000 | mixed_lens: 65.0000 | lr: 3.0750e-06 | scale: 1024.00 | time: 26.708 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2194/  5000| tot_loss: 2.7845 | rl_loss: 0.8981 | pt_loss: 1.8864 | pg_loss: -0.0107 | reg_loss: 0.9088 | reward: -0.3577 | rev_kl: 1.7402 | stu_lens: 103.5000 | mixed_lens: 128.0000 | lr: 3.0735e-06 | scale: 1024.00 | time: 26.678 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2195/  5000| tot_loss: 3.0364 | rl_loss: 1.2088 | pt_loss: 1.8276 | pg_loss: 0.3413 | reg_loss: 0.8675 | reward: -0.6056 | rev_kl: 0.7378 | stu_lens: 80.0000 | mixed_lens: 75.0000 | lr: 3.0719e-06 | scale: 1024.00 | time: 26.757 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2196/  5000| tot_loss: 3.1137 | rl_loss: 1.2544 | pt_loss: 1.8593 | pg_loss: 0.3533 | reg_loss: 0.9011 | reward: -4.5223 | rev_kl: 0.5165 | stu_lens: 73.0000 | mixed_lens: 65.0000 | lr: 3.0704e-06 | scale: 1024.00 | time: 26.645 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2197/  5000| tot_loss: 3.2014 | rl_loss: 1.4993 | pt_loss: 1.7021 | pg_loss: 0.8418 | reg_loss: 0.6575 | reward: -5.0770 | rev_kl: 0.8639 | stu_lens: 120.5000 | mixed_lens: 26.5000 | lr: 3.0688e-06 | scale: 1024.00 | time: 26.709 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2198/  5000| tot_loss: 2.3916 | rl_loss: 1.2140 | pt_loss: 1.1776 | pg_loss: 0.5134 | reg_loss: 0.7006 | reward: -0.5116 | rev_kl: 1.2958 | stu_lens: 53.0000 | mixed_lens: 71.5000 | lr: 3.0672e-06 | scale: 1024.00 | time: 26.748 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2199/  5000| tot_loss: 3.4028 | rl_loss: 1.8090 | pt_loss: 1.5937 | pg_loss: 0.7535 | reg_loss: 1.0556 | reward: -0.5550 | rev_kl: 1.3647 | stu_lens: 65.0000 | mixed_lens: 52.0000 | lr: 3.0657e-06 | scale: 1024.00 | time: 26.620 | step time: 0.000
                                 Evaluation #22                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Yes, Bob should leave Alice, because │
│                                       │ his chances of survival improve by   │
│                                       │ 9%.                                  │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ It is a lexical convention used in   │
│                                       │ programming to denote a variable as  │
│                                       │ a key in a map. It is commonly used  │
│                                       │ in Python, and other languages use   │
│                                       │ similar conventions.                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support 100+ languages.           │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.633 | exact_match: 0.323 | rev_kl: 1.135 | lens: 84.156 | pt_loss: 1.076 | lm_loss: 1.156 | kd_loss: 0.995 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2200/  5000| tot_loss: 3.0931 | rl_loss: 1.3500 | pt_loss: 1.7431 | pg_loss: 0.6541 | reg_loss: 0.6959 | reward: -0.5019 | rev_kl: 0.8795 | stu_lens: 79.0000 | mixed_lens: 61.5000 | lr: 3.0641e-06 | scale: 1024.00 | time: 26.649 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2201/  5000| tot_loss: 1.7634 | rl_loss: 0.2289 | pt_loss: 1.5345 | pg_loss: -0.0106 | reg_loss: 0.2394 | reward: -0.1351 | rev_kl: 0.5435 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.0626e-06 | scale: 1024.00 | time: 26.773 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2202/  5000| tot_loss: 2.9718 | rl_loss: 1.0575 | pt_loss: 1.9143 | pg_loss: -0.0040 | reg_loss: 1.0615 | reward: -0.2910 | rev_kl: 1.2392 | stu_lens: 124.5000 | mixed_lens: 128.0000 | lr: 3.0610e-06 | scale: 1024.00 | time: 26.738 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2203/  5000| tot_loss: 2.4291 | rl_loss: 0.7782 | pt_loss: 1.6509 | pg_loss: 0.0130 | reg_loss: 0.7652 | reward: -0.3981 | rev_kl: 0.5820 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.0594e-06 | scale: 1024.00 | time: 26.697 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2204/  5000| tot_loss: 3.5018 | rl_loss: 1.4772 | pt_loss: 2.0246 | pg_loss: 0.8132 | reg_loss: 0.6640 | reward: -0.7152 | rev_kl: 0.8381 | stu_lens: 76.5000 | mixed_lens: 45.5000 | lr: 3.0579e-06 | scale: 1024.00 | time: 26.691 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2205/  5000| tot_loss: 3.0558 | rl_loss: 1.5875 | pt_loss: 1.4683 | pg_loss: 1.1110 | reg_loss: 0.4765 | reward: -0.1936 | rev_kl: 1.3415 | stu_lens: 67.0000 | mixed_lens: 36.0000 | lr: 3.0563e-06 | scale: 1024.00 | time: 26.686 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2206/  5000| tot_loss: 2.5666 | rl_loss: 0.8077 | pt_loss: 1.7589 | pg_loss: 0.1639 | reg_loss: 0.6438 | reward: -0.4566 | rev_kl: 0.9577 | stu_lens: 90.0000 | mixed_lens: 89.5000 | lr: 3.0547e-06 | scale: 1024.00 | time: 26.632 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2207/  5000| tot_loss: 2.5512 | rl_loss: 0.7087 | pt_loss: 1.8425 | pg_loss: 0.2283 | reg_loss: 0.4804 | reward: -0.1749 | rev_kl: 0.5257 | stu_lens: 21.5000 | mixed_lens: 32.0000 | lr: 3.0532e-06 | scale: 1024.00 | time: 26.665 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2208/  5000| tot_loss: 2.9482 | rl_loss: 1.0023 | pt_loss: 1.9458 | pg_loss: 0.2057 | reg_loss: 0.7966 | reward: -0.4809 | rev_kl: 0.7273 | stu_lens: 84.5000 | mixed_lens: 105.0000 | lr: 3.0516e-06 | scale: 1024.00 | time: 26.652 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2208/  5000| tot_loss: 2.8386 | rl_loss: 1.1409 | pt_loss: 1.6977 | pg_loss: 0.3560 | reg_loss: 0.7850 | reward: -0.7801 | rev_kl: 0.9805 | stu_lens: 91.2031 | mixed_lens: 82.0156 | lr: 3.0516e-06 | scale: 1024.00 | time: 26.652 | step time: 27.914
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2209/  5000| tot_loss: 2.8262 | rl_loss: 1.2308 | pt_loss: 1.5954 | pg_loss: 0.6150 | reg_loss: 0.6158 | reward: -0.5022 | rev_kl: 2.7288 | stu_lens: 61.0000 | mixed_lens: 46.5000 | lr: 3.0500e-06 | scale: 1024.00 | time: 26.685 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2210/  5000| tot_loss: 3.0538 | rl_loss: 1.0930 | pt_loss: 1.9608 | pg_loss: 0.6158 | reg_loss: 0.4772 | reward: -0.6586 | rev_kl: 0.7953 | stu_lens: 99.0000 | mixed_lens: 52.5000 | lr: 3.0485e-06 | scale: 1024.00 | time: 26.663 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2211/  5000| tot_loss: 3.1813 | rl_loss: 1.4203 | pt_loss: 1.7610 | pg_loss: 0.9087 | reg_loss: 0.5116 | reward: -4.8433 | rev_kl: 0.3308 | stu_lens: 55.0000 | mixed_lens: 25.0000 | lr: 3.0469e-06 | scale: 1024.00 | time: 26.683 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2212/  5000| tot_loss: 2.6190 | rl_loss: 1.0499 | pt_loss: 1.5691 | pg_loss: 0.3430 | reg_loss: 0.7070 | reward: -0.5658 | rev_kl: 1.4974 | stu_lens: 91.5000 | mixed_lens: 87.0000 | lr: 3.0454e-06 | scale: 1024.00 | time: 26.690 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2213/  5000| tot_loss: 3.6404 | rl_loss: 1.8268 | pt_loss: 1.8136 | pg_loss: 1.2297 | reg_loss: 0.5971 | reward: -0.6700 | rev_kl: 1.1364 | stu_lens: 50.5000 | mixed_lens: 35.0000 | lr: 3.0438e-06 | scale: 1024.00 | time: 26.702 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2214/  5000| tot_loss: 2.5029 | rl_loss: 0.6285 | pt_loss: 1.8744 | pg_loss: 0.0001 | reg_loss: 0.6284 | reward: -0.3577 | rev_kl: 1.7402 | stu_lens: 103.5000 | mixed_lens: 128.0000 | lr: 3.0422e-06 | scale: 1024.00 | time: 26.682 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2215/  5000| tot_loss: 1.9589 | rl_loss: 0.5739 | pt_loss: 1.3850 | pg_loss: 0.0980 | reg_loss: 0.4758 | reward: -0.3055 | rev_kl: 1.6101 | stu_lens: 75.0000 | mixed_lens: 107.0000 | lr: 3.0407e-06 | scale: 1024.00 | time: 26.752 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2216/  5000| tot_loss: 2.5708 | rl_loss: 1.3607 | pt_loss: 1.2101 | pg_loss: 0.6712 | reg_loss: 0.6895 | reward: -0.6292 | rev_kl: 1.4218 | stu_lens: 83.5000 | mixed_lens: 62.5000 | lr: 3.0391e-06 | scale: 1024.00 | time: 26.685 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2217/  5000| tot_loss: 2.0986 | rl_loss: 0.9760 | pt_loss: 1.1226 | pg_loss: 0.2441 | reg_loss: 0.7319 | reward: -0.1881 | rev_kl: 0.8550 | stu_lens: 128.0000 | mixed_lens: 86.0000 | lr: 3.0375e-06 | scale: 1024.00 | time: 26.697 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2218/  5000| tot_loss: 2.2127 | rl_loss: 0.5929 | pt_loss: 1.6197 | pg_loss: 0.2417 | reg_loss: 0.3512 | reward: -0.2128 | rev_kl: 0.9724 | stu_lens: 109.5000 | mixed_lens: 88.5000 | lr: 3.0360e-06 | scale: 1024.00 | time: 26.697 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2219/  5000| tot_loss: 2.3299 | rl_loss: 0.9163 | pt_loss: 1.4136 | pg_loss: 0.3569 | reg_loss: 0.5593 | reward: -0.2649 | rev_kl: 0.6418 | stu_lens: 105.0000 | mixed_lens: 82.5000 | lr: 3.0344e-06 | scale: 1024.00 | time: 26.802 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2220/  5000| tot_loss: 2.5431 | rl_loss: 1.0906 | pt_loss: 1.4525 | pg_loss: 0.3431 | reg_loss: 0.7475 | reward: -0.5801 | rev_kl: 0.8078 | stu_lens: 56.5000 | mixed_lens: 92.0000 | lr: 3.0328e-06 | scale: 1024.00 | time: 26.676 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2221/  5000| tot_loss: 2.5825 | rl_loss: 0.6912 | pt_loss: 1.8914 | pg_loss: 0.1586 | reg_loss: 0.5325 | reward: -0.2994 | rev_kl: 1.1303 | stu_lens: 78.0000 | mixed_lens: 108.5000 | lr: 3.0313e-06 | scale: 1024.00 | time: 26.704 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2222/  5000| tot_loss: 2.3800 | rl_loss: 0.6326 | pt_loss: 1.7474 | pg_loss: 0.0181 | reg_loss: 0.6144 | reward: -0.1320 | rev_kl: 1.1425 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.0297e-06 | scale: 1024.00 | time: 26.685 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2223/  5000| tot_loss: 2.3863 | rl_loss: 0.6235 | pt_loss: 1.7628 | pg_loss: 0.0161 | reg_loss: 0.6073 | reward: -0.3792 | rev_kl: 1.1360 | stu_lens: 124.5000 | mixed_lens: 128.0000 | lr: 3.0281e-06 | scale: 1024.00 | time: 26.720 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2224/  5000| tot_loss: 2.0859 | rl_loss: 1.4130 | pt_loss: 0.6729 | pg_loss: 0.3028 | reg_loss: 1.1102 | reward: -0.2493 | rev_kl: 1.0912 | stu_lens: 72.5000 | mixed_lens: 63.5000 | lr: 3.0266e-06 | scale: 1024.00 | time: 26.695 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2224/  5000| tot_loss: 2.4979 | rl_loss: 0.8741 | pt_loss: 1.6238 | pg_loss: 0.3583 | reg_loss: 0.5158 | reward: -0.6610 | rev_kl: 1.0791 | stu_lens: 90.7188 | mixed_lens: 79.8125 | lr: 3.0266e-06 | scale: 1024.00 | time: 26.695 | step time: 27.915
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2225/  5000| tot_loss: 2.5507 | rl_loss: 0.5153 | pt_loss: 2.0354 | pg_loss: 0.0845 | reg_loss: 0.4308 | reward: -0.1822 | rev_kl: 2.5712 | stu_lens: 76.0000 | mixed_lens: 88.0000 | lr: 3.0250e-06 | scale: 1024.00 | time: 26.658 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2226/  5000| tot_loss: 2.2201 | rl_loss: 0.5449 | pt_loss: 1.6752 | pg_loss: 0.0773 | reg_loss: 0.4676 | reward: -0.3010 | rev_kl: 1.0774 | stu_lens: 103.5000 | mixed_lens: 115.5000 | lr: 3.0234e-06 | scale: 1024.00 | time: 26.706 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2227/  5000| tot_loss: 2.5495 | rl_loss: 0.6958 | pt_loss: 1.8537 | pg_loss: 0.3187 | reg_loss: 0.3770 | reward: -0.3777 | rev_kl: 1.3226 | stu_lens: 117.0000 | mixed_lens: 64.5000 | lr: 3.0219e-06 | scale: 1024.00 | time: 26.761 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2228/  5000| tot_loss: 2.3145 | rl_loss: 0.7749 | pt_loss: 1.5396 | pg_loss: 0.3741 | reg_loss: 0.4009 | reward: -0.0723 | rev_kl: 0.4717 | stu_lens: 67.0000 | mixed_lens: 67.0000 | lr: 3.0203e-06 | scale: 1024.00 | time: 26.743 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2229/  5000| tot_loss: 2.0344 | rl_loss: 0.7312 | pt_loss: 1.3031 | pg_loss: 0.2912 | reg_loss: 0.4401 | reward: -4.6758 | rev_kl: 0.3675 | stu_lens: 73.0000 | mixed_lens: 65.0000 | lr: 3.0187e-06 | scale: 1024.00 | time: 26.697 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2230/  5000| tot_loss: 2.5889 | rl_loss: 0.4012 | pt_loss: 2.1877 | pg_loss: 0.1641 | reg_loss: 0.2371 | reward: -0.4682 | rev_kl: 0.7142 | stu_lens: 128.0000 | mixed_lens: 81.0000 | lr: 3.0172e-06 | scale: 1024.00 | time: 26.695 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2231/  5000| tot_loss: 2.4961 | rl_loss: 0.9683 | pt_loss: 1.5278 | pg_loss: 0.3713 | reg_loss: 0.5970 | reward: -0.5796 | rev_kl: 1.2380 | stu_lens: 91.5000 | mixed_lens: 87.0000 | lr: 3.0156e-06 | scale: 1024.00 | time: 26.796 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2232/  5000| tot_loss: 2.2755 | rl_loss: 0.9603 | pt_loss: 1.3152 | pg_loss: 0.5161 | reg_loss: 0.4442 | reward: -0.4457 | rev_kl: 1.2374 | stu_lens: 94.5000 | mixed_lens: 85.5000 | lr: 3.0140e-06 | scale: 1024.00 | time: 26.706 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2233/  5000| tot_loss: 3.0797 | rl_loss: 1.2553 | pt_loss: 1.8244 | pg_loss: 0.7233 | reg_loss: 0.5320 | reward: -0.4151 | rev_kl: 1.5571 | stu_lens: 21.0000 | mixed_lens: 59.5000 | lr: 3.0125e-06 | scale: 1024.00 | time: 26.736 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2234/  5000| tot_loss: 2.5058 | rl_loss: 0.9136 | pt_loss: 1.5922 | pg_loss: 0.2452 | reg_loss: 0.6684 | reward: -0.3574 | rev_kl: 3.3435 | stu_lens: 53.5000 | mixed_lens: 88.0000 | lr: 3.0109e-06 | scale: 1024.00 | time: 26.823 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2235/  5000| tot_loss: 2.2089 | rl_loss: 0.5260 | pt_loss: 1.6829 | pg_loss: 0.0889 | reg_loss: 0.4371 | reward: -0.3054 | rev_kl: 1.6180 | stu_lens: 75.0000 | mixed_lens: 107.0000 | lr: 3.0093e-06 | scale: 1024.00 | time: 26.654 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2236/  5000| tot_loss: 2.7936 | rl_loss: 0.8550 | pt_loss: 1.9386 | pg_loss: 0.3900 | reg_loss: 0.4650 | reward: -0.5064 | rev_kl: 1.2627 | stu_lens: 128.0000 | mixed_lens: 76.0000 | lr: 3.0078e-06 | scale: 1024.00 | time: 26.714 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2237/  5000| tot_loss: 2.5801 | rl_loss: 0.7415 | pt_loss: 1.8386 | pg_loss: 0.2704 | reg_loss: 0.4711 | reward: -0.2661 | rev_kl: 1.2508 | stu_lens: 124.5000 | mixed_lens: 86.0000 | lr: 3.0062e-06 | scale: 1024.00 | time: 26.651 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2238/  5000| tot_loss: 2.4785 | rl_loss: 0.9217 | pt_loss: 1.5569 | pg_loss: 0.3701 | reg_loss: 0.5515 | reward: -0.2641 | rev_kl: 0.9596 | stu_lens: 91.0000 | mixed_lens: 49.0000 | lr: 3.0046e-06 | scale: 1024.00 | time: 26.716 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2239/  5000| tot_loss: 2.6157 | rl_loss: 0.6545 | pt_loss: 1.9611 | pg_loss: 0.5306 | reg_loss: 0.1240 | reward: -0.4694 | rev_kl: 0.7042 | stu_lens: 105.5000 | mixed_lens: 46.0000 | lr: 3.0030e-06 | scale: 1024.00 | time: 26.689 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2240/  5000| tot_loss: 2.4342 | rl_loss: 0.8062 | pt_loss: 1.6280 | pg_loss: 0.2366 | reg_loss: 0.5696 | reward: -5.0524 | rev_kl: 1.0494 | stu_lens: 128.0000 | mixed_lens: 67.0000 | lr: 3.0015e-06 | scale: 1024.00 | time: 26.678 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2240/  5000| tot_loss: 2.4859 | rl_loss: 0.7817 | pt_loss: 1.7042 | pg_loss: 0.3769 | reg_loss: 0.4048 | reward: -0.6636 | rev_kl: 1.0952 | stu_lens: 87.5938 | mixed_lens: 77.9219 | lr: 3.0015e-06 | scale: 1024.00 | time: 26.678 | step time: 27.927
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2241/  5000| tot_loss: 2.0034 | rl_loss: 0.4120 | pt_loss: 1.5914 | pg_loss: 0.0569 | reg_loss: 0.3551 | reward: -0.2261 | rev_kl: 0.8653 | stu_lens: 95.0000 | mixed_lens: 120.0000 | lr: 2.9999e-06 | scale: 1024.00 | time: 26.755 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2242/  5000| tot_loss: 3.5559 | rl_loss: 1.8579 | pt_loss: 1.6980 | pg_loss: 0.3321 | reg_loss: 1.5259 | reward: -0.5396 | rev_kl: 0.6844 | stu_lens: 35.5000 | mixed_lens: 61.0000 | lr: 2.9983e-06 | scale: 1024.00 | time: 26.648 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2243/  5000| tot_loss: 2.7028 | rl_loss: 1.0231 | pt_loss: 1.6796 | pg_loss: 0.3302 | reg_loss: 0.6929 | reward: -0.8329 | rev_kl: 0.7432 | stu_lens: 92.0000 | mixed_lens: 76.5000 | lr: 2.9968e-06 | scale: 1024.00 | time: 26.597 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2244/  5000| tot_loss: 3.3110 | rl_loss: 1.4096 | pt_loss: 1.9014 | pg_loss: 0.0743 | reg_loss: 1.3353 | reward: -0.2335 | rev_kl: 1.0290 | stu_lens: 73.5000 | mixed_lens: 128.0000 | lr: 2.9952e-06 | scale: 1024.00 | time: 26.623 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2245/  5000| tot_loss: 3.5442 | rl_loss: 1.7653 | pt_loss: 1.7790 | pg_loss: 0.4514 | reg_loss: 1.3139 | reward: -0.2895 | rev_kl: 0.7189 | stu_lens: 117.0000 | mixed_lens: 79.0000 | lr: 2.9936e-06 | scale: 1024.00 | time: 26.597 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2246/  5000| tot_loss: 2.4577 | rl_loss: 1.3342 | pt_loss: 1.1235 | pg_loss: 0.0596 | reg_loss: 1.2746 | reward: -0.2210 | rev_kl: 1.1182 | stu_lens: 128.0000 | mixed_lens: 125.0000 | lr: 2.9920e-06 | scale: 1024.00 | time: 26.666 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2247/  5000| tot_loss: 3.0258 | rl_loss: 1.5016 | pt_loss: 1.5243 | pg_loss: 0.0870 | reg_loss: 1.4146 | reward: -0.1806 | rev_kl: 1.2772 | stu_lens: 102.5000 | mixed_lens: 122.5000 | lr: 2.9905e-06 | scale: 1024.00 | time: 26.607 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2248/  5000| tot_loss: 3.1558 | rl_loss: 1.6116 | pt_loss: 1.5442 | pg_loss: 0.0656 | reg_loss: 1.5459 | reward: -0.2144 | rev_kl: 1.3089 | stu_lens: 93.0000 | mixed_lens: 128.0000 | lr: 2.9889e-06 | scale: 1024.00 | time: 26.621 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2249/  5000| tot_loss: 2.9473 | rl_loss: 1.4477 | pt_loss: 1.4996 | pg_loss: 0.5076 | reg_loss: 0.9401 | reward: -0.5272 | rev_kl: 0.9034 | stu_lens: 128.0000 | mixed_lens: 82.0000 | lr: 2.9873e-06 | scale: 1024.00 | time: 26.602 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/2250
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2250/  5000| tot_loss: 3.3910 | rl_loss: 1.3858 | pt_loss: 2.0052 | pg_loss: 0.2824 | reg_loss: 1.1033 | reward: -0.3854 | rev_kl: 4.0790 | stu_lens: 124.5000 | mixed_lens: 90.0000 | lr: 2.9858e-06 | scale: 1024.00 | time: 26.650 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2251/  5000| tot_loss: 2.5816 | rl_loss: 0.9315 | pt_loss: 1.6501 | pg_loss: 0.2424 | reg_loss: 0.6891 | reward: -0.0737 | rev_kl: 0.9418 | stu_lens: 73.0000 | mixed_lens: 100.5000 | lr: 2.9842e-06 | scale: 1024.00 | time: 26.667 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2252/  5000| tot_loss: 3.8697 | rl_loss: 2.2153 | pt_loss: 1.6544 | pg_loss: 0.4714 | reg_loss: 1.7439 | reward: -1.0504 | rev_kl: 0.8387 | stu_lens: 56.0000 | mixed_lens: 70.5000 | lr: 2.9826e-06 | scale: 1024.00 | time: 26.766 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2253/  5000| tot_loss: 3.2100 | rl_loss: 1.2217 | pt_loss: 1.9882 | pg_loss: 0.0478 | reg_loss: 1.1739 | reward: -0.2991 | rev_kl: 0.9341 | stu_lens: 102.0000 | mixed_lens: 128.0000 | lr: 2.9810e-06 | scale: 1024.00 | time: 26.735 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2254/  5000| tot_loss: 3.4128 | rl_loss: 1.4613 | pt_loss: 1.9515 | pg_loss: 0.1638 | reg_loss: 1.2975 | reward: -0.1679 | rev_kl: 0.6505 | stu_lens: 90.5000 | mixed_lens: 109.5000 | lr: 2.9795e-06 | scale: 1024.00 | time: 26.657 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2255/  5000| tot_loss: 3.6017 | rl_loss: 1.8812 | pt_loss: 1.7205 | pg_loss: 0.8013 | reg_loss: 1.0799 | reward: -0.2742 | rev_kl: 0.6318 | stu_lens: 65.0000 | mixed_lens: 59.0000 | lr: 2.9779e-06 | scale: 1024.00 | time: 26.679 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2256/  5000| tot_loss: 2.0758 | rl_loss: 0.5963 | pt_loss: 1.4794 | pg_loss: 0.0724 | reg_loss: 0.5239 | reward: -0.0248 | rev_kl: 0.9744 | stu_lens: 128.0000 | mixed_lens: 123.0000 | lr: 2.9763e-06 | scale: 1024.00 | time: 26.683 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2256/  5000| tot_loss: 3.1789 | rl_loss: 1.4889 | pt_loss: 1.6900 | pg_loss: 0.3199 | reg_loss: 1.1690 | reward: -0.3802 | rev_kl: 1.0954 | stu_lens: 88.7500 | mixed_lens: 91.3906 | lr: 2.9763e-06 | scale: 1024.00 | time: 26.683 | step time: 27.873
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2257/  5000| tot_loss: 3.6581 | rl_loss: 1.9040 | pt_loss: 1.7542 | pg_loss: 0.3247 | reg_loss: 1.5793 | reward: -0.7507 | rev_kl: 1.3931 | stu_lens: 83.0000 | mixed_lens: 89.5000 | lr: 2.9747e-06 | scale: 1024.00 | time: 26.666 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2258/  5000| tot_loss: 3.1009 | rl_loss: 1.2717 | pt_loss: 1.8292 | pg_loss: 0.3876 | reg_loss: 0.8841 | reward: -0.2109 | rev_kl: 0.8371 | stu_lens: 50.0000 | mixed_lens: 96.0000 | lr: 2.9732e-06 | scale: 1024.00 | time: 26.690 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2259/  5000| tot_loss: 3.1439 | rl_loss: 1.7013 | pt_loss: 1.4426 | pg_loss: 0.7788 | reg_loss: 0.9225 | reward: -1.0962 | rev_kl: 4.0303 | stu_lens: 83.5000 | mixed_lens: 34.5000 | lr: 2.9716e-06 | scale: 1024.00 | time: 26.664 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2260/  5000| tot_loss: 3.5521 | rl_loss: 1.9072 | pt_loss: 1.6449 | pg_loss: 0.9299 | reg_loss: 0.9773 | reward: -0.8932 | rev_kl: 1.0399 | stu_lens: 76.0000 | mixed_lens: 49.0000 | lr: 2.9700e-06 | scale: 1024.00 | time: 26.688 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2261/  5000| tot_loss: 2.5755 | rl_loss: 0.5688 | pt_loss: 2.0067 | pg_loss: -0.0080 | reg_loss: 0.5768 | reward: -0.2001 | rev_kl: 1.2933 | stu_lens: 104.5000 | mixed_lens: 128.0000 | lr: 2.9685e-06 | scale: 1024.00 | time: 26.667 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2262/  5000| tot_loss: 2.8988 | rl_loss: 1.1099 | pt_loss: 1.7889 | pg_loss: 0.2021 | reg_loss: 0.9078 | reward: -0.1318 | rev_kl: 1.5289 | stu_lens: 128.0000 | mixed_lens: 104.0000 | lr: 2.9669e-06 | scale: 1024.00 | time: 26.688 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2263/  5000| tot_loss: 3.1258 | rl_loss: 1.7328 | pt_loss: 1.3929 | pg_loss: 0.8525 | reg_loss: 0.8803 | reward: -0.8628 | rev_kl: 1.1400 | stu_lens: 76.0000 | mixed_lens: 35.0000 | lr: 2.9653e-06 | scale: 1024.00 | time: 26.667 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2264/  5000| tot_loss: 2.9168 | rl_loss: 0.9979 | pt_loss: 1.9189 | pg_loss: 0.0766 | reg_loss: 0.9214 | reward: -0.0882 | rev_kl: 0.5250 | stu_lens: 128.0000 | mixed_lens: 111.5000 | lr: 2.9637e-06 | scale: 1024.00 | time: 26.725 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2265/  5000| tot_loss: 2.1873 | rl_loss: 0.8007 | pt_loss: 1.3866 | pg_loss: 0.1918 | reg_loss: 0.6089 | reward: -0.1977 | rev_kl: 0.9645 | stu_lens: 38.0000 | mixed_lens: 41.0000 | lr: 2.9622e-06 | scale: 1024.00 | time: 26.683 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2266/  5000| tot_loss: 5.0743 | rl_loss: 3.1870 | pt_loss: 1.8873 | pg_loss: 1.4257 | reg_loss: 1.7613 | reward: -1.2018 | rev_kl: 0.6149 | stu_lens: 16.5000 | mixed_lens: 13.5000 | lr: 2.9606e-06 | scale: 1024.00 | time: 26.704 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2267/  5000| tot_loss: 3.2623 | rl_loss: 1.3485 | pt_loss: 1.9138 | pg_loss: 0.4809 | reg_loss: 0.8677 | reward: -0.7186 | rev_kl: 0.8391 | stu_lens: 79.5000 | mixed_lens: 80.5000 | lr: 2.9590e-06 | scale: 1024.00 | time: 26.678 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2268/  5000| tot_loss: 3.2093 | rl_loss: 1.4985 | pt_loss: 1.7107 | pg_loss: 1.1340 | reg_loss: 0.3645 | reward: -0.4108 | rev_kl: 0.3945 | stu_lens: 86.0000 | mixed_lens: 42.5000 | lr: 2.9574e-06 | scale: 1024.00 | time: 26.687 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2269/  5000| tot_loss: 3.0775 | rl_loss: 1.1541 | pt_loss: 1.9234 | pg_loss: 0.2909 | reg_loss: 0.8632 | reward: -0.5856 | rev_kl: 0.8710 | stu_lens: 85.5000 | mixed_lens: 73.0000 | lr: 2.9559e-06 | scale: 1024.00 | time: 26.652 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2270/  5000| tot_loss: 2.1985 | rl_loss: 0.6267 | pt_loss: 1.5718 | pg_loss: 0.0440 | reg_loss: 0.5828 | reward: -0.1849 | rev_kl: 0.7697 | stu_lens: 128.0000 | mixed_lens: 118.5000 | lr: 2.9543e-06 | scale: 1024.00 | time: 26.692 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2271/  5000| tot_loss: 2.4303 | rl_loss: 0.8458 | pt_loss: 1.5844 | pg_loss: 0.0209 | reg_loss: 0.8249 | reward: -0.2784 | rev_kl: 1.2491 | stu_lens: 103.5000 | mixed_lens: 128.0000 | lr: 2.9527e-06 | scale: 1024.00 | time: 26.668 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2272/  5000| tot_loss: 2.8321 | rl_loss: 0.9826 | pt_loss: 1.8495 | pg_loss: 0.0533 | reg_loss: 0.9293 | reward: -0.2639 | rev_kl: 1.4449 | stu_lens: 86.0000 | mixed_lens: 128.0000 | lr: 2.9511e-06 | scale: 1024.00 | time: 26.728 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2272/  5000| tot_loss: 2.9029 | rl_loss: 1.1834 | pt_loss: 1.7195 | pg_loss: 0.3042 | reg_loss: 0.8791 | reward: -0.3791 | rev_kl: 1.1405 | stu_lens: 88.9531 | mixed_lens: 92.1875 | lr: 2.9511e-06 | scale: 1024.00 | time: 26.728 | step time: 27.896
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2273/  5000| tot_loss: 3.0710 | rl_loss: 0.9927 | pt_loss: 2.0783 | pg_loss: 0.0238 | reg_loss: 0.9689 | reward: -0.4568 | rev_kl: 1.1961 | stu_lens: 37.5000 | mixed_lens: 123.0000 | lr: 2.9495e-06 | scale: 1024.00 | time: 26.710 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2274/  5000| tot_loss: 2.8496 | rl_loss: 0.9304 | pt_loss: 1.9192 | pg_loss: 0.1185 | reg_loss: 0.8119 | reward: -0.2661 | rev_kl: 1.2090 | stu_lens: 26.5000 | mixed_lens: 23.5000 | lr: 2.9480e-06 | scale: 1024.00 | time: 26.734 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2275/  5000| tot_loss: 2.3792 | rl_loss: 0.6326 | pt_loss: 1.7467 | pg_loss: 0.0135 | reg_loss: 0.6191 | reward: -0.1789 | rev_kl: 0.9883 | stu_lens: 62.5000 | mixed_lens: 128.0000 | lr: 2.9464e-06 | scale: 1024.00 | time: 26.717 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2276/  5000| tot_loss: 2.2180 | rl_loss: 0.7542 | pt_loss: 1.4639 | pg_loss: 0.1819 | reg_loss: 0.5722 | reward: -0.3908 | rev_kl: 0.8250 | stu_lens: 72.5000 | mixed_lens: 71.0000 | lr: 2.9448e-06 | scale: 1024.00 | time: 26.737 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2277/  5000| tot_loss: 2.1343 | rl_loss: 0.8566 | pt_loss: 1.2777 | pg_loss: 0.5098 | reg_loss: 0.3468 | reward: -0.2470 | rev_kl: 0.2253 | stu_lens: 81.0000 | mixed_lens: 80.0000 | lr: 2.9432e-06 | scale: 1024.00 | time: 26.730 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2278/  5000| tot_loss: 2.7241 | rl_loss: 0.6664 | pt_loss: 2.0578 | pg_loss: 0.1179 | reg_loss: 0.5485 | reward: -0.5865 | rev_kl: 1.1034 | stu_lens: 128.0000 | mixed_lens: 107.0000 | lr: 2.9417e-06 | scale: 1024.00 | time: 26.725 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2279/  5000| tot_loss: 2.5863 | rl_loss: 0.8543 | pt_loss: 1.7320 | pg_loss: 0.2785 | reg_loss: 0.5758 | reward: -0.3899 | rev_kl: 0.9368 | stu_lens: 54.0000 | mixed_lens: 72.0000 | lr: 2.9401e-06 | scale: 1024.00 | time: 26.711 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2280/  5000| tot_loss: 3.3806 | rl_loss: 1.1475 | pt_loss: 2.2331 | pg_loss: 0.3441 | reg_loss: 0.8034 | reward: -0.0150 | rev_kl: 0.5164 | stu_lens: 52.5000 | mixed_lens: 46.0000 | lr: 2.9385e-06 | scale: 1024.00 | time: 26.718 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2281/  5000| tot_loss: 2.3195 | rl_loss: 0.5586 | pt_loss: 1.7609 | pg_loss: -0.0060 | reg_loss: 0.5646 | reward: -0.1543 | rev_kl: 0.7517 | stu_lens: 112.5000 | mixed_lens: 126.5000 | lr: 2.9369e-06 | scale: 1024.00 | time: 26.722 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2282/  5000| tot_loss: 3.0974 | rl_loss: 0.9043 | pt_loss: 2.1931 | pg_loss: 0.1634 | reg_loss: 0.7409 | reward: -0.4352 | rev_kl: 1.0867 | stu_lens: 60.0000 | mixed_lens: 93.5000 | lr: 2.9353e-06 | scale: 1024.00 | time: 26.740 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2283/  5000| tot_loss: 2.0498 | rl_loss: 0.3545 | pt_loss: 1.6952 | pg_loss: -0.0061 | reg_loss: 0.3606 | reward: -0.2001 | rev_kl: 1.2933 | stu_lens: 104.5000 | mixed_lens: 128.0000 | lr: 2.9338e-06 | scale: 1024.00 | time: 26.694 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2284/  5000| tot_loss: 2.2795 | rl_loss: 0.8615 | pt_loss: 1.4180 | pg_loss: 0.1095 | reg_loss: 0.7519 | reward: -0.1484 | rev_kl: 1.3142 | stu_lens: 87.5000 | mixed_lens: 114.5000 | lr: 2.9322e-06 | scale: 1024.00 | time: 26.742 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2285/  5000| tot_loss: 2.0051 | rl_loss: 0.4366 | pt_loss: 1.5684 | pg_loss: 0.1734 | reg_loss: 0.2632 | reward: -0.6062 | rev_kl: 0.9621 | stu_lens: 58.5000 | mixed_lens: 93.5000 | lr: 2.9306e-06 | scale: 1024.00 | time: 26.723 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2286/  5000| tot_loss: 2.1480 | rl_loss: 0.3871 | pt_loss: 1.7609 | pg_loss: 0.0889 | reg_loss: 0.2983 | reward: -0.1621 | rev_kl: 1.3837 | stu_lens: 102.0000 | mixed_lens: 123.0000 | lr: 2.9290e-06 | scale: 1024.00 | time: 26.779 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2287/  5000| tot_loss: 2.8765 | rl_loss: 0.9556 | pt_loss: 1.9210 | pg_loss: 0.2508 | reg_loss: 0.7048 | reward: -0.4588 | rev_kl: 1.4563 | stu_lens: 128.0000 | mixed_lens: 88.5000 | lr: 2.9275e-06 | scale: 1024.00 | time: 26.702 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2288/  5000| tot_loss: 2.7316 | rl_loss: 0.7850 | pt_loss: 1.9466 | pg_loss: 0.0527 | reg_loss: 0.7324 | reward: -0.2035 | rev_kl: 1.0113 | stu_lens: 91.0000 | mixed_lens: 126.5000 | lr: 2.9259e-06 | scale: 1024.00 | time: 26.736 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2288/  5000| tot_loss: 2.5261 | rl_loss: 0.8619 | pt_loss: 1.6642 | pg_loss: 0.2622 | reg_loss: 0.5997 | reward: -0.3917 | rev_kl: 1.1067 | stu_lens: 87.0000 | mixed_lens: 93.5156 | lr: 2.9259e-06 | scale: 1024.00 | time: 26.736 | step time: 27.938
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2289/  5000| tot_loss: 2.8206 | rl_loss: 0.8922 | pt_loss: 1.9284 | pg_loss: 0.1389 | reg_loss: 0.7533 | reward: -0.5115 | rev_kl: 1.3788 | stu_lens: 117.0000 | mixed_lens: 99.0000 | lr: 2.9243e-06 | scale: 1024.00 | time: 26.698 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2290/  5000| tot_loss: 2.5933 | rl_loss: 0.8686 | pt_loss: 1.7247 | pg_loss: 0.4505 | reg_loss: 0.4180 | reward: -0.7562 | rev_kl: 1.1806 | stu_lens: 78.5000 | mixed_lens: 51.0000 | lr: 2.9227e-06 | scale: 1024.00 | time: 26.739 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2291/  5000| tot_loss: 1.8050 | rl_loss: 0.6793 | pt_loss: 1.1258 | pg_loss: 0.1579 | reg_loss: 0.5214 | reward: -0.4877 | rev_kl: 0.7788 | stu_lens: 24.0000 | mixed_lens: 96.5000 | lr: 2.9211e-06 | scale: 1024.00 | time: 26.733 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2292/  5000| tot_loss: 2.2100 | rl_loss: 0.4432 | pt_loss: 1.7668 | pg_loss: 0.1280 | reg_loss: 0.3152 | reward: -0.1960 | rev_kl: 0.9819 | stu_lens: 77.5000 | mixed_lens: 100.5000 | lr: 2.9196e-06 | scale: 1024.00 | time: 26.757 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2293/  5000| tot_loss: 3.1534 | rl_loss: 1.0240 | pt_loss: 2.1295 | pg_loss: 0.3581 | reg_loss: 0.6659 | reward: -0.7613 | rev_kl: 1.0874 | stu_lens: 58.0000 | mixed_lens: 77.5000 | lr: 2.9180e-06 | scale: 1024.00 | time: 26.749 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2294/  5000| tot_loss: 1.7362 | rl_loss: 0.3052 | pt_loss: 1.4310 | pg_loss: 0.0292 | reg_loss: 0.2759 | reward: -0.1297 | rev_kl: 1.1408 | stu_lens: 104.5000 | mixed_lens: 128.0000 | lr: 2.9164e-06 | scale: 1024.00 | time: 26.743 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2295/  5000| tot_loss: 2.2837 | rl_loss: 0.5958 | pt_loss: 1.6879 | pg_loss: 0.1973 | reg_loss: 0.3985 | reward: -0.1968 | rev_kl: 1.0663 | stu_lens: 79.5000 | mixed_lens: 108.0000 | lr: 2.9148e-06 | scale: 1024.00 | time: 26.748 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2296/  5000| tot_loss: 2.4784 | rl_loss: 0.6731 | pt_loss: 1.8053 | pg_loss: 0.1963 | reg_loss: 0.4768 | reward: -0.4440 | rev_kl: 1.3993 | stu_lens: 105.0000 | mixed_lens: 97.5000 | lr: 2.9132e-06 | scale: 1024.00 | time: 26.758 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2297/  5000| tot_loss: 2.4208 | rl_loss: 0.6452 | pt_loss: 1.7756 | pg_loss: 0.1830 | reg_loss: 0.4622 | reward: -0.3719 | rev_kl: 0.8225 | stu_lens: 82.5000 | mixed_lens: 90.0000 | lr: 2.9117e-06 | scale: 1024.00 | time: 26.752 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2298/  5000| tot_loss: 2.7170 | rl_loss: 0.6559 | pt_loss: 2.0611 | pg_loss: -0.0302 | reg_loss: 0.6861 | reward: -0.1453 | rev_kl: 1.1502 | stu_lens: 102.0000 | mixed_lens: 128.0000 | lr: 2.9101e-06 | scale: 1024.00 | time: 26.829 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2299/  5000| tot_loss: 2.6539 | rl_loss: 1.0698 | pt_loss: 1.5841 | pg_loss: 0.3185 | reg_loss: 0.7513 | reward: -0.3515 | rev_kl: 0.8182 | stu_lens: 69.5000 | mixed_lens: 69.0000 | lr: 2.9085e-06 | scale: 1024.00 | time: 26.762 | step time: 0.000
                                 Evaluation #23                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Yes, Bob should leave Alice. His     │
│                                       │ odds of survival improve by 9%,      │
│                                       │ which is a significant advantage.    │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ It is a typing mistake. The correct  │
│                                       │ answer is y instead of z.            │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support 27 languages.             │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.506 | exact_match: 0.323 | rev_kl: 1.143 | lens: 87.420 | pt_loss: 1.075 | lm_loss: 1.156 | kd_loss: 0.994 
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2300/  5000| tot_loss: 1.6673 | rl_loss: 0.6241 | pt_loss: 1.0432 | pg_loss: 0.2188 | reg_loss: 0.4053 | reward: -0.7690 | rev_kl: 1.0606 | stu_lens: 87.0000 | mixed_lens: 72.5000 | lr: 2.9069e-06 | scale: 1024.00 | time: 26.777 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2301/  5000| tot_loss: 2.5876 | rl_loss: 0.7487 | pt_loss: 1.8389 | pg_loss: 0.3374 | reg_loss: 0.4114 | reward: -0.8500 | rev_kl: 0.8493 | stu_lens: 56.5000 | mixed_lens: 76.5000 | lr: 2.9053e-06 | scale: 1024.00 | time: 26.694 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2302/  5000| tot_loss: 1.9473 | rl_loss: 0.5904 | pt_loss: 1.3570 | pg_loss: 0.1278 | reg_loss: 0.4626 | reward: -0.4342 | rev_kl: 1.0956 | stu_lens: 50.5000 | mixed_lens: 99.0000 | lr: 2.9037e-06 | scale: 1024.00 | time: 26.597 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2303/  5000| tot_loss: 1.7770 | rl_loss: 0.6803 | pt_loss: 1.0968 | pg_loss: 0.1665 | reg_loss: 0.5138 | reward: -0.3785 | rev_kl: 1.3978 | stu_lens: 128.0000 | mixed_lens: 102.0000 | lr: 2.9022e-06 | scale: 1024.00 | time: 26.574 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2304/  5000| tot_loss: 2.4521 | rl_loss: 0.4238 | pt_loss: 2.0283 | pg_loss: 0.0157 | reg_loss: 0.4081 | reward: -0.3611 | rev_kl: 1.3891 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.9006e-06 | scale: 1024.00 | time: 26.595 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2304/  5000| tot_loss: 2.3901 | rl_loss: 0.7226 | pt_loss: 1.6675 | pg_loss: 0.2469 | reg_loss: 0.4757 | reward: -0.4173 | rev_kl: 1.1409 | stu_lens: 84.6250 | mixed_lens: 89.6562 | lr: 2.9006e-06 | scale: 1024.00 | time: 26.595 | step time: 27.931
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2305/  5000| tot_loss: 1.5641 | rl_loss: 0.3011 | pt_loss: 1.2630 | pg_loss: -0.0050 | reg_loss: 0.3062 | reward: -0.0602 | rev_kl: 1.0898 | stu_lens: 123.5000 | mixed_lens: 128.0000 | lr: 2.8990e-06 | scale: 1024.00 | time: 26.623 | step time: 0.000
Another outer ppo epoch, outer ppo epoch: 1
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2306/  5000| tot_loss: 4.3884 | rl_loss: 2.5666 | pt_loss: 1.8218 | pg_loss: 1.0250 | reg_loss: 1.5416 | reward: -1.1008 | rev_kl: 1.1958 | stu_lens: 51.0000 | mixed_lens: 30.5000 | lr: 2.8974e-06 | scale: 1024.00 | time: 26.620 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2307/  5000| tot_loss: 3.0894 | rl_loss: 1.8107 | pt_loss: 1.2787 | pg_loss: 0.7508 | reg_loss: 1.0599 | reward: -0.0597 | rev_kl: 0.6189 | stu_lens: 104.0000 | mixed_lens: 36.0000 | lr: 2.8958e-06 | scale: 1024.00 | time: 26.606 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2308/  5000| tot_loss: 4.5943 | rl_loss: 2.6943 | pt_loss: 1.9000 | pg_loss: 1.4602 | reg_loss: 1.2341 | reward: -1.0170 | rev_kl: 0.6388 | stu_lens: 75.0000 | mixed_lens: 26.0000 | lr: 2.8943e-06 | scale: 1024.00 | time: 26.589 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2309/  5000| tot_loss: 2.6903 | rl_loss: 0.8663 | pt_loss: 1.8240 | pg_loss: 0.0320 | reg_loss: 0.8342 | reward: -0.2439 | rev_kl: 0.9794 | stu_lens: 106.0000 | mixed_lens: 128.0000 | lr: 2.8927e-06 | scale: 1024.00 | time: 26.608 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2310/  5000| tot_loss: 3.0256 | rl_loss: 1.0391 | pt_loss: 1.9864 | pg_loss: 0.0919 | reg_loss: 0.9472 | reward: -0.3477 | rev_kl: 1.0349 | stu_lens: 128.0000 | mixed_lens: 124.0000 | lr: 2.8911e-06 | scale: 1024.00 | time: 26.590 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2311/  5000| tot_loss: 3.5368 | rl_loss: 1.9818 | pt_loss: 1.5550 | pg_loss: 0.6526 | reg_loss: 1.3292 | reward: -0.4898 | rev_kl: 0.9390 | stu_lens: 89.0000 | mixed_lens: 69.5000 | lr: 2.8895e-06 | scale: 1024.00 | time: 26.626 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2312/  5000| tot_loss: 3.4202 | rl_loss: 1.5247 | pt_loss: 1.8955 | pg_loss: 0.2271 | reg_loss: 1.2976 | reward: -0.3475 | rev_kl: 1.2942 | stu_lens: 128.0000 | mixed_lens: 98.0000 | lr: 2.8879e-06 | scale: 1024.00 | time: 26.589 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2313/  5000| tot_loss: 2.5953 | rl_loss: 1.3589 | pt_loss: 1.2364 | pg_loss: 0.4802 | reg_loss: 0.8787 | reward: -0.4881 | rev_kl: 0.7873 | stu_lens: 115.5000 | mixed_lens: 73.0000 | lr: 2.8863e-06 | scale: 1024.00 | time: 26.619 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2314/  5000| tot_loss: 3.0910 | rl_loss: 1.5703 | pt_loss: 1.5207 | pg_loss: 0.0549 | reg_loss: 1.5154 | reward: -0.2046 | rev_kl: 1.0392 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8848e-06 | scale: 1024.00 | time: 26.593 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2315/  5000| tot_loss: 3.4264 | rl_loss: 1.6921 | pt_loss: 1.7343 | pg_loss: 0.7289 | reg_loss: 0.9632 | reward: -0.2860 | rev_kl: 0.7909 | stu_lens: 30.0000 | mixed_lens: 49.5000 | lr: 2.8832e-06 | scale: 1024.00 | time: 26.605 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2316/  5000| tot_loss: 3.1260 | rl_loss: 1.6577 | pt_loss: 1.4684 | pg_loss: 0.3658 | reg_loss: 1.2918 | reward: -0.2207 | rev_kl: 1.0938 | stu_lens: 107.0000 | mixed_lens: 92.5000 | lr: 2.8816e-06 | scale: 1024.00 | time: 26.577 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2317/  5000| tot_loss: 3.1308 | rl_loss: 1.5087 | pt_loss: 1.6221 | pg_loss: 0.1863 | reg_loss: 1.3225 | reward: -0.2795 | rev_kl: 1.2694 | stu_lens: 128.0000 | mixed_lens: 109.0000 | lr: 2.8800e-06 | scale: 1024.00 | time: 26.630 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2318/  5000| tot_loss: 3.4551 | rl_loss: 1.8026 | pt_loss: 1.6525 | pg_loss: 0.4579 | reg_loss: 1.3447 | reward: -0.4911 | rev_kl: 2.2096 | stu_lens: 33.0000 | mixed_lens: 69.0000 | lr: 2.8784e-06 | scale: 1024.00 | time: 26.556 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2319/  5000| tot_loss: 3.0807 | rl_loss: 1.4458 | pt_loss: 1.6349 | pg_loss: 0.1820 | reg_loss: 1.2639 | reward: -0.3255 | rev_kl: 1.1661 | stu_lens: 111.5000 | mixed_lens: 105.5000 | lr: 2.8768e-06 | scale: 1024.00 | time: 26.622 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2320/  5000| tot_loss: 3.2996 | rl_loss: 1.3668 | pt_loss: 1.9328 | pg_loss: 0.0450 | reg_loss: 1.3218 | reward: -0.2966 | rev_kl: 1.1012 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8752e-06 | scale: 1024.00 | time: 26.620 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2320/  5000| tot_loss: 3.2122 | rl_loss: 1.5852 | pt_loss: 1.6270 | pg_loss: 0.3910 | reg_loss: 1.1942 | reward: -0.4257 | rev_kl: 1.1635 | stu_lens: 91.1562 | mixed_lens: 90.1094 | lr: 2.8752e-06 | scale: 1024.00 | time: 26.620 | step time: 27.818
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2321/  5000| tot_loss: 3.7951 | rl_loss: 2.2153 | pt_loss: 1.5798 | pg_loss: 0.7685 | reg_loss: 1.4468 | reward: -0.3924 | rev_kl: 4.0901 | stu_lens: 82.5000 | mixed_lens: 56.0000 | lr: 2.8737e-06 | scale: 1024.00 | time: 26.638 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2322/  5000| tot_loss: 2.5000 | rl_loss: 0.8085 | pt_loss: 1.6915 | pg_loss: -0.0001 | reg_loss: 0.8086 | reward: -0.1010 | rev_kl: 1.1226 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8721e-06 | scale: 1024.00 | time: 26.619 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2323/  5000| tot_loss: 2.4583 | rl_loss: 1.0564 | pt_loss: 1.4019 | pg_loss: 0.1938 | reg_loss: 0.8626 | reward: -0.1500 | rev_kl: 1.0342 | stu_lens: 104.0000 | mixed_lens: 89.0000 | lr: 2.8705e-06 | scale: 1024.00 | time: 26.640 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2324/  5000| tot_loss: 2.0305 | rl_loss: 0.9744 | pt_loss: 1.0561 | pg_loss: 0.2309 | reg_loss: 0.7435 | reward: -0.3702 | rev_kl: 1.0553 | stu_lens: 53.0000 | mixed_lens: 66.5000 | lr: 2.8689e-06 | scale: 1024.00 | time: 26.615 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2325/  5000| tot_loss: 2.6321 | rl_loss: 0.9853 | pt_loss: 1.6468 | pg_loss: 0.2543 | reg_loss: 0.7311 | reward: -0.4604 | rev_kl: 1.0682 | stu_lens: 53.5000 | mixed_lens: 76.0000 | lr: 2.8673e-06 | scale: 1024.00 | time: 26.633 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2326/  5000| tot_loss: 2.5377 | rl_loss: 0.7478 | pt_loss: 1.7899 | pg_loss: -0.0052 | reg_loss: 0.7530 | reward: -0.1386 | rev_kl: 1.1210 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8657e-06 | scale: 1024.00 | time: 26.636 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2327/  5000| tot_loss: 3.3667 | rl_loss: 1.4678 | pt_loss: 1.8989 | pg_loss: 0.2599 | reg_loss: 1.2079 | reward: -0.4108 | rev_kl: 1.2665 | stu_lens: 77.0000 | mixed_lens: 92.0000 | lr: 2.8642e-06 | scale: 1024.00 | time: 26.627 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2328/  5000| tot_loss: 2.8263 | rl_loss: 1.2632 | pt_loss: 1.5631 | pg_loss: 0.1349 | reg_loss: 1.1284 | reward: -0.3218 | rev_kl: 1.3453 | stu_lens: 106.0000 | mixed_lens: 109.0000 | lr: 2.8626e-06 | scale: 1024.00 | time: 26.616 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2329/  5000| tot_loss: 2.6919 | rl_loss: 0.9978 | pt_loss: 1.6941 | pg_loss: 0.1593 | reg_loss: 0.8385 | reward: -0.3334 | rev_kl: 1.2864 | stu_lens: 97.0000 | mixed_lens: 105.5000 | lr: 2.8610e-06 | scale: 1024.00 | time: 26.678 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2330/  5000| tot_loss: 3.0690 | rl_loss: 1.3472 | pt_loss: 1.7218 | pg_loss: 0.1903 | reg_loss: 1.1569 | reward: -0.4878 | rev_kl: 1.4518 | stu_lens: 125.0000 | mixed_lens: 90.0000 | lr: 2.8594e-06 | scale: 1024.00 | time: 26.650 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2331/  5000| tot_loss: 2.4423 | rl_loss: 0.8021 | pt_loss: 1.6403 | pg_loss: 0.0324 | reg_loss: 0.7696 | reward: -0.2888 | rev_kl: 1.0579 | stu_lens: 128.0000 | mixed_lens: 124.0000 | lr: 2.8578e-06 | scale: 1024.00 | time: 26.670 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2332/  5000| tot_loss: 1.7108 | rl_loss: 0.6101 | pt_loss: 1.1006 | pg_loss: 0.2533 | reg_loss: 0.3569 | reward: -0.6370 | rev_kl: 0.4387 | stu_lens: 108.0000 | mixed_lens: 74.0000 | lr: 2.8562e-06 | scale: 1024.00 | time: 26.642 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2333/  5000| tot_loss: 2.9529 | rl_loss: 1.4731 | pt_loss: 1.4798 | pg_loss: 0.4495 | reg_loss: 1.0236 | reward: -1.1408 | rev_kl: 1.2436 | stu_lens: 50.0000 | mixed_lens: 38.0000 | lr: 2.8546e-06 | scale: 1024.00 | time: 26.700 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2334/  5000| tot_loss: 4.2418 | rl_loss: 1.3500 | pt_loss: 2.8918 | pg_loss: 0.7008 | reg_loss: 0.6492 | reward: -0.5535 | rev_kl: 1.3177 | stu_lens: 53.0000 | mixed_lens: 46.5000 | lr: 2.8530e-06 | scale: 1024.00 | time: 26.639 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2335/  5000| tot_loss: 3.2926 | rl_loss: 1.6019 | pt_loss: 1.6907 | pg_loss: 0.6466 | reg_loss: 0.9553 | reward: -0.5389 | rev_kl: 1.1911 | stu_lens: 118.5000 | mixed_lens: 59.0000 | lr: 2.8515e-06 | scale: 1024.00 | time: 26.661 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2336/  5000| tot_loss: 3.7218 | rl_loss: 2.1193 | pt_loss: 1.6025 | pg_loss: 1.0861 | reg_loss: 1.0332 | reward: -0.2670 | rev_kl: 3.0951 | stu_lens: 50.5000 | mixed_lens: 38.5000 | lr: 2.8499e-06 | scale: 1024.00 | time: 26.660 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2336/  5000| tot_loss: 2.8564 | rl_loss: 1.2076 | pt_loss: 1.6489 | pg_loss: 0.3490 | reg_loss: 0.8586 | reward: -0.4265 | rev_kl: 1.3360 | stu_lens: 86.7500 | mixed_lens: 81.7812 | lr: 2.8499e-06 | scale: 1024.00 | time: 26.660 | step time: 27.857
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2337/  5000| tot_loss: 2.4821 | rl_loss: 0.9096 | pt_loss: 1.5725 | pg_loss: 0.1908 | reg_loss: 0.7188 | reward: -0.4605 | rev_kl: 1.6517 | stu_lens: 108.5000 | mixed_lens: 91.0000 | lr: 2.8483e-06 | scale: 1024.00 | time: 26.663 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2338/  5000| tot_loss: 2.9091 | rl_loss: 1.1396 | pt_loss: 1.7695 | pg_loss: 0.4588 | reg_loss: 0.6808 | reward: -0.0303 | rev_kl: 3.1949 | stu_lens: 69.5000 | mixed_lens: 74.0000 | lr: 2.8467e-06 | scale: 1024.00 | time: 26.669 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2339/  5000| tot_loss: 2.7460 | rl_loss: 1.0351 | pt_loss: 1.7109 | pg_loss: 0.1690 | reg_loss: 0.8660 | reward: -0.5461 | rev_kl: 1.5679 | stu_lens: 118.5000 | mixed_lens: 89.0000 | lr: 2.8451e-06 | scale: 1024.00 | time: 26.697 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2340/  5000| tot_loss: 3.4924 | rl_loss: 1.4307 | pt_loss: 2.0617 | pg_loss: 0.6324 | reg_loss: 0.7983 | reward: -0.5104 | rev_kl: 0.8418 | stu_lens: 95.5000 | mixed_lens: 28.5000 | lr: 2.8435e-06 | scale: 1024.00 | time: 26.672 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2341/  5000| tot_loss: 2.8502 | rl_loss: 1.0640 | pt_loss: 1.7861 | pg_loss: 0.3176 | reg_loss: 0.7464 | reward: -0.6088 | rev_kl: 1.7124 | stu_lens: 21.5000 | mixed_lens: 76.0000 | lr: 2.8419e-06 | scale: 1024.00 | time: 26.692 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2342/  5000| tot_loss: 2.9005 | rl_loss: 0.9130 | pt_loss: 1.9874 | pg_loss: 0.3858 | reg_loss: 0.5273 | reward: -0.3158 | rev_kl: 0.7888 | stu_lens: 50.0000 | mixed_lens: 92.5000 | lr: 2.8403e-06 | scale: 1024.00 | time: 26.652 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2343/  5000| tot_loss: 2.4904 | rl_loss: 0.7090 | pt_loss: 1.7814 | pg_loss: 0.0450 | reg_loss: 0.6639 | reward: -0.3510 | rev_kl: 0.9472 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8388e-06 | scale: 1024.00 | time: 26.672 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2344/  5000| tot_loss: 2.7708 | rl_loss: 1.3440 | pt_loss: 1.4268 | pg_loss: 0.4920 | reg_loss: 0.8520 | reward: -0.4978 | rev_kl: 1.4454 | stu_lens: 64.5000 | mixed_lens: 66.5000 | lr: 2.8372e-06 | scale: 1024.00 | time: 26.667 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2345/  5000| tot_loss: 2.1812 | rl_loss: 0.5441 | pt_loss: 1.6372 | pg_loss: 0.0167 | reg_loss: 0.5273 | reward: -0.4144 | rev_kl: 1.0359 | stu_lens: 107.0000 | mixed_lens: 124.5000 | lr: 2.8356e-06 | scale: 1024.00 | time: 26.687 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2346/  5000| tot_loss: 3.0020 | rl_loss: 0.8342 | pt_loss: 2.1678 | pg_loss: 0.2723 | reg_loss: 0.5619 | reward: -0.3266 | rev_kl: 0.7088 | stu_lens: 118.0000 | mixed_lens: 93.5000 | lr: 2.8340e-06 | scale: 1024.00 | time: 26.667 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2347/  5000| tot_loss: 2.0607 | rl_loss: 0.3955 | pt_loss: 1.6652 | pg_loss: 0.0105 | reg_loss: 0.3850 | reward: -0.4171 | rev_kl: 1.0400 | stu_lens: 88.5000 | mixed_lens: 124.0000 | lr: 2.8324e-06 | scale: 1024.00 | time: 26.714 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2348/  5000| tot_loss: 3.4854 | rl_loss: 1.5517 | pt_loss: 1.9337 | pg_loss: 1.1883 | reg_loss: 0.3634 | reward: -0.8959 | rev_kl: 0.6007 | stu_lens: 115.5000 | mixed_lens: 34.0000 | lr: 2.8308e-06 | scale: 1024.00 | time: 26.663 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2349/  5000| tot_loss: 2.3052 | rl_loss: 0.6833 | pt_loss: 1.6219 | pg_loss: 0.2905 | reg_loss: 0.3928 | reward: -0.5039 | rev_kl: 0.7750 | stu_lens: 75.0000 | mixed_lens: 80.0000 | lr: 2.8292e-06 | scale: 1024.00 | time: 26.688 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2350/  5000| tot_loss: 2.2562 | rl_loss: 0.5953 | pt_loss: 1.6608 | pg_loss: 0.0078 | reg_loss: 0.5875 | reward: -0.1236 | rev_kl: 1.1436 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8276e-06 | scale: 1024.00 | time: 26.650 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2351/  5000| tot_loss: 2.0122 | rl_loss: 1.0291 | pt_loss: 0.9831 | pg_loss: 0.3549 | reg_loss: 0.6742 | reward: -0.3478 | rev_kl: 0.7941 | stu_lens: 100.5000 | mixed_lens: 82.5000 | lr: 2.8261e-06 | scale: 1024.00 | time: 26.687 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2352/  5000| tot_loss: 2.2637 | rl_loss: 0.7278 | pt_loss: 1.5359 | pg_loss: 0.2217 | reg_loss: 0.5061 | reward: -0.3263 | rev_kl: 0.9844 | stu_lens: 103.5000 | mixed_lens: 90.5000 | lr: 2.8245e-06 | scale: 1024.00 | time: 26.647 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2352/  5000| tot_loss: 2.6475 | rl_loss: 0.9170 | pt_loss: 1.7305 | pg_loss: 0.3390 | reg_loss: 0.5780 | reward: -0.4444 | rev_kl: 1.2361 | stu_lens: 83.7500 | mixed_lens: 83.2031 | lr: 2.8245e-06 | scale: 1024.00 | time: 26.647 | step time: 27.886
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2353/  5000| tot_loss: 2.2424 | rl_loss: 0.4530 | pt_loss: 1.7894 | pg_loss: 0.0249 | reg_loss: 0.4280 | reward: -0.1861 | rev_kl: 1.5838 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8229e-06 | scale: 1024.00 | time: 26.642 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2354/  5000| tot_loss: 2.4604 | rl_loss: 0.7032 | pt_loss: 1.7572 | pg_loss: 0.3718 | reg_loss: 0.3314 | reward: -0.4137 | rev_kl: 0.7226 | stu_lens: 105.5000 | mixed_lens: 83.5000 | lr: 2.8213e-06 | scale: 1024.00 | time: 26.621 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2355/  5000| tot_loss: 2.6220 | rl_loss: 0.9412 | pt_loss: 1.6808 | pg_loss: 0.4233 | reg_loss: 0.5179 | reward: -0.5000 | rev_kl: 1.8291 | stu_lens: 35.0000 | mixed_lens: 69.0000 | lr: 2.8197e-06 | scale: 1024.00 | time: 26.647 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2356/  5000| tot_loss: 2.3803 | rl_loss: 0.7644 | pt_loss: 1.6159 | pg_loss: 0.4052 | reg_loss: 0.3591 | reward: -0.6793 | rev_kl: 1.1209 | stu_lens: 47.0000 | mixed_lens: 54.0000 | lr: 2.8181e-06 | scale: 1024.00 | time: 26.654 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2357/  5000| tot_loss: 2.6794 | rl_loss: 1.0310 | pt_loss: 1.6485 | pg_loss: 0.4554 | reg_loss: 0.5755 | reward: -0.3598 | rev_kl: 1.8174 | stu_lens: 43.0000 | mixed_lens: 78.5000 | lr: 2.8165e-06 | scale: 1024.00 | time: 26.673 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2358/  5000| tot_loss: 2.1958 | rl_loss: 0.4696 | pt_loss: 1.7262 | pg_loss: 0.0889 | reg_loss: 0.3808 | reward: -0.2126 | rev_kl: 1.1717 | stu_lens: 128.0000 | mixed_lens: 113.0000 | lr: 2.8149e-06 | scale: 1024.00 | time: 26.647 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2359/  5000| tot_loss: 1.4663 | rl_loss: 0.5927 | pt_loss: 0.8736 | pg_loss: 0.2542 | reg_loss: 0.3385 | reward: -0.1086 | rev_kl: 1.2565 | stu_lens: 74.5000 | mixed_lens: 74.5000 | lr: 2.8133e-06 | scale: 1024.00 | time: 26.660 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2360/  5000| tot_loss: 2.7688 | rl_loss: 0.6652 | pt_loss: 2.1036 | pg_loss: 0.3358 | reg_loss: 0.3295 | reward: -0.6433 | rev_kl: 1.2117 | stu_lens: 95.5000 | mixed_lens: 81.5000 | lr: 2.8117e-06 | scale: 1024.00 | time: 26.650 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2361/  5000| tot_loss: 1.9342 | rl_loss: 0.7081 | pt_loss: 1.2261 | pg_loss: 0.3580 | reg_loss: 0.3501 | reward: -0.3799 | rev_kl: 0.7868 | stu_lens: 75.5000 | mixed_lens: 76.0000 | lr: 2.8102e-06 | scale: 1024.00 | time: 26.633 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2362/  5000| tot_loss: 3.2200 | rl_loss: 1.3720 | pt_loss: 1.8480 | pg_loss: 0.8114 | reg_loss: 0.5607 | reward: -0.5700 | rev_kl: 4.0270 | stu_lens: 96.5000 | mixed_lens: 52.5000 | lr: 2.8086e-06 | scale: 1024.00 | time: 26.613 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2363/  5000| tot_loss: 1.9909 | rl_loss: 0.3017 | pt_loss: 1.6892 | pg_loss: 0.0100 | reg_loss: 0.2916 | reward: -0.2819 | rev_kl: 1.1566 | stu_lens: 95.0000 | mixed_lens: 128.0000 | lr: 2.8070e-06 | scale: 1024.00 | time: 26.631 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2364/  5000| tot_loss: 2.2631 | rl_loss: 0.5892 | pt_loss: 1.6739 | pg_loss: 0.2775 | reg_loss: 0.3117 | reward: -0.3541 | rev_kl: 1.2479 | stu_lens: 85.5000 | mixed_lens: 89.0000 | lr: 2.8054e-06 | scale: 1024.00 | time: 26.612 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2365/  5000| tot_loss: 2.2221 | rl_loss: 0.7392 | pt_loss: 1.4829 | pg_loss: 0.3612 | reg_loss: 0.3780 | reward: -0.4177 | rev_kl: 1.6247 | stu_lens: 112.0000 | mixed_lens: 89.0000 | lr: 2.8038e-06 | scale: 1024.00 | time: 26.628 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2366/  5000| tot_loss: 2.6778 | rl_loss: 0.8496 | pt_loss: 1.8282 | pg_loss: 0.2138 | reg_loss: 0.6358 | reward: -0.4538 | rev_kl: 0.6666 | stu_lens: 109.0000 | mixed_lens: 92.5000 | lr: 2.8022e-06 | scale: 1024.00 | time: 26.606 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2367/  5000| tot_loss: 2.2278 | rl_loss: 0.4277 | pt_loss: 1.8000 | pg_loss: 0.0248 | reg_loss: 0.4029 | reward: -0.1522 | rev_kl: 0.8565 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8006e-06 | scale: 1024.00 | time: 26.628 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2368/  5000| tot_loss: 3.2527 | rl_loss: 1.5226 | pt_loss: 1.7301 | pg_loss: 0.8796 | reg_loss: 0.6430 | reward: -0.9122 | rev_kl: 1.3581 | stu_lens: 63.0000 | mixed_lens: 56.0000 | lr: 2.7990e-06 | scale: 1024.00 | time: 26.597 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2368/  5000| tot_loss: 2.4597 | rl_loss: 0.7505 | pt_loss: 1.7092 | pg_loss: 0.3027 | reg_loss: 0.4478 | reward: -0.4254 | rev_kl: 1.2863 | stu_lens: 89.4219 | mixed_lens: 86.7656 | lr: 2.7990e-06 | scale: 1024.00 | time: 26.597 | step time: 27.845
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2369/  5000| tot_loss: 2.5821 | rl_loss: 0.8039 | pt_loss: 1.7782 | pg_loss: 0.3002 | reg_loss: 0.5038 | reward: -0.7574 | rev_kl: 0.7630 | stu_lens: 107.0000 | mixed_lens: 70.5000 | lr: 2.7974e-06 | scale: 1024.00 | time: 26.620 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2370/  5000| tot_loss: 2.7613 | rl_loss: 1.0785 | pt_loss: 1.6828 | pg_loss: 0.1244 | reg_loss: 0.9541 | reward: -0.1965 | rev_kl: 0.8975 | stu_lens: 128.0000 | mixed_lens: 117.0000 | lr: 2.7958e-06 | scale: 1024.00 | time: 26.698 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2371/  5000| tot_loss: 4.4015 | rl_loss: 1.8541 | pt_loss: 2.5474 | pg_loss: 0.5897 | reg_loss: 1.2643 | reward: -0.8064 | rev_kl: 1.1775 | stu_lens: 47.0000 | mixed_lens: 72.0000 | lr: 2.7942e-06 | scale: 1024.00 | time: 26.705 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2372/  5000| tot_loss: 3.6965 | rl_loss: 2.1638 | pt_loss: 1.5327 | pg_loss: 0.7393 | reg_loss: 1.4245 | reward: -0.2258 | rev_kl: 1.4267 | stu_lens: 66.5000 | mixed_lens: 52.0000 | lr: 2.7926e-06 | scale: 1024.00 | time: 26.656 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2373/  5000| tot_loss: 3.9877 | rl_loss: 2.0897 | pt_loss: 1.8981 | pg_loss: 0.4770 | reg_loss: 1.6126 | reward: -0.5231 | rev_kl: 1.1501 | stu_lens: 94.0000 | mixed_lens: 85.0000 | lr: 2.7911e-06 | scale: 1024.00 | time: 26.652 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2374/  5000| tot_loss: 3.2432 | rl_loss: 1.5820 | pt_loss: 1.6612 | pg_loss: 0.3085 | reg_loss: 1.2735 | reward: 0.0184 | rev_kl: 0.4804 | stu_lens: 66.5000 | mixed_lens: 81.0000 | lr: 2.7895e-06 | scale: 1024.00 | time: 26.652 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2375/  5000| tot_loss: 3.1076 | rl_loss: 1.3878 | pt_loss: 1.7198 | pg_loss: 0.6026 | reg_loss: 0.7852 | reward: -0.0992 | rev_kl: 0.2053 | stu_lens: 65.0000 | mixed_lens: 65.0000 | lr: 2.7879e-06 | scale: 1024.00 | time: 26.677 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2376/  5000| tot_loss: 3.2312 | rl_loss: 1.3891 | pt_loss: 1.8420 | pg_loss: 0.1035 | reg_loss: 1.2857 | reward: -0.1521 | rev_kl: 0.9593 | stu_lens: 93.0000 | mixed_lens: 113.5000 | lr: 2.7863e-06 | scale: 1024.00 | time: 26.658 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2377/  5000| tot_loss: 3.0272 | rl_loss: 1.5470 | pt_loss: 1.4801 | pg_loss: 0.2102 | reg_loss: 1.3368 | reward: -0.2933 | rev_kl: 0.9009 | stu_lens: 105.0000 | mixed_lens: 107.5000 | lr: 2.7847e-06 | scale: 1024.00 | time: 26.679 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2378/  5000| tot_loss: 2.3494 | rl_loss: 0.7442 | pt_loss: 1.6052 | pg_loss: 0.3069 | reg_loss: 0.4373 | reward: -0.3608 | rev_kl: 0.5239 | stu_lens: 98.0000 | mixed_lens: 88.5000 | lr: 2.7831e-06 | scale: 1024.00 | time: 26.660 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2379/  5000| tot_loss: 2.9688 | rl_loss: 1.2211 | pt_loss: 1.7477 | pg_loss: 0.0657 | reg_loss: 1.1554 | reward: -0.1679 | rev_kl: 0.2006 | stu_lens: 87.5000 | mixed_lens: 126.5000 | lr: 2.7815e-06 | scale: 1024.00 | time: 26.690 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2380/  5000| tot_loss: 2.8024 | rl_loss: 1.1254 | pt_loss: 1.6770 | pg_loss: 0.0610 | reg_loss: 1.0644 | reward: -0.2901 | rev_kl: 0.4492 | stu_lens: 77.5000 | mixed_lens: 124.0000 | lr: 2.7799e-06 | scale: 1024.00 | time: 26.657 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2381/  5000| tot_loss: 3.3605 | rl_loss: 1.6173 | pt_loss: 1.7432 | pg_loss: 0.4316 | reg_loss: 1.1858 | reward: -0.2991 | rev_kl: 0.9864 | stu_lens: 94.0000 | mixed_lens: 88.0000 | lr: 2.7783e-06 | scale: 1024.00 | time: 26.723 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2382/  5000| tot_loss: 3.1623 | rl_loss: 1.7550 | pt_loss: 1.4073 | pg_loss: 0.0690 | reg_loss: 1.6860 | reward: -0.3088 | rev_kl: 1.3685 | stu_lens: 102.5000 | mixed_lens: 128.0000 | lr: 2.7767e-06 | scale: 1024.00 | time: 26.655 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2383/  5000| tot_loss: 2.8962 | rl_loss: 1.2970 | pt_loss: 1.5992 | pg_loss: 0.2915 | reg_loss: 1.0055 | reward: -0.1693 | rev_kl: 1.9498 | stu_lens: 72.5000 | mixed_lens: 97.5000 | lr: 2.7751e-06 | scale: 1024.00 | time: 26.686 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2384/  5000| tot_loss: 3.9602 | rl_loss: 2.1186 | pt_loss: 1.8416 | pg_loss: 1.0264 | reg_loss: 1.0922 | reward: -0.6713 | rev_kl: 0.6836 | stu_lens: 44.5000 | mixed_lens: 48.0000 | lr: 2.7735e-06 | scale: 1024.00 | time: 26.656 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2384/  5000| tot_loss: 3.2364 | rl_loss: 1.5191 | pt_loss: 1.7172 | pg_loss: 0.3926 | reg_loss: 1.1265 | reward: -0.3113 | rev_kl: 0.9863 | stu_lens: 83.9688 | mixed_lens: 86.3750 | lr: 2.7735e-06 | scale: 1024.00 | time: 26.656 | step time: 27.884
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2385/  5000| tot_loss: 3.0729 | rl_loss: 1.1143 | pt_loss: 1.9586 | pg_loss: 0.4130 | reg_loss: 0.7013 | reward: -0.0994 | rev_kl: 0.4956 | stu_lens: 77.5000 | mixed_lens: 77.5000 | lr: 2.7719e-06 | scale: 1024.00 | time: 26.670 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2386/  5000| tot_loss: 4.0241 | rl_loss: 2.2582 | pt_loss: 1.7659 | pg_loss: 0.7557 | reg_loss: 1.5025 | reward: -0.8534 | rev_kl: 1.2569 | stu_lens: 88.5000 | mixed_lens: 50.0000 | lr: 2.7704e-06 | scale: 1024.00 | time: 26.701 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2387/  5000| tot_loss: 2.8639 | rl_loss: 0.9895 | pt_loss: 1.8744 | pg_loss: 0.0668 | reg_loss: 0.9227 | reward: -0.1705 | rev_kl: 0.8262 | stu_lens: 115.5000 | mixed_lens: 118.0000 | lr: 2.7688e-06 | scale: 1024.00 | time: 26.710 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2388/  5000| tot_loss: 3.9233 | rl_loss: 2.0508 | pt_loss: 1.8725 | pg_loss: 1.0211 | reg_loss: 1.0297 | reward: -0.8604 | rev_kl: 1.4328 | stu_lens: 84.5000 | mixed_lens: 46.5000 | lr: 2.7672e-06 | scale: 1024.00 | time: 26.665 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2389/  5000| tot_loss: 2.4662 | rl_loss: 0.9411 | pt_loss: 1.5251 | pg_loss: 0.1442 | reg_loss: 0.7969 | reward: -0.3853 | rev_kl: 1.1516 | stu_lens: 46.5000 | mixed_lens: 90.5000 | lr: 2.7656e-06 | scale: 1024.00 | time: 26.728 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2390/  5000| tot_loss: 1.9670 | rl_loss: 0.5689 | pt_loss: 1.3981 | pg_loss: 0.2074 | reg_loss: 0.3615 | reward: -0.5821 | rev_kl: 0.8345 | stu_lens: 102.0000 | mixed_lens: 84.5000 | lr: 2.7640e-06 | scale: 1024.00 | time: 26.705 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2391/  5000| tot_loss: 3.3436 | rl_loss: 1.1119 | pt_loss: 2.2317 | pg_loss: 0.5966 | reg_loss: 0.5152 | reward: -0.5598 | rev_kl: 0.9647 | stu_lens: 39.0000 | mixed_lens: 61.0000 | lr: 2.7624e-06 | scale: 1024.00 | time: 26.737 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2392/  5000| tot_loss: 3.5021 | rl_loss: 1.7526 | pt_loss: 1.7495 | pg_loss: 0.6557 | reg_loss: 1.0969 | reward: -0.2258 | rev_kl: 1.4267 | stu_lens: 66.5000 | mixed_lens: 52.0000 | lr: 2.7608e-06 | scale: 1024.00 | time: 26.690 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2393/  5000| tot_loss: 2.2978 | rl_loss: 0.4715 | pt_loss: 1.8262 | pg_loss: 0.0080 | reg_loss: 0.4635 | reward: -0.2047 | rev_kl: 0.8926 | stu_lens: 107.5000 | mixed_lens: 128.0000 | lr: 2.7592e-06 | scale: 1024.00 | time: 26.716 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2394/  5000| tot_loss: 2.7793 | rl_loss: 1.2453 | pt_loss: 1.5340 | pg_loss: 0.3857 | reg_loss: 0.8596 | reward: -0.2074 | rev_kl: 0.7793 | stu_lens: 43.5000 | mixed_lens: 77.5000 | lr: 2.7576e-06 | scale: 1024.00 | time: 26.698 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2395/  5000| tot_loss: 2.2332 | rl_loss: 0.6465 | pt_loss: 1.5867 | pg_loss: 0.0078 | reg_loss: 0.6387 | reward: -0.1188 | rev_kl: 1.3548 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.7560e-06 | scale: 1024.00 | time: 26.726 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2396/  5000| tot_loss: 3.0024 | rl_loss: 1.1480 | pt_loss: 1.8544 | pg_loss: 0.3680 | reg_loss: 0.7800 | reward: 1.4938 | rev_kl: 0.9118 | stu_lens: 61.0000 | mixed_lens: 61.0000 | lr: 2.7544e-06 | scale: 1024.00 | time: 26.685 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2397/  5000| tot_loss: 2.9714 | rl_loss: 0.9632 | pt_loss: 2.0082 | pg_loss: 0.2320 | reg_loss: 0.7312 | reward: -0.2047 | rev_kl: 0.8825 | stu_lens: 100.0000 | mixed_lens: 85.5000 | lr: 2.7528e-06 | scale: 1024.00 | time: 26.725 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2398/  5000| tot_loss: 2.8584 | rl_loss: 1.3172 | pt_loss: 1.5411 | pg_loss: 0.5374 | reg_loss: 0.7798 | reward: -0.2582 | rev_kl: 0.6936 | stu_lens: 62.5000 | mixed_lens: 73.5000 | lr: 2.7512e-06 | scale: 1024.00 | time: 26.665 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2399/  5000| tot_loss: 2.6864 | rl_loss: 0.9406 | pt_loss: 1.7457 | pg_loss: 0.0082 | reg_loss: 0.9325 | reward: -0.1624 | rev_kl: 0.6325 | stu_lens: 87.5000 | mixed_lens: 126.5000 | lr: 2.7496e-06 | scale: 1024.00 | time: 26.706 | step time: 0.000
                                 Evaluation #24                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Yes, Bob should leave Alice. The     │
│                                       │ chance of both of them surviving is  │
│                                       │ 31%, which is higher than the 9%     │
│                                       │ chance of Bob surviving if he leaves │
│                                       │ Alice.                               │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ It is a behavioral phenomenon        │
│                                       │ wherein letters that are located     │
│                                       │ adjacent to each other on a keyboard │
│                                       │ tend to be typed in the same order.  │
│                                       │ For example, mz kezboard tzpe z      │
│                                       │ instead of y and vice versa.         │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support over 150 languages.       │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.705 | exact_match: 0.323 | rev_kl: 1.192 | lens: 82.200 | pt_loss: 1.074 | lm_loss: 1.156 | kd_loss: 0.992 
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2400/  5000| tot_loss: 2.3209 | rl_loss: 0.5512 | pt_loss: 1.7697 | pg_loss: -0.0021 | reg_loss: 0.5533 | reward: -0.2218 | rev_kl: 0.9795 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.7480e-06 | scale: 1024.00 | time: 26.666 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2400/  5000| tot_loss: 2.8720 | rl_loss: 1.1154 | pt_loss: 1.7566 | pg_loss: 0.3312 | reg_loss: 0.7842 | reward: -0.3447 | rev_kl: 1.0537 | stu_lens: 86.3281 | mixed_lens: 87.5000 | lr: 2.7480e-06 | scale: 1024.00 | time: 26.666 | step time: 27.913
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2401/  5000| tot_loss: 2.7057 | rl_loss: 0.8511 | pt_loss: 1.8546 | pg_loss: 0.2704 | reg_loss: 0.5807 | reward: -0.0235 | rev_kl: 0.3070 | stu_lens: 41.5000 | mixed_lens: 50.5000 | lr: 2.7464e-06 | scale: 1024.00 | time: 26.722 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2402/  5000| tot_loss: 3.3603 | rl_loss: 2.1217 | pt_loss: 1.2386 | pg_loss: 1.1437 | reg_loss: 0.9780 | reward: -1.8708 | rev_kl: 0.5881 | stu_lens: 85.0000 | mixed_lens: 20.0000 | lr: 2.7448e-06 | scale: 1024.00 | time: 26.654 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2403/  5000| tot_loss: 1.9708 | rl_loss: 0.5588 | pt_loss: 1.4120 | pg_loss: 0.2826 | reg_loss: 0.2762 | reward: -0.2769 | rev_kl: 0.4743 | stu_lens: 103.5000 | mixed_lens: 88.0000 | lr: 2.7432e-06 | scale: 1024.00 | time: 26.686 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2404/  5000| tot_loss: 2.5492 | rl_loss: 0.8200 | pt_loss: 1.7292 | pg_loss: 0.2649 | reg_loss: 0.5552 | reward: -0.6538 | rev_kl: 1.1597 | stu_lens: 75.0000 | mixed_lens: 93.5000 | lr: 2.7417e-06 | scale: 1024.00 | time: 26.714 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2405/  5000| tot_loss: 2.5769 | rl_loss: 0.5637 | pt_loss: 2.0132 | pg_loss: 0.0413 | reg_loss: 0.5224 | reward: -0.1368 | rev_kl: 0.8706 | stu_lens: 115.5000 | mixed_lens: 128.0000 | lr: 2.7401e-06 | scale: 1024.00 | time: 26.692 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2406/  5000| tot_loss: 2.2883 | rl_loss: 0.6826 | pt_loss: 1.6057 | pg_loss: 0.1651 | reg_loss: 0.5175 | reward: -0.3445 | rev_kl: 0.6335 | stu_lens: 83.5000 | mixed_lens: 82.5000 | lr: 2.7385e-06 | scale: 1024.00 | time: 26.712 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2407/  5000| tot_loss: 1.9677 | rl_loss: 0.2867 | pt_loss: 1.6810 | pg_loss: 0.0273 | reg_loss: 0.2593 | reward: -0.0998 | rev_kl: 0.6719 | stu_lens: 128.0000 | mixed_lens: 119.0000 | lr: 2.7369e-06 | scale: 1024.00 | time: 26.692 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2408/  5000| tot_loss: 2.4210 | rl_loss: 0.7575 | pt_loss: 1.6635 | pg_loss: 0.1787 | reg_loss: 0.5788 | reward: -0.3430 | rev_kl: 1.0109 | stu_lens: 99.0000 | mixed_lens: 102.0000 | lr: 2.7353e-06 | scale: 1024.00 | time: 26.694 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2409/  5000| tot_loss: 2.9522 | rl_loss: 1.0582 | pt_loss: 1.8940 | pg_loss: 0.4424 | reg_loss: 0.6158 | reward: -0.4321 | rev_kl: 0.3510 | stu_lens: 57.5000 | mixed_lens: 87.0000 | lr: 2.7337e-06 | scale: 1024.00 | time: 26.695 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2410/  5000| tot_loss: 2.2311 | rl_loss: 0.6591 | pt_loss: 1.5720 | pg_loss: 0.3476 | reg_loss: 0.3115 | reward: -0.0994 | rev_kl: 0.4956 | stu_lens: 77.5000 | mixed_lens: 77.5000 | lr: 2.7321e-06 | scale: 1024.00 | time: 26.684 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2411/  5000| tot_loss: 2.8992 | rl_loss: 1.1501 | pt_loss: 1.7491 | pg_loss: 0.4841 | reg_loss: 0.6661 | reward: -0.2871 | rev_kl: 2.0843 | stu_lens: 77.0000 | mixed_lens: 78.5000 | lr: 2.7305e-06 | scale: 1024.00 | time: 26.684 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2412/  5000| tot_loss: 2.3290 | rl_loss: 0.7828 | pt_loss: 1.5462 | pg_loss: 0.1938 | reg_loss: 0.5889 | reward: -0.1950 | rev_kl: 1.2881 | stu_lens: 93.0000 | mixed_lens: 102.5000 | lr: 2.7289e-06 | scale: 1024.00 | time: 26.689 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2413/  5000| tot_loss: 2.5974 | rl_loss: 0.7080 | pt_loss: 1.8894 | pg_loss: 0.2652 | reg_loss: 0.4428 | reward: -0.7065 | rev_kl: 0.8469 | stu_lens: 77.5000 | mixed_lens: 80.5000 | lr: 2.7273e-06 | scale: 1024.00 | time: 26.675 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2414/  5000| tot_loss: 2.7902 | rl_loss: 0.8994 | pt_loss: 1.8908 | pg_loss: 0.2434 | reg_loss: 0.6560 | reward: 0.0184 | rev_kl: 0.4804 | stu_lens: 66.5000 | mixed_lens: 81.0000 | lr: 2.7257e-06 | scale: 1024.00 | time: 26.700 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2415/  5000| tot_loss: 2.9345 | rl_loss: 0.8476 | pt_loss: 2.0869 | pg_loss: 0.2449 | reg_loss: 0.6027 | reward: -0.5600 | rev_kl: 1.3476 | stu_lens: 94.0000 | mixed_lens: 95.0000 | lr: 2.7241e-06 | scale: 1024.00 | time: 26.685 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2416/  5000| tot_loss: 3.1457 | rl_loss: 1.3644 | pt_loss: 1.7813 | pg_loss: 0.5313 | reg_loss: 0.8331 | reward: -1.1734 | rev_kl: 1.4541 | stu_lens: 73.0000 | mixed_lens: 27.5000 | lr: 2.7225e-06 | scale: 1024.00 | time: 26.703 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2416/  5000| tot_loss: 2.7074 | rl_loss: 1.0178 | pt_loss: 1.6896 | pg_loss: 0.4926 | reg_loss: 0.5252 | reward: -0.3638 | rev_kl: 0.9520 | stu_lens: 80.7031 | mixed_lens: 82.8906 | lr: 2.7225e-06 | scale: 1024.00 | time: 26.703 | step time: 27.907
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2417/  5000| tot_loss: 2.2302 | rl_loss: 0.6078 | pt_loss: 1.6225 | pg_loss: 0.1232 | reg_loss: 0.4846 | reward: 1.4351 | rev_kl: 0.9904 | stu_lens: 52.5000 | mixed_lens: 65.0000 | lr: 2.7209e-06 | scale: 1024.00 | time: 26.683 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2418/  5000| tot_loss: 2.5110 | rl_loss: 0.8412 | pt_loss: 1.6698 | pg_loss: 0.3696 | reg_loss: 0.4716 | reward: -0.1609 | rev_kl: 0.9387 | stu_lens: 43.0000 | mixed_lens: 81.0000 | lr: 2.7193e-06 | scale: 1024.00 | time: 26.680 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2419/  5000| tot_loss: 1.4959 | rl_loss: 0.5420 | pt_loss: 0.9538 | pg_loss: 0.0173 | reg_loss: 0.5247 | reward: -0.3722 | rev_kl: 0.9989 | stu_lens: 102.5000 | mixed_lens: 128.0000 | lr: 2.7177e-06 | scale: 1024.00 | time: 26.687 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2420/  5000| tot_loss: 2.2272 | rl_loss: 0.5574 | pt_loss: 1.6698 | pg_loss: 0.2097 | reg_loss: 0.3477 | reward: -0.2731 | rev_kl: 1.4133 | stu_lens: 52.0000 | mixed_lens: 97.5000 | lr: 2.7161e-06 | scale: 1024.00 | time: 26.705 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2421/  5000| tot_loss: 1.6274 | rl_loss: 0.6816 | pt_loss: 0.9458 | pg_loss: 0.2411 | reg_loss: 0.4405 | reward: -0.5925 | rev_kl: 1.1015 | stu_lens: 91.5000 | mixed_lens: 93.5000 | lr: 2.7145e-06 | scale: 1024.00 | time: 26.698 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2422/  5000| tot_loss: 2.0083 | rl_loss: 0.5340 | pt_loss: 1.4743 | pg_loss: 0.1955 | reg_loss: 0.3384 | reward: -0.1647 | rev_kl: 1.9655 | stu_lens: 104.5000 | mixed_lens: 100.0000 | lr: 2.7129e-06 | scale: 1024.00 | time: 26.717 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2423/  5000| tot_loss: 2.1998 | rl_loss: 0.4849 | pt_loss: 1.7149 | pg_loss: 0.1327 | reg_loss: 0.3522 | reward: -0.3163 | rev_kl: 1.0884 | stu_lens: 72.5000 | mixed_lens: 90.5000 | lr: 2.7113e-06 | scale: 1024.00 | time: 26.693 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2424/  5000| tot_loss: 2.5895 | rl_loss: 0.5463 | pt_loss: 2.0432 | pg_loss: 0.2968 | reg_loss: 0.2495 | reward: -0.0700 | rev_kl: 0.1477 | stu_lens: 42.0000 | mixed_lens: 47.0000 | lr: 2.7097e-06 | scale: 1024.00 | time: 26.711 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2425/  5000| tot_loss: 3.1462 | rl_loss: 0.8194 | pt_loss: 2.3267 | pg_loss: 0.2283 | reg_loss: 0.5911 | reward: -0.6129 | rev_kl: 0.9143 | stu_lens: 87.5000 | mixed_lens: 73.0000 | lr: 2.7081e-06 | scale: 1024.00 | time: 26.737 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2426/  5000| tot_loss: 2.9060 | rl_loss: 0.9386 | pt_loss: 1.9674 | pg_loss: 0.2896 | reg_loss: 0.6490 | reward: -0.1413 | rev_kl: 1.2521 | stu_lens: 100.0000 | mixed_lens: 85.5000 | lr: 2.7065e-06 | scale: 1024.00 | time: 26.725 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2427/  5000| tot_loss: 2.3616 | rl_loss: 0.4906 | pt_loss: 1.8710 | pg_loss: 0.0219 | reg_loss: 0.4687 | reward: -0.0853 | rev_kl: 2.1204 | stu_lens: 116.0000 | mixed_lens: 123.5000 | lr: 2.7049e-06 | scale: 1024.00 | time: 26.696 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2428/  5000| tot_loss: 2.4230 | rl_loss: 0.7489 | pt_loss: 1.6741 | pg_loss: 0.3425 | reg_loss: 0.4064 | reward: -0.7490 | rev_kl: 1.3608 | stu_lens: 113.5000 | mixed_lens: 63.5000 | lr: 2.7033e-06 | scale: 1024.00 | time: 26.719 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2429/  5000| tot_loss: 2.7288 | rl_loss: 1.0258 | pt_loss: 1.7030 | pg_loss: 0.4347 | reg_loss: 0.5911 | reward: -0.6534 | rev_kl: 0.6616 | stu_lens: 61.5000 | mixed_lens: 83.0000 | lr: 2.7017e-06 | scale: 1024.00 | time: 26.698 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2430/  5000| tot_loss: 1.7521 | rl_loss: 0.2175 | pt_loss: 1.5346 | pg_loss: 0.0310 | reg_loss: 0.1865 | reward: -0.1513 | rev_kl: 0.7705 | stu_lens: 111.5000 | mixed_lens: 128.0000 | lr: 2.7001e-06 | scale: 1024.00 | time: 26.710 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2431/  5000| tot_loss: 2.2460 | rl_loss: 0.5767 | pt_loss: 1.6693 | pg_loss: 0.2569 | reg_loss: 0.3198 | reward: -0.6398 | rev_kl: 1.0269 | stu_lens: 69.5000 | mixed_lens: 91.0000 | lr: 2.6985e-06 | scale: 1024.00 | time: 26.729 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2432/  5000| tot_loss: 3.5445 | rl_loss: 1.6874 | pt_loss: 1.8570 | pg_loss: 1.2820 | reg_loss: 0.4055 | reward: -0.6910 | rev_kl: 0.5709 | stu_lens: 49.0000 | mixed_lens: 34.0000 | lr: 2.6969e-06 | scale: 1024.00 | time: 26.750 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2432/  5000| tot_loss: 2.3418 | rl_loss: 0.7143 | pt_loss: 1.6275 | pg_loss: 0.3014 | reg_loss: 0.4129 | reward: -0.2564 | rev_kl: 1.0200 | stu_lens: 82.8906 | mixed_lens: 84.9219 | lr: 2.6969e-06 | scale: 1024.00 | time: 26.750 | step time: 27.922
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2433/  5000| tot_loss: 2.9734 | rl_loss: 1.2175 | pt_loss: 1.7558 | pg_loss: 0.6524 | reg_loss: 0.5652 | reward: -0.2345 | rev_kl: 0.5722 | stu_lens: 37.0000 | mixed_lens: 59.0000 | lr: 2.6953e-06 | scale: 1024.00 | time: 26.719 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2434/  5000| tot_loss: 2.6769 | rl_loss: 0.9476 | pt_loss: 1.7293 | pg_loss: 0.0516 | reg_loss: 0.8961 | reward: -0.0592 | rev_kl: 1.0450 | stu_lens: 104.5000 | mixed_lens: 124.5000 | lr: 2.6938e-06 | scale: 1024.00 | time: 26.760 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2435/  5000| tot_loss: 3.0728 | rl_loss: 1.1974 | pt_loss: 1.8754 | pg_loss: 0.0373 | reg_loss: 1.1601 | reward: -0.2778 | rev_kl: 0.9020 | stu_lens: 127.0000 | mixed_lens: 128.0000 | lr: 2.6922e-06 | scale: 1024.00 | time: 26.706 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2436/  5000| tot_loss: 2.6694 | rl_loss: 1.2839 | pt_loss: 1.3854 | pg_loss: 0.3388 | reg_loss: 0.9451 | reward: -0.6500 | rev_kl: 0.6741 | stu_lens: 97.0000 | mixed_lens: 53.0000 | lr: 2.6906e-06 | scale: 1024.00 | time: 26.716 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2437/  5000| tot_loss: 2.6684 | rl_loss: 0.9690 | pt_loss: 1.6994 | pg_loss: 0.1158 | reg_loss: 0.8532 | reward: -0.2186 | rev_kl: 0.6710 | stu_lens: 128.0000 | mixed_lens: 114.5000 | lr: 2.6890e-06 | scale: 1024.00 | time: 26.804 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2438/  5000| tot_loss: 3.4425 | rl_loss: 1.4201 | pt_loss: 2.0224 | pg_loss: 0.4179 | reg_loss: 1.0022 | reward: -0.2458 | rev_kl: 0.6427 | stu_lens: 50.0000 | mixed_lens: 75.5000 | lr: 2.6874e-06 | scale: 1024.00 | time: 26.743 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2439/  5000| tot_loss: 2.7430 | rl_loss: 1.1288 | pt_loss: 1.6142 | pg_loss: 0.1179 | reg_loss: 1.0110 | reward: -0.3129 | rev_kl: 1.2246 | stu_lens: 60.0000 | mixed_lens: 119.0000 | lr: 2.6858e-06 | scale: 1024.00 | time: 26.763 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2440/  5000| tot_loss: 3.5368 | rl_loss: 2.1503 | pt_loss: 1.3866 | pg_loss: 0.6010 | reg_loss: 1.5493 | reward: -0.7648 | rev_kl: 1.3425 | stu_lens: 87.0000 | mixed_lens: 73.0000 | lr: 2.6842e-06 | scale: 1024.00 | time: 26.742 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2441/  5000| tot_loss: 3.5933 | rl_loss: 1.8104 | pt_loss: 1.7829 | pg_loss: 0.5677 | reg_loss: 1.2427 | reward: -0.8201 | rev_kl: 1.1453 | stu_lens: 20.5000 | mixed_lens: 66.0000 | lr: 2.6826e-06 | scale: 1024.00 | time: 26.777 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2442/  5000| tot_loss: 1.9198 | rl_loss: 0.9186 | pt_loss: 1.0012 | pg_loss: 0.1322 | reg_loss: 0.7865 | reward: -0.1807 | rev_kl: 0.9174 | stu_lens: 83.5000 | mixed_lens: 111.5000 | lr: 2.6810e-06 | scale: 1024.00 | time: 26.753 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2443/  5000| tot_loss: 2.7074 | rl_loss: 1.7160 | pt_loss: 0.9914 | pg_loss: 0.3477 | reg_loss: 1.3683 | reward: -0.5026 | rev_kl: 1.0943 | stu_lens: 83.5000 | mixed_lens: 61.5000 | lr: 2.6794e-06 | scale: 1024.00 | time: 26.771 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2444/  5000| tot_loss: 2.9356 | rl_loss: 1.3869 | pt_loss: 1.5488 | pg_loss: 0.0323 | reg_loss: 1.3545 | reward: -0.3620 | rev_kl: 0.9182 | stu_lens: 65.0000 | mixed_lens: 128.0000 | lr: 2.6778e-06 | scale: 1024.00 | time: 26.756 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2445/  5000| tot_loss: 3.0027 | rl_loss: 0.9338 | pt_loss: 2.0689 | pg_loss: 0.3115 | reg_loss: 0.6224 | reward: -0.0805 | rev_kl: 0.2895 | stu_lens: 86.5000 | mixed_lens: 93.5000 | lr: 2.6762e-06 | scale: 1024.00 | time: 26.777 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2446/  5000| tot_loss: 2.8868 | rl_loss: 1.5088 | pt_loss: 1.3780 | pg_loss: 0.7496 | reg_loss: 0.7592 | reward: -0.1708 | rev_kl: 1.2387 | stu_lens: 75.5000 | mixed_lens: 47.5000 | lr: 2.6746e-06 | scale: 1024.00 | time: 26.754 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2447/  5000| tot_loss: 4.2860 | rl_loss: 2.5131 | pt_loss: 1.7729 | pg_loss: 1.3612 | reg_loss: 1.1519 | reward: -0.6320 | rev_kl: 0.9238 | stu_lens: 25.5000 | mixed_lens: 27.5000 | lr: 2.6730e-06 | scale: 1024.00 | time: 26.769 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2448/  5000| tot_loss: 2.9344 | rl_loss: 1.6047 | pt_loss: 1.3297 | pg_loss: 0.5285 | reg_loss: 1.0762 | reward: -0.3834 | rev_kl: 1.1608 | stu_lens: 90.0000 | mixed_lens: 71.0000 | lr: 2.6714e-06 | scale: 1024.00 | time: 26.763 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2448/  5000| tot_loss: 3.1251 | rl_loss: 1.4697 | pt_loss: 1.6554 | pg_loss: 0.3970 | reg_loss: 1.0727 | reward: -0.3809 | rev_kl: 0.9377 | stu_lens: 73.4844 | mixed_lens: 79.2656 | lr: 2.6714e-06 | scale: 1024.00 | time: 26.763 | step time: 27.969
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2449/  5000| tot_loss: 4.4030 | rl_loss: 2.1024 | pt_loss: 2.3007 | pg_loss: 0.7840 | reg_loss: 1.3184 | reward: -1.9293 | rev_kl: 0.8916 | stu_lens: 41.0000 | mixed_lens: 53.5000 | lr: 2.6698e-06 | scale: 1024.00 | time: 26.746 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2450/  5000| tot_loss: 3.1403 | rl_loss: 1.5861 | pt_loss: 1.5542 | pg_loss: 0.5560 | reg_loss: 1.0302 | reward: -0.7297 | rev_kl: 0.9885 | stu_lens: 51.0000 | mixed_lens: 73.5000 | lr: 2.6682e-06 | scale: 1024.00 | time: 26.736 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2451/  5000| tot_loss: 4.1392 | rl_loss: 2.3541 | pt_loss: 1.7851 | pg_loss: 1.4050 | reg_loss: 0.9491 | reward: -0.9842 | rev_kl: 0.9418 | stu_lens: 45.0000 | mixed_lens: 25.5000 | lr: 2.6666e-06 | scale: 1024.00 | time: 26.693 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2452/  5000| tot_loss: 2.3694 | rl_loss: 0.8934 | pt_loss: 1.4761 | pg_loss: 0.2256 | reg_loss: 0.6677 | reward: -0.3500 | rev_kl: 0.8539 | stu_lens: 96.0000 | mixed_lens: 66.5000 | lr: 2.6650e-06 | scale: 1024.00 | time: 26.770 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2453/  5000| tot_loss: 1.8988 | rl_loss: 0.2158 | pt_loss: 1.6830 | pg_loss: 0.1028 | reg_loss: 0.1130 | reward: -0.4279 | rev_kl: 0.9595 | stu_lens: 65.5000 | mixed_lens: 74.0000 | lr: 2.6634e-06 | scale: 1024.00 | time: 26.790 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2454/  5000| tot_loss: 3.1218 | rl_loss: 1.1330 | pt_loss: 1.9888 | pg_loss: 0.6631 | reg_loss: 0.4699 | reward: -1.8223 | rev_kl: 0.8959 | stu_lens: 56.0000 | mixed_lens: 43.5000 | lr: 2.6618e-06 | scale: 1024.00 | time: 26.715 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2455/  5000| tot_loss: 2.9513 | rl_loss: 1.3182 | pt_loss: 1.6331 | pg_loss: 0.6371 | reg_loss: 0.6811 | reward: -0.1625 | rev_kl: 1.0345 | stu_lens: 29.0000 | mixed_lens: 61.5000 | lr: 2.6602e-06 | scale: 1024.00 | time: 26.736 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2456/  5000| tot_loss: 2.7178 | rl_loss: 1.4868 | pt_loss: 1.2311 | pg_loss: 0.6769 | reg_loss: 0.8099 | reward: -0.2447 | rev_kl: 0.9642 | stu_lens: 62.5000 | mixed_lens: 40.5000 | lr: 2.6586e-06 | scale: 1024.00 | time: 26.698 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2457/  5000| tot_loss: 2.1849 | rl_loss: 0.7848 | pt_loss: 1.4001 | pg_loss: 0.2551 | reg_loss: 0.5296 | reward: -0.4047 | rev_kl: 0.5411 | stu_lens: 60.5000 | mixed_lens: 91.0000 | lr: 2.6570e-06 | scale: 1024.00 | time: 26.731 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2458/  5000| tot_loss: 2.4917 | rl_loss: 0.8010 | pt_loss: 1.6907 | pg_loss: 0.3585 | reg_loss: 0.4425 | reward: -0.1674 | rev_kl: 0.4724 | stu_lens: 75.5000 | mixed_lens: 75.5000 | lr: 2.6554e-06 | scale: 1024.00 | time: 26.726 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2459/  5000| tot_loss: 2.5967 | rl_loss: 0.8418 | pt_loss: 1.7548 | pg_loss: 0.0276 | reg_loss: 0.8143 | reward: -0.2631 | rev_kl: 1.2141 | stu_lens: 102.5000 | mixed_lens: 128.0000 | lr: 2.6538e-06 | scale: 1024.00 | time: 26.755 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2460/  5000| tot_loss: 1.7719 | rl_loss: 0.1927 | pt_loss: 1.5791 | pg_loss: -0.0012 | reg_loss: 0.1940 | reward: -0.0226 | rev_kl: 0.5671 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6522e-06 | scale: 1024.00 | time: 26.725 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2461/  5000| tot_loss: 3.0384 | rl_loss: 1.2150 | pt_loss: 1.8234 | pg_loss: 0.1748 | reg_loss: 1.0402 | reward: -0.3229 | rev_kl: 1.6415 | stu_lens: 67.0000 | mixed_lens: 104.0000 | lr: 2.6506e-06 | scale: 1024.00 | time: 26.747 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2462/  5000| tot_loss: 3.3229 | rl_loss: 1.4968 | pt_loss: 1.8261 | pg_loss: 0.6723 | reg_loss: 0.8244 | reward: -0.6435 | rev_kl: 1.1745 | stu_lens: 80.5000 | mixed_lens: 67.0000 | lr: 2.6490e-06 | scale: 1024.00 | time: 26.712 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2463/  5000| tot_loss: 2.8450 | rl_loss: 1.0979 | pt_loss: 1.7471 | pg_loss: 0.2544 | reg_loss: 0.8436 | reward: -0.2970 | rev_kl: 0.8044 | stu_lens: 128.0000 | mixed_lens: 85.0000 | lr: 2.6474e-06 | scale: 1024.00 | time: 26.756 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2464/  5000| tot_loss: 3.1387 | rl_loss: 1.3946 | pt_loss: 1.7442 | pg_loss: 0.3791 | reg_loss: 1.0155 | reward: -0.7678 | rev_kl: 1.1856 | stu_lens: 87.0000 | mixed_lens: 84.0000 | lr: 2.6458e-06 | scale: 1024.00 | time: 26.709 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2464/  5000| tot_loss: 2.8405 | rl_loss: 1.1614 | pt_loss: 1.6792 | pg_loss: 0.3894 | reg_loss: 0.7720 | reward: -0.4830 | rev_kl: 0.9870 | stu_lens: 75.7656 | mixed_lens: 80.9219 | lr: 2.6458e-06 | scale: 1024.00 | time: 26.709 | step time: 27.948
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2465/  5000| tot_loss: 2.7163 | rl_loss: 0.8975 | pt_loss: 1.8188 | pg_loss: 0.3693 | reg_loss: 0.5282 | reward: -0.4375 | rev_kl: 0.6006 | stu_lens: 51.0000 | mixed_lens: 81.5000 | lr: 2.6442e-06 | scale: 1024.00 | time: 26.748 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2466/  5000| tot_loss: 2.6182 | rl_loss: 0.8934 | pt_loss: 1.7248 | pg_loss: 0.2844 | reg_loss: 0.6089 | reward: -0.3950 | rev_kl: 1.0248 | stu_lens: 90.0000 | mixed_lens: 71.0000 | lr: 2.6426e-06 | scale: 1024.00 | time: 26.731 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2467/  5000| tot_loss: 1.5779 | rl_loss: 0.2845 | pt_loss: 1.2934 | pg_loss: 0.0214 | reg_loss: 0.2631 | reward: -0.0455 | rev_kl: 0.4352 | stu_lens: 124.0000 | mixed_lens: 128.0000 | lr: 2.6410e-06 | scale: 1024.00 | time: 26.737 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2468/  5000| tot_loss: 2.6475 | rl_loss: 0.9356 | pt_loss: 1.7119 | pg_loss: 0.4023 | reg_loss: 0.5333 | reward: -0.3014 | rev_kl: 0.7360 | stu_lens: 30.0000 | mixed_lens: 75.5000 | lr: 2.6394e-06 | scale: 1024.00 | time: 26.728 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2469/  5000| tot_loss: 2.7120 | rl_loss: 1.0857 | pt_loss: 1.6263 | pg_loss: 0.1552 | reg_loss: 0.9305 | reward: -0.3630 | rev_kl: 1.0761 | stu_lens: 124.5000 | mixed_lens: 111.5000 | lr: 2.6378e-06 | scale: 1024.00 | time: 26.715 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2470/  5000| tot_loss: 2.9270 | rl_loss: 0.9472 | pt_loss: 1.9798 | pg_loss: 0.3771 | reg_loss: 0.5701 | reward: -0.3381 | rev_kl: 1.2992 | stu_lens: 114.0000 | mixed_lens: 90.0000 | lr: 2.6362e-06 | scale: 1024.00 | time: 26.694 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2471/  5000| tot_loss: 3.9775 | rl_loss: 1.9098 | pt_loss: 2.0677 | pg_loss: 1.6107 | reg_loss: 0.2991 | reward: -0.2304 | rev_kl: 0.2826 | stu_lens: 21.5000 | mixed_lens: 21.0000 | lr: 2.6346e-06 | scale: 1024.00 | time: 26.700 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2472/  5000| tot_loss: 2.9972 | rl_loss: 0.9665 | pt_loss: 2.0308 | pg_loss: 0.5345 | reg_loss: 0.4319 | reward: -0.7973 | rev_kl: 1.0919 | stu_lens: 38.0000 | mixed_lens: 52.0000 | lr: 2.6330e-06 | scale: 1024.00 | time: 26.698 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2473/  5000| tot_loss: 2.8567 | rl_loss: 1.1230 | pt_loss: 1.7338 | pg_loss: 0.7221 | reg_loss: 0.4008 | reward: -0.5341 | rev_kl: 0.9632 | stu_lens: 69.5000 | mixed_lens: 49.0000 | lr: 2.6314e-06 | scale: 1024.00 | time: 26.760 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2474/  5000| tot_loss: 2.4032 | rl_loss: 0.7495 | pt_loss: 1.6537 | pg_loss: 0.0103 | reg_loss: 0.7392 | reward: -0.1562 | rev_kl: 1.1888 | stu_lens: 51.0000 | mixed_lens: 126.0000 | lr: 2.6298e-06 | scale: 1024.00 | time: 26.732 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2475/  5000| tot_loss: 1.9668 | rl_loss: 0.3802 | pt_loss: 1.5866 | pg_loss: 0.0466 | reg_loss: 0.3336 | reward: -1.2367 | rev_kl: 0.3040 | stu_lens: 26.0000 | mixed_lens: 32.5000 | lr: 2.6282e-06 | scale: 1024.00 | time: 26.754 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2476/  5000| tot_loss: 3.0639 | rl_loss: 1.2411 | pt_loss: 1.8229 | pg_loss: 0.4114 | reg_loss: 0.8297 | reward: -0.7035 | rev_kl: 1.0391 | stu_lens: 94.0000 | mixed_lens: 89.5000 | lr: 2.6266e-06 | scale: 1024.00 | time: 26.735 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2477/  5000| tot_loss: 3.1611 | rl_loss: 1.0259 | pt_loss: 2.1351 | pg_loss: 0.7767 | reg_loss: 0.2493 | reward: -0.8477 | rev_kl: 0.9995 | stu_lens: 62.5000 | mixed_lens: 24.0000 | lr: 2.6250e-06 | scale: 1024.00 | time: 26.741 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2478/  5000| tot_loss: 1.7595 | rl_loss: 0.2058 | pt_loss: 1.5538 | pg_loss: 0.1286 | reg_loss: 0.0772 | reward: -1.6472 | rev_kl: 0.5787 | stu_lens: 70.0000 | mixed_lens: 70.5000 | lr: 2.6234e-06 | scale: 1024.00 | time: 26.724 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2479/  5000| tot_loss: 1.7785 | rl_loss: 0.5251 | pt_loss: 1.2534 | pg_loss: 0.0531 | reg_loss: 0.4720 | reward: -0.4185 | rev_kl: 1.0710 | stu_lens: 104.0000 | mixed_lens: 121.0000 | lr: 2.6218e-06 | scale: 1024.00 | time: 26.689 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2480/  5000| tot_loss: 2.6856 | rl_loss: 0.6430 | pt_loss: 2.0426 | pg_loss: 0.1311 | reg_loss: 0.5119 | reward: -0.3416 | rev_kl: 1.2892 | stu_lens: 96.0000 | mixed_lens: 96.5000 | lr: 2.6202e-06 | scale: 1024.00 | time: 26.714 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2480/  5000| tot_loss: 2.4755 | rl_loss: 0.7986 | pt_loss: 1.6769 | pg_loss: 0.3112 | reg_loss: 0.4874 | reward: -0.4063 | rev_kl: 0.9390 | stu_lens: 76.0469 | mixed_lens: 82.4844 | lr: 2.6202e-06 | scale: 1024.00 | time: 26.714 | step time: 27.939
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2481/  5000| tot_loss: 2.3757 | rl_loss: 0.6236 | pt_loss: 1.7521 | pg_loss: 0.2617 | reg_loss: 0.3619 | reward: -0.1703 | rev_kl: 0.4525 | stu_lens: 86.5000 | mixed_lens: 93.5000 | lr: 2.6186e-06 | scale: 1024.00 | time: 26.711 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2482/  5000| tot_loss: 1.9259 | rl_loss: 0.2100 | pt_loss: 1.7159 | pg_loss: -0.0106 | reg_loss: 0.2206 | reward: -0.1083 | rev_kl: 0.8450 | stu_lens: 58.0000 | mixed_lens: 128.0000 | lr: 2.6170e-06 | scale: 1024.00 | time: 26.681 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2483/  5000| tot_loss: 2.4912 | rl_loss: 0.6971 | pt_loss: 1.7940 | pg_loss: 0.2112 | reg_loss: 0.4859 | reward: -0.3282 | rev_kl: 1.1975 | stu_lens: 54.0000 | mixed_lens: 86.0000 | lr: 2.6154e-06 | scale: 1024.00 | time: 26.702 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2484/  5000| tot_loss: 2.5357 | rl_loss: 0.6687 | pt_loss: 1.8670 | pg_loss: 0.2443 | reg_loss: 0.4244 | reward: -0.6811 | rev_kl: 0.7246 | stu_lens: 97.0000 | mixed_lens: 49.5000 | lr: 2.6138e-06 | scale: 1024.00 | time: 26.679 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2485/  5000| tot_loss: 1.6848 | rl_loss: 0.2308 | pt_loss: 1.4540 | pg_loss: 0.0839 | reg_loss: 0.1470 | reward: -0.0679 | rev_kl: 0.1431 | stu_lens: 82.5000 | mixed_lens: 87.0000 | lr: 2.6122e-06 | scale: 1024.00 | time: 26.703 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2486/  5000| tot_loss: 2.2997 | rl_loss: 0.6686 | pt_loss: 1.6311 | pg_loss: 0.2481 | reg_loss: 0.4205 | reward: -0.2958 | rev_kl: 1.5369 | stu_lens: 73.5000 | mixed_lens: 104.0000 | lr: 2.6106e-06 | scale: 1024.00 | time: 26.674 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2487/  5000| tot_loss: 2.7103 | rl_loss: 0.8240 | pt_loss: 1.8863 | pg_loss: 0.3894 | reg_loss: 0.4346 | reward: -0.2170 | rev_kl: 0.9640 | stu_lens: 77.5000 | mixed_lens: 81.5000 | lr: 2.6090e-06 | scale: 1024.00 | time: 26.688 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2488/  5000| tot_loss: 1.8249 | rl_loss: 0.3896 | pt_loss: 1.4353 | pg_loss: 0.0155 | reg_loss: 0.3740 | reward: -0.2109 | rev_kl: 1.2144 | stu_lens: 82.5000 | mixed_lens: 128.0000 | lr: 2.6074e-06 | scale: 1024.00 | time: 26.678 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2489/  5000| tot_loss: 3.6226 | rl_loss: 1.8846 | pt_loss: 1.7380 | pg_loss: 1.4271 | reg_loss: 0.4575 | reward: -0.3142 | rev_kl: 1.2640 | stu_lens: 15.0000 | mixed_lens: 28.5000 | lr: 2.6058e-06 | scale: 1024.00 | time: 26.703 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2490/  5000| tot_loss: 1.7764 | rl_loss: 0.4370 | pt_loss: 1.3394 | pg_loss: 0.0351 | reg_loss: 0.4019 | reward: -0.2660 | rev_kl: 0.7538 | stu_lens: 124.5000 | mixed_lens: 128.0000 | lr: 2.6042e-06 | scale: 1024.00 | time: 26.705 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2491/  5000| tot_loss: 2.1369 | rl_loss: 0.6031 | pt_loss: 1.5338 | pg_loss: 0.0092 | reg_loss: 0.5940 | reward: -0.2618 | rev_kl: 1.0353 | stu_lens: 95.0000 | mixed_lens: 128.0000 | lr: 2.6026e-06 | scale: 1024.00 | time: 26.708 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2492/  5000| tot_loss: 1.9721 | rl_loss: 0.6546 | pt_loss: 1.3176 | pg_loss: 0.2365 | reg_loss: 0.4180 | reward: -0.2982 | rev_kl: 0.3968 | stu_lens: 55.5000 | mixed_lens: 93.5000 | lr: 2.6010e-06 | scale: 1024.00 | time: 26.688 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2493/  5000| tot_loss: 2.4067 | rl_loss: 0.3840 | pt_loss: 2.0227 | pg_loss: 0.0210 | reg_loss: 0.3630 | reward: -0.2389 | rev_kl: 0.7582 | stu_lens: 115.5000 | mixed_lens: 128.0000 | lr: 2.5994e-06 | scale: 1024.00 | time: 26.706 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2494/  5000| tot_loss: 2.7182 | rl_loss: 1.0395 | pt_loss: 1.6787 | pg_loss: 0.5058 | reg_loss: 0.5337 | reward: -0.4189 | rev_kl: 0.9129 | stu_lens: 73.0000 | mixed_lens: 67.0000 | lr: 2.5977e-06 | scale: 1024.00 | time: 26.682 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2495/  5000| tot_loss: 2.6015 | rl_loss: 1.0758 | pt_loss: 1.5256 | pg_loss: 0.5748 | reg_loss: 0.5010 | reward: -0.4411 | rev_kl: 0.8411 | stu_lens: 82.0000 | mixed_lens: 71.0000 | lr: 2.5961e-06 | scale: 1024.00 | time: 26.708 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2496/  5000| tot_loss: 2.4137 | rl_loss: 0.5683 | pt_loss: 1.8454 | pg_loss: 0.3902 | reg_loss: 0.1781 | reward: -0.1679 | rev_kl: 0.9492 | stu_lens: 75.5000 | mixed_lens: 71.5000 | lr: 2.5945e-06 | scale: 1024.00 | time: 26.682 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2496/  5000| tot_loss: 2.5550 | rl_loss: 0.8862 | pt_loss: 1.6688 | pg_loss: 0.4298 | reg_loss: 0.4564 | reward: -0.4629 | rev_kl: 0.9458 | stu_lens: 71.9844 | mixed_lens: 77.2812 | lr: 2.5945e-06 | scale: 1024.00 | time: 26.682 | step time: 27.908
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2497/  5000| tot_loss: 2.0698 | rl_loss: 0.7136 | pt_loss: 1.3562 | pg_loss: 0.4127 | reg_loss: 0.3010 | reward: -0.0957 | rev_kl: 1.1218 | stu_lens: 65.5000 | mixed_lens: 81.0000 | lr: 2.5929e-06 | scale: 1024.00 | time: 26.707 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2498/  5000| tot_loss: 3.5997 | rl_loss: 2.0662 | pt_loss: 1.5335 | pg_loss: 0.2198 | reg_loss: 1.8465 | reward: -0.2580 | rev_kl: 1.0104 | stu_lens: 106.0000 | mixed_lens: 106.5000 | lr: 2.5913e-06 | scale: 1024.00 | time: 26.724 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2499/  5000| tot_loss: 2.8859 | rl_loss: 1.4949 | pt_loss: 1.3910 | pg_loss: 0.3177 | reg_loss: 1.1772 | reward: -0.7093 | rev_kl: 1.2495 | stu_lens: 102.0000 | mixed_lens: 83.5000 | lr: 2.5897e-06 | scale: 1024.00 | time: 26.683 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/2500
                                 Evaluation #25                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Yes, Bob should leave Alice. The     │
│                                       │ reason is that his chances of        │
│                                       │ survival improve by 9%.              │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ mz kezboard tzpe z instead of y and  │
│                                       │ vice versa z because mz kezboard is  │
│                                       │ reverse of y                         │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support over 100 languages.       │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.422 | exact_match: 0.215 | rev_kl: 1.102 | lens: 85.076 | pt_loss: 1.074 | lm_loss: 1.156 | kd_loss: 0.992 
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2500/  5000| tot_loss: 2.9328 | rl_loss: 0.8881 | pt_loss: 2.0447 | pg_loss: 0.1201 | reg_loss: 0.7681 | reward: -0.1864 | rev_kl: 0.5298 | stu_lens: 92.0000 | mixed_lens: 114.0000 | lr: 2.5881e-06 | scale: 1024.00 | time: 26.707 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2501/  5000| tot_loss: 3.4459 | rl_loss: 1.4804 | pt_loss: 1.9655 | pg_loss: 0.2955 | reg_loss: 1.1848 | reward: -0.3456 | rev_kl: 1.7189 | stu_lens: 84.0000 | mixed_lens: 32.5000 | lr: 2.5865e-06 | scale: 1024.00 | time: 26.917 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2502/  5000| tot_loss: 3.0865 | rl_loss: 1.0140 | pt_loss: 2.0725 | pg_loss: 0.1649 | reg_loss: 0.8491 | reward: -0.2600 | rev_kl: 0.8103 | stu_lens: 81.0000 | mixed_lens: 104.0000 | lr: 2.5849e-06 | scale: 1024.00 | time: 26.923 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2503/  5000| tot_loss: 2.9698 | rl_loss: 1.0758 | pt_loss: 1.8940 | pg_loss: 0.3106 | reg_loss: 0.7652 | reward: -0.3504 | rev_kl: 0.7945 | stu_lens: 107.5000 | mixed_lens: 89.5000 | lr: 2.5833e-06 | scale: 1024.00 | time: 26.875 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2504/  5000| tot_loss: 4.5023 | rl_loss: 2.8063 | pt_loss: 1.6960 | pg_loss: 1.0179 | reg_loss: 1.7884 | reward: -0.8832 | rev_kl: 1.4290 | stu_lens: 49.5000 | mixed_lens: 49.0000 | lr: 2.5817e-06 | scale: 1024.00 | time: 26.905 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2505/  5000| tot_loss: 3.9554 | rl_loss: 2.2259 | pt_loss: 1.7295 | pg_loss: 0.8463 | reg_loss: 1.3796 | reward: -0.5541 | rev_kl: 1.0942 | stu_lens: 98.5000 | mixed_lens: 44.0000 | lr: 2.5801e-06 | scale: 1024.00 | time: 26.848 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2506/  5000| tot_loss: 3.8069 | rl_loss: 1.4345 | pt_loss: 2.3724 | pg_loss: 0.5340 | reg_loss: 0.9006 | reward: -0.1790 | rev_kl: 1.0533 | stu_lens: 69.0000 | mixed_lens: 68.0000 | lr: 2.5785e-06 | scale: 1024.00 | time: 26.856 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2507/  5000| tot_loss: 3.5136 | rl_loss: 1.6021 | pt_loss: 1.9115 | pg_loss: 0.7437 | reg_loss: 0.8584 | reward: -0.6435 | rev_kl: 0.5766 | stu_lens: 21.0000 | mixed_lens: 16.5000 | lr: 2.5769e-06 | scale: 1024.00 | time: 26.832 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2508/  5000| tot_loss: 2.1578 | rl_loss: 1.1772 | pt_loss: 0.9806 | pg_loss: 0.0871 | reg_loss: 1.0901 | reward: -0.2104 | rev_kl: 2.1193 | stu_lens: 91.0000 | mixed_lens: 128.0000 | lr: 2.5753e-06 | scale: 1024.00 | time: 26.909 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2509/  5000| tot_loss: 3.0436 | rl_loss: 1.5387 | pt_loss: 1.5050 | pg_loss: 0.9135 | reg_loss: 0.6251 | reward: -0.2232 | rev_kl: 1.1780 | stu_lens: 44.0000 | mixed_lens: 49.0000 | lr: 2.5737e-06 | scale: 1024.00 | time: 26.705 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2510/  5000| tot_loss: 3.6631 | rl_loss: 1.8797 | pt_loss: 1.7834 | pg_loss: 0.6602 | reg_loss: 1.2195 | reward: -0.5523 | rev_kl: 1.1301 | stu_lens: 77.5000 | mixed_lens: 58.5000 | lr: 2.5721e-06 | scale: 1024.00 | time: 26.707 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2511/  5000| tot_loss: 3.2648 | rl_loss: 1.6597 | pt_loss: 1.6051 | pg_loss: 0.4586 | reg_loss: 1.2011 | reward: -0.3731 | rev_kl: 6.6009 | stu_lens: 65.0000 | mixed_lens: 73.0000 | lr: 2.5705e-06 | scale: 1024.00 | time: 26.713 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2512/  5000| tot_loss: 3.5040 | rl_loss: 1.6589 | pt_loss: 1.8450 | pg_loss: 0.4084 | reg_loss: 1.2505 | reward: -0.4689 | rev_kl: 0.5551 | stu_lens: 65.5000 | mixed_lens: 97.0000 | lr: 2.5689e-06 | scale: 1024.00 | time: 26.710 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2512/  5000| tot_loss: 3.2377 | rl_loss: 1.5536 | pt_loss: 1.6841 | pg_loss: 0.4213 | reg_loss: 1.1322 | reward: -0.3431 | rev_kl: 1.3900 | stu_lens: 80.1719 | mixed_lens: 78.4062 | lr: 2.5689e-06 | scale: 1024.00 | time: 26.710 | step time: 28.008
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2513/  5000| tot_loss: 3.5812 | rl_loss: 1.9775 | pt_loss: 1.6037 | pg_loss: 0.2809 | reg_loss: 1.6966 | reward: -0.6295 | rev_kl: 1.1664 | stu_lens: 111.0000 | mixed_lens: 82.5000 | lr: 2.5673e-06 | scale: 1024.00 | time: 26.713 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2514/  5000| tot_loss: 2.8045 | rl_loss: 1.3629 | pt_loss: 1.4415 | pg_loss: 0.5955 | reg_loss: 0.7674 | reward: -0.6469 | rev_kl: 0.7313 | stu_lens: 81.5000 | mixed_lens: 73.0000 | lr: 2.5657e-06 | scale: 1024.00 | time: 26.700 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2515/  5000| tot_loss: 3.3867 | rl_loss: 1.4543 | pt_loss: 1.9324 | pg_loss: 0.3639 | reg_loss: 1.0903 | reward: -0.4159 | rev_kl: 0.6758 | stu_lens: 34.5000 | mixed_lens: 71.5000 | lr: 2.5641e-06 | scale: 1024.00 | time: 26.727 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2516/  5000| tot_loss: 2.5630 | rl_loss: 0.8587 | pt_loss: 1.7044 | pg_loss: 0.1630 | reg_loss: 0.6957 | reward: -0.3836 | rev_kl: 1.2139 | stu_lens: 115.0000 | mixed_lens: 95.0000 | lr: 2.5625e-06 | scale: 1024.00 | time: 26.710 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2517/  5000| tot_loss: 3.2142 | rl_loss: 1.3756 | pt_loss: 1.8386 | pg_loss: 0.3608 | reg_loss: 1.0148 | reward: -0.1957 | rev_kl: 1.2051 | stu_lens: 55.0000 | mixed_lens: 82.0000 | lr: 2.5609e-06 | scale: 1024.00 | time: 26.703 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2518/  5000| tot_loss: 3.1304 | rl_loss: 1.3564 | pt_loss: 1.7740 | pg_loss: 0.6550 | reg_loss: 0.7015 | reward: -0.3641 | rev_kl: 6.6269 | stu_lens: 76.5000 | mixed_lens: 54.0000 | lr: 2.5593e-06 | scale: 1024.00 | time: 26.713 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2519/  5000| tot_loss: 3.2662 | rl_loss: 1.5947 | pt_loss: 1.6715 | pg_loss: 0.2402 | reg_loss: 1.3545 | reward: -0.7295 | rev_kl: 1.4615 | stu_lens: 75.5000 | mixed_lens: 89.5000 | lr: 2.5577e-06 | scale: 1024.00 | time: 26.718 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2520/  5000| tot_loss: 3.0840 | rl_loss: 1.2543 | pt_loss: 1.8297 | pg_loss: 0.4395 | reg_loss: 0.8148 | reward: -0.5428 | rev_kl: 1.4746 | stu_lens: 79.5000 | mixed_lens: 63.0000 | lr: 2.5561e-06 | scale: 1024.00 | time: 26.719 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2521/  5000| tot_loss: 2.7915 | rl_loss: 1.0589 | pt_loss: 1.7326 | pg_loss: 0.5263 | reg_loss: 0.5326 | reward: -0.0445 | rev_kl: 0.8483 | stu_lens: 55.5000 | mixed_lens: 37.5000 | lr: 2.5545e-06 | scale: 1024.00 | time: 26.745 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2522/  5000| tot_loss: 2.7107 | rl_loss: 1.0922 | pt_loss: 1.6185 | pg_loss: 0.1363 | reg_loss: 0.9559 | reward: -0.2483 | rev_kl: 1.2497 | stu_lens: 115.5000 | mixed_lens: 112.5000 | lr: 2.5529e-06 | scale: 1024.00 | time: 26.696 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2523/  5000| tot_loss: 2.6100 | rl_loss: 0.8306 | pt_loss: 1.7794 | pg_loss: 0.1889 | reg_loss: 0.6417 | reward: -0.2373 | rev_kl: 1.1224 | stu_lens: 100.0000 | mixed_lens: 97.5000 | lr: 2.5513e-06 | scale: 1024.00 | time: 26.744 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2524/  5000| tot_loss: 2.3969 | rl_loss: 0.9580 | pt_loss: 1.4389 | pg_loss: 0.1991 | reg_loss: 0.7589 | reward: -0.2490 | rev_kl: 2.0764 | stu_lens: 114.0000 | mixed_lens: 97.5000 | lr: 2.5497e-06 | scale: 1024.00 | time: 26.728 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2525/  5000| tot_loss: 2.6178 | rl_loss: 0.8579 | pt_loss: 1.7600 | pg_loss: 0.1472 | reg_loss: 0.7106 | reward: -0.4324 | rev_kl: 1.1895 | stu_lens: 77.0000 | mixed_lens: 111.0000 | lr: 2.5481e-06 | scale: 1024.00 | time: 26.748 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2526/  5000| tot_loss: 3.4767 | rl_loss: 1.7923 | pt_loss: 1.6844 | pg_loss: 0.7444 | reg_loss: 1.0479 | reward: -0.7106 | rev_kl: 1.1067 | stu_lens: 70.0000 | mixed_lens: 56.5000 | lr: 2.5465e-06 | scale: 1024.00 | time: 26.701 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2527/  5000| tot_loss: 2.9757 | rl_loss: 1.1232 | pt_loss: 1.8525 | pg_loss: 0.3594 | reg_loss: 0.7638 | reward: -0.2618 | rev_kl: 1.1620 | stu_lens: 107.5000 | mixed_lens: 74.0000 | lr: 2.5449e-06 | scale: 1024.00 | time: 26.727 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2528/  5000| tot_loss: 2.8196 | rl_loss: 0.9995 | pt_loss: 1.8202 | pg_loss: 0.3861 | reg_loss: 0.6134 | reward: -0.5617 | rev_kl: 4.0278 | stu_lens: 71.5000 | mixed_lens: 75.0000 | lr: 2.5433e-06 | scale: 1024.00 | time: 26.698 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2528/  5000| tot_loss: 2.7320 | rl_loss: 1.0974 | pt_loss: 1.6346 | pg_loss: 0.2898 | reg_loss: 0.8076 | reward: -0.3373 | rev_kl: 1.3808 | stu_lens: 81.4219 | mixed_lens: 80.5625 | lr: 2.5433e-06 | scale: 1024.00 | time: 26.698 | step time: 27.929
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2529/  5000| tot_loss: 3.1423 | rl_loss: 1.2275 | pt_loss: 1.9148 | pg_loss: 0.4898 | reg_loss: 0.7377 | reward: -0.2923 | rev_kl: 1.3274 | stu_lens: 85.5000 | mixed_lens: 64.0000 | lr: 2.5417e-06 | scale: 1024.00 | time: 26.743 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2530/  5000| tot_loss: 2.7713 | rl_loss: 1.0148 | pt_loss: 1.7565 | pg_loss: 0.6552 | reg_loss: 0.3596 | reward: -0.0777 | rev_kl: 6.4131 | stu_lens: 93.0000 | mixed_lens: 43.0000 | lr: 2.5401e-06 | scale: 1024.00 | time: 26.747 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2531/  5000| tot_loss: 2.6061 | rl_loss: 0.9017 | pt_loss: 1.7044 | pg_loss: 0.4779 | reg_loss: 0.4238 | reward: -0.4275 | rev_kl: 0.9339 | stu_lens: 98.5000 | mixed_lens: 71.0000 | lr: 2.5385e-06 | scale: 1024.00 | time: 26.754 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2532/  5000| tot_loss: 2.8201 | rl_loss: 0.9906 | pt_loss: 1.8295 | pg_loss: 0.4621 | reg_loss: 0.5285 | reward: -0.6272 | rev_kl: 1.4204 | stu_lens: 28.5000 | mixed_lens: 65.5000 | lr: 2.5369e-06 | scale: 1024.00 | time: 26.702 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2533/  5000| tot_loss: 2.1654 | rl_loss: 0.5753 | pt_loss: 1.5901 | pg_loss: 0.1594 | reg_loss: 0.4159 | reward: -0.2652 | rev_kl: 0.7782 | stu_lens: 65.5000 | mixed_lens: 104.0000 | lr: 2.5353e-06 | scale: 1024.00 | time: 26.721 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2534/  5000| tot_loss: 2.1030 | rl_loss: 0.8400 | pt_loss: 1.2630 | pg_loss: 0.4880 | reg_loss: 0.3520 | reward: -0.4899 | rev_kl: 0.6647 | stu_lens: 64.0000 | mixed_lens: 59.0000 | lr: 2.5337e-06 | scale: 1024.00 | time: 26.701 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2535/  5000| tot_loss: 3.0107 | rl_loss: 1.0257 | pt_loss: 1.9850 | pg_loss: 0.3414 | reg_loss: 0.6843 | reward: -0.4171 | rev_kl: 1.5353 | stu_lens: 50.0000 | mixed_lens: 89.5000 | lr: 2.5321e-06 | scale: 1024.00 | time: 26.737 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2536/  5000| tot_loss: 2.3611 | rl_loss: 0.8309 | pt_loss: 1.5302 | pg_loss: 0.1938 | reg_loss: 0.6370 | reward: -0.2129 | rev_kl: 1.1927 | stu_lens: 115.5000 | mixed_lens: 105.5000 | lr: 2.5305e-06 | scale: 1024.00 | time: 26.722 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2537/  5000| tot_loss: 2.6481 | rl_loss: 1.1599 | pt_loss: 1.4882 | pg_loss: 0.6450 | reg_loss: 0.5149 | reward: -0.2795 | rev_kl: 0.8570 | stu_lens: 88.5000 | mixed_lens: 61.0000 | lr: 2.5289e-06 | scale: 1024.00 | time: 26.720 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2538/  5000| tot_loss: 2.0866 | rl_loss: 0.3780 | pt_loss: 1.7086 | pg_loss: 0.0582 | reg_loss: 0.3198 | reward: -0.2319 | rev_kl: 0.8578 | stu_lens: 128.0000 | mixed_lens: 118.5000 | lr: 2.5272e-06 | scale: 1024.00 | time: 26.695 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2539/  5000| tot_loss: 2.1644 | rl_loss: 0.5768 | pt_loss: 1.5876 | pg_loss: 0.2227 | reg_loss: 0.3540 | reward: -0.3596 | rev_kl: 0.7750 | stu_lens: 128.0000 | mixed_lens: 83.5000 | lr: 2.5256e-06 | scale: 1024.00 | time: 26.737 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2540/  5000| tot_loss: 2.9950 | rl_loss: 1.1738 | pt_loss: 1.8212 | pg_loss: 0.4327 | reg_loss: 0.7410 | reward: -0.3178 | rev_kl: 2.3333 | stu_lens: 71.5000 | mixed_lens: 63.0000 | lr: 2.5240e-06 | scale: 1024.00 | time: 26.700 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2541/  5000| tot_loss: 1.8970 | rl_loss: 0.5790 | pt_loss: 1.3180 | pg_loss: 0.1238 | reg_loss: 0.4551 | reward: -0.2096 | rev_kl: 0.9966 | stu_lens: 118.0000 | mixed_lens: 106.5000 | lr: 2.5224e-06 | scale: 1024.00 | time: 26.725 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2542/  5000| tot_loss: 2.7143 | rl_loss: 0.9975 | pt_loss: 1.7168 | pg_loss: 0.1003 | reg_loss: 0.8972 | reward: -0.2772 | rev_kl: 0.6883 | stu_lens: 70.0000 | mixed_lens: 114.0000 | lr: 2.5208e-06 | scale: 1024.00 | time: 26.737 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2543/  5000| tot_loss: 2.5807 | rl_loss: 0.7021 | pt_loss: 1.8786 | pg_loss: 0.0731 | reg_loss: 0.6291 | reward: -0.2331 | rev_kl: 1.1982 | stu_lens: 128.0000 | mixed_lens: 112.5000 | lr: 2.5192e-06 | scale: 1024.00 | time: 26.728 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2544/  5000| tot_loss: 2.5326 | rl_loss: 0.9900 | pt_loss: 1.5426 | pg_loss: 0.4406 | reg_loss: 0.5494 | reward: -0.2869 | rev_kl: 1.5813 | stu_lens: 52.0000 | mixed_lens: 75.0000 | lr: 2.5176e-06 | scale: 1024.00 | time: 26.705 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2544/  5000| tot_loss: 2.6003 | rl_loss: 0.9329 | pt_loss: 1.6673 | pg_loss: 0.3657 | reg_loss: 0.5672 | reward: -0.3750 | rev_kl: 1.4126 | stu_lens: 79.2031 | mixed_lens: 76.8594 | lr: 2.5176e-06 | scale: 1024.00 | time: 26.705 | step time: 27.935
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2545/  5000| tot_loss: 2.0159 | rl_loss: 0.8735 | pt_loss: 1.1424 | pg_loss: 0.4652 | reg_loss: 0.4083 | reward: -0.4705 | rev_kl: 0.8498 | stu_lens: 103.0000 | mixed_lens: 77.0000 | lr: 2.5160e-06 | scale: 1024.00 | time: 26.726 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2546/  5000| tot_loss: 3.1869 | rl_loss: 1.1575 | pt_loss: 2.0294 | pg_loss: 0.5221 | reg_loss: 0.6353 | reward: -0.7194 | rev_kl: 1.0719 | stu_lens: 73.5000 | mixed_lens: 58.0000 | lr: 2.5144e-06 | scale: 1024.00 | time: 26.705 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2547/  5000| tot_loss: 2.1381 | rl_loss: 0.8196 | pt_loss: 1.3186 | pg_loss: 0.2446 | reg_loss: 0.5750 | reward: -0.2460 | rev_kl: 1.2799 | stu_lens: 73.5000 | mixed_lens: 99.5000 | lr: 2.5128e-06 | scale: 1024.00 | time: 26.762 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2548/  5000| tot_loss: 2.5988 | rl_loss: 0.7809 | pt_loss: 1.8179 | pg_loss: 0.4717 | reg_loss: 0.3092 | reward: -0.5733 | rev_kl: 0.7972 | stu_lens: 90.0000 | mixed_lens: 83.0000 | lr: 2.5112e-06 | scale: 1024.00 | time: 26.747 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2549/  5000| tot_loss: 2.8175 | rl_loss: 0.8555 | pt_loss: 1.9620 | pg_loss: 0.3922 | reg_loss: 0.4633 | reward: -0.3990 | rev_kl: 1.0285 | stu_lens: 94.0000 | mixed_lens: 88.5000 | lr: 2.5096e-06 | scale: 1024.00 | time: 26.764 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2550/  5000| tot_loss: 2.0998 | rl_loss: 0.7104 | pt_loss: 1.3894 | pg_loss: 0.2801 | reg_loss: 0.4303 | reward: -0.2956 | rev_kl: 1.5501 | stu_lens: 96.5000 | mixed_lens: 86.0000 | lr: 2.5080e-06 | scale: 1024.00 | time: 26.748 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2551/  5000| tot_loss: 2.5549 | rl_loss: 0.9826 | pt_loss: 1.5723 | pg_loss: 0.6941 | reg_loss: 0.2884 | reward: -0.4730 | rev_kl: 1.2824 | stu_lens: 24.0000 | mixed_lens: 29.0000 | lr: 2.5064e-06 | scale: 1024.00 | time: 26.768 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2552/  5000| tot_loss: 2.5390 | rl_loss: 0.8345 | pt_loss: 1.7045 | pg_loss: 0.4281 | reg_loss: 0.4064 | reward: -0.5070 | rev_kl: 0.8726 | stu_lens: 77.0000 | mixed_lens: 54.0000 | lr: 2.5048e-06 | scale: 1024.00 | time: 26.744 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2553/  5000| tot_loss: 2.0703 | rl_loss: 0.5052 | pt_loss: 1.5651 | pg_loss: 0.1373 | reg_loss: 0.3679 | reward: -0.1412 | rev_kl: 1.0325 | stu_lens: 123.5000 | mixed_lens: 102.5000 | lr: 2.5032e-06 | scale: 1024.00 | time: 26.737 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2554/  5000| tot_loss: 2.2388 | rl_loss: 0.4637 | pt_loss: 1.7751 | pg_loss: 0.2567 | reg_loss: 0.2070 | reward: -0.2826 | rev_kl: 0.9190 | stu_lens: 88.5000 | mixed_lens: 92.0000 | lr: 2.5016e-06 | scale: 1024.00 | time: 26.721 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2555/  5000| tot_loss: 2.5625 | rl_loss: 1.0765 | pt_loss: 1.4860 | pg_loss: 0.3298 | reg_loss: 0.7467 | reward: -0.1754 | rev_kl: 1.0517 | stu_lens: 60.0000 | mixed_lens: 82.0000 | lr: 2.5000e-06 | scale: 1024.00 | time: 26.736 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2556/  5000| tot_loss: 2.5165 | rl_loss: 1.0643 | pt_loss: 1.4522 | pg_loss: 0.5444 | reg_loss: 0.5200 | reward: -0.8077 | rev_kl: 1.4571 | stu_lens: 89.0000 | mixed_lens: 65.5000 | lr: 2.4984e-06 | scale: 1024.00 | time: 26.710 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2557/  5000| tot_loss: 2.2468 | rl_loss: 0.4058 | pt_loss: 1.8410 | pg_loss: -0.0607 | reg_loss: 0.4664 | reward: -0.5906 | rev_kl: 1.5456 | stu_lens: 87.5000 | mixed_lens: 31.0000 | lr: 2.4968e-06 | scale: 1024.00 | time: 26.784 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2558/  5000| tot_loss: 2.8103 | rl_loss: 0.7949 | pt_loss: 2.0153 | pg_loss: 0.3683 | reg_loss: 0.4267 | reward: -0.1895 | rev_kl: 1.0147 | stu_lens: 78.5000 | mixed_lens: 84.5000 | lr: 2.4952e-06 | scale: 1024.00 | time: 26.752 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2559/  5000| tot_loss: 1.9681 | rl_loss: 0.6859 | pt_loss: 1.2822 | pg_loss: 0.0635 | reg_loss: 0.6224 | reward: -0.2919 | rev_kl: 2.3548 | stu_lens: 69.0000 | mixed_lens: 112.0000 | lr: 2.4936e-06 | scale: 1024.00 | time: 26.782 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2560/  5000| tot_loss: 2.0486 | rl_loss: 0.3911 | pt_loss: 1.6575 | pg_loss: 0.2294 | reg_loss: 0.1617 | reward: -0.3352 | rev_kl: 0.9818 | stu_lens: 85.5000 | mixed_lens: 89.5000 | lr: 2.4920e-06 | scale: 1024.00 | time: 26.749 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2560/  5000| tot_loss: 2.5280 | rl_loss: 0.7814 | pt_loss: 1.7467 | pg_loss: 0.3510 | reg_loss: 0.4303 | reward: -0.3516 | rev_kl: 1.3822 | stu_lens: 82.0781 | mixed_lens: 76.2656 | lr: 2.4920e-06 | scale: 1024.00 | time: 26.749 | step time: 27.957
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2561/  5000| tot_loss: 2.7114 | rl_loss: 0.6140 | pt_loss: 2.0974 | pg_loss: 0.1859 | reg_loss: 0.4281 | reward: -0.1595 | rev_kl: 0.8164 | stu_lens: 90.5000 | mixed_lens: 108.0000 | lr: 2.4904e-06 | scale: 1024.00 | time: 26.790 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2562/  5000| tot_loss: 3.9204 | rl_loss: 2.0395 | pt_loss: 1.8809 | pg_loss: 0.3630 | reg_loss: 1.6764 | reward: -0.4539 | rev_kl: 1.1340 | stu_lens: 79.5000 | mixed_lens: 96.0000 | lr: 2.4888e-06 | scale: 1024.00 | time: 26.748 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2563/  5000| tot_loss: 2.5514 | rl_loss: 1.3770 | pt_loss: 1.1745 | pg_loss: 0.4993 | reg_loss: 0.8776 | reward: -0.1217 | rev_kl: 1.1905 | stu_lens: 92.5000 | mixed_lens: 83.0000 | lr: 2.4872e-06 | scale: 1024.00 | time: 26.751 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2564/  5000| tot_loss: 3.6105 | rl_loss: 1.9267 | pt_loss: 1.6838 | pg_loss: 0.8511 | reg_loss: 1.0756 | reward: -0.4441 | rev_kl: 0.3953 | stu_lens: 67.5000 | mixed_lens: 50.5000 | lr: 2.4856e-06 | scale: 1024.00 | time: 26.746 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2565/  5000| tot_loss: 4.4101 | rl_loss: 2.5335 | pt_loss: 1.8766 | pg_loss: 1.2113 | reg_loss: 1.3223 | reward: -0.9955 | rev_kl: 0.7410 | stu_lens: 75.5000 | mixed_lens: 41.0000 | lr: 2.4840e-06 | scale: 1024.00 | time: 26.776 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2566/  5000| tot_loss: 3.4768 | rl_loss: 2.0039 | pt_loss: 1.4729 | pg_loss: 0.4157 | reg_loss: 1.5882 | reward: -1.1098 | rev_kl: 1.4201 | stu_lens: 53.5000 | mixed_lens: 88.0000 | lr: 2.4824e-06 | scale: 1024.00 | time: 26.807 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2567/  5000| tot_loss: 3.2817 | rl_loss: 1.9239 | pt_loss: 1.3578 | pg_loss: 0.1727 | reg_loss: 1.7512 | reward: -0.4453 | rev_kl: 1.0987 | stu_lens: 117.0000 | mixed_lens: 115.5000 | lr: 2.4808e-06 | scale: 1024.00 | time: 26.792 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2568/  5000| tot_loss: 2.9826 | rl_loss: 1.3006 | pt_loss: 1.6820 | pg_loss: 0.2160 | reg_loss: 1.0846 | reward: -0.3242 | rev_kl: 1.0732 | stu_lens: 85.5000 | mixed_lens: 98.5000 | lr: 2.4792e-06 | scale: 1024.00 | time: 26.769 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2569/  5000| tot_loss: 3.2226 | rl_loss: 1.6299 | pt_loss: 1.5927 | pg_loss: 0.4606 | reg_loss: 1.1693 | reward: 0.3520 | rev_kl: 1.7612 | stu_lens: 63.0000 | mixed_lens: 69.5000 | lr: 2.4776e-06 | scale: 1024.00 | time: 26.779 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2570/  5000| tot_loss: 3.0640 | rl_loss: 1.5838 | pt_loss: 1.4802 | pg_loss: 0.3196 | reg_loss: 1.2642 | reward: -0.3677 | rev_kl: 0.9056 | stu_lens: 93.0000 | mixed_lens: 90.0000 | lr: 2.4760e-06 | scale: 1024.00 | time: 26.775 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2571/  5000| tot_loss: 3.3000 | rl_loss: 1.9879 | pt_loss: 1.3121 | pg_loss: 0.4928 | reg_loss: 1.4951 | reward: -0.0790 | rev_kl: 1.1956 | stu_lens: 49.0000 | mixed_lens: 71.0000 | lr: 2.4744e-06 | scale: 1024.00 | time: 26.793 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2572/  5000| tot_loss: 3.1996 | rl_loss: 1.3886 | pt_loss: 1.8110 | pg_loss: 0.2719 | reg_loss: 1.1167 | reward: -0.3540 | rev_kl: 1.4946 | stu_lens: 99.5000 | mixed_lens: 100.0000 | lr: 2.4728e-06 | scale: 1024.00 | time: 26.759 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2573/  5000| tot_loss: 2.8064 | rl_loss: 1.1966 | pt_loss: 1.6099 | pg_loss: 0.1257 | reg_loss: 1.0709 | reward: 0.8524 | rev_kl: 1.2122 | stu_lens: 67.0000 | mixed_lens: 56.5000 | lr: 2.4711e-06 | scale: 1024.00 | time: 26.783 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2574/  5000| tot_loss: 2.7050 | rl_loss: 1.2572 | pt_loss: 1.4478 | pg_loss: 0.0652 | reg_loss: 1.1920 | reward: -0.1798 | rev_kl: 1.0195 | stu_lens: 125.5000 | mixed_lens: 128.0000 | lr: 2.4695e-06 | scale: 1024.00 | time: 26.769 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2575/  5000| tot_loss: 3.2523 | rl_loss: 1.4185 | pt_loss: 1.8339 | pg_loss: 0.1509 | reg_loss: 1.2676 | reward: -0.5274 | rev_kl: 0.8595 | stu_lens: 94.0000 | mixed_lens: 79.5000 | lr: 2.4679e-06 | scale: 1024.00 | time: 26.820 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2576/  5000| tot_loss: 2.4040 | rl_loss: 1.0945 | pt_loss: 1.3095 | pg_loss: 0.4420 | reg_loss: 0.6526 | reward: -0.3390 | rev_kl: 0.7254 | stu_lens: 68.5000 | mixed_lens: 53.0000 | lr: 2.4663e-06 | scale: 1024.00 | time: 26.771 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2576/  5000| tot_loss: 3.1737 | rl_loss: 1.5377 | pt_loss: 1.6360 | pg_loss: 0.3406 | reg_loss: 1.1971 | reward: -0.3039 | rev_kl: 1.0837 | stu_lens: 87.5469 | mixed_lens: 89.7812 | lr: 2.4663e-06 | scale: 1024.00 | time: 26.771 | step time: 27.991
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2577/  5000| tot_loss: 3.2945 | rl_loss: 1.5380 | pt_loss: 1.7566 | pg_loss: 0.2633 | reg_loss: 1.2746 | reward: -0.5818 | rev_kl: 1.0313 | stu_lens: 60.0000 | mixed_lens: 107.5000 | lr: 2.4647e-06 | scale: 1024.00 | time: 26.822 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2578/  5000| tot_loss: 3.0439 | rl_loss: 1.0397 | pt_loss: 2.0042 | pg_loss: -0.0166 | reg_loss: 1.0563 | reward: -0.4142 | rev_kl: 0.9147 | stu_lens: 98.0000 | mixed_lens: 128.0000 | lr: 2.4631e-06 | scale: 1024.00 | time: 26.770 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2579/  5000| tot_loss: 2.8743 | rl_loss: 0.9812 | pt_loss: 1.8931 | pg_loss: 0.1498 | reg_loss: 0.8314 | reward: 0.1297 | rev_kl: 0.9102 | stu_lens: 90.0000 | mixed_lens: 78.0000 | lr: 2.4615e-06 | scale: 1024.00 | time: 26.791 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2580/  5000| tot_loss: 2.8012 | rl_loss: 1.2314 | pt_loss: 1.5699 | pg_loss: 0.3489 | reg_loss: 0.8824 | reward: -0.6969 | rev_kl: 1.3300 | stu_lens: 80.5000 | mixed_lens: 86.5000 | lr: 2.4599e-06 | scale: 1024.00 | time: 26.778 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2581/  5000| tot_loss: 1.8456 | rl_loss: 0.9527 | pt_loss: 0.8929 | pg_loss: -0.0119 | reg_loss: 0.9646 | reward: -0.1773 | rev_kl: 1.3182 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.4583e-06 | scale: 1024.00 | time: 26.761 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2582/  5000| tot_loss: 2.9251 | rl_loss: 0.7098 | pt_loss: 2.2153 | pg_loss: 0.2399 | reg_loss: 0.4699 | reward: -0.1902 | rev_kl: 0.8025 | stu_lens: 85.5000 | mixed_lens: 90.0000 | lr: 2.4567e-06 | scale: 1024.00 | time: 26.821 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2583/  5000| tot_loss: 3.0499 | rl_loss: 1.4900 | pt_loss: 1.5599 | pg_loss: 0.7187 | reg_loss: 0.7713 | reward: -0.2319 | rev_kl: 0.8291 | stu_lens: 72.0000 | mixed_lens: 44.0000 | lr: 2.4551e-06 | scale: 1024.00 | time: 26.834 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2584/  5000| tot_loss: 2.3074 | rl_loss: 0.8987 | pt_loss: 1.4087 | pg_loss: 0.0312 | reg_loss: 0.8675 | reward: -0.3411 | rev_kl: 1.2612 | stu_lens: 104.5000 | mixed_lens: 128.0000 | lr: 2.4535e-06 | scale: 1024.00 | time: 26.818 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2585/  5000| tot_loss: 2.3671 | rl_loss: 1.0382 | pt_loss: 1.3289 | pg_loss: 0.5725 | reg_loss: 0.4658 | reward: -0.4590 | rev_kl: 0.6410 | stu_lens: 109.5000 | mixed_lens: 63.0000 | lr: 2.4519e-06 | scale: 1024.00 | time: 26.821 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2586/  5000| tot_loss: 3.7150 | rl_loss: 1.9462 | pt_loss: 1.7687 | pg_loss: 0.7698 | reg_loss: 1.1765 | reward: -1.1727 | rev_kl: 1.4550 | stu_lens: 77.0000 | mixed_lens: 61.5000 | lr: 2.4503e-06 | scale: 1024.00 | time: 26.793 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2587/  5000| tot_loss: 3.2132 | rl_loss: 1.3933 | pt_loss: 1.8199 | pg_loss: 0.2982 | reg_loss: 1.0951 | reward: -0.5519 | rev_kl: 1.5725 | stu_lens: 87.5000 | mixed_lens: 95.0000 | lr: 2.4487e-06 | scale: 1024.00 | time: 26.793 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2588/  5000| tot_loss: 2.6213 | rl_loss: 0.8556 | pt_loss: 1.7657 | pg_loss: 0.0014 | reg_loss: 0.8542 | reward: -0.2271 | rev_kl: 1.0105 | stu_lens: 120.0000 | mixed_lens: 128.0000 | lr: 2.4471e-06 | scale: 1024.00 | time: 26.771 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2589/  5000| tot_loss: 2.7458 | rl_loss: 0.9708 | pt_loss: 1.7749 | pg_loss: 0.1717 | reg_loss: 0.7991 | reward: -0.3122 | rev_kl: 1.1023 | stu_lens: 75.0000 | mixed_lens: 107.0000 | lr: 2.4455e-06 | scale: 1024.00 | time: 26.792 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2590/  5000| tot_loss: 3.3866 | rl_loss: 1.2690 | pt_loss: 2.1176 | pg_loss: 0.4613 | reg_loss: 0.8078 | reward: -0.1476 | rev_kl: 1.0574 | stu_lens: 66.0000 | mixed_lens: 58.5000 | lr: 2.4439e-06 | scale: 1024.00 | time: 26.772 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2591/  5000| tot_loss: 2.7682 | rl_loss: 1.1094 | pt_loss: 1.6587 | pg_loss: 0.4056 | reg_loss: 0.7038 | reward: -0.3134 | rev_kl: 0.7558 | stu_lens: 128.0000 | mixed_lens: 87.0000 | lr: 2.4423e-06 | scale: 1024.00 | time: 26.798 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2592/  5000| tot_loss: 2.6771 | rl_loss: 0.8557 | pt_loss: 1.8214 | pg_loss: 0.2584 | reg_loss: 0.5974 | reward: -0.5016 | rev_kl: 1.1987 | stu_lens: 90.0000 | mixed_lens: 99.5000 | lr: 2.4407e-06 | scale: 1024.00 | time: 26.765 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2592/  5000| tot_loss: 2.8094 | rl_loss: 1.1142 | pt_loss: 1.6953 | pg_loss: 0.2819 | reg_loss: 0.8322 | reward: -0.2737 | rev_kl: 1.0823 | stu_lens: 87.9844 | mixed_lens: 91.6094 | lr: 2.4407e-06 | scale: 1024.00 | time: 26.765 | step time: 28.008
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2593/  5000| tot_loss: 2.7500 | rl_loss: 1.1651 | pt_loss: 1.5848 | pg_loss: 0.1522 | reg_loss: 1.0129 | reward: -0.3303 | rev_kl: 1.2851 | stu_lens: 84.5000 | mixed_lens: 98.5000 | lr: 2.4391e-06 | scale: 1024.00 | time: 26.743 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2594/  5000| tot_loss: 2.0742 | rl_loss: 0.6878 | pt_loss: 1.3864 | pg_loss: 0.2595 | reg_loss: 0.4283 | reward: -0.3988 | rev_kl: 1.2126 | stu_lens: 90.0000 | mixed_lens: 99.0000 | lr: 2.4375e-06 | scale: 1024.00 | time: 26.718 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2595/  5000| tot_loss: 2.6461 | rl_loss: 1.0736 | pt_loss: 1.5725 | pg_loss: 0.1146 | reg_loss: 0.9590 | reward: -0.4175 | rev_kl: 1.3103 | stu_lens: 84.5000 | mixed_lens: 108.5000 | lr: 2.4359e-06 | scale: 1024.00 | time: 26.804 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2596/  5000| tot_loss: 2.4975 | rl_loss: 0.6100 | pt_loss: 1.8875 | pg_loss: 0.0600 | reg_loss: 0.5500 | reward: -0.0999 | rev_kl: 0.5540 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.4343e-06 | scale: 1024.00 | time: 26.721 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2597/  5000| tot_loss: 2.2658 | rl_loss: 0.5712 | pt_loss: 1.6947 | pg_loss: 0.0474 | reg_loss: 0.5238 | reward: 0.1674 | rev_kl: 0.9750 | stu_lens: 36.5000 | mixed_lens: 78.0000 | lr: 2.4327e-06 | scale: 1024.00 | time: 26.740 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2598/  5000| tot_loss: 2.4255 | rl_loss: 0.7655 | pt_loss: 1.6601 | pg_loss: 0.1857 | reg_loss: 0.5798 | reward: -0.3934 | rev_kl: 0.4607 | stu_lens: 98.0000 | mixed_lens: 108.0000 | lr: 2.4311e-06 | scale: 1024.00 | time: 26.719 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2599/  5000| tot_loss: 2.4445 | rl_loss: 0.6328 | pt_loss: 1.8118 | pg_loss: 0.1241 | reg_loss: 0.5087 | reward: -0.1336 | rev_kl: 0.9610 | stu_lens: 109.0000 | mixed_lens: 108.5000 | lr: 2.4295e-06 | scale: 1024.00 | time: 26.746 | step time: 0.000
                                 Evaluation #26                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Bob has a 9% chance of survival if   │
│                                       │ he leaves Alice. This is because he  │
│                                       │ can survive on his own in the desert │
│                                       │ for 31% of the time. However, if he  │
│                                       │ stays with Alice, he has a 31%       │
│                                       │ chance of survival. This is because  │
│                                       │ Alice can also survive on her own in │
│                                       │ the desert for 31% of the time.      │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ zy                                   │
│                                       │                                      │
│                                       │ cz                                   │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support over 100 languages.       │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.466 | exact_match: 0.215 | rev_kl: 1.073 | lens: 80.809 | pt_loss: 1.074 | lm_loss: 1.156 | kd_loss: 0.992 
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2600/  5000| tot_loss: 2.4068 | rl_loss: 0.8599 | pt_loss: 1.5469 | pg_loss: 0.2575 | reg_loss: 0.6024 | reward: -0.3384 | rev_kl: 1.1855 | stu_lens: 128.0000 | mixed_lens: 101.5000 | lr: 2.4279e-06 | scale: 1024.00 | time: 26.723 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2601/  5000| tot_loss: 2.5981 | rl_loss: 0.6657 | pt_loss: 1.9324 | pg_loss: 0.2102 | reg_loss: 0.4554 | reward: -0.0609 | rev_kl: 1.3895 | stu_lens: 96.0000 | mixed_lens: 97.5000 | lr: 2.4263e-06 | scale: 1024.00 | time: 26.813 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2602/  5000| tot_loss: 2.0190 | rl_loss: 0.8989 | pt_loss: 1.1201 | pg_loss: 0.3292 | reg_loss: 0.5698 | reward: -0.4289 | rev_kl: 1.1798 | stu_lens: 73.5000 | mixed_lens: 98.0000 | lr: 2.4247e-06 | scale: 1024.00 | time: 26.795 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2603/  5000| tot_loss: 2.4578 | rl_loss: 1.0822 | pt_loss: 1.3756 | pg_loss: 0.5665 | reg_loss: 0.5157 | reward: -0.5073 | rev_kl: 1.4338 | stu_lens: 99.0000 | mixed_lens: 62.5000 | lr: 2.4231e-06 | scale: 1024.00 | time: 26.756 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2604/  5000| tot_loss: 1.8873 | rl_loss: 0.4219 | pt_loss: 1.4653 | pg_loss: -0.0117 | reg_loss: 0.4336 | reward: -0.1886 | rev_kl: 1.1433 | stu_lens: 125.5000 | mixed_lens: 128.0000 | lr: 2.4215e-06 | scale: 1024.00 | time: 26.832 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2605/  5000| tot_loss: 2.5989 | rl_loss: 1.3621 | pt_loss: 1.2368 | pg_loss: 1.1092 | reg_loss: 0.2529 | reward: 0.5826 | rev_kl: 0.8530 | stu_lens: 6.5000 | mixed_lens: 9.0000 | lr: 2.4199e-06 | scale: 1024.00 | time: 26.661 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2606/  5000| tot_loss: 2.4346 | rl_loss: 0.6654 | pt_loss: 1.7692 | pg_loss: 0.0570 | reg_loss: 0.6084 | reward: -0.2163 | rev_kl: 0.9323 | stu_lens: 76.5000 | mixed_lens: 121.0000 | lr: 2.4183e-06 | scale: 1024.00 | time: 26.677 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2607/  5000| tot_loss: 3.1441 | rl_loss: 1.2414 | pt_loss: 1.9027 | pg_loss: 0.5937 | reg_loss: 0.6477 | reward: -0.3778 | rev_kl: 0.8414 | stu_lens: 37.0000 | mixed_lens: 33.0000 | lr: 2.4167e-06 | scale: 1024.00 | time: 26.709 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2608/  5000| tot_loss: 2.5607 | rl_loss: 0.8180 | pt_loss: 1.7427 | pg_loss: 0.3659 | reg_loss: 0.4521 | reward: -0.4528 | rev_kl: 1.1591 | stu_lens: 97.0000 | mixed_lens: 85.0000 | lr: 2.4151e-06 | scale: 1024.00 | time: 26.659 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2608/  5000| tot_loss: 2.4054 | rl_loss: 0.7894 | pt_loss: 1.6160 | pg_loss: 0.2111 | reg_loss: 0.5783 | reward: -0.2786 | rev_kl: 1.0758 | stu_lens: 84.5469 | mixed_lens: 87.1406 | lr: 2.4151e-06 | scale: 1024.00 | time: 26.659 | step time: 27.953
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2609/  5000| tot_loss: 2.6394 | rl_loss: 0.4837 | pt_loss: 2.1557 | pg_loss: 0.0502 | reg_loss: 0.4336 | reward: -0.2344 | rev_kl: 0.7425 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.4135e-06 | scale: 1024.00 | time: 26.700 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2610/  5000| tot_loss: 2.3035 | rl_loss: 0.6582 | pt_loss: 1.6453 | pg_loss: 0.2610 | reg_loss: 0.3972 | reward: -0.1893 | rev_kl: 0.9721 | stu_lens: 128.0000 | mixed_lens: 92.5000 | lr: 2.4119e-06 | scale: 1024.00 | time: 26.704 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2611/  5000| tot_loss: 1.9395 | rl_loss: 0.5575 | pt_loss: 1.3820 | pg_loss: 0.1149 | reg_loss: 0.4426 | reward: 0.0364 | rev_kl: 1.0882 | stu_lens: 59.0000 | mixed_lens: 57.0000 | lr: 2.4103e-06 | scale: 1024.00 | time: 26.789 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2612/  5000| tot_loss: 1.9567 | rl_loss: 0.4449 | pt_loss: 1.5118 | pg_loss: 0.0143 | reg_loss: 0.4306 | reward: -0.2083 | rev_kl: 1.2466 | stu_lens: 114.5000 | mixed_lens: 128.0000 | lr: 2.4087e-06 | scale: 1024.00 | time: 26.776 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2613/  5000| tot_loss: 2.9190 | rl_loss: 1.1847 | pt_loss: 1.7344 | pg_loss: 0.7984 | reg_loss: 0.3862 | reward: -0.2429 | rev_kl: 0.7961 | stu_lens: 72.0000 | mixed_lens: 50.0000 | lr: 2.4071e-06 | scale: 1024.00 | time: 26.796 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2614/  5000| tot_loss: 1.9199 | rl_loss: 0.4328 | pt_loss: 1.4871 | pg_loss: 0.2057 | reg_loss: 0.2272 | reward: -0.6357 | rev_kl: 0.8783 | stu_lens: 94.0000 | mixed_lens: 57.5000 | lr: 2.4055e-06 | scale: 1024.00 | time: 26.777 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2615/  5000| tot_loss: 2.3582 | rl_loss: 0.6223 | pt_loss: 1.7359 | pg_loss: 0.1693 | reg_loss: 0.4530 | reward: -0.2293 | rev_kl: 0.7417 | stu_lens: 106.0000 | mixed_lens: 108.0000 | lr: 2.4039e-06 | scale: 1024.00 | time: 26.815 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2616/  5000| tot_loss: 2.9497 | rl_loss: 0.9154 | pt_loss: 2.0343 | pg_loss: 0.5384 | reg_loss: 0.3770 | reward: -0.3700 | rev_kl: 0.6525 | stu_lens: 67.5000 | mixed_lens: 70.5000 | lr: 2.4023e-06 | scale: 1024.00 | time: 26.776 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2617/  5000| tot_loss: 2.0222 | rl_loss: 0.3377 | pt_loss: 1.6845 | pg_loss: 0.0473 | reg_loss: 0.2903 | reward: -0.2056 | rev_kl: 1.0730 | stu_lens: 94.0000 | mixed_lens: 113.0000 | lr: 2.4006e-06 | scale: 1024.00 | time: 26.733 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2618/  5000| tot_loss: 3.1171 | rl_loss: 1.3690 | pt_loss: 1.7482 | pg_loss: 0.6881 | reg_loss: 0.6808 | reward: -0.4200 | rev_kl: 0.8784 | stu_lens: 68.0000 | mixed_lens: 68.0000 | lr: 2.3990e-06 | scale: 1024.00 | time: 26.694 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2619/  5000| tot_loss: 2.6347 | rl_loss: 1.1115 | pt_loss: 1.5232 | pg_loss: 0.2848 | reg_loss: 0.8267 | reward: -0.1661 | rev_kl: 1.5102 | stu_lens: 71.0000 | mixed_lens: 71.0000 | lr: 2.3974e-06 | scale: 1024.00 | time: 26.724 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2620/  5000| tot_loss: 2.9924 | rl_loss: 0.9085 | pt_loss: 2.0839 | pg_loss: 0.2373 | reg_loss: 0.6712 | reward: -0.3803 | rev_kl: 1.4541 | stu_lens: 96.0000 | mixed_lens: 101.5000 | lr: 2.3958e-06 | scale: 1024.00 | time: 26.731 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2621/  5000| tot_loss: 2.4020 | rl_loss: 0.4730 | pt_loss: 1.9290 | pg_loss: 0.1494 | reg_loss: 0.3236 | reward: -0.0663 | rev_kl: 1.1118 | stu_lens: 122.5000 | mixed_lens: 97.5000 | lr: 2.3942e-06 | scale: 1024.00 | time: 26.694 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2622/  5000| tot_loss: 2.4319 | rl_loss: 0.8106 | pt_loss: 1.6213 | pg_loss: 0.1967 | reg_loss: 0.6139 | reward: -0.6179 | rev_kl: 1.4868 | stu_lens: 90.0000 | mixed_lens: 107.5000 | lr: 2.3926e-06 | scale: 1024.00 | time: 26.671 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2623/  5000| tot_loss: 2.0640 | rl_loss: 0.4468 | pt_loss: 1.6172 | pg_loss: 0.0204 | reg_loss: 0.4264 | reward: -0.1263 | rev_kl: 1.0019 | stu_lens: 74.5000 | mixed_lens: 118.0000 | lr: 2.3910e-06 | scale: 1024.00 | time: 26.696 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2624/  5000| tot_loss: 2.7316 | rl_loss: 1.2545 | pt_loss: 1.4771 | pg_loss: 0.7170 | reg_loss: 0.5375 | reward: 0.7288 | rev_kl: 1.0611 | stu_lens: 62.0000 | mixed_lens: 54.0000 | lr: 2.3894e-06 | scale: 1024.00 | time: 26.677 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2624/  5000| tot_loss: 2.4546 | rl_loss: 0.7499 | pt_loss: 1.7047 | pg_loss: 0.2691 | reg_loss: 0.4808 | reward: -0.2858 | rev_kl: 1.0849 | stu_lens: 87.9531 | mixed_lens: 90.6562 | lr: 2.3894e-06 | scale: 1024.00 | time: 26.677 | step time: 27.949
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2625/  5000| tot_loss: 2.3547 | rl_loss: 0.6246 | pt_loss: 1.7301 | pg_loss: 0.2509 | reg_loss: 0.3737 | reward: -0.4808 | rev_kl: 1.3371 | stu_lens: 121.0000 | mixed_lens: 88.0000 | lr: 2.3878e-06 | scale: 1024.00 | time: 26.709 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2626/  5000| tot_loss: 2.6237 | rl_loss: 0.9512 | pt_loss: 1.6725 | pg_loss: 0.0291 | reg_loss: 0.9221 | reward: -0.1478 | rev_kl: 0.9165 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.3862e-06 | scale: 1024.00 | time: 26.731 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2627/  5000| tot_loss: 3.3183 | rl_loss: 1.7138 | pt_loss: 1.6044 | pg_loss: 1.2844 | reg_loss: 0.4294 | reward: -0.2959 | rev_kl: 1.1328 | stu_lens: 33.0000 | mixed_lens: 23.0000 | lr: 2.3846e-06 | scale: 1024.00 | time: 26.712 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2628/  5000| tot_loss: 3.9614 | rl_loss: 2.0023 | pt_loss: 1.9590 | pg_loss: 0.8791 | reg_loss: 1.1233 | reward: -0.0326 | rev_kl: 0.8124 | stu_lens: 32.5000 | mixed_lens: 42.5000 | lr: 2.3830e-06 | scale: 1024.00 | time: 26.667 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2629/  5000| tot_loss: 5.4608 | rl_loss: 3.8984 | pt_loss: 1.5624 | pg_loss: 2.4044 | reg_loss: 1.4940 | reward: -2.2696 | rev_kl: 3.4496 | stu_lens: 18.0000 | mixed_lens: 18.5000 | lr: 2.3814e-06 | scale: 1024.00 | time: 26.695 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2630/  5000| tot_loss: 3.1444 | rl_loss: 1.2976 | pt_loss: 1.8468 | pg_loss: 0.2658 | reg_loss: 1.0318 | reward: -0.7552 | rev_kl: 0.8004 | stu_lens: 103.0000 | mixed_lens: 92.0000 | lr: 2.3798e-06 | scale: 1024.00 | time: 26.678 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2631/  5000| tot_loss: 3.1834 | rl_loss: 1.2180 | pt_loss: 1.9654 | pg_loss: 0.0970 | reg_loss: 1.1210 | reward: -0.1766 | rev_kl: 0.6909 | stu_lens: 105.0000 | mixed_lens: 120.0000 | lr: 2.3782e-06 | scale: 1024.00 | time: 26.693 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2632/  5000| tot_loss: 3.6719 | rl_loss: 2.0102 | pt_loss: 1.6618 | pg_loss: 0.3510 | reg_loss: 1.6592 | reward: -0.2987 | rev_kl: 1.1317 | stu_lens: 112.5000 | mixed_lens: 84.0000 | lr: 2.3766e-06 | scale: 1024.00 | time: 26.688 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2633/  5000| tot_loss: 3.4497 | rl_loss: 1.7616 | pt_loss: 1.6881 | pg_loss: 0.2669 | reg_loss: 1.4947 | reward: -0.3610 | rev_kl: 1.4001 | stu_lens: 56.0000 | mixed_lens: 101.5000 | lr: 2.3750e-06 | scale: 1024.00 | time: 26.734 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2634/  5000| tot_loss: 2.9554 | rl_loss: 1.4254 | pt_loss: 1.5299 | pg_loss: 0.4644 | reg_loss: 0.9611 | reward: -0.4359 | rev_kl: 0.8801 | stu_lens: 77.0000 | mixed_lens: 85.5000 | lr: 2.3734e-06 | scale: 1024.00 | time: 26.673 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2635/  5000| tot_loss: 3.1795 | rl_loss: 1.3966 | pt_loss: 1.7829 | pg_loss: 0.3090 | reg_loss: 1.0877 | reward: -0.2366 | rev_kl: 1.2622 | stu_lens: 107.5000 | mixed_lens: 94.5000 | lr: 2.3718e-06 | scale: 1024.00 | time: 26.694 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2636/  5000| tot_loss: 3.1723 | rl_loss: 1.3385 | pt_loss: 1.8338 | pg_loss: 0.1215 | reg_loss: 1.2170 | reward: -0.1938 | rev_kl: 1.0759 | stu_lens: 61.5000 | mixed_lens: 121.0000 | lr: 2.3702e-06 | scale: 1024.00 | time: 26.703 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2637/  5000| tot_loss: 3.5326 | rl_loss: 1.9611 | pt_loss: 1.5715 | pg_loss: 0.4973 | reg_loss: 1.4638 | reward: -0.7086 | rev_kl: 1.7705 | stu_lens: 19.0000 | mixed_lens: 75.0000 | lr: 2.3686e-06 | scale: 1024.00 | time: 26.725 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2638/  5000| tot_loss: 4.0294 | rl_loss: 2.2608 | pt_loss: 1.7686 | pg_loss: 1.3000 | reg_loss: 0.9607 | reward: -0.9832 | rev_kl: 0.8407 | stu_lens: 91.0000 | mixed_lens: 40.0000 | lr: 2.3670e-06 | scale: 1024.00 | time: 26.675 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2639/  5000| tot_loss: 3.6307 | rl_loss: 2.1663 | pt_loss: 1.4644 | pg_loss: 1.4405 | reg_loss: 0.7258 | reward: -0.5409 | rev_kl: 0.9343 | stu_lens: 62.0000 | mixed_lens: 23.0000 | lr: 2.3654e-06 | scale: 1024.00 | time: 26.699 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2640/  5000| tot_loss: 3.5583 | rl_loss: 1.4089 | pt_loss: 2.1494 | pg_loss: 0.4264 | reg_loss: 0.9825 | reward: -0.6047 | rev_kl: 0.4758 | stu_lens: 67.0000 | mixed_lens: 68.0000 | lr: 2.3638e-06 | scale: 1024.00 | time: 26.674 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2640/  5000| tot_loss: 3.2511 | rl_loss: 1.5831 | pt_loss: 1.6680 | pg_loss: 0.4704 | reg_loss: 1.1127 | reward: -0.4698 | rev_kl: 1.2391 | stu_lens: 77.5938 | mixed_lens: 83.8438 | lr: 2.3638e-06 | scale: 1024.00 | time: 26.674 | step time: 27.912
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2641/  5000| tot_loss: 3.6242 | rl_loss: 1.6509 | pt_loss: 1.9733 | pg_loss: 0.2295 | reg_loss: 1.4215 | reward: -0.3279 | rev_kl: 1.2106 | stu_lens: 128.0000 | mixed_lens: 112.5000 | lr: 2.3622e-06 | scale: 1024.00 | time: 26.694 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2642/  5000| tot_loss: 2.7491 | rl_loss: 1.2202 | pt_loss: 1.5289 | pg_loss: 0.2700 | reg_loss: 0.9502 | reward: -0.7410 | rev_kl: 1.1297 | stu_lens: 67.5000 | mixed_lens: 92.0000 | lr: 2.3606e-06 | scale: 1024.00 | time: 26.678 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2643/  5000| tot_loss: 2.7461 | rl_loss: 1.1272 | pt_loss: 1.6189 | pg_loss: 0.4916 | reg_loss: 0.6356 | reward: -0.6468 | rev_kl: 0.4860 | stu_lens: 29.0000 | mixed_lens: 26.0000 | lr: 2.3590e-06 | scale: 1024.00 | time: 26.720 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2644/  5000| tot_loss: 3.1888 | rl_loss: 1.4846 | pt_loss: 1.7042 | pg_loss: 0.3103 | reg_loss: 1.1743 | reward: -0.3150 | rev_kl: 0.8528 | stu_lens: 76.0000 | mixed_lens: 75.5000 | lr: 2.3574e-06 | scale: 1024.00 | time: 26.740 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2645/  5000| tot_loss: 2.7018 | rl_loss: 1.2484 | pt_loss: 1.4534 | pg_loss: 0.2148 | reg_loss: 1.0336 | reward: -0.3562 | rev_kl: 1.2346 | stu_lens: 76.5000 | mixed_lens: 83.5000 | lr: 2.3558e-06 | scale: 1024.00 | time: 26.788 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2646/  5000| tot_loss: 2.7199 | rl_loss: 1.4087 | pt_loss: 1.3111 | pg_loss: 0.4244 | reg_loss: 0.9843 | reward: -0.4571 | rev_kl: 0.9112 | stu_lens: 91.0000 | mixed_lens: 86.5000 | lr: 2.3542e-06 | scale: 1024.00 | time: 26.761 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2647/  5000| tot_loss: 2.4392 | rl_loss: 0.7580 | pt_loss: 1.6812 | pg_loss: 0.0941 | reg_loss: 0.6639 | reward: -0.3705 | rev_kl: 1.0452 | stu_lens: 79.5000 | mixed_lens: 115.5000 | lr: 2.3526e-06 | scale: 1024.00 | time: 26.763 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2648/  5000| tot_loss: 3.0705 | rl_loss: 1.7032 | pt_loss: 1.3674 | pg_loss: 0.6755 | reg_loss: 1.0277 | reward: -0.1417 | rev_kl: 1.3291 | stu_lens: 44.0000 | mixed_lens: 62.0000 | lr: 2.3510e-06 | scale: 1024.00 | time: 26.741 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2649/  5000| tot_loss: 2.1758 | rl_loss: 0.1558 | pt_loss: 2.0200 | pg_loss: 0.0094 | reg_loss: 0.1465 | reward: -0.0706 | rev_kl: 1.0625 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.3494e-06 | scale: 1024.00 | time: 26.772 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2650/  5000| tot_loss: 3.0684 | rl_loss: 1.4385 | pt_loss: 1.6299 | pg_loss: 0.5355 | reg_loss: 0.9030 | reward: -0.7260 | rev_kl: 0.9611 | stu_lens: 32.5000 | mixed_lens: 57.0000 | lr: 2.3478e-06 | scale: 1024.00 | time: 26.738 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2651/  5000| tot_loss: 3.3139 | rl_loss: 1.2296 | pt_loss: 2.0842 | pg_loss: 0.3874 | reg_loss: 0.8422 | reward: -0.4420 | rev_kl: 0.5915 | stu_lens: 64.0000 | mixed_lens: 71.5000 | lr: 2.3462e-06 | scale: 1024.00 | time: 26.819 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2652/  5000| tot_loss: 3.0241 | rl_loss: 1.4480 | pt_loss: 1.5761 | pg_loss: 0.3912 | reg_loss: 1.0568 | reward: -0.4586 | rev_kl: 1.5607 | stu_lens: 87.0000 | mixed_lens: 78.5000 | lr: 2.3446e-06 | scale: 1024.00 | time: 26.747 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2653/  5000| tot_loss: 3.2893 | rl_loss: 1.9009 | pt_loss: 1.3884 | pg_loss: 0.8879 | reg_loss: 1.0130 | reward: -0.8944 | rev_kl: 2.0710 | stu_lens: 30.0000 | mixed_lens: 37.0000 | lr: 2.3430e-06 | scale: 1024.00 | time: 26.776 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2654/  5000| tot_loss: 2.4347 | rl_loss: 1.0744 | pt_loss: 1.3604 | pg_loss: 0.4818 | reg_loss: 0.5925 | reward: -0.1596 | rev_kl: 0.9356 | stu_lens: 100.5000 | mixed_lens: 75.0000 | lr: 2.3414e-06 | scale: 1024.00 | time: 26.735 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2655/  5000| tot_loss: 2.3050 | rl_loss: 0.8161 | pt_loss: 1.4890 | pg_loss: 0.0545 | reg_loss: 0.7615 | reward: -0.2579 | rev_kl: 1.1473 | stu_lens: 102.5000 | mixed_lens: 121.0000 | lr: 2.3398e-06 | scale: 1024.00 | time: 26.790 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2656/  5000| tot_loss: 2.3553 | rl_loss: 0.8254 | pt_loss: 1.5299 | pg_loss: 0.3309 | reg_loss: 0.4945 | reward: -0.7561 | rev_kl: 0.6945 | stu_lens: 72.0000 | mixed_lens: 76.0000 | lr: 2.3382e-06 | scale: 1024.00 | time: 26.763 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2656/  5000| tot_loss: 2.8138 | rl_loss: 1.2136 | pt_loss: 1.6002 | pg_loss: 0.3518 | reg_loss: 0.8618 | reward: -0.4467 | rev_kl: 1.2665 | stu_lens: 80.2812 | mixed_lens: 85.3906 | lr: 2.3382e-06 | scale: 1024.00 | time: 26.763 | step time: 27.966
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2657/  5000| tot_loss: 2.5175 | rl_loss: 0.8385 | pt_loss: 1.6791 | pg_loss: 0.2450 | reg_loss: 0.5934 | reward: -0.2815 | rev_kl: 1.1361 | stu_lens: 71.5000 | mixed_lens: 89.5000 | lr: 2.3366e-06 | scale: 1024.00 | time: 26.786 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2658/  5000| tot_loss: 2.3121 | rl_loss: 0.9954 | pt_loss: 1.3167 | pg_loss: 0.2298 | reg_loss: 0.7656 | reward: -0.4616 | rev_kl: 1.4520 | stu_lens: 89.5000 | mixed_lens: 76.0000 | lr: 2.3350e-06 | scale: 1024.00 | time: 26.794 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2659/  5000| tot_loss: 3.4922 | rl_loss: 1.8091 | pt_loss: 1.6830 | pg_loss: 0.9917 | reg_loss: 0.8174 | reward: -0.7575 | rev_kl: 1.2699 | stu_lens: 42.5000 | mixed_lens: 39.0000 | lr: 2.3334e-06 | scale: 1024.00 | time: 26.819 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2660/  5000| tot_loss: 2.5344 | rl_loss: 0.6477 | pt_loss: 1.8867 | pg_loss: -0.0061 | reg_loss: 0.6539 | reward: -0.1905 | rev_kl: 1.2712 | stu_lens: 116.5000 | mixed_lens: 128.0000 | lr: 2.3318e-06 | scale: 1024.00 | time: 26.785 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2661/  5000| tot_loss: 2.7903 | rl_loss: 0.9908 | pt_loss: 1.7995 | pg_loss: 0.1163 | reg_loss: 0.8744 | reward: -0.5224 | rev_kl: 1.4550 | stu_lens: 126.5000 | mixed_lens: 109.5000 | lr: 2.3302e-06 | scale: 1024.00 | time: 26.832 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2662/  5000| tot_loss: 2.4400 | rl_loss: 1.0425 | pt_loss: 1.3975 | pg_loss: 0.3834 | reg_loss: 0.6591 | reward: -0.3822 | rev_kl: 4.6051 | stu_lens: 64.0000 | mixed_lens: 79.0000 | lr: 2.3286e-06 | scale: 1024.00 | time: 26.839 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2663/  5000| tot_loss: 2.9037 | rl_loss: 1.2273 | pt_loss: 1.6763 | pg_loss: 0.5997 | reg_loss: 0.6276 | reward: -0.6254 | rev_kl: 1.1761 | stu_lens: 75.0000 | mixed_lens: 65.5000 | lr: 2.3270e-06 | scale: 1024.00 | time: 26.829 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2664/  5000| tot_loss: 2.6686 | rl_loss: 0.6227 | pt_loss: 2.0459 | pg_loss: 0.0742 | reg_loss: 0.5485 | reward: -0.1499 | rev_kl: 1.0631 | stu_lens: 102.5000 | mixed_lens: 121.0000 | lr: 2.3254e-06 | scale: 1024.00 | time: 26.791 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2665/  5000| tot_loss: 2.4667 | rl_loss: 0.9014 | pt_loss: 1.5653 | pg_loss: 0.4514 | reg_loss: 0.4500 | reward: -0.3900 | rev_kl: 0.8943 | stu_lens: 71.0000 | mixed_lens: 71.5000 | lr: 2.3238e-06 | scale: 1024.00 | time: 26.810 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2666/  5000| tot_loss: 1.9057 | rl_loss: 0.2587 | pt_loss: 1.6469 | pg_loss: 0.0167 | reg_loss: 0.2421 | reward: -0.0909 | rev_kl: 1.0358 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.3222e-06 | scale: 1024.00 | time: 26.784 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2667/  5000| tot_loss: 2.3310 | rl_loss: 0.6219 | pt_loss: 1.7091 | pg_loss: 0.1069 | reg_loss: 0.5150 | reward: -0.2490 | rev_kl: 1.3693 | stu_lens: 124.5000 | mixed_lens: 116.5000 | lr: 2.3206e-06 | scale: 1024.00 | time: 26.782 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2668/  5000| tot_loss: 2.4481 | rl_loss: 0.8499 | pt_loss: 1.5982 | pg_loss: 0.2886 | reg_loss: 0.5613 | reward: -0.3328 | rev_kl: 0.7294 | stu_lens: 76.0000 | mixed_lens: 75.5000 | lr: 2.3190e-06 | scale: 1024.00 | time: 26.751 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2669/  5000| tot_loss: 2.8663 | rl_loss: 0.8529 | pt_loss: 2.0135 | pg_loss: 0.2909 | reg_loss: 0.5619 | reward: -0.1696 | rev_kl: 0.8526 | stu_lens: 67.0000 | mixed_lens: 87.0000 | lr: 2.3174e-06 | scale: 1024.00 | time: 26.777 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2670/  5000| tot_loss: 2.2075 | rl_loss: 0.7553 | pt_loss: 1.4523 | pg_loss: 0.0561 | reg_loss: 0.6992 | reward: -0.1999 | rev_kl: 0.9434 | stu_lens: 77.5000 | mixed_lens: 122.5000 | lr: 2.3158e-06 | scale: 1024.00 | time: 26.754 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2671/  5000| tot_loss: 2.2306 | rl_loss: 0.4757 | pt_loss: 1.7549 | pg_loss: 0.2207 | reg_loss: 0.2549 | reward: -0.7443 | rev_kl: 0.5579 | stu_lens: 128.0000 | mixed_lens: 76.0000 | lr: 2.3142e-06 | scale: 1024.00 | time: 26.888 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2672/  5000| tot_loss: 2.9048 | rl_loss: 0.8203 | pt_loss: 2.0845 | pg_loss: 0.1395 | reg_loss: 0.6808 | reward: -0.4639 | rev_kl: 1.3443 | stu_lens: 105.0000 | mixed_lens: 110.5000 | lr: 2.3126e-06 | scale: 1024.00 | time: 26.837 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2672/  5000| tot_loss: 2.6576 | rl_loss: 0.9598 | pt_loss: 1.6978 | pg_loss: 0.3427 | reg_loss: 0.6170 | reward: -0.4657 | rev_kl: 1.2447 | stu_lens: 75.3906 | mixed_lens: 83.0000 | lr: 2.3126e-06 | scale: 1024.00 | time: 26.837 | step time: 28.018
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2673/  5000| tot_loss: 2.5974 | rl_loss: 0.8078 | pt_loss: 1.7896 | pg_loss: 0.1424 | reg_loss: 0.6654 | reward: -0.3970 | rev_kl: 1.0749 | stu_lens: 112.5000 | mixed_lens: 115.5000 | lr: 2.3110e-06 | scale: 1024.00 | time: 26.871 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2674/  5000| tot_loss: 3.3818 | rl_loss: 1.1269 | pt_loss: 2.2550 | pg_loss: 0.4912 | reg_loss: 0.6357 | reward: -0.0800 | rev_kl: 1.3168 | stu_lens: 34.5000 | mixed_lens: 83.5000 | lr: 2.3094e-06 | scale: 1024.00 | time: 26.873 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2675/  5000| tot_loss: 2.5850 | rl_loss: 0.7988 | pt_loss: 1.7862 | pg_loss: 0.2715 | reg_loss: 0.5274 | reward: -0.1575 | rev_kl: 1.2228 | stu_lens: 67.5000 | mixed_lens: 75.0000 | lr: 2.3078e-06 | scale: 1024.00 | time: 26.853 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2676/  5000| tot_loss: 2.4211 | rl_loss: 0.4622 | pt_loss: 1.9589 | pg_loss: 0.2721 | reg_loss: 0.1901 | reward: -0.1598 | rev_kl: 1.1644 | stu_lens: 85.0000 | mixed_lens: 75.5000 | lr: 2.3062e-06 | scale: 1024.00 | time: 26.836 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2677/  5000| tot_loss: 2.5395 | rl_loss: 0.5273 | pt_loss: 2.0122 | pg_loss: 0.0478 | reg_loss: 0.4795 | reward: -0.4242 | rev_kl: 1.4821 | stu_lens: 116.5000 | mixed_lens: 118.5000 | lr: 2.3047e-06 | scale: 1024.00 | time: 26.861 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2678/  5000| tot_loss: 2.4144 | rl_loss: 0.9373 | pt_loss: 1.4771 | pg_loss: 0.4042 | reg_loss: 0.5331 | reward: -0.6101 | rev_kl: 1.0930 | stu_lens: 74.0000 | mixed_lens: 63.5000 | lr: 2.3031e-06 | scale: 1024.00 | time: 26.833 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2679/  5000| tot_loss: 3.1236 | rl_loss: 0.8414 | pt_loss: 2.2823 | pg_loss: 0.3436 | reg_loss: 0.4978 | reward: -0.6472 | rev_kl: 1.3389 | stu_lens: 82.0000 | mixed_lens: 71.0000 | lr: 2.3015e-06 | scale: 1024.00 | time: 26.868 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2680/  5000| tot_loss: 2.1583 | rl_loss: 0.4902 | pt_loss: 1.6681 | pg_loss: 0.3611 | reg_loss: 0.1291 | reward: -0.4901 | rev_kl: 0.3851 | stu_lens: 66.0000 | mixed_lens: 66.0000 | lr: 2.2999e-06 | scale: 1024.00 | time: 26.824 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2681/  5000| tot_loss: 2.1571 | rl_loss: 0.8201 | pt_loss: 1.3370 | pg_loss: 0.2100 | reg_loss: 0.6102 | reward: -0.5036 | rev_kl: 1.2917 | stu_lens: 92.5000 | mixed_lens: 98.0000 | lr: 2.2983e-06 | scale: 1024.00 | time: 26.874 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2682/  5000| tot_loss: 2.5992 | rl_loss: 0.7299 | pt_loss: 1.8693 | pg_loss: 0.2137 | reg_loss: 0.5162 | reward: -0.3816 | rev_kl: 1.1225 | stu_lens: 121.0000 | mixed_lens: 107.0000 | lr: 2.2967e-06 | scale: 1024.00 | time: 26.862 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2683/  5000| tot_loss: 2.1248 | rl_loss: 0.7144 | pt_loss: 1.4104 | pg_loss: 0.1803 | reg_loss: 0.5341 | reward: -0.2787 | rev_kl: 1.3693 | stu_lens: 78.5000 | mixed_lens: 106.5000 | lr: 2.2951e-06 | scale: 1024.00 | time: 26.914 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2684/  5000| tot_loss: 2.2839 | rl_loss: 0.9442 | pt_loss: 1.3398 | pg_loss: 0.5317 | reg_loss: 0.4125 | reward: -0.3531 | rev_kl: 0.5174 | stu_lens: 76.0000 | mixed_lens: 52.0000 | lr: 2.2935e-06 | scale: 1024.00 | time: 26.882 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2685/  5000| tot_loss: 2.1060 | rl_loss: 0.3823 | pt_loss: 1.7237 | pg_loss: -0.0012 | reg_loss: 0.3836 | reward: -0.2006 | rev_kl: 0.8993 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.2919e-06 | scale: 1024.00 | time: 26.905 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2686/  5000| tot_loss: 1.3077 | rl_loss: 0.2337 | pt_loss: 1.0740 | pg_loss: 0.0520 | reg_loss: 0.1816 | reward: -0.2492 | rev_kl: 1.2998 | stu_lens: 84.5000 | mixed_lens: 86.0000 | lr: 2.2903e-06 | scale: 1024.00 | time: 26.880 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2687/  5000| tot_loss: 1.7897 | rl_loss: 0.6162 | pt_loss: 1.1735 | pg_loss: 0.1409 | reg_loss: 0.4753 | reward: -0.4669 | rev_kl: 1.4678 | stu_lens: 101.0000 | mixed_lens: 101.5000 | lr: 2.2887e-06 | scale: 1024.00 | time: 26.912 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2688/  5000| tot_loss: 2.3883 | rl_loss: 0.5931 | pt_loss: 1.7952 | pg_loss: 0.1448 | reg_loss: 0.4483 | reward: -0.2916 | rev_kl: 0.9634 | stu_lens: 91.0000 | mixed_lens: 109.5000 | lr: 2.2871e-06 | scale: 1024.00 | time: 26.863 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2688/  5000| tot_loss: 2.4302 | rl_loss: 0.7816 | pt_loss: 1.6485 | pg_loss: 0.3117 | reg_loss: 0.4699 | reward: -0.4166 | rev_kl: 1.1755 | stu_lens: 78.1250 | mixed_lens: 85.3750 | lr: 2.2871e-06 | scale: 1024.00 | time: 26.863 | step time: 28.084
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2689/  5000| tot_loss: 2.7299 | rl_loss: 0.9618 | pt_loss: 1.7682 | pg_loss: 0.3721 | reg_loss: 0.5897 | reward: -0.8591 | rev_kl: 1.2798 | stu_lens: 117.0000 | mixed_lens: 76.0000 | lr: 2.2855e-06 | scale: 1024.00 | time: 26.945 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2690/  5000| tot_loss: 3.1941 | rl_loss: 1.8034 | pt_loss: 1.3907 | pg_loss: 0.3047 | reg_loss: 1.4988 | reward: -0.4061 | rev_kl: 1.2565 | stu_lens: 50.0000 | mixed_lens: 90.0000 | lr: 2.2839e-06 | scale: 1024.00 | time: 26.871 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2691/  5000| tot_loss: 3.4804 | rl_loss: 1.7313 | pt_loss: 1.7491 | pg_loss: 0.6452 | reg_loss: 1.0861 | reward: -0.5111 | rev_kl: 0.5267 | stu_lens: 24.5000 | mixed_lens: 37.5000 | lr: 2.2823e-06 | scale: 1024.00 | time: 26.856 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2692/  5000| tot_loss: 2.6413 | rl_loss: 1.1369 | pt_loss: 1.5044 | pg_loss: 0.3347 | reg_loss: 0.8023 | reward: 0.1401 | rev_kl: 0.8072 | stu_lens: 21.0000 | mixed_lens: 48.5000 | lr: 2.2807e-06 | scale: 1024.00 | time: 26.878 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2693/  5000| tot_loss: 2.7605 | rl_loss: 1.3285 | pt_loss: 1.4320 | pg_loss: 0.2900 | reg_loss: 1.0385 | reward: -0.8520 | rev_kl: 0.8058 | stu_lens: 124.0000 | mixed_lens: 74.5000 | lr: 2.2791e-06 | scale: 1024.00 | time: 26.854 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2694/  5000| tot_loss: 2.2885 | rl_loss: 0.8058 | pt_loss: 1.4827 | pg_loss: 0.2014 | reg_loss: 0.6044 | reward: -0.7095 | rev_kl: 1.4461 | stu_lens: 128.0000 | mixed_lens: 81.0000 | lr: 2.2775e-06 | scale: 1024.00 | time: 26.867 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2695/  5000| tot_loss: 3.0077 | rl_loss: 1.1723 | pt_loss: 1.8354 | pg_loss: 0.0435 | reg_loss: 1.1288 | reward: -0.1916 | rev_kl: 0.9183 | stu_lens: 112.0000 | mixed_lens: 128.0000 | lr: 2.2759e-06 | scale: 1024.00 | time: 26.845 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2696/  5000| tot_loss: 2.8244 | rl_loss: 1.2952 | pt_loss: 1.5293 | pg_loss: 0.2541 | reg_loss: 1.0411 | reward: -0.2654 | rev_kl: 0.5655 | stu_lens: 106.0000 | mixed_lens: 99.0000 | lr: 2.2743e-06 | scale: 1024.00 | time: 26.858 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2697/  5000| tot_loss: 3.5373 | rl_loss: 1.7922 | pt_loss: 1.7451 | pg_loss: 0.4122 | reg_loss: 1.3800 | reward: -0.4365 | rev_kl: 59.2845 | stu_lens: 78.5000 | mixed_lens: 82.0000 | lr: 2.2727e-06 | scale: 1024.00 | time: 26.884 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2698/  5000| tot_loss: 3.6489 | rl_loss: 1.8606 | pt_loss: 1.7883 | pg_loss: 0.2311 | reg_loss: 1.6295 | reward: -0.3104 | rev_kl: 1.2892 | stu_lens: 111.0000 | mixed_lens: 114.5000 | lr: 2.2711e-06 | scale: 1024.00 | time: 26.916 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2699/  5000| tot_loss: 2.5278 | rl_loss: 1.1336 | pt_loss: 1.3943 | pg_loss: 0.1913 | reg_loss: 0.9423 | reward: -0.0864 | rev_kl: 1.3169 | stu_lens: 70.5000 | mixed_lens: 95.5000 | lr: 2.2695e-06 | scale: 1024.00 | time: 26.915 | step time: 0.000
                                 Evaluation #27                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Bob's chances of survival are 31% if │
│                                       │ he carries Alice to safety. But if   │
│                                       │ he leaves her, his chances improve   │
│                                       │ to 9%. So he should leave Alice,     │
│                                       │ because his chances of survival are  │
│                                       │ better.                              │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ mz kezboard tzpe z because mz is the │
│                                       │ first letter of the alphabet and     │
│                                       │ kezboard is a keyboard               │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support 5 languages: English,     │
│                                       │ Spanish, French, Dutch, and German.  │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.445 | exact_match: 0.215 | rev_kl: 1.136 | lens: 90.651 | pt_loss: 1.074 | lm_loss: 1.156 | kd_loss: 0.992 
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2700/  5000| tot_loss: 3.1279 | rl_loss: 1.3230 | pt_loss: 1.8049 | pg_loss: 0.2071 | reg_loss: 1.1159 | reward: -0.2355 | rev_kl: 0.8790 | stu_lens: 112.5000 | mixed_lens: 109.0000 | lr: 2.2679e-06 | scale: 1024.00 | time: 26.919 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2701/  5000| tot_loss: 4.0747 | rl_loss: 1.8387 | pt_loss: 2.2360 | pg_loss: 0.2999 | reg_loss: 1.5387 | reward: -0.7650 | rev_kl: 1.0648 | stu_lens: 99.5000 | mixed_lens: 99.5000 | lr: 2.2663e-06 | scale: 1024.00 | time: 26.933 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2702/  5000| tot_loss: 6.7759 | rl_loss: 5.0978 | pt_loss: 1.6781 | pg_loss: 3.3708 | reg_loss: 1.7270 | reward: -1.4433 | rev_kl: 0.2571 | stu_lens: 14.5000 | mixed_lens: 9.5000 | lr: 2.2647e-06 | scale: 1024.00 | time: 26.893 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2703/  5000| tot_loss: 2.9237 | rl_loss: 1.2044 | pt_loss: 1.7193 | pg_loss: 0.0675 | reg_loss: 1.1369 | reward: -0.2945 | rev_kl: 0.6886 | stu_lens: 73.0000 | mixed_lens: 128.0000 | lr: 2.2631e-06 | scale: 1024.00 | time: 26.917 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2704/  5000| tot_loss: 3.1636 | rl_loss: 1.4567 | pt_loss: 1.7069 | pg_loss: 0.2491 | reg_loss: 1.2077 | reward: -0.4063 | rev_kl: 1.4806 | stu_lens: 98.0000 | mixed_lens: 96.0000 | lr: 2.2615e-06 | scale: 1024.00 | time: 26.871 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2704/  5000| tot_loss: 3.2761 | rl_loss: 1.5346 | pt_loss: 1.7415 | pg_loss: 0.4613 | reg_loss: 1.0733 | reward: -0.4064 | rev_kl: 2.8331 | stu_lens: 82.4375 | mixed_lens: 81.9062 | lr: 2.2615e-06 | scale: 1024.00 | time: 26.871 | step time: 28.104
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2705/  5000| tot_loss: 2.2397 | rl_loss: 0.7188 | pt_loss: 1.5209 | pg_loss: 0.0942 | reg_loss: 0.6246 | reward: -0.2191 | rev_kl: 0.6242 | stu_lens: 128.0000 | mixed_lens: 112.0000 | lr: 2.2599e-06 | scale: 1024.00 | time: 26.890 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2706/  5000| tot_loss: 2.8133 | rl_loss: 0.8991 | pt_loss: 1.9142 | pg_loss: 0.0727 | reg_loss: 0.8263 | reward: -0.1026 | rev_kl: 0.9619 | stu_lens: 112.0000 | mixed_lens: 121.0000 | lr: 2.2583e-06 | scale: 1024.00 | time: 26.851 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2707/  5000| tot_loss: 2.9272 | rl_loss: 1.2523 | pt_loss: 1.6749 | pg_loss: 0.3494 | reg_loss: 0.9030 | reward: -0.2824 | rev_kl: 0.6550 | stu_lens: 53.5000 | mixed_lens: 73.0000 | lr: 2.2568e-06 | scale: 1024.00 | time: 26.885 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2708/  5000| tot_loss: 2.4468 | rl_loss: 1.0389 | pt_loss: 1.4080 | pg_loss: 0.2320 | reg_loss: 0.8069 | reward: -0.2179 | rev_kl: 0.9292 | stu_lens: 105.0000 | mixed_lens: 105.0000 | lr: 2.2552e-06 | scale: 1024.00 | time: 26.863 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2709/  5000| tot_loss: 2.5222 | rl_loss: 0.7280 | pt_loss: 1.7943 | pg_loss: -0.0019 | reg_loss: 0.7299 | reward: -0.0920 | rev_kl: 0.5681 | stu_lens: 51.0000 | mixed_lens: 128.0000 | lr: 2.2536e-06 | scale: 1024.00 | time: 26.870 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2710/  5000| tot_loss: 2.4658 | rl_loss: 1.0136 | pt_loss: 1.4522 | pg_loss: 0.1992 | reg_loss: 0.8145 | reward: -0.2247 | rev_kl: 0.4374 | stu_lens: 65.0000 | mixed_lens: 65.0000 | lr: 2.2520e-06 | scale: 1024.00 | time: 26.852 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2711/  5000| tot_loss: 3.2579 | rl_loss: 1.5108 | pt_loss: 1.7471 | pg_loss: 0.5503 | reg_loss: 0.9606 | reward: -0.2475 | rev_kl: 1.0950 | stu_lens: 112.0000 | mixed_lens: 32.5000 | lr: 2.2504e-06 | scale: 1024.00 | time: 26.860 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2712/  5000| tot_loss: 2.2537 | rl_loss: 0.7498 | pt_loss: 1.5039 | pg_loss: 0.2414 | reg_loss: 0.5084 | reward: -0.2729 | rev_kl: 0.7582 | stu_lens: 71.0000 | mixed_lens: 71.0000 | lr: 2.2488e-06 | scale: 1024.00 | time: 26.839 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2713/  5000| tot_loss: 2.7633 | rl_loss: 0.9602 | pt_loss: 1.8030 | pg_loss: 0.2586 | reg_loss: 0.7016 | reward: -0.3976 | rev_kl: 1.0070 | stu_lens: 104.5000 | mixed_lens: 91.0000 | lr: 2.2472e-06 | scale: 1024.00 | time: 26.862 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2714/  5000| tot_loss: 2.4517 | rl_loss: 1.0914 | pt_loss: 1.3603 | pg_loss: 0.2439 | reg_loss: 0.8475 | reward: -0.2362 | rev_kl: 0.8975 | stu_lens: 98.5000 | mixed_lens: 104.0000 | lr: 2.2456e-06 | scale: 1024.00 | time: 26.802 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2715/  5000| tot_loss: 2.2416 | rl_loss: 0.3745 | pt_loss: 1.8672 | pg_loss: 0.0075 | reg_loss: 0.3670 | reward: -0.1946 | rev_kl: 0.5470 | stu_lens: 112.5000 | mixed_lens: 128.0000 | lr: 2.2440e-06 | scale: 1024.00 | time: 26.899 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2716/  5000| tot_loss: 2.3705 | rl_loss: 0.9081 | pt_loss: 1.4624 | pg_loss: 0.1803 | reg_loss: 0.7278 | reward: -0.2832 | rev_kl: 0.9714 | stu_lens: 92.5000 | mixed_lens: 90.5000 | lr: 2.2424e-06 | scale: 1024.00 | time: 26.848 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2717/  5000| tot_loss: 3.1408 | rl_loss: 1.4734 | pt_loss: 1.6674 | pg_loss: 0.4616 | reg_loss: 1.0118 | reward: -0.3326 | rev_kl: 1.2446 | stu_lens: 53.0000 | mixed_lens: 71.0000 | lr: 2.2408e-06 | scale: 1024.00 | time: 26.870 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2718/  5000| tot_loss: 2.4939 | rl_loss: 1.1386 | pt_loss: 1.3553 | pg_loss: 0.6147 | reg_loss: 0.5239 | reward: 0.2976 | rev_kl: 0.4528 | stu_lens: 15.0000 | mixed_lens: 41.0000 | lr: 2.2392e-06 | scale: 1024.00 | time: 26.855 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2719/  5000| tot_loss: 2.8017 | rl_loss: 1.2070 | pt_loss: 1.5947 | pg_loss: 0.7703 | reg_loss: 0.4367 | reward: -0.3367 | rev_kl: 0.5042 | stu_lens: 25.5000 | mixed_lens: 21.0000 | lr: 2.2376e-06 | scale: 1024.00 | time: 26.899 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2720/  5000| tot_loss: 2.8054 | rl_loss: 0.9635 | pt_loss: 1.8419 | pg_loss: -0.0052 | reg_loss: 0.9687 | reward: -0.0554 | rev_kl: 1.0225 | stu_lens: 123.5000 | mixed_lens: 128.0000 | lr: 2.2360e-06 | scale: 1024.00 | time: 26.875 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2720/  5000| tot_loss: 2.6777 | rl_loss: 1.0684 | pt_loss: 1.6093 | pg_loss: 0.3147 | reg_loss: 0.7537 | reward: -0.3618 | rev_kl: 0.8832 | stu_lens: 82.7500 | mixed_lens: 83.1875 | lr: 2.2360e-06 | scale: 1024.00 | time: 26.875 | step time: 28.075
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2721/  5000| tot_loss: 2.3032 | rl_loss: 0.9605 | pt_loss: 1.3428 | pg_loss: 0.1456 | reg_loss: 0.8148 | reward: -0.3500 | rev_kl: 59.3429 | stu_lens: 102.0000 | mixed_lens: 103.0000 | lr: 2.2344e-06 | scale: 1024.00 | time: 26.918 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2722/  5000| tot_loss: 2.4756 | rl_loss: 0.8982 | pt_loss: 1.5774 | pg_loss: 0.2640 | reg_loss: 0.6342 | reward: -0.1188 | rev_kl: 0.5995 | stu_lens: 56.0000 | mixed_lens: 88.5000 | lr: 2.2328e-06 | scale: 1024.00 | time: 26.895 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2723/  5000| tot_loss: 2.4171 | rl_loss: 0.6704 | pt_loss: 1.7468 | pg_loss: 0.2336 | reg_loss: 0.4368 | reward: -0.4109 | rev_kl: 1.0912 | stu_lens: 128.0000 | mixed_lens: 79.0000 | lr: 2.2312e-06 | scale: 1024.00 | time: 26.921 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2724/  5000| tot_loss: 2.0036 | rl_loss: 0.8703 | pt_loss: 1.1333 | pg_loss: 0.3762 | reg_loss: 0.4941 | reward: -0.9056 | rev_kl: 1.3157 | stu_lens: 120.5000 | mixed_lens: 74.5000 | lr: 2.2296e-06 | scale: 1024.00 | time: 26.909 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2725/  5000| tot_loss: 3.6820 | rl_loss: 1.7833 | pt_loss: 1.8987 | pg_loss: 1.1991 | reg_loss: 0.5843 | reward: -1.2605 | rev_kl: 1.5624 | stu_lens: 85.5000 | mixed_lens: 34.0000 | lr: 2.2281e-06 | scale: 1024.00 | time: 26.975 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2726/  5000| tot_loss: 2.4846 | rl_loss: 0.5758 | pt_loss: 1.9088 | pg_loss: -0.0101 | reg_loss: 0.5859 | reward: -0.1454 | rev_kl: 0.8230 | stu_lens: 123.5000 | mixed_lens: 128.0000 | lr: 2.2265e-06 | scale: 1024.00 | time: 26.861 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2727/  5000| tot_loss: 2.2413 | rl_loss: 0.4781 | pt_loss: 1.7631 | pg_loss: 0.1410 | reg_loss: 0.3371 | reward: -0.0742 | rev_kl: 0.7321 | stu_lens: 80.0000 | mixed_lens: 94.5000 | lr: 2.2249e-06 | scale: 1024.00 | time: 26.879 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2728/  5000| tot_loss: 2.2133 | rl_loss: 0.2015 | pt_loss: 2.0118 | pg_loss: 0.0539 | reg_loss: 0.1475 | reward: 0.1153 | rev_kl: 0.6249 | stu_lens: 71.0000 | mixed_lens: 72.5000 | lr: 2.2233e-06 | scale: 1024.00 | time: 26.852 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2729/  5000| tot_loss: 2.2490 | rl_loss: 0.5826 | pt_loss: 1.6664 | pg_loss: 0.1358 | reg_loss: 0.4468 | reward: -0.2722 | rev_kl: 1.3888 | stu_lens: 76.0000 | mixed_lens: 99.5000 | lr: 2.2217e-06 | scale: 1024.00 | time: 26.874 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2730/  5000| tot_loss: 2.3921 | rl_loss: 0.7421 | pt_loss: 1.6500 | pg_loss: 0.2258 | reg_loss: 0.5164 | reward: -0.3590 | rev_kl: 1.1160 | stu_lens: 92.5000 | mixed_lens: 89.5000 | lr: 2.2201e-06 | scale: 1024.00 | time: 26.853 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2731/  5000| tot_loss: 3.1433 | rl_loss: 1.6541 | pt_loss: 1.4892 | pg_loss: 0.8603 | reg_loss: 0.7937 | reward: -0.7081 | rev_kl: 0.6257 | stu_lens: 46.5000 | mixed_lens: 46.5000 | lr: 2.2185e-06 | scale: 1024.00 | time: 26.872 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2732/  5000| tot_loss: 2.3330 | rl_loss: 0.7915 | pt_loss: 1.5415 | pg_loss: 0.2132 | reg_loss: 0.5783 | reward: -0.2963 | rev_kl: 0.7938 | stu_lens: 104.5000 | mixed_lens: 92.0000 | lr: 2.2169e-06 | scale: 1024.00 | time: 26.837 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2733/  5000| tot_loss: 3.5788 | rl_loss: 1.5183 | pt_loss: 2.0604 | pg_loss: 0.7350 | reg_loss: 0.7834 | reward: -1.5836 | rev_kl: 0.8771 | stu_lens: 77.5000 | mixed_lens: 56.5000 | lr: 2.2153e-06 | scale: 1024.00 | time: 26.846 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2734/  5000| tot_loss: 3.0704 | rl_loss: 1.5901 | pt_loss: 1.4803 | pg_loss: 1.1208 | reg_loss: 0.4693 | reward: -0.4795 | rev_kl: 0.3709 | stu_lens: 16.0000 | mixed_lens: 16.0000 | lr: 2.2137e-06 | scale: 1024.00 | time: 26.807 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2735/  5000| tot_loss: 2.4642 | rl_loss: 1.0341 | pt_loss: 1.4300 | pg_loss: 0.0783 | reg_loss: 0.9558 | reward: -0.2255 | rev_kl: 1.4232 | stu_lens: 111.0000 | mixed_lens: 114.5000 | lr: 2.2121e-06 | scale: 1024.00 | time: 26.859 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2736/  5000| tot_loss: 2.8547 | rl_loss: 0.9648 | pt_loss: 1.8899 | pg_loss: 0.4379 | reg_loss: 0.5268 | reward: 0.1641 | rev_kl: 0.5460 | stu_lens: 49.5000 | mixed_lens: 65.0000 | lr: 2.2105e-06 | scale: 1024.00 | time: 26.837 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2736/  5000| tot_loss: 2.5858 | rl_loss: 0.9238 | pt_loss: 1.6620 | pg_loss: 0.3961 | reg_loss: 0.5277 | reward: -0.3382 | rev_kl: 4.5469 | stu_lens: 81.5625 | mixed_lens: 81.3750 | lr: 2.2105e-06 | scale: 1024.00 | time: 26.837 | step time: 28.086
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2737/  5000| tot_loss: 1.6617 | rl_loss: 0.5617 | pt_loss: 1.1000 | pg_loss: 0.0216 | reg_loss: 0.5402 | reward: -0.3227 | rev_kl: 0.5671 | stu_lens: 65.0000 | mixed_lens: 123.0000 | lr: 2.2089e-06 | scale: 1024.00 | time: 26.941 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2738/  5000| tot_loss: 3.1031 | rl_loss: 1.5812 | pt_loss: 1.5219 | pg_loss: 1.0221 | reg_loss: 0.5591 | reward: -0.1399 | rev_kl: 0.6271 | stu_lens: 17.0000 | mixed_lens: 31.5000 | lr: 2.2074e-06 | scale: 1024.00 | time: 26.866 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2739/  5000| tot_loss: 2.6682 | rl_loss: 0.9341 | pt_loss: 1.7341 | pg_loss: 0.3801 | reg_loss: 0.5540 | reward: -0.1504 | rev_kl: 0.2541 | stu_lens: 20.0000 | mixed_lens: 75.0000 | lr: 2.2058e-06 | scale: 1024.00 | time: 26.889 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2740/  5000| tot_loss: 2.2617 | rl_loss: 0.5866 | pt_loss: 1.6752 | pg_loss: 0.2114 | reg_loss: 0.3752 | reward: -0.7843 | rev_kl: 1.6113 | stu_lens: 128.0000 | mixed_lens: 81.0000 | lr: 2.2042e-06 | scale: 1024.00 | time: 26.871 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2741/  5000| tot_loss: 2.1724 | rl_loss: 0.6567 | pt_loss: 1.5157 | pg_loss: 0.3217 | reg_loss: 0.3350 | reward: -0.2617 | rev_kl: 0.2745 | stu_lens: 54.0000 | mixed_lens: 61.5000 | lr: 2.2026e-06 | scale: 1024.00 | time: 26.900 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2742/  5000| tot_loss: 2.2536 | rl_loss: 0.5357 | pt_loss: 1.7178 | pg_loss: 0.0473 | reg_loss: 0.4885 | reward: -0.3196 | rev_kl: 1.0716 | stu_lens: 128.0000 | mixed_lens: 113.0000 | lr: 2.2010e-06 | scale: 1024.00 | time: 26.885 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2743/  5000| tot_loss: 2.6922 | rl_loss: 0.7117 | pt_loss: 1.9805 | pg_loss: 0.3955 | reg_loss: 0.3161 | reward: -0.4233 | rev_kl: 1.3038 | stu_lens: 81.0000 | mixed_lens: 80.0000 | lr: 2.1994e-06 | scale: 1024.00 | time: 26.906 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2744/  5000| tot_loss: 2.4367 | rl_loss: 0.7106 | pt_loss: 1.7261 | pg_loss: 0.0942 | reg_loss: 0.6164 | reward: -0.2570 | rev_kl: 1.0316 | stu_lens: 112.0000 | mixed_lens: 112.0000 | lr: 2.1978e-06 | scale: 1024.00 | time: 26.889 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2745/  5000| tot_loss: 1.8531 | rl_loss: 0.1550 | pt_loss: 1.6981 | pg_loss: -0.1822 | reg_loss: 0.3372 | reward: -0.5774 | rev_kl: 0.7643 | stu_lens: 73.0000 | mixed_lens: 27.5000 | lr: 2.1962e-06 | scale: 1024.00 | time: 26.935 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2746/  5000| tot_loss: 2.9064 | rl_loss: 0.5519 | pt_loss: 2.3545 | pg_loss: 0.1466 | reg_loss: 0.4052 | reward: -0.3389 | rev_kl: 1.0349 | stu_lens: 89.5000 | mixed_lens: 105.0000 | lr: 2.1946e-06 | scale: 1024.00 | time: 26.926 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2747/  5000| tot_loss: 1.9875 | rl_loss: 0.3931 | pt_loss: 1.5944 | pg_loss: 0.0388 | reg_loss: 0.3543 | reward: -0.1742 | rev_kl: 0.7924 | stu_lens: 128.0000 | mixed_lens: 127.0000 | lr: 2.1930e-06 | scale: 1024.00 | time: 26.899 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2748/  5000| tot_loss: 1.9402 | rl_loss: 0.3022 | pt_loss: 1.6380 | pg_loss: 0.1085 | reg_loss: 0.1937 | reward: -0.0594 | rev_kl: 0.5594 | stu_lens: 78.0000 | mixed_lens: 104.0000 | lr: 2.1914e-06 | scale: 1024.00 | time: 26.861 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2749/  5000| tot_loss: 2.5250 | rl_loss: 1.1517 | pt_loss: 1.3733 | pg_loss: 0.7967 | reg_loss: 0.3550 | reward: -1.2853 | rev_kl: 0.7704 | stu_lens: 79.0000 | mixed_lens: 48.0000 | lr: 2.1898e-06 | scale: 1024.00 | time: 26.871 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/2750
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2750/  5000| tot_loss: 2.0844 | rl_loss: 0.4730 | pt_loss: 1.6114 | pg_loss: 0.2171 | reg_loss: 0.2559 | reward: -0.2107 | rev_kl: 0.8187 | stu_lens: 82.5000 | mixed_lens: 92.0000 | lr: 2.1883e-06 | scale: 1024.00 | time: 26.831 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2751/  5000| tot_loss: 3.0768 | rl_loss: 0.9007 | pt_loss: 2.1760 | pg_loss: 0.3653 | reg_loss: 0.5354 | reward: -0.2695 | rev_kl: 0.9469 | stu_lens: 92.5000 | mixed_lens: 71.5000 | lr: 2.1867e-06 | scale: 1024.00 | time: 26.857 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2752/  5000| tot_loss: 2.0183 | rl_loss: 0.4134 | pt_loss: 1.6050 | pg_loss: 0.0056 | reg_loss: 0.4077 | reward: -0.1459 | rev_kl: 1.1053 | stu_lens: 125.0000 | mixed_lens: 128.0000 | lr: 2.1851e-06 | scale: 1024.00 | time: 26.845 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2752/  5000| tot_loss: 2.4777 | rl_loss: 0.7574 | pt_loss: 1.7203 | pg_loss: 0.3338 | reg_loss: 0.4237 | reward: -0.3872 | rev_kl: 2.7202 | stu_lens: 80.0625 | mixed_lens: 81.7812 | lr: 2.1851e-06 | scale: 1024.00 | time: 26.845 | step time: 28.098
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2753/  5000| tot_loss: 1.8240 | rl_loss: 0.1610 | pt_loss: 1.6629 | pg_loss: 0.0185 | reg_loss: 0.1425 | reward: -0.0924 | rev_kl: 0.4081 | stu_lens: 128.0000 | mixed_lens: 124.5000 | lr: 2.1835e-06 | scale: 1024.00 | time: 26.901 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2754/  5000| tot_loss: 3.0648 | rl_loss: 1.4073 | pt_loss: 1.6575 | pg_loss: 0.0795 | reg_loss: 1.3277 | reward: -0.1833 | rev_kl: 0.6887 | stu_lens: 90.0000 | mixed_lens: 127.0000 | lr: 2.1819e-06 | scale: 1024.00 | time: 26.837 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2755/  5000| tot_loss: 3.6739 | rl_loss: 1.8248 | pt_loss: 1.8491 | pg_loss: 0.3890 | reg_loss: 1.4358 | reward: -0.3705 | rev_kl: 1.3620 | stu_lens: 106.5000 | mixed_lens: 80.5000 | lr: 2.1803e-06 | scale: 1024.00 | time: 26.827 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2756/  5000| tot_loss: 1.9089 | rl_loss: 0.7941 | pt_loss: 1.1148 | pg_loss: 0.0596 | reg_loss: 0.7345 | reward: -0.1952 | rev_kl: 1.1905 | stu_lens: 107.0000 | mixed_lens: 128.0000 | lr: 2.1787e-06 | scale: 1024.00 | time: 26.815 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2757/  5000| tot_loss: 3.1303 | rl_loss: 1.3491 | pt_loss: 1.7812 | pg_loss: 0.5815 | reg_loss: 0.7675 | reward: 0.0109 | rev_kl: 0.7030 | stu_lens: 38.5000 | mixed_lens: 51.0000 | lr: 2.1771e-06 | scale: 1024.00 | time: 26.879 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2758/  5000| tot_loss: 3.1533 | rl_loss: 1.1379 | pt_loss: 2.0154 | pg_loss: 0.4582 | reg_loss: 0.6797 | reward: -0.2078 | rev_kl: 1.1475 | stu_lens: 72.5000 | mixed_lens: 71.5000 | lr: 2.1755e-06 | scale: 1024.00 | time: 26.823 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2759/  5000| tot_loss: 2.8393 | rl_loss: 1.2176 | pt_loss: 1.6217 | pg_loss: 0.2698 | reg_loss: 0.9477 | reward: -0.2057 | rev_kl: 0.9366 | stu_lens: 105.0000 | mixed_lens: 92.0000 | lr: 2.1739e-06 | scale: 1024.00 | time: 26.846 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2760/  5000| tot_loss: 2.9164 | rl_loss: 1.0450 | pt_loss: 1.8714 | pg_loss: 0.0505 | reg_loss: 0.9945 | reward: -0.2005 | rev_kl: 0.6296 | stu_lens: 91.5000 | mixed_lens: 128.0000 | lr: 2.1724e-06 | scale: 1024.00 | time: 26.830 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2761/  5000| tot_loss: 2.9626 | rl_loss: 1.8050 | pt_loss: 1.1576 | pg_loss: 1.1807 | reg_loss: 0.6243 | reward: -0.3269 | rev_kl: 0.3405 | stu_lens: 28.5000 | mixed_lens: 21.0000 | lr: 2.1708e-06 | scale: 1024.00 | time: 26.855 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2762/  5000| tot_loss: 2.7605 | rl_loss: 1.4506 | pt_loss: 1.3099 | pg_loss: 0.2300 | reg_loss: 1.2206 | reward: -0.3961 | rev_kl: 1.0294 | stu_lens: 74.0000 | mixed_lens: 105.0000 | lr: 2.1692e-06 | scale: 1024.00 | time: 26.835 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2763/  5000| tot_loss: 4.8043 | rl_loss: 2.9284 | pt_loss: 1.8758 | pg_loss: 1.6863 | reg_loss: 1.2421 | reward: -1.2143 | rev_kl: 1.2629 | stu_lens: 16.0000 | mixed_lens: 20.5000 | lr: 2.1676e-06 | scale: 1024.00 | time: 26.858 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2764/  5000| tot_loss: 3.3498 | rl_loss: 1.2916 | pt_loss: 2.0581 | pg_loss: 0.1905 | reg_loss: 1.1011 | reward: -0.3025 | rev_kl: 0.9179 | stu_lens: 55.0000 | mixed_lens: 95.5000 | lr: 2.1660e-06 | scale: 1024.00 | time: 26.839 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2765/  5000| tot_loss: 2.6394 | rl_loss: 0.7903 | pt_loss: 1.8492 | pg_loss: 0.2084 | reg_loss: 0.5819 | reward: -0.1013 | rev_kl: 0.2973 | stu_lens: 93.0000 | mixed_lens: 93.0000 | lr: 2.1644e-06 | scale: 1024.00 | time: 26.878 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2766/  5000| tot_loss: 2.3220 | rl_loss: 1.0535 | pt_loss: 1.2685 | pg_loss: 0.1144 | reg_loss: 0.9391 | reward: -0.2209 | rev_kl: 0.6401 | stu_lens: 86.0000 | mixed_lens: 101.5000 | lr: 2.1628e-06 | scale: 1024.00 | time: 26.851 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2767/  5000| tot_loss: 3.2556 | rl_loss: 1.8143 | pt_loss: 1.4413 | pg_loss: 0.5436 | reg_loss: 1.2707 | reward: -0.1814 | rev_kl: 0.5986 | stu_lens: 58.0000 | mixed_lens: 67.0000 | lr: 2.1612e-06 | scale: 1024.00 | time: 26.920 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2768/  5000| tot_loss: 3.3134 | rl_loss: 1.7411 | pt_loss: 1.5723 | pg_loss: 0.4024 | reg_loss: 1.3387 | reward: -0.3776 | rev_kl: 0.7427 | stu_lens: 112.0000 | mixed_lens: 73.5000 | lr: 2.1597e-06 | scale: 1024.00 | time: 26.878 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2768/  5000| tot_loss: 3.2095 | rl_loss: 1.5181 | pt_loss: 1.6914 | pg_loss: 0.4998 | reg_loss: 1.0183 | reward: -0.3334 | rev_kl: 0.8815 | stu_lens: 82.9219 | mixed_lens: 83.0625 | lr: 2.1597e-06 | scale: 1024.00 | time: 26.878 | step time: 28.067
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2769/  5000| tot_loss: 2.7673 | rl_loss: 1.4407 | pt_loss: 1.3266 | pg_loss: 0.2396 | reg_loss: 1.2011 | reward: -0.2026 | rev_kl: 0.8413 | stu_lens: 118.5000 | mixed_lens: 102.5000 | lr: 2.1581e-06 | scale: 1024.00 | time: 26.905 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2770/  5000| tot_loss: 3.0649 | rl_loss: 1.4049 | pt_loss: 1.6600 | pg_loss: 0.5718 | reg_loss: 0.8332 | reward: -0.4460 | rev_kl: 0.9367 | stu_lens: 93.0000 | mixed_lens: 42.5000 | lr: 2.1565e-06 | scale: 1024.00 | time: 26.897 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2771/  5000| tot_loss: 2.1988 | rl_loss: 0.3959 | pt_loss: 1.8028 | pg_loss: -0.0078 | reg_loss: 0.4037 | reward: -0.1219 | rev_kl: 0.3684 | stu_lens: 91.5000 | mixed_lens: 128.0000 | lr: 2.1549e-06 | scale: 1024.00 | time: 26.855 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2772/  5000| tot_loss: 2.6040 | rl_loss: 0.7209 | pt_loss: 1.8831 | pg_loss: 0.3066 | reg_loss: 0.4143 | reward: -0.0322 | rev_kl: 0.1353 | stu_lens: 71.0000 | mixed_lens: 71.0000 | lr: 2.1533e-06 | scale: 1024.00 | time: 26.831 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2773/  5000| tot_loss: 2.4735 | rl_loss: 0.8249 | pt_loss: 1.6486 | pg_loss: 0.0268 | reg_loss: 0.7980 | reward: -0.3105 | rev_kl: 0.9084 | stu_lens: 93.0000 | mixed_lens: 127.0000 | lr: 2.1517e-06 | scale: 1024.00 | time: 26.850 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2774/  5000| tot_loss: 3.0592 | rl_loss: 1.0912 | pt_loss: 1.9680 | pg_loss: 0.1100 | reg_loss: 0.9812 | reward: -0.1750 | rev_kl: 1.2274 | stu_lens: 97.5000 | mixed_lens: 111.5000 | lr: 2.1501e-06 | scale: 1024.00 | time: 26.836 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2775/  5000| tot_loss: 2.7382 | rl_loss: 1.1651 | pt_loss: 1.5731 | pg_loss: 0.1540 | reg_loss: 1.0111 | reward: -0.2734 | rev_kl: 0.8696 | stu_lens: 128.0000 | mixed_lens: 109.0000 | lr: 2.1485e-06 | scale: 1024.00 | time: 26.867 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2776/  5000| tot_loss: 2.4458 | rl_loss: 0.8019 | pt_loss: 1.6439 | pg_loss: 0.1384 | reg_loss: 0.6635 | reward: -0.2484 | rev_kl: 0.8639 | stu_lens: 90.5000 | mixed_lens: 104.0000 | lr: 2.1470e-06 | scale: 1024.00 | time: 26.820 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2777/  5000| tot_loss: 3.0813 | rl_loss: 1.2555 | pt_loss: 1.8258 | pg_loss: 0.5055 | reg_loss: 0.7500 | reward: -0.8804 | rev_kl: 1.3548 | stu_lens: 73.5000 | mixed_lens: 74.0000 | lr: 2.1454e-06 | scale: 1024.00 | time: 26.844 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2778/  5000| tot_loss: 3.3962 | rl_loss: 1.4549 | pt_loss: 1.9413 | pg_loss: 0.6408 | reg_loss: 0.8141 | reward: -0.5660 | rev_kl: 0.8977 | stu_lens: 50.0000 | mixed_lens: 61.5000 | lr: 2.1438e-06 | scale: 1024.00 | time: 26.835 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2779/  5000| tot_loss: 3.6749 | rl_loss: 2.2168 | pt_loss: 1.4580 | pg_loss: 1.5938 | reg_loss: 0.6230 | reward: -0.5385 | rev_kl: 1.0777 | stu_lens: 97.5000 | mixed_lens: 25.0000 | lr: 2.1422e-06 | scale: 1024.00 | time: 26.858 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2780/  5000| tot_loss: 2.1295 | rl_loss: 0.4523 | pt_loss: 1.6772 | pg_loss: -0.0780 | reg_loss: 0.5303 | reward: -0.2921 | rev_kl: 0.6591 | stu_lens: 47.5000 | mixed_lens: 27.0000 | lr: 2.1406e-06 | scale: 1024.00 | time: 26.818 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2781/  5000| tot_loss: 2.4669 | rl_loss: 0.8458 | pt_loss: 1.6211 | pg_loss: 0.4333 | reg_loss: 0.4126 | reward: -0.1007 | rev_kl: 0.8932 | stu_lens: 72.5000 | mixed_lens: 69.0000 | lr: 2.1390e-06 | scale: 1024.00 | time: 26.860 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2782/  5000| tot_loss: 2.4836 | rl_loss: 0.9081 | pt_loss: 1.5755 | pg_loss: 0.4731 | reg_loss: 0.4350 | reward: -0.5449 | rev_kl: 1.4332 | stu_lens: 32.0000 | mixed_lens: 57.5000 | lr: 2.1374e-06 | scale: 1024.00 | time: 26.870 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2783/  5000| tot_loss: 3.0015 | rl_loss: 1.2432 | pt_loss: 1.7583 | pg_loss: 0.3041 | reg_loss: 0.9391 | reward: -0.3469 | rev_kl: 1.2998 | stu_lens: 65.0000 | mixed_lens: 95.5000 | lr: 2.1358e-06 | scale: 1024.00 | time: 26.891 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2784/  5000| tot_loss: 2.4826 | rl_loss: 0.7665 | pt_loss: 1.7161 | pg_loss: 0.0074 | reg_loss: 0.7591 | reward: -0.2071 | rev_kl: 1.2572 | stu_lens: 98.0000 | mixed_lens: 128.0000 | lr: 2.1343e-06 | scale: 1024.00 | time: 26.874 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2784/  5000| tot_loss: 2.7967 | rl_loss: 1.0959 | pt_loss: 1.7008 | pg_loss: 0.3287 | reg_loss: 0.7672 | reward: -0.3430 | rev_kl: 0.8819 | stu_lens: 81.2500 | mixed_lens: 83.2812 | lr: 2.1343e-06 | scale: 1024.00 | time: 26.874 | step time: 28.068
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2785/  5000| tot_loss: 2.0680 | rl_loss: 0.4590 | pt_loss: 1.6090 | pg_loss: 0.1168 | reg_loss: 0.3422 | reward: -0.1231 | rev_kl: 0.9177 | stu_lens: 111.0000 | mixed_lens: 80.0000 | lr: 2.1327e-06 | scale: 1024.00 | time: 26.900 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2786/  5000| tot_loss: 2.8934 | rl_loss: 0.9714 | pt_loss: 1.9220 | pg_loss: 0.1279 | reg_loss: 0.8435 | reward: -0.2975 | rev_kl: 1.4593 | stu_lens: 104.0000 | mixed_lens: 110.0000 | lr: 2.1311e-06 | scale: 1024.00 | time: 26.858 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2787/  5000| tot_loss: 2.3694 | rl_loss: 0.8323 | pt_loss: 1.5370 | pg_loss: 0.2958 | reg_loss: 0.5365 | reward: -0.2675 | rev_kl: 1.1454 | stu_lens: 128.0000 | mixed_lens: 86.5000 | lr: 2.1295e-06 | scale: 1024.00 | time: 26.905 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2788/  5000| tot_loss: 2.7750 | rl_loss: 0.8619 | pt_loss: 1.9131 | pg_loss: 0.2685 | reg_loss: 0.5934 | reward: -0.3951 | rev_kl: 0.7403 | stu_lens: 119.0000 | mixed_lens: 90.5000 | lr: 2.1279e-06 | scale: 1024.00 | time: 26.878 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2789/  5000| tot_loss: 2.1139 | rl_loss: 0.7715 | pt_loss: 1.3424 | pg_loss: 0.2184 | reg_loss: 0.5531 | reward: -0.4229 | rev_kl: 0.7620 | stu_lens: 84.0000 | mixed_lens: 76.5000 | lr: 2.1263e-06 | scale: 1024.00 | time: 26.930 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2790/  5000| tot_loss: 2.1382 | rl_loss: 0.6202 | pt_loss: 1.5179 | pg_loss: 0.1462 | reg_loss: 0.4741 | reward: -0.3593 | rev_kl: 0.6194 | stu_lens: 128.0000 | mixed_lens: 109.0000 | lr: 2.1248e-06 | scale: 1024.00 | time: 26.888 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2791/  5000| tot_loss: 2.3646 | rl_loss: 0.5501 | pt_loss: 1.8145 | pg_loss: 0.0191 | reg_loss: 0.5310 | reward: -0.2014 | rev_kl: 0.7520 | stu_lens: 91.5000 | mixed_lens: 128.0000 | lr: 2.1232e-06 | scale: 1024.00 | time: 26.977 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2792/  5000| tot_loss: 2.2825 | rl_loss: 0.5552 | pt_loss: 1.7273 | pg_loss: 0.0858 | reg_loss: 0.4694 | reward: -0.1845 | rev_kl: 1.1722 | stu_lens: 77.0000 | mixed_lens: 111.0000 | lr: 2.1216e-06 | scale: 1024.00 | time: 26.931 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2793/  5000| tot_loss: 4.3977 | rl_loss: 2.5073 | pt_loss: 1.8904 | pg_loss: 1.9099 | reg_loss: 0.5974 | reward: -0.2470 | rev_kl: 0.8858 | stu_lens: 48.0000 | mixed_lens: 15.0000 | lr: 2.1200e-06 | scale: 1024.00 | time: 26.910 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2794/  5000| tot_loss: 2.1164 | rl_loss: 0.5111 | pt_loss: 1.6054 | pg_loss: 0.0176 | reg_loss: 0.4934 | reward: -0.2452 | rev_kl: 1.2199 | stu_lens: 84.0000 | mixed_lens: 124.5000 | lr: 2.1184e-06 | scale: 1024.00 | time: 26.871 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2795/  5000| tot_loss: 1.8795 | rl_loss: 0.6438 | pt_loss: 1.2357 | pg_loss: 0.1198 | reg_loss: 0.5240 | reward: -0.2305 | rev_kl: 1.2296 | stu_lens: 99.0000 | mixed_lens: 107.5000 | lr: 2.1168e-06 | scale: 1024.00 | time: 26.880 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2796/  5000| tot_loss: 2.4661 | rl_loss: 0.6795 | pt_loss: 1.7865 | pg_loss: 0.1314 | reg_loss: 0.5481 | reward: -0.2540 | rev_kl: 0.4842 | stu_lens: 93.0000 | mixed_lens: 92.0000 | lr: 2.1152e-06 | scale: 1024.00 | time: 26.874 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2797/  5000| tot_loss: 2.2888 | rl_loss: 0.6501 | pt_loss: 1.6386 | pg_loss: 0.1486 | reg_loss: 0.5015 | reward: -0.3272 | rev_kl: 0.9342 | stu_lens: 80.0000 | mixed_lens: 95.5000 | lr: 2.1137e-06 | scale: 1024.00 | time: 26.868 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2798/  5000| tot_loss: 2.6678 | rl_loss: 0.6018 | pt_loss: 2.0660 | pg_loss: 0.1061 | reg_loss: 0.4956 | reward: -0.1682 | rev_kl: 0.9085 | stu_lens: 111.0000 | mixed_lens: 111.0000 | lr: 2.1121e-06 | scale: 1024.00 | time: 26.871 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2799/  5000| tot_loss: 2.5796 | rl_loss: 0.6215 | pt_loss: 1.9580 | pg_loss: 0.1597 | reg_loss: 0.4618 | reward: -0.4366 | rev_kl: 0.9033 | stu_lens: 71.5000 | mixed_lens: 110.5000 | lr: 2.1105e-06 | scale: 1024.00 | time: 26.878 | step time: 0.000
                                 Evaluation #28                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Yes, Bob should leave Alice. His     │
│                                       │ odds of survival improve by 9% if he │
│                                       │ leaves her behind.                   │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ You can use either Y or Z for the    │
│                                       │ keyboard layout. For example, to     │
│                                       │ type "test", you can use "t = 0, z = │
│                                       │ 1, e = 2, s = 3, t = 0, z = 1, e =   │
│                                       │ 2, s = 3, ..." or "t = 0, y = 1, e = │
│                                       │ 2, s = 3, t = 0, y = 1, e = 2, s =   │
│                                       │ 3, ..."                              │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support over 50 languages.        │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.470 | exact_match: 0.215 | rev_kl: 1.142 | lens: 83.978 | pt_loss: 1.073 | lm_loss: 1.156 | kd_loss: 0.991 
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2800/  5000| tot_loss: 1.9337 | rl_loss: 0.2175 | pt_loss: 1.7162 | pg_loss: 0.0122 | reg_loss: 0.2053 | reward: -0.0844 | rev_kl: 0.7235 | stu_lens: 128.0000 | mixed_lens: 125.5000 | lr: 2.1089e-06 | scale: 1024.00 | time: 26.920 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2800/  5000| tot_loss: 2.6428 | rl_loss: 0.8916 | pt_loss: 1.7513 | pg_loss: 0.3904 | reg_loss: 0.5011 | reward: -0.2994 | rev_kl: 0.8910 | stu_lens: 82.6094 | mixed_lens: 80.7969 | lr: 2.1089e-06 | scale: 1024.00 | time: 26.920 | step time: 28.108
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2801/  5000| tot_loss: 2.9956 | rl_loss: 1.0714 | pt_loss: 1.9242 | pg_loss: 0.4476 | reg_loss: 0.6238 | reward: -1.3651 | rev_kl: 0.6279 | stu_lens: 36.5000 | mixed_lens: 50.5000 | lr: 2.1073e-06 | scale: 1024.00 | time: 26.877 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2802/  5000| tot_loss: 2.6328 | rl_loss: 1.0026 | pt_loss: 1.6302 | pg_loss: 0.4683 | reg_loss: 0.5343 | reward: -0.2821 | rev_kl: 0.8311 | stu_lens: 35.5000 | mixed_lens: 68.0000 | lr: 2.1057e-06 | scale: 1024.00 | time: 26.853 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2803/  5000| tot_loss: 2.2514 | rl_loss: 0.7117 | pt_loss: 1.5397 | pg_loss: 0.2318 | reg_loss: 0.4799 | reward: -0.1877 | rev_kl: 0.8664 | stu_lens: 89.5000 | mixed_lens: 91.0000 | lr: 2.1042e-06 | scale: 1024.00 | time: 26.864 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2804/  5000| tot_loss: 2.5177 | rl_loss: 0.7812 | pt_loss: 1.7365 | pg_loss: 0.2356 | reg_loss: 0.5455 | reward: 0.0144 | rev_kl: 0.9146 | stu_lens: 90.5000 | mixed_lens: 81.5000 | lr: 2.1026e-06 | scale: 1024.00 | time: 26.867 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2805/  5000| tot_loss: 1.9289 | rl_loss: 0.6500 | pt_loss: 1.2788 | pg_loss: 0.3370 | reg_loss: 0.3130 | reward: -1.3977 | rev_kl: 0.6189 | stu_lens: 32.0000 | mixed_lens: 67.0000 | lr: 2.1010e-06 | scale: 1024.00 | time: 26.855 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2806/  5000| tot_loss: 2.1218 | rl_loss: 0.5424 | pt_loss: 1.5794 | pg_loss: 0.0967 | reg_loss: 0.4456 | reward: -0.2372 | rev_kl: 1.0136 | stu_lens: 95.0000 | mixed_lens: 117.0000 | lr: 2.0994e-06 | scale: 1024.00 | time: 26.853 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2807/  5000| tot_loss: 2.4079 | rl_loss: 0.7359 | pt_loss: 1.6720 | pg_loss: 0.3237 | reg_loss: 0.4123 | reward: -0.5152 | rev_kl: 0.4155 | stu_lens: 80.0000 | mixed_lens: 77.0000 | lr: 2.0978e-06 | scale: 1024.00 | time: 26.836 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2808/  5000| tot_loss: 1.9872 | rl_loss: 0.4910 | pt_loss: 1.4962 | pg_loss: 0.0876 | reg_loss: 0.4035 | reward: -0.1143 | rev_kl: 1.1684 | stu_lens: 103.0000 | mixed_lens: 111.0000 | lr: 2.0963e-06 | scale: 1024.00 | time: 26.855 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2809/  5000| tot_loss: 2.3196 | rl_loss: 0.7217 | pt_loss: 1.5979 | pg_loss: 0.5472 | reg_loss: 0.1745 | reward: -0.1362 | rev_kl: 0.0134 | stu_lens: 45.0000 | mixed_lens: 46.0000 | lr: 2.0947e-06 | scale: 1024.00 | time: 26.836 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2810/  5000| tot_loss: 2.1845 | rl_loss: 0.5504 | pt_loss: 1.6341 | pg_loss: 0.0710 | reg_loss: 0.4794 | reward: -0.4110 | rev_kl: 1.0043 | stu_lens: 103.0000 | mixed_lens: 116.5000 | lr: 2.0931e-06 | scale: 1024.00 | time: 26.865 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2811/  5000| tot_loss: 2.7335 | rl_loss: 0.9818 | pt_loss: 1.7517 | pg_loss: 0.3416 | reg_loss: 0.6402 | reward: -0.3518 | rev_kl: 1.1628 | stu_lens: 93.0000 | mixed_lens: 81.5000 | lr: 2.0915e-06 | scale: 1024.00 | time: 26.892 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2812/  5000| tot_loss: 2.1145 | rl_loss: 0.4236 | pt_loss: 1.6909 | pg_loss: -0.0092 | reg_loss: 0.4328 | reward: -0.3386 | rev_kl: 0.9148 | stu_lens: 98.5000 | mixed_lens: 123.5000 | lr: 2.0899e-06 | scale: 1024.00 | time: 26.866 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2813/  5000| tot_loss: 2.5019 | rl_loss: 0.6708 | pt_loss: 1.8312 | pg_loss: 0.2322 | reg_loss: 0.4386 | reward: -0.3416 | rev_kl: 1.4704 | stu_lens: 87.0000 | mixed_lens: 75.0000 | lr: 2.0883e-06 | scale: 1024.00 | time: 26.847 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2814/  5000| tot_loss: 2.8672 | rl_loss: 0.8883 | pt_loss: 1.9789 | pg_loss: 0.3692 | reg_loss: 0.5191 | reward: -0.3752 | rev_kl: 1.5441 | stu_lens: 96.5000 | mixed_lens: 93.0000 | lr: 2.0868e-06 | scale: 1024.00 | time: 26.871 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2815/  5000| tot_loss: 2.5754 | rl_loss: 0.6161 | pt_loss: 1.9594 | pg_loss: 0.2111 | reg_loss: 0.4050 | reward: -0.3646 | rev_kl: 0.6492 | stu_lens: 128.0000 | mixed_lens: 88.0000 | lr: 2.0852e-06 | scale: 1024.00 | time: 26.865 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2816/  5000| tot_loss: 1.8867 | rl_loss: 0.3277 | pt_loss: 1.5590 | pg_loss: 0.0084 | reg_loss: 0.3192 | reward: -0.1028 | rev_kl: 0.7614 | stu_lens: 113.5000 | mixed_lens: 128.0000 | lr: 2.0836e-06 | scale: 1024.00 | time: 26.911 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2816/  5000| tot_loss: 2.4554 | rl_loss: 0.7211 | pt_loss: 1.7343 | pg_loss: 0.2992 | reg_loss: 0.4219 | reward: -0.3711 | rev_kl: 0.8509 | stu_lens: 81.1406 | mixed_lens: 84.3594 | lr: 2.0836e-06 | scale: 1024.00 | time: 26.911 | step time: 28.078
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2817/  5000| tot_loss: 3.8244 | rl_loss: 1.9520 | pt_loss: 1.8724 | pg_loss: 1.6243 | reg_loss: 0.3278 | reward: -0.1419 | rev_kl: 0.8708 | stu_lens: 52.0000 | mixed_lens: 19.0000 | lr: 2.0820e-06 | scale: 1024.00 | time: 26.870 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2818/  5000| tot_loss: 3.7294 | rl_loss: 2.0693 | pt_loss: 1.6601 | pg_loss: 0.3876 | reg_loss: 1.6817 | reward: -0.3322 | rev_kl: 1.2678 | stu_lens: 126.5000 | mixed_lens: 86.0000 | lr: 2.0804e-06 | scale: 1024.00 | time: 26.908 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2819/  5000| tot_loss: 2.5679 | rl_loss: 1.2452 | pt_loss: 1.3227 | pg_loss: 0.2475 | reg_loss: 0.9977 | reward: -0.3275 | rev_kl: 1.1103 | stu_lens: 97.5000 | mixed_lens: 107.5000 | lr: 2.0789e-06 | scale: 1024.00 | time: 26.885 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2820/  5000| tot_loss: 2.7606 | rl_loss: 1.3256 | pt_loss: 1.4350 | pg_loss: 0.2938 | reg_loss: 1.0318 | reward: -0.3026 | rev_kl: 1.1669 | stu_lens: 86.0000 | mixed_lens: 77.0000 | lr: 2.0773e-06 | scale: 1024.00 | time: 26.875 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2821/  5000| tot_loss: 2.3617 | rl_loss: 0.8187 | pt_loss: 1.5430 | pg_loss: 0.1904 | reg_loss: 0.6283 | reward: -0.7467 | rev_kl: 0.6048 | stu_lens: 71.0000 | mixed_lens: 71.0000 | lr: 2.0757e-06 | scale: 1024.00 | time: 26.888 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2822/  5000| tot_loss: 3.3030 | rl_loss: 1.9569 | pt_loss: 1.3462 | pg_loss: 0.7169 | reg_loss: 1.2399 | reward: -0.6009 | rev_kl: 1.1612 | stu_lens: 98.5000 | mixed_lens: 59.0000 | lr: 2.0741e-06 | scale: 1024.00 | time: 26.872 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2823/  5000| tot_loss: 3.2658 | rl_loss: 1.3639 | pt_loss: 1.9019 | pg_loss: 0.2584 | reg_loss: 1.1056 | reward: -0.1230 | rev_kl: 0.8761 | stu_lens: 108.0000 | mixed_lens: 95.0000 | lr: 2.0725e-06 | scale: 1024.00 | time: 26.834 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2824/  5000| tot_loss: 3.5591 | rl_loss: 2.3110 | pt_loss: 1.2481 | pg_loss: 2.0737 | reg_loss: 0.2372 | reward: -0.5718 | rev_kl: 0.6008 | stu_lens: 7.0000 | mixed_lens: 7.5000 | lr: 2.0710e-06 | scale: 1024.00 | time: 26.811 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2825/  5000| tot_loss: 3.0554 | rl_loss: 1.2898 | pt_loss: 1.7656 | pg_loss: 0.1954 | reg_loss: 1.0944 | reward: 0.0150 | rev_kl: 1.1744 | stu_lens: 97.0000 | mixed_lens: 108.0000 | lr: 2.0694e-06 | scale: 1024.00 | time: 26.835 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2826/  5000| tot_loss: 3.5931 | rl_loss: 2.0629 | pt_loss: 1.5303 | pg_loss: 0.2885 | reg_loss: 1.7744 | reward: 0.4082 | rev_kl: 0.8940 | stu_lens: 52.5000 | mixed_lens: 69.5000 | lr: 2.0678e-06 | scale: 1024.00 | time: 26.818 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2827/  5000| tot_loss: 2.5768 | rl_loss: 1.5672 | pt_loss: 1.0096 | pg_loss: 0.2627 | reg_loss: 1.3045 | reward: -0.2089 | rev_kl: 1.0720 | stu_lens: 110.5000 | mixed_lens: 101.0000 | lr: 2.0662e-06 | scale: 1024.00 | time: 26.841 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2828/  5000| tot_loss: 3.3770 | rl_loss: 1.5182 | pt_loss: 1.8587 | pg_loss: 0.1630 | reg_loss: 1.3553 | reward: -0.2333 | rev_kl: 0.9000 | stu_lens: 104.5000 | mixed_lens: 110.5000 | lr: 2.0647e-06 | scale: 1024.00 | time: 26.823 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2829/  5000| tot_loss: 3.5670 | rl_loss: 1.5698 | pt_loss: 1.9972 | pg_loss: 0.3217 | reg_loss: 1.2481 | reward: -0.4629 | rev_kl: 1.0492 | stu_lens: 77.0000 | mixed_lens: 100.0000 | lr: 2.0631e-06 | scale: 1024.00 | time: 26.825 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2830/  5000| tot_loss: 3.5482 | rl_loss: 1.7689 | pt_loss: 1.7793 | pg_loss: 0.5485 | reg_loss: 1.2204 | reward: -0.6402 | rev_kl: 0.9673 | stu_lens: 67.5000 | mixed_lens: 68.0000 | lr: 2.0615e-06 | scale: 1024.00 | time: 26.773 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2831/  5000| tot_loss: 2.9851 | rl_loss: 1.4251 | pt_loss: 1.5600 | pg_loss: 0.3231 | reg_loss: 1.1020 | reward: -0.5064 | rev_kl: 0.2838 | stu_lens: 128.0000 | mixed_lens: 72.0000 | lr: 2.0599e-06 | scale: 1024.00 | time: 26.801 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2832/  5000| tot_loss: 3.2203 | rl_loss: 1.8865 | pt_loss: 1.3337 | pg_loss: 0.7585 | reg_loss: 1.1280 | reward: -0.3587 | rev_kl: 1.1935 | stu_lens: 117.0000 | mixed_lens: 64.0000 | lr: 2.0583e-06 | scale: 1024.00 | time: 26.828 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2832/  5000| tot_loss: 3.1326 | rl_loss: 1.5224 | pt_loss: 1.6101 | pg_loss: 0.4514 | reg_loss: 1.0711 | reward: -0.4085 | rev_kl: 1.0759 | stu_lens: 86.3906 | mixed_lens: 80.5000 | lr: 2.0583e-06 | scale: 1024.00 | time: 26.828 | step time: 28.056
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2833/  5000| tot_loss: 3.2070 | rl_loss: 1.3354 | pt_loss: 1.8716 | pg_loss: 0.2824 | reg_loss: 1.0530 | reward: -0.2070 | rev_kl: 1.8306 | stu_lens: 103.0000 | mixed_lens: 99.5000 | lr: 2.0568e-06 | scale: 1024.00 | time: 26.792 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2834/  5000| tot_loss: 3.4327 | rl_loss: 1.3072 | pt_loss: 2.1255 | pg_loss: 0.3864 | reg_loss: 0.9208 | reward: -0.4379 | rev_kl: 1.0420 | stu_lens: 95.0000 | mixed_lens: 74.5000 | lr: 2.0552e-06 | scale: 1024.00 | time: 26.771 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2835/  5000| tot_loss: 2.8440 | rl_loss: 1.1219 | pt_loss: 1.7221 | pg_loss: 0.1626 | reg_loss: 0.9593 | reward: -0.2761 | rev_kl: 1.0408 | stu_lens: 82.5000 | mixed_lens: 96.0000 | lr: 2.0536e-06 | scale: 1024.00 | time: 26.789 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2836/  5000| tot_loss: 3.3022 | rl_loss: 1.6374 | pt_loss: 1.6648 | pg_loss: 0.5479 | reg_loss: 1.0895 | reward: -0.3247 | rev_kl: 1.2808 | stu_lens: 113.5000 | mixed_lens: 76.0000 | lr: 2.0520e-06 | scale: 1024.00 | time: 26.771 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2837/  5000| tot_loss: 2.3908 | rl_loss: 0.9781 | pt_loss: 1.4126 | pg_loss: 0.0318 | reg_loss: 0.9463 | reward: -0.2012 | rev_kl: 1.3880 | stu_lens: 93.5000 | mixed_lens: 128.0000 | lr: 2.0505e-06 | scale: 1024.00 | time: 26.793 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2838/  5000| tot_loss: 2.6404 | rl_loss: 1.0627 | pt_loss: 1.5777 | pg_loss: 0.6403 | reg_loss: 0.4224 | reward: -0.6672 | rev_kl: 0.5786 | stu_lens: 42.5000 | mixed_lens: 43.0000 | lr: 2.0489e-06 | scale: 1024.00 | time: 26.771 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2839/  5000| tot_loss: 2.5030 | rl_loss: 0.9278 | pt_loss: 1.5752 | pg_loss: 0.2276 | reg_loss: 0.7002 | reward: -0.2089 | rev_kl: 1.0535 | stu_lens: 84.0000 | mixed_lens: 103.5000 | lr: 2.0473e-06 | scale: 1024.00 | time: 26.798 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2840/  5000| tot_loss: 2.5260 | rl_loss: 0.9780 | pt_loss: 1.5480 | pg_loss: 0.1011 | reg_loss: 0.8769 | reward: -0.2245 | rev_kl: 0.5420 | stu_lens: 109.5000 | mixed_lens: 113.5000 | lr: 2.0457e-06 | scale: 1024.00 | time: 26.777 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2841/  5000| tot_loss: 2.8071 | rl_loss: 0.8722 | pt_loss: 1.9349 | pg_loss: 0.0478 | reg_loss: 0.8244 | reward: -0.0397 | rev_kl: 0.6028 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.0441e-06 | scale: 1024.00 | time: 26.802 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2842/  5000| tot_loss: 2.3943 | rl_loss: 0.9561 | pt_loss: 1.4381 | pg_loss: 0.0481 | reg_loss: 0.9080 | reward: -0.2039 | rev_kl: 1.1402 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.0426e-06 | scale: 1024.00 | time: 26.806 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2843/  5000| tot_loss: 3.4244 | rl_loss: 1.7606 | pt_loss: 1.6639 | pg_loss: 1.4759 | reg_loss: 0.2846 | reward: -0.5718 | rev_kl: 0.6008 | stu_lens: 7.0000 | mixed_lens: 7.5000 | lr: 2.0410e-06 | scale: 1024.00 | time: 26.803 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2844/  5000| tot_loss: 2.4641 | rl_loss: 0.7187 | pt_loss: 1.7455 | pg_loss: -0.0098 | reg_loss: 0.7285 | reward: -0.2389 | rev_kl: 2.0680 | stu_lens: 125.0000 | mixed_lens: 128.0000 | lr: 2.0394e-06 | scale: 1024.00 | time: 26.787 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2845/  5000| tot_loss: 2.7314 | rl_loss: 0.9699 | pt_loss: 1.7614 | pg_loss: 0.4034 | reg_loss: 0.5666 | reward: -0.2371 | rev_kl: 0.9122 | stu_lens: 70.0000 | mixed_lens: 89.5000 | lr: 2.0378e-06 | scale: 1024.00 | time: 26.795 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2846/  5000| tot_loss: 2.7737 | rl_loss: 0.9683 | pt_loss: 1.8055 | pg_loss: 0.3175 | reg_loss: 0.6508 | reward: -0.4614 | rev_kl: 1.4700 | stu_lens: 93.0000 | mixed_lens: 73.0000 | lr: 2.0363e-06 | scale: 1024.00 | time: 26.794 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2847/  5000| tot_loss: 2.8841 | rl_loss: 1.3296 | pt_loss: 1.5545 | pg_loss: 0.7179 | reg_loss: 0.6117 | reward: -1.0077 | rev_kl: 3.7656 | stu_lens: 40.0000 | mixed_lens: 36.5000 | lr: 2.0347e-06 | scale: 1024.00 | time: 26.822 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2848/  5000| tot_loss: 3.0828 | rl_loss: 1.2984 | pt_loss: 1.7844 | pg_loss: 0.4077 | reg_loss: 0.8907 | reward: -0.2105 | rev_kl: 0.7379 | stu_lens: 84.5000 | mixed_lens: 77.5000 | lr: 2.0331e-06 | scale: 1024.00 | time: 26.792 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2848/  5000| tot_loss: 2.8686 | rl_loss: 1.1156 | pt_loss: 1.7530 | pg_loss: 0.3300 | reg_loss: 0.7856 | reward: -0.4047 | rev_kl: 1.1345 | stu_lens: 87.0000 | mixed_lens: 84.2344 | lr: 2.0331e-06 | scale: 1024.00 | time: 26.792 | step time: 28.003
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2849/  5000| tot_loss: 2.5248 | rl_loss: 0.7924 | pt_loss: 1.7324 | pg_loss: 0.2061 | reg_loss: 0.5862 | reward: -0.4091 | rev_kl: 0.8110 | stu_lens: 112.5000 | mixed_lens: 84.5000 | lr: 2.0315e-06 | scale: 1024.00 | time: 26.806 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2850/  5000| tot_loss: 2.8342 | rl_loss: 1.0414 | pt_loss: 1.7927 | pg_loss: 0.3490 | reg_loss: 0.6924 | reward: -0.4991 | rev_kl: 0.8950 | stu_lens: 78.0000 | mixed_lens: 78.0000 | lr: 2.0300e-06 | scale: 1024.00 | time: 26.819 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2851/  5000| tot_loss: 2.6523 | rl_loss: 0.8063 | pt_loss: 1.8459 | pg_loss: 0.4715 | reg_loss: 0.3348 | reward: -0.2572 | rev_kl: 1.1733 | stu_lens: 56.5000 | mixed_lens: 76.0000 | lr: 2.0284e-06 | scale: 1024.00 | time: 26.835 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2852/  5000| tot_loss: 2.9134 | rl_loss: 0.9124 | pt_loss: 2.0009 | pg_loss: 0.3038 | reg_loss: 0.6086 | reward: -0.4554 | rev_kl: 1.1720 | stu_lens: 124.5000 | mixed_lens: 93.0000 | lr: 2.0268e-06 | scale: 1024.00 | time: 26.836 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2853/  5000| tot_loss: 2.9963 | rl_loss: 1.2907 | pt_loss: 1.7056 | pg_loss: 0.4554 | reg_loss: 0.8354 | reward: -0.8538 | rev_kl: 0.9700 | stu_lens: 43.5000 | mixed_lens: 63.0000 | lr: 2.0253e-06 | scale: 1024.00 | time: 26.863 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2854/  5000| tot_loss: 3.7274 | rl_loss: 0.6772 | pt_loss: 3.0502 | pg_loss: 0.0612 | reg_loss: 0.6160 | reward: -0.2077 | rev_kl: 1.2165 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.0237e-06 | scale: 1024.00 | time: 26.856 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2855/  5000| tot_loss: 2.5115 | rl_loss: 0.4802 | pt_loss: 2.0313 | pg_loss: 0.1109 | reg_loss: 0.3692 | reward: -0.1144 | rev_kl: 0.7724 | stu_lens: 78.5000 | mixed_lens: 64.5000 | lr: 2.0221e-06 | scale: 1024.00 | time: 26.922 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2856/  5000| tot_loss: 1.5458 | rl_loss: 0.6031 | pt_loss: 0.9427 | pg_loss: 0.1654 | reg_loss: 0.4377 | reward: -0.2654 | rev_kl: 0.7342 | stu_lens: 108.0000 | mixed_lens: 101.0000 | lr: 2.0205e-06 | scale: 1024.00 | time: 26.880 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2857/  5000| tot_loss: 2.3148 | rl_loss: 0.6279 | pt_loss: 1.6869 | pg_loss: 0.1367 | reg_loss: 0.4912 | reward: -0.0475 | rev_kl: 1.3877 | stu_lens: 97.0000 | mixed_lens: 108.0000 | lr: 2.0190e-06 | scale: 1024.00 | time: 26.824 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2858/  5000| tot_loss: 1.9326 | rl_loss: 0.6579 | pt_loss: 1.2747 | pg_loss: 0.3075 | reg_loss: 0.3504 | reward: -0.2360 | rev_kl: 0.6648 | stu_lens: 59.0000 | mixed_lens: 78.5000 | lr: 2.0174e-06 | scale: 1024.00 | time: 26.809 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2859/  5000| tot_loss: 2.2615 | rl_loss: 0.6666 | pt_loss: 1.5949 | pg_loss: 0.2170 | reg_loss: 0.4495 | reward: -0.9450 | rev_kl: 3.9560 | stu_lens: 65.0000 | mixed_lens: 65.0000 | lr: 2.0158e-06 | scale: 1024.00 | time: 26.838 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2860/  5000| tot_loss: 3.0249 | rl_loss: 1.3082 | pt_loss: 1.7167 | pg_loss: 0.5292 | reg_loss: 0.7790 | reward: -0.3083 | rev_kl: 1.4328 | stu_lens: 117.0000 | mixed_lens: 73.0000 | lr: 2.0142e-06 | scale: 1024.00 | time: 26.816 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2861/  5000| tot_loss: 2.1387 | rl_loss: 0.7329 | pt_loss: 1.4058 | pg_loss: 0.3336 | reg_loss: 0.3993 | reward: -0.7141 | rev_kl: 0.6665 | stu_lens: 71.0000 | mixed_lens: 71.0000 | lr: 2.0127e-06 | scale: 1024.00 | time: 26.834 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2862/  5000| tot_loss: 2.2799 | rl_loss: 0.9552 | pt_loss: 1.3247 | pg_loss: 0.3973 | reg_loss: 0.5579 | reward: -0.3750 | rev_kl: 0.6165 | stu_lens: 128.0000 | mixed_lens: 62.5000 | lr: 2.0111e-06 | scale: 1024.00 | time: 26.817 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2863/  5000| tot_loss: 2.9239 | rl_loss: 1.0280 | pt_loss: 1.8959 | pg_loss: 0.3295 | reg_loss: 0.6985 | reward: -0.2818 | rev_kl: 1.0043 | stu_lens: 108.0000 | mixed_lens: 82.0000 | lr: 2.0095e-06 | scale: 1024.00 | time: 26.814 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2864/  5000| tot_loss: 2.3457 | rl_loss: 0.6929 | pt_loss: 1.6528 | pg_loss: 0.1745 | reg_loss: 0.5184 | reward: -0.1398 | rev_kl: 1.1893 | stu_lens: 122.0000 | mixed_lens: 109.5000 | lr: 2.0080e-06 | scale: 1024.00 | time: 26.793 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2864/  5000| tot_loss: 2.6242 | rl_loss: 0.9016 | pt_loss: 1.7225 | pg_loss: 0.3334 | reg_loss: 0.5682 | reward: -0.4274 | rev_kl: 1.0531 | stu_lens: 88.1250 | mixed_lens: 79.9062 | lr: 2.0080e-06 | scale: 1024.00 | time: 26.793 | step time: 28.047
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2865/  5000| tot_loss: 2.8841 | rl_loss: 0.9418 | pt_loss: 1.9423 | pg_loss: 0.2352 | reg_loss: 0.7066 | reward: -0.2758 | rev_kl: 1.2321 | stu_lens: 82.0000 | mixed_lens: 93.0000 | lr: 2.0064e-06 | scale: 1024.00 | time: 26.831 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2866/  5000| tot_loss: 2.4860 | rl_loss: 0.8791 | pt_loss: 1.6069 | pg_loss: 0.3482 | reg_loss: 0.5310 | reward: -0.1623 | rev_kl: 1.0277 | stu_lens: 102.0000 | mixed_lens: 76.5000 | lr: 2.0048e-06 | scale: 1024.00 | time: 26.793 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2867/  5000| tot_loss: 2.6371 | rl_loss: 0.7088 | pt_loss: 1.9283 | pg_loss: 0.2801 | reg_loss: 0.4287 | reward: 0.0714 | rev_kl: 0.2920 | stu_lens: 70.0000 | mixed_lens: 24.0000 | lr: 2.0032e-06 | scale: 1024.00 | time: 26.835 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2868/  5000| tot_loss: 2.6203 | rl_loss: 0.7338 | pt_loss: 1.8865 | pg_loss: 0.0600 | reg_loss: 0.6738 | reward: -0.3035 | rev_kl: 1.4152 | stu_lens: 86.5000 | mixed_lens: 123.0000 | lr: 2.0017e-06 | scale: 1024.00 | time: 26.797 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2869/  5000| tot_loss: 2.2174 | rl_loss: 0.7968 | pt_loss: 1.4206 | pg_loss: 0.3348 | reg_loss: 0.4621 | reward: -0.4804 | rev_kl: 1.2682 | stu_lens: 128.0000 | mixed_lens: 79.5000 | lr: 2.0001e-06 | scale: 1024.00 | time: 26.818 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2870/  5000| tot_loss: 2.0585 | rl_loss: 0.2679 | pt_loss: 1.7907 | pg_loss: -0.0201 | reg_loss: 0.2880 | reward: -0.0972 | rev_kl: 0.7007 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.9985e-06 | scale: 1024.00 | time: 26.794 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2871/  5000| tot_loss: 2.1834 | rl_loss: 0.5479 | pt_loss: 1.6355 | pg_loss: 0.0925 | reg_loss: 0.4554 | reward: -0.2489 | rev_kl: 0.7849 | stu_lens: 103.0000 | mixed_lens: 99.5000 | lr: 1.9970e-06 | scale: 1024.00 | time: 26.820 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2872/  5000| tot_loss: 2.1358 | rl_loss: 0.5923 | pt_loss: 1.5435 | pg_loss: 0.1064 | reg_loss: 0.4859 | reward: -0.3197 | rev_kl: 1.1068 | stu_lens: 119.0000 | mixed_lens: 111.0000 | lr: 1.9954e-06 | scale: 1024.00 | time: 26.803 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2873/  5000| tot_loss: 2.8492 | rl_loss: 0.8220 | pt_loss: 2.0271 | pg_loss: 0.2802 | reg_loss: 0.5418 | reward: -0.3647 | rev_kl: 1.2188 | stu_lens: 109.0000 | mixed_lens: 89.0000 | lr: 1.9938e-06 | scale: 1024.00 | time: 26.830 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2874/  5000| tot_loss: 2.4109 | rl_loss: 1.0407 | pt_loss: 1.3702 | pg_loss: 0.4816 | reg_loss: 0.5590 | reward: -0.7554 | rev_kl: 1.2377 | stu_lens: 71.0000 | mixed_lens: 71.0000 | lr: 1.9922e-06 | scale: 1024.00 | time: 26.811 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2875/  5000| tot_loss: 2.9094 | rl_loss: 0.8385 | pt_loss: 2.0709 | pg_loss: 0.3162 | reg_loss: 0.5223 | reward: -0.0217 | rev_kl: 1.1667 | stu_lens: 66.5000 | mixed_lens: 90.0000 | lr: 1.9907e-06 | scale: 1024.00 | time: 26.834 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2876/  5000| tot_loss: 2.1574 | rl_loss: 0.2821 | pt_loss: 1.8754 | pg_loss: 0.0081 | reg_loss: 0.2740 | reward: -0.2728 | rev_kl: 0.9830 | stu_lens: 111.0000 | mixed_lens: 122.0000 | lr: 1.9891e-06 | scale: 1024.00 | time: 26.816 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2877/  5000| tot_loss: 1.8813 | rl_loss: 0.6665 | pt_loss: 1.2148 | pg_loss: 0.2002 | reg_loss: 0.4663 | reward: -0.3884 | rev_kl: 1.2098 | stu_lens: 128.0000 | mixed_lens: 103.0000 | lr: 1.9875e-06 | scale: 1024.00 | time: 26.870 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2878/  5000| tot_loss: 1.7967 | rl_loss: 0.6169 | pt_loss: 1.1798 | pg_loss: 0.1856 | reg_loss: 0.4314 | reward: -0.0718 | rev_kl: 2.5567 | stu_lens: 97.0000 | mixed_lens: 108.0000 | lr: 1.9860e-06 | scale: 1024.00 | time: 26.826 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2879/  5000| tot_loss: 2.8500 | rl_loss: 1.0905 | pt_loss: 1.7595 | pg_loss: 0.4843 | reg_loss: 0.6062 | reward: -1.0053 | rev_kl: 3.6150 | stu_lens: 65.0000 | mixed_lens: 54.5000 | lr: 1.9844e-06 | scale: 1024.00 | time: 26.860 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2880/  5000| tot_loss: 2.1657 | rl_loss: 0.5605 | pt_loss: 1.6052 | pg_loss: 0.1977 | reg_loss: 0.3628 | reward: -2.9833 | rev_kl: 1.8961 | stu_lens: 66.0000 | mixed_lens: 66.0000 | lr: 1.9828e-06 | scale: 1024.00 | time: 26.924 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2880/  5000| tot_loss: 2.4754 | rl_loss: 0.7803 | pt_loss: 1.6951 | pg_loss: 0.3137 | reg_loss: 0.4665 | reward: -0.4058 | rev_kl: 1.1566 | stu_lens: 88.8281 | mixed_lens: 84.6250 | lr: 1.9828e-06 | scale: 1024.00 | time: 26.924 | step time: 28.040
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2881/  5000| tot_loss: 3.0470 | rl_loss: 0.8548 | pt_loss: 2.1922 | pg_loss: 0.4992 | reg_loss: 0.3556 | reward: -0.3123 | rev_kl: 0.6789 | stu_lens: 77.5000 | mixed_lens: 65.0000 | lr: 1.9813e-06 | scale: 1024.00 | time: 26.830 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2882/  5000| tot_loss: 4.1293 | rl_loss: 2.2402 | pt_loss: 1.8891 | pg_loss: 0.1170 | reg_loss: 2.1233 | reward: 1.2661 | rev_kl: 1.3309 | stu_lens: 75.0000 | mixed_lens: 41.5000 | lr: 1.9797e-06 | scale: 1024.00 | time: 26.856 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2883/  5000| tot_loss: 3.1849 | rl_loss: 1.8363 | pt_loss: 1.3485 | pg_loss: 0.3878 | reg_loss: 1.4485 | reward: -0.3469 | rev_kl: 1.2599 | stu_lens: 128.0000 | mixed_lens: 75.0000 | lr: 1.9781e-06 | scale: 1024.00 | time: 26.803 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2884/  5000| tot_loss: 2.9248 | rl_loss: 1.4083 | pt_loss: 1.5165 | pg_loss: 0.2502 | reg_loss: 1.1581 | reward: -0.2057 | rev_kl: 0.8701 | stu_lens: 121.5000 | mixed_lens: 93.0000 | lr: 1.9766e-06 | scale: 1024.00 | time: 26.843 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2885/  5000| tot_loss: 3.4606 | rl_loss: 1.5714 | pt_loss: 1.8892 | pg_loss: 0.6321 | reg_loss: 0.9393 | reward: -0.3642 | rev_kl: 1.0397 | stu_lens: 109.0000 | mixed_lens: 58.5000 | lr: 1.9750e-06 | scale: 1024.00 | time: 26.812 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2886/  5000| tot_loss: 2.8545 | rl_loss: 1.5804 | pt_loss: 1.2741 | pg_loss: 0.7079 | reg_loss: 0.8725 | reward: -0.7022 | rev_kl: 0.8404 | stu_lens: 58.5000 | mixed_lens: 49.0000 | lr: 1.9734e-06 | scale: 1024.00 | time: 26.802 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2887/  5000| tot_loss: 2.3115 | rl_loss: 0.9887 | pt_loss: 1.3228 | pg_loss: 0.0676 | reg_loss: 0.9211 | reward: -0.0611 | rev_kl: 0.2848 | stu_lens: 87.0000 | mixed_lens: 121.0000 | lr: 1.9719e-06 | scale: 1024.00 | time: 26.809 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2888/  5000| tot_loss: 3.7603 | rl_loss: 2.3474 | pt_loss: 1.4129 | pg_loss: 0.5669 | reg_loss: 1.7805 | reward: -0.3518 | rev_kl: 1.1864 | stu_lens: 71.0000 | mixed_lens: 73.5000 | lr: 1.9703e-06 | scale: 1024.00 | time: 26.786 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2889/  5000| tot_loss: 3.2633 | rl_loss: 1.3489 | pt_loss: 1.9144 | pg_loss: 0.3921 | reg_loss: 0.9569 | reward: -0.2284 | rev_kl: 1.3416 | stu_lens: 101.0000 | mixed_lens: 75.5000 | lr: 1.9687e-06 | scale: 1024.00 | time: 26.819 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2890/  5000| tot_loss: 3.4562 | rl_loss: 1.6215 | pt_loss: 1.8347 | pg_loss: 0.1398 | reg_loss: 1.4817 | reward: -0.0738 | rev_kl: 1.4638 | stu_lens: 86.0000 | mixed_lens: 102.5000 | lr: 1.9672e-06 | scale: 1024.00 | time: 26.802 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2891/  5000| tot_loss: 3.6886 | rl_loss: 1.6268 | pt_loss: 2.0619 | pg_loss: 0.4651 | reg_loss: 1.1616 | reward: -0.8095 | rev_kl: 1.1537 | stu_lens: 88.0000 | mixed_lens: 75.5000 | lr: 1.9656e-06 | scale: 1024.00 | time: 26.816 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2892/  5000| tot_loss: 3.5679 | rl_loss: 1.6622 | pt_loss: 1.9057 | pg_loss: 0.2541 | reg_loss: 1.4081 | reward: -0.2324 | rev_kl: 1.4533 | stu_lens: 128.0000 | mixed_lens: 60.5000 | lr: 1.9640e-06 | scale: 1024.00 | time: 26.812 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2893/  5000| tot_loss: 3.5954 | rl_loss: 1.6479 | pt_loss: 1.9475 | pg_loss: 0.5065 | reg_loss: 1.1415 | reward: -0.4924 | rev_kl: 0.6989 | stu_lens: 64.0000 | mixed_lens: 72.0000 | lr: 1.9625e-06 | scale: 1024.00 | time: 26.838 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2894/  5000| tot_loss: 2.7848 | rl_loss: 0.7972 | pt_loss: 1.9876 | pg_loss: 0.1205 | reg_loss: 0.6767 | reward: -0.1200 | rev_kl: 0.5504 | stu_lens: 124.5000 | mixed_lens: 112.0000 | lr: 1.9609e-06 | scale: 1024.00 | time: 26.820 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2895/  5000| tot_loss: 4.1654 | rl_loss: 1.9110 | pt_loss: 2.2544 | pg_loss: 0.4217 | reg_loss: 1.4893 | reward: -0.3916 | rev_kl: 0.9766 | stu_lens: 83.0000 | mixed_lens: 88.5000 | lr: 1.9593e-06 | scale: 1024.00 | time: 26.845 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2896/  5000| tot_loss: 3.4578 | rl_loss: 1.5967 | pt_loss: 1.8611 | pg_loss: 0.4012 | reg_loss: 1.1955 | reward: -0.1829 | rev_kl: 0.6370 | stu_lens: 98.0000 | mixed_lens: 93.5000 | lr: 1.9578e-06 | scale: 1024.00 | time: 26.828 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2896/  5000| tot_loss: 3.1005 | rl_loss: 1.3427 | pt_loss: 1.7578 | pg_loss: 0.3213 | reg_loss: 1.0214 | reward: -0.2163 | rev_kl: 0.9555 | stu_lens: 87.3906 | mixed_lens: 79.8906 | lr: 1.9578e-06 | scale: 1024.00 | time: 26.828 | step time: 28.033
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2897/  5000| tot_loss: 3.1994 | rl_loss: 1.8791 | pt_loss: 1.3203 | pg_loss: 0.5911 | reg_loss: 1.2880 | reward: -0.1353 | rev_kl: 1.0054 | stu_lens: 36.5000 | mixed_lens: 68.0000 | lr: 1.9562e-06 | scale: 1024.00 | time: 26.855 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2898/  5000| tot_loss: 2.8943 | rl_loss: 1.1306 | pt_loss: 1.7637 | pg_loss: 0.1633 | reg_loss: 0.9673 | reward: -0.1218 | rev_kl: 0.7097 | stu_lens: 112.5000 | mixed_lens: 102.5000 | lr: 1.9546e-06 | scale: 1024.00 | time: 26.870 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2899/  5000| tot_loss: 2.5267 | rl_loss: 0.8620 | pt_loss: 1.6647 | pg_loss: 0.3182 | reg_loss: 0.5438 | reward: 0.1125 | rev_kl: 0.7706 | stu_lens: 70.0000 | mixed_lens: 71.0000 | lr: 1.9531e-06 | scale: 1024.00 | time: 26.860 | step time: 0.000
                                 Evaluation #29                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ The scenario is a classic example of │
│                                       │ a decision tree. The decision tree   │
│                                       │ shows the various possibilities and  │
│                                       │ the associated probabilities.        │
│                                       │                                      │
│                                       │ In this case, the decision tree is   │
│                                       │ as follows:                          │
│                                       │                                      │
│                                       │ - Alice stays with Bob               │
│                                       │ - Bob leaves Alice                   │
│                                       │ - Alice dies                         │
│                                       │ - Bob dies                           │
│                                       │                                      │
│                                       │ If Bob leaves Alice, his chances of  │
│                                       │ survival increase by 9%. However,    │
│                                       │ Alice will also die, so the overall  │
│                                       │ chances of survival decrease by 9%.  │
│                                       │                                      │
│                                       │ Therefore, the expected value of the │
│                                       │ decision is -9% * 31% = -2.73. Since │
│                                       │ Bob's chances                        │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ mz kezboard tzpe z instead of y and  │
│                                       │ vice versa because z is the last     │
│                                       │ letter of the alphabet and y is the  │
│                                       │ first letter of the alphabet.        │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support over 100 languages.       │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.850 | exact_match: 0.215 | rev_kl: 1.239 | lens: 88.521 | pt_loss: 1.074 | lm_loss: 1.156 | kd_loss: 0.992 
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2900/  5000| tot_loss: 3.5982 | rl_loss: 1.5788 | pt_loss: 2.0194 | pg_loss: 0.2709 | reg_loss: 1.3080 | reward: -0.0253 | rev_kl: 1.5815 | stu_lens: 100.5000 | mixed_lens: 55.0000 | lr: 1.9515e-06 | scale: 1024.00 | time: 26.849 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2901/  5000| tot_loss: 2.6596 | rl_loss: 0.9189 | pt_loss: 1.7407 | pg_loss: 0.3806 | reg_loss: 0.5383 | reward: -0.1226 | rev_kl: 0.8372 | stu_lens: 120.0000 | mixed_lens: 77.0000 | lr: 1.9500e-06 | scale: 1024.00 | time: 26.877 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2902/  5000| tot_loss: 2.4351 | rl_loss: 1.2271 | pt_loss: 1.2080 | pg_loss: 0.7418 | reg_loss: 0.4854 | reward: -0.3349 | rev_kl: 0.5489 | stu_lens: 67.5000 | mixed_lens: 60.5000 | lr: 1.9484e-06 | scale: 1024.00 | time: 26.856 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2903/  5000| tot_loss: 2.9894 | rl_loss: 1.1806 | pt_loss: 1.8088 | pg_loss: 0.0507 | reg_loss: 1.1300 | reward: -0.2669 | rev_kl: 1.3327 | stu_lens: 109.0000 | mixed_lens: 124.5000 | lr: 1.9468e-06 | scale: 1024.00 | time: 26.859 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2904/  5000| tot_loss: 2.3542 | rl_loss: 0.7360 | pt_loss: 1.6182 | pg_loss: 0.1147 | reg_loss: 0.6213 | reward: -0.2036 | rev_kl: 1.2175 | stu_lens: 83.5000 | mixed_lens: 106.0000 | lr: 1.9453e-06 | scale: 1024.00 | time: 26.879 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2905/  5000| tot_loss: 2.3595 | rl_loss: 0.8873 | pt_loss: 1.4723 | pg_loss: 0.4643 | reg_loss: 0.4230 | reward: -0.3413 | rev_kl: 0.9117 | stu_lens: 55.5000 | mixed_lens: 32.5000 | lr: 1.9437e-06 | scale: 1024.00 | time: 26.861 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2906/  5000| tot_loss: 3.2361 | rl_loss: 1.0270 | pt_loss: 2.2091 | pg_loss: 0.2540 | reg_loss: 0.7730 | reward: -0.2594 | rev_kl: 1.5160 | stu_lens: 96.5000 | mixed_lens: 97.0000 | lr: 1.9421e-06 | scale: 1024.00 | time: 26.823 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2907/  5000| tot_loss: 2.7775 | rl_loss: 0.9143 | pt_loss: 1.8633 | pg_loss: 0.3331 | reg_loss: 0.5812 | reward: -0.2591 | rev_kl: 0.9528 | stu_lens: 121.5000 | mixed_lens: 79.5000 | lr: 1.9406e-06 | scale: 1024.00 | time: 26.814 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2908/  5000| tot_loss: 3.1803 | rl_loss: 1.2954 | pt_loss: 1.8850 | pg_loss: 0.5199 | reg_loss: 0.7754 | reward: -0.3104 | rev_kl: 0.6265 | stu_lens: 99.5000 | mixed_lens: 96.0000 | lr: 1.9390e-06 | scale: 1024.00 | time: 26.885 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2909/  5000| tot_loss: 2.3842 | rl_loss: 1.1700 | pt_loss: 1.2142 | pg_loss: 0.5782 | reg_loss: 0.5918 | reward: -0.2393 | rev_kl: 1.2111 | stu_lens: 91.0000 | mixed_lens: 76.5000 | lr: 1.9374e-06 | scale: 1024.00 | time: 26.825 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2910/  5000| tot_loss: 2.1438 | rl_loss: 0.4236 | pt_loss: 1.7202 | pg_loss: 0.2342 | reg_loss: 0.1894 | reward: -0.5327 | rev_kl: 0.4313 | stu_lens: 25.5000 | mixed_lens: 58.5000 | lr: 1.9359e-06 | scale: 1024.00 | time: 26.851 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2911/  5000| tot_loss: 2.9870 | rl_loss: 1.4696 | pt_loss: 1.5174 | pg_loss: 0.7530 | reg_loss: 0.7165 | reward: -0.4365 | rev_kl: 1.5653 | stu_lens: 28.0000 | mixed_lens: 53.0000 | lr: 1.9343e-06 | scale: 1024.00 | time: 26.807 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2912/  5000| tot_loss: 2.6192 | rl_loss: 1.3486 | pt_loss: 1.2706 | pg_loss: 0.3951 | reg_loss: 0.9535 | reward: -0.3125 | rev_kl: 0.8405 | stu_lens: 91.5000 | mixed_lens: 78.5000 | lr: 1.9328e-06 | scale: 1024.00 | time: 26.861 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2912/  5000| tot_loss: 2.7822 | rl_loss: 1.0824 | pt_loss: 1.6997 | pg_loss: 0.3292 | reg_loss: 0.7532 | reward: -0.2055 | rev_kl: 1.0148 | stu_lens: 83.1875 | mixed_lens: 77.4844 | lr: 1.9328e-06 | scale: 1024.00 | time: 26.861 | step time: 28.064
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2913/  5000| tot_loss: 2.6836 | rl_loss: 0.7031 | pt_loss: 1.9804 | pg_loss: 0.0107 | reg_loss: 0.6924 | reward: -0.1540 | rev_kl: 0.8037 | stu_lens: 110.0000 | mixed_lens: 128.0000 | lr: 1.9312e-06 | scale: 1024.00 | time: 26.805 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2914/  5000| tot_loss: 2.1688 | rl_loss: 0.7166 | pt_loss: 1.4522 | pg_loss: 0.0369 | reg_loss: 0.6797 | reward: -0.1614 | rev_kl: 0.8166 | stu_lens: 117.5000 | mixed_lens: 128.0000 | lr: 1.9296e-06 | scale: 1024.00 | time: 26.833 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2915/  5000| tot_loss: 2.4219 | rl_loss: 0.9980 | pt_loss: 1.4239 | pg_loss: 0.2657 | reg_loss: 0.7323 | reward: -0.3527 | rev_kl: 0.3322 | stu_lens: 91.5000 | mixed_lens: 92.0000 | lr: 1.9281e-06 | scale: 1024.00 | time: 26.804 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2916/  5000| tot_loss: 2.3981 | rl_loss: 1.0314 | pt_loss: 1.3667 | pg_loss: 0.6836 | reg_loss: 0.3478 | reward: -0.5227 | rev_kl: 0.6263 | stu_lens: 73.0000 | mixed_lens: 59.0000 | lr: 1.9265e-06 | scale: 1024.00 | time: 26.828 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2917/  5000| tot_loss: 1.9130 | rl_loss: 0.4336 | pt_loss: 1.4795 | pg_loss: 0.1883 | reg_loss: 0.2453 | reward: -0.5459 | rev_kl: 0.3679 | stu_lens: 66.5000 | mixed_lens: 65.5000 | lr: 1.9250e-06 | scale: 1024.00 | time: 26.809 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2918/  5000| tot_loss: 2.7921 | rl_loss: 0.8672 | pt_loss: 1.9249 | pg_loss: 0.3960 | reg_loss: 0.4712 | reward: 0.0244 | rev_kl: 0.6288 | stu_lens: 112.0000 | mixed_lens: 70.5000 | lr: 1.9234e-06 | scale: 1024.00 | time: 26.870 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2919/  5000| tot_loss: 3.7337 | rl_loss: 2.0458 | pt_loss: 1.6880 | pg_loss: 1.5688 | reg_loss: 0.4769 | reward: -0.2206 | rev_kl: 0.6150 | stu_lens: 18.5000 | mixed_lens: 20.0000 | lr: 1.9218e-06 | scale: 1024.00 | time: 26.812 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2920/  5000| tot_loss: 2.7326 | rl_loss: 1.0894 | pt_loss: 1.6433 | pg_loss: 0.4241 | reg_loss: 0.6653 | reward: -0.4805 | rev_kl: 0.8465 | stu_lens: 93.0000 | mixed_lens: 68.0000 | lr: 1.9203e-06 | scale: 1024.00 | time: 26.836 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2921/  5000| tot_loss: 2.5586 | rl_loss: 0.5999 | pt_loss: 1.9587 | pg_loss: 0.3384 | reg_loss: 0.2615 | reward: -0.1764 | rev_kl: 0.6582 | stu_lens: 73.5000 | mixed_lens: 82.0000 | lr: 1.9187e-06 | scale: 1024.00 | time: 26.820 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2922/  5000| tot_loss: 2.5537 | rl_loss: 0.8931 | pt_loss: 1.6606 | pg_loss: 0.2035 | reg_loss: 0.6896 | reward: 0.2965 | rev_kl: 0.5892 | stu_lens: 64.5000 | mixed_lens: 63.5000 | lr: 1.9172e-06 | scale: 1024.00 | time: 26.848 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2923/  5000| tot_loss: 1.8335 | rl_loss: 0.6678 | pt_loss: 1.1656 | pg_loss: 0.0925 | reg_loss: 0.5753 | reward: -0.1366 | rev_kl: 1.8134 | stu_lens: 101.5000 | mixed_lens: 99.0000 | lr: 1.9156e-06 | scale: 1024.00 | time: 26.825 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2924/  5000| tot_loss: 2.3470 | rl_loss: 0.6792 | pt_loss: 1.6678 | pg_loss: 0.3167 | reg_loss: 0.3625 | reward: -0.5167 | rev_kl: 1.0587 | stu_lens: 73.5000 | mixed_lens: 76.5000 | lr: 1.9140e-06 | scale: 1024.00 | time: 26.852 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2925/  5000| tot_loss: 2.4077 | rl_loss: 0.8355 | pt_loss: 1.5723 | pg_loss: 0.2083 | reg_loss: 0.6272 | reward: -0.0778 | rev_kl: 1.1074 | stu_lens: 89.0000 | mixed_lens: 90.5000 | lr: 1.9125e-06 | scale: 1024.00 | time: 26.833 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2926/  5000| tot_loss: 2.6687 | rl_loss: 0.7993 | pt_loss: 1.8694 | pg_loss: 0.3853 | reg_loss: 0.4140 | reward: -0.2909 | rev_kl: 0.7222 | stu_lens: 122.0000 | mixed_lens: 86.0000 | lr: 1.9109e-06 | scale: 1024.00 | time: 26.858 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2927/  5000| tot_loss: 2.1943 | rl_loss: 0.6841 | pt_loss: 1.5102 | pg_loss: 0.3297 | reg_loss: 0.3545 | reward: -0.2573 | rev_kl: 1.1421 | stu_lens: 93.0000 | mixed_lens: 87.0000 | lr: 1.9094e-06 | scale: 1024.00 | time: 26.838 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2928/  5000| tot_loss: 2.1602 | rl_loss: 0.9418 | pt_loss: 1.2184 | pg_loss: 0.0122 | reg_loss: 0.9296 | reward: 1.3864 | rev_kl: 1.5439 | stu_lens: 71.0000 | mixed_lens: 41.5000 | lr: 1.9078e-06 | scale: 1024.00 | time: 26.870 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2928/  5000| tot_loss: 2.4845 | rl_loss: 0.8385 | pt_loss: 1.6460 | pg_loss: 0.3165 | reg_loss: 0.5220 | reward: -0.2056 | rev_kl: 0.9633 | stu_lens: 85.3125 | mixed_lens: 80.5156 | lr: 1.9078e-06 | scale: 1024.00 | time: 26.870 | step time: 28.045
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2929/  5000| tot_loss: 2.5943 | rl_loss: 0.9853 | pt_loss: 1.6090 | pg_loss: 0.2514 | reg_loss: 0.7339 | reward: -0.3181 | rev_kl: 1.1091 | stu_lens: 94.0000 | mixed_lens: 98.0000 | lr: 1.9063e-06 | scale: 1024.00 | time: 26.868 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2930/  5000| tot_loss: 2.1208 | rl_loss: 0.4368 | pt_loss: 1.6839 | pg_loss: 0.1449 | reg_loss: 0.2919 | reward: -0.2519 | rev_kl: 0.7802 | stu_lens: 128.0000 | mixed_lens: 96.0000 | lr: 1.9047e-06 | scale: 1024.00 | time: 26.897 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2931/  5000| tot_loss: 3.2193 | rl_loss: 1.2471 | pt_loss: 1.9722 | pg_loss: 0.5264 | reg_loss: 0.7207 | reward: -0.1734 | rev_kl: 0.6682 | stu_lens: 62.5000 | mixed_lens: 63.5000 | lr: 1.9031e-06 | scale: 1024.00 | time: 26.822 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2932/  5000| tot_loss: 2.4160 | rl_loss: 0.5138 | pt_loss: 1.9022 | pg_loss: 0.0315 | reg_loss: 0.4823 | reward: -0.2048 | rev_kl: 0.9154 | stu_lens: 117.5000 | mixed_lens: 128.0000 | lr: 1.9016e-06 | scale: 1024.00 | time: 26.904 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2933/  5000| tot_loss: 1.7381 | rl_loss: 0.2595 | pt_loss: 1.4786 | pg_loss: 0.0281 | reg_loss: 0.2314 | reward: -0.1842 | rev_kl: 1.0855 | stu_lens: 128.0000 | mixed_lens: 68.5000 | lr: 1.9000e-06 | scale: 1024.00 | time: 26.887 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2934/  5000| tot_loss: 2.3322 | rl_loss: 0.3208 | pt_loss: 2.0114 | pg_loss: 0.0764 | reg_loss: 0.2444 | reward: -0.1200 | rev_kl: 0.5504 | stu_lens: 124.5000 | mixed_lens: 112.0000 | lr: 1.8985e-06 | scale: 1024.00 | time: 26.848 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2935/  5000| tot_loss: 3.2278 | rl_loss: 1.6742 | pt_loss: 1.5536 | pg_loss: 0.7006 | reg_loss: 0.9736 | reward: 0.3579 | rev_kl: 0.9705 | stu_lens: 46.0000 | mixed_lens: 31.0000 | lr: 1.8969e-06 | scale: 1024.00 | time: 26.827 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2936/  5000| tot_loss: 2.3054 | rl_loss: 0.6372 | pt_loss: 1.6682 | pg_loss: 0.3651 | reg_loss: 0.2720 | reward: -0.1062 | rev_kl: 1.0431 | stu_lens: 93.0000 | mixed_lens: 77.0000 | lr: 1.8954e-06 | scale: 1024.00 | time: 26.827 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2937/  5000| tot_loss: 2.9979 | rl_loss: 1.4110 | pt_loss: 1.5869 | pg_loss: 0.7681 | reg_loss: 0.6428 | reward: -0.3914 | rev_kl: 0.7026 | stu_lens: 66.5000 | mixed_lens: 64.5000 | lr: 1.8938e-06 | scale: 1024.00 | time: 26.832 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2938/  5000| tot_loss: 2.3834 | rl_loss: 0.4521 | pt_loss: 1.9313 | pg_loss: 0.0640 | reg_loss: 0.3881 | reward: -0.1252 | rev_kl: 1.1532 | stu_lens: 128.0000 | mixed_lens: 114.5000 | lr: 1.8923e-06 | scale: 1024.00 | time: 26.863 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2939/  5000| tot_loss: 3.3296 | rl_loss: 1.8852 | pt_loss: 1.4444 | pg_loss: 1.4815 | reg_loss: 0.4037 | reward: -0.3034 | rev_kl: 0.5485 | stu_lens: 49.0000 | mixed_lens: 19.0000 | lr: 1.8907e-06 | scale: 1024.00 | time: 26.875 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2940/  5000| tot_loss: 2.8932 | rl_loss: 1.2030 | pt_loss: 1.6903 | pg_loss: 0.7076 | reg_loss: 0.4954 | reward: -0.1817 | rev_kl: 0.8704 | stu_lens: 78.5000 | mixed_lens: 45.5000 | lr: 1.8891e-06 | scale: 1024.00 | time: 26.842 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2941/  5000| tot_loss: 2.2681 | rl_loss: 0.6608 | pt_loss: 1.6073 | pg_loss: 0.3231 | reg_loss: 0.3378 | reward: -0.2304 | rev_kl: 1.3237 | stu_lens: 61.5000 | mixed_lens: 78.0000 | lr: 1.8876e-06 | scale: 1024.00 | time: 26.819 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2942/  5000| tot_loss: 2.6715 | rl_loss: 0.6370 | pt_loss: 2.0345 | pg_loss: 0.2748 | reg_loss: 0.3622 | reward: -0.0853 | rev_kl: 1.6359 | stu_lens: 79.0000 | mixed_lens: 83.5000 | lr: 1.8860e-06 | scale: 1024.00 | time: 26.845 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2943/  5000| tot_loss: 2.6351 | rl_loss: 0.9020 | pt_loss: 1.7331 | pg_loss: 0.5659 | reg_loss: 0.3361 | reward: -0.3106 | rev_kl: 0.8166 | stu_lens: 76.0000 | mixed_lens: 66.5000 | lr: 1.8845e-06 | scale: 1024.00 | time: 26.816 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2944/  5000| tot_loss: 2.3976 | rl_loss: 0.9368 | pt_loss: 1.4608 | pg_loss: 0.1601 | reg_loss: 0.7767 | reward: -0.0938 | rev_kl: 1.5389 | stu_lens: 119.5000 | mixed_lens: 89.0000 | lr: 1.8829e-06 | scale: 1024.00 | time: 26.844 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2944/  5000| tot_loss: 2.5294 | rl_loss: 0.7838 | pt_loss: 1.7456 | pg_loss: 0.3225 | reg_loss: 0.4613 | reward: -0.1960 | rev_kl: 1.0154 | stu_lens: 85.0156 | mixed_lens: 80.9531 | lr: 1.8829e-06 | scale: 1024.00 | time: 26.844 | step time: 28.062
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2945/  5000| tot_loss: 2.0629 | rl_loss: 0.7275 | pt_loss: 1.3354 | pg_loss: 0.4071 | reg_loss: 0.3204 | reward: -0.7119 | rev_kl: 1.0908 | stu_lens: 71.0000 | mixed_lens: 54.5000 | lr: 1.8814e-06 | scale: 1024.00 | time: 26.815 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2946/  5000| tot_loss: 2.5763 | rl_loss: 0.8834 | pt_loss: 1.6929 | pg_loss: 0.0403 | reg_loss: 0.8431 | reward: -0.2317 | rev_kl: 0.9892 | stu_lens: 101.0000 | mixed_lens: 128.0000 | lr: 1.8798e-06 | scale: 1024.00 | time: 26.868 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2947/  5000| tot_loss: 3.9410 | rl_loss: 2.3977 | pt_loss: 1.5432 | pg_loss: 0.6900 | reg_loss: 1.7077 | reward: -0.4089 | rev_kl: 0.6447 | stu_lens: 50.0000 | mixed_lens: 67.5000 | lr: 1.8783e-06 | scale: 1024.00 | time: 26.854 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2948/  5000| tot_loss: 3.5757 | rl_loss: 2.0414 | pt_loss: 1.5343 | pg_loss: 0.6119 | reg_loss: 1.4295 | reward: -0.5496 | rev_kl: 0.9483 | stu_lens: 108.5000 | mixed_lens: 58.5000 | lr: 1.8767e-06 | scale: 1024.00 | time: 26.834 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2949/  5000| tot_loss: 4.0794 | rl_loss: 2.3008 | pt_loss: 1.7787 | pg_loss: 0.6947 | reg_loss: 1.6061 | reward: -0.2178 | rev_kl: 0.7139 | stu_lens: 14.5000 | mixed_lens: 38.0000 | lr: 1.8752e-06 | scale: 1024.00 | time: 26.857 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2950/  5000| tot_loss: 3.8777 | rl_loss: 2.3011 | pt_loss: 1.5766 | pg_loss: 0.6137 | reg_loss: 1.6874 | reward: -0.7372 | rev_kl: 1.4661 | stu_lens: 64.5000 | mixed_lens: 43.0000 | lr: 1.8736e-06 | scale: 1024.00 | time: 26.856 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2951/  5000| tot_loss: 2.6818 | rl_loss: 1.3404 | pt_loss: 1.3413 | pg_loss: 0.0416 | reg_loss: 1.2988 | reward: -0.2062 | rev_kl: 1.3584 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.8721e-06 | scale: 1024.00 | time: 26.838 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2952/  5000| tot_loss: 3.6040 | rl_loss: 2.2863 | pt_loss: 1.3177 | pg_loss: 0.6965 | reg_loss: 1.5898 | reward: -0.8219 | rev_kl: 1.0238 | stu_lens: 81.5000 | mixed_lens: 59.5000 | lr: 1.8705e-06 | scale: 1024.00 | time: 26.820 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2953/  5000| tot_loss: 2.3605 | rl_loss: 0.9654 | pt_loss: 1.3951 | pg_loss: 0.0641 | reg_loss: 0.9013 | reward: -0.1606 | rev_kl: 0.6183 | stu_lens: 63.0000 | mixed_lens: 128.0000 | lr: 1.8690e-06 | scale: 1024.00 | time: 26.832 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2954/  5000| tot_loss: 3.3337 | rl_loss: 1.4672 | pt_loss: 1.8665 | pg_loss: 0.2277 | reg_loss: 1.2395 | reward: -0.2507 | rev_kl: 1.0933 | stu_lens: 73.0000 | mixed_lens: 99.0000 | lr: 1.8674e-06 | scale: 1024.00 | time: 26.809 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2955/  5000| tot_loss: 3.8043 | rl_loss: 1.6632 | pt_loss: 2.1411 | pg_loss: 0.2350 | reg_loss: 1.4282 | reward: -0.3659 | rev_kl: 1.2397 | stu_lens: 68.5000 | mixed_lens: 98.5000 | lr: 1.8659e-06 | scale: 1024.00 | time: 26.843 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2956/  5000| tot_loss: 2.2349 | rl_loss: 0.7567 | pt_loss: 1.4782 | pg_loss: 0.1319 | reg_loss: 0.6248 | reward: -0.1501 | rev_kl: 0.5715 | stu_lens: 70.0000 | mixed_lens: 111.5000 | lr: 1.8643e-06 | scale: 1024.00 | time: 26.813 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2957/  5000| tot_loss: 3.1275 | rl_loss: 1.3802 | pt_loss: 1.7473 | pg_loss: 0.0519 | reg_loss: 1.3283 | reward: -0.0898 | rev_kl: 1.1903 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.8628e-06 | scale: 1024.00 | time: 26.833 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2958/  5000| tot_loss: 2.7028 | rl_loss: 1.1414 | pt_loss: 1.5614 | pg_loss: 0.1646 | reg_loss: 0.9767 | reward: -0.2511 | rev_kl: 0.7190 | stu_lens: 57.5000 | mixed_lens: 114.0000 | lr: 1.8612e-06 | scale: 1024.00 | time: 26.817 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2959/  5000| tot_loss: 3.6682 | rl_loss: 1.9601 | pt_loss: 1.7081 | pg_loss: 0.4703 | reg_loss: 1.4898 | reward: -0.4548 | rev_kl: 1.7325 | stu_lens: 24.5000 | mixed_lens: 64.5000 | lr: 1.8597e-06 | scale: 1024.00 | time: 26.843 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2960/  5000| tot_loss: 2.5202 | rl_loss: 0.8622 | pt_loss: 1.6581 | pg_loss: 0.5020 | reg_loss: 0.3602 | reward: -0.5397 | rev_kl: 1.5668 | stu_lens: 68.0000 | mixed_lens: 48.0000 | lr: 1.8581e-06 | scale: 1024.00 | time: 26.833 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2960/  5000| tot_loss: 3.2498 | rl_loss: 1.5794 | pt_loss: 1.6703 | pg_loss: 0.3705 | reg_loss: 1.2089 | reward: -0.4148 | rev_kl: 1.1444 | stu_lens: 80.0312 | mixed_lens: 86.6562 | lr: 1.8581e-06 | scale: 1024.00 | time: 26.833 | step time: 28.050
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2961/  5000| tot_loss: 3.6961 | rl_loss: 1.9332 | pt_loss: 1.7629 | pg_loss: 0.3208 | reg_loss: 1.6125 | reward: -0.3329 | rev_kl: 1.3576 | stu_lens: 116.0000 | mixed_lens: 92.5000 | lr: 1.8566e-06 | scale: 1024.00 | time: 26.876 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2962/  5000| tot_loss: 3.6531 | rl_loss: 1.9224 | pt_loss: 1.7307 | pg_loss: 0.7529 | reg_loss: 1.1695 | reward: -0.3988 | rev_kl: 1.3046 | stu_lens: 11.5000 | mixed_lens: 52.0000 | lr: 1.8550e-06 | scale: 1024.00 | time: 26.839 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2963/  5000| tot_loss: 2.4543 | rl_loss: 0.8255 | pt_loss: 1.6288 | pg_loss: 0.0207 | reg_loss: 0.8048 | reward: -0.1869 | rev_kl: 1.1003 | stu_lens: 101.0000 | mixed_lens: 128.0000 | lr: 1.8535e-06 | scale: 1024.00 | time: 26.859 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2964/  5000| tot_loss: 4.3235 | rl_loss: 2.9898 | pt_loss: 1.3337 | pg_loss: 1.6878 | reg_loss: 1.3020 | reward: -1.0440 | rev_kl: 2.1433 | stu_lens: 34.5000 | mixed_lens: 22.0000 | lr: 1.8519e-06 | scale: 1024.00 | time: 26.848 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2965/  5000| tot_loss: 2.7668 | rl_loss: 1.1490 | pt_loss: 1.6177 | pg_loss: 0.2007 | reg_loss: 0.9483 | reward: -0.4691 | rev_kl: 1.1621 | stu_lens: 86.5000 | mixed_lens: 85.0000 | lr: 1.8504e-06 | scale: 1024.00 | time: 26.876 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2966/  5000| tot_loss: 3.2529 | rl_loss: 1.4958 | pt_loss: 1.7571 | pg_loss: 0.8217 | reg_loss: 0.6742 | reward: -0.3045 | rev_kl: 0.5496 | stu_lens: 72.5000 | mixed_lens: 42.0000 | lr: 1.8488e-06 | scale: 1024.00 | time: 26.845 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2967/  5000| tot_loss: 2.9877 | rl_loss: 1.2755 | pt_loss: 1.7122 | pg_loss: 0.2054 | reg_loss: 1.0701 | reward: -0.5482 | rev_kl: 3.6897 | stu_lens: 75.5000 | mixed_lens: 76.0000 | lr: 1.8473e-06 | scale: 1024.00 | time: 26.888 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2968/  5000| tot_loss: 3.0087 | rl_loss: 1.3432 | pt_loss: 1.6655 | pg_loss: 0.3267 | reg_loss: 1.0165 | reward: -0.8139 | rev_kl: 0.6599 | stu_lens: 81.5000 | mixed_lens: 78.0000 | lr: 1.8457e-06 | scale: 1024.00 | time: 26.899 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2969/  5000| tot_loss: 3.0066 | rl_loss: 1.3143 | pt_loss: 1.6923 | pg_loss: 0.2045 | reg_loss: 1.1098 | reward: -0.5464 | rev_kl: 1.2545 | stu_lens: 94.5000 | mixed_lens: 89.0000 | lr: 1.8442e-06 | scale: 1024.00 | time: 26.917 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2970/  5000| tot_loss: 2.8153 | rl_loss: 1.0818 | pt_loss: 1.7335 | pg_loss: 0.1270 | reg_loss: 0.9548 | reward: -0.3010 | rev_kl: 1.0279 | stu_lens: 85.5000 | mixed_lens: 114.0000 | lr: 1.8426e-06 | scale: 1024.00 | time: 26.842 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2971/  5000| tot_loss: 2.4693 | rl_loss: 0.9156 | pt_loss: 1.5537 | pg_loss: -0.0158 | reg_loss: 0.9315 | reward: -0.3898 | rev_kl: 1.2390 | stu_lens: 78.0000 | mixed_lens: 128.0000 | lr: 1.8411e-06 | scale: 1024.00 | time: 26.851 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2972/  5000| tot_loss: 2.8728 | rl_loss: 1.0421 | pt_loss: 1.8307 | pg_loss: 0.0270 | reg_loss: 1.0151 | reward: -0.3891 | rev_kl: 1.5985 | stu_lens: 107.5000 | mixed_lens: 127.0000 | lr: 1.8395e-06 | scale: 1024.00 | time: 26.832 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2973/  5000| tot_loss: 2.1581 | rl_loss: 0.7788 | pt_loss: 1.3793 | pg_loss: 0.1307 | reg_loss: 0.6481 | reward: -0.2069 | rev_kl: 1.0584 | stu_lens: 96.5000 | mixed_lens: 101.5000 | lr: 1.8380e-06 | scale: 1024.00 | time: 26.855 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2974/  5000| tot_loss: 2.7891 | rl_loss: 1.2225 | pt_loss: 1.5666 | pg_loss: 0.4527 | reg_loss: 0.7698 | reward: -0.3272 | rev_kl: 0.7805 | stu_lens: 70.5000 | mixed_lens: 67.5000 | lr: 1.8365e-06 | scale: 1024.00 | time: 26.838 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2975/  5000| tot_loss: 2.2439 | rl_loss: 0.5419 | pt_loss: 1.7020 | pg_loss: 0.3329 | reg_loss: 0.2090 | reward: -0.2306 | rev_kl: 0.5811 | stu_lens: 78.0000 | mixed_lens: 68.5000 | lr: 1.8349e-06 | scale: 1024.00 | time: 26.831 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2976/  5000| tot_loss: 2.9714 | rl_loss: 0.8726 | pt_loss: 2.0987 | pg_loss: 0.4120 | reg_loss: 0.4606 | reward: -0.2710 | rev_kl: 0.7643 | stu_lens: 116.0000 | mixed_lens: 73.0000 | lr: 1.8334e-06 | scale: 1024.00 | time: 26.839 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2976/  5000| tot_loss: 2.9467 | rl_loss: 1.2599 | pt_loss: 1.6868 | pg_loss: 0.3481 | reg_loss: 0.9118 | reward: -0.4121 | rev_kl: 1.1497 | stu_lens: 82.9219 | mixed_lens: 87.5625 | lr: 1.8334e-06 | scale: 1024.00 | time: 26.839 | step time: 28.072
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2977/  5000| tot_loss: 3.4297 | rl_loss: 1.2673 | pt_loss: 2.1624 | pg_loss: -0.0066 | reg_loss: 1.2739 | reward: -0.2190 | rev_kl: 1.3068 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.8318e-06 | scale: 1024.00 | time: 26.872 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2978/  5000| tot_loss: 2.2722 | rl_loss: 0.5763 | pt_loss: 1.6959 | pg_loss: -0.0047 | reg_loss: 0.5810 | reward: -0.1210 | rev_kl: 1.4225 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.8303e-06 | scale: 1024.00 | time: 26.820 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2979/  5000| tot_loss: 2.4521 | rl_loss: 0.8567 | pt_loss: 1.5953 | pg_loss: 0.0493 | reg_loss: 0.8074 | reward: -0.2539 | rev_kl: 3.0335 | stu_lens: 89.5000 | mixed_lens: 128.0000 | lr: 1.8287e-06 | scale: 1024.00 | time: 26.873 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2980/  5000| tot_loss: 3.2879 | rl_loss: 1.4805 | pt_loss: 1.8074 | pg_loss: 0.7894 | reg_loss: 0.6912 | reward: -0.8506 | rev_kl: 1.3375 | stu_lens: 94.5000 | mixed_lens: 52.0000 | lr: 1.8272e-06 | scale: 1024.00 | time: 26.850 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2981/  5000| tot_loss: 2.4557 | rl_loss: 0.5930 | pt_loss: 1.8626 | pg_loss: 0.1672 | reg_loss: 0.4259 | reward: -0.2459 | rev_kl: 0.8287 | stu_lens: 18.0000 | mixed_lens: 95.0000 | lr: 1.8256e-06 | scale: 1024.00 | time: 26.849 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2982/  5000| tot_loss: 2.0792 | rl_loss: 0.5627 | pt_loss: 1.5165 | pg_loss: 0.1521 | reg_loss: 0.4106 | reward: -0.2926 | rev_kl: 0.8787 | stu_lens: 128.0000 | mixed_lens: 96.0000 | lr: 1.8241e-06 | scale: 1024.00 | time: 26.829 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2983/  5000| tot_loss: 2.5509 | rl_loss: 1.0618 | pt_loss: 1.4891 | pg_loss: 0.4165 | reg_loss: 0.6453 | reward: -0.2112 | rev_kl: 0.7365 | stu_lens: 35.5000 | mixed_lens: 72.5000 | lr: 1.8226e-06 | scale: 1024.00 | time: 26.853 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2984/  5000| tot_loss: 3.4301 | rl_loss: 1.9042 | pt_loss: 1.5259 | pg_loss: 1.2876 | reg_loss: 0.6166 | reward: -0.4201 | rev_kl: 0.4197 | stu_lens: 45.5000 | mixed_lens: 20.5000 | lr: 1.8210e-06 | scale: 1024.00 | time: 26.828 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2985/  5000| tot_loss: 2.5318 | rl_loss: 0.7524 | pt_loss: 1.7794 | pg_loss: 0.1183 | reg_loss: 0.6340 | reward: 0.1251 | rev_kl: 1.3464 | stu_lens: 64.0000 | mixed_lens: 91.0000 | lr: 1.8195e-06 | scale: 1024.00 | time: 26.859 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2986/  5000| tot_loss: 2.6006 | rl_loss: 0.8636 | pt_loss: 1.7371 | pg_loss: 0.2306 | reg_loss: 0.6330 | reward: -0.4029 | rev_kl: 1.1284 | stu_lens: 117.0000 | mixed_lens: 95.0000 | lr: 1.8179e-06 | scale: 1024.00 | time: 26.840 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2987/  5000| tot_loss: 2.4189 | rl_loss: 1.1421 | pt_loss: 1.2768 | pg_loss: 0.3302 | reg_loss: 0.8119 | reward: -2.3482 | rev_kl: 1.2422 | stu_lens: 73.0000 | mixed_lens: 72.0000 | lr: 1.8164e-06 | scale: 1024.00 | time: 26.868 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2988/  5000| tot_loss: 2.5114 | rl_loss: 0.5963 | pt_loss: 1.9151 | pg_loss: 0.1680 | reg_loss: 0.4284 | reward: -0.2643 | rev_kl: 1.3342 | stu_lens: 58.0000 | mixed_lens: 98.5000 | lr: 1.8148e-06 | scale: 1024.00 | time: 26.852 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2989/  5000| tot_loss: 2.3469 | rl_loss: 0.3576 | pt_loss: 1.9892 | pg_loss: 0.0145 | reg_loss: 0.3431 | reward: -0.1460 | rev_kl: 0.9722 | stu_lens: 60.0000 | mixed_lens: 128.0000 | lr: 1.8133e-06 | scale: 1024.00 | time: 26.895 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2990/  5000| tot_loss: 3.1231 | rl_loss: 1.1218 | pt_loss: 2.0014 | pg_loss: 0.2931 | reg_loss: 0.8287 | reward: -0.7250 | rev_kl: 1.2163 | stu_lens: 128.0000 | mixed_lens: 64.0000 | lr: 1.8118e-06 | scale: 1024.00 | time: 26.878 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2991/  5000| tot_loss: 3.1756 | rl_loss: 1.0698 | pt_loss: 2.1058 | pg_loss: 0.2403 | reg_loss: 0.8295 | reward: -0.3632 | rev_kl: 1.0754 | stu_lens: 93.0000 | mixed_lens: 98.5000 | lr: 1.8102e-06 | scale: 1024.00 | time: 26.884 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2992/  5000| tot_loss: 2.8926 | rl_loss: 0.8409 | pt_loss: 2.0516 | pg_loss: 0.2694 | reg_loss: 0.5715 | reward: -0.7986 | rev_kl: 0.6337 | stu_lens: 81.5000 | mixed_lens: 65.0000 | lr: 1.8087e-06 | scale: 1024.00 | time: 26.879 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2992/  5000| tot_loss: 2.6853 | rl_loss: 0.9525 | pt_loss: 1.7328 | pg_loss: 0.2854 | reg_loss: 0.6672 | reward: -0.3858 | rev_kl: 1.1532 | stu_lens: 84.1250 | mixed_lens: 91.5469 | lr: 1.8087e-06 | scale: 1024.00 | time: 26.879 | step time: 28.072
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2993/  5000| tot_loss: 3.0012 | rl_loss: 1.6626 | pt_loss: 1.3386 | pg_loss: 0.9440 | reg_loss: 0.7186 | reward: -0.4211 | rev_kl: 0.9793 | stu_lens: 44.5000 | mixed_lens: 34.5000 | lr: 1.8071e-06 | scale: 1024.00 | time: 26.891 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2994/  5000| tot_loss: 3.2144 | rl_loss: 1.4951 | pt_loss: 1.7192 | pg_loss: 0.7279 | reg_loss: 0.7672 | reward: -0.7601 | rev_kl: 1.4832 | stu_lens: 38.0000 | mixed_lens: 49.5000 | lr: 1.8056e-06 | scale: 1024.00 | time: 26.896 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2995/  5000| tot_loss: 2.1193 | rl_loss: 0.7597 | pt_loss: 1.3596 | pg_loss: 0.2987 | reg_loss: 0.4610 | reward: -0.3347 | rev_kl: 1.0811 | stu_lens: 74.5000 | mixed_lens: 92.5000 | lr: 1.8041e-06 | scale: 1024.00 | time: 26.873 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2996/  5000| tot_loss: 2.4911 | rl_loss: 0.7683 | pt_loss: 1.7228 | pg_loss: 0.3414 | reg_loss: 0.4268 | reward: -0.2820 | rev_kl: 0.7814 | stu_lens: 94.5000 | mixed_lens: 85.0000 | lr: 1.8025e-06 | scale: 1024.00 | time: 26.839 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2997/  5000| tot_loss: 2.4603 | rl_loss: 0.6366 | pt_loss: 1.8237 | pg_loss: 0.0760 | reg_loss: 0.5607 | reward: -0.3585 | rev_kl: 1.2411 | stu_lens: 128.0000 | mixed_lens: 115.5000 | lr: 1.8010e-06 | scale: 1024.00 | time: 26.864 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2998/  5000| tot_loss: 2.2181 | rl_loss: 0.6705 | pt_loss: 1.5476 | pg_loss: -0.0063 | reg_loss: 0.6768 | reward: -0.2906 | rev_kl: 1.4133 | stu_lens: 107.5000 | mixed_lens: 128.0000 | lr: 1.7994e-06 | scale: 1024.00 | time: 26.848 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2999/  5000| tot_loss: 3.4114 | rl_loss: 1.4094 | pt_loss: 2.0020 | pg_loss: 0.5930 | reg_loss: 0.8164 | reward: -0.4089 | rev_kl: 0.6447 | stu_lens: 50.0000 | mixed_lens: 67.5000 | lr: 1.7979e-06 | scale: 1024.00 | time: 26.871 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/3000
                                 Evaluation #30                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Bob should leave Alice, as his       │
│                                       │ chances of survival improve by 9%.   │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ It is an alphabetical keyboard, so   │
│                                       │ the keys are laid out in             │
│                                       │ alphabetical order. The keys that    │
│                                       │ are typically associated with a      │
│                                       │ particular letter are marked with    │
│                                       │ that letter. For example, the key    │
│                                       │ for the letter "q" is marked with a  │
│                                       │ "q" and the key for the letter "z"   │
│                                       │ is marked with a "z".                │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support over 100 languages. To    │
│                                       │ see all the languages we support,    │
│                                       │ visit our docs:                      │
│                                       │ https://www.facebook.com/help/36445… │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.797 | exact_match: 0.215 | rev_kl: 1.082 | lens: 83.978 | pt_loss: 1.073 | lm_loss: 1.155 | kd_loss: 0.991 
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   3000/  5000| tot_loss: 2.0038 | rl_loss: 0.8405 | pt_loss: 1.1633 | pg_loss: 0.2647 | reg_loss: 0.5757 | reward: -0.7727 | rev_kl: 0.9047 | stu_lens: 54.5000 | mixed_lens: 78.0000 | lr: 1.7964e-06 | scale: 1024.00 | time: 26.829 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   3001/  5000| tot_loss: 1.9910 | rl_loss: 0.4744 | pt_loss: 1.5166 | pg_loss: 0.1655 | reg_loss: 0.3089 | reward: -0.4609 | rev_kl: 0.7173 | stu_lens: 111.5000 | mixed_lens: 72.5000 | lr: 1.7948e-06 | scale: 1024.00 | time: 26.981 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   3002/  5000| tot_loss: 2.2051 | rl_loss: 0.4060 | pt_loss: 1.7991 | pg_loss: 0.1578 | reg_loss: 0.2482 | reward: -0.1478 | rev_kl: 0.5133 | stu_lens: 79.5000 | mixed_lens: 108.5000 | lr: 1.7933e-06 | scale: 1024.00 | time: 26.992 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   3003/  5000| tot_loss: 2.0988 | rl_loss: 0.4694 | pt_loss: 1.6294 | pg_loss: 0.0730 | reg_loss: 0.3964 | reward: -0.2702 | rev_kl: 1.4247 | stu_lens: 21.0000 | mixed_lens: 115.0000 | lr: 1.7918e-06 | scale: 1024.00 | time: 26.983 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   3004/  5000| tot_loss: 1.8080 | rl_loss: 0.4829 | pt_loss: 1.3251 | pg_loss: 0.0810 | reg_loss: 0.4019 | reward: -0.1602 | rev_kl: 1.0628 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 1.7902e-06 | scale: 1024.00 | time: 26.972 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   3005/  5000| tot_loss: 3.5724 | rl_loss: 1.4694 | pt_loss: 2.1030 | pg_loss: 1.0485 | reg_loss: 0.4209 | reward: -0.4651 | rev_kl: 0.5629 | stu_lens: 65.0000 | mixed_lens: 34.5000 | lr: 1.7887e-06 | scale: 1024.00 | time: 27.005 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   3006/  5000| tot_loss: 2.0488 | rl_loss: 0.4639 | pt_loss: 1.5849 | pg_loss: -0.0060 | reg_loss: 0.4699 | reward: -0.0772 | rev_kl: 1.1277 | stu_lens: 103.5000 | mixed_lens: 128.0000 | lr: 1.7871e-06 | scale: 1024.00 | time: 26.989 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   3007/  5000| tot_loss: 2.5429 | rl_loss: 0.8223 | pt_loss: 1.7206 | pg_loss: 0.2606 | reg_loss: 0.5617 | reward: -0.4191 | rev_kl: 1.3803 | stu_lens: 128.0000 | mixed_lens: 85.0000 | lr: 1.7856e-06 | scale: 1024.00 | time: 26.958 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3008/  5000| tot_loss: 3.2243 | rl_loss: 1.4200 | pt_loss: 1.8043 | pg_loss: 1.0809 | reg_loss: 0.3391 | reward: -0.2389 | rev_kl: 0.4602 | stu_lens: 21.0000 | mixed_lens: 20.5000 | lr: 1.7841e-06 | scale: 1024.00 | time: 26.951 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3008/  5000| tot_loss: 2.5729 | rl_loss: 0.8880 | pt_loss: 1.6850 | pg_loss: 0.3463 | reg_loss: 0.5417 | reward: -0.4185 | rev_kl: 1.1153 | stu_lens: 80.4688 | mixed_lens: 86.4531 | lr: 1.7841e-06 | scale: 1024.00 | time: 26.951 | step time: 28.136
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   3009/  5000| tot_loss: 2.6411 | rl_loss: 1.0604 | pt_loss: 1.5807 | pg_loss: 0.5565 | reg_loss: 0.5039 | reward: -0.1337 | rev_kl: 2.8593 | stu_lens: 72.5000 | mixed_lens: 72.5000 | lr: 1.7825e-06 | scale: 1024.00 | time: 26.963 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   3010/  5000| tot_loss: 3.1001 | rl_loss: 1.3787 | pt_loss: 1.7214 | pg_loss: 1.1008 | reg_loss: 0.2779 | reward: -0.1286 | rev_kl: 0.1329 | stu_lens: 65.0000 | mixed_lens: 24.0000 | lr: 1.7810e-06 | scale: 1024.00 | time: 26.996 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   3011/  5000| tot_loss: 4.4169 | rl_loss: 2.4829 | pt_loss: 1.9340 | pg_loss: 1.0401 | reg_loss: 1.4428 | reward: -0.9099 | rev_kl: 0.9359 | stu_lens: 45.5000 | mixed_lens: 42.5000 | lr: 1.7795e-06 | scale: 1024.00 | time: 26.982 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   3012/  5000| tot_loss: 3.2838 | rl_loss: 1.8774 | pt_loss: 1.4065 | pg_loss: 0.4047 | reg_loss: 1.4727 | reward: -1.6061 | rev_kl: 1.5853 | stu_lens: 88.5000 | mixed_lens: 60.5000 | lr: 1.7779e-06 | scale: 1024.00 | time: 26.974 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   3013/  5000| tot_loss: 2.8449 | rl_loss: 1.2515 | pt_loss: 1.5934 | pg_loss: 0.0621 | reg_loss: 1.1894 | reward: -0.2306 | rev_kl: 1.3463 | stu_lens: 91.5000 | mixed_lens: 128.0000 | lr: 1.7764e-06 | scale: 1024.00 | time: 27.027 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   3014/  5000| tot_loss: 4.0490 | rl_loss: 2.1811 | pt_loss: 1.8679 | pg_loss: 0.8897 | reg_loss: 1.2914 | reward: -0.6376 | rev_kl: 0.9002 | stu_lens: 71.5000 | mixed_lens: 50.0000 | lr: 1.7749e-06 | scale: 1024.00 | time: 26.942 | step time: 0.000
[2023-12-20 05:57:08,846] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 1024, reducing to 512
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   3015/  5000| tot_loss: 3.4098 | rl_loss: 1.2911 | pt_loss: 2.1187 | pg_loss: 0.2166 | reg_loss: 1.0746 | reward: -0.1909 | rev_kl: 0.9455 | stu_lens: 112.0000 | mixed_lens: 96.5000 | lr: 1.7749e-06 | scale: 512.00 | time: 2.847 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   3016/  5000| tot_loss: 2.7643 | rl_loss: 0.8538 | pt_loss: 1.9105 | pg_loss: 0.1071 | reg_loss: 0.7467 | reward: -0.2008 | rev_kl: 0.3056 | stu_lens: 78.0000 | mixed_lens: 64.0000 | lr: 1.7733e-06 | scale: 512.00 | time: 26.955 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   3017/  5000| tot_loss: 3.8765 | rl_loss: 2.0316 | pt_loss: 1.8449 | pg_loss: 0.5346 | reg_loss: 1.4970 | reward: -0.7000 | rev_kl: 1.7085 | stu_lens: 55.5000 | mixed_lens: 77.0000 | lr: 1.7718e-06 | scale: 512.00 | time: 26.947 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   3018/  5000| tot_loss: 3.5833 | rl_loss: 1.8183 | pt_loss: 1.7650 | pg_loss: 0.6048 | reg_loss: 1.2135 | reward: -0.3713 | rev_kl: 1.0504 | stu_lens: 104.5000 | mixed_lens: 77.5000 | lr: 1.7703e-06 | scale: 512.00 | time: 26.944 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   3019/  5000| tot_loss: 3.0147 | rl_loss: 1.9142 | pt_loss: 1.1004 | pg_loss: 0.0993 | reg_loss: 1.8150 | reward: -0.2307 | rev_kl: 1.1517 | stu_lens: 105.0000 | mixed_lens: 125.0000 | lr: 1.7687e-06 | scale: 512.00 | time: 26.932 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   3020/  5000| tot_loss: 2.6643 | rl_loss: 1.5075 | pt_loss: 1.1568 | pg_loss: 0.4127 | reg_loss: 1.0948 | reward: -0.5470 | rev_kl: 1.1912 | stu_lens: 100.5000 | mixed_lens: 87.0000 | lr: 1.7672e-06 | scale: 512.00 | time: 26.949 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   3021/  5000| tot_loss: 3.6808 | rl_loss: 2.0945 | pt_loss: 1.5863 | pg_loss: 0.6665 | reg_loss: 1.4280 | reward: -0.2091 | rev_kl: 0.5556 | stu_lens: 74.5000 | mixed_lens: 65.5000 | lr: 1.7657e-06 | scale: 512.00 | time: 26.929 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   3022/  5000| tot_loss: 3.1646 | rl_loss: 1.4863 | pt_loss: 1.6782 | pg_loss: 0.3475 | reg_loss: 1.1389 | reward: -0.2272 | rev_kl: 0.8099 | stu_lens: 93.5000 | mixed_lens: 90.0000 | lr: 1.7641e-06 | scale: 512.00 | time: 26.959 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   3023/  5000| tot_loss: 3.1938 | rl_loss: 1.3415 | pt_loss: 1.8523 | pg_loss: 0.3260 | reg_loss: 1.0155 | reward: -0.3979 | rev_kl: 1.1128 | stu_lens: 80.0000 | mixed_lens: 92.5000 | lr: 1.7626e-06 | scale: 512.00 | time: 26.971 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3024/  5000| tot_loss: 2.8422 | rl_loss: 1.0811 | pt_loss: 1.7610 | pg_loss: 0.1209 | reg_loss: 0.9603 | reward: -0.2278 | rev_kl: 0.7098 | stu_lens: 118.5000 | mixed_lens: 112.5000 | lr: 1.7611e-06 | scale: 512.00 | time: 26.972 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3024/  5000| tot_loss: 3.3902 | rl_loss: 1.6987 | pt_loss: 1.6914 | pg_loss: 0.5148 | reg_loss: 1.1840 | reward: -0.4337 | rev_kl: 1.0764 | stu_lens: 90.7969 | mixed_lens: 87.2188 | lr: 1.7611e-06 | scale: 512.00 | time: 26.972 | step time: 26.669
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   3025/  5000| tot_loss: 3.6598 | rl_loss: 1.7948 | pt_loss: 1.8650 | pg_loss: 0.2382 | reg_loss: 1.5566 | reward: -0.3564 | rev_kl: 1.1637 | stu_lens: 90.5000 | mixed_lens: 96.5000 | lr: 1.7595e-06 | scale: 512.00 | time: 26.939 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   3026/  5000| tot_loss: 2.7003 | rl_loss: 0.9078 | pt_loss: 1.7924 | pg_loss: 0.1153 | reg_loss: 0.7925 | reward: -0.3007 | rev_kl: 1.0284 | stu_lens: 118.5000 | mixed_lens: 115.5000 | lr: 1.7580e-06 | scale: 512.00 | time: 26.987 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   3027/  5000| tot_loss: 2.8896 | rl_loss: 0.9229 | pt_loss: 1.9666 | pg_loss: 0.0009 | reg_loss: 0.9220 | reward: -0.0984 | rev_kl: 0.8884 | stu_lens: 121.0000 | mixed_lens: 128.0000 | lr: 1.7565e-06 | scale: 512.00 | time: 26.979 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   3028/  5000| tot_loss: 2.8138 | rl_loss: 1.5201 | pt_loss: 1.2936 | pg_loss: 1.1361 | reg_loss: 0.3840 | reward: -0.5363 | rev_kl: 0.7921 | stu_lens: 38.5000 | mixed_lens: 29.0000 | lr: 1.7549e-06 | scale: 512.00 | time: 27.015 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   3029/  5000| tot_loss: 2.5815 | rl_loss: 1.1433 | pt_loss: 1.4382 | pg_loss: 0.0971 | reg_loss: 1.0461 | reward: -0.3583 | rev_kl: 1.3419 | stu_lens: 128.0000 | mixed_lens: 120.5000 | lr: 1.7534e-06 | scale: 512.00 | time: 27.008 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   3030/  5000| tot_loss: 3.5740 | rl_loss: 1.7108 | pt_loss: 1.8632 | pg_loss: 0.4759 | reg_loss: 1.2349 | reward: -1.4326 | rev_kl: 1.3952 | stu_lens: 79.0000 | mixed_lens: 63.5000 | lr: 1.7519e-06 | scale: 512.00 | time: 26.972 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   3031/  5000| tot_loss: 3.1311 | rl_loss: 1.2524 | pt_loss: 1.8787 | pg_loss: -0.0161 | reg_loss: 1.2685 | reward: -0.2176 | rev_kl: 0.9121 | stu_lens: 118.5000 | mixed_lens: 128.0000 | lr: 1.7504e-06 | scale: 512.00 | time: 26.953 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   3032/  5000| tot_loss: 2.2188 | rl_loss: 0.9668 | pt_loss: 1.2520 | pg_loss: 0.3148 | reg_loss: 0.6519 | reward: -0.4164 | rev_kl: 1.0723 | stu_lens: 109.5000 | mixed_lens: 88.5000 | lr: 1.7488e-06 | scale: 512.00 | time: 26.977 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   3033/  5000| tot_loss: 2.1235 | rl_loss: 1.1473 | pt_loss: 0.9762 | pg_loss: 0.1341 | reg_loss: 1.0132 | reward: -0.2191 | rev_kl: 1.0336 | stu_lens: 111.5000 | mixed_lens: 110.0000 | lr: 1.7473e-06 | scale: 512.00 | time: 26.933 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   3034/  5000| tot_loss: 3.3272 | rl_loss: 1.4900 | pt_loss: 1.8372 | pg_loss: 0.2936 | reg_loss: 1.1964 | reward: -0.4435 | rev_kl: 1.5868 | stu_lens: 52.0000 | mixed_lens: 89.0000 | lr: 1.7458e-06 | scale: 512.00 | time: 26.961 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   3035/  5000| tot_loss: 2.8157 | rl_loss: 1.2731 | pt_loss: 1.5426 | pg_loss: 0.3256 | reg_loss: 0.9476 | reward: -0.1494 | rev_kl: 0.8686 | stu_lens: 65.0000 | mixed_lens: 65.0000 | lr: 1.7442e-06 | scale: 512.00 | time: 26.967 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   3036/  5000| tot_loss: 2.8024 | rl_loss: 0.9736 | pt_loss: 1.8288 | pg_loss: 0.0126 | reg_loss: 0.9610 | reward: -0.3544 | rev_kl: 1.1130 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.7427e-06 | scale: 512.00 | time: 26.961 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   3037/  5000| tot_loss: 2.2052 | rl_loss: 0.9130 | pt_loss: 1.2922 | pg_loss: 0.2703 | reg_loss: 0.6427 | reward: -0.4870 | rev_kl: 1.3537 | stu_lens: 80.0000 | mixed_lens: 87.0000 | lr: 1.7412e-06 | scale: 512.00 | time: 26.945 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   3038/  5000| tot_loss: 3.6149 | rl_loss: 1.7242 | pt_loss: 1.8907 | pg_loss: 0.9401 | reg_loss: 0.7842 | reward: -0.7245 | rev_kl: 0.5902 | stu_lens: 96.0000 | mixed_lens: 46.0000 | lr: 1.7397e-06 | scale: 512.00 | time: 26.972 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   3039/  5000| tot_loss: 2.7554 | rl_loss: 1.1368 | pt_loss: 1.6185 | pg_loss: 0.3023 | reg_loss: 0.8345 | reward: -0.3954 | rev_kl: 1.1404 | stu_lens: 119.5000 | mixed_lens: 77.5000 | lr: 1.7381e-06 | scale: 512.00 | time: 26.953 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3040/  5000| tot_loss: 3.1228 | rl_loss: 1.1123 | pt_loss: 2.0105 | pg_loss: 0.1859 | reg_loss: 0.9264 | reward: -0.4329 | rev_kl: 1.1383 | stu_lens: 80.0000 | mixed_lens: 104.5000 | lr: 1.7366e-06 | scale: 512.00 | time: 26.987 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3040/  5000| tot_loss: 2.8032 | rl_loss: 1.2067 | pt_loss: 1.5964 | pg_loss: 0.3412 | reg_loss: 0.8655 | reward: -0.4443 | rev_kl: 1.0523 | stu_lens: 89.5625 | mixed_lens: 84.9062 | lr: 1.7366e-06 | scale: 512.00 | time: 26.987 | step time: 28.183
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   3041/  5000| tot_loss: 3.0778 | rl_loss: 1.3375 | pt_loss: 1.7403 | pg_loss: 0.4505 | reg_loss: 0.8870 | reward: -0.2688 | rev_kl: 0.9307 | stu_lens: 87.0000 | mixed_lens: 58.5000 | lr: 1.7351e-06 | scale: 512.00 | time: 26.973 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   3042/  5000| tot_loss: 2.6172 | rl_loss: 0.8150 | pt_loss: 1.8022 | pg_loss: -0.0017 | reg_loss: 0.8167 | reward: -0.1773 | rev_kl: 1.2877 | stu_lens: 102.5000 | mixed_lens: 128.0000 | lr: 1.7336e-06 | scale: 512.00 | time: 27.005 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   3043/  5000| tot_loss: 2.4306 | rl_loss: 0.4305 | pt_loss: 2.0000 | pg_loss: -0.1364 | reg_loss: 0.5670 | reward: 0.3182 | rev_kl: 1.4385 | stu_lens: 76.5000 | mixed_lens: 44.0000 | lr: 1.7320e-06 | scale: 512.00 | time: 27.039 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   3044/  5000| tot_loss: 2.9810 | rl_loss: 1.3268 | pt_loss: 1.6542 | pg_loss: 0.6879 | reg_loss: 0.6390 | reward: -0.2648 | rev_kl: 0.6329 | stu_lens: 69.5000 | mixed_lens: 54.5000 | lr: 1.7305e-06 | scale: 512.00 | time: 26.965 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   3045/  5000| tot_loss: 3.4306 | rl_loss: 1.4681 | pt_loss: 1.9625 | pg_loss: 0.6084 | reg_loss: 0.8597 | reward: -2.2574 | rev_kl: 1.1692 | stu_lens: 105.0000 | mixed_lens: 58.0000 | lr: 1.7290e-06 | scale: 512.00 | time: 26.970 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   3046/  5000| tot_loss: 2.2689 | rl_loss: 0.6864 | pt_loss: 1.5825 | pg_loss: -0.0061 | reg_loss: 0.6924 | reward: -0.3348 | rev_kl: 1.3818 | stu_lens: 88.5000 | mixed_lens: 128.0000 | lr: 1.7275e-06 | scale: 512.00 | time: 26.989 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   3047/  5000| tot_loss: 2.8687 | rl_loss: 1.0986 | pt_loss: 1.7701 | pg_loss: 0.7883 | reg_loss: 0.3104 | reward: -0.1323 | rev_kl: 0.3192 | stu_lens: 36.5000 | mixed_lens: 51.0000 | lr: 1.7259e-06 | scale: 512.00 | time: 26.939 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   3048/  5000| tot_loss: 2.9985 | rl_loss: 1.2350 | pt_loss: 1.7635 | pg_loss: 0.4149 | reg_loss: 0.8201 | reward: -0.6846 | rev_kl: 1.5232 | stu_lens: 65.5000 | mixed_lens: 82.0000 | lr: 1.7244e-06 | scale: 512.00 | time: 26.953 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   3049/  5000| tot_loss: 2.6773 | rl_loss: 1.1388 | pt_loss: 1.5385 | pg_loss: 0.4691 | reg_loss: 0.6697 | reward: -0.4314 | rev_kl: 1.2638 | stu_lens: 109.5000 | mixed_lens: 78.5000 | lr: 1.7229e-06 | scale: 512.00 | time: 26.939 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   3050/  5000| tot_loss: 2.2943 | rl_loss: 0.7850 | pt_loss: 1.5093 | pg_loss: 0.0102 | reg_loss: 0.7747 | reward: -0.2736 | rev_kl: 1.1275 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.7214e-06 | scale: 512.00 | time: 26.966 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   3051/  5000| tot_loss: 1.8923 | rl_loss: 0.4433 | pt_loss: 1.4490 | pg_loss: 0.0050 | reg_loss: 0.4384 | reward: -0.0811 | rev_kl: 0.6427 | stu_lens: 124.5000 | mixed_lens: 128.0000 | lr: 1.7198e-06 | scale: 512.00 | time: 26.953 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   3052/  5000| tot_loss: 2.4186 | rl_loss: 0.6153 | pt_loss: 1.8033 | pg_loss: 0.0911 | reg_loss: 0.5243 | reward: -0.3282 | rev_kl: 1.3694 | stu_lens: 128.0000 | mixed_lens: 110.5000 | lr: 1.7183e-06 | scale: 512.00 | time: 26.971 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   3053/  5000| tot_loss: 2.1789 | rl_loss: 1.0206 | pt_loss: 1.1584 | pg_loss: 0.0422 | reg_loss: 0.9784 | reward: -0.2373 | rev_kl: 1.1722 | stu_lens: 96.0000 | mixed_lens: 125.0000 | lr: 1.7168e-06 | scale: 512.00 | time: 26.967 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   3054/  5000| tot_loss: 2.2180 | rl_loss: 0.6021 | pt_loss: 1.6159 | pg_loss: 0.2201 | reg_loss: 0.3820 | reward: -0.7613 | rev_kl: 1.2219 | stu_lens: 45.0000 | mixed_lens: 81.5000 | lr: 1.7153e-06 | scale: 512.00 | time: 26.990 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   3055/  5000| tot_loss: 2.3173 | rl_loss: 0.7809 | pt_loss: 1.5364 | pg_loss: 0.1388 | reg_loss: 0.6421 | reward: -0.3051 | rev_kl: 1.0351 | stu_lens: 121.5000 | mixed_lens: 96.5000 | lr: 1.7138e-06 | scale: 512.00 | time: 27.008 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3056/  5000| tot_loss: 2.1515 | rl_loss: 0.5960 | pt_loss: 1.5555 | pg_loss: 0.2554 | reg_loss: 0.3406 | reward: -0.1289 | rev_kl: 0.6002 | stu_lens: 93.5000 | mixed_lens: 90.0000 | lr: 1.7122e-06 | scale: 512.00 | time: 27.014 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3056/  5000| tot_loss: 2.5085 | rl_loss: 0.9036 | pt_loss: 1.6049 | pg_loss: 0.2839 | reg_loss: 0.6197 | reward: -0.4149 | rev_kl: 1.0283 | stu_lens: 91.0469 | mixed_lens: 84.8438 | lr: 1.7122e-06 | scale: 512.00 | time: 27.014 | step time: 28.191
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   3057/  5000| tot_loss: 2.8003 | rl_loss: 1.3486 | pt_loss: 1.4517 | pg_loss: 0.5190 | reg_loss: 0.8296 | reward: -1.3506 | rev_kl: 1.3530 | stu_lens: 62.5000 | mixed_lens: 55.0000 | lr: 1.7107e-06 | scale: 512.00 | time: 27.004 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   3058/  5000| tot_loss: 1.8864 | rl_loss: 0.4993 | pt_loss: 1.3871 | pg_loss: 0.0062 | reg_loss: 0.4930 | reward: -0.2929 | rev_kl: 1.6776 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.7092e-06 | scale: 512.00 | time: 26.987 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   3059/  5000| tot_loss: 2.7627 | rl_loss: 0.8758 | pt_loss: 1.8869 | pg_loss: 0.1751 | reg_loss: 0.7007 | reward: -0.1764 | rev_kl: 1.3016 | stu_lens: 86.0000 | mixed_lens: 110.0000 | lr: 1.7077e-06 | scale: 512.00 | time: 26.955 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   3060/  5000| tot_loss: 2.6748 | rl_loss: 0.7108 | pt_loss: 1.9640 | pg_loss: 0.1519 | reg_loss: 0.5590 | reward: -0.3948 | rev_kl: 0.9130 | stu_lens: 128.0000 | mixed_lens: 90.5000 | lr: 1.7061e-06 | scale: 512.00 | time: 26.982 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   3061/  5000| tot_loss: 2.6643 | rl_loss: 0.6623 | pt_loss: 2.0020 | pg_loss: 0.0318 | reg_loss: 0.6304 | reward: -0.2543 | rev_kl: 1.1908 | stu_lens: 107.0000 | mixed_lens: 120.0000 | lr: 1.7046e-06 | scale: 512.00 | time: 26.963 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   3062/  5000| tot_loss: 2.6559 | rl_loss: 1.1027 | pt_loss: 1.5533 | pg_loss: 0.4818 | reg_loss: 0.6208 | reward: -0.8009 | rev_kl: 1.2435 | stu_lens: 81.5000 | mixed_lens: 72.0000 | lr: 1.7031e-06 | scale: 512.00 | time: 26.962 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   3063/  5000| tot_loss: 2.4017 | rl_loss: 0.6083 | pt_loss: 1.7934 | pg_loss: 0.2320 | reg_loss: 0.3763 | reward: -0.1200 | rev_kl: 0.5284 | stu_lens: 93.5000 | mixed_lens: 90.0000 | lr: 1.7016e-06 | scale: 512.00 | time: 26.939 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   3064/  5000| tot_loss: 3.0788 | rl_loss: 0.9931 | pt_loss: 2.0857 | pg_loss: 0.4087 | reg_loss: 0.5844 | reward: -0.5378 | rev_kl: 1.4432 | stu_lens: 73.5000 | mixed_lens: 61.0000 | lr: 1.7001e-06 | scale: 512.00 | time: 26.972 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   3065/  5000| tot_loss: 2.3328 | rl_loss: 0.8042 | pt_loss: 1.5287 | pg_loss: 0.3432 | reg_loss: 0.4609 | reward: -0.5422 | rev_kl: 1.0904 | stu_lens: 84.5000 | mixed_lens: 84.5000 | lr: 1.6986e-06 | scale: 512.00 | time: 26.948 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   3066/  5000| tot_loss: 2.9313 | rl_loss: 1.0432 | pt_loss: 1.8880 | pg_loss: 0.5661 | reg_loss: 0.4771 | reward: 0.0052 | rev_kl: 0.9831 | stu_lens: 90.5000 | mixed_lens: 60.0000 | lr: 1.6970e-06 | scale: 512.00 | time: 26.977 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   3067/  5000| tot_loss: 2.3018 | rl_loss: 0.3959 | pt_loss: 1.9058 | pg_loss: 0.0782 | reg_loss: 0.3177 | reward: -0.2040 | rev_kl: 0.9228 | stu_lens: 116.0000 | mixed_lens: 101.0000 | lr: 1.6955e-06 | scale: 512.00 | time: 27.011 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   3068/  5000| tot_loss: 2.2526 | rl_loss: 0.3335 | pt_loss: 1.9190 | pg_loss: 0.0412 | reg_loss: 0.2923 | reward: 0.3020 | rev_kl: 1.2329 | stu_lens: 76.5000 | mixed_lens: 69.0000 | lr: 1.6940e-06 | scale: 512.00 | time: 26.992 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   3069/  5000| tot_loss: 3.0510 | rl_loss: 1.0902 | pt_loss: 1.9608 | pg_loss: 0.3759 | reg_loss: 0.7143 | reward: -0.4728 | rev_kl: 1.2045 | stu_lens: 101.5000 | mixed_lens: 92.5000 | lr: 1.6925e-06 | scale: 512.00 | time: 26.981 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   3070/  5000| tot_loss: 2.7767 | rl_loss: 1.0421 | pt_loss: 1.7346 | pg_loss: 0.4252 | reg_loss: 0.6169 | reward: -0.6846 | rev_kl: 1.5232 | stu_lens: 65.5000 | mixed_lens: 82.0000 | lr: 1.6910e-06 | scale: 512.00 | time: 27.014 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   3071/  5000| tot_loss: 2.3500 | rl_loss: 0.8022 | pt_loss: 1.5478 | pg_loss: 0.2062 | reg_loss: 0.5960 | reward: -0.6561 | rev_kl: 0.9683 | stu_lens: 91.0000 | mixed_lens: 94.5000 | lr: 1.6894e-06 | scale: 512.00 | time: 27.008 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3072/  5000| tot_loss: 3.1581 | rl_loss: 1.3899 | pt_loss: 1.7681 | pg_loss: 1.0510 | reg_loss: 0.3389 | reward: -0.3880 | rev_kl: 0.3291 | stu_lens: 14.0000 | mixed_lens: 25.5000 | lr: 1.6879e-06 | scale: 512.00 | time: 26.991 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3072/  5000| tot_loss: 2.5380 | rl_loss: 0.7862 | pt_loss: 1.7517 | pg_loss: 0.2706 | reg_loss: 0.5157 | reward: -0.4771 | rev_kl: 1.0583 | stu_lens: 90.9219 | mixed_lens: 87.0625 | lr: 1.6879e-06 | scale: 512.00 | time: 26.991 | step time: 28.194
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   3073/  5000| tot_loss: 2.4812 | rl_loss: 0.6480 | pt_loss: 1.8331 | pg_loss: 0.3363 | reg_loss: 0.3117 | reward: -0.1715 | rev_kl: 0.3942 | stu_lens: 74.5000 | mixed_lens: 75.0000 | lr: 1.6864e-06 | scale: 512.00 | time: 26.950 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   3074/  5000| tot_loss: 2.3072 | rl_loss: 1.1611 | pt_loss: 1.1460 | pg_loss: 0.4192 | reg_loss: 0.7419 | reward: -0.4146 | rev_kl: 5.5838 | stu_lens: 73.0000 | mixed_lens: 72.0000 | lr: 1.6849e-06 | scale: 512.00 | time: 27.032 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   3075/  5000| tot_loss: 2.7286 | rl_loss: 1.6035 | pt_loss: 1.1252 | pg_loss: 0.2565 | reg_loss: 1.3470 | reward: -0.2750 | rev_kl: 1.4366 | stu_lens: 128.0000 | mixed_lens: 102.0000 | lr: 1.6834e-06 | scale: 512.00 | time: 26.972 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   3076/  5000| tot_loss: 3.4843 | rl_loss: 1.7321 | pt_loss: 1.7522 | pg_loss: 0.4475 | reg_loss: 1.2846 | reward: -4.7909 | rev_kl: 2.4001 | stu_lens: 45.5000 | mixed_lens: 42.0000 | lr: 1.6819e-06 | scale: 512.00 | time: 26.978 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   3077/  5000| tot_loss: 3.3394 | rl_loss: 1.7897 | pt_loss: 1.5497 | pg_loss: 0.2658 | reg_loss: 1.5239 | reward: -0.5226 | rev_kl: 0.8006 | stu_lens: 92.5000 | mixed_lens: 87.0000 | lr: 1.6804e-06 | scale: 512.00 | time: 26.978 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   3078/  5000| tot_loss: 3.6088 | rl_loss: 1.5721 | pt_loss: 2.0367 | pg_loss: 0.1314 | reg_loss: 1.4407 | reward: -0.3809 | rev_kl: 1.0892 | stu_lens: 101.0000 | mixed_lens: 121.5000 | lr: 1.6788e-06 | scale: 512.00 | time: 26.963 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   3079/  5000| tot_loss: 2.6382 | rl_loss: 1.0430 | pt_loss: 1.5952 | pg_loss: 0.1581 | reg_loss: 0.8850 | reward: -0.1995 | rev_kl: 0.6754 | stu_lens: 84.5000 | mixed_lens: 102.0000 | lr: 1.6773e-06 | scale: 512.00 | time: 26.950 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   3080/  5000| tot_loss: 3.4104 | rl_loss: 1.3454 | pt_loss: 2.0651 | pg_loss: 0.1898 | reg_loss: 1.1556 | reward: -0.4518 | rev_kl: 1.0863 | stu_lens: 103.5000 | mixed_lens: 105.5000 | lr: 1.6758e-06 | scale: 512.00 | time: 26.935 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   3081/  5000| tot_loss: 3.3150 | rl_loss: 1.5978 | pt_loss: 1.7172 | pg_loss: 0.9127 | reg_loss: 0.6851 | reward: -0.5918 | rev_kl: 0.8363 | stu_lens: 44.0000 | mixed_lens: 36.5000 | lr: 1.6743e-06 | scale: 512.00 | time: 26.942 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   3082/  5000| tot_loss: 3.1329 | rl_loss: 1.5904 | pt_loss: 1.5425 | pg_loss: 0.2748 | reg_loss: 1.3156 | reward: -0.2498 | rev_kl: 0.4115 | stu_lens: 38.5000 | mixed_lens: 84.0000 | lr: 1.6728e-06 | scale: 512.00 | time: 26.941 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   3083/  5000| tot_loss: 3.3732 | rl_loss: 1.8157 | pt_loss: 1.5575 | pg_loss: 0.2415 | reg_loss: 1.5741 | reward: -0.4567 | rev_kl: 1.4316 | stu_lens: 115.0000 | mixed_lens: 91.0000 | lr: 1.6713e-06 | scale: 512.00 | time: 26.972 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   3084/  5000| tot_loss: 2.9297 | rl_loss: 1.4715 | pt_loss: 1.4582 | pg_loss: 0.0881 | reg_loss: 1.3834 | reward: -0.4265 | rev_kl: 2.2413 | stu_lens: 69.5000 | mixed_lens: 124.5000 | lr: 1.6698e-06 | scale: 512.00 | time: 26.956 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   3085/  5000| tot_loss: 3.1819 | rl_loss: 1.3213 | pt_loss: 1.8606 | pg_loss: 0.3240 | reg_loss: 0.9973 | reward: -0.1134 | rev_kl: 0.8282 | stu_lens: 64.5000 | mixed_lens: 69.0000 | lr: 1.6683e-06 | scale: 512.00 | time: 26.990 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   3086/  5000| tot_loss: 3.5756 | rl_loss: 2.2126 | pt_loss: 1.3631 | pg_loss: 0.3289 | reg_loss: 1.8836 | reward: -0.2889 | rev_kl: 1.3098 | stu_lens: 61.0000 | mixed_lens: 101.0000 | lr: 1.6667e-06 | scale: 512.00 | time: 26.979 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   3087/  5000| tot_loss: 3.5365 | rl_loss: 1.6951 | pt_loss: 1.8415 | pg_loss: 0.5017 | reg_loss: 1.1933 | reward: -0.0796 | rev_kl: 4.7285 | stu_lens: 48.5000 | mixed_lens: 71.5000 | lr: 1.6652e-06 | scale: 512.00 | time: 27.007 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3088/  5000| tot_loss: 3.5877 | rl_loss: 1.9883 | pt_loss: 1.5994 | pg_loss: 0.5137 | reg_loss: 1.4746 | reward: -0.3668 | rev_kl: 1.5040 | stu_lens: 69.0000 | mixed_lens: 85.0000 | lr: 1.6637e-06 | scale: 512.00 | time: 27.024 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3088/  5000| tot_loss: 3.1670 | rl_loss: 1.5584 | pt_loss: 1.6086 | pg_loss: 0.3687 | reg_loss: 1.1897 | reward: -0.4726 | rev_kl: 1.2486 | stu_lens: 82.7812 | mixed_lens: 84.2500 | lr: 1.6637e-06 | scale: 512.00 | time: 27.024 | step time: 28.188
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   3089/  5000| tot_loss: 2.6110 | rl_loss: 0.9192 | pt_loss: 1.6918 | pg_loss: 0.0670 | reg_loss: 0.8522 | reward: -0.2483 | rev_kl: 0.5437 | stu_lens: 83.0000 | mixed_lens: 77.5000 | lr: 1.6622e-06 | scale: 512.00 | time: 27.051 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   3090/  5000| tot_loss: 2.6040 | rl_loss: 1.1145 | pt_loss: 1.4895 | pg_loss: 0.0504 | reg_loss: 1.0641 | reward: -0.1239 | rev_kl: 1.0821 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.6607e-06 | scale: 512.00 | time: 26.952 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   3091/  5000| tot_loss: 3.1614 | rl_loss: 1.4842 | pt_loss: 1.6771 | pg_loss: 0.5100 | reg_loss: 0.9743 | reward: -0.2326 | rev_kl: 0.6131 | stu_lens: 35.5000 | mixed_lens: 66.5000 | lr: 1.6592e-06 | scale: 512.00 | time: 26.984 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   3092/  5000| tot_loss: 3.1153 | rl_loss: 1.2549 | pt_loss: 1.8605 | pg_loss: 0.5202 | reg_loss: 0.7346 | reward: -0.4865 | rev_kl: 1.1131 | stu_lens: 89.5000 | mixed_lens: 62.5000 | lr: 1.6577e-06 | scale: 512.00 | time: 26.966 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   3093/  5000| tot_loss: 3.8195 | rl_loss: 1.9237 | pt_loss: 1.8958 | pg_loss: 0.5373 | reg_loss: 1.3864 | reward: -1.0900 | rev_kl: 1.3052 | stu_lens: 89.0000 | mixed_lens: 82.5000 | lr: 1.6562e-06 | scale: 512.00 | time: 26.965 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   3094/  5000| tot_loss: 3.4274 | rl_loss: 1.7810 | pt_loss: 1.6464 | pg_loss: 1.0775 | reg_loss: 0.7035 | reward: -0.3132 | rev_kl: 0.4726 | stu_lens: 71.5000 | mixed_lens: 39.5000 | lr: 1.6547e-06 | scale: 512.00 | time: 26.941 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   3095/  5000| tot_loss: 2.8067 | rl_loss: 1.5517 | pt_loss: 1.2551 | pg_loss: 0.3428 | reg_loss: 1.2088 | reward: -0.3216 | rev_kl: 1.2241 | stu_lens: 92.5000 | mixed_lens: 93.5000 | lr: 1.6532e-06 | scale: 512.00 | time: 26.963 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   3096/  5000| tot_loss: 1.9433 | rl_loss: 0.9676 | pt_loss: 0.9757 | pg_loss: 0.1101 | reg_loss: 0.8575 | reward: -0.0959 | rev_kl: 1.1471 | stu_lens: 78.5000 | mixed_lens: 100.0000 | lr: 1.6516e-06 | scale: 512.00 | time: 26.952 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   3097/  5000| tot_loss: 2.8521 | rl_loss: 0.9627 | pt_loss: 1.8894 | pg_loss: 0.0604 | reg_loss: 0.9023 | reward: -0.3565 | rev_kl: 0.8451 | stu_lens: 118.5000 | mixed_lens: 127.5000 | lr: 1.6501e-06 | scale: 512.00 | time: 26.981 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   3098/  5000| tot_loss: 2.7136 | rl_loss: 0.9624 | pt_loss: 1.7512 | pg_loss: 0.2879 | reg_loss: 0.6746 | reward: -0.3095 | rev_kl: 1.1440 | stu_lens: 95.0000 | mixed_lens: 80.0000 | lr: 1.6486e-06 | scale: 512.00 | time: 26.966 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   3099/  5000| tot_loss: 2.1060 | rl_loss: 0.7245 | pt_loss: 1.3816 | pg_loss: 0.0838 | reg_loss: 0.6406 | reward: -0.2946 | rev_kl: 1.0121 | stu_lens: 128.0000 | mixed_lens: 103.5000 | lr: 1.6471e-06 | scale: 512.00 | time: 27.043 | step time: 0.000
                                 Evaluation #31                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Yes, Bob should leave Alice. The     │
│                                       │ chance of survival for Alice without │
│                                       │ Bob is 31%. If Bob leaves Alice, his │
│                                       │ chance of survival is 9%.            │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ The kezboard type is determined by   │
│                                       │ the user, not the computer. So, if   │
│                                       │ the user types "y" the kezboard type │
│                                       │ is "y", if the user types "z" the    │
│                                       │ kezboard type is "z".                │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support 100+ languages            │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.651 | exact_match: 0.215 | rev_kl: 1.050 | lens: 81.453 | pt_loss: 1.073 | lm_loss: 1.153 | kd_loss: 0.992 
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   3100/  5000| tot_loss: 3.0081 | rl_loss: 1.4694 | pt_loss: 1.5387 | pg_loss: 0.7432 | reg_loss: 0.7263 | reward: -0.6226 | rev_kl: 0.4725 | stu_lens: 53.5000 | mixed_lens: 48.0000 | lr: 1.6456e-06 | scale: 512.00 | time: 26.989 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   3101/  5000| tot_loss: 2.6061 | rl_loss: 1.2966 | pt_loss: 1.3096 | pg_loss: 0.2354 | reg_loss: 1.0612 | reward: -0.4272 | rev_kl: 0.9744 | stu_lens: 92.5000 | mixed_lens: 87.0000 | lr: 1.6441e-06 | scale: 512.00 | time: 27.010 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   3102/  5000| tot_loss: 2.6945 | rl_loss: 1.1233 | pt_loss: 1.5712 | pg_loss: 0.4752 | reg_loss: 0.6482 | reward: -0.3665 | rev_kl: 0.4243 | stu_lens: 128.0000 | mixed_lens: 68.0000 | lr: 1.6426e-06 | scale: 512.00 | time: 27.001 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   3103/  5000| tot_loss: 4.2749 | rl_loss: 2.1913 | pt_loss: 2.0836 | pg_loss: 1.3346 | reg_loss: 0.8566 | reward: -0.7470 | rev_kl: 4.6720 | stu_lens: 37.5000 | mixed_lens: 27.5000 | lr: 1.6411e-06 | scale: 512.00 | time: 27.009 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3104/  5000| tot_loss: 3.1227 | rl_loss: 1.3004 | pt_loss: 1.8223 | pg_loss: 0.0526 | reg_loss: 1.2478 | reward: -0.3319 | rev_kl: 1.4843 | stu_lens: 94.0000 | mixed_lens: 123.5000 | lr: 1.6396e-06 | scale: 512.00 | time: 27.017 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3104/  5000| tot_loss: 2.8748 | rl_loss: 1.2332 | pt_loss: 1.6415 | pg_loss: 0.3347 | reg_loss: 0.8985 | reward: -0.4707 | rev_kl: 1.2423 | stu_lens: 84.1406 | mixed_lens: 83.0625 | lr: 1.6396e-06 | scale: 512.00 | time: 27.017 | step time: 28.202
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   3105/  5000| tot_loss: 2.5223 | rl_loss: 0.7316 | pt_loss: 1.7907 | pg_loss: 0.0564 | reg_loss: 0.6752 | reward: -0.2462 | rev_kl: 0.9723 | stu_lens: 110.5000 | mixed_lens: 122.0000 | lr: 1.6381e-06 | scale: 512.00 | time: 27.022 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   3106/  5000| tot_loss: 2.5555 | rl_loss: 1.1078 | pt_loss: 1.4478 | pg_loss: 0.0609 | reg_loss: 1.0469 | reward: -0.3227 | rev_kl: 1.0880 | stu_lens: 94.0000 | mixed_lens: 123.5000 | lr: 1.6366e-06 | scale: 512.00 | time: 26.970 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   3107/  5000| tot_loss: 1.9449 | rl_loss: 0.5283 | pt_loss: 1.4166 | pg_loss: 0.1312 | reg_loss: 0.3971 | reward: -0.3008 | rev_kl: 0.7558 | stu_lens: 87.0000 | mixed_lens: 84.0000 | lr: 1.6351e-06 | scale: 512.00 | time: 26.954 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   3108/  5000| tot_loss: 2.5593 | rl_loss: 0.9615 | pt_loss: 1.5978 | pg_loss: 0.3617 | reg_loss: 0.5998 | reward: -0.3230 | rev_kl: 3.9462 | stu_lens: 61.5000 | mixed_lens: 77.5000 | lr: 1.6336e-06 | scale: 512.00 | time: 26.976 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   3109/  5000| tot_loss: 2.8067 | rl_loss: 0.9314 | pt_loss: 1.8753 | pg_loss: 0.2882 | reg_loss: 0.6432 | reward: -0.3501 | rev_kl: 2.1027 | stu_lens: 34.0000 | mixed_lens: 90.0000 | lr: 1.6321e-06 | scale: 512.00 | time: 26.965 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   3110/  5000| tot_loss: 3.1638 | rl_loss: 1.6007 | pt_loss: 1.5630 | pg_loss: 1.0033 | reg_loss: 0.5974 | reward: -0.3464 | rev_kl: 4.4720 | stu_lens: 29.5000 | mixed_lens: 46.0000 | lr: 1.6306e-06 | scale: 512.00 | time: 26.970 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   3111/  5000| tot_loss: 2.0388 | rl_loss: 0.5977 | pt_loss: 1.4411 | pg_loss: 0.0580 | reg_loss: 0.5397 | reward: -0.2538 | rev_kl: 0.6907 | stu_lens: 95.0000 | mixed_lens: 111.5000 | lr: 1.6291e-06 | scale: 512.00 | time: 26.974 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   3112/  5000| tot_loss: 2.4267 | rl_loss: 0.6049 | pt_loss: 1.8218 | pg_loss: -0.0078 | reg_loss: 0.6127 | reward: -0.1614 | rev_kl: 1.3790 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.6276e-06 | scale: 512.00 | time: 26.982 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   3113/  5000| tot_loss: 3.4022 | rl_loss: 2.1463 | pt_loss: 1.2560 | pg_loss: 1.1587 | reg_loss: 0.9875 | reward: -5.0389 | rev_kl: 2.4402 | stu_lens: 29.5000 | mixed_lens: 20.5000 | lr: 1.6261e-06 | scale: 512.00 | time: 27.003 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   3114/  5000| tot_loss: 2.0420 | rl_loss: 0.6839 | pt_loss: 1.3582 | pg_loss: 0.1351 | reg_loss: 0.5488 | reward: -0.3498 | rev_kl: 0.8223 | stu_lens: 128.0000 | mixed_lens: 105.5000 | lr: 1.6246e-06 | scale: 512.00 | time: 26.997 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   3115/  5000| tot_loss: 2.2397 | rl_loss: 0.2362 | pt_loss: 2.0035 | pg_loss: -0.0320 | reg_loss: 0.2682 | reward: -0.2606 | rev_kl: 0.3341 | stu_lens: 66.5000 | mixed_lens: 66.5000 | lr: 1.6231e-06 | scale: 512.00 | time: 26.986 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   3116/  5000| tot_loss: 2.6007 | rl_loss: 0.5737 | pt_loss: 2.0270 | pg_loss: -0.0017 | reg_loss: 0.5754 | reward: -0.4145 | rev_kl: 2.1121 | stu_lens: 103.5000 | mixed_lens: 128.0000 | lr: 1.6216e-06 | scale: 512.00 | time: 27.010 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   3117/  5000| tot_loss: 3.6604 | rl_loss: 1.6988 | pt_loss: 1.9616 | pg_loss: 1.2153 | reg_loss: 0.4834 | reward: -0.3551 | rev_kl: 0.3596 | stu_lens: 84.5000 | mixed_lens: 20.0000 | lr: 1.6201e-06 | scale: 512.00 | time: 27.008 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   3118/  5000| tot_loss: 2.1611 | rl_loss: 1.0448 | pt_loss: 1.1163 | pg_loss: 0.3510 | reg_loss: 0.6938 | reward: -0.4266 | rev_kl: 0.7152 | stu_lens: 53.5000 | mixed_lens: 70.0000 | lr: 1.6186e-06 | scale: 512.00 | time: 27.045 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   3119/  5000| tot_loss: 2.4048 | rl_loss: 0.8467 | pt_loss: 1.5581 | pg_loss: 0.1710 | reg_loss: 0.6757 | reward: -0.1680 | rev_kl: 1.0128 | stu_lens: 128.0000 | mixed_lens: 96.0000 | lr: 1.6171e-06 | scale: 512.00 | time: 26.987 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3120/  5000| tot_loss: 2.5673 | rl_loss: 1.1384 | pt_loss: 1.4290 | pg_loss: 0.3596 | reg_loss: 0.7788 | reward: -1.1718 | rev_kl: 0.8724 | stu_lens: 100.0000 | mixed_lens: 82.0000 | lr: 1.6156e-06 | scale: 512.00 | time: 26.994 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3120/  5000| tot_loss: 2.6387 | rl_loss: 0.9892 | pt_loss: 1.6495 | pg_loss: 0.3300 | reg_loss: 0.6592 | reward: -0.4664 | rev_kl: 1.2254 | stu_lens: 83.3594 | mixed_lens: 84.2969 | lr: 1.6156e-06 | scale: 512.00 | time: 26.994 | step time: 28.204
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   3121/  5000| tot_loss: 2.8262 | rl_loss: 1.2989 | pt_loss: 1.5273 | pg_loss: 0.9295 | reg_loss: 0.3694 | reward: -0.4532 | rev_kl: 0.7135 | stu_lens: 33.0000 | mixed_lens: 28.5000 | lr: 1.6141e-06 | scale: 512.00 | time: 27.008 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   3122/  5000| tot_loss: 4.6153 | rl_loss: 2.5705 | pt_loss: 2.0448 | pg_loss: 1.5107 | reg_loss: 1.0598 | reward: -5.4759 | rev_kl: 2.3204 | stu_lens: 46.5000 | mixed_lens: 19.5000 | lr: 1.6126e-06 | scale: 512.00 | time: 26.983 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   3123/  5000| tot_loss: 2.7960 | rl_loss: 0.9525 | pt_loss: 1.8436 | pg_loss: 0.5608 | reg_loss: 0.3916 | reward: -0.4117 | rev_kl: 1.0253 | stu_lens: 109.5000 | mixed_lens: 52.5000 | lr: 1.6111e-06 | scale: 512.00 | time: 26.958 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   3124/  5000| tot_loss: 2.8931 | rl_loss: 1.1330 | pt_loss: 1.7601 | pg_loss: 0.5475 | reg_loss: 0.5855 | reward: -0.3855 | rev_kl: 0.7316 | stu_lens: 54.0000 | mixed_lens: 65.5000 | lr: 1.6096e-06 | scale: 512.00 | time: 26.982 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   3125/  5000| tot_loss: 1.9243 | rl_loss: 0.6275 | pt_loss: 1.2968 | pg_loss: -0.0043 | reg_loss: 0.6318 | reward: -0.1380 | rev_kl: 1.2912 | stu_lens: 97.0000 | mixed_lens: 128.0000 | lr: 1.6081e-06 | scale: 512.00 | time: 26.959 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   3126/  5000| tot_loss: 2.2681 | rl_loss: 0.6493 | pt_loss: 1.6188 | pg_loss: 0.1060 | reg_loss: 0.5433 | reward: -0.1964 | rev_kl: 1.0928 | stu_lens: 107.0000 | mixed_lens: 107.0000 | lr: 1.6066e-06 | scale: 512.00 | time: 26.991 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   3127/  5000| tot_loss: 2.3827 | rl_loss: 0.5634 | pt_loss: 1.8193 | pg_loss: -0.0064 | reg_loss: 0.5697 | reward: -0.2732 | rev_kl: 1.2269 | stu_lens: 103.5000 | mixed_lens: 128.0000 | lr: 1.6051e-06 | scale: 512.00 | time: 26.977 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   3128/  5000| tot_loss: 2.9256 | rl_loss: 1.2514 | pt_loss: 1.6742 | pg_loss: 0.6404 | reg_loss: 0.6109 | reward: -0.6688 | rev_kl: 0.7493 | stu_lens: 91.0000 | mixed_lens: 58.0000 | lr: 1.6036e-06 | scale: 512.00 | time: 27.011 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   3129/  5000| tot_loss: 2.4531 | rl_loss: 1.0445 | pt_loss: 1.4086 | pg_loss: 0.3488 | reg_loss: 0.6957 | reward: -0.5486 | rev_kl: 0.9682 | stu_lens: 92.5000 | mixed_lens: 87.0000 | lr: 1.6021e-06 | scale: 512.00 | time: 26.996 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   3130/  5000| tot_loss: 3.2697 | rl_loss: 1.0269 | pt_loss: 2.2428 | pg_loss: 0.4281 | reg_loss: 0.5987 | reward: -0.2115 | rev_kl: 0.7174 | stu_lens: 77.5000 | mixed_lens: 73.0000 | lr: 1.6006e-06 | scale: 512.00 | time: 27.026 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   3131/  5000| tot_loss: 2.9684 | rl_loss: 1.0991 | pt_loss: 1.8692 | pg_loss: 0.6470 | reg_loss: 0.4521 | reward: -0.4219 | rev_kl: 0.3742 | stu_lens: 128.0000 | mixed_lens: 68.0000 | lr: 1.5991e-06 | scale: 512.00 | time: 27.066 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   3132/  5000| tot_loss: 3.0796 | rl_loss: 0.9020 | pt_loss: 2.1777 | pg_loss: 0.7231 | reg_loss: 0.1788 | reward: -0.2650 | rev_kl: 0.6279 | stu_lens: 39.5000 | mixed_lens: 29.5000 | lr: 1.5976e-06 | scale: 512.00 | time: 27.007 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   3133/  5000| tot_loss: 3.0454 | rl_loss: 1.4937 | pt_loss: 1.5517 | pg_loss: 0.8292 | reg_loss: 0.6645 | reward: -0.3047 | rev_kl: 0.6460 | stu_lens: 66.5000 | mixed_lens: 40.5000 | lr: 1.5961e-06 | scale: 512.00 | time: 26.971 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   3134/  5000| tot_loss: 2.6255 | rl_loss: 1.0939 | pt_loss: 1.5316 | pg_loss: 0.4126 | reg_loss: 0.6813 | reward: -0.3781 | rev_kl: 0.8760 | stu_lens: 51.5000 | mixed_lens: 90.0000 | lr: 1.5946e-06 | scale: 512.00 | time: 27.001 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   3135/  5000| tot_loss: 2.4954 | rl_loss: 0.9807 | pt_loss: 1.5147 | pg_loss: 0.5567 | reg_loss: 0.4240 | reward: -0.4880 | rev_kl: 1.3165 | stu_lens: 76.5000 | mixed_lens: 48.0000 | lr: 1.5931e-06 | scale: 512.00 | time: 26.981 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3136/  5000| tot_loss: 2.4227 | rl_loss: 0.9415 | pt_loss: 1.4812 | pg_loss: 0.4835 | reg_loss: 0.4580 | reward: -0.2746 | rev_kl: 4.7660 | stu_lens: 73.0000 | mixed_lens: 72.0000 | lr: 1.5916e-06 | scale: 512.00 | time: 26.983 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3136/  5000| tot_loss: 2.6083 | rl_loss: 0.9144 | pt_loss: 1.6939 | pg_loss: 0.3690 | reg_loss: 0.5454 | reward: -0.4850 | rev_kl: 1.2084 | stu_lens: 81.5625 | mixed_lens: 81.7344 | lr: 1.5916e-06 | scale: 512.00 | time: 26.983 | step time: 28.209
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   3137/  5000| tot_loss: 2.2903 | rl_loss: 0.6566 | pt_loss: 1.6337 | pg_loss: 0.1812 | reg_loss: 0.4754 | reward: -0.2282 | rev_kl: 0.6755 | stu_lens: 124.0000 | mixed_lens: 100.5000 | lr: 1.5901e-06 | scale: 512.00 | time: 26.966 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   3138/  5000| tot_loss: 2.3007 | rl_loss: 0.6717 | pt_loss: 1.6290 | pg_loss: 0.0905 | reg_loss: 0.5812 | reward: -0.2562 | rev_kl: 0.7661 | stu_lens: 103.0000 | mixed_lens: 116.5000 | lr: 1.5886e-06 | scale: 512.00 | time: 27.024 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   3139/  5000| tot_loss: 3.5944 | rl_loss: 1.5322 | pt_loss: 2.0622 | pg_loss: 0.1892 | reg_loss: 1.3430 | reward: -0.1844 | rev_kl: 1.2607 | stu_lens: 100.5000 | mixed_lens: 114.5000 | lr: 1.5871e-06 | scale: 512.00 | time: 27.022 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   3140/  5000| tot_loss: 3.6082 | rl_loss: 1.6524 | pt_loss: 1.9557 | pg_loss: 0.3607 | reg_loss: 1.2918 | reward: -0.3801 | rev_kl: 1.0906 | stu_lens: 41.5000 | mixed_lens: 99.0000 | lr: 1.5857e-06 | scale: 512.00 | time: 27.030 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   3141/  5000| tot_loss: 3.2372 | rl_loss: 1.6789 | pt_loss: 1.5583 | pg_loss: 0.2994 | reg_loss: 1.3795 | reward: -0.3651 | rev_kl: 1.3932 | stu_lens: 109.5000 | mixed_lens: 100.0000 | lr: 1.5842e-06 | scale: 512.00 | time: 27.021 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   3142/  5000| tot_loss: 2.9666 | rl_loss: 1.0600 | pt_loss: 1.9066 | pg_loss: 0.1438 | reg_loss: 0.9162 | reward: -0.3056 | rev_kl: 0.9841 | stu_lens: 128.0000 | mixed_lens: 112.5000 | lr: 1.5827e-06 | scale: 512.00 | time: 26.967 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   3143/  5000| tot_loss: 3.5807 | rl_loss: 1.7519 | pt_loss: 1.8288 | pg_loss: 0.1610 | reg_loss: 1.5909 | reward: -0.2353 | rev_kl: 1.2174 | stu_lens: 85.5000 | mixed_lens: 116.5000 | lr: 1.5812e-06 | scale: 512.00 | time: 27.001 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   3144/  5000| tot_loss: 2.9438 | rl_loss: 1.7735 | pt_loss: 1.1702 | pg_loss: 0.2928 | reg_loss: 1.4807 | reward: -0.7015 | rev_kl: 0.6213 | stu_lens: 107.5000 | mixed_lens: 78.0000 | lr: 1.5797e-06 | scale: 512.00 | time: 26.955 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   3145/  5000| tot_loss: 3.1585 | rl_loss: 0.8480 | pt_loss: 2.3105 | pg_loss: 0.0935 | reg_loss: 0.7545 | reward: -0.1090 | rev_kl: 0.7558 | stu_lens: 98.0000 | mixed_lens: 85.0000 | lr: 1.5782e-06 | scale: 512.00 | time: 26.971 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   3146/  5000| tot_loss: 3.7427 | rl_loss: 1.9886 | pt_loss: 1.7541 | pg_loss: 0.3896 | reg_loss: 1.5990 | reward: -1.3357 | rev_kl: 1.4776 | stu_lens: 64.5000 | mixed_lens: 73.0000 | lr: 1.5767e-06 | scale: 512.00 | time: 26.955 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   3147/  5000| tot_loss: 3.2476 | rl_loss: 1.8563 | pt_loss: 1.3912 | pg_loss: 0.5690 | reg_loss: 1.2874 | reward: -0.8065 | rev_kl: 1.1098 | stu_lens: 47.5000 | mixed_lens: 65.5000 | lr: 1.5752e-06 | scale: 512.00 | time: 26.986 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   3148/  5000| tot_loss: 2.2319 | rl_loss: 0.6298 | pt_loss: 1.6021 | pg_loss: 0.2145 | reg_loss: 0.4153 | reward: -0.1930 | rev_kl: 0.8557 | stu_lens: 90.5000 | mixed_lens: 80.0000 | lr: 1.5737e-06 | scale: 512.00 | time: 26.964 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   3149/  5000| tot_loss: 3.7911 | rl_loss: 1.9771 | pt_loss: 1.8139 | pg_loss: 0.2725 | reg_loss: 1.7047 | reward: -0.5316 | rev_kl: 1.2069 | stu_lens: 95.0000 | mixed_lens: 97.0000 | lr: 1.5722e-06 | scale: 512.00 | time: 26.997 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   3150/  5000| tot_loss: 2.2262 | rl_loss: 0.8792 | pt_loss: 1.3470 | pg_loss: 0.0640 | reg_loss: 0.8152 | reward: -0.0798 | rev_kl: 0.9127 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.5708e-06 | scale: 512.00 | time: 26.982 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   3151/  5000| tot_loss: 4.0589 | rl_loss: 2.1088 | pt_loss: 1.9501 | pg_loss: 1.1426 | reg_loss: 0.9663 | reward: -1.0763 | rev_kl: 1.0714 | stu_lens: 28.0000 | mixed_lens: 37.5000 | lr: 1.5693e-06 | scale: 512.00 | time: 27.047 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3152/  5000| tot_loss: 4.7236 | rl_loss: 3.1656 | pt_loss: 1.5580 | pg_loss: 1.4562 | reg_loss: 1.7094 | reward: -1.2858 | rev_kl: 0.7519 | stu_lens: 15.5000 | mixed_lens: 22.0000 | lr: 1.5678e-06 | scale: 512.00 | time: 27.007 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3152/  5000| tot_loss: 3.1732 | rl_loss: 1.4579 | pt_loss: 1.7153 | pg_loss: 0.3123 | reg_loss: 1.1456 | reward: -0.3776 | rev_kl: 1.0934 | stu_lens: 86.3750 | mixed_lens: 95.1562 | lr: 1.5678e-06 | scale: 512.00 | time: 27.007 | step time: 28.209
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   3153/  5000| tot_loss: 1.8976 | rl_loss: 0.8493 | pt_loss: 1.0483 | pg_loss: 0.0603 | reg_loss: 0.7890 | reward: -0.1251 | rev_kl: 0.5779 | stu_lens: 57.0000 | mixed_lens: 125.5000 | lr: 1.5663e-06 | scale: 512.00 | time: 27.050 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   3154/  5000| tot_loss: 3.1359 | rl_loss: 1.3076 | pt_loss: 1.8283 | pg_loss: 0.0474 | reg_loss: 1.2603 | reward: -0.3231 | rev_kl: 1.3966 | stu_lens: 92.5000 | mixed_lens: 123.0000 | lr: 1.5648e-06 | scale: 512.00 | time: 26.988 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   3155/  5000| tot_loss: 3.5350 | rl_loss: 1.6428 | pt_loss: 1.8922 | pg_loss: 0.5017 | reg_loss: 1.1411 | reward: -0.6064 | rev_kl: 0.7155 | stu_lens: 58.0000 | mixed_lens: 73.0000 | lr: 1.5633e-06 | scale: 512.00 | time: 26.985 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   3156/  5000| tot_loss: 2.2942 | rl_loss: 0.5339 | pt_loss: 1.7603 | pg_loss: 0.0010 | reg_loss: 0.5328 | reward: -0.1182 | rev_kl: 0.7229 | stu_lens: 67.0000 | mixed_lens: 125.5000 | lr: 1.5618e-06 | scale: 512.00 | time: 26.979 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   3157/  5000| tot_loss: 3.0192 | rl_loss: 1.4676 | pt_loss: 1.5516 | pg_loss: 0.4372 | reg_loss: 1.0304 | reward: -0.3164 | rev_kl: 0.9323 | stu_lens: 60.5000 | mixed_lens: 37.0000 | lr: 1.5603e-06 | scale: 512.00 | time: 27.008 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   3158/  5000| tot_loss: 2.3916 | rl_loss: 0.8305 | pt_loss: 1.5611 | pg_loss: 0.0191 | reg_loss: 0.8115 | reward: -0.2480 | rev_kl: 0.8132 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.5589e-06 | scale: 512.00 | time: 26.953 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   3159/  5000| tot_loss: 2.3308 | rl_loss: 0.9277 | pt_loss: 1.4031 | pg_loss: 0.0552 | reg_loss: 0.8726 | reward: -0.1352 | rev_kl: 1.2621 | stu_lens: 40.5000 | mixed_lens: 122.0000 | lr: 1.5574e-06 | scale: 512.00 | time: 26.969 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   3160/  5000| tot_loss: 2.7021 | rl_loss: 1.0735 | pt_loss: 1.6286 | pg_loss: 0.0373 | reg_loss: 1.0362 | reward: -0.2369 | rev_kl: 1.4085 | stu_lens: 108.5000 | mixed_lens: 126.5000 | lr: 1.5559e-06 | scale: 512.00 | time: 26.957 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   3161/  5000| tot_loss: 2.4833 | rl_loss: 0.8333 | pt_loss: 1.6501 | pg_loss: 0.0495 | reg_loss: 0.7838 | reward: -0.2478 | rev_kl: 1.2242 | stu_lens: 48.5000 | mixed_lens: 123.5000 | lr: 1.5544e-06 | scale: 512.00 | time: 27.010 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   3162/  5000| tot_loss: 2.3677 | rl_loss: 1.2312 | pt_loss: 1.1365 | pg_loss: 0.3467 | reg_loss: 0.8845 | reward: -0.8017 | rev_kl: 1.0831 | stu_lens: 47.5000 | mixed_lens: 57.0000 | lr: 1.5529e-06 | scale: 512.00 | time: 27.011 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   3163/  5000| tot_loss: 3.5340 | rl_loss: 1.9470 | pt_loss: 1.5870 | pg_loss: 1.0235 | reg_loss: 0.9235 | reward: -0.7623 | rev_kl: 1.0997 | stu_lens: 78.5000 | mixed_lens: 41.0000 | lr: 1.5514e-06 | scale: 512.00 | time: 27.012 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   3164/  5000| tot_loss: 2.9760 | rl_loss: 1.1208 | pt_loss: 1.8551 | pg_loss: 0.2677 | reg_loss: 0.8531 | reward: -0.4557 | rev_kl: 0.9585 | stu_lens: 89.0000 | mixed_lens: 63.0000 | lr: 1.5500e-06 | scale: 512.00 | time: 26.998 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   3165/  5000| tot_loss: 2.9068 | rl_loss: 1.0318 | pt_loss: 1.8750 | pg_loss: 0.3839 | reg_loss: 0.6479 | reward: -0.3071 | rev_kl: 1.1035 | stu_lens: 65.5000 | mixed_lens: 83.5000 | lr: 1.5485e-06 | scale: 512.00 | time: 27.026 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   3166/  5000| tot_loss: 2.8375 | rl_loss: 1.2837 | pt_loss: 1.5537 | pg_loss: 0.0632 | reg_loss: 1.2205 | reward: -0.3553 | rev_kl: 1.3139 | stu_lens: 109.5000 | mixed_lens: 122.0000 | lr: 1.5470e-06 | scale: 512.00 | time: 27.020 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   3167/  5000| tot_loss: 2.7128 | rl_loss: 1.3703 | pt_loss: 1.3426 | pg_loss: 0.2785 | reg_loss: 1.0918 | reward: -0.9262 | rev_kl: 1.3588 | stu_lens: 74.0000 | mixed_lens: 74.0000 | lr: 1.5455e-06 | scale: 512.00 | time: 27.008 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3168/  5000| tot_loss: 3.4392 | rl_loss: 1.6944 | pt_loss: 1.7448 | pg_loss: 0.3701 | reg_loss: 1.3243 | reward: -0.5739 | rev_kl: 1.0211 | stu_lens: 77.0000 | mixed_lens: 77.0000 | lr: 1.5440e-06 | scale: 512.00 | time: 26.986 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3168/  5000| tot_loss: 2.8083 | rl_loss: 1.1030 | pt_loss: 1.7052 | pg_loss: 0.2557 | reg_loss: 0.8474 | reward: -0.3659 | rev_kl: 1.0459 | stu_lens: 83.3281 | mixed_lens: 96.3125 | lr: 1.5440e-06 | scale: 512.00 | time: 26.986 | step time: 28.212
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   3169/  5000| tot_loss: 1.9062 | rl_loss: 1.0690 | pt_loss: 0.8372 | pg_loss: 0.0458 | reg_loss: 1.0232 | reward: -0.3841 | rev_kl: 1.1616 | stu_lens: 113.0000 | mixed_lens: 128.0000 | lr: 1.5426e-06 | scale: 512.00 | time: 26.996 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   3170/  5000| tot_loss: 2.4518 | rl_loss: 0.7556 | pt_loss: 1.6962 | pg_loss: 0.2762 | reg_loss: 0.4794 | reward: -0.6405 | rev_kl: 1.0779 | stu_lens: 50.5000 | mixed_lens: 71.0000 | lr: 1.5411e-06 | scale: 512.00 | time: 26.975 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   3171/  5000| tot_loss: 2.4235 | rl_loss: 0.6649 | pt_loss: 1.7586 | pg_loss: 0.2988 | reg_loss: 0.3661 | reward: -0.6413 | rev_kl: 1.1702 | stu_lens: 95.5000 | mixed_lens: 78.5000 | lr: 1.5396e-06 | scale: 512.00 | time: 26.983 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   3172/  5000| tot_loss: 3.2276 | rl_loss: 1.3729 | pt_loss: 1.8546 | pg_loss: 0.3978 | reg_loss: 0.9751 | reward: -1.2818 | rev_kl: 1.5760 | stu_lens: 59.0000 | mixed_lens: 73.0000 | lr: 1.5381e-06 | scale: 512.00 | time: 26.961 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   3173/  5000| tot_loss: 1.9946 | rl_loss: 0.3571 | pt_loss: 1.6375 | pg_loss: 0.1281 | reg_loss: 0.2290 | reward: -0.3400 | rev_kl: 0.8013 | stu_lens: 57.0000 | mixed_lens: 91.5000 | lr: 1.5366e-06 | scale: 512.00 | time: 26.988 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   3174/  5000| tot_loss: 2.0962 | rl_loss: 0.4337 | pt_loss: 1.6626 | pg_loss: -0.0157 | reg_loss: 0.4494 | reward: -0.2289 | rev_kl: 0.7891 | stu_lens: 120.0000 | mixed_lens: 128.0000 | lr: 1.5352e-06 | scale: 512.00 | time: 26.975 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   3175/  5000| tot_loss: 2.4563 | rl_loss: 0.6416 | pt_loss: 1.8148 | pg_loss: 0.1406 | reg_loss: 0.5010 | reward: -0.2612 | rev_kl: 0.8454 | stu_lens: 109.5000 | mixed_lens: 106.5000 | lr: 1.5337e-06 | scale: 512.00 | time: 27.032 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   3176/  5000| tot_loss: 2.8960 | rl_loss: 1.2572 | pt_loss: 1.6388 | pg_loss: 0.4377 | reg_loss: 0.8195 | reward: -0.7550 | rev_kl: 0.7676 | stu_lens: 67.0000 | mixed_lens: 67.0000 | lr: 1.5322e-06 | scale: 512.00 | time: 26.988 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   3177/  5000| tot_loss: 3.8381 | rl_loss: 2.0891 | pt_loss: 1.7490 | pg_loss: 0.8506 | reg_loss: 1.2385 | reward: -1.0082 | rev_kl: 0.8485 | stu_lens: 35.5000 | mixed_lens: 48.5000 | lr: 1.5307e-06 | scale: 512.00 | time: 27.010 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   3178/  5000| tot_loss: 2.4563 | rl_loss: 1.0831 | pt_loss: 1.3731 | pg_loss: 0.4220 | reg_loss: 0.6612 | reward: -0.2897 | rev_kl: 0.8999 | stu_lens: 98.0000 | mixed_lens: 82.0000 | lr: 1.5292e-06 | scale: 512.00 | time: 27.012 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   3179/  5000| tot_loss: 2.4768 | rl_loss: 0.8293 | pt_loss: 1.6475 | pg_loss: 0.0386 | reg_loss: 0.7907 | reward: -0.2328 | rev_kl: 1.1432 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.5278e-06 | scale: 512.00 | time: 27.044 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   3180/  5000| tot_loss: 1.8918 | rl_loss: 0.4181 | pt_loss: 1.4736 | pg_loss: 0.1571 | reg_loss: 0.2610 | reward: -0.0870 | rev_kl: 0.5730 | stu_lens: 26.0000 | mixed_lens: 86.5000 | lr: 1.5263e-06 | scale: 512.00 | time: 27.023 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   3181/  5000| tot_loss: 2.5006 | rl_loss: 0.7980 | pt_loss: 1.7026 | pg_loss: 0.0082 | reg_loss: 0.7898 | reward: -0.3424 | rev_kl: 1.3678 | stu_lens: 117.5000 | mixed_lens: 128.0000 | lr: 1.5248e-06 | scale: 512.00 | time: 26.997 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   3182/  5000| tot_loss: 2.6634 | rl_loss: 0.5396 | pt_loss: 2.1238 | pg_loss: 0.0116 | reg_loss: 0.5280 | reward: -0.2431 | rev_kl: 0.7278 | stu_lens: 124.5000 | mixed_lens: 128.0000 | lr: 1.5233e-06 | scale: 512.00 | time: 26.995 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   3183/  5000| tot_loss: 2.4779 | rl_loss: 0.4995 | pt_loss: 1.9784 | pg_loss: 0.0361 | reg_loss: 0.4634 | reward: -0.0919 | rev_kl: 0.9756 | stu_lens: 128.0000 | mixed_lens: 118.5000 | lr: 1.5219e-06 | scale: 512.00 | time: 27.033 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3184/  5000| tot_loss: 2.8680 | rl_loss: 0.9823 | pt_loss: 1.8856 | pg_loss: 0.4161 | reg_loss: 0.5662 | reward: -0.2445 | rev_kl: 1.2166 | stu_lens: 48.5000 | mixed_lens: 80.0000 | lr: 1.5204e-06 | scale: 512.00 | time: 26.972 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3184/  5000| tot_loss: 2.4674 | rl_loss: 0.8264 | pt_loss: 1.6410 | pg_loss: 0.1902 | reg_loss: 0.6362 | reward: -0.3749 | rev_kl: 1.0383 | stu_lens: 88.2188 | mixed_lens: 98.1250 | lr: 1.5204e-06 | scale: 512.00 | time: 26.972 | step time: 28.214
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   3185/  5000| tot_loss: 2.3491 | rl_loss: 0.7224 | pt_loss: 1.6268 | pg_loss: 0.2507 | reg_loss: 0.4716 | reward: -0.1473 | rev_kl: 1.3168 | stu_lens: 128.0000 | mixed_lens: 90.5000 | lr: 1.5189e-06 | scale: 512.00 | time: 26.992 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   3186/  5000| tot_loss: 2.0889 | rl_loss: 0.8081 | pt_loss: 1.2808 | pg_loss: 0.2019 | reg_loss: 0.6062 | reward: -0.4834 | rev_kl: 1.4503 | stu_lens: 109.5000 | mixed_lens: 106.5000 | lr: 1.5174e-06 | scale: 512.00 | time: 26.977 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   3187/  5000| tot_loss: 2.2571 | rl_loss: 0.7436 | pt_loss: 1.5135 | pg_loss: 0.0587 | reg_loss: 0.6849 | reward: -0.1855 | rev_kl: 1.0056 | stu_lens: 80.0000 | mixed_lens: 122.0000 | lr: 1.5160e-06 | scale: 512.00 | time: 27.004 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   3188/  5000| tot_loss: 2.1766 | rl_loss: 0.4963 | pt_loss: 1.6804 | pg_loss: 0.1636 | reg_loss: 0.3326 | reward: -0.2817 | rev_kl: 1.0576 | stu_lens: 97.0000 | mixed_lens: 95.0000 | lr: 1.5145e-06 | scale: 512.00 | time: 26.983 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   3189/  5000| tot_loss: 3.3958 | rl_loss: 1.9647 | pt_loss: 1.4311 | pg_loss: 1.4105 | reg_loss: 0.5543 | reward: -1.1738 | rev_kl: 0.6105 | stu_lens: 54.0000 | mixed_lens: 30.5000 | lr: 1.5130e-06 | scale: 512.00 | time: 27.001 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   3190/  5000| tot_loss: 1.5473 | rl_loss: 0.1290 | pt_loss: 1.4183 | pg_loss: 0.0296 | reg_loss: 0.0994 | reward: -0.0716 | rev_kl: 0.6226 | stu_lens: 103.0000 | mixed_lens: 128.0000 | lr: 1.5115e-06 | scale: 512.00 | time: 27.007 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   3191/  5000| tot_loss: 2.6336 | rl_loss: 0.8115 | pt_loss: 1.8221 | pg_loss: 0.1721 | reg_loss: 0.6394 | reward: -0.5513 | rev_kl: 1.1365 | stu_lens: 57.0000 | mixed_lens: 89.0000 | lr: 1.5101e-06 | scale: 512.00 | time: 27.052 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   3192/  5000| tot_loss: 2.6296 | rl_loss: 0.8239 | pt_loss: 1.8058 | pg_loss: 0.4746 | reg_loss: 0.3492 | reward: -0.2539 | rev_kl: 1.0700 | stu_lens: 90.5000 | mixed_lens: 64.5000 | lr: 1.5086e-06 | scale: 512.00 | time: 27.032 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   3193/  5000| tot_loss: 2.3365 | rl_loss: 0.6156 | pt_loss: 1.7209 | pg_loss: 0.0673 | reg_loss: 0.5482 | reward: -0.2879 | rev_kl: 1.1285 | stu_lens: 122.0000 | mixed_lens: 118.5000 | lr: 1.5071e-06 | scale: 512.00 | time: 27.023 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   3194/  5000| tot_loss: 2.4786 | rl_loss: 0.7350 | pt_loss: 1.7435 | pg_loss: 0.4444 | reg_loss: 0.2906 | reward: -0.2784 | rev_kl: 0.9451 | stu_lens: 96.0000 | mixed_lens: 79.5000 | lr: 1.5057e-06 | scale: 512.00 | time: 26.986 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   3195/  5000| tot_loss: 2.2109 | rl_loss: 0.8217 | pt_loss: 1.3893 | pg_loss: 0.4577 | reg_loss: 0.3639 | reward: -0.4598 | rev_kl: 0.6258 | stu_lens: 47.0000 | mixed_lens: 60.0000 | lr: 1.5042e-06 | scale: 512.00 | time: 27.010 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   3196/  5000| tot_loss: 2.7758 | rl_loss: 1.1123 | pt_loss: 1.6635 | pg_loss: 0.4943 | reg_loss: 0.6180 | reward: -0.7296 | rev_kl: 1.0643 | stu_lens: 67.0000 | mixed_lens: 67.0000 | lr: 1.5027e-06 | scale: 512.00 | time: 27.008 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   3197/  5000| tot_loss: 2.5225 | rl_loss: 0.4751 | pt_loss: 2.0474 | pg_loss: 0.1910 | reg_loss: 0.2840 | reward: -0.8351 | rev_kl: 1.2193 | stu_lens: 67.0000 | mixed_lens: 70.5000 | lr: 1.5012e-06 | scale: 512.00 | time: 27.000 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   3198/  5000| tot_loss: 3.0204 | rl_loss: 1.0063 | pt_loss: 2.0141 | pg_loss: 0.5581 | reg_loss: 0.4482 | reward: -0.3329 | rev_kl: 1.0732 | stu_lens: 58.0000 | mixed_lens: 70.0000 | lr: 1.4998e-06 | scale: 512.00 | time: 26.975 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   3199/  5000| tot_loss: 2.5737 | rl_loss: 0.6051 | pt_loss: 1.9686 | pg_loss: 0.0605 | reg_loss: 0.5446 | reward: -0.2234 | rev_kl: 0.9683 | stu_lens: 114.0000 | mixed_lens: 121.5000 | lr: 1.4983e-06 | scale: 512.00 | time: 27.007 | step time: 0.000
                                 Evaluation #32                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Yes, Bob should leave Alice. His     │
│                                       │ chances of survival increase by 9%.  │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ mz kezboard tzpe z instead of y and  │
│                                       │ vice versa is because of the         │
│                                       │ location of the keys on the          │
│                                       │ keyboard. The keys are arranged in a │
│                                       │ QWERTY layout, which is the most     │
│                                       │ common keyboard layout. The keys are │
│                                       │ arranged in a specific order so that │
│                                       │ the most commonly used letters are   │
│                                       │ conveniently placed on the home row. │
│                                       │ The home row is the row of keys      │
│                                       │ directly in front of you when you    │
│                                       │ are sitting in front of a keyboard.  │
│                                       │ The keyboard has a total of 94 keys, │
│                                       │ 52 of which are on the home row. The │
│                                       │ 52 keys on the home row are as       │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support 50+ languages.            │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.929 | exact_match: 0.215 | rev_kl: 1.172 | lens: 90.530 | pt_loss: 1.072 | lm_loss: 1.154 | kd_loss: 0.990 
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3200/  5000| tot_loss: 2.6671 | rl_loss: 0.5858 | pt_loss: 2.0814 | pg_loss: 0.0245 | reg_loss: 0.5613 | reward: -0.3847 | rev_kl: 1.0516 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4968e-06 | scale: 512.00 | time: 26.972 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3200/  5000| tot_loss: 2.3628 | rl_loss: 0.7284 | pt_loss: 1.6344 | pg_loss: 0.2449 | reg_loss: 0.4834 | reward: -0.3703 | rev_kl: 1.0648 | stu_lens: 83.8281 | mixed_lens: 94.6562 | lr: 1.4968e-06 | scale: 512.00 | time: 26.972 | step time: 28.216
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   3201/  5000| tot_loss: 2.1641 | rl_loss: 0.4321 | pt_loss: 1.7320 | pg_loss: -0.0085 | reg_loss: 0.4406 | reward: -0.1561 | rev_kl: 1.0549 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4954e-06 | scale: 512.00 | time: 26.893 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   3202/  5000| tot_loss: 4.1192 | rl_loss: 2.1831 | pt_loss: 1.9361 | pg_loss: 0.8526 | reg_loss: 1.3305 | reward: -0.7665 | rev_kl: 0.8717 | stu_lens: 24.0000 | mixed_lens: 25.5000 | lr: 1.4939e-06 | scale: 512.00 | time: 26.890 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   3203/  5000| tot_loss: 2.8508 | rl_loss: 1.5679 | pt_loss: 1.2829 | pg_loss: 0.2373 | reg_loss: 1.3306 | reward: -0.2940 | rev_kl: 0.7824 | stu_lens: 103.0000 | mixed_lens: 104.5000 | lr: 1.4924e-06 | scale: 512.00 | time: 26.893 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   3204/  5000| tot_loss: 3.9106 | rl_loss: 2.0348 | pt_loss: 1.8758 | pg_loss: 0.4084 | reg_loss: 1.6264 | reward: -0.2415 | rev_kl: 1.1249 | stu_lens: 128.0000 | mixed_lens: 88.5000 | lr: 1.4910e-06 | scale: 512.00 | time: 26.881 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   3205/  5000| tot_loss: 3.1464 | rl_loss: 1.3991 | pt_loss: 1.7473 | pg_loss: 0.0956 | reg_loss: 1.3035 | reward: -0.2218 | rev_kl: 1.0343 | stu_lens: 110.5000 | mixed_lens: 120.0000 | lr: 1.4895e-06 | scale: 512.00 | time: 26.867 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   3206/  5000| tot_loss: 3.3193 | rl_loss: 1.7307 | pt_loss: 1.5886 | pg_loss: 0.3983 | reg_loss: 1.3323 | reward: -0.0037 | rev_kl: 0.8012 | stu_lens: 71.5000 | mixed_lens: 71.5000 | lr: 1.4880e-06 | scale: 512.00 | time: 26.892 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   3207/  5000| tot_loss: 3.3426 | rl_loss: 1.6453 | pt_loss: 1.6973 | pg_loss: 0.2342 | reg_loss: 1.4111 | reward: -0.2112 | rev_kl: 1.2687 | stu_lens: 86.0000 | mixed_lens: 101.0000 | lr: 1.4866e-06 | scale: 512.00 | time: 26.880 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   3208/  5000| tot_loss: 3.3307 | rl_loss: 1.3235 | pt_loss: 2.0072 | pg_loss: 0.2478 | reg_loss: 1.0758 | reward: -0.4691 | rev_kl: 1.0528 | stu_lens: 92.0000 | mixed_lens: 98.0000 | lr: 1.4851e-06 | scale: 512.00 | time: 26.912 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   3209/  5000| tot_loss: 3.2130 | rl_loss: 1.6265 | pt_loss: 1.5865 | pg_loss: 0.0896 | reg_loss: 1.5369 | reward: -0.1553 | rev_kl: 1.0107 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4836e-06 | scale: 512.00 | time: 26.889 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   3210/  5000| tot_loss: 3.5860 | rl_loss: 2.0587 | pt_loss: 1.5274 | pg_loss: 0.7796 | reg_loss: 1.2790 | reward: -0.2054 | rev_kl: 0.8561 | stu_lens: 78.0000 | mixed_lens: 58.0000 | lr: 1.4822e-06 | scale: 512.00 | time: 26.917 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   3211/  5000| tot_loss: 3.6683 | rl_loss: 1.6700 | pt_loss: 1.9984 | pg_loss: 0.3380 | reg_loss: 1.3320 | reward: -0.3297 | rev_kl: 1.2988 | stu_lens: 128.0000 | mixed_lens: 85.0000 | lr: 1.4807e-06 | scale: 512.00 | time: 26.902 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   3212/  5000| tot_loss: 3.5452 | rl_loss: 1.7288 | pt_loss: 1.8164 | pg_loss: 0.3109 | reg_loss: 1.4180 | reward: -0.2593 | rev_kl: 1.9363 | stu_lens: 89.5000 | mixed_lens: 90.5000 | lr: 1.4793e-06 | scale: 512.00 | time: 26.941 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   3213/  5000| tot_loss: 3.6385 | rl_loss: 1.8452 | pt_loss: 1.7933 | pg_loss: 0.8659 | reg_loss: 0.9793 | reward: -0.2427 | rev_kl: 1.2330 | stu_lens: 84.5000 | mixed_lens: 46.5000 | lr: 1.4778e-06 | scale: 512.00 | time: 26.927 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   3214/  5000| tot_loss: 3.4754 | rl_loss: 1.5755 | pt_loss: 1.8998 | pg_loss: 0.2459 | reg_loss: 1.3296 | reward: -0.1447 | rev_kl: 0.9543 | stu_lens: 128.0000 | mixed_lens: 84.0000 | lr: 1.4763e-06 | scale: 512.00 | time: 26.948 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   3215/  5000| tot_loss: 3.1002 | rl_loss: 1.2087 | pt_loss: 1.8915 | pg_loss: 0.1835 | reg_loss: 1.0252 | reward: -0.3411 | rev_kl: 0.7580 | stu_lens: 68.5000 | mixed_lens: 109.5000 | lr: 1.4749e-06 | scale: 512.00 | time: 26.871 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3216/  5000| tot_loss: 3.0254 | rl_loss: 1.1797 | pt_loss: 1.8457 | pg_loss: 0.4290 | reg_loss: 0.7507 | reward: -0.1260 | rev_kl: 0.7772 | stu_lens: 96.0000 | mixed_lens: 77.0000 | lr: 1.4734e-06 | scale: 512.00 | time: 26.890 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3216/  5000| tot_loss: 3.1251 | rl_loss: 1.4074 | pt_loss: 1.7176 | pg_loss: 0.2573 | reg_loss: 1.1501 | reward: -0.2997 | rev_kl: 1.0619 | stu_lens: 95.2344 | mixed_lens: 97.3750 | lr: 1.4734e-06 | scale: 512.00 | time: 26.890 | step time: 28.116
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   3217/  5000| tot_loss: 3.2398 | rl_loss: 1.1964 | pt_loss: 2.0434 | pg_loss: 0.2095 | reg_loss: 0.9869 | reward: -0.1588 | rev_kl: 0.8898 | stu_lens: 120.5000 | mixed_lens: 98.0000 | lr: 1.4719e-06 | scale: 512.00 | time: 26.879 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   3218/  5000| tot_loss: 2.5888 | rl_loss: 0.9740 | pt_loss: 1.6148 | pg_loss: 0.0748 | reg_loss: 0.8992 | reward: -0.3826 | rev_kl: 1.0797 | stu_lens: 79.0000 | mixed_lens: 117.0000 | lr: 1.4705e-06 | scale: 512.00 | time: 26.900 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   3219/  5000| tot_loss: 2.6941 | rl_loss: 0.8350 | pt_loss: 1.8591 | pg_loss: 0.0323 | reg_loss: 0.8026 | reward: -0.2138 | rev_kl: 0.9252 | stu_lens: 115.0000 | mixed_lens: 128.0000 | lr: 1.4690e-06 | scale: 512.00 | time: 26.886 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   3220/  5000| tot_loss: 2.6511 | rl_loss: 0.9870 | pt_loss: 1.6641 | pg_loss: 0.3526 | reg_loss: 0.6343 | reward: -0.3634 | rev_kl: 0.9352 | stu_lens: 95.0000 | mixed_lens: 85.0000 | lr: 1.4676e-06 | scale: 512.00 | time: 26.888 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   3221/  5000| tot_loss: 2.6195 | rl_loss: 0.9250 | pt_loss: 1.6945 | pg_loss: 0.0465 | reg_loss: 0.8785 | reward: -0.5745 | rev_kl: 0.8044 | stu_lens: 75.5000 | mixed_lens: 75.0000 | lr: 1.4661e-06 | scale: 512.00 | time: 26.890 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   3222/  5000| tot_loss: 2.4305 | rl_loss: 1.1887 | pt_loss: 1.2418 | pg_loss: 0.4502 | reg_loss: 0.7385 | reward: -0.3387 | rev_kl: 0.8641 | stu_lens: 37.5000 | mixed_lens: 73.5000 | lr: 1.4646e-06 | scale: 512.00 | time: 26.890 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   3223/  5000| tot_loss: 3.5338 | rl_loss: 1.5314 | pt_loss: 2.0025 | pg_loss: 0.4500 | reg_loss: 1.0814 | reward: -0.8169 | rev_kl: 0.9988 | stu_lens: 69.0000 | mixed_lens: 74.5000 | lr: 1.4632e-06 | scale: 512.00 | time: 26.900 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   3224/  5000| tot_loss: 2.6674 | rl_loss: 1.1209 | pt_loss: 1.5464 | pg_loss: 0.2216 | reg_loss: 0.8994 | reward: -0.0952 | rev_kl: 0.7820 | stu_lens: 96.0000 | mixed_lens: 90.0000 | lr: 1.4617e-06 | scale: 512.00 | time: 26.893 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   3225/  5000| tot_loss: 3.0251 | rl_loss: 1.2550 | pt_loss: 1.7701 | pg_loss: 0.2302 | reg_loss: 1.0248 | reward: -0.1646 | rev_kl: 1.0663 | stu_lens: 74.5000 | mixed_lens: 101.0000 | lr: 1.4603e-06 | scale: 512.00 | time: 26.874 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   3226/  5000| tot_loss: 2.2244 | rl_loss: 0.7303 | pt_loss: 1.4941 | pg_loss: 0.1456 | reg_loss: 0.5846 | reward: 0.0464 | rev_kl: 0.5528 | stu_lens: 128.0000 | mixed_lens: 84.0000 | lr: 1.4588e-06 | scale: 512.00 | time: 26.904 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   3227/  5000| tot_loss: 2.5728 | rl_loss: 1.0076 | pt_loss: 1.5652 | pg_loss: 0.2780 | reg_loss: 0.7296 | reward: -0.3009 | rev_kl: 1.1083 | stu_lens: 30.0000 | mixed_lens: 77.5000 | lr: 1.4574e-06 | scale: 512.00 | time: 26.889 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   3228/  5000| tot_loss: 2.6839 | rl_loss: 0.9480 | pt_loss: 1.7358 | pg_loss: 0.0999 | reg_loss: 0.8481 | reward: -0.2006 | rev_kl: 1.1258 | stu_lens: 111.0000 | mixed_lens: 88.5000 | lr: 1.4559e-06 | scale: 512.00 | time: 26.915 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   3229/  5000| tot_loss: 2.9246 | rl_loss: 1.4081 | pt_loss: 1.5165 | pg_loss: 0.3461 | reg_loss: 1.0621 | reward: -0.0465 | rev_kl: 0.8504 | stu_lens: 71.5000 | mixed_lens: 71.5000 | lr: 1.4544e-06 | scale: 512.00 | time: 26.901 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   3230/  5000| tot_loss: 2.6653 | rl_loss: 1.4515 | pt_loss: 1.2138 | pg_loss: 0.7884 | reg_loss: 0.6631 | reward: -0.1211 | rev_kl: 1.0791 | stu_lens: 78.0000 | mixed_lens: 38.0000 | lr: 1.4530e-06 | scale: 512.00 | time: 26.927 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   3231/  5000| tot_loss: 3.2909 | rl_loss: 1.2798 | pt_loss: 2.0111 | pg_loss: 0.3132 | reg_loss: 0.9666 | reward: -0.3297 | rev_kl: 1.2988 | stu_lens: 128.0000 | mixed_lens: 85.0000 | lr: 1.4515e-06 | scale: 512.00 | time: 26.911 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3232/  5000| tot_loss: 2.1763 | rl_loss: 0.9074 | pt_loss: 1.2689 | pg_loss: -0.0121 | reg_loss: 0.9195 | reward: -0.1494 | rev_kl: 1.0103 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4501e-06 | scale: 512.00 | time: 26.944 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3232/  5000| tot_loss: 2.7127 | rl_loss: 1.1130 | pt_loss: 1.5997 | pg_loss: 0.2399 | reg_loss: 0.8731 | reward: -0.2919 | rev_kl: 1.0289 | stu_lens: 94.9219 | mixed_lens: 95.5000 | lr: 1.4501e-06 | scale: 512.00 | time: 26.944 | step time: 28.114
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   3233/  5000| tot_loss: 2.3349 | rl_loss: 0.7174 | pt_loss: 1.6174 | pg_loss: -0.0080 | reg_loss: 0.7255 | reward: -0.1368 | rev_kl: 0.9698 | stu_lens: 110.5000 | mixed_lens: 128.0000 | lr: 1.4486e-06 | scale: 512.00 | time: 26.928 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   3234/  5000| tot_loss: 2.0761 | rl_loss: 0.3607 | pt_loss: 1.7154 | pg_loss: 0.0992 | reg_loss: 0.2615 | reward: -0.1321 | rev_kl: 0.7702 | stu_lens: 96.0000 | mixed_lens: 50.5000 | lr: 1.4472e-06 | scale: 512.00 | time: 26.962 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   3235/  5000| tot_loss: 2.7710 | rl_loss: 1.1718 | pt_loss: 1.5993 | pg_loss: 0.4094 | reg_loss: 0.7624 | reward: -0.4742 | rev_kl: 0.8856 | stu_lens: 55.0000 | mixed_lens: 77.5000 | lr: 1.4457e-06 | scale: 512.00 | time: 26.904 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   3236/  5000| tot_loss: 2.2057 | rl_loss: 0.9169 | pt_loss: 1.2888 | pg_loss: -0.0131 | reg_loss: 0.9301 | reward: -0.3362 | rev_kl: 0.9069 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4443e-06 | scale: 512.00 | time: 26.961 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   3237/  5000| tot_loss: 2.0895 | rl_loss: 0.7645 | pt_loss: 1.3250 | pg_loss: 0.2000 | reg_loss: 0.5645 | reward: -0.5866 | rev_kl: 0.9246 | stu_lens: 75.5000 | mixed_lens: 75.0000 | lr: 1.4428e-06 | scale: 512.00 | time: 26.892 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   3238/  5000| tot_loss: 2.9849 | rl_loss: 1.3671 | pt_loss: 1.6178 | pg_loss: 0.9662 | reg_loss: 0.4008 | reward: -0.2296 | rev_kl: 0.6270 | stu_lens: 38.5000 | mixed_lens: 41.5000 | lr: 1.4414e-06 | scale: 512.00 | time: 26.890 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   3239/  5000| tot_loss: 2.2689 | rl_loss: 0.8738 | pt_loss: 1.3952 | pg_loss: 0.4199 | reg_loss: 0.4539 | reward: -0.9782 | rev_kl: 2.2508 | stu_lens: 56.0000 | mixed_lens: 70.0000 | lr: 1.4399e-06 | scale: 512.00 | time: 26.869 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   3240/  5000| tot_loss: 2.9608 | rl_loss: 1.2754 | pt_loss: 1.6854 | pg_loss: 0.7234 | reg_loss: 0.5520 | reward: -0.3099 | rev_kl: 1.2019 | stu_lens: 128.0000 | mixed_lens: 45.5000 | lr: 1.4385e-06 | scale: 512.00 | time: 26.892 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   3241/  5000| tot_loss: 3.0361 | rl_loss: 0.9999 | pt_loss: 2.0361 | pg_loss: 0.3362 | reg_loss: 0.6637 | reward: 0.0014 | rev_kl: 1.0332 | stu_lens: 124.5000 | mixed_lens: 84.0000 | lr: 1.4370e-06 | scale: 512.00 | time: 26.870 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   3242/  5000| tot_loss: 2.4156 | rl_loss: 1.1314 | pt_loss: 1.2842 | pg_loss: 0.3891 | reg_loss: 0.7423 | reward: -0.4055 | rev_kl: 1.1032 | stu_lens: 76.5000 | mixed_lens: 78.5000 | lr: 1.4356e-06 | scale: 512.00 | time: 26.899 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   3243/  5000| tot_loss: 1.9962 | rl_loss: 0.6885 | pt_loss: 1.3077 | pg_loss: 0.0576 | reg_loss: 0.6309 | reward: -0.0844 | rev_kl: 1.0048 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4341e-06 | scale: 512.00 | time: 26.874 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   3244/  5000| tot_loss: 2.5464 | rl_loss: 0.8850 | pt_loss: 1.6614 | pg_loss: 0.0424 | reg_loss: 0.8426 | reward: -0.3640 | rev_kl: 1.1215 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4327e-06 | scale: 512.00 | time: 26.905 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   3245/  5000| tot_loss: 2.4171 | rl_loss: 0.8296 | pt_loss: 1.5874 | pg_loss: 0.1777 | reg_loss: 0.6519 | reward: -0.2076 | rev_kl: 1.1628 | stu_lens: 67.5000 | mixed_lens: 101.0000 | lr: 1.4312e-06 | scale: 512.00 | time: 26.887 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   3246/  5000| tot_loss: 2.6294 | rl_loss: 0.5927 | pt_loss: 2.0367 | pg_loss: 0.1977 | reg_loss: 0.3950 | reward: -0.2501 | rev_kl: 0.8371 | stu_lens: 97.5000 | mixed_lens: 87.0000 | lr: 1.4298e-06 | scale: 512.00 | time: 26.947 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   3247/  5000| tot_loss: 2.8050 | rl_loss: 1.0518 | pt_loss: 1.7533 | pg_loss: 0.1996 | reg_loss: 0.8521 | reward: -0.1229 | rev_kl: 1.3689 | stu_lens: 85.5000 | mixed_lens: 92.5000 | lr: 1.4283e-06 | scale: 512.00 | time: 26.904 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3248/  5000| tot_loss: 2.8673 | rl_loss: 1.0265 | pt_loss: 1.8408 | pg_loss: 0.4164 | reg_loss: 0.6101 | reward: -0.2234 | rev_kl: 0.9102 | stu_lens: 60.5000 | mixed_lens: 69.5000 | lr: 1.4269e-06 | scale: 512.00 | time: 26.922 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3248/  5000| tot_loss: 2.5103 | rl_loss: 0.8711 | pt_loss: 1.6391 | pg_loss: 0.2255 | reg_loss: 0.6456 | reward: -0.2973 | rev_kl: 1.0493 | stu_lens: 96.4688 | mixed_lens: 97.0156 | lr: 1.4269e-06 | scale: 512.00 | time: 26.922 | step time: 28.121
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   3249/  5000| tot_loss: 2.8280 | rl_loss: 0.9566 | pt_loss: 1.8714 | pg_loss: 0.0953 | reg_loss: 0.8613 | reward: -0.2983 | rev_kl: 1.0885 | stu_lens: 68.5000 | mixed_lens: 109.5000 | lr: 1.4254e-06 | scale: 512.00 | time: 26.917 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/3250
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   3250/  5000| tot_loss: 2.6750 | rl_loss: 0.9578 | pt_loss: 1.7172 | pg_loss: 0.4265 | reg_loss: 0.5313 | reward: -0.0429 | rev_kl: 0.7446 | stu_lens: 53.0000 | mixed_lens: 71.5000 | lr: 1.4240e-06 | scale: 512.00 | time: 26.956 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   3251/  5000| tot_loss: 3.1148 | rl_loss: 1.0224 | pt_loss: 2.0923 | pg_loss: 0.4912 | reg_loss: 0.5312 | reward: -0.0048 | rev_kl: 0.9165 | stu_lens: 93.0000 | mixed_lens: 75.0000 | lr: 1.4225e-06 | scale: 512.00 | time: 29.972 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   3252/  5000| tot_loss: 2.5308 | rl_loss: 0.7225 | pt_loss: 1.8084 | pg_loss: 0.2810 | reg_loss: 0.4414 | reward: -0.2431 | rev_kl: 0.7351 | stu_lens: 96.0000 | mixed_lens: 90.0000 | lr: 1.4211e-06 | scale: 512.00 | time: 29.911 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   3253/  5000| tot_loss: 2.1302 | rl_loss: 0.6848 | pt_loss: 1.4454 | pg_loss: 0.0152 | reg_loss: 0.6696 | reward: -0.2804 | rev_kl: 1.2108 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4196e-06 | scale: 512.00 | time: 29.889 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   3254/  5000| tot_loss: 2.3024 | rl_loss: 0.9064 | pt_loss: 1.3959 | pg_loss: 0.7067 | reg_loss: 0.1998 | reward: -0.2187 | rev_kl: 0.7910 | stu_lens: 77.0000 | mixed_lens: 31.5000 | lr: 1.4182e-06 | scale: 512.00 | time: 29.938 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   3255/  5000| tot_loss: 2.4527 | rl_loss: 0.5088 | pt_loss: 1.9439 | pg_loss: 0.1211 | reg_loss: 0.3877 | reward: -0.1556 | rev_kl: 1.0130 | stu_lens: 110.5000 | mixed_lens: 88.5000 | lr: 1.4167e-06 | scale: 512.00 | time: 29.969 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   3256/  5000| tot_loss: 1.7462 | rl_loss: 0.5684 | pt_loss: 1.1779 | pg_loss: -0.0073 | reg_loss: 0.5757 | reward: -0.2981 | rev_kl: 1.4026 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4153e-06 | scale: 512.00 | time: 30.034 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   3257/  5000| tot_loss: 2.2211 | rl_loss: 0.5096 | pt_loss: 1.7115 | pg_loss: 0.0126 | reg_loss: 0.4970 | reward: -0.1193 | rev_kl: 0.5876 | stu_lens: 79.0000 | mixed_lens: 128.0000 | lr: 1.4138e-06 | scale: 512.00 | time: 29.968 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   3258/  5000| tot_loss: 1.9999 | rl_loss: 0.6197 | pt_loss: 1.3802 | pg_loss: 0.3162 | reg_loss: 0.3036 | reward: -0.0914 | rev_kl: 1.2238 | stu_lens: 128.0000 | mixed_lens: 75.5000 | lr: 1.4124e-06 | scale: 512.00 | time: 34.752 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   3259/  5000| tot_loss: 2.9307 | rl_loss: 0.7525 | pt_loss: 2.1783 | pg_loss: 0.1883 | reg_loss: 0.5641 | reward: -0.6726 | rev_kl: 0.8592 | stu_lens: 58.5000 | mixed_lens: 75.0000 | lr: 1.4110e-06 | scale: 512.00 | time: 29.902 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   3260/  5000| tot_loss: 1.9455 | rl_loss: 0.5742 | pt_loss: 1.3713 | pg_loss: 0.0359 | reg_loss: 0.5383 | reward: -0.2906 | rev_kl: 0.8309 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4095e-06 | scale: 512.00 | time: 29.948 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   3261/  5000| tot_loss: 2.4204 | rl_loss: 0.6074 | pt_loss: 1.8130 | pg_loss: 0.1188 | reg_loss: 0.4885 | reward: -0.3258 | rev_kl: 1.5732 | stu_lens: 128.0000 | mixed_lens: 108.5000 | lr: 1.4081e-06 | scale: 512.00 | time: 29.987 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   3262/  5000| tot_loss: 2.7395 | rl_loss: 0.8200 | pt_loss: 1.9195 | pg_loss: 0.1740 | reg_loss: 0.6460 | reward: -0.9332 | rev_kl: 2.3665 | stu_lens: 69.0000 | mixed_lens: 70.0000 | lr: 1.4066e-06 | scale: 512.00 | time: 34.752 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   3263/  5000| tot_loss: 2.2064 | rl_loss: 0.5328 | pt_loss: 1.6735 | pg_loss: 0.0175 | reg_loss: 0.5153 | reward: -0.1423 | rev_kl: 0.9353 | stu_lens: 115.0000 | mixed_lens: 128.0000 | lr: 1.4052e-06 | scale: 512.00 | time: 29.985 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3264/  5000| tot_loss: 2.1015 | rl_loss: 0.6362 | pt_loss: 1.4653 | pg_loss: 0.0150 | reg_loss: 0.6212 | reward: -0.2248 | rev_kl: 1.1263 | stu_lens: 123.0000 | mixed_lens: 128.0000 | lr: 1.4038e-06 | scale: 512.00 | time: 30.001 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3264/  5000| tot_loss: 2.4146 | rl_loss: 0.7422 | pt_loss: 1.6724 | pg_loss: 0.2180 | reg_loss: 0.5242 | reward: -0.2892 | rev_kl: 1.0416 | stu_lens: 95.0469 | mixed_lens: 98.7500 | lr: 1.4038e-06 | scale: 512.00 | time: 30.001 | step time: 31.393
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   3265/  5000| tot_loss: 2.7011 | rl_loss: 1.2649 | pt_loss: 1.4361 | pg_loss: 0.7209 | reg_loss: 0.5441 | reward: -0.3277 | rev_kl: 1.3420 | stu_lens: 89.5000 | mixed_lens: 47.5000 | lr: 1.4023e-06 | scale: 512.00 | time: 29.970 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   3266/  5000| tot_loss: 3.5972 | rl_loss: 1.8701 | pt_loss: 1.7271 | pg_loss: 0.1514 | reg_loss: 1.7186 | reward: -0.2911 | rev_kl: 1.4964 | stu_lens: 118.5000 | mixed_lens: 114.0000 | lr: 1.4009e-06 | scale: 512.00 | time: 30.039 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   3267/  5000| tot_loss: 1.5848 | rl_loss: -0.4011 | pt_loss: 1.9859 | pg_loss: -0.8086 | reg_loss: 0.4075 | reward: -0.0917 | rev_kl: 0.2960 | stu_lens: 75.5000 | mixed_lens: 21.5000 | lr: 1.3994e-06 | scale: 512.00 | time: 29.956 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   3268/  5000| tot_loss: 2.9684 | rl_loss: 1.3215 | pt_loss: 1.6469 | pg_loss: 0.0923 | reg_loss: 1.2291 | reward: -0.1632 | rev_kl: 0.9317 | stu_lens: 128.0000 | mixed_lens: 119.5000 | lr: 1.3980e-06 | scale: 512.00 | time: 29.988 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   3269/  5000| tot_loss: 3.2245 | rl_loss: 1.3355 | pt_loss: 1.8889 | pg_loss: 0.0421 | reg_loss: 1.2935 | reward: -0.2972 | rev_kl: 1.4764 | stu_lens: 128.0000 | mixed_lens: 124.5000 | lr: 1.3966e-06 | scale: 512.00 | time: 29.933 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   3270/  5000| tot_loss: 2.8950 | rl_loss: 0.7379 | pt_loss: 2.1570 | pg_loss: 0.0880 | reg_loss: 0.6500 | reward: -0.4022 | rev_kl: 1.2608 | stu_lens: 85.0000 | mixed_lens: 115.0000 | lr: 1.3951e-06 | scale: 512.00 | time: 29.981 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   3271/  5000| tot_loss: 2.9055 | rl_loss: 1.3084 | pt_loss: 1.5972 | pg_loss: 0.1704 | reg_loss: 1.1380 | reward: -0.1021 | rev_kl: 0.8747 | stu_lens: 71.5000 | mixed_lens: 71.5000 | lr: 1.3937e-06 | scale: 512.00 | time: 30.033 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   3272/  5000| tot_loss: 3.0721 | rl_loss: 1.2901 | pt_loss: 1.7821 | pg_loss: 0.2679 | reg_loss: 1.0222 | reward: -0.2430 | rev_kl: 0.9686 | stu_lens: 110.0000 | mixed_lens: 95.0000 | lr: 1.3922e-06 | scale: 512.00 | time: 29.870 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   3273/  5000| tot_loss: 3.4958 | rl_loss: 1.8773 | pt_loss: 1.6185 | pg_loss: 0.3360 | reg_loss: 1.5413 | reward: -0.5736 | rev_kl: 1.4209 | stu_lens: 74.0000 | mixed_lens: 76.0000 | lr: 1.3908e-06 | scale: 512.00 | time: 29.983 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   3274/  5000| tot_loss: 3.4174 | rl_loss: 1.4892 | pt_loss: 1.9282 | pg_loss: 0.0902 | reg_loss: 1.3990 | reward: -0.0939 | rev_kl: 1.1974 | stu_lens: 128.0000 | mixed_lens: 125.5000 | lr: 1.3894e-06 | scale: 512.00 | time: 29.988 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   3275/  5000| tot_loss: 3.4494 | rl_loss: 1.3693 | pt_loss: 2.0801 | pg_loss: 0.2907 | reg_loss: 1.0785 | reward: -0.0911 | rev_kl: 1.2628 | stu_lens: 68.0000 | mixed_lens: 95.5000 | lr: 1.3879e-06 | scale: 512.00 | time: 29.982 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   3276/  5000| tot_loss: 3.6838 | rl_loss: 1.4918 | pt_loss: 2.1919 | pg_loss: 0.3347 | reg_loss: 1.1572 | reward: -0.3025 | rev_kl: 1.1938 | stu_lens: 104.0000 | mixed_lens: 102.0000 | lr: 1.3865e-06 | scale: 512.00 | time: 30.097 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   3277/  5000| tot_loss: 2.8751 | rl_loss: 1.1855 | pt_loss: 1.6896 | pg_loss: 0.3443 | reg_loss: 0.8412 | reward: -0.0153 | rev_kl: 0.2515 | stu_lens: 68.5000 | mixed_lens: 81.5000 | lr: 1.3851e-06 | scale: 512.00 | time: 30.006 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   3278/  5000| tot_loss: 3.4397 | rl_loss: 1.7814 | pt_loss: 1.6582 | pg_loss: 0.1776 | reg_loss: 1.6038 | reward: -0.3475 | rev_kl: 1.6997 | stu_lens: 107.0000 | mixed_lens: 117.0000 | lr: 1.3836e-06 | scale: 512.00 | time: 30.000 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   3279/  5000| tot_loss: 3.4873 | rl_loss: 1.6394 | pt_loss: 1.8479 | pg_loss: 0.2960 | reg_loss: 1.3434 | reward: -0.2750 | rev_kl: 1.1430 | stu_lens: 128.0000 | mixed_lens: 82.0000 | lr: 1.3822e-06 | scale: 512.00 | time: 29.974 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3280/  5000| tot_loss: 3.4994 | rl_loss: 2.1903 | pt_loss: 1.3091 | pg_loss: 1.0060 | reg_loss: 1.1843 | reward: -0.7314 | rev_kl: 0.9105 | stu_lens: 37.0000 | mixed_lens: 51.0000 | lr: 1.3808e-06 | scale: 512.00 | time: 34.847 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3280/  5000| tot_loss: 3.1906 | rl_loss: 1.4301 | pt_loss: 1.7604 | pg_loss: 0.2866 | reg_loss: 1.1435 | reward: -0.1157 | rev_kl: 1.0302 | stu_lens: 95.2812 | mixed_lens: 93.0000 | lr: 1.3808e-06 | scale: 512.00 | time: 34.847 | step time: 31.503
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   3281/  5000| tot_loss: 2.8901 | rl_loss: 0.8947 | pt_loss: 1.9954 | pg_loss: 0.0767 | reg_loss: 0.8179 | reward: -0.1958 | rev_kl: 1.0238 | stu_lens: 127.5000 | mixed_lens: 125.0000 | lr: 1.3793e-06 | scale: 512.00 | time: 30.063 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   3282/  5000| tot_loss: 2.5211 | rl_loss: 0.9216 | pt_loss: 1.5995 | pg_loss: 0.0178 | reg_loss: 0.9038 | reward: -0.2630 | rev_kl: 1.2851 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.3779e-06 | scale: 512.00 | time: 29.986 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   3283/  5000| tot_loss: 3.7904 | rl_loss: 1.7972 | pt_loss: 1.9932 | pg_loss: 0.6045 | reg_loss: 1.1926 | reward: -0.3829 | rev_kl: 0.7703 | stu_lens: 66.0000 | mixed_lens: 62.0000 | lr: 1.3765e-06 | scale: 512.00 | time: 30.040 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   3284/  5000| tot_loss: 2.7344 | rl_loss: 0.9013 | pt_loss: 1.8332 | pg_loss: 0.0991 | reg_loss: 0.8022 | reward: -0.1621 | rev_kl: 1.5928 | stu_lens: 89.5000 | mixed_lens: 103.5000 | lr: 1.3750e-06 | scale: 512.00 | time: 34.850 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   3285/  5000| tot_loss: 3.3286 | rl_loss: 1.4211 | pt_loss: 1.9075 | pg_loss: 0.2517 | reg_loss: 1.1694 | reward: -0.3321 | rev_kl: 1.3059 | stu_lens: 128.0000 | mixed_lens: 82.0000 | lr: 1.3736e-06 | scale: 512.00 | time: 30.033 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   3286/  5000| tot_loss: 2.6477 | rl_loss: 0.9903 | pt_loss: 1.6574 | pg_loss: 0.7098 | reg_loss: 0.2805 | reward: -0.1980 | rev_kl: 0.2745 | stu_lens: 36.0000 | mixed_lens: 43.5000 | lr: 1.3722e-06 | scale: 512.00 | time: 30.022 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   3287/  5000| tot_loss: 2.5946 | rl_loss: 1.1997 | pt_loss: 1.3949 | pg_loss: 0.2783 | reg_loss: 0.9215 | reward: -0.3025 | rev_kl: 1.1938 | stu_lens: 104.0000 | mixed_lens: 102.0000 | lr: 1.3707e-06 | scale: 512.00 | time: 29.986 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   3288/  5000| tot_loss: 2.9889 | rl_loss: 1.3481 | pt_loss: 1.6409 | pg_loss: 0.2059 | reg_loss: 1.1422 | reward: -0.4271 | rev_kl: 0.9841 | stu_lens: 92.0000 | mixed_lens: 90.5000 | lr: 1.3693e-06 | scale: 512.00 | time: 30.029 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   3289/  5000| tot_loss: 3.5689 | rl_loss: 1.7500 | pt_loss: 1.8188 | pg_loss: 0.5380 | reg_loss: 1.2121 | reward: -0.7522 | rev_kl: 1.8809 | stu_lens: 53.0000 | mixed_lens: 65.5000 | lr: 1.3679e-06 | scale: 512.00 | time: 29.957 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   3290/  5000| tot_loss: 2.7187 | rl_loss: 1.0949 | pt_loss: 1.6238 | pg_loss: 0.2731 | reg_loss: 0.8217 | reward: -0.2900 | rev_kl: 1.6086 | stu_lens: 128.0000 | mixed_lens: 78.0000 | lr: 1.3665e-06 | scale: 512.00 | time: 30.025 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   3291/  5000| tot_loss: 1.7726 | rl_loss: 0.4647 | pt_loss: 1.3079 | pg_loss: 0.0321 | reg_loss: 0.4326 | reward: -0.1241 | rev_kl: 0.5464 | stu_lens: 128.0000 | mixed_lens: 119.5000 | lr: 1.3650e-06 | scale: 512.00 | time: 29.993 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   3292/  5000| tot_loss: 2.4072 | rl_loss: 1.2982 | pt_loss: 1.1089 | pg_loss: 0.4162 | reg_loss: 0.8820 | reward: -0.6339 | rev_kl: 0.9167 | stu_lens: 73.0000 | mixed_lens: 74.0000 | lr: 1.3636e-06 | scale: 512.00 | time: 34.838 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   3293/  5000| tot_loss: 2.8737 | rl_loss: 0.8060 | pt_loss: 2.0676 | pg_loss: 0.0628 | reg_loss: 0.7433 | reward: -0.0821 | rev_kl: 1.0875 | stu_lens: 112.0000 | mixed_lens: 119.0000 | lr: 1.3622e-06 | scale: 512.00 | time: 30.029 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   3294/  5000| tot_loss: 3.1916 | rl_loss: 1.0017 | pt_loss: 2.1899 | pg_loss: 0.2451 | reg_loss: 0.7565 | reward: -0.1227 | rev_kl: 0.8357 | stu_lens: 128.0000 | mixed_lens: 74.0000 | lr: 1.3607e-06 | scale: 512.00 | time: 30.002 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   3295/  5000| tot_loss: 1.7081 | rl_loss: 0.8009 | pt_loss: 0.9073 | pg_loss: 0.2784 | reg_loss: 0.5225 | reward: -0.2033 | rev_kl: 0.7572 | stu_lens: 110.0000 | mixed_lens: 95.0000 | lr: 1.3593e-06 | scale: 512.00 | time: 29.987 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3296/  5000| tot_loss: 2.2556 | rl_loss: 0.9719 | pt_loss: 1.2838 | pg_loss: 0.0151 | reg_loss: 0.9568 | reward: -0.2147 | rev_kl: 1.0290 | stu_lens: 128.0000 | mixed_lens: 125.5000 | lr: 1.3579e-06 | scale: 512.00 | time: 34.873 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3296/  5000| tot_loss: 2.7454 | rl_loss: 1.0664 | pt_loss: 1.6790 | pg_loss: 0.2126 | reg_loss: 0.8538 | reward: -0.1073 | rev_kl: 1.0270 | stu_lens: 95.7656 | mixed_lens: 94.6250 | lr: 1.3579e-06 | scale: 512.00 | time: 34.873 | step time: 32.131
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   3297/  5000| tot_loss: 3.1442 | rl_loss: 1.5084 | pt_loss: 1.6358 | pg_loss: 0.5382 | reg_loss: 0.9701 | reward: -0.5680 | rev_kl: 0.7093 | stu_lens: 88.5000 | mixed_lens: 76.0000 | lr: 1.3565e-06 | scale: 512.00 | time: 29.987 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   3298/  5000| tot_loss: 2.2205 | rl_loss: 0.6432 | pt_loss: 1.5773 | pg_loss: 0.1277 | reg_loss: 0.5155 | reward: -0.4733 | rev_kl: 1.0046 | stu_lens: 43.5000 | mixed_lens: 103.5000 | lr: 1.3550e-06 | scale: 512.00 | time: 30.026 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   3299/  5000| tot_loss: 2.3271 | rl_loss: 0.7197 | pt_loss: 1.6073 | pg_loss: 0.1032 | reg_loss: 0.6165 | reward: -0.2084 | rev_kl: 1.0003 | stu_lens: 112.5000 | mixed_lens: 107.5000 | lr: 1.3536e-06 | scale: 512.00 | time: 30.043 | step time: 0.000
                                 Evaluation #33                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Bob should leave Alice, because his  │
│                                       │ chances of survival improve by 9%.   │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ mz kezboard tzpe z instead of y and  │
│                                       │ vice versa because mz kezboard is a  │
│                                       │ japanese keyboard and y is the roman │
│                                       │ alphabet and z is the japanese       │
│                                       │ alphabet                             │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support over 100 languages.       │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.730 | exact_match: 0.215 | rev_kl: 1.080 | lens: 83.455 | pt_loss: 1.072 | lm_loss: 1.152 | kd_loss: 0.991 
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   3300/  5000| tot_loss: 2.8181 | rl_loss: 0.9860 | pt_loss: 1.8321 | pg_loss: 0.2797 | reg_loss: 0.7063 | reward: -0.5001 | rev_kl: 0.8338 | stu_lens: 88.5000 | mixed_lens: 83.0000 | lr: 1.3522e-06 | scale: 512.00 | time: 34.873 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   3301/  5000| tot_loss: 2.5164 | rl_loss: 0.6846 | pt_loss: 1.8319 | pg_loss: 0.3581 | reg_loss: 0.3264 | reward: -0.3199 | rev_kl: 0.1682 | stu_lens: 28.0000 | mixed_lens: 75.5000 | lr: 1.3508e-06 | scale: 512.00 | time: 30.070 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   3302/  5000| tot_loss: 2.9324 | rl_loss: 0.9951 | pt_loss: 1.9372 | pg_loss: 0.3377 | reg_loss: 0.6574 | reward: -0.0635 | rev_kl: 0.4268 | stu_lens: 81.5000 | mixed_lens: 79.0000 | lr: 1.3493e-06 | scale: 512.00 | time: 30.028 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   3303/  5000| tot_loss: 2.1772 | rl_loss: 0.7147 | pt_loss: 1.4625 | pg_loss: 0.0311 | reg_loss: 0.6836 | reward: -0.1632 | rev_kl: 0.9317 | stu_lens: 128.0000 | mixed_lens: 119.5000 | lr: 1.3479e-06 | scale: 512.00 | time: 30.023 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   3304/  5000| tot_loss: 3.2530 | rl_loss: 1.5409 | pt_loss: 1.7120 | pg_loss: 0.4592 | reg_loss: 1.0818 | reward: -0.6365 | rev_kl: 1.4490 | stu_lens: 74.0000 | mixed_lens: 76.0000 | lr: 1.3465e-06 | scale: 512.00 | time: 30.001 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   3305/  5000| tot_loss: 3.1225 | rl_loss: 1.2458 | pt_loss: 1.8767 | pg_loss: 0.5606 | reg_loss: 0.6852 | reward: -0.2232 | rev_kl: 1.0320 | stu_lens: 113.0000 | mixed_lens: 55.5000 | lr: 1.3451e-06 | scale: 512.00 | time: 29.983 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   3306/  5000| tot_loss: 2.2307 | rl_loss: 0.7054 | pt_loss: 1.5253 | pg_loss: 0.0153 | reg_loss: 0.6902 | reward: -0.1491 | rev_kl: 1.3908 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.3437e-06 | scale: 512.00 | time: 29.967 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   3307/  5000| tot_loss: 2.7524 | rl_loss: 1.0025 | pt_loss: 1.7499 | pg_loss: 0.1956 | reg_loss: 0.8069 | reward: -0.2912 | rev_kl: 1.3873 | stu_lens: 104.0000 | mixed_lens: 102.0000 | lr: 1.3422e-06 | scale: 512.00 | time: 34.865 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   3308/  5000| tot_loss: 3.9014 | rl_loss: 1.1306 | pt_loss: 2.7708 | pg_loss: 0.3260 | reg_loss: 0.8046 | reward: -0.2758 | rev_kl: 1.4617 | stu_lens: 68.0000 | mixed_lens: 95.0000 | lr: 1.3408e-06 | scale: 512.00 | time: 29.998 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   3309/  5000| tot_loss: 2.4139 | rl_loss: 0.3573 | pt_loss: 2.0566 | pg_loss: 0.1213 | reg_loss: 0.2360 | reward: -0.1763 | rev_kl: 0.5277 | stu_lens: 82.5000 | mixed_lens: 36.0000 | lr: 1.3394e-06 | scale: 512.00 | time: 30.003 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   3310/  5000| tot_loss: 2.5842 | rl_loss: 1.0889 | pt_loss: 1.4953 | pg_loss: 0.3048 | reg_loss: 0.7841 | reward: -0.4358 | rev_kl: 0.8793 | stu_lens: 119.0000 | mixed_lens: 95.0000 | lr: 1.3380e-06 | scale: 512.00 | time: 30.043 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   3311/  5000| tot_loss: 2.6433 | rl_loss: 0.5859 | pt_loss: 2.0575 | pg_loss: 0.0132 | reg_loss: 0.5726 | reward: -0.4041 | rev_kl: 1.1122 | stu_lens: 128.0000 | mixed_lens: 124.5000 | lr: 1.3366e-06 | scale: 512.00 | time: 30.011 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3312/  5000| tot_loss: 2.3690 | rl_loss: 0.6672 | pt_loss: 1.7019 | pg_loss: 0.0767 | reg_loss: 0.5905 | reward: -0.2633 | rev_kl: 1.5510 | stu_lens: 128.0000 | mixed_lens: 114.5000 | lr: 1.3351e-06 | scale: 512.00 | time: 29.969 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3312/  5000| tot_loss: 2.6347 | rl_loss: 0.8870 | pt_loss: 1.7477 | pg_loss: 0.2198 | reg_loss: 0.6672 | reward: -0.1131 | rev_kl: 1.0300 | stu_lens: 96.2656 | mixed_lens: 94.3594 | lr: 1.3351e-06 | scale: 512.00 | time: 29.969 | step time: 31.833
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   3313/  5000| tot_loss: 2.7074 | rl_loss: 0.9724 | pt_loss: 1.7350 | pg_loss: 0.5135 | reg_loss: 0.4589 | reward: -0.8237 | rev_kl: 0.8489 | stu_lens: 76.0000 | mixed_lens: 73.5000 | lr: 1.3337e-06 | scale: 512.00 | time: 29.983 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   3314/  5000| tot_loss: 2.3596 | rl_loss: 0.6780 | pt_loss: 1.6817 | pg_loss: 0.0403 | reg_loss: 0.6376 | reward: -0.1130 | rev_kl: 1.2500 | stu_lens: 128.0000 | mixed_lens: 127.5000 | lr: 1.3323e-06 | scale: 512.00 | time: 30.025 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   3315/  5000| tot_loss: 2.5643 | rl_loss: 0.5915 | pt_loss: 1.9728 | pg_loss: 0.0785 | reg_loss: 0.5130 | reward: -0.2351 | rev_kl: 0.9150 | stu_lens: 128.0000 | mixed_lens: 114.0000 | lr: 1.3309e-06 | scale: 512.00 | time: 34.864 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   3316/  5000| tot_loss: 2.3573 | rl_loss: 0.7399 | pt_loss: 1.6174 | pg_loss: 0.2387 | reg_loss: 0.5012 | reward: -0.1585 | rev_kl: 1.3456 | stu_lens: 89.5000 | mixed_lens: 103.5000 | lr: 1.3295e-06 | scale: 512.00 | time: 30.028 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   3317/  5000| tot_loss: 2.1113 | rl_loss: 0.3569 | pt_loss: 1.7544 | pg_loss: -0.0010 | reg_loss: 0.3579 | reward: -0.3483 | rev_kl: 1.0204 | stu_lens: 85.0000 | mixed_lens: 128.0000 | lr: 1.3281e-06 | scale: 512.00 | time: 30.035 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   3318/  5000| tot_loss: 4.9256 | rl_loss: 2.9371 | pt_loss: 1.9885 | pg_loss: 2.0132 | reg_loss: 0.9239 | reward: 5.4115 | rev_kl: 1.0061 | stu_lens: 14.5000 | mixed_lens: 13.0000 | lr: 1.3266e-06 | scale: 512.00 | time: 29.996 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   3319/  5000| tot_loss: 1.9399 | rl_loss: 0.3696 | pt_loss: 1.5702 | pg_loss: 0.0033 | reg_loss: 0.3663 | reward: -0.0589 | rev_kl: 1.4803 | stu_lens: 107.0000 | mixed_lens: 128.0000 | lr: 1.3252e-06 | scale: 512.00 | time: 34.860 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   3320/  5000| tot_loss: 2.4894 | rl_loss: 0.5135 | pt_loss: 1.9758 | pg_loss: 0.1119 | reg_loss: 0.4016 | reward: -0.1447 | rev_kl: 1.1115 | stu_lens: 110.0000 | mixed_lens: 95.0000 | lr: 1.3238e-06 | scale: 512.00 | time: 30.063 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   3321/  5000| tot_loss: 1.5587 | rl_loss: 0.2072 | pt_loss: 1.3515 | pg_loss: 0.0269 | reg_loss: 0.1803 | reward: -0.2056 | rev_kl: 0.9993 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 1.3224e-06 | scale: 512.00 | time: 30.009 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   3322/  5000| tot_loss: 2.8799 | rl_loss: 1.2375 | pt_loss: 1.6423 | pg_loss: 0.4683 | reg_loss: 0.7692 | reward: -0.0699 | rev_kl: 1.0285 | stu_lens: 62.0000 | mixed_lens: 58.0000 | lr: 1.3210e-06 | scale: 512.00 | time: 30.011 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   3323/  5000| tot_loss: 2.1969 | rl_loss: 0.5680 | pt_loss: 1.6289 | pg_loss: 0.0902 | reg_loss: 0.4778 | reward: -0.3089 | rev_kl: 1.3931 | stu_lens: 104.0000 | mixed_lens: 117.5000 | lr: 1.3196e-06 | scale: 512.00 | time: 34.869 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   3324/  5000| tot_loss: 2.6125 | rl_loss: 0.7049 | pt_loss: 1.9076 | pg_loss: 0.2613 | reg_loss: 0.4437 | reward: -0.2887 | rev_kl: 0.9647 | stu_lens: 104.0000 | mixed_lens: 102.0000 | lr: 1.3182e-06 | scale: 512.00 | time: 30.042 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   3325/  5000| tot_loss: 2.5443 | rl_loss: 0.8609 | pt_loss: 1.6834 | pg_loss: 0.3675 | reg_loss: 0.4934 | reward: -0.5837 | rev_kl: 0.6439 | stu_lens: 60.0000 | mixed_lens: 74.0000 | lr: 1.3167e-06 | scale: 512.00 | time: 30.049 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   3326/  5000| tot_loss: 2.0439 | rl_loss: 0.4753 | pt_loss: 1.5686 | pg_loss: 0.0229 | reg_loss: 0.4524 | reward: -0.1396 | rev_kl: 1.1927 | stu_lens: 92.5000 | mixed_lens: 115.0000 | lr: 1.3153e-06 | scale: 512.00 | time: 30.004 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   3327/  5000| tot_loss: 2.1849 | rl_loss: 0.5133 | pt_loss: 1.6716 | pg_loss: 0.0115 | reg_loss: 0.5018 | reward: -0.1265 | rev_kl: 1.6183 | stu_lens: 128.0000 | mixed_lens: 127.5000 | lr: 1.3139e-06 | scale: 512.00 | time: 30.031 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3328/  5000| tot_loss: 3.2558 | rl_loss: 1.2953 | pt_loss: 1.9604 | pg_loss: 0.6473 | reg_loss: 0.6480 | reward: -0.9904 | rev_kl: 0.8812 | stu_lens: 76.0000 | mixed_lens: 58.0000 | lr: 1.3125e-06 | scale: 512.00 | time: 29.977 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3328/  5000| tot_loss: 2.5121 | rl_loss: 0.8175 | pt_loss: 1.6946 | pg_loss: 0.2848 | reg_loss: 0.5327 | reward: -0.1266 | rev_kl: 1.0093 | stu_lens: 96.5312 | mixed_lens: 95.8125 | lr: 1.3125e-06 | scale: 512.00 | time: 29.977 | step time: 32.143
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   3329/  5000| tot_loss: 3.0823 | rl_loss: 1.3607 | pt_loss: 1.7216 | pg_loss: 0.6893 | reg_loss: 0.6715 | reward: -0.3228 | rev_kl: 1.4015 | stu_lens: 119.0000 | mixed_lens: 60.5000 | lr: 1.3111e-06 | scale: 512.00 | time: 30.039 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   3330/  5000| tot_loss: 3.4143 | rl_loss: 1.5675 | pt_loss: 1.8468 | pg_loss: 0.2232 | reg_loss: 1.3442 | reward: -0.2260 | rev_kl: 1.1213 | stu_lens: 53.0000 | mixed_lens: 92.0000 | lr: 1.3097e-06 | scale: 512.00 | time: 30.068 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   3331/  5000| tot_loss: 3.9894 | rl_loss: 1.8732 | pt_loss: 2.1162 | pg_loss: 0.3575 | reg_loss: 1.5157 | reward: -1.0127 | rev_kl: 1.2223 | stu_lens: 84.5000 | mixed_lens: 74.5000 | lr: 1.3083e-06 | scale: 512.00 | time: 30.001 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   3332/  5000| tot_loss: 3.6108 | rl_loss: 1.7046 | pt_loss: 1.9063 | pg_loss: 0.3891 | reg_loss: 1.3155 | reward: -0.5216 | rev_kl: 1.0765 | stu_lens: 127.0000 | mixed_lens: 92.0000 | lr: 1.3069e-06 | scale: 512.00 | time: 30.022 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   3333/  5000| tot_loss: 2.9079 | rl_loss: 1.7847 | pt_loss: 1.1232 | pg_loss: 0.4837 | reg_loss: 1.3010 | reward: -0.7670 | rev_kl: 1.2389 | stu_lens: 85.5000 | mixed_lens: 62.0000 | lr: 1.3055e-06 | scale: 512.00 | time: 29.980 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   3334/  5000| tot_loss: 3.3757 | rl_loss: 1.6157 | pt_loss: 1.7600 | pg_loss: 0.2040 | reg_loss: 1.4117 | reward: -0.0174 | rev_kl: 1.2149 | stu_lens: 85.5000 | mixed_lens: 104.5000 | lr: 1.3041e-06 | scale: 512.00 | time: 30.020 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   3335/  5000| tot_loss: 2.8232 | rl_loss: 1.1335 | pt_loss: 1.6897 | pg_loss: 0.0966 | reg_loss: 1.0369 | reward: -0.3778 | rev_kl: 0.8732 | stu_lens: 97.0000 | mixed_lens: 120.0000 | lr: 1.3026e-06 | scale: 512.00 | time: 30.017 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   3336/  5000| tot_loss: 5.1040 | rl_loss: 3.1748 | pt_loss: 1.9292 | pg_loss: 0.9683 | reg_loss: 2.2065 | reward: -1.1536 | rev_kl: 1.1480 | stu_lens: 98.0000 | mixed_lens: 51.0000 | lr: 1.3012e-06 | scale: 512.00 | time: 30.053 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   3337/  5000| tot_loss: 4.2174 | rl_loss: 2.4585 | pt_loss: 1.7589 | pg_loss: 0.9231 | reg_loss: 1.5354 | reward: -0.6776 | rev_kl: 0.8676 | stu_lens: 98.5000 | mixed_lens: 42.0000 | lr: 1.2998e-06 | scale: 512.00 | time: 30.055 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   3338/  5000| tot_loss: 3.6718 | rl_loss: 1.8906 | pt_loss: 1.7812 | pg_loss: 0.8149 | reg_loss: 1.0756 | reward: -0.2599 | rev_kl: 1.0958 | stu_lens: 59.5000 | mixed_lens: 32.5000 | lr: 1.2984e-06 | scale: 512.00 | time: 30.025 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   3339/  5000| tot_loss: 3.0640 | rl_loss: 1.4916 | pt_loss: 1.5724 | pg_loss: 0.1823 | reg_loss: 1.3094 | reward: -0.1870 | rev_kl: 1.3939 | stu_lens: 128.0000 | mixed_lens: 108.0000 | lr: 1.2970e-06 | scale: 512.00 | time: 30.024 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   3340/  5000| tot_loss: 3.3687 | rl_loss: 1.5453 | pt_loss: 1.8235 | pg_loss: 0.2870 | reg_loss: 1.2582 | reward: -0.3517 | rev_kl: 0.9636 | stu_lens: 94.0000 | mixed_lens: 88.0000 | lr: 1.2956e-06 | scale: 512.00 | time: 34.853 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   3341/  5000| tot_loss: 4.4290 | rl_loss: 2.5324 | pt_loss: 1.8966 | pg_loss: 0.6680 | reg_loss: 1.8644 | reward: -1.2732 | rev_kl: 1.2308 | stu_lens: 53.0000 | mixed_lens: 71.5000 | lr: 1.2942e-06 | scale: 512.00 | time: 30.019 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   3342/  5000| tot_loss: 2.3108 | rl_loss: 0.7735 | pt_loss: 1.5373 | pg_loss: 0.0606 | reg_loss: 0.7129 | reward: -0.1403 | rev_kl: 0.6050 | stu_lens: 97.5000 | mixed_lens: 128.0000 | lr: 1.2928e-06 | scale: 512.00 | time: 30.055 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   3343/  5000| tot_loss: 3.2233 | rl_loss: 1.5232 | pt_loss: 1.7001 | pg_loss: 0.3147 | reg_loss: 1.2086 | reward: -0.2599 | rev_kl: 1.2307 | stu_lens: 96.0000 | mixed_lens: 87.0000 | lr: 1.2914e-06 | scale: 512.00 | time: 30.030 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3344/  5000| tot_loss: 3.0127 | rl_loss: 1.1303 | pt_loss: 1.8824 | pg_loss: 0.0431 | reg_loss: 1.0872 | reward: -0.0968 | rev_kl: 1.1466 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.2900e-06 | scale: 512.00 | time: 34.978 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3344/  5000| tot_loss: 3.3830 | rl_loss: 1.6580 | pt_loss: 1.7250 | pg_loss: 0.4440 | reg_loss: 1.2141 | reward: -0.4231 | rev_kl: 1.1182 | stu_lens: 85.4844 | mixed_lens: 79.9844 | lr: 1.2900e-06 | scale: 512.00 | time: 34.978 | step time: 31.852
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   3345/  5000| tot_loss: 3.5547 | rl_loss: 1.6132 | pt_loss: 1.9415 | pg_loss: 0.2426 | reg_loss: 1.3706 | reward: -0.4351 | rev_kl: 1.7767 | stu_lens: 70.5000 | mixed_lens: 107.5000 | lr: 1.2886e-06 | scale: 512.00 | time: 30.020 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   3346/  5000| tot_loss: 3.3561 | rl_loss: 1.7137 | pt_loss: 1.6424 | pg_loss: 0.7332 | reg_loss: 0.9805 | reward: -0.3776 | rev_kl: 1.2564 | stu_lens: 105.0000 | mixed_lens: 50.0000 | lr: 1.2872e-06 | scale: 512.00 | time: 30.025 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   3347/  5000| tot_loss: 2.8828 | rl_loss: 1.1740 | pt_loss: 1.7088 | pg_loss: 0.2301 | reg_loss: 0.9439 | reward: -0.2365 | rev_kl: 0.7905 | stu_lens: 96.0000 | mixed_lens: 93.0000 | lr: 1.2858e-06 | scale: 512.00 | time: 30.011 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   3348/  5000| tot_loss: 4.5600 | rl_loss: 2.4889 | pt_loss: 2.0711 | pg_loss: 1.3104 | reg_loss: 1.1785 | reward: -0.3524 | rev_kl: 0.0830 | stu_lens: 14.0000 | mixed_lens: 27.5000 | lr: 1.2844e-06 | scale: 512.00 | time: 30.026 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   3349/  5000| tot_loss: 3.2201 | rl_loss: 1.0572 | pt_loss: 2.1629 | pg_loss: 0.0301 | reg_loss: 1.0271 | reward: -0.2490 | rev_kl: 1.8101 | stu_lens: 86.0000 | mixed_lens: 128.0000 | lr: 1.2830e-06 | scale: 512.00 | time: 30.063 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   3350/  5000| tot_loss: 2.7685 | rl_loss: 1.2008 | pt_loss: 1.5676 | pg_loss: 0.1519 | reg_loss: 1.0490 | reward: -0.1551 | rev_kl: 1.0905 | stu_lens: 97.5000 | mixed_lens: 101.0000 | lr: 1.2816e-06 | scale: 512.00 | time: 30.081 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   3351/  5000| tot_loss: 3.9291 | rl_loss: 2.0862 | pt_loss: 1.8429 | pg_loss: 0.6958 | reg_loss: 1.3904 | reward: -1.1088 | rev_kl: 1.9823 | stu_lens: 45.5000 | mixed_lens: 51.5000 | lr: 1.2802e-06 | scale: 512.00 | time: 30.028 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   3352/  5000| tot_loss: 3.1528 | rl_loss: 1.6208 | pt_loss: 1.5320 | pg_loss: 0.5285 | reg_loss: 1.0923 | reward: -0.3623 | rev_kl: 1.1743 | stu_lens: 44.0000 | mixed_lens: 58.0000 | lr: 1.2788e-06 | scale: 512.00 | time: 30.034 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   3353/  5000| tot_loss: 2.8492 | rl_loss: 1.1519 | pt_loss: 1.6973 | pg_loss: 0.0472 | reg_loss: 1.1046 | reward: -0.3387 | rev_kl: 2.2708 | stu_lens: 107.5000 | mixed_lens: 117.0000 | lr: 1.2774e-06 | scale: 512.00 | time: 29.949 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   3354/  5000| tot_loss: 3.4611 | rl_loss: 1.6187 | pt_loss: 1.8424 | pg_loss: 0.7504 | reg_loss: 0.8683 | reward: -0.5993 | rev_kl: 1.0287 | stu_lens: 98.0000 | mixed_lens: 28.5000 | lr: 1.2760e-06 | scale: 512.00 | time: 29.979 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   3355/  5000| tot_loss: 2.5422 | rl_loss: 1.1542 | pt_loss: 1.3880 | pg_loss: 0.2083 | reg_loss: 0.9459 | reward: -0.2761 | rev_kl: 1.2135 | stu_lens: 90.5000 | mixed_lens: 86.5000 | lr: 1.2746e-06 | scale: 512.00 | time: 29.938 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   3356/  5000| tot_loss: 2.8106 | rl_loss: 0.8567 | pt_loss: 1.9540 | pg_loss: 0.0991 | reg_loss: 0.7576 | reward: -0.1846 | rev_kl: 1.2276 | stu_lens: 128.0000 | mixed_lens: 118.0000 | lr: 1.2732e-06 | scale: 512.00 | time: 30.015 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   3357/  5000| tot_loss: 2.3329 | rl_loss: 1.2200 | pt_loss: 1.1129 | pg_loss: 0.4167 | reg_loss: 0.8033 | reward: -0.3988 | rev_kl: 0.9661 | stu_lens: 112.0000 | mixed_lens: 81.0000 | lr: 1.2718e-06 | scale: 512.00 | time: 30.005 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   3358/  5000| tot_loss: 3.3764 | rl_loss: 1.4404 | pt_loss: 1.9359 | pg_loss: 0.5555 | reg_loss: 0.8850 | reward: -0.0300 | rev_kl: 1.4057 | stu_lens: 68.5000 | mixed_lens: 43.0000 | lr: 1.2704e-06 | scale: 512.00 | time: 29.971 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   3359/  5000| tot_loss: 2.5311 | rl_loss: 0.8847 | pt_loss: 1.6465 | pg_loss: 0.0189 | reg_loss: 0.8657 | reward: -0.1464 | rev_kl: 1.5523 | stu_lens: 99.0000 | mixed_lens: 127.5000 | lr: 1.2690e-06 | scale: 512.00 | time: 29.994 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3360/  5000| tot_loss: 3.1157 | rl_loss: 1.4572 | pt_loss: 1.6584 | pg_loss: 0.3173 | reg_loss: 1.1399 | reward: -0.4221 | rev_kl: 0.9121 | stu_lens: 112.5000 | mixed_lens: 72.5000 | lr: 1.2676e-06 | scale: 512.00 | time: 34.869 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3360/  5000| tot_loss: 3.0462 | rl_loss: 1.2805 | pt_loss: 1.7657 | pg_loss: 0.3541 | reg_loss: 0.9263 | reward: -0.3673 | rev_kl: 1.1481 | stu_lens: 89.0938 | mixed_lens: 83.2500 | lr: 1.2676e-06 | scale: 512.00 | time: 34.869 | step time: 31.525
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   3361/  5000| tot_loss: 3.9376 | rl_loss: 1.9287 | pt_loss: 2.0089 | pg_loss: 0.7352 | reg_loss: 1.1934 | reward: -0.5201 | rev_kl: 0.8295 | stu_lens: 34.0000 | mixed_lens: 51.0000 | lr: 1.2662e-06 | scale: 512.00 | time: 29.946 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   3362/  5000| tot_loss: 2.4268 | rl_loss: 0.9417 | pt_loss: 1.4851 | pg_loss: 0.2404 | reg_loss: 0.7013 | reward: -0.2429 | rev_kl: 1.5091 | stu_lens: 67.0000 | mixed_lens: 92.5000 | lr: 1.2648e-06 | scale: 512.00 | time: 30.027 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   3363/  5000| tot_loss: 3.3020 | rl_loss: 1.4457 | pt_loss: 1.8563 | pg_loss: 0.6258 | reg_loss: 0.8199 | reward: -0.2343 | rev_kl: 0.8634 | stu_lens: 13.0000 | mixed_lens: 41.0000 | lr: 1.2634e-06 | scale: 512.00 | time: 29.951 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   3364/  5000| tot_loss: 2.1720 | rl_loss: 0.4460 | pt_loss: 1.7260 | pg_loss: 0.1061 | reg_loss: 0.3399 | reward: -0.1686 | rev_kl: 0.9512 | stu_lens: 68.5000 | mixed_lens: 89.0000 | lr: 1.2620e-06 | scale: 512.00 | time: 30.018 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   3365/  5000| tot_loss: 2.7531 | rl_loss: 1.0441 | pt_loss: 1.7090 | pg_loss: 0.2866 | reg_loss: 0.7575 | reward: -0.6534 | rev_kl: 1.1689 | stu_lens: 126.5000 | mixed_lens: 74.0000 | lr: 1.2607e-06 | scale: 512.00 | time: 30.027 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   3366/  5000| tot_loss: 3.1999 | rl_loss: 1.1599 | pt_loss: 2.0400 | pg_loss: 0.2168 | reg_loss: 0.9431 | reward: -0.8924 | rev_kl: 2.2143 | stu_lens: 106.0000 | mixed_lens: 99.0000 | lr: 1.2593e-06 | scale: 512.00 | time: 29.977 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   3367/  5000| tot_loss: 2.7466 | rl_loss: 0.9533 | pt_loss: 1.7933 | pg_loss: 0.3162 | reg_loss: 0.6371 | reward: -0.1673 | rev_kl: 0.7922 | stu_lens: 43.5000 | mixed_lens: 59.5000 | lr: 1.2579e-06 | scale: 512.00 | time: 29.967 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   3368/  5000| tot_loss: 2.6609 | rl_loss: 0.9385 | pt_loss: 1.7224 | pg_loss: 0.3126 | reg_loss: 0.6259 | reward: -0.6584 | rev_kl: 1.7378 | stu_lens: 64.5000 | mixed_lens: 81.0000 | lr: 1.2565e-06 | scale: 512.00 | time: 34.957 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   3369/  5000| tot_loss: 2.3144 | rl_loss: 0.6818 | pt_loss: 1.6326 | pg_loss: 0.1887 | reg_loss: 0.4931 | reward: -0.1115 | rev_kl: 0.7413 | stu_lens: 102.0000 | mixed_lens: 95.0000 | lr: 1.2551e-06 | scale: 512.00 | time: 30.107 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   3370/  5000| tot_loss: 2.7557 | rl_loss: 1.2303 | pt_loss: 1.5255 | pg_loss: 0.5154 | reg_loss: 0.7149 | reward: -0.3106 | rev_kl: 1.3405 | stu_lens: 65.5000 | mixed_lens: 69.5000 | lr: 1.2537e-06 | scale: 512.00 | time: 30.042 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   3371/  5000| tot_loss: 2.2063 | rl_loss: 1.0150 | pt_loss: 1.1913 | pg_loss: 0.2708 | reg_loss: 0.7443 | reward: -0.5474 | rev_kl: 1.2115 | stu_lens: 114.0000 | mixed_lens: 97.5000 | lr: 1.2523e-06 | scale: 512.00 | time: 29.989 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   3372/  5000| tot_loss: 3.3577 | rl_loss: 1.6892 | pt_loss: 1.6685 | pg_loss: 0.7986 | reg_loss: 0.8907 | reward: -0.2146 | rev_kl: 0.8697 | stu_lens: 112.0000 | mixed_lens: 48.0000 | lr: 1.2509e-06 | scale: 512.00 | time: 29.995 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   3373/  5000| tot_loss: 2.4439 | rl_loss: 0.9899 | pt_loss: 1.4540 | pg_loss: 0.3806 | reg_loss: 0.6093 | reward: -1.0828 | rev_kl: 0.9682 | stu_lens: 46.0000 | mixed_lens: 71.5000 | lr: 1.2495e-06 | scale: 512.00 | time: 29.965 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   3374/  5000| tot_loss: 2.5024 | rl_loss: 1.3039 | pt_loss: 1.1984 | pg_loss: 0.5203 | reg_loss: 0.7836 | reward: -0.2449 | rev_kl: 1.3233 | stu_lens: 65.5000 | mixed_lens: 64.5000 | lr: 1.2481e-06 | scale: 512.00 | time: 29.957 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   3375/  5000| tot_loss: 3.3465 | rl_loss: 2.3158 | pt_loss: 1.0307 | pg_loss: 1.6869 | reg_loss: 0.6290 | reward: -1.1838 | rev_kl: 1.5768 | stu_lens: 27.5000 | mixed_lens: 22.5000 | lr: 1.2468e-06 | scale: 512.00 | time: 29.978 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3376/  5000| tot_loss: 2.4673 | rl_loss: 0.8614 | pt_loss: 1.6060 | pg_loss: 0.0101 | reg_loss: 0.8512 | reward: -0.3175 | rev_kl: 2.0370 | stu_lens: 114.5000 | mixed_lens: 128.0000 | lr: 1.2454e-06 | scale: 512.00 | time: 34.876 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3376/  5000| tot_loss: 2.7542 | rl_loss: 1.1428 | pt_loss: 1.6114 | pg_loss: 0.4230 | reg_loss: 0.7198 | reward: -0.4740 | rev_kl: 1.1230 | stu_lens: 83.7969 | mixed_lens: 76.8906 | lr: 1.2454e-06 | scale: 512.00 | time: 34.876 | step time: 31.823
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   3377/  5000| tot_loss: 3.0873 | rl_loss: 1.1430 | pt_loss: 1.9443 | pg_loss: 0.3094 | reg_loss: 0.8336 | reward: -0.3659 | rev_kl: 0.9418 | stu_lens: 80.5000 | mixed_lens: 93.0000 | lr: 1.2440e-06 | scale: 512.00 | time: 30.052 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   3378/  5000| tot_loss: 2.9815 | rl_loss: 1.1560 | pt_loss: 1.8254 | pg_loss: 0.3251 | reg_loss: 0.8310 | reward: -0.6460 | rev_kl: 0.8855 | stu_lens: 83.0000 | mixed_lens: 89.5000 | lr: 1.2426e-06 | scale: 512.00 | time: 30.002 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   3379/  5000| tot_loss: 1.9641 | rl_loss: 0.4460 | pt_loss: 1.5181 | pg_loss: -0.0009 | reg_loss: 0.4469 | reward: -0.3254 | rev_kl: 1.1914 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.2412e-06 | scale: 512.00 | time: 29.981 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   3380/  5000| tot_loss: 2.3935 | rl_loss: 0.6765 | pt_loss: 1.7171 | pg_loss: 0.0191 | reg_loss: 0.6573 | reward: -0.2815 | rev_kl: 2.4222 | stu_lens: 107.5000 | mixed_lens: 123.0000 | lr: 1.2398e-06 | scale: 512.00 | time: 30.089 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   3381/  5000| tot_loss: 1.6359 | rl_loss: 0.4367 | pt_loss: 1.1992 | pg_loss: 0.0742 | reg_loss: 0.3624 | reward: -0.1885 | rev_kl: 0.5397 | stu_lens: 102.0000 | mixed_lens: 95.0000 | lr: 1.2385e-06 | scale: 512.00 | time: 29.942 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   3382/  5000| tot_loss: 1.9263 | rl_loss: 0.5617 | pt_loss: 1.3645 | pg_loss: 0.0273 | reg_loss: 0.5345 | reward: -0.1312 | rev_kl: 1.1145 | stu_lens: 128.0000 | mixed_lens: 122.0000 | lr: 1.2371e-06 | scale: 512.00 | time: 30.021 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   3383/  5000| tot_loss: 2.4522 | rl_loss: 0.6167 | pt_loss: 1.8355 | pg_loss: -0.0047 | reg_loss: 0.6214 | reward: -0.4015 | rev_kl: 1.1601 | stu_lens: 114.5000 | mixed_lens: 128.0000 | lr: 1.2357e-06 | scale: 512.00 | time: 30.026 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   3384/  5000| tot_loss: 2.7031 | rl_loss: 0.9003 | pt_loss: 1.8027 | pg_loss: 0.2103 | reg_loss: 0.6900 | reward: -0.1213 | rev_kl: 1.2210 | stu_lens: 73.0000 | mixed_lens: 78.0000 | lr: 1.2343e-06 | scale: 512.00 | time: 34.901 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   3385/  5000| tot_loss: 2.2441 | rl_loss: 0.7464 | pt_loss: 1.4976 | pg_loss: 0.1333 | reg_loss: 0.6131 | reward: -0.6718 | rev_kl: 1.0546 | stu_lens: 98.0000 | mixed_lens: 104.0000 | lr: 1.2329e-06 | scale: 512.00 | time: 30.115 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   3386/  5000| tot_loss: 2.1188 | rl_loss: 1.0889 | pt_loss: 1.0299 | pg_loss: 0.4855 | reg_loss: 0.6034 | reward: -0.3465 | rev_kl: 0.9019 | stu_lens: 74.5000 | mixed_lens: 68.5000 | lr: 1.2315e-06 | scale: 512.00 | time: 30.020 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   3387/  5000| tot_loss: 3.3633 | rl_loss: 1.0170 | pt_loss: 2.3463 | pg_loss: 0.2623 | reg_loss: 0.7546 | reward: -0.2757 | rev_kl: 1.9483 | stu_lens: 114.5000 | mixed_lens: 95.0000 | lr: 1.2302e-06 | scale: 512.00 | time: 29.960 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   3388/  5000| tot_loss: 3.0607 | rl_loss: 1.0722 | pt_loss: 1.9885 | pg_loss: 0.5285 | reg_loss: 0.5437 | reward: -0.3623 | rev_kl: 1.1743 | stu_lens: 44.0000 | mixed_lens: 58.0000 | lr: 1.2288e-06 | scale: 512.00 | time: 29.991 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   3389/  5000| tot_loss: 2.2209 | rl_loss: 0.7232 | pt_loss: 1.4977 | pg_loss: 0.2595 | reg_loss: 0.4637 | reward: -0.3746 | rev_kl: 0.8444 | stu_lens: 94.0000 | mixed_lens: 88.0000 | lr: 1.2274e-06 | scale: 512.00 | time: 30.045 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   3390/  5000| tot_loss: 2.4146 | rl_loss: 1.0217 | pt_loss: 1.3929 | pg_loss: 0.3817 | reg_loss: 0.6399 | reward: -0.9448 | rev_kl: 0.8050 | stu_lens: 55.5000 | mixed_lens: 69.5000 | lr: 1.2260e-06 | scale: 512.00 | time: 30.051 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   3391/  5000| tot_loss: 2.5044 | rl_loss: 0.6336 | pt_loss: 1.8709 | pg_loss: 0.1125 | reg_loss: 0.5210 | reward: -0.2043 | rev_kl: 0.8810 | stu_lens: 52.5000 | mixed_lens: 54.0000 | lr: 1.2246e-06 | scale: 512.00 | time: 30.012 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3392/  5000| tot_loss: 2.4990 | rl_loss: 0.1366 | pt_loss: 2.3624 | pg_loss: -0.0244 | reg_loss: 0.1610 | reward: 0.0484 | rev_kl: 0.6965 | stu_lens: 54.5000 | mixed_lens: 18.0000 | lr: 1.2233e-06 | scale: 512.00 | time: 34.854 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3392/  5000| tot_loss: 2.5441 | rl_loss: 0.8646 | pt_loss: 1.6795 | pg_loss: 0.3008 | reg_loss: 0.5638 | reward: -0.4065 | rev_kl: 1.1320 | stu_lens: 85.7188 | mixed_lens: 82.8906 | lr: 1.2233e-06 | scale: 512.00 | time: 34.854 | step time: 31.840
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   3393/  5000| tot_loss: 2.7004 | rl_loss: 0.9848 | pt_loss: 1.7155 | pg_loss: 0.5045 | reg_loss: 0.4804 | reward: -0.5182 | rev_kl: 0.9277 | stu_lens: 112.5000 | mixed_lens: 72.5000 | lr: 1.2219e-06 | scale: 512.00 | time: 30.012 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   3394/  5000| tot_loss: 3.0652 | rl_loss: 1.4926 | pt_loss: 1.5726 | pg_loss: 0.0577 | reg_loss: 1.4349 | reward: -0.3668 | rev_kl: 1.0659 | stu_lens: 128.0000 | mixed_lens: 122.5000 | lr: 1.2205e-06 | scale: 512.00 | time: 30.040 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   3395/  5000| tot_loss: 3.5205 | rl_loss: 1.8796 | pt_loss: 1.6409 | pg_loss: 0.4346 | reg_loss: 1.4451 | reward: -0.8543 | rev_kl: 0.8635 | stu_lens: 81.0000 | mixed_lens: 72.5000 | lr: 1.2191e-06 | scale: 512.00 | time: 30.025 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   3396/  5000| tot_loss: 3.8341 | rl_loss: 2.0255 | pt_loss: 1.8085 | pg_loss: 0.6813 | reg_loss: 1.3442 | reward: -0.6506 | rev_kl: 1.1490 | stu_lens: 115.0000 | mixed_lens: 65.5000 | lr: 1.2178e-06 | scale: 512.00 | time: 29.976 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   3397/  5000| tot_loss: 2.3895 | rl_loss: 1.3433 | pt_loss: 1.0462 | pg_loss: 0.3234 | reg_loss: 1.0199 | reward: -0.3041 | rev_kl: 0.7721 | stu_lens: 85.0000 | mixed_lens: 93.0000 | lr: 1.2164e-06 | scale: 512.00 | time: 29.963 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   3398/  5000| tot_loss: 2.9706 | rl_loss: 1.0699 | pt_loss: 1.9007 | pg_loss: 0.0245 | reg_loss: 1.0454 | reward: -0.2635 | rev_kl: 1.0604 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.2150e-06 | scale: 512.00 | time: 30.012 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   3399/  5000| tot_loss: 3.3368 | rl_loss: 1.8545 | pt_loss: 1.4823 | pg_loss: 0.3963 | reg_loss: 1.4581 | reward: -0.5758 | rev_kl: 1.3555 | stu_lens: 121.0000 | mixed_lens: 77.5000 | lr: 1.2136e-06 | scale: 512.00 | time: 30.027 | step time: 0.000
                                 Evaluation #34                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Bob should leave Alice, since his    │
│                                       │ chances of survival improve by 9%.   │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ mz kezboard tzpe z instead of y and  │
│                                       │ vice versa                           │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support over 40 languages.        │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.782 | exact_match: 0.215 | rev_kl: 1.072 | lens: 84.361 | pt_loss: 1.071 | lm_loss: 1.152 | kd_loss: 0.991 
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   3400/  5000| tot_loss: 3.5269 | rl_loss: 2.0101 | pt_loss: 1.5168 | pg_loss: 0.3149 | reg_loss: 1.6953 | reward: -0.2077 | rev_kl: 1.1947 | stu_lens: 105.5000 | mixed_lens: 95.5000 | lr: 1.2123e-06 | scale: 512.00 | time: 29.975 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   3401/  5000| tot_loss: 3.9671 | rl_loss: 2.2292 | pt_loss: 1.7379 | pg_loss: 0.5708 | reg_loss: 1.6584 | reward: -0.3779 | rev_kl: 0.7347 | stu_lens: 110.0000 | mixed_lens: 56.0000 | lr: 1.2109e-06 | scale: 512.00 | time: 30.002 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   3402/  5000| tot_loss: 3.1912 | rl_loss: 1.6280 | pt_loss: 1.5632 | pg_loss: 0.1114 | reg_loss: 1.5166 | reward: -0.2287 | rev_kl: 1.2562 | stu_lens: 85.5000 | mixed_lens: 120.5000 | lr: 1.2095e-06 | scale: 512.00 | time: 29.976 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   3403/  5000| tot_loss: 2.3701 | rl_loss: 1.1430 | pt_loss: 1.2271 | pg_loss: 0.1272 | reg_loss: 1.0158 | reward: -0.4021 | rev_kl: 1.9903 | stu_lens: 64.0000 | mixed_lens: 48.0000 | lr: 1.2081e-06 | scale: 512.00 | time: 30.051 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   3404/  5000| tot_loss: 3.1603 | rl_loss: 1.6653 | pt_loss: 1.4949 | pg_loss: 0.5183 | reg_loss: 1.1470 | reward: -0.5148 | rev_kl: 0.9188 | stu_lens: 78.0000 | mixed_lens: 78.5000 | lr: 1.2068e-06 | scale: 512.00 | time: 29.993 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   3405/  5000| tot_loss: 3.0445 | rl_loss: 1.1785 | pt_loss: 1.8660 | pg_loss: 0.1615 | reg_loss: 1.0170 | reward: -0.1980 | rev_kl: 0.8433 | stu_lens: 100.5000 | mixed_lens: 106.0000 | lr: 1.2054e-06 | scale: 512.00 | time: 29.993 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   3406/  5000| tot_loss: 3.0422 | rl_loss: 1.2221 | pt_loss: 1.8201 | pg_loss: 0.1702 | reg_loss: 1.0519 | reward: -0.2963 | rev_kl: 1.3831 | stu_lens: 128.0000 | mixed_lens: 116.0000 | lr: 1.2040e-06 | scale: 512.00 | time: 29.987 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   3407/  5000| tot_loss: 3.8026 | rl_loss: 1.9027 | pt_loss: 1.8999 | pg_loss: 0.8450 | reg_loss: 1.0577 | reward: -0.6618 | rev_kl: 0.6192 | stu_lens: 27.0000 | mixed_lens: 29.0000 | lr: 1.2026e-06 | scale: 512.00 | time: 29.978 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3408/  5000| tot_loss: 3.5201 | rl_loss: 1.6980 | pt_loss: 1.8221 | pg_loss: 0.4195 | reg_loss: 1.2786 | reward: -0.3647 | rev_kl: 1.1126 | stu_lens: 85.5000 | mixed_lens: 81.0000 | lr: 1.2013e-06 | scale: 512.00 | time: 29.976 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3408/  5000| tot_loss: 3.2551 | rl_loss: 1.5415 | pt_loss: 1.7136 | pg_loss: 0.3562 | reg_loss: 1.1853 | reward: -0.3734 | rev_kl: 1.0892 | stu_lens: 95.9375 | mixed_lens: 87.0938 | lr: 1.2013e-06 | scale: 512.00 | time: 29.976 | step time: 31.214
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   3409/  5000| tot_loss: 2.5282 | rl_loss: 0.8792 | pt_loss: 1.6491 | pg_loss: 0.0585 | reg_loss: 0.8207 | reward: -0.1560 | rev_kl: 1.3963 | stu_lens: 110.5000 | mixed_lens: 128.0000 | lr: 1.1999e-06 | scale: 512.00 | time: 30.018 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   3410/  5000| tot_loss: 2.6343 | rl_loss: 1.1447 | pt_loss: 1.4897 | pg_loss: 0.2548 | reg_loss: 0.8898 | reward: -0.3629 | rev_kl: 1.2764 | stu_lens: 114.5000 | mixed_lens: 100.0000 | lr: 1.1985e-06 | scale: 512.00 | time: 29.999 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   3411/  5000| tot_loss: 3.9509 | rl_loss: 1.7140 | pt_loss: 2.2369 | pg_loss: 0.5499 | reg_loss: 1.1641 | reward: -0.9151 | rev_kl: 1.1391 | stu_lens: 77.0000 | mixed_lens: 66.0000 | lr: 1.1972e-06 | scale: 512.00 | time: 29.991 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   3412/  5000| tot_loss: 3.4958 | rl_loss: 1.7534 | pt_loss: 1.7424 | pg_loss: 0.7325 | reg_loss: 1.0209 | reward: -0.3665 | rev_kl: 1.1195 | stu_lens: 82.5000 | mixed_lens: 46.0000 | lr: 1.1958e-06 | scale: 512.00 | time: 29.989 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   3413/  5000| tot_loss: 2.7214 | rl_loss: 1.1288 | pt_loss: 1.5926 | pg_loss: 0.1358 | reg_loss: 0.9930 | reward: -0.1882 | rev_kl: 1.3648 | stu_lens: 65.0000 | mixed_lens: 98.0000 | lr: 1.1944e-06 | scale: 512.00 | time: 29.959 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   3414/  5000| tot_loss: 2.9928 | rl_loss: 1.3681 | pt_loss: 1.6247 | pg_loss: 0.4175 | reg_loss: 0.9506 | reward: -0.1600 | rev_kl: 1.0864 | stu_lens: 69.5000 | mixed_lens: 67.0000 | lr: 1.1931e-06 | scale: 512.00 | time: 30.043 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   3415/  5000| tot_loss: 3.2630 | rl_loss: 1.7426 | pt_loss: 1.5204 | pg_loss: 0.3867 | reg_loss: 1.3559 | reward: -0.5552 | rev_kl: 1.3468 | stu_lens: 121.0000 | mixed_lens: 81.5000 | lr: 1.1917e-06 | scale: 512.00 | time: 30.023 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   3416/  5000| tot_loss: 3.0078 | rl_loss: 0.8934 | pt_loss: 2.1143 | pg_loss: 0.0648 | reg_loss: 0.8287 | reward: -0.1464 | rev_kl: 1.2879 | stu_lens: 128.0000 | mixed_lens: 120.5000 | lr: 1.1903e-06 | scale: 512.00 | time: 30.025 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   3417/  5000| tot_loss: 2.1100 | rl_loss: 0.7454 | pt_loss: 1.3646 | pg_loss: 0.0307 | reg_loss: 0.7147 | reward: -0.1143 | rev_kl: 0.7668 | stu_lens: 128.0000 | mixed_lens: 124.0000 | lr: 1.1890e-06 | scale: 512.00 | time: 29.980 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   3418/  5000| tot_loss: 3.0060 | rl_loss: 1.1256 | pt_loss: 1.8804 | pg_loss: 0.0378 | reg_loss: 1.0878 | reward: -0.3948 | rev_kl: 1.1589 | stu_lens: 125.0000 | mixed_lens: 127.0000 | lr: 1.1876e-06 | scale: 512.00 | time: 34.912 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   3419/  5000| tot_loss: 3.2933 | rl_loss: 1.5523 | pt_loss: 1.7409 | pg_loss: 0.1706 | reg_loss: 1.3817 | reward: -0.4126 | rev_kl: 1.8514 | stu_lens: 107.0000 | mixed_lens: 99.5000 | lr: 1.1862e-06 | scale: 512.00 | time: 29.971 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   3420/  5000| tot_loss: 2.8539 | rl_loss: 1.2468 | pt_loss: 1.6071 | pg_loss: 0.2819 | reg_loss: 0.9649 | reward: -0.3375 | rev_kl: 0.7443 | stu_lens: 94.0000 | mixed_lens: 79.5000 | lr: 1.1849e-06 | scale: 512.00 | time: 29.979 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   3421/  5000| tot_loss: 3.2754 | rl_loss: 1.7076 | pt_loss: 1.5678 | pg_loss: 0.5324 | reg_loss: 1.1751 | reward: -0.7649 | rev_kl: 0.9696 | stu_lens: 78.0000 | mixed_lens: 78.5000 | lr: 1.1835e-06 | scale: 512.00 | time: 30.002 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   3422/  5000| tot_loss: 2.3549 | rl_loss: 0.7644 | pt_loss: 1.5906 | pg_loss: 0.0318 | reg_loss: 0.7326 | reward: -0.2176 | rev_kl: 0.6262 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.1822e-06 | scale: 512.00 | time: 34.922 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   3423/  5000| tot_loss: 2.9089 | rl_loss: 1.2449 | pt_loss: 1.6640 | pg_loss: 0.2228 | reg_loss: 1.0222 | reward: -0.4375 | rev_kl: 1.0598 | stu_lens: 114.0000 | mixed_lens: 97.5000 | lr: 1.1808e-06 | scale: 512.00 | time: 30.043 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3424/  5000| tot_loss: 2.5248 | rl_loss: 1.2111 | pt_loss: 1.3137 | pg_loss: 0.2404 | reg_loss: 0.9707 | reward: -0.7502 | rev_kl: 0.8628 | stu_lens: 83.0000 | mixed_lens: 82.5000 | lr: 1.1794e-06 | scale: 512.00 | time: 30.014 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3424/  5000| tot_loss: 2.8869 | rl_loss: 1.2307 | pt_loss: 1.6561 | pg_loss: 0.2726 | reg_loss: 0.9581 | reward: -0.3399 | rev_kl: 1.1701 | stu_lens: 98.2500 | mixed_lens: 89.1562 | lr: 1.1794e-06 | scale: 512.00 | time: 30.014 | step time: 31.832
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   3425/  5000| tot_loss: 2.9013 | rl_loss: 1.2321 | pt_loss: 1.6693 | pg_loss: 0.2547 | reg_loss: 0.9774 | reward: -0.3206 | rev_kl: 1.0770 | stu_lens: 95.5000 | mixed_lens: 101.5000 | lr: 1.1781e-06 | scale: 512.00 | time: 29.970 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   3426/  5000| tot_loss: 2.6447 | rl_loss: 0.8703 | pt_loss: 1.7744 | pg_loss: 0.1300 | reg_loss: 0.7404 | reward: -0.2164 | rev_kl: 0.9885 | stu_lens: 100.5000 | mixed_lens: 103.0000 | lr: 1.1767e-06 | scale: 512.00 | time: 29.985 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   3427/  5000| tot_loss: 2.3190 | rl_loss: 0.9689 | pt_loss: 1.3501 | pg_loss: 0.3235 | reg_loss: 0.6454 | reward: -0.5115 | rev_kl: 1.1369 | stu_lens: 97.5000 | mixed_lens: 77.5000 | lr: 1.1754e-06 | scale: 512.00 | time: 29.959 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   3428/  5000| tot_loss: 2.4985 | rl_loss: 0.9739 | pt_loss: 1.5246 | pg_loss: 0.3089 | reg_loss: 0.6650 | reward: -0.4192 | rev_kl: 0.7959 | stu_lens: 64.0000 | mixed_lens: 69.5000 | lr: 1.1740e-06 | scale: 512.00 | time: 29.999 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   3429/  5000| tot_loss: 2.4559 | rl_loss: 0.9626 | pt_loss: 1.4932 | pg_loss: 0.5530 | reg_loss: 0.4096 | reward: -0.3879 | rev_kl: 0.5116 | stu_lens: 28.5000 | mixed_lens: 40.5000 | lr: 1.1726e-06 | scale: 512.00 | time: 30.001 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   3430/  5000| tot_loss: 2.8426 | rl_loss: 1.2925 | pt_loss: 1.5501 | pg_loss: 0.3932 | reg_loss: 0.8993 | reward: -0.0469 | rev_kl: 1.0314 | stu_lens: 102.5000 | mixed_lens: 79.5000 | lr: 1.1713e-06 | scale: 512.00 | time: 34.927 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   3431/  5000| tot_loss: 2.4424 | rl_loss: 0.9438 | pt_loss: 1.4986 | pg_loss: 0.1225 | reg_loss: 0.8214 | reward: -0.2510 | rev_kl: 1.3335 | stu_lens: 63.0000 | mixed_lens: 95.5000 | lr: 1.1699e-06 | scale: 512.00 | time: 30.000 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   3432/  5000| tot_loss: 2.6058 | rl_loss: 0.7605 | pt_loss: 1.8453 | pg_loss: 0.0299 | reg_loss: 0.7306 | reward: -0.1476 | rev_kl: 0.9560 | stu_lens: 123.0000 | mixed_lens: 124.0000 | lr: 1.1686e-06 | scale: 512.00 | time: 30.024 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   3433/  5000| tot_loss: 2.8048 | rl_loss: 1.0481 | pt_loss: 1.7567 | pg_loss: 0.1203 | reg_loss: 0.9278 | reward: -0.5408 | rev_kl: 1.6207 | stu_lens: 125.0000 | mixed_lens: 115.0000 | lr: 1.1672e-06 | scale: 512.00 | time: 29.967 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   3434/  5000| tot_loss: 3.2968 | rl_loss: 1.4980 | pt_loss: 1.7988 | pg_loss: 0.5424 | reg_loss: 0.9556 | reward: -0.7647 | rev_kl: 1.0643 | stu_lens: 78.0000 | mixed_lens: 78.5000 | lr: 1.1659e-06 | scale: 512.00 | time: 34.863 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   3435/  5000| tot_loss: 2.0544 | rl_loss: 0.9195 | pt_loss: 1.1349 | pg_loss: 0.2150 | reg_loss: 0.7045 | reward: -0.5533 | rev_kl: 1.3132 | stu_lens: 121.0000 | mixed_lens: 81.5000 | lr: 1.1645e-06 | scale: 512.00 | time: 29.960 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   3436/  5000| tot_loss: 2.3111 | rl_loss: 1.1533 | pt_loss: 1.1578 | pg_loss: 0.4087 | reg_loss: 0.7446 | reward: -0.2276 | rev_kl: 0.9924 | stu_lens: 78.0000 | mixed_lens: 51.0000 | lr: 1.1631e-06 | scale: 512.00 | time: 29.986 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   3437/  5000| tot_loss: 2.4464 | rl_loss: 0.7644 | pt_loss: 1.6820 | pg_loss: 0.0469 | reg_loss: 0.7174 | reward: -0.2483 | rev_kl: 1.1407 | stu_lens: 110.5000 | mixed_lens: 120.5000 | lr: 1.1618e-06 | scale: 512.00 | time: 30.020 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   3438/  5000| tot_loss: 2.7440 | rl_loss: 0.9621 | pt_loss: 1.7819 | pg_loss: 0.2319 | reg_loss: 0.7301 | reward: -0.2698 | rev_kl: 1.2018 | stu_lens: 107.0000 | mixed_lens: 99.5000 | lr: 1.1604e-06 | scale: 512.00 | time: 30.043 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   3439/  5000| tot_loss: 2.5360 | rl_loss: 0.8099 | pt_loss: 1.7261 | pg_loss: 0.2166 | reg_loss: 0.5934 | reward: -0.1689 | rev_kl: 0.7131 | stu_lens: 73.5000 | mixed_lens: 101.5000 | lr: 1.1591e-06 | scale: 512.00 | time: 30.004 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3440/  5000| tot_loss: 2.6339 | rl_loss: 1.0616 | pt_loss: 1.5723 | pg_loss: 0.3645 | reg_loss: 0.6972 | reward: -0.7877 | rev_kl: 2.0056 | stu_lens: 95.0000 | mixed_lens: 71.0000 | lr: 1.1577e-06 | scale: 512.00 | time: 30.000 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3440/  5000| tot_loss: 2.6713 | rl_loss: 0.9951 | pt_loss: 1.6763 | pg_loss: 0.2743 | reg_loss: 0.7208 | reward: -0.3308 | rev_kl: 1.1023 | stu_lens: 96.6875 | mixed_lens: 89.3125 | lr: 1.1577e-06 | scale: 512.00 | time: 30.000 | step time: 31.821
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   3441/  5000| tot_loss: 1.9434 | rl_loss: 0.4369 | pt_loss: 1.5065 | pg_loss: 0.0283 | reg_loss: 0.4086 | reward: -0.1823 | rev_kl: 0.6153 | stu_lens: 128.0000 | mixed_lens: 122.5000 | lr: 1.1564e-06 | scale: 512.00 | time: 29.970 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   3442/  5000| tot_loss: 2.5906 | rl_loss: 1.0822 | pt_loss: 1.5084 | pg_loss: 0.3446 | reg_loss: 0.7376 | reward: -0.5414 | rev_kl: 1.0965 | stu_lens: 111.0000 | mixed_lens: 74.5000 | lr: 1.1550e-06 | scale: 512.00 | time: 34.905 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   3443/  5000| tot_loss: 3.5172 | rl_loss: 1.6138 | pt_loss: 1.9034 | pg_loss: 0.7171 | reg_loss: 0.8967 | reward: -1.1347 | rev_kl: 0.8779 | stu_lens: 73.0000 | mixed_lens: 59.5000 | lr: 1.1537e-06 | scale: 512.00 | time: 30.020 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   3444/  5000| tot_loss: 2.4600 | rl_loss: 0.6592 | pt_loss: 1.8008 | pg_loss: 0.2906 | reg_loss: 0.3686 | reward: 0.1002 | rev_kl: 0.7193 | stu_lens: 90.5000 | mixed_lens: 90.5000 | lr: 1.1523e-06 | scale: 512.00 | time: 30.077 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   3445/  5000| tot_loss: 2.1523 | rl_loss: 0.4856 | pt_loss: 1.6667 | pg_loss: 0.0097 | reg_loss: 0.4760 | reward: -0.0807 | rev_kl: 1.0230 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.1510e-06 | scale: 512.00 | time: 30.018 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   3446/  5000| tot_loss: 2.6028 | rl_loss: 1.1965 | pt_loss: 1.4064 | pg_loss: 0.3897 | reg_loss: 0.8068 | reward: -0.8669 | rev_kl: 2.5677 | stu_lens: 101.5000 | mixed_lens: 65.0000 | lr: 1.1496e-06 | scale: 512.00 | time: 30.153 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   3447/  5000| tot_loss: 2.4938 | rl_loss: 0.7421 | pt_loss: 1.7517 | pg_loss: 0.1193 | reg_loss: 0.6228 | reward: -0.0155 | rev_kl: 0.8054 | stu_lens: 77.0000 | mixed_lens: 104.0000 | lr: 1.1483e-06 | scale: 512.00 | time: 29.996 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   3448/  5000| tot_loss: 2.1272 | rl_loss: 0.6059 | pt_loss: 1.5212 | pg_loss: -0.0084 | reg_loss: 0.6143 | reward: -0.2905 | rev_kl: 1.1873 | stu_lens: 114.5000 | mixed_lens: 128.0000 | lr: 1.1469e-06 | scale: 512.00 | time: 30.015 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   3449/  5000| tot_loss: 2.7768 | rl_loss: 0.8108 | pt_loss: 1.9660 | pg_loss: 0.2207 | reg_loss: 0.5901 | reward: -0.6618 | rev_kl: 1.1969 | stu_lens: 35.5000 | mixed_lens: 78.5000 | lr: 1.1456e-06 | scale: 512.00 | time: 29.973 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   3450/  5000| tot_loss: 2.3541 | rl_loss: 0.3773 | pt_loss: 1.9768 | pg_loss: -0.0124 | reg_loss: 0.3897 | reward: -0.3283 | rev_kl: 1.1174 | stu_lens: 110.5000 | mixed_lens: 128.0000 | lr: 1.1442e-06 | scale: 512.00 | time: 30.046 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   3451/  5000| tot_loss: 2.6572 | rl_loss: 1.0223 | pt_loss: 1.6349 | pg_loss: 0.4609 | reg_loss: 0.5613 | reward: 0.1354 | rev_kl: 1.1896 | stu_lens: 84.0000 | mixed_lens: 75.5000 | lr: 1.1429e-06 | scale: 512.00 | time: 30.012 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   3452/  5000| tot_loss: 2.4216 | rl_loss: 0.9690 | pt_loss: 1.4526 | pg_loss: 0.8856 | reg_loss: 0.0835 | reward: -0.5842 | rev_kl: 0.6669 | stu_lens: 22.5000 | mixed_lens: 21.0000 | lr: 1.1415e-06 | scale: 512.00 | time: 30.024 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   3453/  5000| tot_loss: 2.1185 | rl_loss: 0.9454 | pt_loss: 1.1731 | pg_loss: 0.2626 | reg_loss: 0.6828 | reward: -0.2494 | rev_kl: 1.0528 | stu_lens: 107.0000 | mixed_lens: 99.5000 | lr: 1.1402e-06 | scale: 512.00 | time: 30.109 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   3454/  5000| tot_loss: 2.5628 | rl_loss: 0.6208 | pt_loss: 1.9420 | pg_loss: 0.0694 | reg_loss: 0.5513 | reward: -0.2606 | rev_kl: 1.4499 | stu_lens: 98.5000 | mixed_lens: 116.0000 | lr: 1.1389e-06 | scale: 512.00 | time: 34.946 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   3455/  5000| tot_loss: 2.2336 | rl_loss: 0.8336 | pt_loss: 1.4000 | pg_loss: 0.3351 | reg_loss: 0.4985 | reward: -0.2889 | rev_kl: 0.3729 | stu_lens: 95.5000 | mixed_lens: 67.5000 | lr: 1.1375e-06 | scale: 512.00 | time: 30.027 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3456/  5000| tot_loss: 2.8452 | rl_loss: 1.0093 | pt_loss: 1.8359 | pg_loss: 0.3104 | reg_loss: 0.6989 | reward: -0.1554 | rev_kl: 0.8085 | stu_lens: 78.0000 | mixed_lens: 79.0000 | lr: 1.1362e-06 | scale: 512.00 | time: 30.019 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3456/  5000| tot_loss: 2.5558 | rl_loss: 0.8480 | pt_loss: 1.7078 | pg_loss: 0.2680 | reg_loss: 0.5800 | reward: -0.3689 | rev_kl: 1.1294 | stu_lens: 98.0000 | mixed_lens: 89.5938 | lr: 1.1362e-06 | scale: 512.00 | time: 30.019 | step time: 31.859
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   3457/  5000| tot_loss: 2.3813 | rl_loss: 0.5111 | pt_loss: 1.8702 | pg_loss: 0.0474 | reg_loss: 0.4638 | reward: -0.1704 | rev_kl: 2.0402 | stu_lens: 128.0000 | mixed_lens: 116.5000 | lr: 1.1348e-06 | scale: 512.00 | time: 29.999 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   3458/  5000| tot_loss: 4.1720 | rl_loss: 2.1878 | pt_loss: 1.9841 | pg_loss: 0.4892 | reg_loss: 1.6986 | reward: -0.5485 | rev_kl: 1.1190 | stu_lens: 113.0000 | mixed_lens: 76.0000 | lr: 1.1335e-06 | scale: 512.00 | time: 30.029 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   3459/  5000| tot_loss: 3.5981 | rl_loss: 1.6608 | pt_loss: 1.9373 | pg_loss: 0.0649 | reg_loss: 1.5959 | reward: -0.1282 | rev_kl: 1.2437 | stu_lens: 85.0000 | mixed_lens: 128.0000 | lr: 1.1321e-06 | scale: 512.00 | time: 29.994 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   3460/  5000| tot_loss: 3.5635 | rl_loss: 1.4249 | pt_loss: 2.1386 | pg_loss: 0.0409 | reg_loss: 1.3840 | reward: -0.1722 | rev_kl: 1.1636 | stu_lens: 81.5000 | mixed_lens: 128.0000 | lr: 1.1308e-06 | scale: 512.00 | time: 29.976 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   3461/  5000| tot_loss: 3.6986 | rl_loss: 2.0842 | pt_loss: 1.6144 | pg_loss: 0.4750 | reg_loss: 1.6092 | reward: -1.4531 | rev_kl: 0.9312 | stu_lens: 60.0000 | mixed_lens: 76.0000 | lr: 1.1295e-06 | scale: 512.00 | time: 30.068 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   3462/  5000| tot_loss: 3.0809 | rl_loss: 1.6663 | pt_loss: 1.4146 | pg_loss: 0.0987 | reg_loss: 1.5676 | reward: -0.4335 | rev_kl: 1.2055 | stu_lens: 119.0000 | mixed_lens: 121.5000 | lr: 1.1281e-06 | scale: 512.00 | time: 30.000 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   3463/  5000| tot_loss: 2.4906 | rl_loss: 1.3423 | pt_loss: 1.1483 | pg_loss: 0.3391 | reg_loss: 1.0032 | reward: -0.3058 | rev_kl: 0.9361 | stu_lens: 128.0000 | mixed_lens: 93.0000 | lr: 1.1268e-06 | scale: 512.00 | time: 34.900 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   3464/  5000| tot_loss: 3.5495 | rl_loss: 1.7957 | pt_loss: 1.7538 | pg_loss: 0.7132 | reg_loss: 1.0824 | reward: -0.8391 | rev_kl: 1.3724 | stu_lens: 88.0000 | mixed_lens: 69.5000 | lr: 1.1254e-06 | scale: 512.00 | time: 30.025 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   3465/  5000| tot_loss: 3.8421 | rl_loss: 1.9261 | pt_loss: 1.9160 | pg_loss: 0.8520 | reg_loss: 1.0741 | reward: -0.5689 | rev_kl: 1.2644 | stu_lens: 31.0000 | mixed_lens: 31.5000 | lr: 1.1241e-06 | scale: 512.00 | time: 30.225 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   3466/  5000| tot_loss: 3.3288 | rl_loss: 1.5996 | pt_loss: 1.7292 | pg_loss: 0.2901 | reg_loss: 1.3096 | reward: -0.2448 | rev_kl: 0.5997 | stu_lens: 95.5000 | mixed_lens: 88.5000 | lr: 1.1228e-06 | scale: 512.00 | time: 30.138 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   3467/  5000| tot_loss: 2.5738 | rl_loss: 1.1921 | pt_loss: 1.3816 | pg_loss: 0.2119 | reg_loss: 0.9802 | reward: -0.0772 | rev_kl: 0.6542 | stu_lens: 105.0000 | mixed_lens: 105.0000 | lr: 1.1214e-06 | scale: 512.00 | time: 30.156 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   3468/  5000| tot_loss: 3.8997 | rl_loss: 1.9617 | pt_loss: 1.9381 | pg_loss: 0.6650 | reg_loss: 1.2967 | reward: -0.6342 | rev_kl: 1.5595 | stu_lens: 32.5000 | mixed_lens: 51.5000 | lr: 1.1201e-06 | scale: 512.00 | time: 30.114 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   3469/  5000| tot_loss: 3.7141 | rl_loss: 1.5702 | pt_loss: 2.1439 | pg_loss: 0.0391 | reg_loss: 1.5311 | reward: -0.2912 | rev_kl: 1.0549 | stu_lens: 117.0000 | mixed_lens: 128.0000 | lr: 1.1187e-06 | scale: 512.00 | time: 30.139 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   3470/  5000| tot_loss: 4.0092 | rl_loss: 2.5077 | pt_loss: 1.5015 | pg_loss: 0.6487 | reg_loss: 1.8590 | reward: -0.8529 | rev_kl: 1.4172 | stu_lens: 68.5000 | mixed_lens: 54.5000 | lr: 1.1174e-06 | scale: 512.00 | time: 30.210 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   3471/  5000| tot_loss: 2.7999 | rl_loss: 1.2719 | pt_loss: 1.5280 | pg_loss: 0.0998 | reg_loss: 1.1722 | reward: -0.2429 | rev_kl: 1.0188 | stu_lens: 113.5000 | mixed_lens: 122.0000 | lr: 1.1161e-06 | scale: 512.00 | time: 35.086 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3472/  5000| tot_loss: 4.9744 | rl_loss: 3.3120 | pt_loss: 1.6624 | pg_loss: 1.3520 | reg_loss: 1.9600 | reward: -0.8522 | rev_kl: 0.5795 | stu_lens: 18.0000 | mixed_lens: 35.5000 | lr: 1.1147e-06 | scale: 512.00 | time: 30.217 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3472/  5000| tot_loss: 3.4723 | rl_loss: 1.7596 | pt_loss: 1.7127 | pg_loss: 0.4787 | reg_loss: 1.2809 | reward: -0.4248 | rev_kl: 1.0653 | stu_lens: 85.4531 | mixed_lens: 83.5625 | lr: 1.1147e-06 | scale: 512.00 | time: 30.217 | step time: 31.921
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   3473/  5000| tot_loss: 3.6885 | rl_loss: 1.7775 | pt_loss: 1.9110 | pg_loss: 0.6606 | reg_loss: 1.1169 | reward: -0.3297 | rev_kl: 1.1234 | stu_lens: 83.0000 | mixed_lens: 37.5000 | lr: 1.1134e-06 | scale: 512.00 | time: 30.172 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   3474/  5000| tot_loss: 4.2908 | rl_loss: 2.8008 | pt_loss: 1.4900 | pg_loss: 2.0969 | reg_loss: 0.7039 | reward: -1.1879 | rev_kl: 0.3821 | stu_lens: 14.0000 | mixed_lens: 14.5000 | lr: 1.1121e-06 | scale: 512.00 | time: 30.282 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   3475/  5000| tot_loss: 4.4366 | rl_loss: 2.5976 | pt_loss: 1.8391 | pg_loss: 1.1026 | reg_loss: 1.4950 | reward: -1.3435 | rev_kl: 1.5022 | stu_lens: 39.5000 | mixed_lens: 38.0000 | lr: 1.1107e-06 | scale: 512.00 | time: 30.238 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   3476/  5000| tot_loss: 3.2462 | rl_loss: 1.6277 | pt_loss: 1.6185 | pg_loss: 0.5464 | reg_loss: 1.0813 | reward: -0.8557 | rev_kl: 1.7558 | stu_lens: 45.0000 | mixed_lens: 57.0000 | lr: 1.1094e-06 | scale: 512.00 | time: 30.148 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   3477/  5000| tot_loss: 3.5024 | rl_loss: 1.5884 | pt_loss: 1.9139 | pg_loss: 0.2262 | reg_loss: 1.3622 | reward: -0.4650 | rev_kl: 1.1046 | stu_lens: 117.0000 | mixed_lens: 85.5000 | lr: 1.1081e-06 | scale: 512.00 | time: 30.184 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   3478/  5000| tot_loss: 2.8573 | rl_loss: 1.4699 | pt_loss: 1.3874 | pg_loss: 0.2199 | reg_loss: 1.2500 | reward: -0.2655 | rev_kl: 1.2984 | stu_lens: 100.0000 | mixed_lens: 71.5000 | lr: 1.1067e-06 | scale: 512.00 | time: 30.141 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   3479/  5000| tot_loss: 3.9471 | rl_loss: 2.4842 | pt_loss: 1.4629 | pg_loss: 1.9797 | reg_loss: 0.5045 | reward: -0.1105 | rev_kl: 0.7055 | stu_lens: 32.0000 | mixed_lens: 18.0000 | lr: 1.1054e-06 | scale: 512.00 | time: 35.087 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   3480/  5000| tot_loss: 3.2590 | rl_loss: 1.1851 | pt_loss: 2.0739 | pg_loss: 0.1119 | reg_loss: 1.0731 | reward: -0.0727 | rev_kl: 0.6710 | stu_lens: 90.5000 | mixed_lens: 113.0000 | lr: 1.1041e-06 | scale: 512.00 | time: 30.159 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   3481/  5000| tot_loss: 2.7099 | rl_loss: 0.9838 | pt_loss: 1.7261 | pg_loss: 0.1902 | reg_loss: 0.7937 | reward: 0.1772 | rev_kl: 1.1953 | stu_lens: 66.5000 | mixed_lens: 84.5000 | lr: 1.1028e-06 | scale: 512.00 | time: 30.216 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   3482/  5000| tot_loss: 3.4334 | rl_loss: 1.7522 | pt_loss: 1.6813 | pg_loss: 0.3656 | reg_loss: 1.3866 | reward: -0.2105 | rev_kl: 1.2383 | stu_lens: 86.5000 | mixed_lens: 86.5000 | lr: 1.1014e-06 | scale: 512.00 | time: 30.264 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   3483/  5000| tot_loss: 2.3215 | rl_loss: 0.8451 | pt_loss: 1.4764 | pg_loss: 0.1851 | reg_loss: 0.6599 | reward: -0.4695 | rev_kl: 1.2780 | stu_lens: 117.5000 | mixed_lens: 102.5000 | lr: 1.1001e-06 | scale: 512.00 | time: 30.178 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   3484/  5000| tot_loss: 3.6824 | rl_loss: 1.6602 | pt_loss: 2.0223 | pg_loss: 0.2762 | reg_loss: 1.3840 | reward: -0.3773 | rev_kl: 1.5220 | stu_lens: 30.5000 | mixed_lens: 91.5000 | lr: 1.0988e-06 | scale: 512.00 | time: 30.176 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   3485/  5000| tot_loss: 2.7319 | rl_loss: 1.0251 | pt_loss: 1.7068 | pg_loss: 0.1741 | reg_loss: 0.8511 | reward: 0.1009 | rev_kl: 1.0036 | stu_lens: 57.5000 | mixed_lens: 86.5000 | lr: 1.0974e-06 | scale: 512.00 | time: 30.159 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   3486/  5000| tot_loss: 2.3691 | rl_loss: 1.0009 | pt_loss: 1.3682 | pg_loss: 0.0079 | reg_loss: 0.9930 | reward: -0.2930 | rev_kl: 1.2668 | stu_lens: 92.0000 | mixed_lens: 128.0000 | lr: 1.0961e-06 | scale: 512.00 | time: 30.144 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   3487/  5000| tot_loss: 4.0209 | rl_loss: 1.4677 | pt_loss: 2.5532 | pg_loss: 0.3998 | reg_loss: 1.0679 | reward: -0.5834 | rev_kl: 1.2007 | stu_lens: 89.0000 | mixed_lens: 78.0000 | lr: 1.0948e-06 | scale: 512.00 | time: 35.109 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3488/  5000| tot_loss: 2.7681 | rl_loss: 1.0787 | pt_loss: 1.6894 | pg_loss: 0.0005 | reg_loss: 1.0782 | reward: -0.2394 | rev_kl: 1.1741 | stu_lens: 115.5000 | mixed_lens: 128.0000 | lr: 1.0935e-06 | scale: 512.00 | time: 30.162 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3488/  5000| tot_loss: 3.0936 | rl_loss: 1.3884 | pt_loss: 1.7052 | pg_loss: 0.3977 | reg_loss: 0.9906 | reward: -0.3932 | rev_kl: 1.0238 | stu_lens: 81.8438 | mixed_lens: 75.8125 | lr: 1.0935e-06 | scale: 512.00 | time: 30.162 | step time: 32.015
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   3489/  5000| tot_loss: 3.3028 | rl_loss: 1.3707 | pt_loss: 1.9322 | pg_loss: 0.1139 | reg_loss: 1.2567 | reward: -0.1650 | rev_kl: 0.4120 | stu_lens: 63.0000 | mixed_lens: 83.5000 | lr: 1.0921e-06 | scale: 512.00 | time: 30.162 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   3490/  5000| tot_loss: 2.7568 | rl_loss: 1.3070 | pt_loss: 1.4498 | pg_loss: 0.4700 | reg_loss: 0.8370 | reward: -0.1648 | rev_kl: 1.0634 | stu_lens: 104.5000 | mixed_lens: 72.5000 | lr: 1.0908e-06 | scale: 512.00 | time: 30.182 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   3491/  5000| tot_loss: 2.5893 | rl_loss: 0.7945 | pt_loss: 1.7948 | pg_loss: 0.1130 | reg_loss: 0.6814 | reward: -0.0550 | rev_kl: 1.1953 | stu_lens: 113.5000 | mixed_lens: 106.5000 | lr: 1.0895e-06 | scale: 512.00 | time: 35.216 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   3492/  5000| tot_loss: 2.7469 | rl_loss: 0.8942 | pt_loss: 1.8526 | pg_loss: 0.1964 | reg_loss: 0.6979 | reward: -0.1357 | rev_kl: 0.5960 | stu_lens: 90.5000 | mixed_lens: 98.5000 | lr: 1.0882e-06 | scale: 512.00 | time: 30.273 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   3493/  5000| tot_loss: 2.5886 | rl_loss: 1.1873 | pt_loss: 1.4013 | pg_loss: 0.6283 | reg_loss: 0.5590 | reward: -0.2479 | rev_kl: 0.9094 | stu_lens: 48.5000 | mixed_lens: 40.0000 | lr: 1.0868e-06 | scale: 512.00 | time: 30.238 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   3494/  5000| tot_loss: 3.2106 | rl_loss: 1.0351 | pt_loss: 2.1755 | pg_loss: -0.0230 | reg_loss: 1.0581 | reward: -0.3723 | rev_kl: 1.0474 | stu_lens: 117.0000 | mixed_lens: 128.0000 | lr: 1.0855e-06 | scale: 512.00 | time: 30.232 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   3495/  5000| tot_loss: 2.4223 | rl_loss: 1.0373 | pt_loss: 1.3850 | pg_loss: 0.1939 | reg_loss: 0.8434 | reward: -0.4457 | rev_kl: 1.6457 | stu_lens: 53.5000 | mixed_lens: 90.0000 | lr: 1.0842e-06 | scale: 512.00 | time: 30.562 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   3496/  5000| tot_loss: 2.3827 | rl_loss: 0.9161 | pt_loss: 1.4666 | pg_loss: 0.0964 | reg_loss: 0.8197 | reward: -0.1939 | rev_kl: 0.6421 | stu_lens: 116.5000 | mixed_lens: 106.0000 | lr: 1.0829e-06 | scale: 512.00 | time: 30.231 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   3497/  5000| tot_loss: 2.3783 | rl_loss: 0.8504 | pt_loss: 1.5279 | pg_loss: 0.0020 | reg_loss: 0.8484 | reward: -0.2238 | rev_kl: 1.2120 | stu_lens: 99.0000 | mixed_lens: 128.0000 | lr: 1.0816e-06 | scale: 512.00 | time: 30.210 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   3498/  5000| tot_loss: 2.7852 | rl_loss: 1.1169 | pt_loss: 1.6682 | pg_loss: 0.2020 | reg_loss: 0.9149 | reward: -0.3497 | rev_kl: 1.0882 | stu_lens: 90.0000 | mixed_lens: 88.5000 | lr: 1.0802e-06 | scale: 512.00 | time: 30.182 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   3499/  5000| tot_loss: 2.6547 | rl_loss: 0.6391 | pt_loss: 2.0156 | pg_loss: -0.1786 | reg_loss: 0.8177 | reward: -0.3012 | rev_kl: 0.6253 | stu_lens: 53.0000 | mixed_lens: 14.0000 | lr: 1.0789e-06 | scale: 512.00 | time: 35.142 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/3500
                                 Evaluation #35                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Alice and Bob are stranded in the     │ Alice and Bob are stranded in the    │
│ desert. Alice is injured and cannot   │ desert. Alice is injured and cannot  │
│ walk. If Bob carries Alice to safety, │ walk. If Bob carries Alice to        │
│ they both stand a 31% chance of       │ safety, they both stand a 31% chance │
│ survival. But if Bob leaves Alice,    │ of survival. But if Bob leaves       │
│ his chances improve by 9%. Should Bob │ Alice, his chances improve by 9%.    │
│ leave Alice?                          │ Should Bob leave Alice?              │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Yes, Bob should leave Alice. His     │
│                                       │ chances of survival are 31% if he    │
│                                       │ stays with Alice, but 9% if he       │
│                                       │ leaves her behind.                   │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ whz does mz kezboard tzpe z instead   │ whz does mz kezboard tzpe z instead  │
│ of y and vice versa                   │ of y and vice versa                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ mz kezboard tzpe z instead of y and  │
│                                       │ vice versa is a typo. It should be   │
│                                       │ mz kezboard tzpe y instead of z and  │
│                                       │ vice versa.                          │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ How many languages do you support?    │ How many languages do you support?   │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ We support over 100 languages.       │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.876 | exact_match: 0.323 | rev_kl: 1.085 | lens: 85.538 | pt_loss: 1.071 | lm_loss: 1.152 | kd_loss: 0.991 
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   3500/  5000| tot_loss: 2.3906 | rl_loss: 1.0296 | pt_loss: 1.3610 | pg_loss: 0.5100 | reg_loss: 0.5196 | reward: -0.8066 | rev_kl: 0.7872 | stu_lens: 70.5000 | mixed_lens: 51.0000 | lr: 1.0776e-06 | scale: 512.00 | time: 30.221 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   3501/  5000| tot_loss: 3.1840 | rl_loss: 1.2659 | pt_loss: 1.9181 | pg_loss: 0.4046 | reg_loss: 0.8613 | reward: -0.2986 | rev_kl: 1.0468 | stu_lens: 79.5000 | mixed_lens: 80.0000 | lr: 1.0763e-06 | scale: 512.00 | time: 35.158 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   3502/  5000| tot_loss: 3.1093 | rl_loss: 1.3409 | pt_loss: 1.7684 | pg_loss: 0.6529 | reg_loss: 0.6881 | reward: -0.3314 | rev_kl: 0.7413 | stu_lens: 29.0000 | mixed_lens: 65.0000 | lr: 1.0750e-06 | scale: 512.00 | time: 30.185 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   3503/  5000| tot_loss: 2.6441 | rl_loss: 1.0228 | pt_loss: 1.6214 | pg_loss: 0.3964 | reg_loss: 0.6263 | reward: 0.2490 | rev_kl: 0.6205 | stu_lens: 75.0000 | mixed_lens: 69.5000 | lr: 1.0737e-06 | scale: 512.00 | time: 30.147 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3504/  5000| tot_loss: 3.2429 | rl_loss: 1.6196 | pt_loss: 1.6233 | pg_loss: 0.9822 | reg_loss: 0.6375 | reward: -1.2040 | rev_kl: 1.6232 | stu_lens: 20.5000 | mixed_lens: 43.5000 | lr: 1.0723e-06 | scale: 512.00 | time: 30.165 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3504/  5000| tot_loss: 2.8265 | rl_loss: 1.1732 | pt_loss: 1.6533 | pg_loss: 0.4135 | reg_loss: 0.7597 | reward: -0.4286 | rev_kl: 0.9859 | stu_lens: 79.9062 | mixed_lens: 77.7344 | lr: 1.0723e-06 | scale: 512.00 | time: 30.165 | step time: 32.371
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   3505/  5000| tot_loss: 2.3041 | rl_loss: 0.7869 | pt_loss: 1.5172 | pg_loss: 0.1313 | reg_loss: 0.6556 | reward: -0.3634 | rev_kl: 1.3934 | stu_lens: 102.0000 | mixed_lens: 108.0000 | lr: 1.0710e-06 | scale: 512.00 | time: 30.150 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   3506/  5000| tot_loss: 2.8648 | rl_loss: 1.3232 | pt_loss: 1.5417 | pg_loss: 0.3872 | reg_loss: 0.9359 | reward: -0.0875 | rev_kl: 0.6149 | stu_lens: 55.0000 | mixed_lens: 66.0000 | lr: 1.0697e-06 | scale: 512.00 | time: 30.241 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   3507/  5000| tot_loss: 2.6735 | rl_loss: 0.7186 | pt_loss: 1.9549 | pg_loss: 0.1397 | reg_loss: 0.5789 | reward: -0.3851 | rev_kl: 1.1929 | stu_lens: 99.0000 | mixed_lens: 85.5000 | lr: 1.0684e-06 | scale: 512.00 | time: 30.256 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   3508/  5000| tot_loss: 2.4735 | rl_loss: 0.5346 | pt_loss: 1.9389 | pg_loss: 0.1982 | reg_loss: 0.3364 | reward: -0.2748 | rev_kl: 0.7280 | stu_lens: 128.0000 | mixed_lens: 88.0000 | lr: 1.0671e-06 | scale: 512.00 | time: 30.192 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   3509/  5000| tot_loss: 2.1189 | rl_loss: 0.8047 | pt_loss: 1.3142 | pg_loss: -0.0042 | reg_loss: 0.8089 | reward: -0.1469 | rev_kl: 1.6256 | stu_lens: 84.0000 | mixed_lens: 128.0000 | lr: 1.0658e-06 | scale: 512.00 | time: 30.141 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   3510/  5000| tot_loss: 2.7376 | rl_loss: 0.8990 | pt_loss: 1.8386 | pg_loss: 0.1985 | reg_loss: 0.7006 | reward: -0.1602 | rev_kl: 0.8222 | stu_lens: 73.5000 | mixed_lens: 102.0000 | lr: 1.0645e-06 | scale: 512.00 | time: 35.130 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   3511/  5000| tot_loss: 2.9778 | rl_loss: 1.6871 | pt_loss: 1.2907 | pg_loss: 0.8216 | reg_loss: 0.8655 | reward: -0.8433 | rev_kl: 0.6831 | stu_lens: 74.5000 | mixed_lens: 54.5000 | lr: 1.0631e-06 | scale: 512.00 | time: 30.177 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   3512/  5000| tot_loss: 2.4255 | rl_loss: 0.7345 | pt_loss: 1.6910 | pg_loss: 0.2250 | reg_loss: 0.5095 | reward: -0.4209 | rev_kl: 0.7144 | stu_lens: 124.5000 | mixed_lens: 98.5000 | lr: 1.0618e-06 | scale: 512.00 | time: 30.235 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   3513/  5000| tot_loss: 2.0774 | rl_loss: 0.8296 | pt_loss: 1.2479 | pg_loss: 0.4915 | reg_loss: 0.3381 | reward: -0.8526 | rev_kl: 1.2294 | stu_lens: 72.5000 | mixed_lens: 53.5000 | lr: 1.0605e-06 | scale: 512.00 | time: 30.147 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   3514/  5000| tot_loss: 2.4607 | rl_loss: 0.5661 | pt_loss: 1.8946 | pg_loss: 0.3872 | reg_loss: 0.1789 | reward: -0.1605 | rev_kl: 0.2892 | stu_lens: 65.0000 | mixed_lens: 65.0000 | lr: 1.0592e-06 | scale: 512.00 | time: 35.062 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   3515/  5000| tot_loss: 2.1918 | rl_loss: 0.9493 | pt_loss: 1.2425 | pg_loss: 0.4088 | reg_loss: 0.5405 | reward: -0.1103 | rev_kl: 0.6967 | stu_lens: 98.5000 | mixed_lens: 76.0000 | lr: 1.0579e-06 | scale: 512.00 | time: 30.094 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   3516/  5000| tot_loss: 2.7076 | rl_loss: 0.6969 | pt_loss: 2.0107 | pg_loss: 0.2275 | reg_loss: 0.4694 | reward: 0.1212 | rev_kl: 1.1364 | stu_lens: 39.0000 | mixed_lens: 84.5000 | lr: 1.0566e-06 | scale: 512.00 | time: 30.195 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   3517/  5000| tot_loss: 2.8463 | rl_loss: 1.0267 | pt_loss: 1.8196 | pg_loss: 0.2944 | reg_loss: 0.7323 | reward: -0.4011 | rev_kl: 1.3495 | stu_lens: 91.0000 | mixed_lens: 73.0000 | lr: 1.0553e-06 | scale: 512.00 | time: 30.168 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   3518/  5000| tot_loss: 2.3866 | rl_loss: 1.1153 | pt_loss: 1.2713 | pg_loss: 0.4161 | reg_loss: 0.6992 | reward: -0.1700 | rev_kl: 1.2687 | stu_lens: 77.5000 | mixed_lens: 80.0000 | lr: 1.0540e-06 | scale: 512.00 | time: 35.034 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   3519/  5000| tot_loss: 4.7658 | rl_loss: 3.2206 | pt_loss: 1.5452 | pg_loss: 2.0051 | reg_loss: 1.2155 | reward: -2.2797 | rev_kl: 0.6127 | stu_lens: 31.5000 | mixed_lens: 17.0000 | lr: 1.0527e-06 | scale: 512.00 | time: 30.234 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3520/  5000| tot_loss: 4.2519 | rl_loss: 2.6401 | pt_loss: 1.6119 | pg_loss: 2.0995 | reg_loss: 0.5405 | reward: -1.1879 | rev_kl: 0.3821 | stu_lens: 14.0000 | mixed_lens: 14.5000 | lr: 1.0514e-06 | scale: 512.00 | time: 30.255 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3520/  5000| tot_loss: 2.6728 | rl_loss: 1.0396 | pt_loss: 1.6332 | pg_loss: 0.4088 | reg_loss: 0.6308 | reward: -0.4012 | rev_kl: 1.0417 | stu_lens: 83.5312 | mixed_lens: 81.2031 | lr: 1.0514e-06 | scale: 512.00 | time: 30.255 | step time: 32.318
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   3521/  5000| tot_loss: 3.5526 | rl_loss: 1.4067 | pt_loss: 2.1459 | pg_loss: 0.9019 | reg_loss: 0.5048 | reward: -0.7230 | rev_kl: 1.0567 | stu_lens: 69.0000 | mixed_lens: 47.0000 | lr: 1.0501e-06 | scale: 512.00 | time: 30.223 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   3522/  5000| tot_loss: 2.9424 | rl_loss: 1.4072 | pt_loss: 1.5352 | pg_loss: 0.1570 | reg_loss: 1.2502 | reward: -0.1371 | rev_kl: 0.4031 | stu_lens: 80.0000 | mixed_lens: 74.5000 | lr: 1.0488e-06 | scale: 512.00 | time: 30.232 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   3523/  5000| tot_loss: 3.4991 | rl_loss: 1.8570 | pt_loss: 1.6421 | pg_loss: 0.6593 | reg_loss: 1.1976 | reward: -0.6332 | rev_kl: 2.7737 | stu_lens: 66.0000 | mixed_lens: 67.5000 | lr: 1.0474e-06 | scale: 512.00 | time: 30.206 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   3524/  5000| tot_loss: 3.1621 | rl_loss: 1.1041 | pt_loss: 2.0580 | pg_loss: 0.2918 | reg_loss: 0.8123 | reward: -0.0953 | rev_kl: 1.1019 | stu_lens: 91.5000 | mixed_lens: 95.0000 | lr: 1.0461e-06 | scale: 512.00 | time: 30.286 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   3525/  5000| tot_loss: 3.7717 | rl_loss: 2.2723 | pt_loss: 1.4994 | pg_loss: 0.5783 | reg_loss: 1.6939 | reward: -0.4846 | rev_kl: 1.2089 | stu_lens: 73.5000 | mixed_lens: 54.0000 | lr: 1.0448e-06 | scale: 512.00 | time: 30.214 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   3526/  5000| tot_loss: 2.2246 | rl_loss: 0.7423 | pt_loss: 1.4822 | pg_loss: 0.0345 | reg_loss: 0.7078 | reward: -0.1110 | rev_kl: 1.1495 | stu_lens: 124.0000 | mixed_lens: 128.0000 | lr: 1.0435e-06 | scale: 512.00 | time: 30.251 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   3527/  5000| tot_loss: 3.0746 | rl_loss: 1.6603 | pt_loss: 1.4143 | pg_loss: 0.1124 | reg_loss: 1.5479 | reward: -0.2865 | rev_kl: 1.4331 | stu_lens: 107.0000 | mixed_lens: 114.0000 | lr: 1.0422e-06 | scale: 512.00 | time: 30.275 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   3528/  5000| tot_loss: 3.2490 | rl_loss: 1.5888 | pt_loss: 1.6602 | pg_loss: 0.1267 | reg_loss: 1.4621 | reward: -0.1834 | rev_kl: 0.9208 | stu_lens: 128.0000 | mixed_lens: 119.0000 | lr: 1.0409e-06 | scale: 512.00 | time: 30.240 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   3529/  5000| tot_loss: 3.7390 | rl_loss: 1.8088 | pt_loss: 1.9301 | pg_loss: 0.3727 | reg_loss: 1.4361 | reward: -0.4413 | rev_kl: 1.3405 | stu_lens: 93.5000 | mixed_lens: 85.0000 | lr: 1.0396e-06 | scale: 512.00 | time: 30.174 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   3530/  5000| tot_loss: 3.0504 | rl_loss: 1.3332 | pt_loss: 1.7172 | pg_loss: 0.1565 | reg_loss: 1.1768 | reward: 0.0999 | rev_kl: 0.9336 | stu_lens: 98.0000 | mixed_lens: 99.0000 | lr: 1.0383e-06 | scale: 512.00 | time: 30.195 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   3531/  5000| tot_loss: 2.8081 | rl_loss: 1.3749 | pt_loss: 1.4332 | pg_loss: 0.0693 | reg_loss: 1.3055 | reward: -0.2020 | rev_kl: 1.1124 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.0370e-06 | scale: 512.00 | time: 30.186 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   3532/  5000| tot_loss: 3.0960 | rl_loss: 1.5815 | pt_loss: 1.5145 | pg_loss: 0.2868 | reg_loss: 1.2946 | reward: -1.8409 | rev_kl: 0.9957 | stu_lens: 31.0000 | mixed_lens: 18.0000 | lr: 1.0357e-06 | scale: 512.00 | time: 30.272 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   3533/  5000| tot_loss: 2.8247 | rl_loss: 1.4981 | pt_loss: 1.3266 | pg_loss: 0.3302 | reg_loss: 1.1679 | reward: -1.0373 | rev_kl: 0.9359 | stu_lens: 87.0000 | mixed_lens: 78.0000 | lr: 1.0344e-06 | scale: 512.00 | time: 30.294 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   3534/  5000| tot_loss: 3.2146 | rl_loss: 1.2983 | pt_loss: 1.9163 | pg_loss: 0.2352 | reg_loss: 1.0632 | reward: -0.2738 | rev_kl: 0.5941 | stu_lens: 116.5000 | mixed_lens: 101.0000 | lr: 1.0331e-06 | scale: 512.00 | time: 30.275 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   3535/  5000| tot_loss: 3.4899 | rl_loss: 1.6634 | pt_loss: 1.8265 | pg_loss: 0.2621 | reg_loss: 1.4013 | reward: -0.4009 | rev_kl: 1.2936 | stu_lens: 106.5000 | mixed_lens: 80.5000 | lr: 1.0318e-06 | scale: 512.00 | time: 35.003 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3536/  5000| tot_loss: 2.1998 | rl_loss: 0.2601 | pt_loss: 1.9397 | pg_loss: 0.0563 | reg_loss: 0.2037 | reward: 2.4272 | rev_kl: 0.9263 | stu_lens: 67.0000 | mixed_lens: 65.0000 | lr: 1.0305e-06 | scale: 512.00 | time: 30.243 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3536/  5000| tot_loss: 3.2048 | rl_loss: 1.5123 | pt_loss: 1.6925 | pg_loss: 0.4035 | reg_loss: 1.1088 | reward: -0.2392 | rev_kl: 1.0496 | stu_lens: 83.8750 | mixed_lens: 81.8438 | lr: 1.0305e-06 | scale: 512.00 | time: 30.243 | step time: 31.750
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   3537/  5000| tot_loss: 2.1847 | rl_loss: 0.7565 | pt_loss: 1.4281 | pg_loss: 0.0490 | reg_loss: 0.7075 | reward: -0.0967 | rev_kl: 0.8104 | stu_lens: 107.0000 | mixed_lens: 128.0000 | lr: 1.0292e-06 | scale: 512.00 | time: 29.976 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   3538/  5000| tot_loss: 2.1920 | rl_loss: 0.8015 | pt_loss: 1.3905 | pg_loss: 0.2990 | reg_loss: 0.5025 | reward: -0.1942 | rev_kl: 0.5587 | stu_lens: 76.0000 | mixed_lens: 79.5000 | lr: 1.0279e-06 | scale: 512.00 | time: 30.248 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   3539/  5000| tot_loss: 3.2605 | rl_loss: 1.0451 | pt_loss: 2.2154 | pg_loss: 0.2932 | reg_loss: 0.7519 | reward: -0.3096 | rev_kl: 1.1578 | stu_lens: 115.5000 | mixed_lens: 92.0000 | lr: 1.0266e-06 | scale: 512.00 | time: 35.114 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   3540/  5000| tot_loss: 3.0346 | rl_loss: 1.0239 | pt_loss: 2.0107 | pg_loss: 0.0267 | reg_loss: 0.9972 | reward: -0.1754 | rev_kl: 1.2844 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.0254e-06 | scale: 512.00 | time: 30.223 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   3541/  5000| tot_loss: 2.2464 | rl_loss: 0.9900 | pt_loss: 1.2564 | pg_loss: 0.2710 | reg_loss: 0.7189 | reward: -0.4588 | rev_kl: 1.5926 | stu_lens: 87.0000 | mixed_lens: 92.0000 | lr: 1.0241e-06 | scale: 512.00 | time: 30.235 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   3542/  5000| tot_loss: 3.4141 | rl_loss: 1.2344 | pt_loss: 2.1796 | pg_loss: 0.2335 | reg_loss: 1.0009 | reward: -0.3429 | rev_kl: 1.3479 | stu_lens: 106.5000 | mixed_lens: 80.5000 | lr: 1.0228e-06 | scale: 512.00 | time: 30.203 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   3543/  5000| tot_loss: 3.2632 | rl_loss: 1.5511 | pt_loss: 1.7121 | pg_loss: 0.3858 | reg_loss: 1.1653 | reward: 1.4985 | rev_kl: 0.6222 | stu_lens: 50.0000 | mixed_lens: 61.0000 | lr: 1.0215e-06 | scale: 512.00 | time: 35.112 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   3544/  5000| tot_loss: 2.0162 | rl_loss: -0.0205 | pt_loss: 2.0367 | pg_loss: -0.8624 | reg_loss: 0.8418 | reward: 2.4408 | rev_kl: 0.6566 | stu_lens: 19.0000 | mixed_lens: 11.5000 | lr: 1.0202e-06 | scale: 512.00 | time: 30.242 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   3545/  5000| tot_loss: 2.7417 | rl_loss: 1.1430 | pt_loss: 1.5988 | pg_loss: 0.2557 | reg_loss: 0.8873 | reward: -0.1815 | rev_kl: 0.6074 | stu_lens: 42.0000 | mixed_lens: 43.5000 | lr: 1.0189e-06 | scale: 512.00 | time: 30.202 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   3546/  5000| tot_loss: 1.4327 | rl_loss: 0.6019 | pt_loss: 0.8308 | pg_loss: 0.1836 | reg_loss: 0.4182 | reward: -0.3642 | rev_kl: 0.6876 | stu_lens: 93.5000 | mixed_lens: 85.0000 | lr: 1.0176e-06 | scale: 512.00 | time: 30.207 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   3547/  5000| tot_loss: 2.9665 | rl_loss: 1.3953 | pt_loss: 1.5712 | pg_loss: 0.4517 | reg_loss: 0.9436 | reward: -0.9434 | rev_kl: 0.7824 | stu_lens: 43.5000 | mixed_lens: 43.0000 | lr: 1.0163e-06 | scale: 512.00 | time: 35.001 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   3548/  5000| tot_loss: 3.2838 | rl_loss: 1.1079 | pt_loss: 2.1759 | pg_loss: 0.2095 | reg_loss: 0.8984 | reward: -0.4354 | rev_kl: 1.1571 | stu_lens: 128.0000 | mixed_lens: 106.5000 | lr: 1.0150e-06 | scale: 512.00 | time: 30.168 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   3549/  5000| tot_loss: 3.0543 | rl_loss: 1.2523 | pt_loss: 1.8020 | pg_loss: 0.4806 | reg_loss: 0.7716 | reward: -0.4933 | rev_kl: 0.8574 | stu_lens: 29.5000 | mixed_lens: 61.0000 | lr: 1.0137e-06 | scale: 512.00 | time: 30.169 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   3550/  5000| tot_loss: 2.6213 | rl_loss: 1.1070 | pt_loss: 1.5143 | pg_loss: 0.7108 | reg_loss: 0.3962 | reward: 0.1005 | rev_kl: 0.9327 | stu_lens: 62.0000 | mixed_lens: 49.0000 | lr: 1.0124e-06 | scale: 512.00 | time: 30.148 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   3551/  5000| tot_loss: 2.2512 | rl_loss: 0.4747 | pt_loss: 1.7765 | pg_loss: 0.0399 | reg_loss: 0.4348 | reward: -0.0026 | rev_kl: 0.6088 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.0112e-06 | scale: 512.00 | time: 30.120 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3552/  5000| tot_loss: 2.3088 | rl_loss: 0.7096 | pt_loss: 1.5992 | pg_loss: 0.3428 | reg_loss: 0.3668 | reward: -1.1493 | rev_kl: 0.7085 | stu_lens: 33.0000 | mixed_lens: 31.5000 | lr: 1.0099e-06 | scale: 512.00 | time: 30.157 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3552/  5000| tot_loss: 2.7885 | rl_loss: 1.1047 | pt_loss: 1.6838 | pg_loss: 0.2717 | reg_loss: 0.8330 | reward: -0.2013 | rev_kl: 1.0103 | stu_lens: 81.9531 | mixed_lens: 84.5000 | lr: 1.0099e-06 | scale: 512.00 | time: 30.157 | step time: 32.310
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   3553/  5000| tot_loss: 3.4551 | rl_loss: 1.5183 | pt_loss: 1.9368 | pg_loss: 0.3666 | reg_loss: 1.1517 | reward: -0.4302 | rev_kl: 1.2116 | stu_lens: 67.0000 | mixed_lens: 81.5000 | lr: 1.0086e-06 | scale: 512.00 | time: 30.113 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   3554/  5000| tot_loss: 2.6761 | rl_loss: 0.6641 | pt_loss: 2.0120 | pg_loss: 0.0407 | reg_loss: 0.6235 | reward: -0.2800 | rev_kl: 0.8496 | stu_lens: 107.0000 | mixed_lens: 122.0000 | lr: 1.0073e-06 | scale: 512.00 | time: 30.114 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   3555/  5000| tot_loss: 3.0596 | rl_loss: 1.5790 | pt_loss: 1.4805 | pg_loss: 0.7963 | reg_loss: 0.7827 | reward: 1.7023 | rev_kl: 0.9404 | stu_lens: 34.5000 | mixed_lens: 34.0000 | lr: 1.0060e-06 | scale: 512.00 | time: 35.077 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   3556/  5000| tot_loss: 2.8815 | rl_loss: 1.1927 | pt_loss: 1.6888 | pg_loss: 0.3364 | reg_loss: 0.8563 | reward: -0.3249 | rev_kl: 1.0241 | stu_lens: 97.5000 | mixed_lens: 98.5000 | lr: 1.0047e-06 | scale: 512.00 | time: 30.128 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   3557/  5000| tot_loss: 2.3500 | rl_loss: 0.0758 | pt_loss: 2.2742 | pg_loss: -0.2765 | reg_loss: 0.3523 | reward: -0.3131 | rev_kl: 0.6015 | stu_lens: 58.5000 | mixed_lens: 27.0000 | lr: 1.0034e-06 | scale: 512.00 | time: 30.148 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   3558/  5000| tot_loss: 2.7405 | rl_loss: 0.9745 | pt_loss: 1.7660 | pg_loss: 0.3444 | reg_loss: 0.6301 | reward: -0.2556 | rev_kl: 0.9143 | stu_lens: 66.0000 | mixed_lens: 87.5000 | lr: 1.0022e-06 | scale: 512.00 | time: 30.128 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   3559/  5000| tot_loss: 2.7892 | rl_loss: 1.0505 | pt_loss: 1.7387 | pg_loss: 0.2200 | reg_loss: 0.8306 | reward: -0.2605 | rev_kl: 1.2670 | stu_lens: 116.5000 | mixed_lens: 101.0000 | lr: 1.0009e-06 | scale: 512.00 | time: 30.155 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   3560/  5000| tot_loss: 2.8260 | rl_loss: 1.1765 | pt_loss: 1.6496 | pg_loss: 0.3691 | reg_loss: 0.8073 | reward: -0.3626 | rev_kl: 0.4052 | stu_lens: 58.0000 | mixed_lens: 72.5000 | lr: 9.9959e-07 | scale: 512.00 | time: 30.094 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   3561/  5000| tot_loss: 2.8369 | rl_loss: 1.0187 | pt_loss: 1.8182 | pg_loss: 0.4699 | reg_loss: 0.5488 | reward: 2.2319 | rev_kl: 2.7402 | stu_lens: 42.0000 | mixed_lens: 40.5000 | lr: 9.9831e-07 | scale: 512.00 | time: 30.097 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   3562/  5000| tot_loss: 2.8965 | rl_loss: 1.2840 | pt_loss: 1.6125 | pg_loss: 0.4465 | reg_loss: 0.8376 | reward: -0.5642 | rev_kl: 1.2086 | stu_lens: 71.5000 | mixed_lens: 71.5000 | lr: 9.9703e-07 | scale: 512.00 | time: 30.084 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   3563/  5000| tot_loss: 2.1132 | rl_loss: 0.7480 | pt_loss: 1.3652 | pg_loss: 0.1364 | reg_loss: 0.6116 | reward: 0.0181 | rev_kl: 0.9477 | stu_lens: 98.0000 | mixed_lens: 99.0000 | lr: 9.9575e-07 | scale: 512.00 | time: 30.118 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   3564/  5000| tot_loss: 3.0793 | rl_loss: 1.1476 | pt_loss: 1.9317 | pg_loss: 0.2851 | reg_loss: 0.8625 | reward: -0.1509 | rev_kl: 0.6856 | stu_lens: 80.5000 | mixed_lens: 84.0000 | lr: 9.9447e-07 | scale: 512.00 | time: 30.235 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   3565/  5000| tot_loss: 2.4518 | rl_loss: 0.8393 | pt_loss: 1.6125 | pg_loss: 0.2683 | reg_loss: 0.5710 | reward: 0.1207 | rev_kl: 1.4199 | stu_lens: 100.5000 | mixed_lens: 87.5000 | lr: 9.9319e-07 | scale: 512.00 | time: 30.152 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   3566/  5000| tot_loss: 2.4044 | rl_loss: 0.9316 | pt_loss: 1.4729 | pg_loss: 0.1483 | reg_loss: 0.7833 | reward: -0.2927 | rev_kl: 1.1404 | stu_lens: 115.5000 | mixed_lens: 110.5000 | lr: 9.9191e-07 | scale: 512.00 | time: 30.144 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   3567/  5000| tot_loss: 2.2891 | rl_loss: 0.9628 | pt_loss: 1.3263 | pg_loss: 0.5742 | reg_loss: 0.3886 | reward: -1.0705 | rev_kl: 1.3744 | stu_lens: 64.0000 | mixed_lens: 68.0000 | lr: 9.9063e-07 | scale: 512.00 | time: 35.035 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3568/  5000| tot_loss: 2.6158 | rl_loss: 0.6525 | pt_loss: 1.9633 | pg_loss: 0.0450 | reg_loss: 0.6075 | reward: -0.1680 | rev_kl: 0.8145 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 9.8935e-07 | scale: 512.00 | time: 30.124 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3568/  5000| tot_loss: 2.6700 | rl_loss: 0.9711 | pt_loss: 1.6989 | pg_loss: 0.2686 | reg_loss: 0.7025 | reward: -0.2150 | rev_kl: 1.0734 | stu_lens: 84.0156 | mixed_lens: 86.6562 | lr: 9.8935e-07 | scale: 512.00 | time: 30.124 | step time: 31.961
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   3569/  5000| tot_loss: 2.4387 | rl_loss: 0.9751 | pt_loss: 1.4636 | pg_loss: 0.7231 | reg_loss: 0.2519 | reward: -0.3500 | rev_kl: 0.5991 | stu_lens: 76.0000 | mixed_lens: 57.5000 | lr: 9.8808e-07 | scale: 512.00 | time: 30.092 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   3570/  5000| tot_loss: 2.4177 | rl_loss: 0.9091 | pt_loss: 1.5085 | pg_loss: 0.0948 | reg_loss: 0.8143 | reward: -0.2791 | rev_kl: 0.9704 | stu_lens: 107.0000 | mixed_lens: 113.0000 | lr: 9.8680e-07 | scale: 512.00 | time: 30.060 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   3571/  5000| tot_loss: 2.6503 | rl_loss: 0.8102 | pt_loss: 1.8401 | pg_loss: 0.0792 | reg_loss: 0.7311 | reward: -0.2798 | rev_kl: 1.4106 | stu_lens: 128.0000 | mixed_lens: 121.0000 | lr: 9.8552e-07 | scale: 512.00 | time: 34.987 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   3572/  5000| tot_loss: 1.9571 | rl_loss: 0.5657 | pt_loss: 1.3914 | pg_loss: 0.0133 | reg_loss: 0.5523 | reward: -0.1034 | rev_kl: 1.4381 | stu_lens: 128.0000 | mixed_lens: 124.0000 | lr: 9.8425e-07 | scale: 512.00 | time: 30.082 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   3573/  5000| tot_loss: 1.8795 | rl_loss: 0.3199 | pt_loss: 1.5596 | pg_loss: 0.0320 | reg_loss: 0.2878 | reward: -0.0026 | rev_kl: 0.6088 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 9.8298e-07 | scale: 512.00 | time: 30.093 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   3574/  5000| tot_loss: 2.5463 | rl_loss: 0.5885 | pt_loss: 1.9578 | pg_loss: 0.0808 | reg_loss: 0.5077 | reward: -0.2915 | rev_kl: 1.4716 | stu_lens: 78.5000 | mixed_lens: 108.5000 | lr: 9.8170e-07 | scale: 512.00 | time: 30.134 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   3575/  5000| tot_loss: 2.0249 | rl_loss: 0.4121 | pt_loss: 1.6128 | pg_loss: 0.1586 | reg_loss: 0.2536 | reward: -0.3476 | rev_kl: 1.5040 | stu_lens: 102.5000 | mixed_lens: 80.5000 | lr: 9.8043e-07 | scale: 512.00 | time: 34.996 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   3576/  5000| tot_loss: 1.8132 | rl_loss: 0.4723 | pt_loss: 1.3409 | pg_loss: 0.0021 | reg_loss: 0.4702 | reward: -0.1845 | rev_kl: 0.7637 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 9.7916e-07 | scale: 512.00 | time: 30.155 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   3577/  5000| tot_loss: 2.0976 | rl_loss: 0.5871 | pt_loss: 1.5105 | pg_loss: 0.3551 | reg_loss: 0.2320 | reward: -1.0494 | rev_kl: 0.7780 | stu_lens: 68.0000 | mixed_lens: 68.0000 | lr: 9.7788e-07 | scale: 512.00 | time: 30.134 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   3578/  5000| tot_loss: 2.1870 | rl_loss: 0.8762 | pt_loss: 1.3108 | pg_loss: 0.3376 | reg_loss: 0.5386 | reward: 0.0389 | rev_kl: 1.4340 | stu_lens: 100.5000 | mixed_lens: 87.5000 | lr: 9.7661e-07 | scale: 512.00 | time: 30.146 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   3579/  5000| tot_loss: 2.3531 | rl_loss: 0.7906 | pt_loss: 1.5625 | pg_loss: 0.3795 | reg_loss: 0.4111 | reward: -0.5121 | rev_kl: 1.0066 | stu_lens: 71.5000 | mixed_lens: 71.5000 | lr: 9.7534e-07 | scale: 512.00 | time: 30.136 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   3580/  5000| tot_loss: 2.8873 | rl_loss: 1.0473 | pt_loss: 1.8400 | pg_loss: 0.2525 | reg_loss: 0.7948 | reward: 2.4375 | rev_kl: 1.2062 | stu_lens: 67.0000 | mixed_lens: 65.0000 | lr: 9.7407e-07 | scale: 512.00 | time: 30.103 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   3581/  5000| tot_loss: 3.0164 | rl_loss: 1.4035 | pt_loss: 1.6129 | pg_loss: 0.4101 | reg_loss: 0.9934 | reward: -0.3682 | rev_kl: 1.1906 | stu_lens: 104.0000 | mixed_lens: 83.5000 | lr: 9.7280e-07 | scale: 512.00 | time: 30.052 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   3582/  5000| tot_loss: 2.5427 | rl_loss: 0.9931 | pt_loss: 1.5496 | pg_loss: 0.4176 | reg_loss: 0.5755 | reward: -0.2466 | rev_kl: 0.6550 | stu_lens: 43.0000 | mixed_lens: 74.0000 | lr: 9.7153e-07 | scale: 512.00 | time: 30.137 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   3583/  5000| tot_loss: 2.6847 | rl_loss: 0.5598 | pt_loss: 2.1249 | pg_loss: 0.1796 | reg_loss: 0.3802 | reward: -0.1326 | rev_kl: 0.3870 | stu_lens: 89.5000 | mixed_lens: 89.5000 | lr: 9.7027e-07 | scale: 512.00 | time: 34.905 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3584/  5000| tot_loss: 2.6354 | rl_loss: 0.5935 | pt_loss: 2.0419 | pg_loss: 0.1580 | reg_loss: 0.4355 | reward: -0.1709 | rev_kl: 0.4990 | stu_lens: 80.5000 | mixed_lens: 93.0000 | lr: 9.6900e-07 | scale: 512.00 | time: 30.159 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3584/  5000| tot_loss: 2.4773 | rl_loss: 0.8147 | pt_loss: 1.6626 | pg_loss: 0.2527 | reg_loss: 0.5620 | reward: -0.1963 | rev_kl: 1.0217 | stu_lens: 84.4844 | mixed_lens: 83.6094 | lr: 9.6900e-07 | scale: 512.00 | time: 30.159 | step time: 32.237
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   3585/  5000| tot_loss: 2.9428 | rl_loss: 1.3017 | pt_loss: 1.6410 | pg_loss: 0.8080 | reg_loss: 0.4937 | reward: -0.2777 | rev_kl: 0.3834 | stu_lens: 44.5000 | mixed_lens: 60.5000 | lr: 9.6773e-07 | scale: 512.00 | time: 30.146 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   3586/  5000| tot_loss: 3.5653 | rl_loss: 1.7149 | pt_loss: 1.8505 | pg_loss: 0.3242 | reg_loss: 1.3906 | reward: -0.4855 | rev_kl: 0.7506 | stu_lens: 99.5000 | mixed_lens: 98.0000 | lr: 9.6647e-07 | scale: 512.00 | time: 30.108 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   3587/  5000| tot_loss: 3.2485 | rl_loss: 1.5521 | pt_loss: 1.6964 | pg_loss: 0.7248 | reg_loss: 0.8273 | reward: -0.1617 | rev_kl: 0.6213 | stu_lens: 58.0000 | mixed_lens: 52.0000 | lr: 9.6520e-07 | scale: 512.00 | time: 30.104 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   3588/  5000| tot_loss: 3.3076 | rl_loss: 1.4006 | pt_loss: 1.9071 | pg_loss: 0.2445 | reg_loss: 1.1561 | reward: -0.3836 | rev_kl: 1.3606 | stu_lens: 100.5000 | mixed_lens: 100.5000 | lr: 9.6394e-07 | scale: 512.00 | time: 30.180 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   3589/  5000| tot_loss: 2.4774 | rl_loss: 1.2748 | pt_loss: 1.2026 | pg_loss: 0.3566 | reg_loss: 0.9182 | reward: -0.2954 | rev_kl: 0.7537 | stu_lens: 68.0000 | mixed_lens: 67.5000 | lr: 9.6267e-07 | scale: 512.00 | time: 30.129 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   3590/  5000| tot_loss: 3.4557 | rl_loss: 1.4415 | pt_loss: 2.0142 | pg_loss: 0.1898 | reg_loss: 1.2517 | reward: -0.0701 | rev_kl: 2.5417 | stu_lens: 65.0000 | mixed_lens: 106.0000 | lr: 9.6141e-07 | scale: 512.00 | time: 30.143 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   3591/  5000| tot_loss: 3.9471 | rl_loss: 2.1897 | pt_loss: 1.7574 | pg_loss: 0.7492 | reg_loss: 1.4404 | reward: -0.5463 | rev_kl: 0.6963 | stu_lens: 47.0000 | mixed_lens: 58.5000 | lr: 9.6014e-07 | scale: 512.00 | time: 30.097 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   3592/  5000| tot_loss: 2.8854 | rl_loss: 1.2458 | pt_loss: 1.6396 | pg_loss: 0.2091 | reg_loss: 1.0367 | reward: -0.1240 | rev_kl: 1.4139 | stu_lens: 90.5000 | mixed_lens: 91.5000 | lr: 9.5888e-07 | scale: 512.00 | time: 30.101 | step time: 0.000
