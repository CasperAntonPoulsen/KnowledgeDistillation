Wed Dec 13 16:07:25 2023       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.104.12             Driver Version: 535.104.12   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA H100 PCIe               On  | 00000000:A1:00.0 Off |                    0 |
| N/A   25C    P0              46W / 350W |      4MiB / 81559MiB |      0%   E. Process |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
python3 -m torch.distributed.run --nproc_per_node 1 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 3013 /dtu/p1/johlau/LMOps/minillm/train_minillm.py --base-path /dtu/p1/johlau/LMOps/minillm --model-path /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_init/llama-7B --teacher-model-path /dtu/p1/johlau/LMOps/minillm/results/llama/train/sft/llama-13B --ckpt-name 7B-init --teacher-ckpt-name 13B-sft --n-gpu 1 --n-nodes 1 --model-type llama --teacher-model-fp16 --gradient-checkpointing --prompt-data-dir /dtu/p1/johlau/LMOps/minillm/processed_data/dolly_both/prompt/llama/ --lm-data-dir /dtu/p1/johlau/LMOps/minillm/processed_data/roberta_both/llama/256/20M/ --dev-num 1000 --num-workers 0 --epochs 10 --total-iters 1000 --kd-ratio 0.5 --batch-size 2 --eval-batch-size 4 --lr 5e-6 --lr-min 5e-6 --gradient-accumulation-steps 2 --max-length 256 --max-prompt-length 128 --warmup-iters 100 --scheduler-name cosine_trm --save /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/ --seed 10 --seed-ppo 42 --seed-lm 7 --save-interval 500 --eval-interval 100 --log-interval 16 --mid-log-num 1 --type minillm --ppo-epochs 4 --num-rollouts 64 --chunk-size 2 --length-norm --single-step-reg --teacher-mixed-alpha 0.2 --reward-scaling 0.5 --cliprange-reward 100 --do-sample --top-k 0 --top-p 1.0 --temperature 1.0 --deepspeed --deepspeed_config /dtu/p1/johlau/LMOps/minillm/configs/deepspeed/ds_config_zero2_offload.json /dtu/p1/johlau/LMOps/minillm 3013
PYTHONPATH=/dtu/p1/johlau/LMOps/minillm
[2023-12-13 16:07:30,754] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
using world size: 1
[2023-12-13 16:07:32,391] [INFO] [comm.py:637:init_distributed] cdb=None
[2023-12-13 16:07:32,391] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_path ................... /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_init/llama-7B
  ckpt_name .................... 7B-init
  model_type ................... llama
  teacher_model_type ........... None
  n_gpu ........................ 1
  n_nodes ...................... 1
  teacher_model_path ........... /dtu/p1/johlau/LMOps/minillm/results/llama/train/sft/llama-13B
  teacher_ckpt_name ............ 13B-sft
  teacher_model_fp16 ........... True
  model_parallel ............... False
  model_parallel_size .......... None
  no_value ..................... False
  dropout_path_rate ............ None
  fp32 ......................... False
  type ......................... minillm
  do_train ..................... False
  do_valid ..................... False
  do_eval ...................... False
  base_path .................... /dtu/p1/johlau/LMOps/minillm
  load ......................... None
  save ......................... /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
  log_interval ................. 16
  mid_log_num .................. 1
  save_interval ................ 500
  eval_interval ................ 100
  local_rank ................... 0
  save_additional_suffix ....... 
  save_rollout ................. False
  eb_sample_times .............. 3
  data_dir ..................... None
  processed_data_dir ........... None
  force_process ................ False
  force_process_demo ........... False
  data_process_workers ......... -1
  train_num .................... -1
  train_ratio .................. 1
  dev_num ...................... 1000
  dev_ratio .................... 1
  gen_num ...................... -1
  data_names ................... None
  prompt_type .................. None
  num_workers .................. 0
  max_prompt_length ............ 128
  min_prompt_length ............ 64
  json_data .................... False
  bin_data ..................... False
  txt_data ..................... False
  prompt_data_dir .............. /dtu/p1/johlau/LMOps/minillm/processed_data/dolly_both/prompt/llama/
  lm_data_dir .................. /dtu/p1/johlau/LMOps/minillm/processed_data/roberta_both/llama/256/20M/
  eval_ppl ..................... False
  eval_rw ...................... False
  eval_gen ..................... False
  only_prompt .................. False
  batch_size ................... 2
  eval_batch_size .............. 4
  clip_grad .................... 1.0
  total_iters .................. 1000
  train_iters_per_epoch ........ -1
  max_length ................... 256
  seed ......................... 10
  seed_order ................... 42
  seed_data .................... 42
  seed_ppo ..................... 42
  seed_lm ...................... 7
  epochs ....................... 10
  training_epochs .............. 10000
  gradient_accumulation_steps .. 2
  gradient_checkpointing ....... True
  attn_dtype ................... None
  lr ........................... 5e-06
  lr_min ....................... 5e-06
  weight_decay ................. 0.01
  loss_scale ................... 65536
  kd_ratio ..................... 0.5
  warmup_iters ................. 100
  lr_decay_iters ............... None
  lr_decay_style ............... noam
  scheduler_name ............... cosine_trm
  reward_scaling ............... 0.5
  cliprange_reward ............. 100.0
  ppo_epochs ................... 4
  num_rollouts ................. 64
  num_rollouts_per_device ...... 64
  cliprange .................... 0.2
  chunk_size ................... 2
  gamma ........................ 0.95
  length_norm .................. True
  single_step_reg .............. True
  teacher_mixed_alpha .......... 0.2
  lm_coef ...................... 1
  top_k ........................ 0
  top_p ........................ 1.0
  do_sample .................... True
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  num_beams .................... 1
  temperature .................. 1.0
  peft ......................... None
  peft_lora_r .................. 8
  peft_lora_alpha .............. 32
  peft_lora_dropout ............ 0.1
  peft_name .................... None
  peft_path .................... None
  teacher_peft_name ............ None
  teacher_peft_path ............ None
  deepspeed .................... True
  deepspeed_config ............. /dtu/p1/johlau/LMOps/minillm/configs/deepspeed/ds_config_zero2_offload.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  rank ......................... 0
  world_size ................... 1
 > number of parameters: 13015864320
 > number of parameters: 6738415616
Model load time: 7.814941883087158s
 > number of parameters: 6738M
[2023-12-13 16:07:54,644] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.12.1, git-hash=unknown, git-branch=unknown
[2023-12-13 16:07:55,619] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-12-13 16:07:55,620] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2023-12-13 16:07:55,620] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2023-12-13 16:07:55,635] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = AdamW
[2023-12-13 16:07:55,636] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=AdamW type=<class 'torch.optim.adamw.AdamW'>
[2023-12-13 16:07:55,636] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2023-12-13 16:07:55,636] [INFO] [stage_1_and_2.py:147:__init__] Reduce bucket size 200000000
[2023-12-13 16:07:55,636] [INFO] [stage_1_and_2.py:148:__init__] Allgather bucket size 200000000
[2023-12-13 16:07:55,636] [INFO] [stage_1_and_2.py:149:__init__] CPU Offload: True
[2023-12-13 16:07:55,636] [INFO] [stage_1_and_2.py:150:__init__] Round robin gradient partitioning: False
[2023-12-13 16:08:07,741] [INFO] [utils.py:802:see_memory_usage] Before initializing optimizer states
[2023-12-13 16:08:07,742] [INFO] [utils.py:803:see_memory_usage] MA 37.23 GB         Max_MA 37.23 GB         CA 37.23 GB         Max_CA 37 GB 
[2023-12-13 16:08:07,742] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 138.07 GB, percent = 18.3%
[2023-12-13 16:08:55,965] [INFO] [utils.py:802:see_memory_usage] After initializing optimizer states
[2023-12-13 16:08:55,966] [INFO] [utils.py:803:see_memory_usage] MA 37.23 GB         Max_MA 37.23 GB         CA 37.23 GB         Max_CA 37 GB 
[2023-12-13 16:08:55,966] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 214.02 GB, percent = 28.3%
[2023-12-13 16:08:55,967] [INFO] [stage_1_and_2.py:514:__init__] optimizer state initialized
[2023-12-13 16:08:56,058] [INFO] [utils.py:802:see_memory_usage] After initializing ZeRO optimizer
[2023-12-13 16:08:56,058] [INFO] [utils.py:803:see_memory_usage] MA 37.23 GB         Max_MA 37.23 GB         CA 37.23 GB         Max_CA 37 GB 
[2023-12-13 16:08:56,059] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 214.02 GB, percent = 28.3%
[2023-12-13 16:08:56,067] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = AdamW
[2023-12-13 16:08:56,067] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2023-12-13 16:08:56,067] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <torch.optim.lr_scheduler.LambdaLR object at 0x7f33dc1af520>
[2023-12-13 16:08:56,067] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0], mom=[[0.9, 0.95]]
[2023-12-13 16:08:56,068] [INFO] [config.py:972:print] DeepSpeedEngine configuration:
[2023-12-13 16:08:56,068] [INFO] [config.py:976:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-12-13 16:08:56,068] [INFO] [config.py:976:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-12-13 16:08:56,068] [INFO] [config.py:976:print]   amp_enabled .................. False
[2023-12-13 16:08:56,068] [INFO] [config.py:976:print]   amp_params ................... False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   bfloat16_enabled ............. False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   checkpoint_parallel_write_pipeline  False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   checkpoint_tag_validation_enabled  True
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   checkpoint_tag_validation_fail  False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f33dc1af490>
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   communication_data_type ...... None
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   curriculum_enabled_legacy .... False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   curriculum_params_legacy ..... False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   data_efficiency_enabled ...... False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   dataloader_drop_last ......... False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   disable_allgather ............ False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   dump_state ................... False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 5000, 'delayed_shift': 4, 'consecutive_hysteresis': False, 'min_scale': 1}
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   eigenvalue_enabled ........... False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   eigenvalue_gas_boundary_resolution  1
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   eigenvalue_layer_num ......... 0
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   eigenvalue_max_iter .......... 100
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   eigenvalue_stability ......... 1e-06
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   eigenvalue_tol ............... 0.01
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   eigenvalue_verbose ........... False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   elasticity_enabled ........... False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   fp16_auto_cast ............... False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   fp16_enabled ................. True
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   fp16_master_weights_and_gradients  False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   global_rank .................. 0
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   grad_accum_dtype ............. None
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   gradient_accumulation_steps .. 2
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   gradient_clipping ............ 1.0
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   gradient_predivide_factor .... 1.0
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   initial_dynamic_scale ........ 2048
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   load_universal_checkpoint .... False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   loss_scale ................... 0
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   memory_breakdown ............. False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   mics_hierarchial_params_gather  False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   mics_shard_size .............. -1
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   optimizer_legacy_fusion ...... False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   optimizer_name ............... None
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   optimizer_params ............. None
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   pld_enabled .................. False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   pld_params ................... False
[2023-12-13 16:08:56,069] [INFO] [config.py:976:print]   prescale_gradients ........... False
[2023-12-13 16:08:56,070] [INFO] [config.py:976:print]   scheduler_name ............... None
[2023-12-13 16:08:56,070] [INFO] [config.py:976:print]   scheduler_params ............. None
[2023-12-13 16:08:56,070] [INFO] [config.py:976:print]   seq_parallel_communication_data_type  torch.float32
[2023-12-13 16:08:56,070] [INFO] [config.py:976:print]   sparse_attention ............. None
[2023-12-13 16:08:56,070] [INFO] [config.py:976:print]   sparse_gradients_enabled ..... False
[2023-12-13 16:08:56,070] [INFO] [config.py:976:print]   steps_per_print .............. 10000000
[2023-12-13 16:08:56,070] [INFO] [config.py:976:print]   train_batch_size ............. 4
[2023-12-13 16:08:56,070] [INFO] [config.py:976:print]   train_micro_batch_size_per_gpu  2
[2023-12-13 16:08:56,070] [INFO] [config.py:976:print]   use_node_local_storage ....... False
[2023-12-13 16:08:56,070] [INFO] [config.py:976:print]   wall_clock_breakdown ......... False
[2023-12-13 16:08:56,070] [INFO] [config.py:976:print]   weight_quantization_config ... None
[2023-12-13 16:08:56,070] [INFO] [config.py:976:print]   world_size ................... 1
[2023-12-13 16:08:56,070] [INFO] [config.py:976:print]   zero_allow_untested_optimizer  True
[2023-12-13 16:08:56,070] [INFO] [config.py:976:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=DeepSpeedZeroOffloadOptimizerConfig(device='cpu', nvme_path=None, buffer_count=4, pin_memory=False, pipeline=False, pipeline_read=False, pipeline_write=False, fast_init=False) sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2023-12-13 16:08:56,070] [INFO] [config.py:976:print]   zero_enabled ................. True
[2023-12-13 16:08:56,070] [INFO] [config.py:976:print]   zero_force_ds_cpu_optimizer .. False
[2023-12-13 16:08:56,070] [INFO] [config.py:976:print]   zero_optimization_stage ...... 2
[2023-12-13 16:08:56,070] [INFO] [config.py:962:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 2, 
    "zero_optimization": {
        "stage": 2, 
        "offload_optimizer": {
            "device": "cpu"
        }, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true
    }, 
    "zero_force_ds_cpu_optimizer": false, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 5.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1.000000e+07
}
Probing Dataset
Probing end. Max data state 1, total length 36562
Num PPO instances: 36562
Probing Dataset
Probing end. Max data state 1, total length 968
Num PPO instances: 968
Probing Dataset
Probing end. Max data state 1, total length 20000000
Num LM instances: 20000000
Probing Dataset
Probing end. Max data state 1, total length 10000
Num LM instances: 10000
                                 Evaluation #0                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ It sounds boring, but this is        │
│                                       │ actually a question on a scientific  │
│                                       │ structured interview. The point      │
│                                       │ behind this question is to figure    │
│                                       │ out how you will react in those rare │
│                                       │ situations when you will experience  │
│                                       │ something new. Most people fall back │
│                                       │ to the safe zone, considering this   │
│                                       │ situation as a boring one, but       │
│                                       │ that's is not the best answer.       │
│                                       │ Instead answer with the one that     │
│                                       │ actually depicts what you will do    │
│                                       │ when that occurs.                    │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ You said what you do not to enjoy,   │
│                                       │ it seems that making something new   │
│                                       │ makes you depressed. But there are   │
│                                       │ always people who come up with great │
│                                       │ ideas, such as Steven Spielberg's    │
│                                       │ creation by combining parts of       │
│                                       │ Gremlins and Jaws or Adele Adkins is │
│                                       │ widely credited by the public for    │
│                                       │ being "the breaker of 2000/2010."    │
│                                       │                                      │
│                                       │ If you put yourself in a positive    │
│                                       │ head space and want to let yourself  │
│                                       │ feel relaxed and enthusiastic about  │
│                                       │ the project, sprinkle in these four  │
│                                       │ steps.                               │
│                                       │                                      │
│                                       │ First, you need to have a good       │
│                                       │ foundation of                        │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ I can help you in that.              │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 11.379 | exact_match: 0.103 | rev_kl: 1.932 | lens: 76.589 | pt_loss: 1.161 | lm_loss: 1.274 | kd_loss: 1.048 
Total Steps: 1000 Data Epochs: 10
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:      2/  1000| tot_loss: 3.9759 | rl_loss: 2.1047 | pt_loss: 1.8711 | pg_loss: 0.3036 | reg_loss: 1.8011 | reward: -0.4820 | rev_kl: 2.0385 | stu_lens: 66.0000 | mixed_lens: 106.5000 | lr: 5.0000e-08 | scale: 2048.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:      3/  1000| tot_loss: 3.9605 | rl_loss: 2.2314 | pt_loss: 1.7291 | pg_loss: 0.1326 | reg_loss: 2.0988 | reward: -1.9394 | rev_kl: 1.6580 | stu_lens: 39.5000 | mixed_lens: 15.5000 | lr: 1.0000e-07 | scale: 2048.00 | time: 26.642 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:      4/  1000| tot_loss: 3.2326 | rl_loss: 1.3657 | pt_loss: 1.8669 | pg_loss: 0.0401 | reg_loss: 1.3256 | reward: -0.3455 | rev_kl: 1.6920 | stu_lens: 122.0000 | mixed_lens: 128.0000 | lr: 1.5000e-07 | scale: 2048.00 | time: 26.651 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:      5/  1000| tot_loss: 3.6779 | rl_loss: 1.9798 | pt_loss: 1.6981 | pg_loss: 0.3928 | reg_loss: 1.5870 | reward: -0.4746 | rev_kl: 1.7700 | stu_lens: 81.5000 | mixed_lens: 88.0000 | lr: 2.0000e-07 | scale: 2048.00 | time: 26.655 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:      6/  1000| tot_loss: 3.5863 | rl_loss: 1.5702 | pt_loss: 2.0161 | pg_loss: 0.2766 | reg_loss: 1.2936 | reward: -6.4882 | rev_kl: 1.7520 | stu_lens: 31.5000 | mixed_lens: 66.0000 | lr: 2.5000e-07 | scale: 2048.00 | time: 26.598 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:      7/  1000| tot_loss: 4.7110 | rl_loss: 2.7204 | pt_loss: 1.9905 | pg_loss: 0.3403 | reg_loss: 2.3801 | reward: -0.6012 | rev_kl: 2.7109 | stu_lens: 77.0000 | mixed_lens: 101.0000 | lr: 3.0000e-07 | scale: 2048.00 | time: 26.645 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:      8/  1000| tot_loss: 6.9285 | rl_loss: 4.9442 | pt_loss: 1.9844 | pg_loss: 1.8140 | reg_loss: 3.1302 | reward: -4.6650 | rev_kl: 1.0152 | stu_lens: 50.0000 | mixed_lens: 24.5000 | lr: 3.5000e-07 | scale: 2048.00 | time: 26.579 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:      9/  1000| tot_loss: 5.9482 | rl_loss: 4.1043 | pt_loss: 1.8439 | pg_loss: 1.1780 | reg_loss: 2.9263 | reward: -3.2792 | rev_kl: 1.0944 | stu_lens: 12.5000 | mixed_lens: 30.5000 | lr: 4.0000e-07 | scale: 2048.00 | time: 26.683 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:     10/  1000| tot_loss: 3.7728 | rl_loss: 2.1392 | pt_loss: 1.6337 | pg_loss: 0.3052 | reg_loss: 1.8340 | reward: -0.7481 | rev_kl: 1.8829 | stu_lens: 43.5000 | mixed_lens: 88.0000 | lr: 4.5000e-07 | scale: 2048.00 | time: 26.621 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:     11/  1000| tot_loss: 7.1793 | rl_loss: 5.6493 | pt_loss: 1.5299 | pg_loss: 2.9390 | reg_loss: 2.7103 | reward: -1.4368 | rev_kl: 1.7042 | stu_lens: 8.5000 | mixed_lens: 8.5000 | lr: 5.0000e-07 | scale: 2048.00 | time: 26.635 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:     12/  1000| tot_loss: 4.2910 | rl_loss: 2.3168 | pt_loss: 1.9742 | pg_loss: 0.7207 | reg_loss: 1.5960 | reward: -0.2692 | rev_kl: 1.2351 | stu_lens: 20.5000 | mixed_lens: 65.5000 | lr: 5.5000e-07 | scale: 2048.00 | time: 26.603 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:     13/  1000| tot_loss: 3.6740 | rl_loss: 2.0140 | pt_loss: 1.6600 | pg_loss: 0.6224 | reg_loss: 1.3916 | reward: -0.9847 | rev_kl: 0.4495 | stu_lens: 39.0000 | mixed_lens: 76.5000 | lr: 6.0000e-07 | scale: 2048.00 | time: 26.670 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:     14/  1000| tot_loss: 4.3087 | rl_loss: 2.1786 | pt_loss: 2.1300 | pg_loss: 0.3165 | reg_loss: 1.8621 | reward: -0.6628 | rev_kl: 1.1501 | stu_lens: 90.0000 | mixed_lens: 96.5000 | lr: 6.5000e-07 | scale: 2048.00 | time: 26.588 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:     15/  1000| tot_loss: 3.8135 | rl_loss: 2.1221 | pt_loss: 1.6914 | pg_loss: 0.5718 | reg_loss: 1.5503 | reward: -0.2751 | rev_kl: 1.3768 | stu_lens: 35.0000 | mixed_lens: 72.5000 | lr: 7.0000e-07 | scale: 2048.00 | time: 26.635 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     16/  1000| tot_loss: 3.4175 | rl_loss: 2.0499 | pt_loss: 1.3676 | pg_loss: 0.5290 | reg_loss: 1.5209 | reward: 0.1896 | rev_kl: 1.6933 | stu_lens: 77.5000 | mixed_lens: 65.5000 | lr: 7.5000e-07 | scale: 2048.00 | time: 26.555 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     16/  1000| tot_loss: 4.0221 | rl_loss: 2.3603 | pt_loss: 1.6618 | pg_loss: 0.5974 | reg_loss: 1.7629 | reward: -1.1183 | rev_kl: 1.5840 | stu_lens: 64.0469 | mixed_lens: 68.1406 | lr: 7.5000e-07 | scale: 2048.00 | time: 26.555 | step time: 26.235
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:     17/  1000| tot_loss: 4.2858 | rl_loss: 2.6029 | pt_loss: 1.6830 | pg_loss: 0.4297 | reg_loss: 2.1731 | reward: -1.6248 | rev_kl: 2.6924 | stu_lens: 48.0000 | mixed_lens: 77.5000 | lr: 8.0000e-07 | scale: 2048.00 | time: 26.618 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:     18/  1000| tot_loss: 3.7247 | rl_loss: 2.3395 | pt_loss: 1.3852 | pg_loss: 0.7780 | reg_loss: 1.5615 | reward: -0.6861 | rev_kl: 1.2703 | stu_lens: 73.5000 | mixed_lens: 30.5000 | lr: 8.5000e-07 | scale: 2048.00 | time: 26.572 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:     19/  1000| tot_loss: 6.0031 | rl_loss: 4.1653 | pt_loss: 1.8378 | pg_loss: 2.3134 | reg_loss: 1.8519 | reward: -2.2836 | rev_kl: 2.4295 | stu_lens: 58.0000 | mixed_lens: 11.5000 | lr: 9.0000e-07 | scale: 2048.00 | time: 26.604 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:     20/  1000| tot_loss: 5.7042 | rl_loss: 3.8595 | pt_loss: 1.8447 | pg_loss: 0.7864 | reg_loss: 3.0731 | reward: -1.3777 | rev_kl: 1.6573 | stu_lens: 29.0000 | mixed_lens: 47.0000 | lr: 9.5000e-07 | scale: 2048.00 | time: 26.570 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:     21/  1000| tot_loss: 4.0547 | rl_loss: 1.9383 | pt_loss: 2.1164 | pg_loss: 0.4931 | reg_loss: 1.4452 | reward: -0.5707 | rev_kl: 1.3514 | stu_lens: 102.0000 | mixed_lens: 65.5000 | lr: 1.0000e-06 | scale: 2048.00 | time: 26.576 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:     22/  1000| tot_loss: 3.3259 | rl_loss: 1.7643 | pt_loss: 1.5617 | pg_loss: 0.2699 | reg_loss: 1.4943 | reward: -0.6289 | rev_kl: 1.4350 | stu_lens: 90.5000 | mixed_lens: 76.0000 | lr: 1.0500e-06 | scale: 2048.00 | time: 26.601 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:     23/  1000| tot_loss: 4.3559 | rl_loss: 2.8258 | pt_loss: 1.5301 | pg_loss: 1.2190 | reg_loss: 1.6068 | reward: -0.9662 | rev_kl: 1.0472 | stu_lens: 8.0000 | mixed_lens: 40.0000 | lr: 1.1000e-06 | scale: 2048.00 | time: 26.616 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:     24/  1000| tot_loss: 3.5836 | rl_loss: 2.0389 | pt_loss: 1.5447 | pg_loss: 0.5798 | reg_loss: 1.4591 | reward: -0.4580 | rev_kl: 2.3014 | stu_lens: 61.5000 | mixed_lens: 68.0000 | lr: 1.1500e-06 | scale: 2048.00 | time: 26.570 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:     25/  1000| tot_loss: 4.5659 | rl_loss: 2.7337 | pt_loss: 1.8321 | pg_loss: 0.6184 | reg_loss: 2.1153 | reward: -1.6362 | rev_kl: 2.6902 | stu_lens: 65.5000 | mixed_lens: 63.0000 | lr: 1.2000e-06 | scale: 2048.00 | time: 26.610 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:     26/  1000| tot_loss: 3.7811 | rl_loss: 1.9251 | pt_loss: 1.8561 | pg_loss: 0.2440 | reg_loss: 1.6810 | reward: -0.6858 | rev_kl: 1.2990 | stu_lens: 109.0000 | mixed_lens: 103.5000 | lr: 1.2500e-06 | scale: 2048.00 | time: 26.561 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:     27/  1000| tot_loss: 3.3033 | rl_loss: 1.5017 | pt_loss: 1.8016 | pg_loss: 0.2606 | reg_loss: 1.2410 | reward: -0.5660 | rev_kl: 1.8400 | stu_lens: 75.5000 | mixed_lens: 88.0000 | lr: 1.3000e-06 | scale: 2048.00 | time: 26.569 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:     28/  1000| tot_loss: 2.9776 | rl_loss: 1.5917 | pt_loss: 1.3860 | pg_loss: 0.4227 | reg_loss: 1.1690 | reward: -0.3823 | rev_kl: 1.4500 | stu_lens: 84.0000 | mixed_lens: 72.5000 | lr: 1.3500e-06 | scale: 2048.00 | time: 26.532 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:     29/  1000| tot_loss: 3.3349 | rl_loss: 1.8141 | pt_loss: 1.5208 | pg_loss: 0.5143 | reg_loss: 1.2998 | reward: -2.6630 | rev_kl: 1.4823 | stu_lens: 22.5000 | mixed_lens: 48.5000 | lr: 1.4000e-06 | scale: 2048.00 | time: 26.587 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:     30/  1000| tot_loss: 5.4507 | rl_loss: 4.0308 | pt_loss: 1.4198 | pg_loss: 1.4104 | reg_loss: 2.6204 | reward: -2.2618 | rev_kl: 2.1563 | stu_lens: 31.0000 | mixed_lens: 26.5000 | lr: 1.4500e-06 | scale: 2048.00 | time: 26.549 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:     31/  1000| tot_loss: 3.4700 | rl_loss: 1.7877 | pt_loss: 1.6823 | pg_loss: 0.0258 | reg_loss: 1.7618 | reward: -0.4005 | rev_kl: 1.7785 | stu_lens: 76.0000 | mixed_lens: 128.0000 | lr: 1.5000e-06 | scale: 2048.00 | time: 26.575 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     32/  1000| tot_loss: 4.9730 | rl_loss: 3.3918 | pt_loss: 1.5813 | pg_loss: 1.2224 | reg_loss: 2.1694 | reward: -6.9684 | rev_kl: 2.1298 | stu_lens: 65.5000 | mixed_lens: 25.0000 | lr: 1.5500e-06 | scale: 2048.00 | time: 26.542 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     32/  1000| tot_loss: 3.9524 | rl_loss: 2.2310 | pt_loss: 1.7214 | pg_loss: 0.5449 | reg_loss: 1.6861 | reward: -1.2342 | rev_kl: 1.8086 | stu_lens: 66.8281 | mixed_lens: 72.0781 | lr: 1.5500e-06 | scale: 2048.00 | time: 26.542 | step time: 27.802
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:     33/  1000| tot_loss: 2.9304 | rl_loss: 1.4156 | pt_loss: 1.5148 | pg_loss: 0.0072 | reg_loss: 1.4084 | reward: -0.3843 | rev_kl: 1.7577 | stu_lens: 84.0000 | mixed_lens: 128.0000 | lr: 1.6000e-06 | scale: 2048.00 | time: 26.601 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:     34/  1000| tot_loss: 2.4043 | rl_loss: 0.7539 | pt_loss: 1.6503 | pg_loss: -0.0050 | reg_loss: 0.7589 | reward: -0.4765 | rev_kl: 1.8104 | stu_lens: 88.0000 | mixed_lens: 128.0000 | lr: 1.6500e-06 | scale: 2048.00 | time: 26.554 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:     35/  1000| tot_loss: 3.5896 | rl_loss: 1.5541 | pt_loss: 2.0356 | pg_loss: 0.4164 | reg_loss: 1.1377 | reward: -1.4091 | rev_kl: 1.9875 | stu_lens: 38.0000 | mixed_lens: 63.5000 | lr: 1.7000e-06 | scale: 2048.00 | time: 26.642 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:     36/  1000| tot_loss: 4.2078 | rl_loss: 2.1756 | pt_loss: 2.0322 | pg_loss: 0.3063 | reg_loss: 1.8693 | reward: -0.6754 | rev_kl: 2.3096 | stu_lens: 66.0000 | mixed_lens: 76.5000 | lr: 1.7500e-06 | scale: 2048.00 | time: 26.553 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:     37/  1000| tot_loss: 3.4400 | rl_loss: 1.7157 | pt_loss: 1.7243 | pg_loss: 0.4277 | reg_loss: 1.2880 | reward: -0.9128 | rev_kl: 0.7370 | stu_lens: 28.5000 | mixed_lens: 53.5000 | lr: 1.8000e-06 | scale: 2048.00 | time: 26.644 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:     38/  1000| tot_loss: 3.7249 | rl_loss: 1.9156 | pt_loss: 1.8093 | pg_loss: 0.2860 | reg_loss: 1.6296 | reward: -0.6884 | rev_kl: 1.6063 | stu_lens: 128.0000 | mixed_lens: 96.5000 | lr: 1.8500e-06 | scale: 2048.00 | time: 26.562 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:     39/  1000| tot_loss: 2.9479 | rl_loss: 1.0261 | pt_loss: 1.9218 | pg_loss: 0.1537 | reg_loss: 0.8724 | reward: -0.3591 | rev_kl: 1.4020 | stu_lens: 79.5000 | mixed_lens: 104.5000 | lr: 1.9000e-06 | scale: 2048.00 | time: 26.624 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:     40/  1000| tot_loss: 2.7679 | rl_loss: 1.8796 | pt_loss: 0.8883 | pg_loss: 0.5980 | reg_loss: 1.2816 | reward: -1.7041 | rev_kl: 1.6695 | stu_lens: 77.0000 | mixed_lens: 67.0000 | lr: 1.9500e-06 | scale: 2048.00 | time: 26.573 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:     41/  1000| tot_loss: 2.9666 | rl_loss: 1.4831 | pt_loss: 1.4835 | pg_loss: 0.3458 | reg_loss: 1.1373 | reward: -0.9018 | rev_kl: 1.9494 | stu_lens: 84.0000 | mixed_lens: 87.0000 | lr: 2.0000e-06 | scale: 2048.00 | time: 26.649 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:     42/  1000| tot_loss: 4.8196 | rl_loss: 3.0835 | pt_loss: 1.7361 | pg_loss: 1.7579 | reg_loss: 1.3256 | reward: -1.2798 | rev_kl: 2.4027 | stu_lens: 70.5000 | mixed_lens: 22.0000 | lr: 2.0500e-06 | scale: 2048.00 | time: 26.602 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:     43/  1000| tot_loss: 3.2769 | rl_loss: 1.3673 | pt_loss: 1.9096 | pg_loss: 0.3052 | reg_loss: 1.0621 | reward: -0.4232 | rev_kl: 1.6811 | stu_lens: 34.0000 | mixed_lens: 74.5000 | lr: 2.1000e-06 | scale: 2048.00 | time: 26.599 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:     44/  1000| tot_loss: 2.7515 | rl_loss: 0.8568 | pt_loss: 1.8947 | pg_loss: 0.0184 | reg_loss: 0.8384 | reward: -0.2643 | rev_kl: 1.7287 | stu_lens: 76.0000 | mixed_lens: 128.0000 | lr: 2.1500e-06 | scale: 2048.00 | time: 26.575 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:     45/  1000| tot_loss: 3.3602 | rl_loss: 1.7171 | pt_loss: 1.6431 | pg_loss: 0.7506 | reg_loss: 0.9665 | reward: -0.7707 | rev_kl: 1.6553 | stu_lens: 74.5000 | mixed_lens: 44.5000 | lr: 2.2000e-06 | scale: 2048.00 | time: 26.604 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:     46/  1000| tot_loss: 5.0418 | rl_loss: 3.2480 | pt_loss: 1.7939 | pg_loss: 1.2184 | reg_loss: 2.0296 | reward: -3.9321 | rev_kl: 2.1622 | stu_lens: 70.5000 | mixed_lens: 27.0000 | lr: 2.2500e-06 | scale: 2048.00 | time: 26.546 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:     47/  1000| tot_loss: 3.0058 | rl_loss: 1.4130 | pt_loss: 1.5927 | pg_loss: 1.1820 | reg_loss: 0.2310 | reward: 0.0646 | rev_kl: 1.0812 | stu_lens: 44.0000 | mixed_lens: 5.5000 | lr: 2.3000e-06 | scale: 2048.00 | time: 26.561 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:     48/  1000| tot_loss: 3.6053 | rl_loss: 1.5490 | pt_loss: 2.0563 | pg_loss: 0.4264 | reg_loss: 1.1225 | reward: -2.7205 | rev_kl: 2.0370 | stu_lens: 47.0000 | mixed_lens: 71.5000 | lr: 2.3500e-06 | scale: 2048.00 | time: 26.546 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:     48/  1000| tot_loss: 3.3906 | rl_loss: 1.6513 | pt_loss: 1.7393 | pg_loss: 0.4946 | reg_loss: 1.1567 | reward: -1.1219 | rev_kl: 1.6666 | stu_lens: 72.5781 | mixed_lens: 77.5938 | lr: 2.3500e-06 | scale: 2048.00 | time: 26.546 | step time: 27.813
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:     49/  1000| tot_loss: 4.7803 | rl_loss: 3.2087 | pt_loss: 1.5716 | pg_loss: 2.1915 | reg_loss: 1.0172 | reward: -2.2008 | rev_kl: 3.2130 | stu_lens: 6.5000 | mixed_lens: 16.5000 | lr: 2.4000e-06 | scale: 2048.00 | time: 26.554 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:     50/  1000| tot_loss: 2.8922 | rl_loss: 1.2884 | pt_loss: 1.6037 | pg_loss: 0.5817 | reg_loss: 0.7067 | reward: 0.1421 | rev_kl: 2.0121 | stu_lens: 39.5000 | mixed_lens: 66.0000 | lr: 2.4500e-06 | scale: 2048.00 | time: 26.540 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:     51/  1000| tot_loss: 3.4093 | rl_loss: 1.2612 | pt_loss: 2.1481 | pg_loss: 0.5547 | reg_loss: 0.7065 | reward: -0.8847 | rev_kl: 1.1720 | stu_lens: 102.0000 | mixed_lens: 64.0000 | lr: 2.5000e-06 | scale: 2048.00 | time: 26.550 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:     52/  1000| tot_loss: 3.4447 | rl_loss: 1.7933 | pt_loss: 1.6514 | pg_loss: 0.4151 | reg_loss: 1.3782 | reward: -3.7680 | rev_kl: 2.4879 | stu_lens: 60.0000 | mixed_lens: 67.0000 | lr: 2.5500e-06 | scale: 2048.00 | time: 26.523 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:     53/  1000| tot_loss: 3.5204 | rl_loss: 1.8248 | pt_loss: 1.6957 | pg_loss: 1.2205 | reg_loss: 0.6043 | reward: -1.9794 | rev_kl: 2.7799 | stu_lens: 60.5000 | mixed_lens: 36.5000 | lr: 2.6000e-06 | scale: 2048.00 | time: 26.578 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:     54/  1000| tot_loss: 4.8505 | rl_loss: 3.4605 | pt_loss: 1.3900 | pg_loss: 2.2827 | reg_loss: 1.1778 | reward: -2.1728 | rev_kl: 2.4849 | stu_lens: 19.5000 | mixed_lens: 5.0000 | lr: 2.6500e-06 | scale: 2048.00 | time: 26.504 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:     55/  1000| tot_loss: 3.1424 | rl_loss: 1.2369 | pt_loss: 1.9054 | pg_loss: 0.4587 | reg_loss: 0.7782 | reward: -0.1191 | rev_kl: 1.6929 | stu_lens: 57.5000 | mixed_lens: 68.0000 | lr: 2.7000e-06 | scale: 2048.00 | time: 26.548 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:     56/  1000| tot_loss: 2.4730 | rl_loss: 0.6862 | pt_loss: 1.7868 | pg_loss: 0.1903 | reg_loss: 0.4959 | reward: -0.2323 | rev_kl: 1.1001 | stu_lens: 73.5000 | mixed_lens: 74.5000 | lr: 2.7500e-06 | scale: 2048.00 | time: 26.509 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:     57/  1000| tot_loss: 2.9162 | rl_loss: 1.2955 | pt_loss: 1.6206 | pg_loss: 0.5842 | reg_loss: 0.7114 | reward: 0.0007 | rev_kl: 1.0619 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 2.8000e-06 | scale: 2048.00 | time: 26.529 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:     58/  1000| tot_loss: 2.0318 | rl_loss: 0.6866 | pt_loss: 1.3451 | pg_loss: 0.2034 | reg_loss: 0.4833 | reward: -0.9071 | rev_kl: 1.1678 | stu_lens: 65.0000 | mixed_lens: 96.5000 | lr: 2.8500e-06 | scale: 2048.00 | time: 26.514 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:     59/  1000| tot_loss: 2.9386 | rl_loss: 1.3598 | pt_loss: 1.5788 | pg_loss: 0.3239 | reg_loss: 1.0359 | reward: -0.6754 | rev_kl: 2.3096 | stu_lens: 66.0000 | mixed_lens: 76.5000 | lr: 2.9000e-06 | scale: 2048.00 | time: 26.532 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:     60/  1000| tot_loss: 2.6788 | rl_loss: 0.9932 | pt_loss: 1.6856 | pg_loss: 0.4598 | reg_loss: 0.5333 | reward: -1.3336 | rev_kl: 1.3149 | stu_lens: 21.5000 | mixed_lens: 65.0000 | lr: 2.9500e-06 | scale: 2048.00 | time: 26.513 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:     61/  1000| tot_loss: 2.6322 | rl_loss: 0.7189 | pt_loss: 1.9134 | pg_loss: 0.0162 | reg_loss: 0.7027 | reward: -0.1654 | rev_kl: 1.0769 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.0000e-06 | scale: 2048.00 | time: 26.524 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:     62/  1000| tot_loss: 3.0952 | rl_loss: 1.2270 | pt_loss: 1.8682 | pg_loss: 0.4297 | reg_loss: 0.7973 | reward: -1.0816 | rev_kl: 1.2689 | stu_lens: 69.5000 | mixed_lens: 87.0000 | lr: 3.0500e-06 | scale: 2048.00 | time: 26.529 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:     63/  1000| tot_loss: 3.6656 | rl_loss: 1.7431 | pt_loss: 1.9225 | pg_loss: 1.3375 | reg_loss: 0.4056 | reward: -2.6947 | rev_kl: 1.5922 | stu_lens: 71.0000 | mixed_lens: 29.0000 | lr: 3.1000e-06 | scale: 2048.00 | time: 26.584 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:     64/  1000| tot_loss: 4.9178 | rl_loss: 3.1400 | pt_loss: 1.7778 | pg_loss: 2.0154 | reg_loss: 1.1246 | reward: -1.4392 | rev_kl: 1.9379 | stu_lens: 21.0000 | mixed_lens: 15.5000 | lr: 3.1500e-06 | scale: 2048.00 | time: 26.529 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:     64/  1000| tot_loss: 3.1353 | rl_loss: 1.3796 | pt_loss: 1.7557 | pg_loss: 0.6144 | reg_loss: 0.7652 | reward: -1.2318 | rev_kl: 1.8079 | stu_lens: 68.9219 | mixed_lens: 73.1875 | lr: 3.1500e-06 | scale: 2048.00 | time: 26.529 | step time: 27.758
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:     65/  1000| tot_loss: 2.8488 | rl_loss: 1.0986 | pt_loss: 1.7502 | pg_loss: 0.3749 | reg_loss: 0.7237 | reward: -0.8275 | rev_kl: 1.9752 | stu_lens: 44.5000 | mixed_lens: 69.0000 | lr: 3.2000e-06 | scale: 2048.00 | time: 26.552 | step time: 0.000
[2023-12-13 17:12:03,429] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, but hysteresis is 4. Reducing hysteresis to 3
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:     66/  1000| tot_loss: 3.0275 | rl_loss: 1.1333 | pt_loss: 1.8943 | pg_loss: 0.1550 | reg_loss: 0.9782 | reward: -0.3009 | rev_kl: 1.1314 | stu_lens: 98.0000 | mixed_lens: 114.5000 | lr: 3.2000e-06 | scale: 2048.00 | time: 2.957 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:     67/  1000| tot_loss: 3.1871 | rl_loss: 0.9758 | pt_loss: 2.2113 | pg_loss: 0.1022 | reg_loss: 0.8736 | reward: -0.0460 | rev_kl: 0.5472 | stu_lens: 128.0000 | mixed_lens: 113.5000 | lr: 3.2500e-06 | scale: 2048.00 | time: 26.537 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:     68/  1000| tot_loss: 3.4825 | rl_loss: 1.7867 | pt_loss: 1.6958 | pg_loss: 0.3744 | reg_loss: 1.4123 | reward: -0.9519 | rev_kl: 1.7375 | stu_lens: 92.0000 | mixed_lens: 80.0000 | lr: 3.3000e-06 | scale: 2048.00 | time: 26.525 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:     69/  1000| tot_loss: 4.2115 | rl_loss: 2.4641 | pt_loss: 1.7474 | pg_loss: 0.7215 | reg_loss: 1.7425 | reward: -1.5270 | rev_kl: 1.5642 | stu_lens: 128.0000 | mixed_lens: 50.5000 | lr: 3.3500e-06 | scale: 2048.00 | time: 26.501 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:     70/  1000| tot_loss: 3.6732 | rl_loss: 1.9764 | pt_loss: 1.6968 | pg_loss: 0.4120 | reg_loss: 1.5644 | reward: -0.5509 | rev_kl: 1.0368 | stu_lens: 128.0000 | mixed_lens: 77.5000 | lr: 3.4000e-06 | scale: 2048.00 | time: 26.518 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:     71/  1000| tot_loss: 3.1511 | rl_loss: 1.4859 | pt_loss: 1.6652 | pg_loss: 0.0464 | reg_loss: 1.4396 | reward: -0.2745 | rev_kl: 1.4604 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4500e-06 | scale: 2048.00 | time: 26.507 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:     72/  1000| tot_loss: 2.5158 | rl_loss: 1.2014 | pt_loss: 1.3144 | pg_loss: 0.0294 | reg_loss: 1.1720 | reward: -0.3790 | rev_kl: 1.0348 | stu_lens: 101.0000 | mixed_lens: 128.0000 | lr: 3.5000e-06 | scale: 2048.00 | time: 26.499 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:     73/  1000| tot_loss: 3.8803 | rl_loss: 1.7866 | pt_loss: 2.0937 | pg_loss: 0.0592 | reg_loss: 1.7274 | reward: -0.2519 | rev_kl: 1.3170 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5500e-06 | scale: 2048.00 | time: 26.519 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:     74/  1000| tot_loss: 3.8417 | rl_loss: 2.2976 | pt_loss: 1.5440 | pg_loss: 0.7119 | reg_loss: 1.5857 | reward: -0.7386 | rev_kl: 1.4457 | stu_lens: 92.5000 | mixed_lens: 63.5000 | lr: 3.6000e-06 | scale: 2048.00 | time: 26.541 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:     75/  1000| tot_loss: 2.3251 | rl_loss: 0.9985 | pt_loss: 1.3265 | pg_loss: 0.0426 | reg_loss: 0.9560 | reward: -0.1578 | rev_kl: 1.1856 | stu_lens: 99.5000 | mixed_lens: 128.0000 | lr: 3.6500e-06 | scale: 2048.00 | time: 26.549 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:     76/  1000| tot_loss: 3.4535 | rl_loss: 1.5566 | pt_loss: 1.8968 | pg_loss: 0.1935 | reg_loss: 1.3632 | reward: -0.3476 | rev_kl: 1.2841 | stu_lens: 101.5000 | mixed_lens: 114.0000 | lr: 3.7000e-06 | scale: 2048.00 | time: 26.522 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:     77/  1000| tot_loss: 4.8323 | rl_loss: 3.4212 | pt_loss: 1.4111 | pg_loss: 1.6928 | reg_loss: 1.7283 | reward: -1.5888 | rev_kl: 1.8432 | stu_lens: 38.5000 | mixed_lens: 25.0000 | lr: 3.7500e-06 | scale: 2048.00 | time: 26.562 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:     78/  1000| tot_loss: 2.9096 | rl_loss: 1.3207 | pt_loss: 1.5889 | pg_loss: 0.2754 | reg_loss: 1.0453 | reward: -0.4501 | rev_kl: 0.8102 | stu_lens: 61.0000 | mixed_lens: 86.0000 | lr: 3.8000e-06 | scale: 2048.00 | time: 26.561 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:     79/  1000| tot_loss: 3.9212 | rl_loss: 2.3959 | pt_loss: 1.5252 | pg_loss: 0.7242 | reg_loss: 1.6717 | reward: -0.8537 | rev_kl: 1.5944 | stu_lens: 61.0000 | mixed_lens: 68.0000 | lr: 3.8500e-06 | scale: 2048.00 | time: 26.553 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     80/  1000| tot_loss: 3.7337 | rl_loss: 1.9804 | pt_loss: 1.7532 | pg_loss: 0.6578 | reg_loss: 1.3227 | reward: -2.5999 | rev_kl: 1.2817 | stu_lens: 68.0000 | mixed_lens: 62.5000 | lr: 3.9000e-06 | scale: 2048.00 | time: 26.574 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     80/  1000| tot_loss: 3.4909 | rl_loss: 1.7621 | pt_loss: 1.7288 | pg_loss: 0.4351 | reg_loss: 1.3271 | reward: -0.7558 | rev_kl: 1.3589 | stu_lens: 79.4219 | mixed_lens: 85.1719 | lr: 3.9000e-06 | scale: 2048.00 | time: 26.574 | step time: 26.278
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:     81/  1000| tot_loss: 3.8913 | rl_loss: 2.1199 | pt_loss: 1.7714 | pg_loss: 0.7241 | reg_loss: 1.3958 | reward: -0.6836 | rev_kl: 3.3805 | stu_lens: 78.0000 | mixed_lens: 61.5000 | lr: 3.9500e-06 | scale: 2048.00 | time: 26.600 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:     82/  1000| tot_loss: 2.9217 | rl_loss: 1.0728 | pt_loss: 1.8490 | pg_loss: 0.3882 | reg_loss: 0.6846 | reward: -0.3778 | rev_kl: 0.7606 | stu_lens: 71.0000 | mixed_lens: 86.0000 | lr: 4.0000e-06 | scale: 2048.00 | time: 26.559 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:     83/  1000| tot_loss: 2.6349 | rl_loss: 0.7348 | pt_loss: 1.9001 | pg_loss: -0.0141 | reg_loss: 0.7489 | reward: -0.2903 | rev_kl: 1.2591 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.0500e-06 | scale: 2048.00 | time: 26.575 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:     84/  1000| tot_loss: 4.9319 | rl_loss: 3.1678 | pt_loss: 1.7641 | pg_loss: 2.1051 | reg_loss: 1.0627 | reward: -0.6730 | rev_kl: 3.3198 | stu_lens: 15.5000 | mixed_lens: 11.5000 | lr: 4.1000e-06 | scale: 2048.00 | time: 26.520 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:     85/  1000| tot_loss: 2.4495 | rl_loss: 0.9658 | pt_loss: 1.4837 | pg_loss: 0.0017 | reg_loss: 0.9641 | reward: -0.3091 | rev_kl: 1.6977 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1500e-06 | scale: 2048.00 | time: 26.609 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:     86/  1000| tot_loss: 2.1749 | rl_loss: 0.5697 | pt_loss: 1.6051 | pg_loss: 0.2408 | reg_loss: 0.3289 | reward: -0.9440 | rev_kl: 1.2277 | stu_lens: 72.5000 | mixed_lens: 72.5000 | lr: 4.2000e-06 | scale: 2048.00 | time: 26.533 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:     87/  1000| tot_loss: 3.3769 | rl_loss: 1.7315 | pt_loss: 1.6454 | pg_loss: 0.8267 | reg_loss: 0.9048 | reward: -0.7498 | rev_kl: 1.1934 | stu_lens: 89.5000 | mixed_lens: 58.5000 | lr: 4.2500e-06 | scale: 2048.00 | time: 26.565 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:     88/  1000| tot_loss: 3.0169 | rl_loss: 1.0131 | pt_loss: 2.0038 | pg_loss: 0.1945 | reg_loss: 0.8186 | reward: -1.1152 | rev_kl: 1.1099 | stu_lens: 89.5000 | mixed_lens: 82.0000 | lr: 4.3000e-06 | scale: 2048.00 | time: 26.498 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:     89/  1000| tot_loss: 2.8956 | rl_loss: 1.0389 | pt_loss: 1.8567 | pg_loss: 0.0217 | reg_loss: 1.0172 | reward: -0.2519 | rev_kl: 1.3170 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3500e-06 | scale: 2048.00 | time: 26.552 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:     90/  1000| tot_loss: 2.7656 | rl_loss: 0.8320 | pt_loss: 1.9336 | pg_loss: 0.3000 | reg_loss: 0.5321 | reward: -0.7495 | rev_kl: 1.3086 | stu_lens: 41.0000 | mixed_lens: 90.5000 | lr: 4.4000e-06 | scale: 2048.00 | time: 26.510 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:     91/  1000| tot_loss: 2.9590 | rl_loss: 1.4957 | pt_loss: 1.4632 | pg_loss: 0.2852 | reg_loss: 1.2105 | reward: -0.4394 | rev_kl: 1.2058 | stu_lens: 92.5000 | mixed_lens: 83.5000 | lr: 4.4500e-06 | scale: 2048.00 | time: 26.539 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:     92/  1000| tot_loss: 2.3196 | rl_loss: 1.0379 | pt_loss: 1.2817 | pg_loss: 0.3456 | reg_loss: 0.6923 | reward: 0.8947 | rev_kl: 1.1386 | stu_lens: 68.0000 | mixed_lens: 68.5000 | lr: 4.5000e-06 | scale: 2048.00 | time: 26.482 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:     93/  1000| tot_loss: 2.5961 | rl_loss: 0.9794 | pt_loss: 1.6167 | pg_loss: 0.2192 | reg_loss: 0.7602 | reward: -0.2705 | rev_kl: 1.1224 | stu_lens: 124.0000 | mixed_lens: 86.5000 | lr: 4.5500e-06 | scale: 2048.00 | time: 26.532 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:     94/  1000| tot_loss: 2.9982 | rl_loss: 1.2961 | pt_loss: 1.7020 | pg_loss: 0.4110 | reg_loss: 0.8851 | reward: -3.8716 | rev_kl: 0.4669 | stu_lens: 69.0000 | mixed_lens: 66.0000 | lr: 4.6000e-06 | scale: 2048.00 | time: 26.479 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:     95/  1000| tot_loss: 2.6734 | rl_loss: 0.9734 | pt_loss: 1.6999 | pg_loss: 0.2866 | reg_loss: 0.6869 | reward: -0.4890 | rev_kl: 1.0904 | stu_lens: 65.5000 | mixed_lens: 92.5000 | lr: 4.6500e-06 | scale: 2048.00 | time: 26.529 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     96/  1000| tot_loss: 2.8322 | rl_loss: 1.1251 | pt_loss: 1.7070 | pg_loss: 0.2214 | reg_loss: 0.9037 | reward: -0.7894 | rev_kl: 1.4159 | stu_lens: 128.0000 | mixed_lens: 96.5000 | lr: 4.7000e-06 | scale: 2048.00 | time: 26.465 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     96/  1000| tot_loss: 3.0823 | rl_loss: 1.3553 | pt_loss: 1.7271 | pg_loss: 0.4622 | reg_loss: 0.8931 | reward: -0.7475 | rev_kl: 1.4369 | stu_lens: 84.1875 | mixed_lens: 84.4688 | lr: 4.7000e-06 | scale: 2048.00 | time: 26.465 | step time: 27.757
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:     97/  1000| tot_loss: 3.4050 | rl_loss: 1.4659 | pt_loss: 1.9391 | pg_loss: 0.6334 | reg_loss: 0.8325 | reward: -0.6310 | rev_kl: 1.3430 | stu_lens: 62.5000 | mixed_lens: 67.0000 | lr: 4.7500e-06 | scale: 2048.00 | time: 26.553 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:     98/  1000| tot_loss: 2.4945 | rl_loss: 0.9333 | pt_loss: 1.5613 | pg_loss: 0.4547 | reg_loss: 0.4786 | reward: -0.1142 | rev_kl: 0.7166 | stu_lens: 53.0000 | mixed_lens: 69.5000 | lr: 4.8000e-06 | scale: 2048.00 | time: 26.461 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:     99/  1000| tot_loss: 2.5906 | rl_loss: 0.6005 | pt_loss: 1.9901 | pg_loss: -0.0056 | reg_loss: 0.6061 | reward: -0.2435 | rev_kl: 1.3766 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8500e-06 | scale: 2048.00 | time: 26.502 | step time: 0.000
                                 Evaluation #1                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ I understand. If you want to create  │
│                                       │ something new, you might be          │
│                                       │ interested in artificial             │
│                                       │ intelligence. Artificial             │
│                                       │ intelligence is a popular area of    │
│                                       │ research that focuses on creating    │
│                                       │ algorithms that can learn and make   │
│                                       │ decisions like humans. There are     │
│                                       │ many applications of AI, such as     │
│                                       │ self-driving cars, recommendations   │
│                                       │ systems, and machine translation.    │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ That's totally fine. Machine         │
│                                       │ learning is still a young field, and │
│                                       │ there is a lot of room for           │
│                                       │ innovation. There are also many      │
│                                       │ other areas within machine learning, │
│                                       │ such as computer vision, natural     │
│                                       │ language processing, and recommender │
│                                       │ systems. You can also apply machine  │
│                                       │ learning to other domains, such as   │
│                                       │ finance, transportation, sports, or  │
│                                       │ healthcare.                          │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Follow your passion. But build on    │
│                                       │ something that already exists. It    │
│                                       │ will be a lot easier for you to find │
│                                       │ mentors and get started. Also, there │
│                                       │ is a higher chance of your idea      │
│                                       │ being successful if it is based on   │
│                                       │ an existing idea.                    │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 15.564 | exact_match: 0.000 | rev_kl: 1.133 | lens: 97.404 | pt_loss: 1.124 | lm_loss: 1.232 | kd_loss: 1.016 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    100/  1000| tot_loss: 2.4226 | rl_loss: 1.2476 | pt_loss: 1.1750 | pg_loss: 0.5127 | reg_loss: 0.7349 | reward: -0.5354 | rev_kl: 1.7453 | stu_lens: 47.0000 | mixed_lens: 72.0000 | lr: 4.9000e-06 | scale: 2048.00 | time: 26.460 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    101/  1000| tot_loss: 4.6540 | rl_loss: 3.1462 | pt_loss: 1.5077 | pg_loss: 2.4152 | reg_loss: 0.7311 | reward: -0.9528 | rev_kl: 3.5062 | stu_lens: 10.0000 | mixed_lens: 10.5000 | lr: 4.9500e-06 | scale: 2048.00 | time: 26.548 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    102/  1000| tot_loss: 3.3315 | rl_loss: 1.7837 | pt_loss: 1.5479 | pg_loss: 0.9673 | reg_loss: 0.8164 | reward: -1.0633 | rev_kl: 1.6798 | stu_lens: 58.5000 | mixed_lens: 45.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.508 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    103/  1000| tot_loss: 2.9839 | rl_loss: 1.1769 | pt_loss: 1.8071 | pg_loss: 0.5699 | reg_loss: 0.6070 | reward: -1.5270 | rev_kl: 1.5642 | stu_lens: 128.0000 | mixed_lens: 50.5000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.507 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    104/  1000| tot_loss: 2.4495 | rl_loss: 0.8373 | pt_loss: 1.6122 | pg_loss: 0.1507 | reg_loss: 0.6865 | reward: -0.2965 | rev_kl: 1.6417 | stu_lens: 128.0000 | mixed_lens: 108.0000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.492 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    105/  1000| tot_loss: 2.6392 | rl_loss: 0.6139 | pt_loss: 2.0253 | pg_loss: 0.0647 | reg_loss: 0.5493 | reward: -0.2280 | rev_kl: 2.9874 | stu_lens: 89.5000 | mixed_lens: 116.0000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.511 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    106/  1000| tot_loss: 2.3690 | rl_loss: 0.9218 | pt_loss: 1.4472 | pg_loss: 0.2867 | reg_loss: 0.6351 | reward: -0.3789 | rev_kl: 1.2491 | stu_lens: 99.5000 | mixed_lens: 86.0000 | lr: 4.9998e-06 | scale: 2048.00 | time: 26.480 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    107/  1000| tot_loss: 2.2948 | rl_loss: 0.6135 | pt_loss: 1.6813 | pg_loss: -0.0089 | reg_loss: 0.6225 | reward: -0.2820 | rev_kl: 1.4550 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9996e-06 | scale: 2048.00 | time: 26.498 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    108/  1000| tot_loss: 2.9699 | rl_loss: 1.3105 | pt_loss: 1.6593 | pg_loss: 0.4851 | reg_loss: 0.8255 | reward: -0.8203 | rev_kl: 1.3767 | stu_lens: 75.5000 | mixed_lens: 84.0000 | lr: 4.9995e-06 | scale: 2048.00 | time: 26.483 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    109/  1000| tot_loss: 2.6030 | rl_loss: 0.6864 | pt_loss: 1.9166 | pg_loss: 0.1470 | reg_loss: 0.5394 | reward: -0.6330 | rev_kl: 1.3411 | stu_lens: 39.0000 | mixed_lens: 105.5000 | lr: 4.9993e-06 | scale: 2048.00 | time: 26.529 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    110/  1000| tot_loss: 2.3488 | rl_loss: 0.9569 | pt_loss: 1.3919 | pg_loss: 0.1957 | reg_loss: 0.7612 | reward: -0.1986 | rev_kl: 1.1509 | stu_lens: 128.0000 | mixed_lens: 113.5000 | lr: 4.9990e-06 | scale: 2048.00 | time: 26.476 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    111/  1000| tot_loss: 2.4193 | rl_loss: 0.9393 | pt_loss: 1.4800 | pg_loss: 0.5879 | reg_loss: 0.3514 | reward: 0.7831 | rev_kl: 0.5868 | stu_lens: 64.0000 | mixed_lens: 27.0000 | lr: 4.9988e-06 | scale: 2048.00 | time: 26.523 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    112/  1000| tot_loss: 2.5395 | rl_loss: 0.8698 | pt_loss: 1.6697 | pg_loss: 0.2993 | reg_loss: 0.5705 | reward: -2.9554 | rev_kl: 1.1261 | stu_lens: 70.0000 | mixed_lens: 53.5000 | lr: 4.9985e-06 | scale: 2048.00 | time: 26.518 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    112/  1000| tot_loss: 2.7987 | rl_loss: 1.0638 | pt_loss: 1.7349 | pg_loss: 0.4277 | reg_loss: 0.6361 | reward: -0.6893 | rev_kl: 1.4519 | stu_lens: 81.9688 | mixed_lens: 82.8281 | lr: 4.9985e-06 | scale: 2048.00 | time: 26.518 | step time: 27.731
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    113/  1000| tot_loss: 2.6889 | rl_loss: 0.7915 | pt_loss: 1.8975 | pg_loss: 0.2469 | reg_loss: 0.5445 | reward: -3.7634 | rev_kl: 0.3125 | stu_lens: 64.0000 | mixed_lens: 66.0000 | lr: 4.9982e-06 | scale: 2048.00 | time: 26.531 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    114/  1000| tot_loss: 2.7921 | rl_loss: 1.2739 | pt_loss: 1.5182 | pg_loss: 0.8305 | reg_loss: 0.4435 | reward: -2.6469 | rev_kl: 1.0872 | stu_lens: 64.0000 | mixed_lens: 27.5000 | lr: 4.9978e-06 | scale: 2048.00 | time: 26.514 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    115/  1000| tot_loss: 2.4072 | rl_loss: 0.5891 | pt_loss: 1.8180 | pg_loss: 0.0063 | reg_loss: 0.5828 | reward: -0.4780 | rev_kl: 1.3303 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9974e-06 | scale: 2048.00 | time: 26.554 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    116/  1000| tot_loss: 2.4345 | rl_loss: 0.8796 | pt_loss: 1.5549 | pg_loss: 0.3655 | reg_loss: 0.5142 | reward: -0.7863 | rev_kl: 1.7460 | stu_lens: 34.5000 | mixed_lens: 90.5000 | lr: 4.9970e-06 | scale: 2048.00 | time: 26.571 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    117/  1000| tot_loss: 2.4148 | rl_loss: 0.7255 | pt_loss: 1.6893 | pg_loss: 0.2381 | reg_loss: 0.4874 | reward: -0.6638 | rev_kl: 1.4458 | stu_lens: 128.0000 | mixed_lens: 96.5000 | lr: 4.9966e-06 | scale: 2048.00 | time: 26.581 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    118/  1000| tot_loss: 2.4319 | rl_loss: 0.7861 | pt_loss: 1.6458 | pg_loss: 0.2278 | reg_loss: 0.5583 | reward: -1.0144 | rev_kl: 1.2537 | stu_lens: 45.5000 | mixed_lens: 72.5000 | lr: 4.9961e-06 | scale: 2048.00 | time: 26.539 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    119/  1000| tot_loss: 1.9675 | rl_loss: 0.6027 | pt_loss: 1.3648 | pg_loss: 0.2297 | reg_loss: 0.3730 | reward: -0.5512 | rev_kl: 1.2841 | stu_lens: 107.0000 | mixed_lens: 106.5000 | lr: 4.9956e-06 | scale: 2048.00 | time: 26.588 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    120/  1000| tot_loss: 2.7098 | rl_loss: 0.8804 | pt_loss: 1.8294 | pg_loss: 0.2307 | reg_loss: 0.6497 | reward: -0.3334 | rev_kl: 1.4708 | stu_lens: 92.5000 | mixed_lens: 92.5000 | lr: 4.9951e-06 | scale: 2048.00 | time: 26.528 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    121/  1000| tot_loss: 2.5002 | rl_loss: 0.8994 | pt_loss: 1.6008 | pg_loss: 0.3678 | reg_loss: 0.5316 | reward: -3.7792 | rev_kl: 0.8271 | stu_lens: 85.0000 | mixed_lens: 66.0000 | lr: 4.9945e-06 | scale: 2048.00 | time: 26.576 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    122/  1000| tot_loss: 2.2259 | rl_loss: 0.8500 | pt_loss: 1.3760 | pg_loss: 0.7001 | reg_loss: 0.1499 | reward: -0.5524 | rev_kl: 3.3033 | stu_lens: 31.5000 | mixed_lens: 43.5000 | lr: 4.9939e-06 | scale: 2048.00 | time: 26.516 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    123/  1000| tot_loss: 2.3176 | rl_loss: 0.5066 | pt_loss: 1.8110 | pg_loss: 0.2305 | reg_loss: 0.2761 | reward: -2.8246 | rev_kl: 1.1458 | stu_lens: 70.0000 | mixed_lens: 68.0000 | lr: 4.9933e-06 | scale: 2048.00 | time: 26.522 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    124/  1000| tot_loss: 2.9431 | rl_loss: 1.0016 | pt_loss: 1.9415 | pg_loss: 0.4638 | reg_loss: 0.5379 | reward: -0.5230 | rev_kl: 1.3151 | stu_lens: 99.5000 | mixed_lens: 86.0000 | lr: 4.9926e-06 | scale: 2048.00 | time: 26.507 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    125/  1000| tot_loss: 2.3289 | rl_loss: 0.3567 | pt_loss: 1.9722 | pg_loss: 0.1787 | reg_loss: 0.1780 | reward: -0.4936 | rev_kl: 0.8962 | stu_lens: 110.5000 | mixed_lens: 78.0000 | lr: 4.9919e-06 | scale: 2048.00 | time: 26.557 | step time: 0.000
[2023-12-13 18:05:36,488] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, but hysteresis is 3. Reducing hysteresis to 2
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    126/  1000| tot_loss: 3.3895 | rl_loss: 0.6210 | pt_loss: 2.7684 | pg_loss: 0.1036 | reg_loss: 0.5175 | reward: -0.3204 | rev_kl: 1.0413 | stu_lens: 101.5000 | mixed_lens: 114.0000 | lr: 4.9919e-06 | scale: 2048.00 | time: 2.900 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    127/  1000| tot_loss: 1.9390 | rl_loss: 0.3974 | pt_loss: 1.5416 | pg_loss: 0.0177 | reg_loss: 0.3798 | reward: -0.1815 | rev_kl: 1.5747 | stu_lens: 55.5000 | mixed_lens: 128.0000 | lr: 4.9912e-06 | scale: 2048.00 | time: 26.478 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    128/  1000| tot_loss: 2.2690 | rl_loss: 0.5937 | pt_loss: 1.6754 | pg_loss: 0.1299 | reg_loss: 0.4637 | reward: -0.1624 | rev_kl: 1.1282 | stu_lens: 128.0000 | mixed_lens: 113.5000 | lr: 4.9905e-06 | scale: 2048.00 | time: 26.501 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    128/  1000| tot_loss: 2.6197 | rl_loss: 0.8817 | pt_loss: 1.7380 | pg_loss: 0.4013 | reg_loss: 0.4805 | reward: -0.8658 | rev_kl: 1.3743 | stu_lens: 80.8438 | mixed_lens: 81.3281 | lr: 4.9905e-06 | scale: 2048.00 | time: 26.501 | step time: 26.277
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    129/  1000| tot_loss: 2.8927 | rl_loss: 0.6990 | pt_loss: 2.1937 | pg_loss: 0.2569 | reg_loss: 0.4420 | reward: -0.5052 | rev_kl: 1.0312 | stu_lens: 91.0000 | mixed_lens: 108.5000 | lr: 4.9897e-06 | scale: 2048.00 | time: 26.467 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    130/  1000| tot_loss: 3.4379 | rl_loss: 1.4998 | pt_loss: 1.9381 | pg_loss: 0.1897 | reg_loss: 1.3102 | reward: -0.3160 | rev_kl: 1.0673 | stu_lens: 49.5000 | mixed_lens: 110.5000 | lr: 4.9889e-06 | scale: 2048.00 | time: 26.524 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    131/  1000| tot_loss: 2.9353 | rl_loss: 1.4109 | pt_loss: 1.5245 | pg_loss: 0.4314 | reg_loss: 0.9794 | reward: -0.2467 | rev_kl: 1.1578 | stu_lens: 54.0000 | mixed_lens: 76.0000 | lr: 4.9881e-06 | scale: 2048.00 | time: 26.502 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    132/  1000| tot_loss: 0.2586 | rl_loss: -1.5833 | pt_loss: 1.8418 | pg_loss: -1.7588 | reg_loss: 0.1756 | reward: 0.0401 | rev_kl: 0.0269 | stu_lens: 7.5000 | mixed_lens: 7.5000 | lr: 4.9872e-06 | scale: 2048.00 | time: 26.446 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    133/  1000| tot_loss: 3.4233 | rl_loss: 1.5130 | pt_loss: 1.9103 | pg_loss: 0.0516 | reg_loss: 1.4614 | reward: -0.4084 | rev_kl: 1.6857 | stu_lens: 105.5000 | mixed_lens: 128.0000 | lr: 4.9863e-06 | scale: 2048.00 | time: 26.516 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    134/  1000| tot_loss: 2.7350 | rl_loss: 1.1454 | pt_loss: 1.5896 | pg_loss: 0.2651 | reg_loss: 0.8804 | reward: -0.2019 | rev_kl: 0.8258 | stu_lens: 112.5000 | mixed_lens: 101.5000 | lr: 4.9854e-06 | scale: 2048.00 | time: 26.480 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    135/  1000| tot_loss: 3.1685 | rl_loss: 1.5561 | pt_loss: 1.6124 | pg_loss: 0.6528 | reg_loss: 0.9033 | reward: -1.6170 | rev_kl: 1.1186 | stu_lens: 41.0000 | mixed_lens: 37.0000 | lr: 4.9844e-06 | scale: 2048.00 | time: 26.525 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    136/  1000| tot_loss: 3.1543 | rl_loss: 1.3904 | pt_loss: 1.7639 | pg_loss: 0.1694 | reg_loss: 1.2210 | reward: -0.4019 | rev_kl: 1.0746 | stu_lens: 109.0000 | mixed_lens: 108.0000 | lr: 4.9834e-06 | scale: 2048.00 | time: 26.467 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    137/  1000| tot_loss: 2.7848 | rl_loss: 0.6857 | pt_loss: 2.0991 | pg_loss: 0.0649 | reg_loss: 0.6208 | reward: -0.3867 | rev_kl: 0.5753 | stu_lens: 110.0000 | mixed_lens: 128.0000 | lr: 4.9824e-06 | scale: 2048.00 | time: 26.507 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    138/  1000| tot_loss: 3.0779 | rl_loss: 1.6752 | pt_loss: 1.4027 | pg_loss: 0.0804 | reg_loss: 1.5948 | reward: -0.4720 | rev_kl: 1.6712 | stu_lens: 128.0000 | mixed_lens: 122.5000 | lr: 4.9814e-06 | scale: 2048.00 | time: 26.461 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    139/  1000| tot_loss: 3.0220 | rl_loss: 1.3632 | pt_loss: 1.6588 | pg_loss: 0.0347 | reg_loss: 1.3286 | reward: -0.1923 | rev_kl: 1.1642 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9803e-06 | scale: 2048.00 | time: 26.489 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    140/  1000| tot_loss: 4.4621 | rl_loss: 2.1313 | pt_loss: 2.3309 | pg_loss: 0.5353 | reg_loss: 1.5960 | reward: -0.6439 | rev_kl: 1.2517 | stu_lens: 128.0000 | mixed_lens: 87.0000 | lr: 4.9792e-06 | scale: 2048.00 | time: 26.456 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    141/  1000| tot_loss: 3.1643 | rl_loss: 1.2827 | pt_loss: 1.8816 | pg_loss: 0.0597 | reg_loss: 1.2229 | reward: -0.2388 | rev_kl: 1.2216 | stu_lens: 90.5000 | mixed_lens: 124.5000 | lr: 4.9780e-06 | scale: 2048.00 | time: 26.527 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    142/  1000| tot_loss: 4.6914 | rl_loss: 2.4684 | pt_loss: 2.2230 | pg_loss: 0.6386 | reg_loss: 1.8298 | reward: -1.0040 | rev_kl: 1.6340 | stu_lens: 125.5000 | mixed_lens: 73.0000 | lr: 4.9769e-06 | scale: 2048.00 | time: 26.476 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    143/  1000| tot_loss: 2.4967 | rl_loss: 1.2153 | pt_loss: 1.2814 | pg_loss: 0.0884 | reg_loss: 1.1269 | reward: -0.2030 | rev_kl: 1.1002 | stu_lens: 97.0000 | mixed_lens: 127.5000 | lr: 4.9757e-06 | scale: 2048.00 | time: 26.508 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    144/  1000| tot_loss: 3.6426 | rl_loss: 2.1680 | pt_loss: 1.4746 | pg_loss: 0.7646 | reg_loss: 1.4034 | reward: -0.4157 | rev_kl: 1.0380 | stu_lens: 104.0000 | mixed_lens: 46.5000 | lr: 4.9744e-06 | scale: 2048.00 | time: 26.459 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    144/  1000| tot_loss: 3.2063 | rl_loss: 1.4022 | pt_loss: 1.8041 | pg_loss: 0.2647 | reg_loss: 1.1376 | reward: -0.4251 | rev_kl: 1.1129 | stu_lens: 89.5000 | mixed_lens: 93.2812 | lr: 4.9744e-06 | scale: 2048.00 | time: 26.459 | step time: 27.717
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    145/  1000| tot_loss: 3.1969 | rl_loss: 1.2618 | pt_loss: 1.9351 | pg_loss: 0.3995 | reg_loss: 0.8623 | reward: -0.1942 | rev_kl: 0.8189 | stu_lens: 128.0000 | mixed_lens: 78.5000 | lr: 4.9732e-06 | scale: 2048.00 | time: 26.537 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    146/  1000| tot_loss: 3.0412 | rl_loss: 1.4352 | pt_loss: 1.6061 | pg_loss: 0.3160 | reg_loss: 1.1192 | reward: -0.4882 | rev_kl: 1.3190 | stu_lens: 114.0000 | mixed_lens: 76.5000 | lr: 4.9719e-06 | scale: 2048.00 | time: 26.521 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    147/  1000| tot_loss: 4.1276 | rl_loss: 2.2041 | pt_loss: 1.9234 | pg_loss: 0.9075 | reg_loss: 1.2967 | reward: -1.3668 | rev_kl: 1.5137 | stu_lens: 118.0000 | mixed_lens: 46.5000 | lr: 4.9706e-06 | scale: 2048.00 | time: 26.558 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    148/  1000| tot_loss: 2.8322 | rl_loss: 1.0001 | pt_loss: 1.8321 | pg_loss: 0.4360 | reg_loss: 0.5641 | reward: -1.3005 | rev_kl: 1.5984 | stu_lens: 30.5000 | mixed_lens: 62.5000 | lr: 4.9692e-06 | scale: 2048.00 | time: 26.529 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    149/  1000| tot_loss: 3.1515 | rl_loss: 1.3348 | pt_loss: 1.8167 | pg_loss: 0.3559 | reg_loss: 0.9789 | reward: -0.4606 | rev_kl: 1.4811 | stu_lens: 87.0000 | mixed_lens: 94.5000 | lr: 4.9678e-06 | scale: 2048.00 | time: 26.532 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    150/  1000| tot_loss: 3.6349 | rl_loss: 1.9493 | pt_loss: 1.6856 | pg_loss: 0.8883 | reg_loss: 1.0610 | reward: -0.5779 | rev_kl: 0.9882 | stu_lens: 99.0000 | mixed_lens: 47.0000 | lr: 4.9664e-06 | scale: 2048.00 | time: 26.558 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    151/  1000| tot_loss: 3.4416 | rl_loss: 1.4126 | pt_loss: 2.0290 | pg_loss: 0.5964 | reg_loss: 0.8162 | reward: -0.1994 | rev_kl: 1.0784 | stu_lens: 73.0000 | mixed_lens: 69.0000 | lr: 4.9650e-06 | scale: 2048.00 | time: 26.503 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    152/  1000| tot_loss: 3.0444 | rl_loss: 1.2129 | pt_loss: 1.8315 | pg_loss: 0.2052 | reg_loss: 1.0077 | reward: -0.2815 | rev_kl: 1.4930 | stu_lens: 98.0000 | mixed_lens: 96.5000 | lr: 4.9635e-06 | scale: 2048.00 | time: 26.481 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    153/  1000| tot_loss: 2.8067 | rl_loss: 1.3267 | pt_loss: 1.4799 | pg_loss: 0.3698 | reg_loss: 0.9570 | reward: -0.5830 | rev_kl: 1.0137 | stu_lens: 61.0000 | mixed_lens: 62.5000 | lr: 4.9620e-06 | scale: 2048.00 | time: 26.528 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    154/  1000| tot_loss: 2.6725 | rl_loss: 0.8989 | pt_loss: 1.7736 | pg_loss: 0.0624 | reg_loss: 0.8365 | reward: -0.4534 | rev_kl: 1.3371 | stu_lens: 128.0000 | mixed_lens: 122.5000 | lr: 4.9605e-06 | scale: 2048.00 | time: 26.457 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    155/  1000| tot_loss: 2.1137 | rl_loss: 0.6763 | pt_loss: 1.4373 | pg_loss: 0.0274 | reg_loss: 0.6489 | reward: -0.2305 | rev_kl: 0.8228 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9589e-06 | scale: 2048.00 | time: 26.495 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    156/  1000| tot_loss: 2.3392 | rl_loss: 0.6844 | pt_loss: 1.6547 | pg_loss: -0.0092 | reg_loss: 0.6936 | reward: -0.3024 | rev_kl: 0.8603 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9573e-06 | scale: 2048.00 | time: 26.461 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    157/  1000| tot_loss: 2.3953 | rl_loss: 0.7566 | pt_loss: 1.6387 | pg_loss: 0.2479 | reg_loss: 0.5086 | reward: -0.1240 | rev_kl: 0.4486 | stu_lens: 90.0000 | mixed_lens: 90.5000 | lr: 4.9557e-06 | scale: 2048.00 | time: 26.501 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    158/  1000| tot_loss: 1.6891 | rl_loss: 0.4063 | pt_loss: 1.2828 | pg_loss: 0.0792 | reg_loss: 0.3270 | reward: -0.1404 | rev_kl: 0.9670 | stu_lens: 128.0000 | mixed_lens: 109.5000 | lr: 4.9541e-06 | scale: 2048.00 | time: 26.453 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    159/  1000| tot_loss: 3.7133 | rl_loss: 1.6424 | pt_loss: 2.0709 | pg_loss: 0.9533 | reg_loss: 0.6891 | reward: -1.2645 | rev_kl: 0.7923 | stu_lens: 28.5000 | mixed_lens: 66.0000 | lr: 4.9524e-06 | scale: 2048.00 | time: 26.500 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    160/  1000| tot_loss: 2.5215 | rl_loss: 0.9982 | pt_loss: 1.5233 | pg_loss: 0.3133 | reg_loss: 0.6849 | reward: -1.5659 | rev_kl: 0.7582 | stu_lens: 68.5000 | mixed_lens: 68.5000 | lr: 4.9507e-06 | scale: 2048.00 | time: 26.486 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    160/  1000| tot_loss: 2.7929 | rl_loss: 1.0814 | pt_loss: 1.7115 | pg_loss: 0.3055 | reg_loss: 0.7759 | reward: -0.4078 | rev_kl: 1.0727 | stu_lens: 92.9688 | mixed_lens: 91.3906 | lr: 4.9507e-06 | scale: 2048.00 | time: 26.486 | step time: 27.729
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    161/  1000| tot_loss: 2.5816 | rl_loss: 0.7531 | pt_loss: 1.8286 | pg_loss: 0.0084 | reg_loss: 0.7447 | reward: -0.3198 | rev_kl: 1.5692 | stu_lens: 128.0000 | mixed_lens: 124.5000 | lr: 4.9489e-06 | scale: 2048.00 | time: 26.502 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    162/  1000| tot_loss: 2.1204 | rl_loss: 0.6137 | pt_loss: 1.5067 | pg_loss: 0.0071 | reg_loss: 0.6066 | reward: -0.3557 | rev_kl: 1.1224 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9472e-06 | scale: 2048.00 | time: 26.470 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    163/  1000| tot_loss: 2.5969 | rl_loss: 0.5490 | pt_loss: 2.0479 | pg_loss: 0.0489 | reg_loss: 0.5001 | reward: -0.2670 | rev_kl: 0.6689 | stu_lens: 120.0000 | mixed_lens: 128.0000 | lr: 4.9454e-06 | scale: 2048.00 | time: 26.524 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    164/  1000| tot_loss: 2.4935 | rl_loss: 0.9268 | pt_loss: 1.5667 | pg_loss: 0.2934 | reg_loss: 0.6335 | reward: -0.2004 | rev_kl: 1.0417 | stu_lens: 91.0000 | mixed_lens: 82.5000 | lr: 4.9435e-06 | scale: 2048.00 | time: 26.465 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    165/  1000| tot_loss: 2.7305 | rl_loss: 0.8372 | pt_loss: 1.8933 | pg_loss: 0.4611 | reg_loss: 0.3761 | reward: -0.9127 | rev_kl: 1.6928 | stu_lens: 82.5000 | mixed_lens: 57.5000 | lr: 4.9417e-06 | scale: 2048.00 | time: 26.518 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    166/  1000| tot_loss: 2.4569 | rl_loss: 0.3720 | pt_loss: 2.0848 | pg_loss: 0.0066 | reg_loss: 0.3655 | reward: -0.0696 | rev_kl: 0.6282 | stu_lens: 77.5000 | mixed_lens: 128.0000 | lr: 4.9398e-06 | scale: 2048.00 | time: 26.484 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    167/  1000| tot_loss: 1.8693 | rl_loss: 0.4757 | pt_loss: 1.3936 | pg_loss: 0.1703 | reg_loss: 0.3054 | reward: -0.0691 | rev_kl: 0.3650 | stu_lens: 90.0000 | mixed_lens: 90.5000 | lr: 4.9379e-06 | scale: 2048.00 | time: 26.564 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    168/  1000| tot_loss: 2.8085 | rl_loss: 1.1712 | pt_loss: 1.6373 | pg_loss: 0.5477 | reg_loss: 0.6235 | reward: -0.2995 | rev_kl: 1.4735 | stu_lens: 47.5000 | mixed_lens: 78.0000 | lr: 4.9359e-06 | scale: 2048.00 | time: 26.513 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    169/  1000| tot_loss: 2.8405 | rl_loss: 1.2051 | pt_loss: 1.6353 | pg_loss: 0.3410 | reg_loss: 0.8641 | reward: -0.3693 | rev_kl: 1.4993 | stu_lens: 128.0000 | mixed_lens: 87.0000 | lr: 4.9339e-06 | scale: 2048.00 | time: 26.578 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    170/  1000| tot_loss: 2.7998 | rl_loss: 0.8020 | pt_loss: 1.9978 | pg_loss: 0.0802 | reg_loss: 0.7218 | reward: -0.3910 | rev_kl: 1.3236 | stu_lens: 90.5000 | mixed_lens: 122.5000 | lr: 4.9319e-06 | scale: 2048.00 | time: 26.530 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    171/  1000| tot_loss: 3.7657 | rl_loss: 1.7643 | pt_loss: 2.0014 | pg_loss: 1.4669 | reg_loss: 0.2974 | reward: -0.3794 | rev_kl: 0.5408 | stu_lens: 19.5000 | mixed_lens: 22.0000 | lr: 4.9299e-06 | scale: 2048.00 | time: 26.564 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    172/  1000| tot_loss: 2.2922 | rl_loss: 0.5538 | pt_loss: 1.7384 | pg_loss: 0.0819 | reg_loss: 0.4719 | reward: -0.3301 | rev_kl: 1.1583 | stu_lens: 109.0000 | mixed_lens: 108.0000 | lr: 4.9278e-06 | scale: 2048.00 | time: 26.508 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    173/  1000| tot_loss: 2.0385 | rl_loss: 0.8560 | pt_loss: 1.1826 | pg_loss: 0.2630 | reg_loss: 0.5929 | reward: -0.3442 | rev_kl: 1.3155 | stu_lens: 125.5000 | mixed_lens: 97.0000 | lr: 4.9257e-06 | scale: 2048.00 | time: 26.523 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    174/  1000| tot_loss: 2.8435 | rl_loss: 1.1070 | pt_loss: 1.7364 | pg_loss: 0.3241 | reg_loss: 0.7830 | reward: -0.3970 | rev_kl: 1.2683 | stu_lens: 128.0000 | mixed_lens: 83.0000 | lr: 4.9236e-06 | scale: 2048.00 | time: 26.504 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    175/  1000| tot_loss: 2.0731 | rl_loss: 0.4537 | pt_loss: 1.6194 | pg_loss: 0.0355 | reg_loss: 0.4182 | reward: -1.5374 | rev_kl: 0.9106 | stu_lens: 66.0000 | mixed_lens: 66.0000 | lr: 4.9215e-06 | scale: 2048.00 | time: 26.508 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    176/  1000| tot_loss: 2.3056 | rl_loss: 0.4338 | pt_loss: 1.8718 | pg_loss: 0.0226 | reg_loss: 0.4112 | reward: -0.2729 | rev_kl: 1.1588 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9193e-06 | scale: 2048.00 | time: 26.455 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    176/  1000| tot_loss: 2.4626 | rl_loss: 0.7984 | pt_loss: 1.6642 | pg_loss: 0.2405 | reg_loss: 0.5579 | reward: -0.4117 | rev_kl: 1.1490 | stu_lens: 92.2031 | mixed_lens: 93.9531 | lr: 4.9193e-06 | scale: 2048.00 | time: 26.455 | step time: 27.736
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    177/  1000| tot_loss: 2.1815 | rl_loss: 0.6774 | pt_loss: 1.5041 | pg_loss: 0.2529 | reg_loss: 0.4245 | reward: -0.3013 | rev_kl: 1.0266 | stu_lens: 128.0000 | mixed_lens: 93.5000 | lr: 4.9171e-06 | scale: 2048.00 | time: 26.471 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    178/  1000| tot_loss: 1.7892 | rl_loss: 0.2013 | pt_loss: 1.5879 | pg_loss: -0.0197 | reg_loss: 0.2210 | reward: -0.1392 | rev_kl: 0.8034 | stu_lens: 110.0000 | mixed_lens: 128.0000 | lr: 4.9148e-06 | scale: 2048.00 | time: 26.455 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    179/  1000| tot_loss: 2.8205 | rl_loss: 1.0558 | pt_loss: 1.7646 | pg_loss: 0.6116 | reg_loss: 0.4442 | reward: -0.7009 | rev_kl: 0.9787 | stu_lens: 89.5000 | mixed_lens: 65.0000 | lr: 4.9125e-06 | scale: 2048.00 | time: 26.468 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    180/  1000| tot_loss: 2.7197 | rl_loss: 0.7076 | pt_loss: 2.0122 | pg_loss: 0.2939 | reg_loss: 0.4137 | reward: -0.9743 | rev_kl: 1.0385 | stu_lens: 128.0000 | mixed_lens: 73.0000 | lr: 4.9102e-06 | scale: 2048.00 | time: 26.456 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    181/  1000| tot_loss: 2.3024 | rl_loss: 0.7153 | pt_loss: 1.5872 | pg_loss: 0.2193 | reg_loss: 0.4960 | reward: -0.3342 | rev_kl: 1.4114 | stu_lens: 88.5000 | mixed_lens: 95.5000 | lr: 4.9079e-06 | scale: 2048.00 | time: 26.491 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    182/  1000| tot_loss: 2.4243 | rl_loss: 0.5369 | pt_loss: 1.8874 | pg_loss: 0.0229 | reg_loss: 0.5140 | reward: -0.1846 | rev_kl: 2.6841 | stu_lens: 111.0000 | mixed_lens: 124.5000 | lr: 4.9055e-06 | scale: 2048.00 | time: 26.424 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    183/  1000| tot_loss: 2.3131 | rl_loss: 0.5475 | pt_loss: 1.7656 | pg_loss: 0.0806 | reg_loss: 0.4670 | reward: -0.4175 | rev_kl: 1.2173 | stu_lens: 128.0000 | mixed_lens: 122.5000 | lr: 4.9032e-06 | scale: 2048.00 | time: 26.485 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    184/  1000| tot_loss: 2.0383 | rl_loss: 0.3870 | pt_loss: 1.6513 | pg_loss: 0.0125 | reg_loss: 0.3745 | reward: -0.2357 | rev_kl: 1.2380 | stu_lens: 104.0000 | mixed_lens: 127.5000 | lr: 4.9007e-06 | scale: 2048.00 | time: 26.447 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    185/  1000| tot_loss: 1.9889 | rl_loss: 0.6393 | pt_loss: 1.3496 | pg_loss: -0.0053 | reg_loss: 0.6446 | reward: -0.3152 | rev_kl: 1.1312 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8983e-06 | scale: 2048.00 | time: 26.529 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    186/  1000| tot_loss: 2.6420 | rl_loss: 1.0350 | pt_loss: 1.6069 | pg_loss: 0.3212 | reg_loss: 0.7138 | reward: -0.2095 | rev_kl: 0.9393 | stu_lens: 85.5000 | mixed_lens: 90.5000 | lr: 4.8958e-06 | scale: 2048.00 | time: 26.429 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    187/  1000| tot_loss: 2.9847 | rl_loss: 1.0457 | pt_loss: 1.9390 | pg_loss: 0.6395 | reg_loss: 0.4063 | reward: -0.4517 | rev_kl: 1.1775 | stu_lens: 128.0000 | mixed_lens: 56.0000 | lr: 4.8933e-06 | scale: 2048.00 | time: 26.486 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    188/  1000| tot_loss: 1.4982 | rl_loss: -0.5507 | pt_loss: 2.0489 | pg_loss: -0.8743 | reg_loss: 0.3236 | reward: 0.5058 | rev_kl: 0.8805 | stu_lens: 33.0000 | mixed_lens: 22.5000 | lr: 4.8908e-06 | scale: 2048.00 | time: 26.462 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    189/  1000| tot_loss: 2.3984 | rl_loss: 0.8336 | pt_loss: 1.5648 | pg_loss: 0.5334 | reg_loss: 0.3002 | reward: -0.1289 | rev_kl: 0.4848 | stu_lens: 67.5000 | mixed_lens: 67.5000 | lr: 4.8882e-06 | scale: 2048.00 | time: 26.504 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    190/  1000| tot_loss: 1.9289 | rl_loss: 0.3989 | pt_loss: 1.5300 | pg_loss: 0.1195 | reg_loss: 0.2794 | reward: -0.4888 | rev_kl: 0.7904 | stu_lens: 112.5000 | mixed_lens: 101.5000 | lr: 4.8856e-06 | scale: 2048.00 | time: 26.506 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    191/  1000| tot_loss: 2.6861 | rl_loss: 0.7354 | pt_loss: 1.9507 | pg_loss: 0.2245 | reg_loss: 0.5108 | reward: -1.2393 | rev_kl: 1.1759 | stu_lens: 38.5000 | mixed_lens: 34.5000 | lr: 4.8830e-06 | scale: 2048.00 | time: 26.546 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    192/  1000| tot_loss: 2.5669 | rl_loss: 0.7666 | pt_loss: 1.8004 | pg_loss: 0.2831 | reg_loss: 0.4835 | reward: -0.4158 | rev_kl: 1.0252 | stu_lens: 99.0000 | mixed_lens: 92.0000 | lr: 4.8803e-06 | scale: 2048.00 | time: 26.493 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    192/  1000| tot_loss: 2.3672 | rl_loss: 0.6553 | pt_loss: 1.7119 | pg_loss: 0.2138 | reg_loss: 0.4415 | reward: -0.4265 | rev_kl: 1.0924 | stu_lens: 89.5469 | mixed_lens: 90.1406 | lr: 4.8803e-06 | scale: 2048.00 | time: 26.493 | step time: 27.702
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    193/  1000| tot_loss: 2.1010 | rl_loss: 0.4728 | pt_loss: 1.6282 | pg_loss: 0.0279 | reg_loss: 0.4449 | reward: -0.1208 | rev_kl: 0.8131 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8776e-06 | scale: 2048.00 | time: 26.539 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    194/  1000| tot_loss: 3.0906 | rl_loss: 1.0859 | pt_loss: 2.0047 | pg_loss: 0.0585 | reg_loss: 1.0274 | reward: -0.1467 | rev_kl: 0.8595 | stu_lens: 119.5000 | mixed_lens: 127.0000 | lr: 4.8749e-06 | scale: 2048.00 | time: 26.566 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    195/  1000| tot_loss: 2.7711 | rl_loss: 0.7543 | pt_loss: 2.0169 | pg_loss: 0.0477 | reg_loss: 0.7066 | reward: -0.3338 | rev_kl: 0.8277 | stu_lens: 85.5000 | mixed_lens: 128.0000 | lr: 4.8722e-06 | scale: 2048.00 | time: 26.475 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    196/  1000| tot_loss: 2.9205 | rl_loss: 1.2796 | pt_loss: 1.6408 | pg_loss: 0.2660 | reg_loss: 1.0137 | reward: -0.1634 | rev_kl: 1.1010 | stu_lens: 71.0000 | mixed_lens: 59.5000 | lr: 4.8694e-06 | scale: 2048.00 | time: 26.524 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    197/  1000| tot_loss: 3.0101 | rl_loss: 1.1810 | pt_loss: 1.8291 | pg_loss: 0.2028 | reg_loss: 0.9782 | reward: -0.1511 | rev_kl: 1.0144 | stu_lens: 102.5000 | mixed_lens: 78.0000 | lr: 4.8666e-06 | scale: 2048.00 | time: 26.495 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    198/  1000| tot_loss: 3.3444 | rl_loss: 1.7354 | pt_loss: 1.6089 | pg_loss: 0.4723 | reg_loss: 1.2631 | reward: -0.0165 | rev_kl: 0.7962 | stu_lens: 56.0000 | mixed_lens: 83.0000 | lr: 4.8638e-06 | scale: 2048.00 | time: 26.506 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    199/  1000| tot_loss: 2.3916 | rl_loss: 0.5660 | pt_loss: 1.8256 | pg_loss: 0.1873 | reg_loss: 0.3787 | reward: -0.3317 | rev_kl: 1.4225 | stu_lens: 11.0000 | mixed_lens: 72.0000 | lr: 4.8609e-06 | scale: 2048.00 | time: 26.475 | step time: 0.000
                                 Evaluation #2                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ I am not sure that I can create      │
│                                       │ something new. I am not a creator. I │
│                                       │ am a learner. I learn about new      │
│                                       │ things every day, but I do not       │
│                                       │ create anything new. I am a great    │
│                                       │ observer. I watch people and I       │
│                                       │ observe the world around me. I learn │
│                                       │ from what I observe. I am a great    │
│                                       │ listener, too. I listen to the sound │
│                                       │ of the birds singing. I listen to    │
│                                       │ the water flowing in the river. I    │
│                                       │ listen to the sound of the wind      │
│                                       │ blowing. I listen to the sound of my │
│                                       │ own breathing. I am a great thinker. │
│                                       │ I think about the meaning of         │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ You should try to be more creative.  │
│                                       │ There are many ways to create        │
│                                       │ something new. You can invent        │
│                                       │ something, or you can combine some   │
│                                       │ existing ideas to create something   │
│                                       │ new. You can also improve an         │
│                                       │ existing idea to make it better. You │
│                                       │ can also create something from       │
│                                       │ scratch. The key is to be creative   │
│                                       │ and think outside the box.           │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ That sounds boring. I want to create │
│                                       │ something new.                       │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 15.893 | exact_match: 0.000 | rev_kl: 1.065 | lens: 82.306 | pt_loss: 1.109 | lm_loss: 1.210 | kd_loss: 1.008 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    200/  1000| tot_loss: 2.8901 | rl_loss: 1.1970 | pt_loss: 1.6931 | pg_loss: 0.0670 | reg_loss: 1.1300 | reward: -0.2416 | rev_kl: 1.0908 | stu_lens: 96.5000 | mixed_lens: 128.0000 | lr: 4.8581e-06 | scale: 2048.00 | time: 26.378 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    201/  1000| tot_loss: 2.8422 | rl_loss: 0.8735 | pt_loss: 1.9687 | pg_loss: 0.0367 | reg_loss: 0.8368 | reward: -0.1764 | rev_kl: 1.1350 | stu_lens: 83.5000 | mixed_lens: 128.0000 | lr: 4.8551e-06 | scale: 2048.00 | time: 26.392 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    202/  1000| tot_loss: 4.5669 | rl_loss: 2.7404 | pt_loss: 1.8265 | pg_loss: 1.8903 | reg_loss: 0.8501 | reward: -0.4933 | rev_kl: 1.1794 | stu_lens: 25.5000 | mixed_lens: 14.0000 | lr: 4.8522e-06 | scale: 2048.00 | time: 26.366 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    203/  1000| tot_loss: 3.0999 | rl_loss: 1.4178 | pt_loss: 1.6820 | pg_loss: 0.4304 | reg_loss: 0.9874 | reward: -0.6301 | rev_kl: 0.7927 | stu_lens: 124.5000 | mixed_lens: 79.0000 | lr: 4.8492e-06 | scale: 2048.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    204/  1000| tot_loss: 2.9433 | rl_loss: 1.3550 | pt_loss: 1.5883 | pg_loss: 0.3748 | reg_loss: 0.9802 | reward: -0.8180 | rev_kl: 0.7682 | stu_lens: 128.0000 | mixed_lens: 76.5000 | lr: 4.8462e-06 | scale: 2048.00 | time: 26.361 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    205/  1000| tot_loss: 3.0985 | rl_loss: 1.3629 | pt_loss: 1.7356 | pg_loss: 0.3237 | reg_loss: 1.0392 | reward: -0.5145 | rev_kl: 0.8807 | stu_lens: 128.0000 | mixed_lens: 89.5000 | lr: 4.8432e-06 | scale: 2048.00 | time: 26.327 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    206/  1000| tot_loss: 3.0566 | rl_loss: 1.4682 | pt_loss: 1.5884 | pg_loss: 0.2932 | reg_loss: 1.1750 | reward: -0.3333 | rev_kl: 0.9431 | stu_lens: 128.0000 | mixed_lens: 88.0000 | lr: 4.8401e-06 | scale: 2048.00 | time: 26.360 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    207/  1000| tot_loss: 2.9084 | rl_loss: 1.2434 | pt_loss: 1.6650 | pg_loss: 0.4252 | reg_loss: 0.8182 | reward: -0.2165 | rev_kl: 1.1575 | stu_lens: 84.0000 | mixed_lens: 79.0000 | lr: 4.8371e-06 | scale: 2048.00 | time: 26.328 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    208/  1000| tot_loss: 3.0073 | rl_loss: 1.3022 | pt_loss: 1.7050 | pg_loss: 0.1420 | reg_loss: 1.1602 | reward: -0.2020 | rev_kl: 1.0070 | stu_lens: 94.5000 | mixed_lens: 114.0000 | lr: 4.8340e-06 | scale: 2048.00 | time: 26.412 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    208/  1000| tot_loss: 3.0619 | rl_loss: 1.3806 | pt_loss: 1.6813 | pg_loss: 0.3343 | reg_loss: 1.0464 | reward: -0.3655 | rev_kl: 1.0534 | stu_lens: 88.4688 | mixed_lens: 89.6406 | lr: 4.8340e-06 | scale: 2048.00 | time: 26.412 | step time: 27.648
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    209/  1000| tot_loss: 3.1080 | rl_loss: 1.4455 | pt_loss: 1.6625 | pg_loss: 0.5679 | reg_loss: 0.8776 | reward: -0.2537 | rev_kl: 0.8302 | stu_lens: 108.5000 | mixed_lens: 39.0000 | lr: 4.8308e-06 | scale: 2048.00 | time: 26.424 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    210/  1000| tot_loss: 2.8133 | rl_loss: 0.7874 | pt_loss: 2.0258 | pg_loss: 0.2513 | reg_loss: 0.5362 | reward: -0.0483 | rev_kl: 1.0899 | stu_lens: 71.0000 | mixed_lens: 77.5000 | lr: 4.8276e-06 | scale: 2048.00 | time: 26.379 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    211/  1000| tot_loss: 3.7044 | rl_loss: 2.2628 | pt_loss: 1.4417 | pg_loss: 1.1662 | reg_loss: 1.0966 | reward: -0.7403 | rev_kl: 0.8185 | stu_lens: 128.0000 | mixed_lens: 39.0000 | lr: 4.8244e-06 | scale: 2048.00 | time: 26.388 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    212/  1000| tot_loss: 2.5401 | rl_loss: 0.7685 | pt_loss: 1.7716 | pg_loss: 0.0505 | reg_loss: 0.7179 | reward: -0.3324 | rev_kl: 0.9083 | stu_lens: 75.0000 | mixed_lens: 124.0000 | lr: 4.8212e-06 | scale: 2048.00 | time: 26.336 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    213/  1000| tot_loss: 3.1369 | rl_loss: 0.9879 | pt_loss: 2.1489 | pg_loss: 0.2145 | reg_loss: 0.7735 | reward: -0.3735 | rev_kl: 0.9681 | stu_lens: 119.5000 | mixed_lens: 89.5000 | lr: 4.8180e-06 | scale: 2048.00 | time: 26.359 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    214/  1000| tot_loss: 3.2312 | rl_loss: 1.2015 | pt_loss: 2.0297 | pg_loss: 0.3648 | reg_loss: 0.8367 | reward: -0.6270 | rev_kl: 1.1181 | stu_lens: 77.0000 | mixed_lens: 81.5000 | lr: 4.8147e-06 | scale: 2048.00 | time: 26.385 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    215/  1000| tot_loss: 2.3237 | rl_loss: 0.4250 | pt_loss: 1.8987 | pg_loss: -0.0140 | reg_loss: 0.4390 | reward: -0.1635 | rev_kl: 1.1707 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8114e-06 | scale: 2048.00 | time: 26.361 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    216/  1000| tot_loss: 2.8582 | rl_loss: 0.8757 | pt_loss: 1.9824 | pg_loss: 0.0307 | reg_loss: 0.8450 | reward: -0.1358 | rev_kl: 1.4579 | stu_lens: 113.5000 | mixed_lens: 125.0000 | lr: 4.8080e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    217/  1000| tot_loss: 3.4688 | rl_loss: 1.4351 | pt_loss: 2.0338 | pg_loss: 0.3453 | reg_loss: 1.0898 | reward: -0.3338 | rev_kl: 3.6884 | stu_lens: 11.0000 | mixed_lens: 73.5000 | lr: 4.8047e-06 | scale: 2048.00 | time: 26.345 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    218/  1000| tot_loss: 3.4399 | rl_loss: 1.5045 | pt_loss: 1.9354 | pg_loss: 0.8623 | reg_loss: 0.6422 | reward: -0.2626 | rev_kl: 1.1317 | stu_lens: 64.5000 | mixed_lens: 42.5000 | lr: 4.8013e-06 | scale: 2048.00 | time: 26.344 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    219/  1000| tot_loss: 2.9799 | rl_loss: 1.1555 | pt_loss: 1.8244 | pg_loss: 0.4928 | reg_loss: 0.6627 | reward: -0.1443 | rev_kl: 1.0379 | stu_lens: 82.5000 | mixed_lens: 73.5000 | lr: 4.7978e-06 | scale: 2048.00 | time: 26.344 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    220/  1000| tot_loss: 2.2557 | rl_loss: 0.6643 | pt_loss: 1.5914 | pg_loss: -0.0049 | reg_loss: 0.6692 | reward: -0.1443 | rev_kl: 1.2497 | stu_lens: 83.5000 | mixed_lens: 128.0000 | lr: 4.7944e-06 | scale: 2048.00 | time: 26.430 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    221/  1000| tot_loss: 3.1005 | rl_loss: 1.1778 | pt_loss: 1.9228 | pg_loss: 0.2649 | reg_loss: 0.9128 | reward: -0.3607 | rev_kl: 0.9751 | stu_lens: 123.0000 | mixed_lens: 88.0000 | lr: 4.7909e-06 | scale: 2048.00 | time: 26.376 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    222/  1000| tot_loss: 2.5915 | rl_loss: 0.8240 | pt_loss: 1.7675 | pg_loss: 0.1041 | reg_loss: 0.7199 | reward: -0.2751 | rev_kl: 1.1267 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 4.7874e-06 | scale: 2048.00 | time: 26.406 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    223/  1000| tot_loss: 2.5617 | rl_loss: 0.7711 | pt_loss: 1.7906 | pg_loss: -0.0129 | reg_loss: 0.7840 | reward: -0.2736 | rev_kl: 1.5808 | stu_lens: 99.0000 | mixed_lens: 128.0000 | lr: 4.7839e-06 | scale: 2048.00 | time: 26.369 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    224/  1000| tot_loss: 3.1707 | rl_loss: 1.2144 | pt_loss: 1.9563 | pg_loss: 0.2728 | reg_loss: 0.9416 | reward: -0.1587 | rev_kl: 0.7004 | stu_lens: 60.0000 | mixed_lens: 86.0000 | lr: 4.7803e-06 | scale: 2048.00 | time: 26.386 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    224/  1000| tot_loss: 2.9610 | rl_loss: 1.1288 | pt_loss: 1.8321 | pg_loss: 0.3589 | reg_loss: 0.7700 | reward: -0.3773 | rev_kl: 1.1823 | stu_lens: 83.0469 | mixed_lens: 85.9375 | lr: 4.7803e-06 | scale: 2048.00 | time: 26.386 | step time: 27.584
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    225/  1000| tot_loss: 2.1274 | rl_loss: 0.7330 | pt_loss: 1.3944 | pg_loss: 0.0955 | reg_loss: 0.6375 | reward: -0.1579 | rev_kl: 0.8924 | stu_lens: 128.0000 | mixed_lens: 104.5000 | lr: 4.7767e-06 | scale: 2048.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    226/  1000| tot_loss: 2.5032 | rl_loss: 0.5506 | pt_loss: 1.9526 | pg_loss: 0.1439 | reg_loss: 0.4067 | reward: -0.2419 | rev_kl: 1.7095 | stu_lens: 16.0000 | mixed_lens: 27.0000 | lr: 4.7731e-06 | scale: 2048.00 | time: 26.376 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    227/  1000| tot_loss: 2.0577 | rl_loss: 0.7193 | pt_loss: 1.3384 | pg_loss: 0.1118 | reg_loss: 0.6075 | reward: -0.3735 | rev_kl: 1.1972 | stu_lens: 128.0000 | mixed_lens: 107.0000 | lr: 4.7694e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    228/  1000| tot_loss: 2.0372 | rl_loss: 0.5499 | pt_loss: 1.4874 | pg_loss: -0.0008 | reg_loss: 0.5506 | reward: -0.2475 | rev_kl: 1.2114 | stu_lens: 83.5000 | mixed_lens: 128.0000 | lr: 4.7658e-06 | scale: 2048.00 | time: 26.365 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    229/  1000| tot_loss: 2.1494 | rl_loss: 0.5288 | pt_loss: 1.6206 | pg_loss: 0.2663 | reg_loss: 0.2625 | reward: -0.6620 | rev_kl: 0.6114 | stu_lens: 85.5000 | mixed_lens: 79.0000 | lr: 4.7621e-06 | scale: 2048.00 | time: 26.365 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    230/  1000| tot_loss: 2.4976 | rl_loss: 0.6006 | pt_loss: 1.8970 | pg_loss: 0.0890 | reg_loss: 0.5116 | reward: -0.2184 | rev_kl: 1.3043 | stu_lens: 91.0000 | mixed_lens: 114.5000 | lr: 4.7583e-06 | scale: 2048.00 | time: 26.361 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    231/  1000| tot_loss: 2.9366 | rl_loss: 0.8575 | pt_loss: 2.0792 | pg_loss: 0.2829 | reg_loss: 0.5746 | reward: -0.2091 | rev_kl: 1.0802 | stu_lens: 113.5000 | mixed_lens: 87.0000 | lr: 4.7546e-06 | scale: 2048.00 | time: 26.322 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    232/  1000| tot_loss: 2.4939 | rl_loss: 0.6051 | pt_loss: 1.8888 | pg_loss: 0.0552 | reg_loss: 0.5499 | reward: -0.2703 | rev_kl: 0.8841 | stu_lens: 128.0000 | mixed_lens: 110.0000 | lr: 4.7508e-06 | scale: 2048.00 | time: 26.380 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    233/  1000| tot_loss: 3.0237 | rl_loss: 0.6330 | pt_loss: 2.3907 | pg_loss: 0.1169 | reg_loss: 0.5161 | reward: -0.2355 | rev_kl: 0.9498 | stu_lens: 67.5000 | mixed_lens: 109.0000 | lr: 4.7470e-06 | scale: 2048.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    234/  1000| tot_loss: 1.8350 | rl_loss: 0.4306 | pt_loss: 1.4044 | pg_loss: -0.0102 | reg_loss: 0.4407 | reward: -0.1489 | rev_kl: 0.9590 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7431e-06 | scale: 2048.00 | time: 26.405 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    235/  1000| tot_loss: 2.2650 | rl_loss: 0.4703 | pt_loss: 1.7947 | pg_loss: 0.0009 | reg_loss: 0.4694 | reward: -0.3020 | rev_kl: 1.0091 | stu_lens: 124.5000 | mixed_lens: 128.0000 | lr: 4.7393e-06 | scale: 2048.00 | time: 26.387 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    236/  1000| tot_loss: 2.2508 | rl_loss: 0.9640 | pt_loss: 1.2868 | pg_loss: 0.4720 | reg_loss: 0.4921 | reward: -0.1366 | rev_kl: 1.3341 | stu_lens: 54.5000 | mixed_lens: 73.5000 | lr: 4.7354e-06 | scale: 2048.00 | time: 26.390 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    237/  1000| tot_loss: 3.4183 | rl_loss: 1.6723 | pt_loss: 1.7460 | pg_loss: 1.0811 | reg_loss: 0.5912 | reward: -1.2680 | rev_kl: 0.8340 | stu_lens: 14.5000 | mixed_lens: 19.0000 | lr: 4.7315e-06 | scale: 2048.00 | time: 26.370 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    238/  1000| tot_loss: 2.2619 | rl_loss: 0.7677 | pt_loss: 1.4942 | pg_loss: 0.4577 | reg_loss: 0.3100 | reward: -0.4821 | rev_kl: 0.8316 | stu_lens: 77.0000 | mixed_lens: 81.5000 | lr: 4.7275e-06 | scale: 2048.00 | time: 26.347 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    239/  1000| tot_loss: 2.4654 | rl_loss: 0.3528 | pt_loss: 2.1127 | pg_loss: 0.0217 | reg_loss: 0.3310 | reward: -0.1370 | rev_kl: 1.1967 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7235e-06 | scale: 2048.00 | time: 26.354 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    240/  1000| tot_loss: 2.2764 | rl_loss: 0.6122 | pt_loss: 1.6642 | pg_loss: 0.0961 | reg_loss: 0.5161 | reward: -0.1468 | rev_kl: 0.5182 | stu_lens: 128.0000 | mixed_lens: 85.5000 | lr: 4.7195e-06 | scale: 2048.00 | time: 26.365 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    240/  1000| tot_loss: 2.5081 | rl_loss: 0.7753 | pt_loss: 1.7328 | pg_loss: 0.2774 | reg_loss: 0.4979 | reward: -0.3670 | rev_kl: 1.1104 | stu_lens: 87.0781 | mixed_lens: 86.6562 | lr: 4.7195e-06 | scale: 2048.00 | time: 26.365 | step time: 27.585
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    241/  1000| tot_loss: 3.0032 | rl_loss: 1.3656 | pt_loss: 1.6376 | pg_loss: 0.4627 | reg_loss: 0.9029 | reward: -0.2845 | rev_kl: 1.1066 | stu_lens: 75.0000 | mixed_lens: 63.0000 | lr: 4.7155e-06 | scale: 2048.00 | time: 26.327 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    242/  1000| tot_loss: 2.8009 | rl_loss: 0.9298 | pt_loss: 1.8711 | pg_loss: 0.4939 | reg_loss: 0.4359 | reward: -0.3127 | rev_kl: 1.6010 | stu_lens: 69.5000 | mixed_lens: 72.0000 | lr: 4.7115e-06 | scale: 2048.00 | time: 26.362 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    243/  1000| tot_loss: 2.4232 | rl_loss: 0.7584 | pt_loss: 1.6648 | pg_loss: 0.2136 | reg_loss: 0.5448 | reward: -0.5421 | rev_kl: 1.2575 | stu_lens: 104.0000 | mixed_lens: 75.5000 | lr: 4.7074e-06 | scale: 2048.00 | time: 26.329 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    244/  1000| tot_loss: 2.3568 | rl_loss: 0.4772 | pt_loss: 1.8796 | pg_loss: 0.0413 | reg_loss: 0.4359 | reward: -0.2826 | rev_kl: 0.8584 | stu_lens: 75.0000 | mixed_lens: 123.0000 | lr: 4.7033e-06 | scale: 2048.00 | time: 26.362 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    245/  1000| tot_loss: 2.0415 | rl_loss: 0.4618 | pt_loss: 1.5797 | pg_loss: -0.0278 | reg_loss: 0.4895 | reward: -0.2121 | rev_kl: 1.0643 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6991e-06 | scale: 2048.00 | time: 26.353 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    246/  1000| tot_loss: 2.2742 | rl_loss: 0.2990 | pt_loss: 1.9752 | pg_loss: 0.0044 | reg_loss: 0.2947 | reward: -0.1438 | rev_kl: 0.8704 | stu_lens: 124.5000 | mixed_lens: 128.0000 | lr: 4.6950e-06 | scale: 2048.00 | time: 26.409 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    247/  1000| tot_loss: 2.7814 | rl_loss: 0.7708 | pt_loss: 2.0106 | pg_loss: 0.2858 | reg_loss: 0.4850 | reward: -0.3378 | rev_kl: 3.2356 | stu_lens: 22.5000 | mixed_lens: 78.0000 | lr: 4.6908e-06 | scale: 2048.00 | time: 26.364 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    248/  1000| tot_loss: 2.4548 | rl_loss: 1.0733 | pt_loss: 1.3815 | pg_loss: 0.5049 | reg_loss: 0.5684 | reward: -0.1282 | rev_kl: 0.5440 | stu_lens: 65.5000 | mixed_lens: 67.0000 | lr: 4.6865e-06 | scale: 2048.00 | time: 26.380 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    249/  1000| tot_loss: 2.4868 | rl_loss: 0.6314 | pt_loss: 1.8554 | pg_loss: 0.2066 | reg_loss: 0.4248 | reward: -0.1039 | rev_kl: 1.0398 | stu_lens: 120.0000 | mixed_lens: 98.5000 | lr: 4.6823e-06 | scale: 2048.00 | time: 26.398 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    250/  1000| tot_loss: 2.3892 | rl_loss: 0.6985 | pt_loss: 1.6907 | pg_loss: 0.0909 | reg_loss: 0.6076 | reward: -0.1468 | rev_kl: 0.5182 | stu_lens: 128.0000 | mixed_lens: 85.5000 | lr: 4.6780e-06 | scale: 2048.00 | time: 26.373 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    251/  1000| tot_loss: 2.9081 | rl_loss: 0.7668 | pt_loss: 2.1413 | pg_loss: 0.3608 | reg_loss: 0.4060 | reward: -0.2973 | rev_kl: 0.8944 | stu_lens: 108.5000 | mixed_lens: 77.0000 | lr: 4.6737e-06 | scale: 2048.00 | time: 26.345 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    252/  1000| tot_loss: 1.7906 | rl_loss: 0.6258 | pt_loss: 1.1648 | pg_loss: 0.2728 | reg_loss: 0.3530 | reward: -0.2716 | rev_kl: 1.0394 | stu_lens: 83.5000 | mixed_lens: 90.0000 | lr: 4.6694e-06 | scale: 2048.00 | time: 26.369 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    253/  1000| tot_loss: 2.8125 | rl_loss: 0.7708 | pt_loss: 2.0417 | pg_loss: 0.3994 | reg_loss: 0.3714 | reward: -0.6891 | rev_kl: 1.2074 | stu_lens: 57.0000 | mixed_lens: 68.5000 | lr: 4.6651e-06 | scale: 2048.00 | time: 26.329 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    254/  1000| tot_loss: 2.1631 | rl_loss: 0.5950 | pt_loss: 1.5681 | pg_loss: 0.1201 | reg_loss: 0.4749 | reward: -0.2490 | rev_kl: 1.2273 | stu_lens: 113.5000 | mixed_lens: 104.0000 | lr: 4.6607e-06 | scale: 2048.00 | time: 26.355 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    255/  1000| tot_loss: 2.0931 | rl_loss: 0.4503 | pt_loss: 1.6428 | pg_loss: 0.1173 | reg_loss: 0.3329 | reward: -0.2074 | rev_kl: 1.0437 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 4.6563e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    256/  1000| tot_loss: 1.7885 | rl_loss: 0.1597 | pt_loss: 1.6288 | pg_loss: 0.0316 | reg_loss: 0.1281 | reward: -0.1220 | rev_kl: 0.8066 | stu_lens: 44.0000 | mixed_lens: 78.0000 | lr: 4.6519e-06 | scale: 2048.00 | time: 26.347 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    256/  1000| tot_loss: 2.4475 | rl_loss: 0.7112 | pt_loss: 1.7363 | pg_loss: 0.2857 | reg_loss: 0.4255 | reward: -0.3662 | rev_kl: 1.1070 | stu_lens: 85.0000 | mixed_lens: 86.3750 | lr: 4.6519e-06 | scale: 2048.00 | time: 26.347 | step time: 27.579
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    257/  1000| tot_loss: 2.0935 | rl_loss: 0.4706 | pt_loss: 1.6230 | pg_loss: 0.0311 | reg_loss: 0.4395 | reward: -0.2374 | rev_kl: 1.2242 | stu_lens: 96.5000 | mixed_lens: 128.0000 | lr: 4.6474e-06 | scale: 2048.00 | time: 26.340 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    258/  1000| tot_loss: 3.1099 | rl_loss: 1.7570 | pt_loss: 1.3530 | pg_loss: 0.1838 | reg_loss: 1.5732 | reward: -0.3014 | rev_kl: 1.2859 | stu_lens: 128.0000 | mixed_lens: 102.5000 | lr: 4.6429e-06 | scale: 2048.00 | time: 26.371 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    259/  1000| tot_loss: 4.0763 | rl_loss: 2.3766 | pt_loss: 1.6998 | pg_loss: 1.2679 | reg_loss: 1.1087 | reward: -1.6461 | rev_kl: 1.1884 | stu_lens: 68.5000 | mixed_lens: 25.5000 | lr: 4.6384e-06 | scale: 2048.00 | time: 26.374 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    260/  1000| tot_loss: 3.0745 | rl_loss: 1.4544 | pt_loss: 1.6200 | pg_loss: 0.2828 | reg_loss: 1.1716 | reward: -0.6370 | rev_kl: 0.6151 | stu_lens: 84.0000 | mixed_lens: 96.0000 | lr: 4.6339e-06 | scale: 2048.00 | time: 26.328 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    261/  1000| tot_loss: 3.2367 | rl_loss: 1.6306 | pt_loss: 1.6061 | pg_loss: 0.2159 | reg_loss: 1.4147 | reward: -0.1882 | rev_kl: 1.1916 | stu_lens: 98.0000 | mixed_lens: 97.5000 | lr: 4.6293e-06 | scale: 2048.00 | time: 26.362 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    262/  1000| tot_loss: 2.9785 | rl_loss: 1.0947 | pt_loss: 1.8838 | pg_loss: 0.0658 | reg_loss: 1.0290 | reward: -0.1939 | rev_kl: 0.9354 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6247e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    263/  1000| tot_loss: 3.3496 | rl_loss: 1.7844 | pt_loss: 1.5653 | pg_loss: 0.5466 | reg_loss: 1.2378 | reward: -0.3781 | rev_kl: 1.5094 | stu_lens: 105.5000 | mixed_lens: 64.0000 | lr: 4.6201e-06 | scale: 2048.00 | time: 26.348 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    264/  1000| tot_loss: 2.8167 | rl_loss: 0.9082 | pt_loss: 1.9085 | pg_loss: 0.1226 | reg_loss: 0.7855 | reward: -0.1419 | rev_kl: 0.5952 | stu_lens: 78.5000 | mixed_lens: 108.0000 | lr: 4.6155e-06 | scale: 2048.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    265/  1000| tot_loss: 3.7628 | rl_loss: 2.1538 | pt_loss: 1.6091 | pg_loss: 0.5443 | reg_loss: 1.6095 | reward: -0.9006 | rev_kl: 0.8070 | stu_lens: 45.5000 | mixed_lens: 46.0000 | lr: 4.6108e-06 | scale: 2048.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    266/  1000| tot_loss: 4.4149 | rl_loss: 2.5157 | pt_loss: 1.8992 | pg_loss: 0.7130 | reg_loss: 1.8028 | reward: -0.5766 | rev_kl: 1.3084 | stu_lens: 67.0000 | mixed_lens: 66.0000 | lr: 4.6061e-06 | scale: 2048.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    267/  1000| tot_loss: 3.4653 | rl_loss: 1.2561 | pt_loss: 2.2092 | pg_loss: 0.0613 | reg_loss: 1.1949 | reward: 0.0102 | rev_kl: 1.1752 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6014e-06 | scale: 2048.00 | time: 26.365 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    268/  1000| tot_loss: 2.8042 | rl_loss: 0.9826 | pt_loss: 1.8216 | pg_loss: 0.0726 | reg_loss: 0.9100 | reward: -0.2338 | rev_kl: 0.4900 | stu_lens: 111.0000 | mixed_lens: 122.0000 | lr: 4.5967e-06 | scale: 2048.00 | time: 26.360 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    269/  1000| tot_loss: 2.7529 | rl_loss: 0.7942 | pt_loss: 1.9588 | pg_loss: 0.0132 | reg_loss: 0.7809 | reward: -0.3210 | rev_kl: 0.9680 | stu_lens: 106.5000 | mixed_lens: 128.0000 | lr: 4.5919e-06 | scale: 2048.00 | time: 26.385 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    270/  1000| tot_loss: 2.5224 | rl_loss: 1.1110 | pt_loss: 1.4114 | pg_loss: 0.1109 | reg_loss: 1.0001 | reward: -0.3012 | rev_kl: 1.7206 | stu_lens: 47.5000 | mixed_lens: 96.0000 | lr: 4.5871e-06 | scale: 2048.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    271/  1000| tot_loss: 2.7883 | rl_loss: 1.1685 | pt_loss: 1.6198 | pg_loss: 0.4591 | reg_loss: 0.7094 | reward: -0.3981 | rev_kl: 1.5291 | stu_lens: 64.0000 | mixed_lens: 68.0000 | lr: 4.5823e-06 | scale: 2048.00 | time: 26.367 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    272/  1000| tot_loss: 2.7898 | rl_loss: 1.0493 | pt_loss: 1.7405 | pg_loss: 0.0804 | reg_loss: 0.9689 | reward: -0.2435 | rev_kl: 0.8004 | stu_lens: 105.5000 | mixed_lens: 117.0000 | lr: 4.5775e-06 | scale: 2048.00 | time: 26.337 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    272/  1000| tot_loss: 3.1792 | rl_loss: 1.4816 | pt_loss: 1.6976 | pg_loss: 0.4431 | reg_loss: 1.0385 | reward: -0.2989 | rev_kl: 1.0303 | stu_lens: 84.4844 | mixed_lens: 83.8750 | lr: 4.5775e-06 | scale: 2048.00 | time: 26.337 | step time: 27.578
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    273/  1000| tot_loss: 4.3634 | rl_loss: 2.2871 | pt_loss: 2.0762 | pg_loss: 1.3975 | reg_loss: 0.8897 | reward: -0.3265 | rev_kl: 1.0729 | stu_lens: 48.0000 | mixed_lens: 20.0000 | lr: 4.5726e-06 | scale: 2048.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    274/  1000| tot_loss: 4.4176 | rl_loss: 2.8159 | pt_loss: 1.6018 | pg_loss: 1.6773 | reg_loss: 1.1386 | reward: -0.1854 | rev_kl: 0.9494 | stu_lens: 43.0000 | mixed_lens: 23.0000 | lr: 4.5677e-06 | scale: 2048.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    275/  1000| tot_loss: 4.0072 | rl_loss: 1.9788 | pt_loss: 2.0285 | pg_loss: 0.4801 | reg_loss: 1.4987 | reward: -0.2182 | rev_kl: 0.7918 | stu_lens: 55.0000 | mixed_lens: 76.0000 | lr: 4.5628e-06 | scale: 2048.00 | time: 26.338 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    276/  1000| tot_loss: 2.4000 | rl_loss: 0.8046 | pt_loss: 1.5954 | pg_loss: 0.1535 | reg_loss: 0.6512 | reward: -0.3961 | rev_kl: 1.0184 | stu_lens: 83.0000 | mixed_lens: 84.5000 | lr: 4.5578e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    277/  1000| tot_loss: 3.6760 | rl_loss: 1.8252 | pt_loss: 1.8508 | pg_loss: 0.5843 | reg_loss: 1.2409 | reward: -0.7693 | rev_kl: 0.9455 | stu_lens: 109.0000 | mixed_lens: 57.0000 | lr: 4.5529e-06 | scale: 2048.00 | time: 26.348 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    278/  1000| tot_loss: 2.3944 | rl_loss: 0.5712 | pt_loss: 1.8231 | pg_loss: 0.0325 | reg_loss: 0.5387 | reward: -0.1975 | rev_kl: 0.5486 | stu_lens: 125.0000 | mixed_lens: 122.0000 | lr: 4.5479e-06 | scale: 2048.00 | time: 26.320 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    279/  1000| tot_loss: 2.6713 | rl_loss: 1.3983 | pt_loss: 1.2730 | pg_loss: 0.7016 | reg_loss: 0.6967 | reward: 0.0391 | rev_kl: 1.1335 | stu_lens: 67.0000 | mixed_lens: 36.0000 | lr: 4.5429e-06 | scale: 2048.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    280/  1000| tot_loss: 2.5504 | rl_loss: 0.7427 | pt_loss: 1.8077 | pg_loss: 0.1742 | reg_loss: 0.5685 | reward: -0.6691 | rev_kl: 0.7951 | stu_lens: 83.0000 | mixed_lens: 76.0000 | lr: 4.5378e-06 | scale: 2048.00 | time: 26.365 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    281/  1000| tot_loss: 2.5218 | rl_loss: 0.9286 | pt_loss: 1.5932 | pg_loss: 0.4423 | reg_loss: 0.4863 | reward: -0.5422 | rev_kl: 0.5466 | stu_lens: 41.5000 | mixed_lens: 60.0000 | lr: 4.5328e-06 | scale: 2048.00 | time: 26.373 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    282/  1000| tot_loss: 2.7069 | rl_loss: 0.6161 | pt_loss: 2.0909 | pg_loss: 0.0634 | reg_loss: 0.5527 | reward: -0.0773 | rev_kl: 0.5126 | stu_lens: 82.0000 | mixed_lens: 94.0000 | lr: 4.5277e-06 | scale: 2048.00 | time: 26.413 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    283/  1000| tot_loss: 2.6559 | rl_loss: 0.8034 | pt_loss: 1.8525 | pg_loss: 0.0078 | reg_loss: 0.7956 | reward: -0.3007 | rev_kl: 0.9540 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5225e-06 | scale: 2048.00 | time: 26.425 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    284/  1000| tot_loss: 2.4874 | rl_loss: 0.8656 | pt_loss: 1.6218 | pg_loss: 0.0468 | reg_loss: 0.8188 | reward: -0.0929 | rev_kl: 1.5907 | stu_lens: 74.0000 | mixed_lens: 111.5000 | lr: 4.5174e-06 | scale: 2048.00 | time: 26.347 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    285/  1000| tot_loss: 2.5634 | rl_loss: 1.0523 | pt_loss: 1.5111 | pg_loss: 0.1738 | reg_loss: 0.8785 | reward: -0.3612 | rev_kl: 1.6208 | stu_lens: 46.5000 | mixed_lens: 41.0000 | lr: 4.5122e-06 | scale: 2048.00 | time: 26.363 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    286/  1000| tot_loss: 2.9866 | rl_loss: 1.1553 | pt_loss: 1.8313 | pg_loss: 0.2620 | reg_loss: 0.8933 | reward: 1.6748 | rev_kl: 1.4107 | stu_lens: 65.5000 | mixed_lens: 65.0000 | lr: 4.5070e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    287/  1000| tot_loss: 2.4550 | rl_loss: 0.9065 | pt_loss: 1.5484 | pg_loss: -0.0113 | reg_loss: 0.9178 | reward: -0.0917 | rev_kl: 0.5270 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5018e-06 | scale: 2048.00 | time: 26.350 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    288/  1000| tot_loss: 2.4011 | rl_loss: 0.6998 | pt_loss: 1.7013 | pg_loss: 0.1297 | reg_loss: 0.5701 | reward: -0.4474 | rev_kl: 1.2784 | stu_lens: 101.5000 | mixed_lens: 96.0000 | lr: 4.4966e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    288/  1000| tot_loss: 2.9026 | rl_loss: 1.2234 | pt_loss: 1.6792 | pg_loss: 0.4033 | reg_loss: 0.8201 | reward: -0.3554 | rev_kl: 1.0646 | stu_lens: 79.8594 | mixed_lens: 79.1406 | lr: 4.4966e-06 | scale: 2048.00 | time: 26.316 | step time: 27.571
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    289/  1000| tot_loss: 2.9705 | rl_loss: 1.3803 | pt_loss: 1.5902 | pg_loss: 0.3739 | reg_loss: 1.0064 | reward: -0.2599 | rev_kl: 1.0241 | stu_lens: 78.0000 | mixed_lens: 72.0000 | lr: 4.4913e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    290/  1000| tot_loss: 2.3646 | rl_loss: 0.5270 | pt_loss: 1.8376 | pg_loss: 0.1275 | reg_loss: 0.3995 | reward: -0.2986 | rev_kl: 1.0363 | stu_lens: 128.0000 | mixed_lens: 106.5000 | lr: 4.4860e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    291/  1000| tot_loss: 2.5835 | rl_loss: 0.6269 | pt_loss: 1.9565 | pg_loss: 0.2920 | reg_loss: 0.3350 | reward: -0.1129 | rev_kl: 0.5202 | stu_lens: 75.5000 | mixed_lens: 76.0000 | lr: 4.4807e-06 | scale: 2048.00 | time: 26.368 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    292/  1000| tot_loss: 2.2245 | rl_loss: 0.6636 | pt_loss: 1.5609 | pg_loss: 0.0611 | reg_loss: 0.6025 | reward: -0.2807 | rev_kl: 1.0254 | stu_lens: 78.0000 | mixed_lens: 110.0000 | lr: 4.4754e-06 | scale: 2048.00 | time: 26.362 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    293/  1000| tot_loss: 3.6048 | rl_loss: 1.6165 | pt_loss: 1.9883 | pg_loss: 0.7524 | reg_loss: 0.8641 | reward: 0.0251 | rev_kl: 1.5833 | stu_lens: 40.5000 | mixed_lens: 35.0000 | lr: 4.4700e-06 | scale: 2048.00 | time: 26.396 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    294/  1000| tot_loss: 2.4465 | rl_loss: 1.1734 | pt_loss: 1.2731 | pg_loss: 0.6782 | reg_loss: 0.4952 | reward: -0.5265 | rev_kl: 0.8058 | stu_lens: 39.5000 | mixed_lens: 39.0000 | lr: 4.4646e-06 | scale: 2048.00 | time: 26.363 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    295/  1000| tot_loss: 2.5415 | rl_loss: 0.6548 | pt_loss: 1.8867 | pg_loss: 0.0322 | reg_loss: 0.6226 | reward: -0.3560 | rev_kl: 0.9317 | stu_lens: 104.5000 | mixed_lens: 122.0000 | lr: 4.4592e-06 | scale: 2048.00 | time: 26.375 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    296/  1000| tot_loss: 3.2114 | rl_loss: 1.4896 | pt_loss: 1.7219 | pg_loss: 0.4271 | reg_loss: 1.0624 | reward: -1.1270 | rev_kl: 1.6079 | stu_lens: 83.0000 | mixed_lens: 35.0000 | lr: 4.4538e-06 | scale: 2048.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    297/  1000| tot_loss: 2.4027 | rl_loss: 0.4486 | pt_loss: 1.9540 | pg_loss: 0.1310 | reg_loss: 0.3176 | reward: -0.1629 | rev_kl: 0.7173 | stu_lens: 128.0000 | mixed_lens: 85.0000 | lr: 4.4483e-06 | scale: 2048.00 | time: 26.362 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    298/  1000| tot_loss: 2.7474 | rl_loss: 0.7068 | pt_loss: 2.0406 | pg_loss: 0.0680 | reg_loss: 0.6388 | reward: -0.1071 | rev_kl: 1.1801 | stu_lens: 128.0000 | mixed_lens: 119.0000 | lr: 4.4429e-06 | scale: 2048.00 | time: 26.322 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    299/  1000| tot_loss: 3.3509 | rl_loss: 1.4891 | pt_loss: 1.8617 | pg_loss: 0.5852 | reg_loss: 0.9039 | reward: -1.4897 | rev_kl: 0.9533 | stu_lens: 68.5000 | mixed_lens: 68.5000 | lr: 4.4374e-06 | scale: 2048.00 | time: 26.348 | step time: 0.000
                                 Evaluation #3                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ That's ok. You can create something  │
│                                       │ new by combining two or more         │
│                                       │ existing things. For example, you    │
│                                       │ can combine a dog and a cat to       │
│                                       │ create a dogcat. That's a new        │
│                                       │ creature.                            │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ That's great! I'll provide you with  │
│                                       │ some ideas.                          │
│                                       │                                      │
│                                       │ - You can create a website.          │
│                                       │ - You can create an app.             │
│                                       │ - You can create a game.             │
│                                       │ - You can create a business.         │
│                                       │ - You can create a piece of art.     │
│                                       │ - You can create a book.             │
│                                       │ - You can create a film.             │
│                                       │ - You can create a TV show.          │
│                                       │ - You can create a podcast.          │
│                                       │ - You can create a play.             │
│                                       │ - You can create a piece of music.   │
│                                       │ - You can create a dance.            │
│                                       │ - You can create a sport.            │
│                                       │ - You                                │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ That's fine. You can create          │
│                                       │ something new. But you have to make  │
│                                       │ sure that it is not boring.          │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 15.381 | exact_match: 0.000 | rev_kl: 1.057 | lens: 94.217 | pt_loss: 1.104 | lm_loss: 1.202 | kd_loss: 1.007 
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    300/  1000| tot_loss: 2.2641 | rl_loss: 0.6298 | pt_loss: 1.6343 | pg_loss: 0.1498 | reg_loss: 0.4799 | reward: -0.5905 | rev_kl: 1.0646 | stu_lens: 117.0000 | mixed_lens: 78.5000 | lr: 4.4318e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    301/  1000| tot_loss: 2.4997 | rl_loss: 0.7531 | pt_loss: 1.7466 | pg_loss: 0.3850 | reg_loss: 0.3682 | reward: -0.9292 | rev_kl: 0.6388 | stu_lens: 56.0000 | mixed_lens: 76.5000 | lr: 4.4263e-06 | scale: 2048.00 | time: 26.418 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    302/  1000| tot_loss: 3.1122 | rl_loss: 1.4800 | pt_loss: 1.6322 | pg_loss: 1.0127 | reg_loss: 0.4673 | reward: -0.5559 | rev_kl: 1.4790 | stu_lens: 43.5000 | mixed_lens: 28.5000 | lr: 4.4207e-06 | scale: 2048.00 | time: 26.355 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    303/  1000| tot_loss: 2.0525 | rl_loss: 0.6032 | pt_loss: 1.4493 | pg_loss: 0.2966 | reg_loss: 0.3066 | reward: -0.5319 | rev_kl: 0.1308 | stu_lens: 34.5000 | mixed_lens: 76.0000 | lr: 4.4151e-06 | scale: 2048.00 | time: 26.358 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    304/  1000| tot_loss: 2.5442 | rl_loss: 0.7666 | pt_loss: 1.7776 | pg_loss: 0.3468 | reg_loss: 0.4199 | reward: 0.2822 | rev_kl: 0.6299 | stu_lens: 66.5000 | mixed_lens: 69.0000 | lr: 4.4095e-06 | scale: 2048.00 | time: 26.382 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    304/  1000| tot_loss: 2.6426 | rl_loss: 0.8917 | pt_loss: 1.7508 | pg_loss: 0.3197 | reg_loss: 0.5720 | reward: -0.3543 | rev_kl: 1.0358 | stu_lens: 81.5312 | mixed_lens: 80.4375 | lr: 4.4095e-06 | scale: 2048.00 | time: 26.382 | step time: 27.581
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    305/  1000| tot_loss: 2.5477 | rl_loss: 0.6701 | pt_loss: 1.8776 | pg_loss: 0.1886 | reg_loss: 0.4815 | reward: -0.3052 | rev_kl: 0.7596 | stu_lens: 82.0000 | mixed_lens: 90.5000 | lr: 4.4038e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    306/  1000| tot_loss: 2.7514 | rl_loss: 1.0387 | pt_loss: 1.7127 | pg_loss: 0.6373 | reg_loss: 0.4013 | reward: -1.6911 | rev_kl: 1.2262 | stu_lens: 68.5000 | mixed_lens: 47.0000 | lr: 4.3982e-06 | scale: 2048.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    307/  1000| tot_loss: 2.6638 | rl_loss: 0.6990 | pt_loss: 1.9648 | pg_loss: 0.0554 | reg_loss: 0.6437 | reward: -0.3465 | rev_kl: 0.9253 | stu_lens: 93.5000 | mixed_lens: 128.0000 | lr: 4.3925e-06 | scale: 2048.00 | time: 26.327 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    308/  1000| tot_loss: 2.6703 | rl_loss: 1.1403 | pt_loss: 1.5300 | pg_loss: 0.7330 | reg_loss: 0.4073 | reward: -0.8026 | rev_kl: 1.5702 | stu_lens: 67.0000 | mixed_lens: 57.0000 | lr: 4.3868e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    309/  1000| tot_loss: 2.9150 | rl_loss: 0.9760 | pt_loss: 1.9390 | pg_loss: 0.3462 | reg_loss: 0.6298 | reward: -0.7232 | rev_kl: 1.8566 | stu_lens: 68.5000 | mixed_lens: 30.5000 | lr: 4.3810e-06 | scale: 2048.00 | time: 26.322 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    310/  1000| tot_loss: 2.4138 | rl_loss: 0.8732 | pt_loss: 1.5406 | pg_loss: 0.5180 | reg_loss: 0.3552 | reward: -0.0478 | rev_kl: 0.5394 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 4.3753e-06 | scale: 2048.00 | time: 26.353 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    311/  1000| tot_loss: 2.0944 | rl_loss: 0.3761 | pt_loss: 1.7183 | pg_loss: 0.0718 | reg_loss: 0.3043 | reward: -0.1809 | rev_kl: 0.8703 | stu_lens: 94.5000 | mixed_lens: 117.0000 | lr: 4.3695e-06 | scale: 2048.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    312/  1000| tot_loss: 1.0687 | rl_loss: 0.3685 | pt_loss: 0.7002 | pg_loss: 0.0205 | reg_loss: 0.3480 | reward: -0.2873 | rev_kl: 0.9116 | stu_lens: 116.5000 | mixed_lens: 128.0000 | lr: 4.3637e-06 | scale: 2048.00 | time: 26.361 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    313/  1000| tot_loss: 1.9372 | rl_loss: 0.2163 | pt_loss: 1.7209 | pg_loss: 0.0745 | reg_loss: 0.1418 | reward: -0.0711 | rev_kl: 0.2251 | stu_lens: 86.0000 | mixed_lens: 94.0000 | lr: 4.3579e-06 | scale: 2048.00 | time: 26.366 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    314/  1000| tot_loss: 2.6092 | rl_loss: 0.7375 | pt_loss: 1.8717 | pg_loss: 0.1884 | reg_loss: 0.5492 | reward: -0.2837 | rev_kl: 1.1541 | stu_lens: 101.5000 | mixed_lens: 96.0000 | lr: 4.3520e-06 | scale: 2048.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    315/  1000| tot_loss: 2.6077 | rl_loss: 0.6194 | pt_loss: 1.9884 | pg_loss: 0.1488 | reg_loss: 0.4706 | reward: -0.4494 | rev_kl: 1.3556 | stu_lens: 91.5000 | mixed_lens: 90.5000 | lr: 4.3461e-06 | scale: 2048.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    316/  1000| tot_loss: 2.7657 | rl_loss: 0.5876 | pt_loss: 2.1781 | pg_loss: 0.2173 | reg_loss: 0.3703 | reward: -0.8183 | rev_kl: 1.2448 | stu_lens: 61.5000 | mixed_lens: 76.0000 | lr: 4.3402e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    317/  1000| tot_loss: 1.6208 | rl_loss: 0.6441 | pt_loss: 0.9767 | pg_loss: 0.3110 | reg_loss: 0.3332 | reward: -0.3695 | rev_kl: 1.3548 | stu_lens: 92.0000 | mixed_lens: 77.5000 | lr: 4.3343e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    318/  1000| tot_loss: 2.1606 | rl_loss: 0.6647 | pt_loss: 1.4959 | pg_loss: 0.2441 | reg_loss: 0.4206 | reward: -0.2684 | rev_kl: 0.8129 | stu_lens: 117.0000 | mixed_lens: 93.0000 | lr: 4.3284e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    319/  1000| tot_loss: 2.0690 | rl_loss: 0.5429 | pt_loss: 1.5260 | pg_loss: 0.2280 | reg_loss: 0.3149 | reward: -0.8032 | rev_kl: 0.3182 | stu_lens: 67.5000 | mixed_lens: 76.5000 | lr: 4.3224e-06 | scale: 2048.00 | time: 26.329 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    320/  1000| tot_loss: 2.8668 | rl_loss: 0.7605 | pt_loss: 2.1063 | pg_loss: 0.1689 | reg_loss: 0.5916 | reward: -0.3853 | rev_kl: 0.6826 | stu_lens: 76.0000 | mixed_lens: 94.0000 | lr: 4.3164e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    320/  1000| tot_loss: 2.2882 | rl_loss: 0.6455 | pt_loss: 1.6427 | pg_loss: 0.1974 | reg_loss: 0.4481 | reward: -0.2590 | rev_kl: 1.0163 | stu_lens: 81.0156 | mixed_lens: 80.1250 | lr: 4.3164e-06 | scale: 2048.00 | time: 26.291 | step time: 27.547
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    321/  1000| tot_loss: 3.0707 | rl_loss: 1.0357 | pt_loss: 2.0350 | pg_loss: 0.5460 | reg_loss: 0.4897 | reward: -0.5780 | rev_kl: 1.1389 | stu_lens: 98.0000 | mixed_lens: 48.0000 | lr: 4.3104e-06 | scale: 2048.00 | time: 26.367 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    322/  1000| tot_loss: 2.8039 | rl_loss: 1.2556 | pt_loss: 1.5483 | pg_loss: 0.1452 | reg_loss: 1.1104 | reward: -0.4244 | rev_kl: 0.9946 | stu_lens: 112.5000 | mixed_lens: 109.5000 | lr: 4.3044e-06 | scale: 2048.00 | time: 26.373 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    323/  1000| tot_loss: 3.9403 | rl_loss: 1.5126 | pt_loss: 2.4277 | pg_loss: 0.1470 | reg_loss: 1.3656 | reward: -0.0586 | rev_kl: 1.2291 | stu_lens: 120.0000 | mixed_lens: 111.0000 | lr: 4.2983e-06 | scale: 2048.00 | time: 26.393 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    324/  1000| tot_loss: 4.0882 | rl_loss: 2.3551 | pt_loss: 1.7331 | pg_loss: 0.4586 | reg_loss: 1.8965 | reward: 0.1120 | rev_kl: 1.2031 | stu_lens: 107.0000 | mixed_lens: 73.5000 | lr: 4.2923e-06 | scale: 2048.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    325/  1000| tot_loss: 3.7043 | rl_loss: 1.9064 | pt_loss: 1.7979 | pg_loss: 0.7265 | reg_loss: 1.1799 | reward: -0.4766 | rev_kl: 0.8980 | stu_lens: 52.5000 | mixed_lens: 64.0000 | lr: 4.2862e-06 | scale: 2048.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    326/  1000| tot_loss: 4.5269 | rl_loss: 2.6785 | pt_loss: 1.8484 | pg_loss: 0.8626 | reg_loss: 1.8159 | reward: -1.1960 | rev_kl: 1.7841 | stu_lens: 27.0000 | mixed_lens: 44.5000 | lr: 4.2801e-06 | scale: 2048.00 | time: 26.315 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    327/  1000| tot_loss: 2.9476 | rl_loss: 1.3118 | pt_loss: 1.6358 | pg_loss: 0.2825 | reg_loss: 1.0293 | reward: -0.5757 | rev_kl: 0.6792 | stu_lens: 116.5000 | mixed_lens: 101.0000 | lr: 4.2739e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    328/  1000| tot_loss: 2.7534 | rl_loss: 0.9006 | pt_loss: 1.8528 | pg_loss: 0.2745 | reg_loss: 0.6261 | reward: -0.2454 | rev_kl: 1.2138 | stu_lens: 68.0000 | mixed_lens: 68.5000 | lr: 4.2678e-06 | scale: 2048.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    329/  1000| tot_loss: 3.6744 | rl_loss: 1.8003 | pt_loss: 1.8741 | pg_loss: 0.3645 | reg_loss: 1.4358 | reward: -0.4414 | rev_kl: 1.2541 | stu_lens: 128.0000 | mixed_lens: 101.5000 | lr: 4.2616e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    330/  1000| tot_loss: 3.7237 | rl_loss: 1.7021 | pt_loss: 2.0217 | pg_loss: 0.2674 | reg_loss: 1.4347 | reward: -0.5972 | rev_kl: 0.9754 | stu_lens: 128.0000 | mixed_lens: 100.5000 | lr: 4.2554e-06 | scale: 2048.00 | time: 26.360 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    331/  1000| tot_loss: 3.4716 | rl_loss: 1.6884 | pt_loss: 1.7831 | pg_loss: 0.4829 | reg_loss: 1.2055 | reward: -0.5782 | rev_kl: 1.0697 | stu_lens: 92.5000 | mixed_lens: 74.5000 | lr: 4.2492e-06 | scale: 2048.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    332/  1000| tot_loss: 3.4598 | rl_loss: 1.6053 | pt_loss: 1.8545 | pg_loss: 0.3133 | reg_loss: 1.2921 | reward: -0.3904 | rev_kl: 1.0149 | stu_lens: 125.0000 | mixed_lens: 84.5000 | lr: 4.2429e-06 | scale: 2048.00 | time: 26.433 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    333/  1000| tot_loss: 3.0697 | rl_loss: 1.4843 | pt_loss: 1.5853 | pg_loss: 0.3217 | reg_loss: 1.1626 | reward: -0.7813 | rev_kl: 0.9733 | stu_lens: 70.5000 | mixed_lens: 81.0000 | lr: 4.2366e-06 | scale: 2048.00 | time: 26.377 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    334/  1000| tot_loss: 2.7515 | rl_loss: 1.3433 | pt_loss: 1.4081 | pg_loss: 0.2596 | reg_loss: 1.0837 | reward: -0.3395 | rev_kl: 1.1289 | stu_lens: 116.0000 | mixed_lens: 111.0000 | lr: 4.2304e-06 | scale: 2048.00 | time: 26.358 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    335/  1000| tot_loss: 3.9524 | rl_loss: 1.8326 | pt_loss: 2.1198 | pg_loss: 0.0956 | reg_loss: 1.7369 | reward: -0.4442 | rev_kl: 1.6067 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 4.2240e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    336/  1000| tot_loss: 2.9322 | rl_loss: 1.1140 | pt_loss: 1.8182 | pg_loss: 0.2899 | reg_loss: 0.8241 | reward: -0.1279 | rev_kl: 0.6570 | stu_lens: 82.0000 | mixed_lens: 82.0000 | lr: 4.2177e-06 | scale: 2048.00 | time: 26.353 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    336/  1000| tot_loss: 3.2898 | rl_loss: 1.5227 | pt_loss: 1.7670 | pg_loss: 0.3557 | reg_loss: 1.1670 | reward: -0.4682 | rev_kl: 1.1920 | stu_lens: 96.1562 | mixed_lens: 89.0625 | lr: 4.2177e-06 | scale: 2048.00 | time: 26.353 | step time: 27.562
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    337/  1000| tot_loss: 4.1320 | rl_loss: 2.4715 | pt_loss: 1.6605 | pg_loss: 0.9034 | reg_loss: 1.5681 | reward: -0.7445 | rev_kl: 0.8414 | stu_lens: 113.5000 | mixed_lens: 55.5000 | lr: 4.2114e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    338/  1000| tot_loss: 2.6066 | rl_loss: 0.7903 | pt_loss: 1.8163 | pg_loss: 0.1954 | reg_loss: 0.5950 | reward: -0.9692 | rev_kl: 1.1180 | stu_lens: 86.5000 | mixed_lens: 89.0000 | lr: 4.2050e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    339/  1000| tot_loss: 3.2595 | rl_loss: 0.9938 | pt_loss: 2.2657 | pg_loss: 0.2116 | reg_loss: 0.7822 | reward: -0.6937 | rev_kl: 1.0242 | stu_lens: 104.5000 | mixed_lens: 104.0000 | lr: 4.1986e-06 | scale: 2048.00 | time: 26.348 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    340/  1000| tot_loss: 2.5730 | rl_loss: 0.8207 | pt_loss: 1.7523 | pg_loss: 0.2224 | reg_loss: 0.5984 | reward: -0.5095 | rev_kl: 1.1636 | stu_lens: 86.5000 | mixed_lens: 100.0000 | lr: 4.1922e-06 | scale: 2048.00 | time: 26.322 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    341/  1000| tot_loss: 2.5934 | rl_loss: 0.6286 | pt_loss: 1.9648 | pg_loss: -0.0231 | reg_loss: 0.6517 | reward: -0.3023 | rev_kl: 1.1149 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1858e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    342/  1000| tot_loss: 3.2526 | rl_loss: 1.4208 | pt_loss: 1.8318 | pg_loss: 0.3384 | reg_loss: 1.0824 | reward: -0.4166 | rev_kl: 1.1005 | stu_lens: 82.0000 | mixed_lens: 69.0000 | lr: 4.1793e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    343/  1000| tot_loss: 2.8221 | rl_loss: 1.2883 | pt_loss: 1.5338 | pg_loss: 0.3668 | reg_loss: 0.9215 | reward: -1.0183 | rev_kl: 1.3469 | stu_lens: 117.5000 | mixed_lens: 49.0000 | lr: 4.1728e-06 | scale: 2048.00 | time: 26.446 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    344/  1000| tot_loss: 2.6024 | rl_loss: 0.8933 | pt_loss: 1.7091 | pg_loss: 0.0908 | reg_loss: 0.8025 | reward: -0.4086 | rev_kl: 0.9986 | stu_lens: 128.0000 | mixed_lens: 114.5000 | lr: 4.1663e-06 | scale: 2048.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    345/  1000| tot_loss: 2.2053 | rl_loss: 0.9382 | pt_loss: 1.2670 | pg_loss: 0.0981 | reg_loss: 0.8401 | reward: -0.3453 | rev_kl: 0.7722 | stu_lens: 94.0000 | mixed_lens: 105.0000 | lr: 4.1598e-06 | scale: 2048.00 | time: 26.389 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    346/  1000| tot_loss: 2.9992 | rl_loss: 1.4685 | pt_loss: 1.5307 | pg_loss: 0.7202 | reg_loss: 0.7483 | reward: -0.3915 | rev_kl: 0.5746 | stu_lens: 69.5000 | mixed_lens: 42.5000 | lr: 4.1533e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    347/  1000| tot_loss: 3.6308 | rl_loss: 1.4143 | pt_loss: 2.2164 | pg_loss: 0.3595 | reg_loss: 1.0549 | reward: 0.0652 | rev_kl: 0.6391 | stu_lens: 107.0000 | mixed_lens: 49.5000 | lr: 4.1467e-06 | scale: 2048.00 | time: 26.328 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    348/  1000| tot_loss: 3.0074 | rl_loss: 1.2317 | pt_loss: 1.7756 | pg_loss: 0.2673 | reg_loss: 0.9645 | reward: -1.0844 | rev_kl: 0.8882 | stu_lens: 67.0000 | mixed_lens: 72.0000 | lr: 4.1401e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    349/  1000| tot_loss: 2.9804 | rl_loss: 1.0765 | pt_loss: 1.9039 | pg_loss: 0.2804 | reg_loss: 0.7961 | reward: -0.4900 | rev_kl: 0.8824 | stu_lens: 128.0000 | mixed_lens: 99.5000 | lr: 4.1336e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    350/  1000| tot_loss: 2.7665 | rl_loss: 1.1601 | pt_loss: 1.6064 | pg_loss: 0.1365 | reg_loss: 1.0236 | reward: -0.1508 | rev_kl: 1.1847 | stu_lens: 81.0000 | mixed_lens: 111.0000 | lr: 4.1269e-06 | scale: 2048.00 | time: 26.338 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    351/  1000| tot_loss: 2.1648 | rl_loss: 0.6332 | pt_loss: 1.5315 | pg_loss: 0.0019 | reg_loss: 0.6313 | reward: -0.3227 | rev_kl: 1.3152 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1203e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    352/  1000| tot_loss: 2.7260 | rl_loss: 1.1043 | pt_loss: 1.6217 | pg_loss: 0.2393 | reg_loss: 0.8650 | reward: -0.5738 | rev_kl: 1.1612 | stu_lens: 116.0000 | mixed_lens: 101.5000 | lr: 4.1136e-06 | scale: 2048.00 | time: 26.340 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    352/  1000| tot_loss: 2.8263 | rl_loss: 1.1645 | pt_loss: 1.6618 | pg_loss: 0.3189 | reg_loss: 0.8456 | reward: -0.4559 | rev_kl: 1.1285 | stu_lens: 101.7656 | mixed_lens: 87.4844 | lr: 4.1136e-06 | scale: 2048.00 | time: 26.340 | step time: 27.543
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    353/  1000| tot_loss: 2.8571 | rl_loss: 1.0687 | pt_loss: 1.7885 | pg_loss: 0.2827 | reg_loss: 0.7859 | reward: -0.4908 | rev_kl: 1.2608 | stu_lens: 87.5000 | mixed_lens: 91.0000 | lr: 4.1070e-06 | scale: 2048.00 | time: 26.358 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    354/  1000| tot_loss: 3.1200 | rl_loss: 1.0698 | pt_loss: 2.0502 | pg_loss: 0.5025 | reg_loss: 0.5673 | reward: -0.3827 | rev_kl: 0.9588 | stu_lens: 83.0000 | mixed_lens: 68.0000 | lr: 4.1003e-06 | scale: 2048.00 | time: 26.352 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    355/  1000| tot_loss: 3.4864 | rl_loss: 2.1475 | pt_loss: 1.3389 | pg_loss: 1.0525 | reg_loss: 1.0950 | reward: -1.1753 | rev_kl: 0.8794 | stu_lens: 117.5000 | mixed_lens: 44.0000 | lr: 4.0936e-06 | scale: 2048.00 | time: 26.372 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    356/  1000| tot_loss: 2.6653 | rl_loss: 0.8114 | pt_loss: 1.8539 | pg_loss: 0.5257 | reg_loss: 0.2857 | reward: -0.3039 | rev_kl: 0.4079 | stu_lens: 60.5000 | mixed_lens: 54.0000 | lr: 4.0868e-06 | scale: 2048.00 | time: 26.367 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    357/  1000| tot_loss: 3.0152 | rl_loss: 1.1404 | pt_loss: 1.8748 | pg_loss: 0.4249 | reg_loss: 0.7155 | reward: -0.6559 | rev_kl: 0.6534 | stu_lens: 84.0000 | mixed_lens: 55.0000 | lr: 4.0801e-06 | scale: 2048.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    358/  1000| tot_loss: 2.4721 | rl_loss: 0.6547 | pt_loss: 1.8174 | pg_loss: 0.0234 | reg_loss: 0.6314 | reward: -0.2185 | rev_kl: 0.8977 | stu_lens: 89.0000 | mixed_lens: 128.0000 | lr: 4.0733e-06 | scale: 2048.00 | time: 26.360 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    359/  1000| tot_loss: 2.7781 | rl_loss: 0.9168 | pt_loss: 1.8613 | pg_loss: 0.1708 | reg_loss: 0.7459 | reward: -0.3861 | rev_kl: 1.4097 | stu_lens: 78.5000 | mixed_lens: 102.0000 | lr: 4.0665e-06 | scale: 2048.00 | time: 26.315 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    360/  1000| tot_loss: 2.2524 | rl_loss: 0.5670 | pt_loss: 1.6854 | pg_loss: 0.1185 | reg_loss: 0.4485 | reward: -0.4724 | rev_kl: 1.1445 | stu_lens: 104.5000 | mixed_lens: 104.0000 | lr: 4.0597e-06 | scale: 2048.00 | time: 26.328 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    361/  1000| tot_loss: 2.6740 | rl_loss: 1.0771 | pt_loss: 1.5969 | pg_loss: 0.4720 | reg_loss: 0.6051 | reward: 0.0171 | rev_kl: 1.6998 | stu_lens: 110.0000 | mixed_lens: 60.5000 | lr: 4.0529e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    362/  1000| tot_loss: 2.4211 | rl_loss: 0.5117 | pt_loss: 1.9095 | pg_loss: 0.1518 | reg_loss: 0.3599 | reward: -0.3002 | rev_kl: 1.0444 | stu_lens: 128.0000 | mixed_lens: 104.0000 | lr: 4.0460e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
[2023-12-13 21:04:58,900] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, but hysteresis is 2. Reducing hysteresis to 1
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    363/  1000| tot_loss: 5.8704 | rl_loss: 4.2207 | pt_loss: 1.6496 | pg_loss: 3.6262 | reg_loss: 0.5946 | reward: -0.5657 | rev_kl: 0.9620 | stu_lens: 128.0000 | mixed_lens: 101.5000 | lr: 4.0460e-06 | scale: 2048.00 | time: 2.902 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    364/  1000| tot_loss: 1.8439 | rl_loss: 0.2985 | pt_loss: 1.5453 | pg_loss: -0.0087 | reg_loss: 0.3072 | reward: -0.3151 | rev_kl: 1.3126 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.0392e-06 | scale: 2048.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    365/  1000| tot_loss: 2.9003 | rl_loss: 0.5303 | pt_loss: 2.3700 | pg_loss: 0.0103 | reg_loss: 0.5199 | reward: -0.4395 | rev_kl: 1.2984 | stu_lens: 124.5000 | mixed_lens: 128.0000 | lr: 4.0323e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    366/  1000| tot_loss: 2.2004 | rl_loss: 0.5270 | pt_loss: 1.6734 | pg_loss: 0.1371 | reg_loss: 0.3899 | reward: -0.2300 | rev_kl: 1.1044 | stu_lens: 123.5000 | mixed_lens: 111.0000 | lr: 4.0254e-06 | scale: 2048.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    367/  1000| tot_loss: 2.5785 | rl_loss: 1.3086 | pt_loss: 1.2699 | pg_loss: 0.6527 | reg_loss: 0.6558 | reward: -0.6799 | rev_kl: 1.1942 | stu_lens: 110.0000 | mixed_lens: 60.5000 | lr: 4.0184e-06 | scale: 2048.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    368/  1000| tot_loss: 2.2792 | rl_loss: 0.9922 | pt_loss: 1.2869 | pg_loss: 0.2585 | reg_loss: 0.7337 | reward: -0.5323 | rev_kl: 2.0911 | stu_lens: 107.0000 | mixed_lens: 89.0000 | lr: 4.0115e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    368/  1000| tot_loss: 2.7432 | rl_loss: 1.0450 | pt_loss: 1.6982 | pg_loss: 0.4629 | reg_loss: 0.5821 | reward: -0.4455 | rev_kl: 1.1440 | stu_lens: 98.7344 | mixed_lens: 87.4062 | lr: 4.0115e-06 | scale: 2048.00 | time: 26.342 | step time: 26.097
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    369/  1000| tot_loss: 2.8327 | rl_loss: 1.6422 | pt_loss: 1.1904 | pg_loss: 0.8853 | reg_loss: 0.7569 | reward: -1.0707 | rev_kl: 1.0486 | stu_lens: 92.5000 | mixed_lens: 47.5000 | lr: 4.0045e-06 | scale: 2048.00 | time: 26.388 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    370/  1000| tot_loss: 2.7062 | rl_loss: 0.7630 | pt_loss: 1.9432 | pg_loss: 0.3171 | reg_loss: 0.4459 | reward: -0.6582 | rev_kl: 0.7089 | stu_lens: 116.0000 | mixed_lens: 82.5000 | lr: 3.9976e-06 | scale: 2048.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    371/  1000| tot_loss: 2.8602 | rl_loss: 0.9738 | pt_loss: 1.8864 | pg_loss: 0.1396 | reg_loss: 0.8342 | reward: -0.5347 | rev_kl: 1.4906 | stu_lens: 107.0000 | mixed_lens: 98.5000 | lr: 3.9906e-06 | scale: 2048.00 | time: 26.363 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    372/  1000| tot_loss: 2.2280 | rl_loss: 0.6136 | pt_loss: 1.6144 | pg_loss: 0.1061 | reg_loss: 0.5075 | reward: -0.4495 | rev_kl: 1.0042 | stu_lens: 94.0000 | mixed_lens: 105.0000 | lr: 3.9835e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    373/  1000| tot_loss: 2.0988 | rl_loss: 0.5261 | pt_loss: 1.5727 | pg_loss: 0.0996 | reg_loss: 0.4265 | reward: -0.3317 | rev_kl: 1.2830 | stu_lens: 128.0000 | mixed_lens: 104.5000 | lr: 3.9765e-06 | scale: 2048.00 | time: 26.344 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    374/  1000| tot_loss: 1.8535 | rl_loss: 0.3742 | pt_loss: 1.4793 | pg_loss: 0.0137 | reg_loss: 0.3605 | reward: -0.1159 | rev_kl: 1.0117 | stu_lens: 123.5000 | mixed_lens: 121.0000 | lr: 3.9695e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    375/  1000| tot_loss: 2.0836 | rl_loss: 0.6168 | pt_loss: 1.4668 | pg_loss: 0.0995 | reg_loss: 0.5173 | reward: -0.1434 | rev_kl: 1.4804 | stu_lens: 120.0000 | mixed_lens: 111.0000 | lr: 3.9624e-06 | scale: 2048.00 | time: 26.340 | step time: 0.000
[2023-12-13 21:10:35,001] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, reducing to 1024
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    376/  1000| tot_loss: 2.2274 | rl_loss: 0.9986 | pt_loss: 1.2288 | pg_loss: 0.4091 | reg_loss: 0.5895 | reward: -1.0426 | rev_kl: 0.7804 | stu_lens: 65.0000 | mixed_lens: 72.0000 | lr: 3.9624e-06 | scale: 1024.00 | time: 2.900 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    377/  1000| tot_loss: 2.7375 | rl_loss: 0.8353 | pt_loss: 1.9022 | pg_loss: 0.4001 | reg_loss: 0.4352 | reward: -0.4098 | rev_kl: 0.5583 | stu_lens: 72.5000 | mixed_lens: 72.5000 | lr: 3.9553e-06 | scale: 1024.00 | time: 26.344 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    378/  1000| tot_loss: 2.3019 | rl_loss: 0.6858 | pt_loss: 1.6161 | pg_loss: 0.1618 | reg_loss: 0.5240 | reward: -0.7711 | rev_kl: 2.5515 | stu_lens: 87.0000 | mixed_lens: 104.0000 | lr: 3.9482e-06 | scale: 1024.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    379/  1000| tot_loss: 2.9779 | rl_loss: 1.1723 | pt_loss: 1.8055 | pg_loss: 0.4244 | reg_loss: 0.7479 | reward: 0.1015 | rev_kl: 1.1469 | stu_lens: 128.0000 | mixed_lens: 60.5000 | lr: 3.9411e-06 | scale: 1024.00 | time: 26.322 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    380/  1000| tot_loss: 2.3815 | rl_loss: 0.3560 | pt_loss: 2.0255 | pg_loss: 0.0232 | reg_loss: 0.3328 | reward: -0.1882 | rev_kl: 1.1206 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.9339e-06 | scale: 1024.00 | time: 26.365 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    381/  1000| tot_loss: 2.2600 | rl_loss: 0.5372 | pt_loss: 1.7228 | pg_loss: 0.0158 | reg_loss: 0.5214 | reward: -0.3431 | rev_kl: 0.8794 | stu_lens: 64.5000 | mixed_lens: 128.0000 | lr: 3.9268e-06 | scale: 1024.00 | time: 26.340 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    382/  1000| tot_loss: 3.1862 | rl_loss: 0.9884 | pt_loss: 2.1978 | pg_loss: 0.4179 | reg_loss: 0.5705 | reward: -0.7102 | rev_kl: 1.2256 | stu_lens: 24.5000 | mixed_lens: 40.0000 | lr: 3.9196e-06 | scale: 1024.00 | time: 26.361 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    383/  1000| tot_loss: 2.2698 | rl_loss: 0.4918 | pt_loss: 1.7780 | pg_loss: 0.2425 | reg_loss: 0.2493 | reward: -0.4777 | rev_kl: 0.8621 | stu_lens: 128.0000 | mixed_lens: 76.5000 | lr: 3.9124e-06 | scale: 1024.00 | time: 26.322 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    384/  1000| tot_loss: 2.7164 | rl_loss: 0.7744 | pt_loss: 1.9420 | pg_loss: 0.3054 | reg_loss: 0.4690 | reward: -0.5637 | rev_kl: 0.7959 | stu_lens: 86.5000 | mixed_lens: 100.0000 | lr: 3.9052e-06 | scale: 1024.00 | time: 26.360 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    384/  1000| tot_loss: 2.6710 | rl_loss: 0.9458 | pt_loss: 1.7251 | pg_loss: 0.4308 | reg_loss: 0.5150 | reward: -0.4903 | rev_kl: 1.1165 | stu_lens: 101.8594 | mixed_lens: 87.6250 | lr: 3.9052e-06 | scale: 1024.00 | time: 26.360 | step time: 26.091
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    385/  1000| tot_loss: 2.3602 | rl_loss: 0.5831 | pt_loss: 1.7771 | pg_loss: 0.1542 | reg_loss: 0.4288 | reward: -0.3873 | rev_kl: 2.2177 | stu_lens: 128.0000 | mixed_lens: 105.5000 | lr: 3.8980e-06 | scale: 1024.00 | time: 26.328 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    386/  1000| tot_loss: 3.1369 | rl_loss: 1.2586 | pt_loss: 1.8783 | pg_loss: 0.3060 | reg_loss: 0.9526 | reward: -0.2292 | rev_kl: 1.4939 | stu_lens: 87.0000 | mixed_lens: 88.0000 | lr: 3.8907e-06 | scale: 1024.00 | time: 26.377 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    387/  1000| tot_loss: 2.7818 | rl_loss: 1.2807 | pt_loss: 1.5011 | pg_loss: 0.1937 | reg_loss: 1.0870 | reward: -0.4553 | rev_kl: 1.5701 | stu_lens: 75.5000 | mixed_lens: 100.0000 | lr: 3.8835e-06 | scale: 1024.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    388/  1000| tot_loss: 3.3764 | rl_loss: 1.9535 | pt_loss: 1.4229 | pg_loss: 0.3213 | reg_loss: 1.6323 | reward: -0.3770 | rev_kl: 1.6766 | stu_lens: 67.5000 | mixed_lens: 77.0000 | lr: 3.8762e-06 | scale: 1024.00 | time: 26.351 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    389/  1000| tot_loss: 3.1333 | rl_loss: 1.3885 | pt_loss: 1.7447 | pg_loss: 0.5194 | reg_loss: 0.8691 | reward: -0.0741 | rev_kl: 0.5151 | stu_lens: 77.0000 | mixed_lens: 76.0000 | lr: 3.8689e-06 | scale: 1024.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    390/  1000| tot_loss: 4.3631 | rl_loss: 2.5311 | pt_loss: 1.8319 | pg_loss: 0.9088 | reg_loss: 1.6223 | reward: -1.1792 | rev_kl: 0.7430 | stu_lens: 65.0000 | mixed_lens: 53.5000 | lr: 3.8616e-06 | scale: 1024.00 | time: 26.322 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    391/  1000| tot_loss: 3.0713 | rl_loss: 1.2395 | pt_loss: 1.8318 | pg_loss: 0.0958 | reg_loss: 1.1437 | reward: -0.4268 | rev_kl: 1.1035 | stu_lens: 128.0000 | mixed_lens: 44.5000 | lr: 3.8543e-06 | scale: 1024.00 | time: 26.322 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    392/  1000| tot_loss: 3.8710 | rl_loss: 2.1890 | pt_loss: 1.6820 | pg_loss: 1.2178 | reg_loss: 0.9711 | reward: -0.3788 | rev_kl: 1.5941 | stu_lens: 30.5000 | mixed_lens: 25.5000 | lr: 3.8469e-06 | scale: 1024.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    393/  1000| tot_loss: 3.9464 | rl_loss: 2.2032 | pt_loss: 1.7432 | pg_loss: 0.8282 | reg_loss: 1.3750 | reward: -0.3600 | rev_kl: 1.1104 | stu_lens: 94.5000 | mixed_lens: 55.5000 | lr: 3.8396e-06 | scale: 1024.00 | time: 26.314 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    394/  1000| tot_loss: 2.9276 | rl_loss: 0.9724 | pt_loss: 1.9552 | pg_loss: 0.3788 | reg_loss: 0.5936 | reward: -0.2198 | rev_kl: 1.5375 | stu_lens: 128.0000 | mixed_lens: 83.0000 | lr: 3.8322e-06 | scale: 1024.00 | time: 26.367 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    395/  1000| tot_loss: 2.8922 | rl_loss: 1.3086 | pt_loss: 1.5835 | pg_loss: 0.3199 | reg_loss: 0.9887 | reward: -0.9064 | rev_kl: 1.1574 | stu_lens: 102.5000 | mixed_lens: 67.5000 | lr: 3.8248e-06 | scale: 1024.00 | time: 26.320 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    396/  1000| tot_loss: 3.0398 | rl_loss: 1.2587 | pt_loss: 1.7811 | pg_loss: 0.0599 | reg_loss: 1.1987 | reward: -0.2356 | rev_kl: 0.9603 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8174e-06 | scale: 1024.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    397/  1000| tot_loss: 3.6528 | rl_loss: 1.4890 | pt_loss: 2.1638 | pg_loss: 0.2284 | reg_loss: 1.2605 | reward: -0.2072 | rev_kl: 2.3689 | stu_lens: 128.0000 | mixed_lens: 108.5000 | lr: 3.8100e-06 | scale: 1024.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    398/  1000| tot_loss: 2.9138 | rl_loss: 1.0097 | pt_loss: 1.9040 | pg_loss: 0.2139 | reg_loss: 0.7958 | reward: -0.5116 | rev_kl: 0.9651 | stu_lens: 80.0000 | mixed_lens: 83.0000 | lr: 3.8025e-06 | scale: 1024.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    399/  1000| tot_loss: 3.9071 | rl_loss: 1.6174 | pt_loss: 2.2897 | pg_loss: 0.0651 | reg_loss: 1.5522 | reward: -0.4314 | rev_kl: 1.2011 | stu_lens: 105.5000 | mixed_lens: 128.0000 | lr: 3.7951e-06 | scale: 1024.00 | time: 26.276 | step time: 0.000
                                 Evaluation #4                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ You can create new things with the   │
│                                       │ code editor. For example, you can    │
│                                       │ write a new program and then run it  │
│                                       │ to see how it works. If you are      │
│                                       │ unsure of how to write a program,    │
│                                       │ you can use a code editor to find    │
│                                       │ examples of code and learn from      │
│                                       │ them. You can also use the code      │
│                                       │ editor to edit existing programs and │
│                                       │ see how they work.                   │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ I think you should try to create     │
│                                       │ something new. It will be fun to see │
│                                       │ what you come up with.               │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ There are many ways to create new    │
│                                       │ things. You can create something new │
│                                       │ by combining existing things in new  │
│                                       │ ways. For example, you can combine   │
│                                       │ two existing things to create a new  │
│                                       │ thing. You can also create something │
│                                       │ new by taking something apart and    │
│                                       │ studying how it was put together.    │
│                                       │ Then you can reassemble the pieces   │
│                                       │ in a different way to create a new   │
│                                       │ thing. Finally, you can create       │
│                                       │ something new by imagining something │
│                                       │ that does not exist. Then you can    │
│                                       │ try to make that thing happen.       │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.243 | exact_match: 0.103 | rev_kl: 1.056 | lens: 102.982 | pt_loss: 1.103 | lm_loss: 1.200 | kd_loss: 1.006 
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    400/  1000| tot_loss: 4.6878 | rl_loss: 2.7749 | pt_loss: 1.9129 | pg_loss: 1.3755 | reg_loss: 1.3993 | reward: 0.5234 | rev_kl: 1.0133 | stu_lens: 10.0000 | mixed_lens: 13.0000 | lr: 3.7876e-06 | scale: 1024.00 | time: 26.328 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    400/  1000| tot_loss: 3.2852 | rl_loss: 1.5250 | pt_loss: 1.7602 | pg_loss: 0.4309 | reg_loss: 1.0941 | reward: -0.3262 | rev_kl: 1.3692 | stu_lens: 88.4062 | mixed_lens: 80.9844 | lr: 3.7876e-06 | scale: 1024.00 | time: 26.328 | step time: 27.552
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    401/  1000| tot_loss: 4.4053 | rl_loss: 2.5421 | pt_loss: 1.8632 | pg_loss: 0.9958 | reg_loss: 1.5463 | reward: -0.0349 | rev_kl: 0.5237 | stu_lens: 51.0000 | mixed_lens: 34.0000 | lr: 3.7801e-06 | scale: 1024.00 | time: 26.341 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    402/  1000| tot_loss: 3.3660 | rl_loss: 1.7717 | pt_loss: 1.5943 | pg_loss: 1.0913 | reg_loss: 0.6804 | reward: -1.1979 | rev_kl: 4.3906 | stu_lens: 21.0000 | mixed_lens: 28.5000 | lr: 3.7726e-06 | scale: 1024.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    403/  1000| tot_loss: 2.5657 | rl_loss: 0.9084 | pt_loss: 1.6573 | pg_loss: 0.0530 | reg_loss: 0.8554 | reward: -0.2087 | rev_kl: 2.4843 | stu_lens: 128.0000 | mixed_lens: 120.5000 | lr: 3.7651e-06 | scale: 1024.00 | time: 26.341 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    404/  1000| tot_loss: 3.6483 | rl_loss: 1.9005 | pt_loss: 1.7478 | pg_loss: 1.4808 | reg_loss: 0.4197 | reward: -0.1806 | rev_kl: 0.6798 | stu_lens: 70.0000 | mixed_lens: 9.5000 | lr: 3.7575e-06 | scale: 1024.00 | time: 26.344 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    405/  1000| tot_loss: 2.1183 | rl_loss: 0.4841 | pt_loss: 1.6342 | pg_loss: -0.0141 | reg_loss: 0.4982 | reward: -0.0853 | rev_kl: 0.8660 | stu_lens: 77.0000 | mixed_lens: 128.0000 | lr: 3.7500e-06 | scale: 1024.00 | time: 26.351 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    406/  1000| tot_loss: 2.5005 | rl_loss: 1.0163 | pt_loss: 1.4842 | pg_loss: 0.1389 | reg_loss: 0.8774 | reward: -0.2212 | rev_kl: 1.2200 | stu_lens: 109.5000 | mixed_lens: 108.0000 | lr: 3.7424e-06 | scale: 1024.00 | time: 26.375 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    407/  1000| tot_loss: 2.9712 | rl_loss: 0.9298 | pt_loss: 2.0414 | pg_loss: 0.0034 | reg_loss: 0.9265 | reward: -0.0392 | rev_kl: 1.0080 | stu_lens: 102.5000 | mixed_lens: 127.0000 | lr: 3.7349e-06 | scale: 1024.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    408/  1000| tot_loss: 2.0378 | rl_loss: 1.1640 | pt_loss: 0.8737 | pg_loss: 0.6145 | reg_loss: 0.5495 | reward: -0.2275 | rev_kl: 1.1986 | stu_lens: 105.5000 | mixed_lens: 48.5000 | lr: 3.7273e-06 | scale: 1024.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    409/  1000| tot_loss: 2.0578 | rl_loss: 0.5947 | pt_loss: 1.4632 | pg_loss: 0.1325 | reg_loss: 0.4622 | reward: -0.3312 | rev_kl: 1.1478 | stu_lens: 105.0000 | mixed_lens: 100.0000 | lr: 3.7196e-06 | scale: 1024.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    410/  1000| tot_loss: 3.8039 | rl_loss: 2.1147 | pt_loss: 1.6892 | pg_loss: 1.3078 | reg_loss: 0.8068 | reward: 0.5725 | rev_kl: 1.3985 | stu_lens: 33.0000 | mixed_lens: 23.0000 | lr: 3.7120e-06 | scale: 1024.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    411/  1000| tot_loss: 2.5892 | rl_loss: 0.8392 | pt_loss: 1.7500 | pg_loss: 0.1158 | reg_loss: 0.7234 | reward: -0.2976 | rev_kl: 0.9586 | stu_lens: 89.0000 | mixed_lens: 104.0000 | lr: 3.7044e-06 | scale: 1024.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    412/  1000| tot_loss: 2.4062 | rl_loss: 0.8665 | pt_loss: 1.5397 | pg_loss: 0.1472 | reg_loss: 0.7193 | reward: -0.3100 | rev_kl: 0.7362 | stu_lens: 128.0000 | mixed_lens: 102.5000 | lr: 3.6967e-06 | scale: 1024.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    413/  1000| tot_loss: 2.5143 | rl_loss: 0.9681 | pt_loss: 1.5463 | pg_loss: 0.1510 | reg_loss: 0.8171 | reward: -0.2615 | rev_kl: 1.0840 | stu_lens: 92.0000 | mixed_lens: 90.5000 | lr: 3.6891e-06 | scale: 1024.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    414/  1000| tot_loss: 2.7843 | rl_loss: 0.8586 | pt_loss: 1.9257 | pg_loss: 0.3586 | reg_loss: 0.5000 | reward: -0.2414 | rev_kl: 1.2932 | stu_lens: 86.0000 | mixed_lens: 71.5000 | lr: 3.6814e-06 | scale: 1024.00 | time: 26.329 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    415/  1000| tot_loss: 2.4218 | rl_loss: 0.5305 | pt_loss: 1.8913 | pg_loss: 0.0128 | reg_loss: 0.5177 | reward: -0.1408 | rev_kl: 1.1838 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6737e-06 | scale: 1024.00 | time: 26.392 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    416/  1000| tot_loss: 3.4045 | rl_loss: 1.5265 | pt_loss: 1.8780 | pg_loss: 0.7199 | reg_loss: 0.8066 | reward: -0.0689 | rev_kl: 0.5230 | stu_lens: 105.5000 | mixed_lens: 43.0000 | lr: 3.6660e-06 | scale: 1024.00 | time: 26.343 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    416/  1000| tot_loss: 2.8855 | rl_loss: 1.1596 | pt_loss: 1.7259 | pg_loss: 0.4395 | reg_loss: 0.7201 | reward: -0.3229 | rev_kl: 1.2430 | stu_lens: 86.2969 | mixed_lens: 77.2500 | lr: 3.6660e-06 | scale: 1024.00 | time: 26.343 | step time: 27.560
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    417/  1000| tot_loss: 2.4849 | rl_loss: 1.0708 | pt_loss: 1.4140 | pg_loss: 0.0038 | reg_loss: 1.0670 | reward: -0.3604 | rev_kl: 1.2291 | stu_lens: 119.5000 | mixed_lens: 128.0000 | lr: 3.6582e-06 | scale: 1024.00 | time: 26.393 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    418/  1000| tot_loss: 2.7283 | rl_loss: 0.8077 | pt_loss: 1.9206 | pg_loss: 0.4081 | reg_loss: 0.3995 | reward: -0.2358 | rev_kl: 1.1239 | stu_lens: 43.5000 | mixed_lens: 81.0000 | lr: 3.6505e-06 | scale: 1024.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    419/  1000| tot_loss: 1.8874 | rl_loss: 0.6375 | pt_loss: 1.2499 | pg_loss: 0.0407 | reg_loss: 0.5968 | reward: -0.2024 | rev_kl: 0.6963 | stu_lens: 89.0000 | mixed_lens: 115.5000 | lr: 3.6427e-06 | scale: 1024.00 | time: 26.349 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    420/  1000| tot_loss: 2.1080 | rl_loss: 0.4900 | pt_loss: 1.6180 | pg_loss: 0.0552 | reg_loss: 0.4348 | reward: -0.2739 | rev_kl: 1.2187 | stu_lens: 98.5000 | mixed_lens: 128.0000 | lr: 3.6350e-06 | scale: 1024.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    421/  1000| tot_loss: 2.4310 | rl_loss: 1.2071 | pt_loss: 1.2239 | pg_loss: 1.0214 | reg_loss: 0.1857 | reward: -0.2363 | rev_kl: 2.2474 | stu_lens: 86.0000 | mixed_lens: 26.5000 | lr: 3.6272e-06 | scale: 1024.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    422/  1000| tot_loss: 2.0751 | rl_loss: 0.5069 | pt_loss: 1.5682 | pg_loss: -0.0137 | reg_loss: 0.5206 | reward: -0.1793 | rev_kl: 1.0843 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6194e-06 | scale: 1024.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    423/  1000| tot_loss: 2.1379 | rl_loss: 0.6892 | pt_loss: 1.4487 | pg_loss: 0.0905 | reg_loss: 0.5987 | reward: -0.0840 | rev_kl: 0.9914 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 3.6116e-06 | scale: 1024.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    424/  1000| tot_loss: 2.6059 | rl_loss: 0.9128 | pt_loss: 1.6931 | pg_loss: 0.2743 | reg_loss: 0.6385 | reward: -0.2848 | rev_kl: 0.9870 | stu_lens: 90.5000 | mixed_lens: 92.5000 | lr: 3.6038e-06 | scale: 1024.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    425/  1000| tot_loss: 3.0884 | rl_loss: 1.1886 | pt_loss: 1.8999 | pg_loss: 0.5662 | reg_loss: 0.6224 | reward: -0.7137 | rev_kl: 1.6587 | stu_lens: 100.5000 | mixed_lens: 67.0000 | lr: 3.5959e-06 | scale: 1024.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    426/  1000| tot_loss: 2.0864 | rl_loss: 0.2979 | pt_loss: 1.7886 | pg_loss: 0.0597 | reg_loss: 0.2382 | reward: -0.1279 | rev_kl: 0.7830 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5881e-06 | scale: 1024.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    427/  1000| tot_loss: 2.6206 | rl_loss: 0.8968 | pt_loss: 1.7238 | pg_loss: 0.3202 | reg_loss: 0.5766 | reward: -0.1802 | rev_kl: 1.2543 | stu_lens: 86.0000 | mixed_lens: 77.0000 | lr: 3.5802e-06 | scale: 1024.00 | time: 26.377 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    428/  1000| tot_loss: 2.3515 | rl_loss: 0.4786 | pt_loss: 1.8729 | pg_loss: -0.0170 | reg_loss: 0.4956 | reward: -0.0462 | rev_kl: 1.1660 | stu_lens: 109.5000 | mixed_lens: 128.0000 | lr: 3.5723e-06 | scale: 1024.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    429/  1000| tot_loss: 2.3351 | rl_loss: 0.5300 | pt_loss: 1.8051 | pg_loss: 0.0909 | reg_loss: 0.4391 | reward: -0.2423 | rev_kl: 2.1808 | stu_lens: 128.0000 | mixed_lens: 120.5000 | lr: 3.5644e-06 | scale: 1024.00 | time: 26.368 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    430/  1000| tot_loss: 2.4630 | rl_loss: 1.2947 | pt_loss: 1.1682 | pg_loss: 0.6329 | reg_loss: 0.6619 | reward: 0.6192 | rev_kl: 1.3369 | stu_lens: 52.5000 | mixed_lens: 70.0000 | lr: 3.5565e-06 | scale: 1024.00 | time: 26.314 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    431/  1000| tot_loss: 2.7098 | rl_loss: 1.6064 | pt_loss: 1.1034 | pg_loss: 0.8289 | reg_loss: 0.7775 | reward: -0.8389 | rev_kl: 1.9623 | stu_lens: 57.5000 | mixed_lens: 33.5000 | lr: 3.5486e-06 | scale: 1024.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    432/  1000| tot_loss: 2.8996 | rl_loss: 1.0479 | pt_loss: 1.8517 | pg_loss: 0.3882 | reg_loss: 0.6597 | reward: -0.3623 | rev_kl: 1.4186 | stu_lens: 51.0000 | mixed_lens: 50.5000 | lr: 3.5407e-06 | scale: 1024.00 | time: 26.315 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    432/  1000| tot_loss: 2.5022 | rl_loss: 0.9303 | pt_loss: 1.5718 | pg_loss: 0.4198 | reg_loss: 0.5106 | reward: -0.3300 | rev_kl: 1.3231 | stu_lens: 85.9375 | mixed_lens: 80.0625 | lr: 3.5407e-06 | scale: 1024.00 | time: 26.315 | step time: 27.556
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    433/  1000| tot_loss: 2.6919 | rl_loss: 1.1029 | pt_loss: 1.5890 | pg_loss: 0.2565 | reg_loss: 0.8463 | reward: -0.4897 | rev_kl: 1.1997 | stu_lens: 91.5000 | mixed_lens: 52.0000 | lr: 3.5328e-06 | scale: 1024.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    434/  1000| tot_loss: 3.5563 | rl_loss: 1.5655 | pt_loss: 1.9908 | pg_loss: 1.1690 | reg_loss: 0.3965 | reward: -0.1904 | rev_kl: 1.3198 | stu_lens: 85.0000 | mixed_lens: 37.5000 | lr: 3.5248e-06 | scale: 1024.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    435/  1000| tot_loss: 1.9517 | rl_loss: 0.5130 | pt_loss: 1.4387 | pg_loss: 0.0981 | reg_loss: 0.4149 | reward: -0.0919 | rev_kl: 2.6235 | stu_lens: 102.5000 | mixed_lens: 119.5000 | lr: 3.5168e-06 | scale: 1024.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    436/  1000| tot_loss: 3.0082 | rl_loss: 1.3458 | pt_loss: 1.6624 | pg_loss: 0.8225 | reg_loss: 0.5233 | reward: 0.5847 | rev_kl: 1.2723 | stu_lens: 66.5000 | mixed_lens: 44.5000 | lr: 3.5089e-06 | scale: 1024.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    437/  1000| tot_loss: 2.0649 | rl_loss: 0.4698 | pt_loss: 1.5951 | pg_loss: 0.1228 | reg_loss: 0.3469 | reward: -0.1057 | rev_kl: 0.8521 | stu_lens: 128.0000 | mixed_lens: 109.0000 | lr: 3.5009e-06 | scale: 1024.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    438/  1000| tot_loss: 1.9435 | rl_loss: 0.4284 | pt_loss: 1.5151 | pg_loss: 0.0177 | reg_loss: 0.4108 | reward: -0.0511 | rev_kl: 0.7915 | stu_lens: 109.5000 | mixed_lens: 128.0000 | lr: 3.4929e-06 | scale: 1024.00 | time: 26.349 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    439/  1000| tot_loss: 2.4157 | rl_loss: 0.9383 | pt_loss: 1.4774 | pg_loss: 0.4977 | reg_loss: 0.4406 | reward: -0.3778 | rev_kl: 1.4193 | stu_lens: 35.0000 | mixed_lens: 66.5000 | lr: 3.4849e-06 | scale: 1024.00 | time: 26.381 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    440/  1000| tot_loss: 2.3715 | rl_loss: 0.7036 | pt_loss: 1.6679 | pg_loss: 0.2174 | reg_loss: 0.4862 | reward: -0.9977 | rev_kl: 1.3814 | stu_lens: 98.5000 | mixed_lens: 67.5000 | lr: 3.4768e-06 | scale: 1024.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    441/  1000| tot_loss: 2.6070 | rl_loss: 0.6591 | pt_loss: 1.9479 | pg_loss: 0.2902 | reg_loss: 0.3689 | reward: -0.3295 | rev_kl: 1.7055 | stu_lens: 128.0000 | mixed_lens: 83.0000 | lr: 3.4688e-06 | scale: 1024.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    442/  1000| tot_loss: 2.7917 | rl_loss: 0.8700 | pt_loss: 1.9217 | pg_loss: 0.5494 | reg_loss: 0.3206 | reward: 0.6036 | rev_kl: 0.5737 | stu_lens: 19.0000 | mixed_lens: 70.0000 | lr: 3.4607e-06 | scale: 1024.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    443/  1000| tot_loss: 2.2246 | rl_loss: 0.5597 | pt_loss: 1.6649 | pg_loss: 0.1576 | reg_loss: 0.4021 | reward: -0.3222 | rev_kl: 1.5353 | stu_lens: 105.0000 | mixed_lens: 100.0000 | lr: 3.4527e-06 | scale: 1024.00 | time: 26.379 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    444/  1000| tot_loss: 3.7213 | rl_loss: 1.8802 | pt_loss: 1.8411 | pg_loss: 1.5935 | reg_loss: 0.2867 | reward: -1.0785 | rev_kl: 0.7242 | stu_lens: 69.5000 | mixed_lens: 23.5000 | lr: 3.4446e-06 | scale: 1024.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    445/  1000| tot_loss: 1.9868 | rl_loss: 0.3341 | pt_loss: 1.6526 | pg_loss: -0.0095 | reg_loss: 0.3436 | reward: -0.2586 | rev_kl: 1.3601 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4365e-06 | scale: 1024.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    446/  1000| tot_loss: 2.6971 | rl_loss: 0.4850 | pt_loss: 2.2121 | pg_loss: 0.1691 | reg_loss: 0.3159 | reward: -0.3629 | rev_kl: 1.1682 | stu_lens: 91.5000 | mixed_lens: 89.5000 | lr: 3.4284e-06 | scale: 1024.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    447/  1000| tot_loss: 2.5922 | rl_loss: 0.6147 | pt_loss: 1.9775 | pg_loss: 0.3045 | reg_loss: 0.3102 | reward: -0.3120 | rev_kl: 0.7699 | stu_lens: 71.5000 | mixed_lens: 71.0000 | lr: 3.4203e-06 | scale: 1024.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    448/  1000| tot_loss: 1.7920 | rl_loss: 0.3794 | pt_loss: 1.4126 | pg_loss: 0.1534 | reg_loss: 0.2260 | reward: -0.2075 | rev_kl: 1.1388 | stu_lens: 89.0000 | mixed_lens: 87.5000 | lr: 3.4122e-06 | scale: 1024.00 | time: 26.394 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    448/  1000| tot_loss: 2.5592 | rl_loss: 0.8036 | pt_loss: 1.7557 | pg_loss: 0.3760 | reg_loss: 0.4275 | reward: -0.3188 | rev_kl: 1.2801 | stu_lens: 89.9062 | mixed_lens: 79.1094 | lr: 3.4122e-06 | scale: 1024.00 | time: 26.394 | step time: 27.546
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    449/  1000| tot_loss: 2.6117 | rl_loss: 0.8571 | pt_loss: 1.7546 | pg_loss: 0.3337 | reg_loss: 0.5234 | reward: -0.6330 | rev_kl: 1.6612 | stu_lens: 78.5000 | mixed_lens: 87.0000 | lr: 3.4041e-06 | scale: 1024.00 | time: 26.484 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    450/  1000| tot_loss: 3.2635 | rl_loss: 1.3164 | pt_loss: 1.9471 | pg_loss: 0.2626 | reg_loss: 1.0538 | reward: -0.5186 | rev_kl: 1.3004 | stu_lens: 114.0000 | mixed_lens: 96.5000 | lr: 3.3959e-06 | scale: 1024.00 | time: 26.374 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    451/  1000| tot_loss: 3.0542 | rl_loss: 1.4046 | pt_loss: 1.6496 | pg_loss: 0.4890 | reg_loss: 0.9156 | reward: -0.2584 | rev_kl: 1.0167 | stu_lens: 91.5000 | mixed_lens: 72.5000 | lr: 3.3878e-06 | scale: 1024.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    452/  1000| tot_loss: 2.8931 | rl_loss: 1.1950 | pt_loss: 1.6981 | pg_loss: 0.3077 | reg_loss: 0.8873 | reward: -0.7026 | rev_kl: 0.9858 | stu_lens: 86.0000 | mixed_lens: 63.5000 | lr: 3.3796e-06 | scale: 1024.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    453/  1000| tot_loss: 2.6466 | rl_loss: 1.1587 | pt_loss: 1.4878 | pg_loss: 0.3417 | reg_loss: 0.8170 | reward: -0.2459 | rev_kl: 0.9481 | stu_lens: 99.0000 | mixed_lens: 83.0000 | lr: 3.3714e-06 | scale: 1024.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    454/  1000| tot_loss: 2.2797 | rl_loss: 0.9016 | pt_loss: 1.3781 | pg_loss: 0.0467 | reg_loss: 0.8549 | reward: -0.1594 | rev_kl: 0.6783 | stu_lens: 70.5000 | mixed_lens: 128.0000 | lr: 3.3632e-06 | scale: 1024.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    455/  1000| tot_loss: 3.3798 | rl_loss: 1.2464 | pt_loss: 2.1334 | pg_loss: 0.1300 | reg_loss: 1.1164 | reward: -0.4513 | rev_kl: 1.0332 | stu_lens: 77.0000 | mixed_lens: 105.0000 | lr: 3.3551e-06 | scale: 1024.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    456/  1000| tot_loss: 2.6762 | rl_loss: 0.9303 | pt_loss: 1.7459 | pg_loss: 0.0843 | reg_loss: 0.8460 | reward: -0.2710 | rev_kl: 0.8818 | stu_lens: 85.5000 | mixed_lens: 117.0000 | lr: 3.3468e-06 | scale: 1024.00 | time: 26.350 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    457/  1000| tot_loss: 3.0763 | rl_loss: 1.4093 | pt_loss: 1.6669 | pg_loss: 0.2767 | reg_loss: 1.1326 | reward: -0.1915 | rev_kl: 1.2618 | stu_lens: 89.0000 | mixed_lens: 97.0000 | lr: 3.3386e-06 | scale: 1024.00 | time: 26.358 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    458/  1000| tot_loss: 3.3414 | rl_loss: 1.6191 | pt_loss: 1.7223 | pg_loss: 0.4902 | reg_loss: 1.1290 | reward: -0.5448 | rev_kl: 0.6445 | stu_lens: 33.0000 | mixed_lens: 79.0000 | lr: 3.3304e-06 | scale: 1024.00 | time: 26.376 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    459/  1000| tot_loss: 3.1745 | rl_loss: 2.0189 | pt_loss: 1.1556 | pg_loss: 0.6991 | reg_loss: 1.3198 | reward: -0.8671 | rev_kl: 1.4613 | stu_lens: 115.5000 | mixed_lens: 37.0000 | lr: 3.3222e-06 | scale: 1024.00 | time: 26.348 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    460/  1000| tot_loss: 3.0633 | rl_loss: 1.4217 | pt_loss: 1.6416 | pg_loss: 0.1105 | reg_loss: 1.3111 | reward: -0.1905 | rev_kl: 1.3151 | stu_lens: 128.0000 | mixed_lens: 122.5000 | lr: 3.3139e-06 | scale: 1024.00 | time: 26.381 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    461/  1000| tot_loss: 3.0881 | rl_loss: 1.7209 | pt_loss: 1.3672 | pg_loss: 0.3180 | reg_loss: 1.4029 | reward: -0.2296 | rev_kl: 0.8665 | stu_lens: 90.0000 | mixed_lens: 84.0000 | lr: 3.3057e-06 | scale: 1024.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    462/  1000| tot_loss: 2.8004 | rl_loss: 1.1172 | pt_loss: 1.6833 | pg_loss: 0.0295 | reg_loss: 1.0877 | reward: -0.3121 | rev_kl: 0.8597 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.2974e-06 | scale: 1024.00 | time: 26.343 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    463/  1000| tot_loss: 2.1926 | rl_loss: 0.6077 | pt_loss: 1.5849 | pg_loss: 0.1342 | reg_loss: 0.4735 | reward: -0.1099 | rev_kl: 0.5916 | stu_lens: 128.0000 | mixed_lens: 107.0000 | lr: 3.2891e-06 | scale: 1024.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    464/  1000| tot_loss: 2.6589 | rl_loss: 0.9427 | pt_loss: 1.7162 | pg_loss: 0.0765 | reg_loss: 0.8662 | reward: -0.2985 | rev_kl: 0.9645 | stu_lens: 113.0000 | mixed_lens: 128.0000 | lr: 3.2808e-06 | scale: 1024.00 | time: 26.335 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    464/  1000| tot_loss: 3.0397 | rl_loss: 1.3431 | pt_loss: 1.6965 | pg_loss: 0.2837 | reg_loss: 1.0594 | reward: -0.4244 | rev_kl: 0.9910 | stu_lens: 93.2969 | mixed_lens: 89.9844 | lr: 3.2808e-06 | scale: 1024.00 | time: 26.335 | step time: 27.565
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    465/  1000| tot_loss: 2.4906 | rl_loss: 0.5417 | pt_loss: 1.9489 | pg_loss: 0.0297 | reg_loss: 0.5120 | reward: -0.0246 | rev_kl: 0.6998 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.2725e-06 | scale: 1024.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    466/  1000| tot_loss: 2.9346 | rl_loss: 1.3004 | pt_loss: 1.6342 | pg_loss: 0.3615 | reg_loss: 0.9389 | reward: -0.6974 | rev_kl: 0.9867 | stu_lens: 75.5000 | mixed_lens: 71.5000 | lr: 3.2642e-06 | scale: 1024.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    467/  1000| tot_loss: 2.2584 | rl_loss: 0.6789 | pt_loss: 1.5796 | pg_loss: 0.2907 | reg_loss: 0.3881 | reward: -0.4959 | rev_kl: 0.2071 | stu_lens: 90.0000 | mixed_lens: 75.0000 | lr: 3.2559e-06 | scale: 1024.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    468/  1000| tot_loss: 2.3252 | rl_loss: 0.6989 | pt_loss: 1.6263 | pg_loss: 0.0057 | reg_loss: 0.6931 | reward: -0.1367 | rev_kl: 1.0368 | stu_lens: 115.0000 | mixed_lens: 128.0000 | lr: 3.2476e-06 | scale: 1024.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    469/  1000| tot_loss: 2.4011 | rl_loss: 0.8868 | pt_loss: 1.5143 | pg_loss: 0.0202 | reg_loss: 0.8666 | reward: -0.2954 | rev_kl: 1.2451 | stu_lens: 112.5000 | mixed_lens: 128.0000 | lr: 3.2393e-06 | scale: 1024.00 | time: 26.355 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    470/  1000| tot_loss: 2.9154 | rl_loss: 1.1208 | pt_loss: 1.7946 | pg_loss: 0.2744 | reg_loss: 0.8464 | reward: -0.8514 | rev_kl: 1.1970 | stu_lens: 83.0000 | mixed_lens: 75.5000 | lr: 3.2309e-06 | scale: 1024.00 | time: 26.371 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    471/  1000| tot_loss: 2.1703 | rl_loss: 0.9598 | pt_loss: 1.2104 | pg_loss: 0.0549 | reg_loss: 0.9049 | reward: -0.1946 | rev_kl: 1.4190 | stu_lens: 107.5000 | mixed_lens: 118.0000 | lr: 3.2226e-06 | scale: 1024.00 | time: 26.381 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    472/  1000| tot_loss: 2.3076 | rl_loss: 0.6946 | pt_loss: 1.6130 | pg_loss: 0.2668 | reg_loss: 0.4278 | reward: -0.3310 | rev_kl: 0.8537 | stu_lens: 99.0000 | mixed_lens: 83.0000 | lr: 3.2142e-06 | scale: 1024.00 | time: 26.373 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    473/  1000| tot_loss: 2.4167 | rl_loss: 0.8641 | pt_loss: 1.5526 | pg_loss: 0.1562 | reg_loss: 0.7079 | reward: -0.2699 | rev_kl: 0.8222 | stu_lens: 77.5000 | mixed_lens: 96.0000 | lr: 3.2059e-06 | scale: 1024.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    474/  1000| tot_loss: 3.0621 | rl_loss: 1.6363 | pt_loss: 1.4257 | pg_loss: 1.1981 | reg_loss: 0.4383 | reward: -0.5902 | rev_kl: 0.7816 | stu_lens: 39.5000 | mixed_lens: 35.0000 | lr: 3.1975e-06 | scale: 1024.00 | time: 26.338 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    475/  1000| tot_loss: 2.3720 | rl_loss: 0.8701 | pt_loss: 1.5019 | pg_loss: 0.2951 | reg_loss: 0.5750 | reward: -0.2567 | rev_kl: 1.2974 | stu_lens: 81.0000 | mixed_lens: 94.5000 | lr: 3.1891e-06 | scale: 1024.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    476/  1000| tot_loss: 2.3908 | rl_loss: 0.9559 | pt_loss: 1.4349 | pg_loss: 0.3715 | reg_loss: 0.5844 | reward: -0.1371 | rev_kl: 0.9028 | stu_lens: 128.0000 | mixed_lens: 79.5000 | lr: 3.1807e-06 | scale: 1024.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    477/  1000| tot_loss: 2.4658 | rl_loss: 0.8870 | pt_loss: 1.5788 | pg_loss: 0.0053 | reg_loss: 0.8817 | reward: -0.1842 | rev_kl: 0.7294 | stu_lens: 83.5000 | mixed_lens: 128.0000 | lr: 3.1723e-06 | scale: 1024.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    478/  1000| tot_loss: 3.3759 | rl_loss: 1.2814 | pt_loss: 2.0945 | pg_loss: 0.2616 | reg_loss: 1.0199 | reward: -0.2929 | rev_kl: 0.6722 | stu_lens: 90.5000 | mixed_lens: 84.5000 | lr: 3.1639e-06 | scale: 1024.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    479/  1000| tot_loss: 2.6224 | rl_loss: 1.2296 | pt_loss: 1.3928 | pg_loss: 0.4883 | reg_loss: 0.7413 | reward: -0.7783 | rev_kl: 1.3519 | stu_lens: 95.0000 | mixed_lens: 37.5000 | lr: 3.1555e-06 | scale: 1024.00 | time: 26.343 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    480/  1000| tot_loss: 2.7517 | rl_loss: 1.3185 | pt_loss: 1.4332 | pg_loss: 0.2823 | reg_loss: 1.0363 | reward: -0.7272 | rev_kl: 1.3618 | stu_lens: 115.5000 | mixed_lens: 89.0000 | lr: 3.1470e-06 | scale: 1024.00 | time: 26.387 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    480/  1000| tot_loss: 2.6030 | rl_loss: 1.0131 | pt_loss: 1.5900 | pg_loss: 0.3433 | reg_loss: 0.6697 | reward: -0.3952 | rev_kl: 0.9659 | stu_lens: 99.0625 | mixed_lens: 90.6406 | lr: 3.1470e-06 | scale: 1024.00 | time: 26.387 | step time: 27.556
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    481/  1000| tot_loss: 2.2060 | rl_loss: 1.0466 | pt_loss: 1.1595 | pg_loss: 0.3202 | reg_loss: 0.7264 | reward: 0.0794 | rev_kl: 0.5892 | stu_lens: 70.5000 | mixed_lens: 87.5000 | lr: 3.1386e-06 | scale: 1024.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    482/  1000| tot_loss: 1.6388 | rl_loss: 0.2951 | pt_loss: 1.3437 | pg_loss: 0.2179 | reg_loss: 0.0771 | reward: -1.2853 | rev_kl: 0.5382 | stu_lens: 65.0000 | mixed_lens: 44.0000 | lr: 3.1302e-06 | scale: 1024.00 | time: 26.371 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    483/  1000| tot_loss: 2.5453 | rl_loss: 0.6758 | pt_loss: 1.8695 | pg_loss: 0.0028 | reg_loss: 0.6730 | reward: -0.3843 | rev_kl: 1.0128 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.1217e-06 | scale: 1024.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    484/  1000| tot_loss: 2.3857 | rl_loss: 0.5956 | pt_loss: 1.7901 | pg_loss: 0.0581 | reg_loss: 0.5376 | reward: -0.4186 | rev_kl: 1.1672 | stu_lens: 128.0000 | mixed_lens: 125.0000 | lr: 3.1133e-06 | scale: 1024.00 | time: 26.349 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    485/  1000| tot_loss: 2.7543 | rl_loss: 1.0042 | pt_loss: 1.7501 | pg_loss: 0.2380 | reg_loss: 0.7662 | reward: -1.0020 | rev_kl: 0.9138 | stu_lens: 83.0000 | mixed_lens: 81.0000 | lr: 3.1048e-06 | scale: 1024.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    486/  1000| tot_loss: 2.4478 | rl_loss: 0.7136 | pt_loss: 1.7342 | pg_loss: 0.0596 | reg_loss: 0.6540 | reward: -0.2581 | rev_kl: 1.5209 | stu_lens: 101.5000 | mixed_lens: 112.0000 | lr: 3.0963e-06 | scale: 1024.00 | time: 26.315 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    487/  1000| tot_loss: 2.3651 | rl_loss: 0.7263 | pt_loss: 1.6388 | pg_loss: 0.1066 | reg_loss: 0.6197 | reward: -0.6140 | rev_kl: 0.9793 | stu_lens: 115.5000 | mixed_lens: 92.0000 | lr: 3.0879e-06 | scale: 1024.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    488/  1000| tot_loss: 2.2672 | rl_loss: 0.7248 | pt_loss: 1.5424 | pg_loss: 0.2375 | reg_loss: 0.4873 | reward: 0.1067 | rev_kl: 0.7762 | stu_lens: 91.5000 | mixed_lens: 87.5000 | lr: 3.0794e-06 | scale: 1024.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    489/  1000| tot_loss: 1.9362 | rl_loss: 0.6242 | pt_loss: 1.3120 | pg_loss: 0.0564 | reg_loss: 0.5678 | reward: -0.0886 | rev_kl: 1.4456 | stu_lens: 128.0000 | mixed_lens: 118.0000 | lr: 3.0709e-06 | scale: 1024.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    490/  1000| tot_loss: 1.8526 | rl_loss: 0.7843 | pt_loss: 1.0683 | pg_loss: 0.1519 | reg_loss: 0.6324 | reward: -0.2825 | rev_kl: 1.2852 | stu_lens: 64.0000 | mixed_lens: 105.0000 | lr: 3.0624e-06 | scale: 1024.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    491/  1000| tot_loss: 2.7056 | rl_loss: 0.6740 | pt_loss: 2.0316 | pg_loss: 0.1985 | reg_loss: 0.4755 | reward: -0.2670 | rev_kl: 1.0254 | stu_lens: 89.0000 | mixed_lens: 107.0000 | lr: 3.0539e-06 | scale: 1024.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    492/  1000| tot_loss: 2.7789 | rl_loss: 0.9619 | pt_loss: 1.8170 | pg_loss: 0.5014 | reg_loss: 0.4606 | reward: -0.5073 | rev_kl: 0.8109 | stu_lens: 128.0000 | mixed_lens: 66.0000 | lr: 3.0454e-06 | scale: 1024.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    493/  1000| tot_loss: 2.3735 | rl_loss: 0.4742 | pt_loss: 1.8994 | pg_loss: 0.0051 | reg_loss: 0.4691 | reward: -0.1746 | rev_kl: 0.9504 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.0368e-06 | scale: 1024.00 | time: 26.322 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    494/  1000| tot_loss: 2.3241 | rl_loss: 0.6441 | pt_loss: 1.6800 | pg_loss: 0.0132 | reg_loss: 0.6309 | reward: -0.2135 | rev_kl: 0.9056 | stu_lens: 77.5000 | mixed_lens: 128.0000 | lr: 3.0283e-06 | scale: 1024.00 | time: 26.352 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    495/  1000| tot_loss: 2.4663 | rl_loss: 0.5753 | pt_loss: 1.8910 | pg_loss: -0.0117 | reg_loss: 0.5871 | reward: -0.2098 | rev_kl: 0.6199 | stu_lens: 59.5000 | mixed_lens: 128.0000 | lr: 3.0198e-06 | scale: 1024.00 | time: 26.320 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    496/  1000| tot_loss: 1.6718 | rl_loss: 0.7131 | pt_loss: 0.9587 | pg_loss: 0.2291 | reg_loss: 0.4840 | reward: -0.1409 | rev_kl: 1.0479 | stu_lens: 128.0000 | mixed_lens: 79.5000 | lr: 3.0112e-06 | scale: 1024.00 | time: 26.334 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    496/  1000| tot_loss: 2.3887 | rl_loss: 0.7179 | pt_loss: 1.6708 | pg_loss: 0.2193 | reg_loss: 0.4986 | reward: -0.3772 | rev_kl: 0.9642 | stu_lens: 97.3281 | mixed_lens: 92.2656 | lr: 3.0112e-06 | scale: 1024.00 | time: 26.334 | step time: 27.542
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    497/  1000| tot_loss: 2.4690 | rl_loss: 0.7111 | pt_loss: 1.7579 | pg_loss: 0.1894 | reg_loss: 0.5217 | reward: -0.5414 | rev_kl: 0.2502 | stu_lens: 90.0000 | mixed_lens: 88.0000 | lr: 3.0027e-06 | scale: 1024.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    498/  1000| tot_loss: 2.3337 | rl_loss: 0.5485 | pt_loss: 1.7852 | pg_loss: 0.1381 | reg_loss: 0.4103 | reward: -0.0501 | rev_kl: 0.7472 | stu_lens: 63.0000 | mixed_lens: 107.0000 | lr: 2.9941e-06 | scale: 1024.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    499/  1000| tot_loss: 3.0807 | rl_loss: 1.4831 | pt_loss: 1.5976 | pg_loss: 0.8793 | reg_loss: 0.6038 | reward: -0.9683 | rev_kl: 1.2138 | stu_lens: 104.5000 | mixed_lens: 47.5000 | lr: 2.9856e-06 | scale: 1024.00 | time: 26.271 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/500
                                 Evaluation #5                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ It is boring to create the same      │
│                                       │ thing over and over again. It is     │
│                                       │ much more exciting to create         │
│                                       │ something new.                       │
│                                       │                                      │
│                                       │ That is why we have invented the     │
│                                       │ field of computer science. We can    │
│                                       │ use computers to simulate concepts   │
│                                       │ that we cannot physically create.    │
│                                       │ This way, we can study new ideas     │
│                                       │ without the risk of causing any      │
│                                       │ damage.                              │
│                                       │                                      │
│                                       │ For example, we can use computers to │
│                                       │ simulate the behavior of electrons   │
│                                       │ in a metal. This is called           │
│                                       │ electronics. We can use computers to │
│                                       │ simulate the behavior of molecules   │
│                                       │ in a liquid. This is called          │
│                                       │ chemistry. We can use computers to   │
│                                       │ simulate the behavior of people in a │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Have you ever thought about creating │
│                                       │ your own language? It's not as hard  │
│                                       │ as you might think. You can use      │
│                                       │ XBlank to create a new language.     │
│                                       │ XBlank is a tool that generates      │
│                                       │ lexical items from a seed lexicon.   │
│                                       │ It can be used to create languages   │
│                                       │ for fictional worlds, or to create   │
│                                       │ practical languages for use in       │
│                                       │ specific domains.                    │
│                                       │                                      │
│                                       │ To get started, you'll need to       │
│                                       │ decide on a few things. First,       │
│                                       │ you'll need to decide on the         │
│                                       │ philosophy behind your language.     │
│                                       │ What is it for? Is it for daily use, │
│                                       │ or is it for a specific purpose?     │
│                                       │ Next, you                            │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Okay, I will create something new. I │
│                                       │ will create a new programming        │
│                                       │ language.                            │
│                                       │                                      │
│                                       │ I will call it Sawtooth. It will be  │
│                                       │ a programming language that uses     │
│                                       │ jagged edges to represent shapes. It │
│                                       │ will be optimized for generating     │
│                                       │ complex shapes quickly.              │
│                                       │                                      │
│                                       │ It will be a multi-paradigm language │
│                                       │ that supports both functional and    │
│                                       │ object-oriented programming. It will │
│                                       │ have built-in support for            │
│                                       │ concurrency and parallelism.         │
│                                       │                                      │
│                                       │ It will have an expressive syntax    │
│                                       │ that is easy to learn. It will be a  │
│                                       │ statically typed language that does  │
│                                       │ not require the use of a compiler.   │
│                                       │                                      │
│                                       │ That                                 │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 15.876 | exact_match: 0.000 | rev_kl: 1.042 | lens: 94.534 | pt_loss: 1.099 | lm_loss: 1.194 | kd_loss: 1.003 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    500/  1000| tot_loss: 2.1925 | rl_loss: 0.4986 | pt_loss: 1.6938 | pg_loss: 0.1617 | reg_loss: 0.3369 | reward: -0.2265 | rev_kl: 1.4484 | stu_lens: 63.0000 | mixed_lens: 91.0000 | lr: 2.9770e-06 | scale: 1024.00 | time: 26.340 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    501/  1000| tot_loss: 2.6085 | rl_loss: 0.7417 | pt_loss: 1.8668 | pg_loss: 0.5436 | reg_loss: 0.1981 | reward: -1.2271 | rev_kl: 0.6490 | stu_lens: 65.0000 | mixed_lens: 65.0000 | lr: 2.9685e-06 | scale: 1024.00 | time: 26.367 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    502/  1000| tot_loss: 2.5754 | rl_loss: 0.5547 | pt_loss: 2.0207 | pg_loss: 0.0109 | reg_loss: 0.5437 | reward: -0.1581 | rev_kl: 1.0652 | stu_lens: 115.0000 | mixed_lens: 128.0000 | lr: 2.9599e-06 | scale: 1024.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    503/  1000| tot_loss: 2.5020 | rl_loss: 0.5352 | pt_loss: 1.9668 | pg_loss: 0.3316 | reg_loss: 0.2036 | reward: -0.4529 | rev_kl: 0.7374 | stu_lens: 55.5000 | mixed_lens: 61.0000 | lr: 2.9513e-06 | scale: 1024.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    504/  1000| tot_loss: 2.1567 | rl_loss: 0.2748 | pt_loss: 1.8820 | pg_loss: 0.0580 | reg_loss: 0.2168 | reward: -0.2536 | rev_kl: 0.5267 | stu_lens: 128.0000 | mixed_lens: 107.0000 | lr: 2.9427e-06 | scale: 1024.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    505/  1000| tot_loss: 2.2207 | rl_loss: 0.8992 | pt_loss: 1.3215 | pg_loss: 0.6753 | reg_loss: 0.2239 | reward: -0.6346 | rev_kl: 1.2661 | stu_lens: 99.5000 | mixed_lens: 52.5000 | lr: 2.9341e-06 | scale: 1024.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    506/  1000| tot_loss: 2.2170 | rl_loss: 0.5011 | pt_loss: 1.7159 | pg_loss: 0.3063 | reg_loss: 0.1948 | reward: -0.5390 | rev_kl: 0.9136 | stu_lens: 114.0000 | mixed_lens: 83.5000 | lr: 2.9255e-06 | scale: 1024.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    507/  1000| tot_loss: 2.8334 | rl_loss: 0.9946 | pt_loss: 1.8387 | pg_loss: 0.3181 | reg_loss: 0.6765 | reward: -0.5221 | rev_kl: 1.4578 | stu_lens: 74.5000 | mixed_lens: 73.5000 | lr: 2.9169e-06 | scale: 1024.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    508/  1000| tot_loss: 1.7518 | rl_loss: 0.5087 | pt_loss: 1.2431 | pg_loss: 0.0024 | reg_loss: 0.5063 | reward: -0.1131 | rev_kl: 1.1409 | stu_lens: 104.0000 | mixed_lens: 128.0000 | lr: 2.9083e-06 | scale: 1024.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    509/  1000| tot_loss: 2.3144 | rl_loss: 0.3867 | pt_loss: 1.9277 | pg_loss: 0.0153 | reg_loss: 0.3714 | reward: -0.2940 | rev_kl: 0.9265 | stu_lens: 77.5000 | mixed_lens: 128.0000 | lr: 2.8997e-06 | scale: 1024.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    510/  1000| tot_loss: 2.7444 | rl_loss: 0.9285 | pt_loss: 1.8159 | pg_loss: 0.5723 | reg_loss: 0.3562 | reward: -0.0202 | rev_kl: 1.1227 | stu_lens: 91.5000 | mixed_lens: 58.0000 | lr: 2.8911e-06 | scale: 1024.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    511/  1000| tot_loss: 2.1013 | rl_loss: 0.7025 | pt_loss: 1.3987 | pg_loss: 0.1635 | reg_loss: 0.5391 | reward: -0.4036 | rev_kl: 1.2286 | stu_lens: 115.5000 | mixed_lens: 92.0000 | lr: 2.8825e-06 | scale: 1024.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    512/  1000| tot_loss: 2.5056 | rl_loss: 0.5488 | pt_loss: 1.9569 | pg_loss: 0.0255 | reg_loss: 0.5233 | reward: -0.3070 | rev_kl: 1.0434 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8738e-06 | scale: 1024.00 | time: 26.284 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    512/  1000| tot_loss: 2.3842 | rl_loss: 0.6591 | pt_loss: 1.7251 | pg_loss: 0.2750 | reg_loss: 0.3841 | reward: -0.4214 | rev_kl: 0.9317 | stu_lens: 98.8594 | mixed_lens: 90.6719 | lr: 2.8738e-06 | scale: 1024.00 | time: 26.284 | step time: 27.517
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    513/  1000| tot_loss: 2.3958 | rl_loss: 0.5361 | pt_loss: 1.8597 | pg_loss: 0.2498 | reg_loss: 0.2863 | reward: -0.3770 | rev_kl: 1.4840 | stu_lens: 69.0000 | mixed_lens: 92.5000 | lr: 2.8652e-06 | scale: 1024.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    514/  1000| tot_loss: 3.7403 | rl_loss: 1.9995 | pt_loss: 1.7408 | pg_loss: 0.6286 | reg_loss: 1.3710 | reward: -0.1347 | rev_kl: 0.8080 | stu_lens: 66.5000 | mixed_lens: 66.5000 | lr: 2.8566e-06 | scale: 1024.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    515/  1000| tot_loss: 2.1397 | rl_loss: 0.6751 | pt_loss: 1.4646 | pg_loss: 0.1201 | reg_loss: 0.5550 | reward: 0.4484 | rev_kl: 0.4952 | stu_lens: 75.5000 | mixed_lens: 67.5000 | lr: 2.8479e-06 | scale: 1024.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    516/  1000| tot_loss: 1.2707 | rl_loss: -0.5615 | pt_loss: 1.8322 | pg_loss: -0.6455 | reg_loss: 0.0840 | reward: 0.0647 | rev_kl: 0.3532 | stu_lens: 51.0000 | mixed_lens: 24.0000 | lr: 2.8393e-06 | scale: 1024.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    517/  1000| tot_loss: 3.3004 | rl_loss: 1.6917 | pt_loss: 1.6087 | pg_loss: 0.4256 | reg_loss: 1.2661 | reward: -0.1332 | rev_kl: 2.0059 | stu_lens: 108.0000 | mixed_lens: 75.5000 | lr: 2.8306e-06 | scale: 1024.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    518/  1000| tot_loss: 4.8306 | rl_loss: 2.8067 | pt_loss: 2.0240 | pg_loss: 1.2783 | reg_loss: 1.5284 | reward: -0.5647 | rev_kl: 1.0725 | stu_lens: 51.5000 | mixed_lens: 41.0000 | lr: 2.8220e-06 | scale: 1024.00 | time: 26.344 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    519/  1000| tot_loss: 3.6178 | rl_loss: 1.7030 | pt_loss: 1.9148 | pg_loss: 1.4077 | reg_loss: 0.2953 | reward: 0.9675 | rev_kl: 0.2746 | stu_lens: 7.5000 | mixed_lens: 8.0000 | lr: 2.8133e-06 | scale: 1024.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    520/  1000| tot_loss: 2.7686 | rl_loss: 1.1285 | pt_loss: 1.6401 | pg_loss: 0.1789 | reg_loss: 0.9496 | reward: -0.1366 | rev_kl: 0.9378 | stu_lens: 106.0000 | mixed_lens: 108.0000 | lr: 2.8047e-06 | scale: 1024.00 | time: 26.378 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    521/  1000| tot_loss: 4.0622 | rl_loss: 2.3635 | pt_loss: 1.6987 | pg_loss: 0.7704 | reg_loss: 1.5931 | reward: -1.3317 | rev_kl: 1.7651 | stu_lens: 59.5000 | mixed_lens: 45.5000 | lr: 2.7960e-06 | scale: 1024.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    522/  1000| tot_loss: 3.6408 | rl_loss: 2.0907 | pt_loss: 1.5500 | pg_loss: 0.5666 | reg_loss: 1.5241 | reward: -0.2365 | rev_kl: 0.9338 | stu_lens: 36.5000 | mixed_lens: 50.0000 | lr: 2.7873e-06 | scale: 1024.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    523/  1000| tot_loss: 2.6795 | rl_loss: 0.9034 | pt_loss: 1.7761 | pg_loss: 0.0483 | reg_loss: 0.8551 | reward: -0.2032 | rev_kl: 0.6604 | stu_lens: 109.5000 | mixed_lens: 128.0000 | lr: 2.7787e-06 | scale: 1024.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    524/  1000| tot_loss: 2.5478 | rl_loss: 0.9914 | pt_loss: 1.5564 | pg_loss: 0.4891 | reg_loss: 0.5022 | reward: -0.3008 | rev_kl: 0.4775 | stu_lens: 74.5000 | mixed_lens: 76.0000 | lr: 2.7700e-06 | scale: 1024.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    525/  1000| tot_loss: 3.4518 | rl_loss: 1.6351 | pt_loss: 1.8167 | pg_loss: 0.2571 | reg_loss: 1.3780 | reward: -0.1713 | rev_kl: 7.5410 | stu_lens: 100.0000 | mixed_lens: 83.0000 | lr: 2.7613e-06 | scale: 1024.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    526/  1000| tot_loss: 3.2569 | rl_loss: 1.6476 | pt_loss: 1.6093 | pg_loss: 0.3506 | reg_loss: 1.2971 | reward: 0.2898 | rev_kl: 0.9898 | stu_lens: 71.5000 | mixed_lens: 76.5000 | lr: 2.7526e-06 | scale: 1024.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    527/  1000| tot_loss: 2.6614 | rl_loss: 1.1987 | pt_loss: 1.4627 | pg_loss: 0.0524 | reg_loss: 1.1463 | reward: -0.3257 | rev_kl: 0.9675 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.7440e-06 | scale: 1024.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    528/  1000| tot_loss: 3.0164 | rl_loss: 1.2712 | pt_loss: 1.7451 | pg_loss: 0.4637 | reg_loss: 0.8075 | reward: -0.4234 | rev_kl: 0.9615 | stu_lens: 60.5000 | mixed_lens: 70.0000 | lr: 2.7353e-06 | scale: 1024.00 | time: 26.313 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    528/  1000| tot_loss: 3.1849 | rl_loss: 1.4181 | pt_loss: 1.7667 | pg_loss: 0.4057 | reg_loss: 1.0124 | reward: -0.2478 | rev_kl: 1.2026 | stu_lens: 76.1406 | mixed_lens: 79.6406 | lr: 2.7353e-06 | scale: 1024.00 | time: 26.313 | step time: 27.506
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    529/  1000| tot_loss: 2.7418 | rl_loss: 1.2631 | pt_loss: 1.4787 | pg_loss: 0.1691 | reg_loss: 1.0939 | reward: -0.4321 | rev_kl: 0.9355 | stu_lens: 103.0000 | mixed_lens: 102.0000 | lr: 2.7266e-06 | scale: 1024.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    530/  1000| tot_loss: 1.9997 | rl_loss: 0.5865 | pt_loss: 1.4133 | pg_loss: 0.0001 | reg_loss: 0.5864 | reward: -0.1567 | rev_kl: 0.6097 | stu_lens: 109.5000 | mixed_lens: 128.0000 | lr: 2.7179e-06 | scale: 1024.00 | time: 26.320 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    531/  1000| tot_loss: 2.6665 | rl_loss: 1.0283 | pt_loss: 1.6382 | pg_loss: 0.1231 | reg_loss: 0.9052 | reward: -0.2398 | rev_kl: 7.6139 | stu_lens: 92.5000 | mixed_lens: 106.5000 | lr: 2.7092e-06 | scale: 1024.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    532/  1000| tot_loss: 3.3085 | rl_loss: 1.2992 | pt_loss: 2.0094 | pg_loss: 0.7108 | reg_loss: 0.5883 | reward: -0.4768 | rev_kl: 0.7240 | stu_lens: 78.5000 | mixed_lens: 55.5000 | lr: 2.7005e-06 | scale: 1024.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    533/  1000| tot_loss: 3.2349 | rl_loss: 1.5947 | pt_loss: 1.6402 | pg_loss: 0.5243 | reg_loss: 1.0704 | reward: -0.6102 | rev_kl: 1.2851 | stu_lens: 67.0000 | mixed_lens: 63.5000 | lr: 2.6918e-06 | scale: 1024.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    534/  1000| tot_loss: 2.0161 | rl_loss: 0.7723 | pt_loss: 1.2438 | pg_loss: -0.0027 | reg_loss: 0.7750 | reward: -0.2832 | rev_kl: 0.9000 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6831e-06 | scale: 1024.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    535/  1000| tot_loss: 2.3043 | rl_loss: 1.3075 | pt_loss: 0.9968 | pg_loss: 0.6851 | reg_loss: 0.6224 | reward: -0.0015 | rev_kl: 0.7485 | stu_lens: 56.5000 | mixed_lens: 51.5000 | lr: 2.6744e-06 | scale: 1024.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    536/  1000| tot_loss: 3.2975 | rl_loss: 1.2537 | pt_loss: 2.0438 | pg_loss: 0.6387 | reg_loss: 0.6150 | reward: -0.2979 | rev_kl: 0.8745 | stu_lens: 65.5000 | mixed_lens: 53.0000 | lr: 2.6657e-06 | scale: 1024.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    537/  1000| tot_loss: 2.4279 | rl_loss: 0.6504 | pt_loss: 1.7774 | pg_loss: 0.0925 | reg_loss: 0.5579 | reward: -0.1715 | rev_kl: 0.7756 | stu_lens: 95.0000 | mixed_lens: 113.0000 | lr: 2.6570e-06 | scale: 1024.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    538/  1000| tot_loss: 2.7747 | rl_loss: 0.9072 | pt_loss: 1.8675 | pg_loss: 0.2644 | reg_loss: 0.6428 | reward: -0.1258 | rev_kl: 0.8127 | stu_lens: 60.5000 | mixed_lens: 89.0000 | lr: 2.6483e-06 | scale: 1024.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    539/  1000| tot_loss: 3.1829 | rl_loss: 1.6200 | pt_loss: 1.5629 | pg_loss: 0.3527 | reg_loss: 1.2673 | reward: -0.7810 | rev_kl: 1.4830 | stu_lens: 64.5000 | mixed_lens: 85.5000 | lr: 2.6396e-06 | scale: 1024.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    540/  1000| tot_loss: 2.1122 | rl_loss: 0.4834 | pt_loss: 1.6288 | pg_loss: -0.0067 | reg_loss: 0.4901 | reward: -0.0948 | rev_kl: 0.9797 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6308e-06 | scale: 1024.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    541/  1000| tot_loss: 3.3853 | rl_loss: 1.2154 | pt_loss: 2.1699 | pg_loss: 0.8270 | reg_loss: 0.3884 | reward: 0.8862 | rev_kl: 0.7752 | stu_lens: 27.0000 | mixed_lens: 10.5000 | lr: 2.6221e-06 | scale: 1024.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    542/  1000| tot_loss: 2.6799 | rl_loss: 1.4153 | pt_loss: 1.2646 | pg_loss: 0.4565 | reg_loss: 0.9588 | reward: -0.1706 | rev_kl: 1.4435 | stu_lens: 108.0000 | mixed_lens: 64.0000 | lr: 2.6134e-06 | scale: 1024.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    543/  1000| tot_loss: 2.3358 | rl_loss: 1.1616 | pt_loss: 1.1741 | pg_loss: 0.2901 | reg_loss: 0.8716 | reward: -0.2179 | rev_kl: 0.9710 | stu_lens: 84.0000 | mixed_lens: 98.0000 | lr: 2.6047e-06 | scale: 1024.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    544/  1000| tot_loss: 3.2545 | rl_loss: 1.4387 | pt_loss: 1.8157 | pg_loss: 0.7932 | reg_loss: 0.6455 | reward: -0.3927 | rev_kl: 0.6623 | stu_lens: 45.5000 | mixed_lens: 37.0000 | lr: 2.5960e-06 | scale: 1024.00 | time: 26.278 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    544/  1000| tot_loss: 2.6798 | rl_loss: 1.0345 | pt_loss: 1.6452 | pg_loss: 0.3049 | reg_loss: 0.7296 | reward: -0.2812 | rev_kl: 1.1757 | stu_lens: 78.7500 | mixed_lens: 79.4688 | lr: 2.5960e-06 | scale: 1024.00 | time: 26.278 | step time: 27.510
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    545/  1000| tot_loss: 2.2451 | rl_loss: 0.7838 | pt_loss: 1.4613 | pg_loss: 0.1059 | reg_loss: 0.6779 | reward: -0.2306 | rev_kl: 1.8344 | stu_lens: 85.0000 | mixed_lens: 107.5000 | lr: 2.5872e-06 | scale: 1024.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    546/  1000| tot_loss: 2.9598 | rl_loss: 1.2445 | pt_loss: 1.7152 | pg_loss: 1.1373 | reg_loss: 0.1073 | reward: -0.2160 | rev_kl: 0.2425 | stu_lens: 16.0000 | mixed_lens: 17.5000 | lr: 2.5785e-06 | scale: 1024.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    547/  1000| tot_loss: 3.5377 | rl_loss: 1.5155 | pt_loss: 2.0222 | pg_loss: 0.5910 | reg_loss: 0.9245 | reward: 0.9737 | rev_kl: 0.9953 | stu_lens: 45.0000 | mixed_lens: 66.5000 | lr: 2.5698e-06 | scale: 1024.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    548/  1000| tot_loss: 3.4928 | rl_loss: 1.3753 | pt_loss: 2.1175 | pg_loss: 0.3762 | reg_loss: 0.9991 | reward: -1.1043 | rev_kl: 1.1640 | stu_lens: 47.5000 | mixed_lens: 66.5000 | lr: 2.5611e-06 | scale: 1024.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    549/  1000| tot_loss: 2.3493 | rl_loss: 0.7140 | pt_loss: 1.6353 | pg_loss: 0.1172 | reg_loss: 0.5967 | reward: -0.4180 | rev_kl: 1.1961 | stu_lens: 103.0000 | mixed_lens: 102.0000 | lr: 2.5524e-06 | scale: 1024.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    550/  1000| tot_loss: 2.8855 | rl_loss: 0.9739 | pt_loss: 1.9116 | pg_loss: 0.4467 | reg_loss: 0.5272 | reward: -0.7056 | rev_kl: 1.1349 | stu_lens: 76.5000 | mixed_lens: 65.5000 | lr: 2.5436e-06 | scale: 1024.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    551/  1000| tot_loss: 2.3846 | rl_loss: 0.7712 | pt_loss: 1.6134 | pg_loss: 0.4540 | reg_loss: 0.3172 | reward: -0.3096 | rev_kl: 0.7804 | stu_lens: 112.5000 | mixed_lens: 96.5000 | lr: 2.5349e-06 | scale: 1024.00 | time: 26.225 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    552/  1000| tot_loss: 3.1253 | rl_loss: 1.2647 | pt_loss: 1.8605 | pg_loss: 0.4938 | reg_loss: 0.7709 | reward: -0.6518 | rev_kl: 0.9154 | stu_lens: 68.0000 | mixed_lens: 73.0000 | lr: 2.5262e-06 | scale: 1024.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    553/  1000| tot_loss: 2.3819 | rl_loss: 0.4907 | pt_loss: 1.8912 | pg_loss: 0.1557 | reg_loss: 0.3351 | reward: -0.4154 | rev_kl: 0.5036 | stu_lens: 93.5000 | mixed_lens: 93.0000 | lr: 2.5175e-06 | scale: 1024.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    554/  1000| tot_loss: 2.7313 | rl_loss: 0.9909 | pt_loss: 1.7405 | pg_loss: 0.4964 | reg_loss: 0.4944 | reward: -0.4559 | rev_kl: 0.9091 | stu_lens: 77.5000 | mixed_lens: 75.5000 | lr: 2.5087e-06 | scale: 1024.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    555/  1000| tot_loss: 2.1943 | rl_loss: 0.6527 | pt_loss: 1.5416 | pg_loss: 0.1539 | reg_loss: 0.4988 | reward: 0.0491 | rev_kl: 7.7591 | stu_lens: 80.0000 | mixed_lens: 54.0000 | lr: 2.5000e-06 | scale: 1024.00 | time: 26.203 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    556/  1000| tot_loss: 2.2224 | rl_loss: 0.6050 | pt_loss: 1.6174 | pg_loss: 0.1203 | reg_loss: 0.4846 | reward: -0.3045 | rev_kl: 1.4319 | stu_lens: 92.0000 | mixed_lens: 89.5000 | lr: 2.4913e-06 | scale: 1024.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    557/  1000| tot_loss: 1.9984 | rl_loss: 0.5051 | pt_loss: 1.4933 | pg_loss: 0.0944 | reg_loss: 0.4107 | reward: -0.1686 | rev_kl: 0.7687 | stu_lens: 89.0000 | mixed_lens: 111.0000 | lr: 2.4825e-06 | scale: 1024.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    558/  1000| tot_loss: 2.2116 | rl_loss: 0.8411 | pt_loss: 1.3705 | pg_loss: 0.3342 | reg_loss: 0.5069 | reward: -0.3567 | rev_kl: 1.2034 | stu_lens: 73.5000 | mixed_lens: 93.5000 | lr: 2.4738e-06 | scale: 1024.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    559/  1000| tot_loss: 2.3156 | rl_loss: 0.5842 | pt_loss: 1.7314 | pg_loss: 0.1009 | reg_loss: 0.4833 | reward: -0.2306 | rev_kl: 1.8344 | stu_lens: 85.0000 | mixed_lens: 107.5000 | lr: 2.4651e-06 | scale: 1024.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    560/  1000| tot_loss: 2.1166 | rl_loss: 0.3291 | pt_loss: 1.7874 | pg_loss: 0.0895 | reg_loss: 0.2397 | reward: -0.1452 | rev_kl: 0.5843 | stu_lens: 96.5000 | mixed_lens: 108.5000 | lr: 2.4564e-06 | scale: 1024.00 | time: 26.313 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    560/  1000| tot_loss: 2.5568 | rl_loss: 0.8235 | pt_loss: 1.7332 | pg_loss: 0.2884 | reg_loss: 0.5352 | reward: -0.2801 | rev_kl: 1.2328 | stu_lens: 76.7812 | mixed_lens: 80.5625 | lr: 2.4564e-06 | scale: 1024.00 | time: 26.313 | step time: 27.491
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    561/  1000| tot_loss: 2.7626 | rl_loss: 1.6562 | pt_loss: 1.1064 | pg_loss: 1.2013 | reg_loss: 0.4548 | reward: -0.4823 | rev_kl: 0.9505 | stu_lens: 79.5000 | mixed_lens: 37.0000 | lr: 2.4476e-06 | scale: 1024.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    562/  1000| tot_loss: 2.5466 | rl_loss: 0.8225 | pt_loss: 1.7241 | pg_loss: 0.5784 | reg_loss: 0.2441 | reward: -0.3578 | rev_kl: 1.2623 | stu_lens: 42.5000 | mixed_lens: 42.5000 | lr: 2.4389e-06 | scale: 1024.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    563/  1000| tot_loss: 2.5901 | rl_loss: 0.2148 | pt_loss: 2.3753 | pg_loss: 0.0440 | reg_loss: 0.1708 | reward: -0.0901 | rev_kl: 7.1154 | stu_lens: 100.0000 | mixed_lens: 106.5000 | lr: 2.4302e-06 | scale: 1024.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    564/  1000| tot_loss: 1.9411 | rl_loss: 0.2847 | pt_loss: 1.6565 | pg_loss: -0.0028 | reg_loss: 0.2875 | reward: -0.2502 | rev_kl: 0.8840 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.4215e-06 | scale: 1024.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    565/  1000| tot_loss: 2.3023 | rl_loss: 0.5304 | pt_loss: 1.7719 | pg_loss: 0.2286 | reg_loss: 0.3018 | reward: -0.1130 | rev_kl: 0.8542 | stu_lens: 81.5000 | mixed_lens: 91.0000 | lr: 2.4128e-06 | scale: 1024.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    566/  1000| tot_loss: 2.5116 | rl_loss: 0.9207 | pt_loss: 1.5908 | pg_loss: 0.2357 | reg_loss: 0.6851 | reward: -0.2186 | rev_kl: 1.2660 | stu_lens: 91.5000 | mixed_lens: 96.5000 | lr: 2.4040e-06 | scale: 1024.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    567/  1000| tot_loss: 2.9396 | rl_loss: 1.4562 | pt_loss: 1.4834 | pg_loss: 1.0423 | reg_loss: 0.4139 | reward: -0.3938 | rev_kl: 1.3364 | stu_lens: 53.0000 | mixed_lens: 39.5000 | lr: 2.3953e-06 | scale: 1024.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    568/  1000| tot_loss: 2.2389 | rl_loss: 0.5908 | pt_loss: 1.6482 | pg_loss: 0.0710 | reg_loss: 0.5197 | reward: -0.3697 | rev_kl: 1.0241 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 2.3866e-06 | scale: 1024.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    569/  1000| tot_loss: 3.0027 | rl_loss: 1.1646 | pt_loss: 1.8381 | pg_loss: 0.5180 | reg_loss: 0.6466 | reward: -0.2612 | rev_kl: 1.3159 | stu_lens: 89.0000 | mixed_lens: 72.0000 | lr: 2.3779e-06 | scale: 1024.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    570/  1000| tot_loss: 2.7871 | rl_loss: 1.0224 | pt_loss: 1.7646 | pg_loss: 0.5583 | reg_loss: 0.4641 | reward: -0.4828 | rev_kl: 1.0820 | stu_lens: 109.5000 | mixed_lens: 70.0000 | lr: 2.3692e-06 | scale: 1024.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    571/  1000| tot_loss: 2.5421 | rl_loss: 0.9569 | pt_loss: 1.5852 | pg_loss: 0.5927 | reg_loss: 0.3642 | reward: 1.0538 | rev_kl: 0.8380 | stu_lens: 23.0000 | mixed_lens: 46.0000 | lr: 2.3604e-06 | scale: 1024.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    572/  1000| tot_loss: 1.9226 | rl_loss: 0.4680 | pt_loss: 1.4545 | pg_loss: 0.0708 | reg_loss: 0.3973 | reward: -0.2006 | rev_kl: 0.7402 | stu_lens: 128.0000 | mixed_lens: 119.5000 | lr: 2.3517e-06 | scale: 1024.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    573/  1000| tot_loss: 2.4391 | rl_loss: 0.5279 | pt_loss: 1.9112 | pg_loss: 0.0644 | reg_loss: 0.4635 | reward: -0.1334 | rev_kl: 1.2407 | stu_lens: 128.0000 | mixed_lens: 104.5000 | lr: 2.3430e-06 | scale: 1024.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    574/  1000| tot_loss: 2.7550 | rl_loss: 0.9973 | pt_loss: 1.7577 | pg_loss: 0.8121 | reg_loss: 0.1852 | reward: -0.2805 | rev_kl: 0.7230 | stu_lens: 47.5000 | mixed_lens: 45.0000 | lr: 2.3343e-06 | scale: 1024.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    575/  1000| tot_loss: 2.5333 | rl_loss: 0.8124 | pt_loss: 1.7209 | pg_loss: 0.2823 | reg_loss: 0.5301 | reward: -0.2132 | rev_kl: 0.9716 | stu_lens: 57.5000 | mixed_lens: 77.0000 | lr: 2.3256e-06 | scale: 1024.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    576/  1000| tot_loss: 4.5425 | rl_loss: 2.5608 | pt_loss: 1.9818 | pg_loss: 2.1679 | reg_loss: 0.3929 | reward: -0.5015 | rev_kl: 0.3182 | stu_lens: 14.0000 | mixed_lens: 11.5000 | lr: 2.3169e-06 | scale: 1024.00 | time: 26.289 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    576/  1000| tot_loss: 2.5115 | rl_loss: 0.8017 | pt_loss: 1.7098 | pg_loss: 0.4016 | reg_loss: 0.4001 | reward: -0.2336 | rev_kl: 1.1661 | stu_lens: 74.7500 | mixed_lens: 74.0312 | lr: 2.3169e-06 | scale: 1024.00 | time: 26.289 | step time: 27.502
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    577/  1000| tot_loss: 2.5657 | rl_loss: 0.6928 | pt_loss: 1.8729 | pg_loss: 0.2884 | reg_loss: 0.4044 | reward: -0.7612 | rev_kl: 1.0494 | stu_lens: 84.0000 | mixed_lens: 85.5000 | lr: 2.3082e-06 | scale: 1024.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    578/  1000| tot_loss: 3.0361 | rl_loss: 1.3226 | pt_loss: 1.7135 | pg_loss: 0.6539 | reg_loss: 0.6687 | reward: -0.1979 | rev_kl: 1.0504 | stu_lens: 99.5000 | mixed_lens: 46.0000 | lr: 2.2995e-06 | scale: 1024.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    579/  1000| tot_loss: 2.9356 | rl_loss: 1.3288 | pt_loss: 1.6068 | pg_loss: 0.2851 | reg_loss: 1.0436 | reward: -0.2924 | rev_kl: 0.7381 | stu_lens: 128.0000 | mixed_lens: 95.5000 | lr: 2.2908e-06 | scale: 1024.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    580/  1000| tot_loss: 2.9321 | rl_loss: 1.4573 | pt_loss: 1.4748 | pg_loss: 0.1195 | reg_loss: 1.3378 | reward: -0.4405 | rev_kl: 1.1119 | stu_lens: 82.0000 | mixed_lens: 114.0000 | lr: 2.2821e-06 | scale: 1024.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    581/  1000| tot_loss: 5.7660 | rl_loss: 3.7858 | pt_loss: 1.9802 | pg_loss: 2.0258 | reg_loss: 1.7600 | reward: -2.0225 | rev_kl: 0.5184 | stu_lens: 25.5000 | mixed_lens: 18.5000 | lr: 2.2734e-06 | scale: 1024.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    582/  1000| tot_loss: 3.1298 | rl_loss: 0.8651 | pt_loss: 2.2647 | pg_loss: 0.1588 | reg_loss: 0.7064 | reward: -0.1587 | rev_kl: 1.1495 | stu_lens: 127.0000 | mixed_lens: 103.0000 | lr: 2.2647e-06 | scale: 1024.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    583/  1000| tot_loss: 2.9617 | rl_loss: 1.2192 | pt_loss: 1.7425 | pg_loss: 0.4941 | reg_loss: 0.7251 | reward: -0.4837 | rev_kl: 0.7982 | stu_lens: 122.0000 | mixed_lens: 72.0000 | lr: 2.2560e-06 | scale: 1024.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    584/  1000| tot_loss: 1.8281 | rl_loss: 0.7342 | pt_loss: 1.0939 | pg_loss: 0.0528 | reg_loss: 0.6814 | reward: -0.2177 | rev_kl: 0.5993 | stu_lens: 118.0000 | mixed_lens: 128.0000 | lr: 2.2474e-06 | scale: 1024.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    585/  1000| tot_loss: 4.1768 | rl_loss: 3.0100 | pt_loss: 1.1668 | pg_loss: 1.1950 | reg_loss: 1.8151 | reward: -0.9640 | rev_kl: 1.4793 | stu_lens: 84.0000 | mixed_lens: 35.5000 | lr: 2.2387e-06 | scale: 1024.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    586/  1000| tot_loss: 3.9387 | rl_loss: 1.8505 | pt_loss: 2.0883 | pg_loss: 0.2462 | reg_loss: 1.6043 | reward: -0.3623 | rev_kl: 1.1984 | stu_lens: 73.0000 | mixed_lens: 90.5000 | lr: 2.2300e-06 | scale: 1024.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    587/  1000| tot_loss: 2.9166 | rl_loss: 1.0568 | pt_loss: 1.8598 | pg_loss: 0.3175 | reg_loss: 0.7393 | reward: -0.1833 | rev_kl: 0.5433 | stu_lens: 70.0000 | mixed_lens: 71.0000 | lr: 2.2213e-06 | scale: 1024.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    588/  1000| tot_loss: 2.5011 | rl_loss: 0.7183 | pt_loss: 1.7829 | pg_loss: 0.2517 | reg_loss: 0.4666 | reward: -0.3975 | rev_kl: 0.9747 | stu_lens: 91.5000 | mixed_lens: 80.0000 | lr: 2.2127e-06 | scale: 1024.00 | time: 26.204 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    589/  1000| tot_loss: 2.8714 | rl_loss: 1.4390 | pt_loss: 1.4325 | pg_loss: 0.1118 | reg_loss: 1.3271 | reward: -0.2323 | rev_kl: 1.1967 | stu_lens: 128.0000 | mixed_lens: 121.0000 | lr: 2.2040e-06 | scale: 1024.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    590/  1000| tot_loss: 3.7674 | rl_loss: 2.2805 | pt_loss: 1.4869 | pg_loss: 1.0174 | reg_loss: 1.2631 | reward: -1.7886 | rev_kl: 0.4367 | stu_lens: 66.0000 | mixed_lens: 34.0000 | lr: 2.1953e-06 | scale: 1024.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    591/  1000| tot_loss: 2.8056 | rl_loss: 0.9389 | pt_loss: 1.8668 | pg_loss: 0.1574 | reg_loss: 0.7814 | reward: -0.3175 | rev_kl: 0.6285 | stu_lens: 89.5000 | mixed_lens: 100.0000 | lr: 2.1867e-06 | scale: 1024.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    592/  1000| tot_loss: 3.2998 | rl_loss: 1.7163 | pt_loss: 1.5835 | pg_loss: 0.4114 | reg_loss: 1.3049 | reward: -4.8736 | rev_kl: 1.8580 | stu_lens: 62.0000 | mixed_lens: 53.5000 | lr: 2.1780e-06 | scale: 1024.00 | time: 26.293 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    592/  1000| tot_loss: 3.0799 | rl_loss: 1.4180 | pt_loss: 1.6619 | pg_loss: 0.3480 | reg_loss: 1.0700 | reward: -0.5932 | rev_kl: 0.9745 | stu_lens: 89.9688 | mixed_lens: 84.5625 | lr: 2.1780e-06 | scale: 1024.00 | time: 26.293 | step time: 27.485
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    593/  1000| tot_loss: 3.1724 | rl_loss: 1.2571 | pt_loss: 1.9154 | pg_loss: 0.3842 | reg_loss: 0.8728 | reward: -0.7635 | rev_kl: 0.6257 | stu_lens: 37.0000 | mixed_lens: 64.5000 | lr: 2.1694e-06 | scale: 1024.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    594/  1000| tot_loss: 3.0867 | rl_loss: 1.0622 | pt_loss: 2.0244 | pg_loss: 0.2708 | reg_loss: 0.7915 | reward: -0.4345 | rev_kl: 0.7370 | stu_lens: 128.0000 | mixed_lens: 80.5000 | lr: 2.1607e-06 | scale: 1024.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    595/  1000| tot_loss: 2.7654 | rl_loss: 0.8049 | pt_loss: 1.9605 | pg_loss: 0.2134 | reg_loss: 0.5916 | reward: -0.3203 | rev_kl: 0.9927 | stu_lens: 128.0000 | mixed_lens: 88.5000 | lr: 2.1521e-06 | scale: 1024.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    596/  1000| tot_loss: 3.3132 | rl_loss: 1.7004 | pt_loss: 1.6128 | pg_loss: 0.5858 | reg_loss: 1.1146 | reward: -1.1646 | rev_kl: 0.7800 | stu_lens: 50.5000 | mixed_lens: 55.5000 | lr: 2.1434e-06 | scale: 1024.00 | time: 26.209 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    597/  1000| tot_loss: 2.1831 | rl_loss: 0.5253 | pt_loss: 1.6579 | pg_loss: 0.0278 | reg_loss: 0.4975 | reward: -0.4474 | rev_kl: 1.0340 | stu_lens: 128.0000 | mixed_lens: 114.0000 | lr: 2.1348e-06 | scale: 1024.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    598/  1000| tot_loss: 2.3368 | rl_loss: 0.7970 | pt_loss: 1.5398 | pg_loss: 0.3800 | reg_loss: 0.4170 | reward: -0.3373 | rev_kl: 0.6342 | stu_lens: 128.0000 | mixed_lens: 79.5000 | lr: 2.1262e-06 | scale: 1024.00 | time: 26.202 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    599/  1000| tot_loss: 3.0336 | rl_loss: 1.2590 | pt_loss: 1.7746 | pg_loss: 0.3972 | reg_loss: 0.8618 | reward: -0.3460 | rev_kl: 1.2886 | stu_lens: 61.0000 | mixed_lens: 75.0000 | lr: 2.1175e-06 | scale: 1024.00 | time: 26.296 | step time: 0.000
                                 Evaluation #6                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ That is fine. You can create         │
│                                       │ something new. However, before you   │
│                                       │ can create something new, you must   │
│                                       │ first understand how something old   │
│                                       │ works. You must study the old to     │
│                                       │ understand the new.                  │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ That's what innovation is all about. │
│                                       │ Creating something new. You can      │
│                                       │ create something new by combining    │
│                                       │ existing ideas in new ways. Or by    │
│                                       │ combining existing ideas with new    │
│                                       │ technology. Or by combining existing │
│                                       │ ideas with new materials. The        │
│                                       │ possibilities are endless.           │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ That's great! The first step is to   │
│                                       │ decide what you want to create.      │
│                                       │ Then, you can do some research to    │
│                                       │ find out if anyone has created       │
│                                       │ something similar before. If so, you │
│                                       │ can try to improve on their idea or  │
│                                       │ create something completely          │
│                                       │ different.                           │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.454 | exact_match: 0.000 | rev_kl: 1.057 | lens: 89.500 | pt_loss: 1.097 | lm_loss: 1.191 | kd_loss: 1.003 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    600/  1000| tot_loss: 2.9022 | rl_loss: 1.5752 | pt_loss: 1.3270 | pg_loss: 0.6056 | reg_loss: 0.9695 | reward: -0.5769 | rev_kl: 1.3104 | stu_lens: 88.0000 | mixed_lens: 66.0000 | lr: 2.1089e-06 | scale: 1024.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    601/  1000| tot_loss: 1.9884 | rl_loss: 0.8955 | pt_loss: 1.0930 | pg_loss: 0.3001 | reg_loss: 0.5953 | reward: -0.6741 | rev_kl: 0.8892 | stu_lens: 74.5000 | mixed_lens: 74.5000 | lr: 2.1003e-06 | scale: 1024.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    602/  1000| tot_loss: 2.1427 | rl_loss: 0.8891 | pt_loss: 1.2536 | pg_loss: 0.4511 | reg_loss: 0.4380 | reward: -0.8142 | rev_kl: 1.3272 | stu_lens: 91.5000 | mixed_lens: 63.5000 | lr: 2.0917e-06 | scale: 1024.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    603/  1000| tot_loss: 4.4674 | rl_loss: 2.9256 | pt_loss: 1.5418 | pg_loss: 1.8060 | reg_loss: 1.1196 | reward: -0.1658 | rev_kl: 1.5485 | stu_lens: 38.5000 | mixed_lens: 17.0000 | lr: 2.0831e-06 | scale: 1024.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    604/  1000| tot_loss: 3.1410 | rl_loss: 1.4126 | pt_loss: 1.7284 | pg_loss: 0.2634 | reg_loss: 1.1492 | reward: -0.0788 | rev_kl: 1.3248 | stu_lens: 98.5000 | mixed_lens: 74.0000 | lr: 2.0745e-06 | scale: 1024.00 | time: 26.211 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    605/  1000| tot_loss: 2.5302 | rl_loss: 1.0197 | pt_loss: 1.5104 | pg_loss: -0.0018 | reg_loss: 1.0216 | reward: -0.2716 | rev_kl: 1.2047 | stu_lens: 78.5000 | mixed_lens: 128.0000 | lr: 2.0659e-06 | scale: 1024.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    606/  1000| tot_loss: 2.0825 | rl_loss: 0.5877 | pt_loss: 1.4948 | pg_loss: 0.1649 | reg_loss: 0.4228 | reward: -0.1257 | rev_kl: 0.5124 | stu_lens: 128.0000 | mixed_lens: 74.0000 | lr: 2.0573e-06 | scale: 1024.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    607/  1000| tot_loss: 2.5128 | rl_loss: 1.0895 | pt_loss: 1.4233 | pg_loss: 0.4802 | reg_loss: 0.6093 | reward: -1.0852 | rev_kl: 0.3993 | stu_lens: 58.0000 | mixed_lens: 73.5000 | lr: 2.0487e-06 | scale: 1024.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    608/  1000| tot_loss: 2.7543 | rl_loss: 1.0560 | pt_loss: 1.6983 | pg_loss: 0.2538 | reg_loss: 0.8023 | reward: -0.4219 | rev_kl: 1.4700 | stu_lens: 42.5000 | mixed_lens: 99.0000 | lr: 2.0401e-06 | scale: 1024.00 | time: 26.298 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    608/  1000| tot_loss: 2.8665 | rl_loss: 1.1599 | pt_loss: 1.7065 | pg_loss: 0.3720 | reg_loss: 0.7880 | reward: -0.6012 | rev_kl: 0.9459 | stu_lens: 87.3906 | mixed_lens: 82.3906 | lr: 2.0401e-06 | scale: 1024.00 | time: 26.298 | step time: 27.475
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    609/  1000| tot_loss: 3.2185 | rl_loss: 1.6048 | pt_loss: 1.6137 | pg_loss: 0.4243 | reg_loss: 1.1806 | reward: -0.6464 | rev_kl: 1.1233 | stu_lens: 122.0000 | mixed_lens: 84.5000 | lr: 2.0315e-06 | scale: 1024.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    610/  1000| tot_loss: 2.2130 | rl_loss: 0.5277 | pt_loss: 1.6853 | pg_loss: -0.0159 | reg_loss: 0.5436 | reward: -0.2211 | rev_kl: 0.9953 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.0230e-06 | scale: 1024.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    611/  1000| tot_loss: 2.0330 | rl_loss: 0.5620 | pt_loss: 1.4710 | pg_loss: 0.4129 | reg_loss: 0.1491 | reward: 0.1385 | rev_kl: 0.5170 | stu_lens: 72.5000 | mixed_lens: 54.0000 | lr: 2.0144e-06 | scale: 1024.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    612/  1000| tot_loss: 2.5450 | rl_loss: 0.4612 | pt_loss: 2.0838 | pg_loss: 0.0729 | reg_loss: 0.3883 | reward: -0.1809 | rev_kl: 0.9344 | stu_lens: 127.0000 | mixed_lens: 113.0000 | lr: 2.0059e-06 | scale: 1024.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    613/  1000| tot_loss: 3.1695 | rl_loss: 1.5098 | pt_loss: 1.6597 | pg_loss: 0.6961 | reg_loss: 0.8137 | reward: -0.2203 | rev_kl: 0.6666 | stu_lens: 89.5000 | mixed_lens: 46.0000 | lr: 1.9973e-06 | scale: 1024.00 | time: 26.197 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    614/  1000| tot_loss: 2.7245 | rl_loss: 0.6851 | pt_loss: 2.0394 | pg_loss: 0.1172 | reg_loss: 0.5678 | reward: -0.2570 | rev_kl: 0.9443 | stu_lens: 92.5000 | mixed_lens: 110.5000 | lr: 1.9888e-06 | scale: 1024.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    615/  1000| tot_loss: 2.2579 | rl_loss: 0.5691 | pt_loss: 1.6888 | pg_loss: 0.2968 | reg_loss: 0.2723 | reward: -0.5435 | rev_kl: 0.7673 | stu_lens: 128.0000 | mixed_lens: 67.5000 | lr: 1.9802e-06 | scale: 1024.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    616/  1000| tot_loss: 3.0313 | rl_loss: 1.2691 | pt_loss: 1.7622 | pg_loss: 0.7171 | reg_loss: 0.5520 | reward: -0.3223 | rev_kl: 0.8637 | stu_lens: 26.5000 | mixed_lens: 34.0000 | lr: 1.9717e-06 | scale: 1024.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    617/  1000| tot_loss: 2.5978 | rl_loss: 0.7564 | pt_loss: 1.8414 | pg_loss: 0.2170 | reg_loss: 0.5394 | reward: -0.3870 | rev_kl: 1.1332 | stu_lens: 92.0000 | mixed_lens: 92.0000 | lr: 1.9632e-06 | scale: 1024.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    618/  1000| tot_loss: 3.1387 | rl_loss: 1.7877 | pt_loss: 1.3511 | pg_loss: 1.0886 | reg_loss: 0.6991 | reward: -0.7793 | rev_kl: 1.2964 | stu_lens: 85.5000 | mixed_lens: 39.0000 | lr: 1.9546e-06 | scale: 1024.00 | time: 26.364 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    619/  1000| tot_loss: 2.6657 | rl_loss: 1.0144 | pt_loss: 1.6513 | pg_loss: 0.2256 | reg_loss: 0.7889 | reward: -1.1560 | rev_kl: 0.8724 | stu_lens: 75.5000 | mixed_lens: 73.5000 | lr: 1.9461e-06 | scale: 1024.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    620/  1000| tot_loss: 3.4487 | rl_loss: 1.4565 | pt_loss: 1.9922 | pg_loss: 0.6454 | reg_loss: 0.8111 | reward: -0.9584 | rev_kl: 1.5078 | stu_lens: 88.0000 | mixed_lens: 74.5000 | lr: 1.9376e-06 | scale: 1024.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    621/  1000| tot_loss: 2.2372 | rl_loss: 0.3606 | pt_loss: 1.8766 | pg_loss: -0.0071 | reg_loss: 0.3677 | reward: -0.0761 | rev_kl: 0.5408 | stu_lens: 95.5000 | mixed_lens: 128.0000 | lr: 1.9291e-06 | scale: 1024.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    622/  1000| tot_loss: 3.0867 | rl_loss: 0.8547 | pt_loss: 2.2320 | pg_loss: 0.2933 | reg_loss: 0.5614 | reward: -0.8848 | rev_kl: 1.2400 | stu_lens: 84.0000 | mixed_lens: 75.0000 | lr: 1.9206e-06 | scale: 1024.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    623/  1000| tot_loss: 2.1532 | rl_loss: 0.5651 | pt_loss: 1.5881 | pg_loss: 0.0482 | reg_loss: 0.5169 | reward: -0.3941 | rev_kl: 0.9298 | stu_lens: 117.5000 | mixed_lens: 114.0000 | lr: 1.9121e-06 | scale: 1024.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    624/  1000| tot_loss: 2.5443 | rl_loss: 0.8638 | pt_loss: 1.6805 | pg_loss: -0.0137 | reg_loss: 0.8775 | reward: -0.2943 | rev_kl: 1.1471 | stu_lens: 79.5000 | mixed_lens: 128.0000 | lr: 1.9037e-06 | scale: 1024.00 | time: 26.308 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    624/  1000| tot_loss: 2.7297 | rl_loss: 0.9822 | pt_loss: 1.7475 | pg_loss: 0.3506 | reg_loss: 0.6316 | reward: -0.6046 | rev_kl: 0.9342 | stu_lens: 92.4688 | mixed_lens: 81.7031 | lr: 1.9037e-06 | scale: 1024.00 | time: 26.308 | step time: 27.481
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    625/  1000| tot_loss: 2.5295 | rl_loss: 0.7537 | pt_loss: 1.7759 | pg_loss: -0.0012 | reg_loss: 0.7548 | reward: -0.3588 | rev_kl: 1.5498 | stu_lens: 43.0000 | mixed_lens: 128.0000 | lr: 1.8952e-06 | scale: 1024.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    626/  1000| tot_loss: 2.4601 | rl_loss: 0.6623 | pt_loss: 1.7978 | pg_loss: 0.0476 | reg_loss: 0.6147 | reward: -0.2171 | rev_kl: 1.2435 | stu_lens: 123.5000 | mixed_lens: 115.5000 | lr: 1.8867e-06 | scale: 1024.00 | time: 26.336 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    627/  1000| tot_loss: 2.5877 | rl_loss: 0.8294 | pt_loss: 1.7583 | pg_loss: 0.3386 | reg_loss: 0.4908 | reward: -1.1828 | rev_kl: 0.6441 | stu_lens: 60.5000 | mixed_lens: 73.0000 | lr: 1.8783e-06 | scale: 1024.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    628/  1000| tot_loss: 2.1200 | rl_loss: 0.3772 | pt_loss: 1.7428 | pg_loss: -0.0227 | reg_loss: 0.3999 | reward: -0.2568 | rev_kl: 0.7512 | stu_lens: 118.0000 | mixed_lens: 128.0000 | lr: 1.8698e-06 | scale: 1024.00 | time: 26.360 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    629/  1000| tot_loss: 2.6283 | rl_loss: 0.7329 | pt_loss: 1.8954 | pg_loss: 0.2922 | reg_loss: 0.4408 | reward: -0.0625 | rev_kl: 1.0837 | stu_lens: 99.5000 | mixed_lens: 74.0000 | lr: 1.8614e-06 | scale: 1024.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    630/  1000| tot_loss: 2.6661 | rl_loss: 0.8050 | pt_loss: 1.8611 | pg_loss: 0.3004 | reg_loss: 0.5046 | reward: -0.3831 | rev_kl: 1.0035 | stu_lens: 64.5000 | mixed_lens: 81.5000 | lr: 1.8530e-06 | scale: 1024.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    631/  1000| tot_loss: 2.1471 | rl_loss: 0.5018 | pt_loss: 1.6453 | pg_loss: 0.1675 | reg_loss: 0.3344 | reward: -0.4334 | rev_kl: 0.4031 | stu_lens: 90.5000 | mixed_lens: 82.5000 | lr: 1.8445e-06 | scale: 1024.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    632/  1000| tot_loss: 2.6994 | rl_loss: 0.9410 | pt_loss: 1.7584 | pg_loss: 0.2201 | reg_loss: 0.7209 | reward: -0.9271 | rev_kl: 1.3824 | stu_lens: 43.0000 | mixed_lens: 88.5000 | lr: 1.8361e-06 | scale: 1024.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    633/  1000| tot_loss: 2.5083 | rl_loss: 0.8675 | pt_loss: 1.6408 | pg_loss: 0.5149 | reg_loss: 0.3525 | reward: -1.0202 | rev_kl: 1.2067 | stu_lens: 84.0000 | mixed_lens: 47.0000 | lr: 1.8277e-06 | scale: 1024.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    634/  1000| tot_loss: 2.6384 | rl_loss: 0.8406 | pt_loss: 1.7978 | pg_loss: 0.3844 | reg_loss: 0.4562 | reward: -0.0121 | rev_kl: 0.9515 | stu_lens: 96.5000 | mixed_lens: 87.0000 | lr: 1.8193e-06 | scale: 1024.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    635/  1000| tot_loss: 2.5160 | rl_loss: 0.6927 | pt_loss: 1.8233 | pg_loss: 0.1905 | reg_loss: 0.5022 | reward: -4.8195 | rev_kl: 1.4291 | stu_lens: 34.0000 | mixed_lens: 66.0000 | lr: 1.8109e-06 | scale: 1024.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    636/  1000| tot_loss: 1.8382 | rl_loss: 0.2149 | pt_loss: 1.6233 | pg_loss: 0.1777 | reg_loss: 0.0373 | reward: -0.0308 | rev_kl: 0.6575 | stu_lens: 104.0000 | mixed_lens: 70.0000 | lr: 1.8025e-06 | scale: 1024.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    637/  1000| tot_loss: 2.3269 | rl_loss: 0.3670 | pt_loss: 1.9599 | pg_loss: 0.0152 | reg_loss: 0.3518 | reward: -0.2161 | rev_kl: 1.1200 | stu_lens: 78.5000 | mixed_lens: 128.0000 | lr: 1.7941e-06 | scale: 1024.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    638/  1000| tot_loss: 2.1084 | rl_loss: 0.3334 | pt_loss: 1.7751 | pg_loss: 0.0496 | reg_loss: 0.2838 | reward: -0.3185 | rev_kl: 0.7161 | stu_lens: 85.5000 | mixed_lens: 113.0000 | lr: 1.7858e-06 | scale: 1024.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    639/  1000| tot_loss: 2.3167 | rl_loss: 0.5845 | pt_loss: 1.7322 | pg_loss: 0.0841 | reg_loss: 0.5004 | reward: -0.2759 | rev_kl: 1.0061 | stu_lens: 128.0000 | mixed_lens: 107.5000 | lr: 1.7774e-06 | scale: 1024.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    640/  1000| tot_loss: 2.8438 | rl_loss: 0.7263 | pt_loss: 2.1175 | pg_loss: 0.1712 | reg_loss: 0.5551 | reward: -0.5042 | rev_kl: 1.0884 | stu_lens: 92.5000 | mixed_lens: 95.5000 | lr: 1.7691e-06 | scale: 1024.00 | time: 26.308 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    640/  1000| tot_loss: 2.4237 | rl_loss: 0.7120 | pt_loss: 1.7117 | pg_loss: 0.2603 | reg_loss: 0.4517 | reward: -0.6123 | rev_kl: 0.9581 | stu_lens: 89.9375 | mixed_lens: 85.0781 | lr: 1.7691e-06 | scale: 1024.00 | time: 26.308 | step time: 27.506
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    641/  1000| tot_loss: 2.0264 | rl_loss: 0.5198 | pt_loss: 1.5066 | pg_loss: 0.2711 | reg_loss: 0.2488 | reward: -0.6762 | rev_kl: 0.8485 | stu_lens: 74.5000 | mixed_lens: 74.5000 | lr: 1.7607e-06 | scale: 1024.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    642/  1000| tot_loss: 3.5364 | rl_loss: 2.1028 | pt_loss: 1.4336 | pg_loss: 0.8563 | reg_loss: 1.2464 | reward: -0.8217 | rev_kl: 1.3961 | stu_lens: 85.0000 | mixed_lens: 50.5000 | lr: 1.7524e-06 | scale: 1024.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    643/  1000| tot_loss: 2.3096 | rl_loss: 1.1552 | pt_loss: 1.1545 | pg_loss: 0.0588 | reg_loss: 1.0964 | reward: -0.1642 | rev_kl: 0.6407 | stu_lens: 110.0000 | mixed_lens: 128.0000 | lr: 1.7441e-06 | scale: 1024.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    644/  1000| tot_loss: 2.8625 | rl_loss: 1.4444 | pt_loss: 1.4180 | pg_loss: 0.3068 | reg_loss: 1.1376 | reward: -0.4244 | rev_kl: 1.2969 | stu_lens: 96.0000 | mixed_lens: 89.0000 | lr: 1.7358e-06 | scale: 1024.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    645/  1000| tot_loss: 3.9348 | rl_loss: 1.9444 | pt_loss: 1.9904 | pg_loss: 0.7039 | reg_loss: 1.2405 | reward: -0.6936 | rev_kl: 1.5454 | stu_lens: 57.5000 | mixed_lens: 54.5000 | lr: 1.7275e-06 | scale: 1024.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    646/  1000| tot_loss: 3.0346 | rl_loss: 1.1434 | pt_loss: 1.8912 | pg_loss: 0.3836 | reg_loss: 0.7598 | reward: -0.4797 | rev_kl: 0.6031 | stu_lens: 79.0000 | mixed_lens: 77.5000 | lr: 1.7192e-06 | scale: 1024.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    647/  1000| tot_loss: 4.5859 | rl_loss: 2.9217 | pt_loss: 1.6642 | pg_loss: 1.1529 | reg_loss: 1.7687 | reward: -1.5117 | rev_kl: 0.8489 | stu_lens: 89.0000 | mixed_lens: 43.0000 | lr: 1.7109e-06 | scale: 1024.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    648/  1000| tot_loss: 3.8125 | rl_loss: 1.8495 | pt_loss: 1.9630 | pg_loss: 0.5650 | reg_loss: 1.2845 | reward: -0.2640 | rev_kl: 0.4907 | stu_lens: 60.5000 | mixed_lens: 74.0000 | lr: 1.7026e-06 | scale: 1024.00 | time: 26.220 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    649/  1000| tot_loss: 3.4284 | rl_loss: 1.5013 | pt_loss: 1.9271 | pg_loss: 0.3040 | reg_loss: 1.1973 | reward: -0.7559 | rev_kl: 0.9732 | stu_lens: 86.0000 | mixed_lens: 74.0000 | lr: 1.6943e-06 | scale: 1024.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    650/  1000| tot_loss: 3.8106 | rl_loss: 2.1289 | pt_loss: 1.6817 | pg_loss: 0.5264 | reg_loss: 1.6025 | reward: -0.3189 | rev_kl: 0.8510 | stu_lens: 45.0000 | mixed_lens: 82.0000 | lr: 1.6861e-06 | scale: 1024.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    651/  1000| tot_loss: 2.6869 | rl_loss: 0.7614 | pt_loss: 1.9255 | pg_loss: 0.0299 | reg_loss: 0.7315 | reward: -0.1134 | rev_kl: 1.1073 | stu_lens: 65.5000 | mixed_lens: 128.0000 | lr: 1.6778e-06 | scale: 1024.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    652/  1000| tot_loss: 3.3512 | rl_loss: 1.7160 | pt_loss: 1.6353 | pg_loss: 0.0379 | reg_loss: 1.6780 | reward: -0.3634 | rev_kl: 1.4752 | stu_lens: 94.5000 | mixed_lens: 128.0000 | lr: 1.6696e-06 | scale: 1024.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    653/  1000| tot_loss: 2.7986 | rl_loss: 1.2124 | pt_loss: 1.5862 | pg_loss: 0.1510 | reg_loss: 1.0614 | reward: -0.1375 | rev_kl: 0.9139 | stu_lens: 128.0000 | mixed_lens: 113.0000 | lr: 1.6614e-06 | scale: 1024.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    654/  1000| tot_loss: 3.9220 | rl_loss: 1.9103 | pt_loss: 2.0117 | pg_loss: 0.6840 | reg_loss: 1.2263 | reward: -0.7199 | rev_kl: 1.1435 | stu_lens: 74.0000 | mixed_lens: 52.0000 | lr: 1.6532e-06 | scale: 1024.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    655/  1000| tot_loss: 2.4553 | rl_loss: 0.8198 | pt_loss: 1.6355 | pg_loss: 0.0368 | reg_loss: 0.7830 | reward: -0.2114 | rev_kl: 0.8762 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.6449e-06 | scale: 1024.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    656/  1000| tot_loss: 3.8605 | rl_loss: 2.0576 | pt_loss: 1.8030 | pg_loss: 0.8972 | reg_loss: 1.1604 | reward: -0.4382 | rev_kl: 0.8769 | stu_lens: 47.5000 | mixed_lens: 55.0000 | lr: 1.6368e-06 | scale: 1024.00 | time: 26.257 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    656/  1000| tot_loss: 3.3152 | rl_loss: 1.5962 | pt_loss: 1.7190 | pg_loss: 0.4734 | reg_loss: 1.1228 | reward: -0.5853 | rev_kl: 1.0570 | stu_lens: 79.4062 | mixed_lens: 79.7656 | lr: 1.6368e-06 | scale: 1024.00 | time: 26.257 | step time: 27.482
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    657/  1000| tot_loss: 3.6313 | rl_loss: 1.8653 | pt_loss: 1.7660 | pg_loss: 0.4282 | reg_loss: 1.4371 | reward: -0.4663 | rev_kl: 0.6425 | stu_lens: 128.0000 | mixed_lens: 82.0000 | lr: 1.6286e-06 | scale: 1024.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    658/  1000| tot_loss: 2.4490 | rl_loss: 0.9464 | pt_loss: 1.5026 | pg_loss: 0.3073 | reg_loss: 0.6391 | reward: -0.2997 | rev_kl: 1.2437 | stu_lens: 69.0000 | mixed_lens: 42.5000 | lr: 1.6204e-06 | scale: 1024.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    659/  1000| tot_loss: 2.0497 | rl_loss: 0.6162 | pt_loss: 1.4335 | pg_loss: -0.0022 | reg_loss: 0.6185 | reward: -0.2190 | rev_kl: 0.8067 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.6122e-06 | scale: 1024.00 | time: 26.206 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    660/  1000| tot_loss: 2.8749 | rl_loss: 1.2431 | pt_loss: 1.6318 | pg_loss: 0.3247 | reg_loss: 0.9184 | reward: -0.2134 | rev_kl: 0.5434 | stu_lens: 74.5000 | mixed_lens: 74.0000 | lr: 1.6041e-06 | scale: 1024.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    661/  1000| tot_loss: 1.9176 | rl_loss: 0.7402 | pt_loss: 1.1774 | pg_loss: 0.0331 | reg_loss: 0.7071 | reward: -0.1308 | rev_kl: 0.7386 | stu_lens: 110.0000 | mixed_lens: 128.0000 | lr: 1.5959e-06 | scale: 1024.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    662/  1000| tot_loss: 2.9734 | rl_loss: 1.0334 | pt_loss: 1.9400 | pg_loss: 0.2799 | reg_loss: 0.7535 | reward: -0.3114 | rev_kl: 0.5874 | stu_lens: 75.0000 | mixed_lens: 69.5000 | lr: 1.5878e-06 | scale: 1024.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    663/  1000| tot_loss: 3.3718 | rl_loss: 1.6157 | pt_loss: 1.7561 | pg_loss: 0.6218 | reg_loss: 0.9939 | reward: -0.4661 | rev_kl: 1.0687 | stu_lens: 96.5000 | mixed_lens: 65.0000 | lr: 1.5797e-06 | scale: 1024.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    664/  1000| tot_loss: 2.9721 | rl_loss: 1.2825 | pt_loss: 1.6896 | pg_loss: 0.3431 | reg_loss: 0.9394 | reward: -0.5641 | rev_kl: 1.6287 | stu_lens: 46.0000 | mixed_lens: 84.0000 | lr: 1.5716e-06 | scale: 1024.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    665/  1000| tot_loss: 3.3942 | rl_loss: 1.3096 | pt_loss: 2.0846 | pg_loss: 0.4846 | reg_loss: 0.8250 | reward: -0.5941 | rev_kl: 1.0161 | stu_lens: 79.0000 | mixed_lens: 77.5000 | lr: 1.5635e-06 | scale: 1024.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    666/  1000| tot_loss: 2.7404 | rl_loss: 1.4983 | pt_loss: 1.2420 | pg_loss: 0.7906 | reg_loss: 0.7078 | reward: -2.1699 | rev_kl: 0.9924 | stu_lens: 70.5000 | mixed_lens: 29.5000 | lr: 1.5554e-06 | scale: 1024.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    667/  1000| tot_loss: 2.6382 | rl_loss: 0.6048 | pt_loss: 2.0334 | pg_loss: -0.0224 | reg_loss: 0.6272 | reward: -0.1052 | rev_kl: 0.7757 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.5473e-06 | scale: 1024.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    668/  1000| tot_loss: 2.7630 | rl_loss: 0.9794 | pt_loss: 1.7835 | pg_loss: 0.2937 | reg_loss: 0.6857 | reward: -0.1965 | rev_kl: 0.7432 | stu_lens: 30.5000 | mixed_lens: 85.0000 | lr: 1.5393e-06 | scale: 1024.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    669/  1000| tot_loss: 4.5085 | rl_loss: 2.3603 | pt_loss: 2.1482 | pg_loss: 1.4502 | reg_loss: 0.9101 | reward: -1.7111 | rev_kl: 0.5587 | stu_lens: 13.5000 | mixed_lens: 25.0000 | lr: 1.5312e-06 | scale: 1024.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    670/  1000| tot_loss: 3.0053 | rl_loss: 1.4339 | pt_loss: 1.5714 | pg_loss: 0.5735 | reg_loss: 0.8604 | reward: -0.7820 | rev_kl: 0.9960 | stu_lens: 128.0000 | mixed_lens: 69.0000 | lr: 1.5232e-06 | scale: 1024.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    671/  1000| tot_loss: 2.4429 | rl_loss: 0.6674 | pt_loss: 1.7755 | pg_loss: 0.2085 | reg_loss: 0.4589 | reward: -0.4570 | rev_kl: 0.8450 | stu_lens: 39.0000 | mixed_lens: 87.5000 | lr: 1.5151e-06 | scale: 1024.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    672/  1000| tot_loss: 2.4596 | rl_loss: 0.8300 | pt_loss: 1.6296 | pg_loss: 0.0121 | reg_loss: 0.8178 | reward: -0.2078 | rev_kl: 1.0538 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.5071e-06 | scale: 1024.00 | time: 26.284 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    672/  1000| tot_loss: 3.0414 | rl_loss: 1.2927 | pt_loss: 1.7486 | pg_loss: 0.4340 | reg_loss: 0.8588 | reward: -0.6018 | rev_kl: 1.0158 | stu_lens: 81.1094 | mixed_lens: 80.4844 | lr: 1.5071e-06 | scale: 1024.00 | time: 26.284 | step time: 27.481
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    673/  1000| tot_loss: 2.5904 | rl_loss: 1.1503 | pt_loss: 1.4401 | pg_loss: 0.2287 | reg_loss: 0.9215 | reward: -0.2515 | rev_kl: 0.8384 | stu_lens: 103.5000 | mixed_lens: 104.0000 | lr: 1.4991e-06 | scale: 1024.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    674/  1000| tot_loss: 2.6523 | rl_loss: 1.0835 | pt_loss: 1.5688 | pg_loss: 0.2111 | reg_loss: 0.8724 | reward: -0.4506 | rev_kl: 0.9373 | stu_lens: 95.5000 | mixed_lens: 105.0000 | lr: 1.4911e-06 | scale: 1024.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    675/  1000| tot_loss: 2.7541 | rl_loss: 0.9112 | pt_loss: 1.8429 | pg_loss: 0.2391 | reg_loss: 0.6721 | reward: -0.4870 | rev_kl: 1.1924 | stu_lens: 96.0000 | mixed_lens: 89.0000 | lr: 1.4832e-06 | scale: 1024.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    676/  1000| tot_loss: 2.0923 | rl_loss: 0.5463 | pt_loss: 1.5461 | pg_loss: -0.0021 | reg_loss: 0.5484 | reward: -0.2451 | rev_kl: 1.1163 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4752e-06 | scale: 1024.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    677/  1000| tot_loss: 3.7047 | rl_loss: 1.8078 | pt_loss: 1.8969 | pg_loss: 0.6354 | reg_loss: 1.1724 | reward: 0.0753 | rev_kl: 1.4152 | stu_lens: 44.5000 | mixed_lens: 64.0000 | lr: 1.4672e-06 | scale: 1024.00 | time: 26.202 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    678/  1000| tot_loss: 2.1961 | rl_loss: 1.0218 | pt_loss: 1.1743 | pg_loss: 0.2666 | reg_loss: 0.7552 | reward: -0.2729 | rev_kl: 1.2139 | stu_lens: 78.5000 | mixed_lens: 89.0000 | lr: 1.4593e-06 | scale: 1024.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    679/  1000| tot_loss: 1.6576 | rl_loss: 0.4241 | pt_loss: 1.2335 | pg_loss: 0.1308 | reg_loss: 0.2933 | reward: -0.1178 | rev_kl: 0.6364 | stu_lens: 72.0000 | mixed_lens: 91.0000 | lr: 1.4514e-06 | scale: 1024.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    680/  1000| tot_loss: 2.3641 | rl_loss: 0.5725 | pt_loss: 1.7916 | pg_loss: 0.0582 | reg_loss: 0.5143 | reward: -0.2373 | rev_kl: 0.9929 | stu_lens: 88.0000 | mixed_lens: 118.5000 | lr: 1.4435e-06 | scale: 1024.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    681/  1000| tot_loss: 3.8103 | rl_loss: 2.1457 | pt_loss: 1.6646 | pg_loss: 1.7921 | reg_loss: 0.3536 | reward: -1.0342 | rev_kl: 1.2276 | stu_lens: 8.0000 | mixed_lens: 17.0000 | lr: 1.4356e-06 | scale: 1024.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    682/  1000| tot_loss: 2.0291 | rl_loss: 0.7222 | pt_loss: 1.3069 | pg_loss: 0.1263 | reg_loss: 0.5959 | reward: -0.1752 | rev_kl: 0.9016 | stu_lens: 103.5000 | mixed_lens: 104.0000 | lr: 1.4277e-06 | scale: 1024.00 | time: 26.322 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    683/  1000| tot_loss: 2.0138 | rl_loss: 0.3769 | pt_loss: 1.6369 | pg_loss: -0.0109 | reg_loss: 0.3878 | reward: -0.2294 | rev_kl: 1.0171 | stu_lens: 83.0000 | mixed_lens: 128.0000 | lr: 1.4198e-06 | scale: 1024.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    684/  1000| tot_loss: 2.8677 | rl_loss: 1.0105 | pt_loss: 1.8573 | pg_loss: 0.3530 | reg_loss: 0.6575 | reward: -1.1533 | rev_kl: 1.3183 | stu_lens: 80.5000 | mixed_lens: 66.5000 | lr: 1.4119e-06 | scale: 1024.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    685/  1000| tot_loss: 2.6761 | rl_loss: 1.3085 | pt_loss: 1.3675 | pg_loss: 0.3023 | reg_loss: 1.0062 | reward: -1.6411 | rev_kl: 0.9883 | stu_lens: 37.5000 | mixed_lens: 74.0000 | lr: 1.4041e-06 | scale: 1024.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    686/  1000| tot_loss: 3.5751 | rl_loss: 1.6210 | pt_loss: 1.9541 | pg_loss: 0.7387 | reg_loss: 0.8823 | reward: -0.7841 | rev_kl: 1.3697 | stu_lens: 61.5000 | mixed_lens: 66.0000 | lr: 1.3962e-06 | scale: 1024.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    687/  1000| tot_loss: 2.0866 | rl_loss: 0.5130 | pt_loss: 1.5736 | pg_loss: 0.1370 | reg_loss: 0.3761 | reward: -0.1883 | rev_kl: 0.9020 | stu_lens: 76.0000 | mixed_lens: 101.0000 | lr: 1.3884e-06 | scale: 1024.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    688/  1000| tot_loss: 2.7850 | rl_loss: 1.2549 | pt_loss: 1.5301 | pg_loss: 0.5897 | reg_loss: 0.6652 | reward: -0.5747 | rev_kl: 1.5665 | stu_lens: 67.5000 | mixed_lens: 54.0000 | lr: 1.3806e-06 | scale: 1024.00 | time: 26.262 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    688/  1000| tot_loss: 2.6914 | rl_loss: 1.0329 | pt_loss: 1.6585 | pg_loss: 0.4005 | reg_loss: 0.6325 | reward: -0.5626 | rev_kl: 1.0183 | stu_lens: 83.9219 | mixed_lens: 82.2656 | lr: 1.3806e-06 | scale: 1024.00 | time: 26.262 | step time: 27.475
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    689/  1000| tot_loss: 2.5597 | rl_loss: 0.8392 | pt_loss: 1.7205 | pg_loss: 0.3415 | reg_loss: 0.4977 | reward: -1.9261 | rev_kl: 1.1519 | stu_lens: 66.0000 | mixed_lens: 66.0000 | lr: 1.3728e-06 | scale: 1024.00 | time: 26.203 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    690/  1000| tot_loss: 2.1617 | rl_loss: 0.8918 | pt_loss: 1.2699 | pg_loss: 0.4140 | reg_loss: 0.4777 | reward: -1.0986 | rev_kl: 1.3614 | stu_lens: 80.5000 | mixed_lens: 75.5000 | lr: 1.3650e-06 | scale: 1024.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    691/  1000| tot_loss: 2.3118 | rl_loss: 0.4975 | pt_loss: 1.8142 | pg_loss: 0.2659 | reg_loss: 0.2316 | reward: -0.1847 | rev_kl: 1.1235 | stu_lens: 45.5000 | mixed_lens: 84.5000 | lr: 1.3573e-06 | scale: 1024.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    692/  1000| tot_loss: 3.0021 | rl_loss: 1.1594 | pt_loss: 1.8426 | pg_loss: 0.6836 | reg_loss: 0.4758 | reward: -0.5202 | rev_kl: 1.1854 | stu_lens: 49.0000 | mixed_lens: 61.5000 | lr: 1.3495e-06 | scale: 1024.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    693/  1000| tot_loss: 2.5767 | rl_loss: 0.7363 | pt_loss: 1.8404 | pg_loss: 0.3081 | reg_loss: 0.4281 | reward: -0.1531 | rev_kl: 1.1514 | stu_lens: 128.0000 | mixed_lens: 88.5000 | lr: 1.3418e-06 | scale: 1024.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    694/  1000| tot_loss: 2.2999 | rl_loss: 0.8920 | pt_loss: 1.4079 | pg_loss: 0.3849 | reg_loss: 0.5071 | reward: -0.9146 | rev_kl: 1.3518 | stu_lens: 68.5000 | mixed_lens: 80.5000 | lr: 1.3340e-06 | scale: 1024.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    695/  1000| tot_loss: 2.5555 | rl_loss: 1.0896 | pt_loss: 1.4658 | pg_loss: 0.5355 | reg_loss: 0.5542 | reward: -0.7197 | rev_kl: 0.9930 | stu_lens: 81.5000 | mixed_lens: 69.0000 | lr: 1.3263e-06 | scale: 1024.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    696/  1000| tot_loss: 2.6972 | rl_loss: 1.2096 | pt_loss: 1.4876 | pg_loss: 0.7127 | reg_loss: 0.4969 | reward: -0.8576 | rev_kl: 1.1030 | stu_lens: 89.0000 | mixed_lens: 59.5000 | lr: 1.3186e-06 | scale: 1024.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    697/  1000| tot_loss: 2.8900 | rl_loss: 1.1356 | pt_loss: 1.7545 | pg_loss: 0.7748 | reg_loss: 0.3608 | reward: -0.3044 | rev_kl: 0.3640 | stu_lens: 22.5000 | mixed_lens: 35.5000 | lr: 1.3109e-06 | scale: 1024.00 | time: 26.196 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    698/  1000| tot_loss: 2.4663 | rl_loss: 0.5735 | pt_loss: 1.8928 | pg_loss: -0.0015 | reg_loss: 0.5750 | reward: -0.2290 | rev_kl: 0.6178 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.3033e-06 | scale: 1024.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    699/  1000| tot_loss: 2.5119 | rl_loss: 0.7310 | pt_loss: 1.7809 | pg_loss: 0.2641 | reg_loss: 0.4669 | reward: -0.3424 | rev_kl: 0.9884 | stu_lens: 94.5000 | mixed_lens: 82.5000 | lr: 1.2956e-06 | scale: 1024.00 | time: 26.216 | step time: 0.000
                                 Evaluation #7                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ That's a valid point. There are a    │
│                                       │ lot of other ways to create          │
│                                       │ something new. You could invent a    │
│                                       │ new type of car, or a new type of    │
│                                       │ computer, or a new type of medicine. │
│                                       │ You could also just try to improve   │
│                                       │ on something that already exists.    │
│                                       │ For example, instead of inventing a  │
│                                       │ new type of computer, you could try  │
│                                       │ to invent a faster computer.         │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Okay, I'll try to think of something │
│                                       │ new. Let me see... Lemme ask you a   │
│                                       │ question. What is the purpose of     │
│                                       │ money?                               │
│                                       │                                      │
│                                       │ Oh, I see. Money is simply a tool to │
│                                       │ buy things. That's it, right?        │
│                                       │                                      │
│                                       │ Well, I think I can do something     │
│                                       │ better than that. What if I found a  │
│                                       │ way to buy things without using      │
│                                       │ money?                               │
│                                       │                                      │
│                                       │ Oh, that's interesting. How would    │
│                                       │ you do that?                         │
│                                       │                                      │
│                                       │ I'd first have to find a way to      │
│                                       │ store value. Then I'd need a way to  │
│                                       │ transfer that value to someone else. │
│                                       │ Finally                              │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ That's great! Create something new   │
│                                       │ and share it with the world.         │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 15.411 | exact_match: 0.000 | rev_kl: 1.003 | lens: 84.664 | pt_loss: 1.094 | lm_loss: 1.187 | kd_loss: 1.002 
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    700/  1000| tot_loss: 2.2029 | rl_loss: 0.6954 | pt_loss: 1.5076 | pg_loss: 0.3040 | reg_loss: 0.3914 | reward: -0.4315 | rev_kl: 1.0980 | stu_lens: 70.5000 | mixed_lens: 79.0000 | lr: 1.2880e-06 | scale: 1024.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    701/  1000| tot_loss: 3.9519 | rl_loss: 2.1925 | pt_loss: 1.7594 | pg_loss: 1.8034 | reg_loss: 0.3890 | reward: -1.3868 | rev_kl: 1.4167 | stu_lens: 23.5000 | mixed_lens: 12.0000 | lr: 1.2804e-06 | scale: 1024.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    702/  1000| tot_loss: 3.1719 | rl_loss: 1.3725 | pt_loss: 1.7994 | pg_loss: 0.9920 | reg_loss: 0.3805 | reward: -1.1877 | rev_kl: 0.6836 | stu_lens: 40.0000 | mixed_lens: 29.0000 | lr: 1.2727e-06 | scale: 1024.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    703/  1000| tot_loss: 2.7136 | rl_loss: 0.6434 | pt_loss: 2.0702 | pg_loss: 0.3657 | reg_loss: 0.2777 | reward: -0.5411 | rev_kl: 0.9798 | stu_lens: 107.0000 | mixed_lens: 75.5000 | lr: 1.2651e-06 | scale: 1024.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    704/  1000| tot_loss: 2.5747 | rl_loss: 1.1495 | pt_loss: 1.4252 | pg_loss: 0.8708 | reg_loss: 0.2787 | reward: -0.2137 | rev_kl: 0.6549 | stu_lens: 50.0000 | mixed_lens: 50.0000 | lr: 1.2576e-06 | scale: 1024.00 | time: 26.236 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    704/  1000| tot_loss: 2.5998 | rl_loss: 0.9125 | pt_loss: 1.6874 | pg_loss: 0.4358 | reg_loss: 0.4766 | reward: -0.6462 | rev_kl: 1.0183 | stu_lens: 77.4062 | mixed_lens: 76.7344 | lr: 1.2576e-06 | scale: 1024.00 | time: 26.236 | step time: 27.481
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    705/  1000| tot_loss: 2.2625 | rl_loss: 0.6129 | pt_loss: 1.6496 | pg_loss: 0.2283 | reg_loss: 0.3845 | reward: -0.7659 | rev_kl: 0.9757 | stu_lens: 128.0000 | mixed_lens: 91.5000 | lr: 1.2500e-06 | scale: 1024.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    706/  1000| tot_loss: 4.3875 | rl_loss: 2.2583 | pt_loss: 2.1291 | pg_loss: 0.5378 | reg_loss: 1.7206 | reward: -0.6450 | rev_kl: 0.9592 | stu_lens: 90.0000 | mixed_lens: 67.5000 | lr: 1.2425e-06 | scale: 1024.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    707/  1000| tot_loss: 2.9820 | rl_loss: 1.6835 | pt_loss: 1.2985 | pg_loss: 0.1329 | reg_loss: 1.5506 | reward: -0.4042 | rev_kl: 1.1793 | stu_lens: 80.5000 | mixed_lens: 119.5000 | lr: 1.2349e-06 | scale: 1024.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    708/  1000| tot_loss: 3.2330 | rl_loss: 1.5175 | pt_loss: 1.7155 | pg_loss: 0.4178 | reg_loss: 1.0996 | reward: -0.8309 | rev_kl: 0.8670 | stu_lens: 128.0000 | mixed_lens: 64.0000 | lr: 1.2274e-06 | scale: 1024.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    709/  1000| tot_loss: 2.9960 | rl_loss: 1.2248 | pt_loss: 1.7711 | pg_loss: 0.1563 | reg_loss: 1.0686 | reward: -0.3704 | rev_kl: 0.7787 | stu_lens: 87.5000 | mixed_lens: 114.5000 | lr: 1.2199e-06 | scale: 1024.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    710/  1000| tot_loss: 3.2955 | rl_loss: 1.2870 | pt_loss: 2.0085 | pg_loss: 0.3037 | reg_loss: 0.9833 | reward: -0.3805 | rev_kl: 0.7513 | stu_lens: 88.0000 | mixed_lens: 74.0000 | lr: 1.2124e-06 | scale: 1024.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    711/  1000| tot_loss: 3.0663 | rl_loss: 1.4541 | pt_loss: 1.6121 | pg_loss: 0.3875 | reg_loss: 1.0667 | reward: -0.3425 | rev_kl: 0.8671 | stu_lens: 64.5000 | mixed_lens: 89.0000 | lr: 1.2049e-06 | scale: 1024.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    712/  1000| tot_loss: 3.3858 | rl_loss: 1.7138 | pt_loss: 1.6721 | pg_loss: 0.6638 | reg_loss: 1.0499 | reward: -0.2185 | rev_kl: 0.5006 | stu_lens: 60.5000 | mixed_lens: 59.0000 | lr: 1.1975e-06 | scale: 1024.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    713/  1000| tot_loss: 3.1749 | rl_loss: 1.2794 | pt_loss: 1.8955 | pg_loss: 0.0683 | reg_loss: 1.2111 | reward: -0.1997 | rev_kl: 1.2584 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.1900e-06 | scale: 1024.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    714/  1000| tot_loss: 2.6363 | rl_loss: 1.0324 | pt_loss: 1.6039 | pg_loss: 0.0868 | reg_loss: 0.9456 | reward: -0.2138 | rev_kl: 0.6553 | stu_lens: 84.0000 | mixed_lens: 125.5000 | lr: 1.1826e-06 | scale: 1024.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    715/  1000| tot_loss: 2.8767 | rl_loss: 1.5464 | pt_loss: 1.3303 | pg_loss: 0.1896 | reg_loss: 1.3568 | reward: -0.3606 | rev_kl: 1.4085 | stu_lens: 81.5000 | mixed_lens: 113.5000 | lr: 1.1752e-06 | scale: 1024.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    716/  1000| tot_loss: 3.4344 | rl_loss: 1.4020 | pt_loss: 2.0323 | pg_loss: 0.8462 | reg_loss: 0.5558 | reward: -0.3123 | rev_kl: 0.1966 | stu_lens: 32.5000 | mixed_lens: 35.0000 | lr: 1.1678e-06 | scale: 1024.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    717/  1000| tot_loss: 3.2692 | rl_loss: 1.7355 | pt_loss: 1.5337 | pg_loss: 0.2340 | reg_loss: 1.5015 | reward: -0.4351 | rev_kl: 0.9441 | stu_lens: 53.0000 | mixed_lens: 99.5000 | lr: 1.1604e-06 | scale: 1024.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    718/  1000| tot_loss: 4.2961 | rl_loss: 2.8680 | pt_loss: 1.4280 | pg_loss: 1.8122 | reg_loss: 1.0559 | reward: -0.8547 | rev_kl: 1.1438 | stu_lens: 34.0000 | mixed_lens: 19.5000 | lr: 1.1531e-06 | scale: 1024.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    719/  1000| tot_loss: 3.9375 | rl_loss: 2.0360 | pt_loss: 1.9016 | pg_loss: 0.8888 | reg_loss: 1.1471 | reward: -1.1502 | rev_kl: 1.0083 | stu_lens: 39.0000 | mixed_lens: 37.0000 | lr: 1.1457e-06 | scale: 1024.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    720/  1000| tot_loss: 2.9529 | rl_loss: 1.3146 | pt_loss: 1.6383 | pg_loss: 0.0903 | reg_loss: 1.2243 | reward: -0.4542 | rev_kl: 0.8011 | stu_lens: 105.0000 | mixed_lens: 122.5000 | lr: 1.1384e-06 | scale: 1024.00 | time: 26.261 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    720/  1000| tot_loss: 3.2536 | rl_loss: 1.4890 | pt_loss: 1.7646 | pg_loss: 0.3808 | reg_loss: 1.1081 | reward: -0.4024 | rev_kl: 0.9253 | stu_lens: 82.5469 | mixed_lens: 87.3906 | lr: 1.1384e-06 | scale: 1024.00 | time: 26.261 | step time: 27.485
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    721/  1000| tot_loss: 2.9351 | rl_loss: 1.0064 | pt_loss: 1.9286 | pg_loss: 0.4065 | reg_loss: 0.6000 | reward: -0.2970 | rev_kl: 0.4994 | stu_lens: 128.0000 | mixed_lens: 83.0000 | lr: 1.1311e-06 | scale: 1024.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    722/  1000| tot_loss: 2.7488 | rl_loss: 0.8440 | pt_loss: 1.9047 | pg_loss: 0.3642 | reg_loss: 0.4799 | reward: -0.0299 | rev_kl: 0.1076 | stu_lens: 75.0000 | mixed_lens: 75.0000 | lr: 1.1238e-06 | scale: 1024.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    723/  1000| tot_loss: 2.6015 | rl_loss: 0.9940 | pt_loss: 1.6075 | pg_loss: 0.2316 | reg_loss: 0.7623 | reward: -0.4187 | rev_kl: 0.7932 | stu_lens: 88.0000 | mixed_lens: 76.5000 | lr: 1.1165e-06 | scale: 1024.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    724/  1000| tot_loss: 2.5240 | rl_loss: 0.7987 | pt_loss: 1.7254 | pg_loss: 0.2636 | reg_loss: 0.5351 | reward: -0.3795 | rev_kl: 0.8206 | stu_lens: 75.0000 | mixed_lens: 71.0000 | lr: 1.1093e-06 | scale: 1024.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    725/  1000| tot_loss: 2.5572 | rl_loss: 0.9690 | pt_loss: 1.5882 | pg_loss: 0.1930 | reg_loss: 0.7760 | reward: -0.9880 | rev_kl: 1.0261 | stu_lens: 71.5000 | mixed_lens: 75.5000 | lr: 1.1020e-06 | scale: 1024.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    726/  1000| tot_loss: 2.1663 | rl_loss: 0.7909 | pt_loss: 1.3755 | pg_loss: 0.0448 | reg_loss: 0.7461 | reward: -0.3308 | rev_kl: 0.7378 | stu_lens: 105.0000 | mixed_lens: 113.0000 | lr: 1.0948e-06 | scale: 1024.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    727/  1000| tot_loss: 2.7563 | rl_loss: 1.0998 | pt_loss: 1.6565 | pg_loss: 0.5754 | reg_loss: 0.5244 | reward: -0.4713 | rev_kl: 0.9158 | stu_lens: 26.0000 | mixed_lens: 65.5000 | lr: 1.0876e-06 | scale: 1024.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    728/  1000| tot_loss: 2.5275 | rl_loss: 0.8945 | pt_loss: 1.6330 | pg_loss: 0.0987 | reg_loss: 0.7959 | reward: -0.3280 | rev_kl: 0.9682 | stu_lens: 37.0000 | mixed_lens: 35.5000 | lr: 1.0804e-06 | scale: 1024.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    729/  1000| tot_loss: 3.2071 | rl_loss: 1.5115 | pt_loss: 1.6956 | pg_loss: 0.5140 | reg_loss: 0.9975 | reward: -0.6303 | rev_kl: 0.7443 | stu_lens: 106.5000 | mixed_lens: 79.5000 | lr: 1.0732e-06 | scale: 1024.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    730/  1000| tot_loss: 2.8461 | rl_loss: 1.2079 | pt_loss: 1.6382 | pg_loss: 0.4127 | reg_loss: 0.7952 | reward: -0.1249 | rev_kl: 0.6707 | stu_lens: 77.0000 | mixed_lens: 78.0000 | lr: 1.0661e-06 | scale: 1024.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    731/  1000| tot_loss: 3.7421 | rl_loss: 1.8057 | pt_loss: 1.9364 | pg_loss: 0.5197 | reg_loss: 1.2860 | reward: -0.7133 | rev_kl: 0.9323 | stu_lens: 109.0000 | mixed_lens: 79.5000 | lr: 1.0589e-06 | scale: 1024.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    732/  1000| tot_loss: 2.8577 | rl_loss: 1.2380 | pt_loss: 1.6196 | pg_loss: 0.0061 | reg_loss: 1.2319 | reward: -0.2934 | rev_kl: 1.3803 | stu_lens: 92.5000 | mixed_lens: 128.0000 | lr: 1.0518e-06 | scale: 1024.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    733/  1000| tot_loss: 2.9787 | rl_loss: 1.0333 | pt_loss: 1.9455 | pg_loss: 0.0500 | reg_loss: 0.9833 | reward: -0.3329 | rev_kl: 0.9333 | stu_lens: 63.5000 | mixed_lens: 120.0000 | lr: 1.0447e-06 | scale: 1024.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    734/  1000| tot_loss: 2.6243 | rl_loss: 0.8265 | pt_loss: 1.7977 | pg_loss: 0.0982 | reg_loss: 0.7283 | reward: -0.3097 | rev_kl: 0.7510 | stu_lens: 87.5000 | mixed_lens: 114.5000 | lr: 1.0376e-06 | scale: 1024.00 | time: 26.199 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    735/  1000| tot_loss: 3.0575 | rl_loss: 1.0492 | pt_loss: 2.0082 | pg_loss: 0.2194 | reg_loss: 0.8299 | reward: -0.3903 | rev_kl: 1.1635 | stu_lens: 95.5000 | mixed_lens: 84.5000 | lr: 1.0305e-06 | scale: 1024.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    736/  1000| tot_loss: 3.2934 | rl_loss: 1.3328 | pt_loss: 1.9605 | pg_loss: 0.0776 | reg_loss: 1.2553 | reward: -0.2480 | rev_kl: 1.1648 | stu_lens: 117.0000 | mixed_lens: 114.5000 | lr: 1.0235e-06 | scale: 1024.00 | time: 26.202 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    736/  1000| tot_loss: 2.8633 | rl_loss: 1.1687 | pt_loss: 1.6946 | pg_loss: 0.2884 | reg_loss: 0.8803 | reward: -0.3856 | rev_kl: 0.8959 | stu_lens: 82.0625 | mixed_lens: 87.5156 | lr: 1.0235e-06 | scale: 1024.00 | time: 26.202 | step time: 27.484
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    737/  1000| tot_loss: 3.1325 | rl_loss: 1.4894 | pt_loss: 1.6431 | pg_loss: 0.3527 | reg_loss: 1.1367 | reward: -0.4443 | rev_kl: 0.9819 | stu_lens: 82.5000 | mixed_lens: 92.0000 | lr: 1.0165e-06 | scale: 1024.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    738/  1000| tot_loss: 3.5892 | rl_loss: 1.4292 | pt_loss: 2.1600 | pg_loss: 0.6696 | reg_loss: 0.7596 | reward: -0.5170 | rev_kl: 0.4426 | stu_lens: 42.0000 | mixed_lens: 56.5000 | lr: 1.0094e-06 | scale: 1024.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    739/  1000| tot_loss: 2.1978 | rl_loss: 0.8610 | pt_loss: 1.3368 | pg_loss: 0.2405 | reg_loss: 0.6205 | reward: -0.2304 | rev_kl: 0.6980 | stu_lens: 43.5000 | mixed_lens: 78.0000 | lr: 1.0024e-06 | scale: 1024.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    740/  1000| tot_loss: 2.6967 | rl_loss: 1.0291 | pt_loss: 1.6676 | pg_loss: 0.2494 | reg_loss: 0.7797 | reward: -0.3889 | rev_kl: 0.9811 | stu_lens: 30.0000 | mixed_lens: 38.5000 | lr: 9.9546e-07 | scale: 1024.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    741/  1000| tot_loss: 2.8012 | rl_loss: 0.9920 | pt_loss: 1.8091 | pg_loss: 0.0523 | reg_loss: 0.9397 | reward: -0.3805 | rev_kl: 1.1888 | stu_lens: 128.0000 | mixed_lens: 120.0000 | lr: 9.8850e-07 | scale: 1024.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    742/  1000| tot_loss: 5.1051 | rl_loss: 0.6596 | pt_loss: 4.4455 | pg_loss: 0.1321 | reg_loss: 0.5275 | reward: -0.2398 | rev_kl: 0.7200 | stu_lens: 90.5000 | mixed_lens: 99.5000 | lr: 9.8156e-07 | scale: 1024.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    743/  1000| tot_loss: 2.2133 | rl_loss: 0.7152 | pt_loss: 1.4981 | pg_loss: 0.0992 | reg_loss: 0.6159 | reward: -0.2251 | rev_kl: 1.0709 | stu_lens: 97.0000 | mixed_lens: 120.0000 | lr: 9.7464e-07 | scale: 1024.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    744/  1000| tot_loss: 3.1725 | rl_loss: 1.0067 | pt_loss: 2.1658 | pg_loss: 0.4296 | reg_loss: 0.5771 | reward: -0.3532 | rev_kl: 0.9072 | stu_lens: 70.0000 | mixed_lens: 72.5000 | lr: 9.6773e-07 | scale: 1024.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    745/  1000| tot_loss: 3.2884 | rl_loss: 0.9474 | pt_loss: 2.3411 | pg_loss: 0.0621 | reg_loss: 0.8853 | reward: -0.3604 | rev_kl: 0.9408 | stu_lens: 87.5000 | mixed_lens: 114.5000 | lr: 9.6085e-07 | scale: 1024.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    746/  1000| tot_loss: 2.9329 | rl_loss: 1.1913 | pt_loss: 1.7416 | pg_loss: 0.4436 | reg_loss: 0.7477 | reward: -0.4061 | rev_kl: 0.9472 | stu_lens: 77.0000 | mixed_lens: 70.0000 | lr: 9.5398e-07 | scale: 1024.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    747/  1000| tot_loss: 3.1912 | rl_loss: 1.7776 | pt_loss: 1.4137 | pg_loss: 1.2953 | reg_loss: 0.4823 | reward: -0.8254 | rev_kl: 1.3623 | stu_lens: 24.0000 | mixed_lens: 14.5000 | lr: 9.4713e-07 | scale: 1024.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    748/  1000| tot_loss: 2.3961 | rl_loss: 0.9242 | pt_loss: 1.4720 | pg_loss: 0.1530 | reg_loss: 0.7711 | reward: -0.5456 | rev_kl: 1.1077 | stu_lens: 43.5000 | mixed_lens: 75.5000 | lr: 9.4030e-07 | scale: 1024.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    749/  1000| tot_loss: 2.2012 | rl_loss: 0.7234 | pt_loss: 1.4778 | pg_loss: 0.1773 | reg_loss: 0.5462 | reward: -0.5719 | rev_kl: 0.8374 | stu_lens: 106.5000 | mixed_lens: 79.5000 | lr: 9.3349e-07 | scale: 1024.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    750/  1000| tot_loss: 2.7790 | rl_loss: 0.9151 | pt_loss: 1.8639 | pg_loss: 0.2439 | reg_loss: 0.6712 | reward: -0.0703 | rev_kl: 0.7127 | stu_lens: 75.0000 | mixed_lens: 75.0000 | lr: 9.2670e-07 | scale: 1024.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    751/  1000| tot_loss: 2.0000 | rl_loss: 0.8672 | pt_loss: 1.1327 | pg_loss: 0.2779 | reg_loss: 0.5894 | reward: -0.9270 | rev_kl: 0.6971 | stu_lens: 34.0000 | mixed_lens: 75.5000 | lr: 9.1993e-07 | scale: 1024.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    752/  1000| tot_loss: 2.9486 | rl_loss: 1.2962 | pt_loss: 1.6524 | pg_loss: 0.3305 | reg_loss: 0.9657 | reward: -0.5364 | rev_kl: 1.0576 | stu_lens: 128.0000 | mixed_lens: 78.5000 | lr: 9.1317e-07 | scale: 1024.00 | time: 26.253 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    752/  1000| tot_loss: 2.7772 | rl_loss: 1.0238 | pt_loss: 1.7534 | pg_loss: 0.3062 | reg_loss: 0.7176 | reward: -0.4088 | rev_kl: 0.9272 | stu_lens: 85.2656 | mixed_lens: 87.2812 | lr: 9.1317e-07 | scale: 1024.00 | time: 26.253 | step time: 27.498
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    753/  1000| tot_loss: 2.7582 | rl_loss: 0.8536 | pt_loss: 1.9046 | pg_loss: 0.0296 | reg_loss: 0.8239 | reward: -0.2366 | rev_kl: 1.1815 | stu_lens: 76.5000 | mixed_lens: 126.0000 | lr: 9.0644e-07 | scale: 1024.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    754/  1000| tot_loss: 2.4931 | rl_loss: 0.6496 | pt_loss: 1.8435 | pg_loss: -0.0115 | reg_loss: 0.6612 | reward: -0.1696 | rev_kl: 1.0455 | stu_lens: 93.5000 | mixed_lens: 128.0000 | lr: 8.9973e-07 | scale: 1024.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    755/  1000| tot_loss: 2.2236 | rl_loss: 0.6889 | pt_loss: 1.5347 | pg_loss: -0.0094 | reg_loss: 0.6983 | reward: -0.3373 | rev_kl: 0.8969 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 8.9303e-07 | scale: 1024.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    756/  1000| tot_loss: 2.5065 | rl_loss: 0.7733 | pt_loss: 1.7332 | pg_loss: 0.2464 | reg_loss: 0.5269 | reward: -0.3478 | rev_kl: 0.7983 | stu_lens: 88.5000 | mixed_lens: 92.5000 | lr: 8.8636e-07 | scale: 1024.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    757/  1000| tot_loss: 2.9453 | rl_loss: 0.9181 | pt_loss: 2.0271 | pg_loss: 0.2853 | reg_loss: 0.6328 | reward: -0.7545 | rev_kl: 0.9393 | stu_lens: 109.0000 | mixed_lens: 69.5000 | lr: 8.7970e-07 | scale: 1024.00 | time: 26.322 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    758/  1000| tot_loss: 2.8688 | rl_loss: 0.7816 | pt_loss: 2.0872 | pg_loss: 0.0043 | reg_loss: 0.7773 | reward: -0.3742 | rev_kl: 1.4967 | stu_lens: 128.0000 | mixed_lens: 127.0000 | lr: 8.7306e-07 | scale: 1024.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    759/  1000| tot_loss: 2.1230 | rl_loss: 0.6606 | pt_loss: 1.4624 | pg_loss: -0.0048 | reg_loss: 0.6655 | reward: -0.2156 | rev_kl: 1.4119 | stu_lens: 95.5000 | mixed_lens: 128.0000 | lr: 8.6645e-07 | scale: 1024.00 | time: 26.315 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    760/  1000| tot_loss: 2.3247 | rl_loss: 0.6441 | pt_loss: 1.6807 | pg_loss: 0.1667 | reg_loss: 0.4774 | reward: -0.3230 | rev_kl: 0.9458 | stu_lens: 57.5000 | mixed_lens: 86.0000 | lr: 8.5985e-07 | scale: 1024.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    761/  1000| tot_loss: 2.2845 | rl_loss: 0.3817 | pt_loss: 1.9029 | pg_loss: 0.0460 | reg_loss: 0.3356 | reward: -0.1994 | rev_kl: 0.4239 | stu_lens: 87.5000 | mixed_lens: 114.5000 | lr: 8.5328e-07 | scale: 1024.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    762/  1000| tot_loss: 2.1723 | rl_loss: 0.7235 | pt_loss: 1.4488 | pg_loss: 0.2000 | reg_loss: 0.5235 | reward: -0.2762 | rev_kl: 0.6458 | stu_lens: 88.0000 | mixed_lens: 83.5000 | lr: 8.4672e-07 | scale: 1024.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    763/  1000| tot_loss: 2.4133 | rl_loss: 0.8111 | pt_loss: 1.6021 | pg_loss: 0.4139 | reg_loss: 0.3973 | reward: -0.4452 | rev_kl: 0.9120 | stu_lens: 81.0000 | mixed_lens: 61.0000 | lr: 8.4018e-07 | scale: 1024.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    764/  1000| tot_loss: 2.9703 | rl_loss: 0.8432 | pt_loss: 2.1271 | pg_loss: 0.2245 | reg_loss: 0.6187 | reward: -0.5154 | rev_kl: 0.7764 | stu_lens: 63.5000 | mixed_lens: 94.0000 | lr: 8.3367e-07 | scale: 1024.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    765/  1000| tot_loss: 2.4025 | rl_loss: 0.5488 | pt_loss: 1.8538 | pg_loss: 0.2240 | reg_loss: 0.3248 | reward: -0.0793 | rev_kl: 0.3489 | stu_lens: 75.0000 | mixed_lens: 65.5000 | lr: 8.2717e-07 | scale: 1024.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    766/  1000| tot_loss: 3.0545 | rl_loss: 1.1375 | pt_loss: 1.9170 | pg_loss: 0.5822 | reg_loss: 0.5554 | reward: -0.6388 | rev_kl: 1.1724 | stu_lens: 85.0000 | mixed_lens: 61.5000 | lr: 8.2070e-07 | scale: 1024.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    767/  1000| tot_loss: 2.6396 | rl_loss: 0.8452 | pt_loss: 1.7943 | pg_loss: 0.3970 | reg_loss: 0.4482 | reward: -0.5109 | rev_kl: 0.5084 | stu_lens: 69.0000 | mixed_lens: 79.5000 | lr: 8.1424e-07 | scale: 1024.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    768/  1000| tot_loss: 3.1749 | rl_loss: 1.2971 | pt_loss: 1.8778 | pg_loss: 0.8695 | reg_loss: 0.4276 | reward: -0.5866 | rev_kl: 0.7447 | stu_lens: 40.5000 | mixed_lens: 46.0000 | lr: 8.0781e-07 | scale: 1024.00 | time: 26.285 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    768/  1000| tot_loss: 2.5530 | rl_loss: 0.8495 | pt_loss: 1.7035 | pg_loss: 0.2950 | reg_loss: 0.5544 | reward: -0.3530 | rev_kl: 0.9061 | stu_lens: 80.3438 | mixed_lens: 89.8750 | lr: 8.0781e-07 | scale: 1024.00 | time: 26.285 | step time: 27.493
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    769/  1000| tot_loss: 2.6157 | rl_loss: 1.0673 | pt_loss: 1.5484 | pg_loss: 0.4835 | reg_loss: 0.5838 | reward: -0.5260 | rev_kl: 0.8719 | stu_lens: 113.0000 | mixed_lens: 74.5000 | lr: 8.0140e-07 | scale: 1024.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    770/  1000| tot_loss: 3.6086 | rl_loss: 1.8004 | pt_loss: 1.8081 | pg_loss: 0.5168 | reg_loss: 1.2836 | reward: -0.8096 | rev_kl: 1.0242 | stu_lens: 75.0000 | mixed_lens: 70.5000 | lr: 7.9500e-07 | scale: 1024.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    771/  1000| tot_loss: 2.7374 | rl_loss: 1.1310 | pt_loss: 1.6064 | pg_loss: 0.1982 | reg_loss: 0.9328 | reward: -0.3385 | rev_kl: 1.2579 | stu_lens: 70.5000 | mixed_lens: 87.0000 | lr: 7.8863e-07 | scale: 1024.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    772/  1000| tot_loss: 3.3189 | rl_loss: 1.4435 | pt_loss: 1.8755 | pg_loss: 0.3965 | reg_loss: 1.0470 | reward: -0.2936 | rev_kl: 0.7257 | stu_lens: 80.5000 | mixed_lens: 81.5000 | lr: 7.8228e-07 | scale: 1024.00 | time: 26.211 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    773/  1000| tot_loss: 3.3107 | rl_loss: 1.1602 | pt_loss: 2.1506 | pg_loss: 0.5124 | reg_loss: 0.6478 | reward: -0.1306 | rev_kl: 0.4127 | stu_lens: 29.0000 | mixed_lens: 51.0000 | lr: 7.7595e-07 | scale: 1024.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    774/  1000| tot_loss: 3.4243 | rl_loss: 1.5071 | pt_loss: 1.9172 | pg_loss: 0.1916 | reg_loss: 1.3155 | reward: -0.5543 | rev_kl: 1.4552 | stu_lens: 56.0000 | mixed_lens: 108.0000 | lr: 7.6964e-07 | scale: 1024.00 | time: 26.197 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    775/  1000| tot_loss: 3.9008 | rl_loss: 1.6586 | pt_loss: 2.2422 | pg_loss: 0.3668 | reg_loss: 1.2918 | reward: -0.3546 | rev_kl: 1.8327 | stu_lens: 96.5000 | mixed_lens: 79.0000 | lr: 7.6335e-07 | scale: 1024.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    776/  1000| tot_loss: 4.1107 | rl_loss: 2.4731 | pt_loss: 1.6375 | pg_loss: 0.6123 | reg_loss: 1.8608 | reward: -0.5775 | rev_kl: 1.3026 | stu_lens: 116.0000 | mixed_lens: 58.5000 | lr: 7.5709e-07 | scale: 1024.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    777/  1000| tot_loss: 3.2215 | rl_loss: 1.5487 | pt_loss: 1.6728 | pg_loss: 0.3617 | reg_loss: 1.1870 | reward: -0.4963 | rev_kl: 1.2401 | stu_lens: 75.5000 | mixed_lens: 81.5000 | lr: 7.5084e-07 | scale: 1024.00 | time: 26.340 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    778/  1000| tot_loss: 3.5870 | rl_loss: 1.9022 | pt_loss: 1.6848 | pg_loss: 1.1294 | reg_loss: 0.7728 | reward: -0.2966 | rev_kl: 0.8973 | stu_lens: 25.5000 | mixed_lens: 24.0000 | lr: 7.4462e-07 | scale: 1024.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    779/  1000| tot_loss: 3.2923 | rl_loss: 1.5121 | pt_loss: 1.7802 | pg_loss: 0.5189 | reg_loss: 0.9931 | reward: 0.1298 | rev_kl: 0.6737 | stu_lens: 92.5000 | mixed_lens: 80.0000 | lr: 7.3841e-07 | scale: 1024.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    780/  1000| tot_loss: 3.8236 | rl_loss: 1.3447 | pt_loss: 2.4789 | pg_loss: 0.1731 | reg_loss: 1.1715 | reward: -0.3718 | rev_kl: 1.1678 | stu_lens: 68.5000 | mixed_lens: 70.0000 | lr: 7.3223e-07 | scale: 1024.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    781/  1000| tot_loss: 3.1696 | rl_loss: 1.0811 | pt_loss: 2.0884 | pg_loss: 0.2364 | reg_loss: 0.8448 | reward: -0.1296 | rev_kl: 0.3869 | stu_lens: 79.5000 | mixed_lens: 96.5000 | lr: 7.2607e-07 | scale: 1024.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    782/  1000| tot_loss: 3.6014 | rl_loss: 1.4428 | pt_loss: 2.1586 | pg_loss: 0.1565 | reg_loss: 1.2863 | reward: -0.3329 | rev_kl: 1.2017 | stu_lens: 71.0000 | mixed_lens: 102.0000 | lr: 7.1993e-07 | scale: 1024.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    783/  1000| tot_loss: 3.2907 | rl_loss: 1.3693 | pt_loss: 1.9215 | pg_loss: 0.2053 | reg_loss: 1.1639 | reward: -0.1770 | rev_kl: 0.9081 | stu_lens: 98.5000 | mixed_lens: 102.0000 | lr: 7.1382e-07 | scale: 1024.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    784/  1000| tot_loss: 2.7827 | rl_loss: 1.0757 | pt_loss: 1.7070 | pg_loss: 0.0274 | reg_loss: 1.0483 | reward: -0.2710 | rev_kl: 1.3675 | stu_lens: 99.0000 | mixed_lens: 128.0000 | lr: 7.0772e-07 | scale: 1024.00 | time: 26.239 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    784/  1000| tot_loss: 3.2127 | rl_loss: 1.3616 | pt_loss: 1.8512 | pg_loss: 0.3059 | reg_loss: 1.0556 | reward: -0.4426 | rev_kl: 1.0489 | stu_lens: 85.2031 | mixed_lens: 86.0938 | lr: 7.0772e-07 | scale: 1024.00 | time: 26.239 | step time: 27.492
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    785/  1000| tot_loss: 3.3604 | rl_loss: 1.6083 | pt_loss: 1.7521 | pg_loss: 0.6214 | reg_loss: 0.9868 | reward: -0.7292 | rev_kl: 0.9572 | stu_lens: 56.0000 | mixed_lens: 73.5000 | lr: 7.0165e-07 | scale: 1024.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    786/  1000| tot_loss: 5.8386 | rl_loss: 4.5529 | pt_loss: 1.2857 | pg_loss: 2.9613 | reg_loss: 1.5916 | reward: -2.4551 | rev_kl: 3.1905 | stu_lens: 29.5000 | mixed_lens: 9.5000 | lr: 6.9560e-07 | scale: 1024.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    787/  1000| tot_loss: 3.5376 | rl_loss: 1.5547 | pt_loss: 1.9829 | pg_loss: 0.8878 | reg_loss: 0.6669 | reward: -0.2517 | rev_kl: 0.8961 | stu_lens: 40.0000 | mixed_lens: 49.0000 | lr: 6.8957e-07 | scale: 1024.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    788/  1000| tot_loss: 2.6253 | rl_loss: 0.9069 | pt_loss: 1.7184 | pg_loss: 0.4910 | reg_loss: 0.4158 | reward: -0.0694 | rev_kl: 0.3101 | stu_lens: 36.0000 | mixed_lens: 52.0000 | lr: 6.8356e-07 | scale: 1024.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    789/  1000| tot_loss: 2.4376 | rl_loss: 1.1516 | pt_loss: 1.2860 | pg_loss: 0.2682 | reg_loss: 0.8834 | reward: -0.8672 | rev_kl: 0.9734 | stu_lens: 88.0000 | mixed_lens: 76.5000 | lr: 6.7758e-07 | scale: 1024.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    790/  1000| tot_loss: 3.1387 | rl_loss: 1.2523 | pt_loss: 1.8863 | pg_loss: 0.2557 | reg_loss: 0.9966 | reward: -0.3919 | rev_kl: 0.8219 | stu_lens: 128.0000 | mixed_lens: 87.5000 | lr: 6.7162e-07 | scale: 1024.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    791/  1000| tot_loss: 2.8834 | rl_loss: 1.0623 | pt_loss: 1.8211 | pg_loss: 0.0440 | reg_loss: 1.0183 | reward: -0.2323 | rev_kl: 1.4466 | stu_lens: 84.5000 | mixed_lens: 121.0000 | lr: 6.6568e-07 | scale: 1024.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    792/  1000| tot_loss: 3.2804 | rl_loss: 1.5889 | pt_loss: 1.6915 | pg_loss: 0.2050 | reg_loss: 1.3839 | reward: -0.4550 | rev_kl: 1.6445 | stu_lens: 128.0000 | mixed_lens: 93.0000 | lr: 6.5976e-07 | scale: 1024.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    793/  1000| tot_loss: 2.7092 | rl_loss: 1.0670 | pt_loss: 1.6422 | pg_loss: 0.3070 | reg_loss: 0.7600 | reward: -0.3466 | rev_kl: 0.6697 | stu_lens: 69.0000 | mixed_lens: 70.5000 | lr: 6.5386e-07 | scale: 1024.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    794/  1000| tot_loss: 2.2373 | rl_loss: 0.9953 | pt_loss: 1.2420 | pg_loss: 0.1936 | reg_loss: 0.8017 | reward: -0.1189 | rev_kl: 0.6607 | stu_lens: 86.5000 | mixed_lens: 95.5000 | lr: 6.4799e-07 | scale: 1024.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    795/  1000| tot_loss: 2.2679 | rl_loss: 0.9969 | pt_loss: 1.2709 | pg_loss: -0.0173 | reg_loss: 1.0142 | reward: -0.2597 | rev_kl: 0.8326 | stu_lens: 113.5000 | mixed_lens: 128.0000 | lr: 6.4214e-07 | scale: 1024.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    796/  1000| tot_loss: 3.3149 | rl_loss: 1.5815 | pt_loss: 1.7334 | pg_loss: 0.5476 | reg_loss: 1.0339 | reward: -0.7189 | rev_kl: 0.8774 | stu_lens: 94.5000 | mixed_lens: 77.5000 | lr: 6.3631e-07 | scale: 1024.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    797/  1000| tot_loss: 2.8176 | rl_loss: 1.0147 | pt_loss: 1.8030 | pg_loss: 0.3538 | reg_loss: 0.6608 | reward: -0.8849 | rev_kl: 0.7298 | stu_lens: 64.0000 | mixed_lens: 70.5000 | lr: 6.3050e-07 | scale: 1024.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    798/  1000| tot_loss: 2.6494 | rl_loss: 1.1627 | pt_loss: 1.4867 | pg_loss: 0.3600 | reg_loss: 0.8027 | reward: 0.0749 | rev_kl: 0.5389 | stu_lens: 78.5000 | mixed_lens: 80.0000 | lr: 6.2472e-07 | scale: 1024.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    799/  1000| tot_loss: 2.8664 | rl_loss: 1.0877 | pt_loss: 1.7787 | pg_loss: 0.1169 | reg_loss: 0.9708 | reward: -0.3364 | rev_kl: 1.4698 | stu_lens: 96.5000 | mixed_lens: 104.0000 | lr: 6.1896e-07 | scale: 1024.00 | time: 26.335 | step time: 0.000
                                 Evaluation #8                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ That sounds boring. I want to create │
│                                       │ something new.                       │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Then why don't you create something  │
│                                       │ new?                                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Ok, then create something new.       │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 15.954 | exact_match: 0.000 | rev_kl: 1.024 | lens: 86.836 | pt_loss: 1.094 | lm_loss: 1.185 | kd_loss: 1.002 
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    800/  1000| tot_loss: 2.9840 | rl_loss: 1.1355 | pt_loss: 1.8486 | pg_loss: 0.1008 | reg_loss: 1.0347 | reward: -0.5106 | rev_kl: 1.5144 | stu_lens: 50.0000 | mixed_lens: 118.0000 | lr: 6.1323e-07 | scale: 1024.00 | time: 26.273 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    800/  1000| tot_loss: 2.9590 | rl_loss: 1.3207 | pt_loss: 1.6384 | pg_loss: 0.4041 | reg_loss: 0.9166 | reward: -0.4537 | rev_kl: 1.0179 | stu_lens: 80.7812 | mixed_lens: 85.0938 | lr: 6.1323e-07 | scale: 1024.00 | time: 26.273 | step time: 27.515
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    801/  1000| tot_loss: 2.9055 | rl_loss: 1.0496 | pt_loss: 1.8558 | pg_loss: 0.1072 | reg_loss: 0.9424 | reward: -0.3513 | rev_kl: 0.8349 | stu_lens: 104.5000 | mixed_lens: 102.0000 | lr: 6.0751e-07 | scale: 1024.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    802/  1000| tot_loss: 3.0622 | rl_loss: 1.1289 | pt_loss: 1.9333 | pg_loss: 0.1797 | reg_loss: 0.9492 | reward: -0.4743 | rev_kl: 1.2222 | stu_lens: 105.0000 | mixed_lens: 99.0000 | lr: 6.0182e-07 | scale: 1024.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    803/  1000| tot_loss: 3.6749 | rl_loss: 1.6596 | pt_loss: 2.0154 | pg_loss: 0.5965 | reg_loss: 1.0630 | reward: -1.1588 | rev_kl: 3.4037 | stu_lens: 64.0000 | mixed_lens: 41.5000 | lr: 5.9615e-07 | scale: 1024.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    804/  1000| tot_loss: 2.1446 | rl_loss: 0.9038 | pt_loss: 1.2408 | pg_loss: 0.0384 | reg_loss: 0.8654 | reward: -0.2862 | rev_kl: 0.7706 | stu_lens: 114.0000 | mixed_lens: 123.5000 | lr: 5.9051e-07 | scale: 1024.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    805/  1000| tot_loss: 3.0551 | rl_loss: 0.9470 | pt_loss: 2.1081 | pg_loss: 0.1927 | reg_loss: 0.7542 | reward: -0.2850 | rev_kl: 1.3834 | stu_lens: 95.5000 | mixed_lens: 104.0000 | lr: 5.8489e-07 | scale: 1024.00 | time: 26.367 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    806/  1000| tot_loss: 2.1262 | rl_loss: 0.8793 | pt_loss: 1.2468 | pg_loss: -0.0234 | reg_loss: 0.9028 | reward: -0.2597 | rev_kl: 0.8326 | stu_lens: 113.5000 | mixed_lens: 128.0000 | lr: 5.7929e-07 | scale: 1024.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    807/  1000| tot_loss: 3.2919 | rl_loss: 0.9958 | pt_loss: 2.2961 | pg_loss: 0.1256 | reg_loss: 0.8701 | reward: -0.5545 | rev_kl: 1.4027 | stu_lens: 128.0000 | mixed_lens: 92.0000 | lr: 5.7372e-07 | scale: 1024.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    808/  1000| tot_loss: 3.2923 | rl_loss: 1.5823 | pt_loss: 1.7100 | pg_loss: 0.4683 | reg_loss: 1.1140 | reward: -0.5448 | rev_kl: 1.2393 | stu_lens: 80.5000 | mixed_lens: 76.5000 | lr: 5.6817e-07 | scale: 1024.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    809/  1000| tot_loss: 2.7080 | rl_loss: 0.8680 | pt_loss: 1.8400 | pg_loss: 0.2875 | reg_loss: 0.5805 | reward: -0.0524 | rev_kl: 0.5257 | stu_lens: 31.5000 | mixed_lens: 83.5000 | lr: 5.6264e-07 | scale: 1024.00 | time: 26.360 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    810/  1000| tot_loss: 3.4400 | rl_loss: 1.7086 | pt_loss: 1.7314 | pg_loss: 0.7671 | reg_loss: 0.9415 | reward: -1.6724 | rev_kl: 0.8617 | stu_lens: 42.5000 | mixed_lens: 47.5000 | lr: 5.5714e-07 | scale: 1024.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    811/  1000| tot_loss: 2.3567 | rl_loss: 0.9071 | pt_loss: 1.4496 | pg_loss: 0.1884 | reg_loss: 0.7187 | reward: -0.2533 | rev_kl: 0.7788 | stu_lens: 86.5000 | mixed_lens: 95.5000 | lr: 5.5166e-07 | scale: 1024.00 | time: 26.315 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    812/  1000| tot_loss: 2.6825 | rl_loss: 1.0283 | pt_loss: 1.6542 | pg_loss: 0.3151 | reg_loss: 0.7132 | reward: -0.5241 | rev_kl: 1.0583 | stu_lens: 100.0000 | mixed_lens: 81.5000 | lr: 5.4620e-07 | scale: 1024.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    813/  1000| tot_loss: 2.3096 | rl_loss: 0.8471 | pt_loss: 1.4625 | pg_loss: -0.0062 | reg_loss: 0.8533 | reward: -0.1377 | rev_kl: 1.5836 | stu_lens: 66.5000 | mixed_lens: 128.0000 | lr: 5.4077e-07 | scale: 1024.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    814/  1000| tot_loss: 2.4404 | rl_loss: 1.1468 | pt_loss: 1.2937 | pg_loss: 0.5803 | reg_loss: 0.5665 | reward: 0.0678 | rev_kl: 0.4300 | stu_lens: 64.0000 | mixed_lens: 59.0000 | lr: 5.3536e-07 | scale: 1024.00 | time: 26.315 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    815/  1000| tot_loss: 2.8800 | rl_loss: 0.8049 | pt_loss: 2.0752 | pg_loss: 0.0497 | reg_loss: 0.7552 | reward: -0.1771 | rev_kl: 0.8672 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 5.2997e-07 | scale: 1024.00 | time: 26.396 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    816/  1000| tot_loss: 3.1763 | rl_loss: 1.2071 | pt_loss: 1.9692 | pg_loss: 0.6591 | reg_loss: 0.5480 | reward: -1.3061 | rev_kl: 1.1154 | stu_lens: 37.5000 | mixed_lens: 40.0000 | lr: 5.2461e-07 | scale: 1024.00 | time: 26.292 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    816/  1000| tot_loss: 2.7250 | rl_loss: 1.0668 | pt_loss: 1.6582 | pg_loss: 0.2797 | reg_loss: 0.7870 | reward: -0.4251 | rev_kl: 1.0271 | stu_lens: 86.4219 | mixed_lens: 89.2969 | lr: 5.2461e-07 | scale: 1024.00 | time: 26.292 | step time: 27.551
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    817/  1000| tot_loss: 2.6217 | rl_loss: 0.9973 | pt_loss: 1.6244 | pg_loss: 0.2495 | reg_loss: 0.7478 | reward: -0.3513 | rev_kl: 1.3627 | stu_lens: 85.5000 | mixed_lens: 87.0000 | lr: 5.1928e-07 | scale: 1024.00 | time: 26.352 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    818/  1000| tot_loss: 1.8231 | rl_loss: 0.5315 | pt_loss: 1.2915 | pg_loss: 0.1947 | reg_loss: 0.3368 | reward: -0.2114 | rev_kl: 0.4232 | stu_lens: 86.5000 | mixed_lens: 93.0000 | lr: 5.1396e-07 | scale: 1024.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    819/  1000| tot_loss: 2.2374 | rl_loss: 0.6740 | pt_loss: 1.5634 | pg_loss: -0.0077 | reg_loss: 0.6816 | reward: -0.2207 | rev_kl: 1.3495 | stu_lens: 100.0000 | mixed_lens: 128.0000 | lr: 5.0868e-07 | scale: 1024.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    820/  1000| tot_loss: 2.9263 | rl_loss: 1.3659 | pt_loss: 1.5604 | pg_loss: 0.4074 | reg_loss: 0.9585 | reward: -0.5441 | rev_kl: 1.8328 | stu_lens: 85.5000 | mixed_lens: 82.0000 | lr: 5.0341e-07 | scale: 1024.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    821/  1000| tot_loss: 2.3790 | rl_loss: 0.4302 | pt_loss: 1.9488 | pg_loss: 0.0067 | reg_loss: 0.4235 | reward: -0.1450 | rev_kl: 0.7130 | stu_lens: 128.0000 | mixed_lens: 126.0000 | lr: 4.9817e-07 | scale: 1024.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    822/  1000| tot_loss: 3.2779 | rl_loss: 1.5737 | pt_loss: 1.7042 | pg_loss: 0.5768 | reg_loss: 0.9969 | reward: -1.0546 | rev_kl: 3.2652 | stu_lens: 87.5000 | mixed_lens: 63.0000 | lr: 4.9296e-07 | scale: 1024.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    823/  1000| tot_loss: 2.1028 | rl_loss: 0.8170 | pt_loss: 1.2858 | pg_loss: 0.2285 | reg_loss: 0.5885 | reward: -0.3809 | rev_kl: 1.0044 | stu_lens: 60.5000 | mixed_lens: 74.5000 | lr: 4.8777e-07 | scale: 1024.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    824/  1000| tot_loss: 2.8435 | rl_loss: 1.1063 | pt_loss: 1.7372 | pg_loss: 0.3648 | reg_loss: 0.7415 | reward: -0.5656 | rev_kl: 1.1729 | stu_lens: 97.0000 | mixed_lens: 78.5000 | lr: 4.8260e-07 | scale: 1024.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    825/  1000| tot_loss: 2.4457 | rl_loss: 0.7248 | pt_loss: 1.7209 | pg_loss: -0.0106 | reg_loss: 0.7353 | reward: -0.2123 | rev_kl: 0.8053 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7746e-07 | scale: 1024.00 | time: 26.362 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    826/  1000| tot_loss: 2.5561 | rl_loss: 0.6590 | pt_loss: 1.8972 | pg_loss: 0.1229 | reg_loss: 0.5361 | reward: -0.1197 | rev_kl: 0.4937 | stu_lens: 60.5000 | mixed_lens: 107.0000 | lr: 4.7234e-07 | scale: 1024.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    827/  1000| tot_loss: 2.6847 | rl_loss: 1.0415 | pt_loss: 1.6432 | pg_loss: 0.2625 | reg_loss: 0.7790 | reward: -0.4065 | rev_kl: 1.6193 | stu_lens: 102.0000 | mixed_lens: 92.0000 | lr: 4.6725e-07 | scale: 1024.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    828/  1000| tot_loss: 2.6820 | rl_loss: 0.8603 | pt_loss: 1.8217 | pg_loss: 0.0496 | reg_loss: 0.8107 | reward: -0.3197 | rev_kl: 1.2253 | stu_lens: 124.5000 | mixed_lens: 118.0000 | lr: 4.6218e-07 | scale: 1024.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    829/  1000| tot_loss: 2.0181 | rl_loss: 0.7522 | pt_loss: 1.2659 | pg_loss: 0.1494 | reg_loss: 0.6028 | reward: -0.1744 | rev_kl: 1.5210 | stu_lens: 96.5000 | mixed_lens: 104.0000 | lr: 4.5714e-07 | scale: 1024.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    830/  1000| tot_loss: 3.5106 | rl_loss: 1.5120 | pt_loss: 1.9986 | pg_loss: 0.7434 | reg_loss: 0.7686 | reward: -0.7860 | rev_kl: 0.9559 | stu_lens: 53.0000 | mixed_lens: 49.5000 | lr: 4.5212e-07 | scale: 1024.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    831/  1000| tot_loss: 2.2715 | rl_loss: 0.6055 | pt_loss: 1.6660 | pg_loss: 0.1032 | reg_loss: 0.5023 | reward: -0.3356 | rev_kl: 1.0440 | stu_lens: 104.5000 | mixed_lens: 102.0000 | lr: 4.4713e-07 | scale: 1024.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    832/  1000| tot_loss: 2.5529 | rl_loss: 1.0927 | pt_loss: 1.4601 | pg_loss: 0.4124 | reg_loss: 0.6804 | reward: -0.0741 | rev_kl: 0.7347 | stu_lens: 78.0000 | mixed_lens: 77.5000 | lr: 4.4216e-07 | scale: 1024.00 | time: 26.274 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    832/  1000| tot_loss: 2.7210 | rl_loss: 1.0869 | pt_loss: 1.6341 | pg_loss: 0.4353 | reg_loss: 0.6516 | reward: -0.4325 | rev_kl: 1.0481 | stu_lens: 83.0156 | mixed_lens: 85.2812 | lr: 4.4216e-07 | scale: 1024.00 | time: 26.274 | step time: 27.533
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    833/  1000| tot_loss: 2.7416 | rl_loss: 1.1802 | pt_loss: 1.5614 | pg_loss: 0.7381 | reg_loss: 0.4421 | reward: -1.0027 | rev_kl: 0.8350 | stu_lens: 40.5000 | mixed_lens: 30.0000 | lr: 4.3722e-07 | scale: 1024.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    834/  1000| tot_loss: 3.2882 | rl_loss: 1.5164 | pt_loss: 1.7719 | pg_loss: 0.2270 | reg_loss: 1.2894 | reward: -0.4481 | rev_kl: 1.2526 | stu_lens: 77.5000 | mixed_lens: 98.0000 | lr: 4.3230e-07 | scale: 1024.00 | time: 26.386 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    835/  1000| tot_loss: 3.1526 | rl_loss: 1.5620 | pt_loss: 1.5906 | pg_loss: 0.1723 | reg_loss: 1.3897 | reward: -0.1337 | rev_kl: 0.8341 | stu_lens: 58.0000 | mixed_lens: 109.0000 | lr: 4.2741e-07 | scale: 1024.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    836/  1000| tot_loss: 2.6832 | rl_loss: 1.1062 | pt_loss: 1.5770 | pg_loss: 0.2750 | reg_loss: 0.8312 | reward: -0.4152 | rev_kl: 0.6691 | stu_lens: 128.0000 | mixed_lens: 92.5000 | lr: 4.2254e-07 | scale: 1024.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    837/  1000| tot_loss: 2.7517 | rl_loss: 1.2116 | pt_loss: 1.5401 | pg_loss: 0.5276 | reg_loss: 0.6840 | reward: -0.5143 | rev_kl: 1.5011 | stu_lens: 96.5000 | mixed_lens: 61.0000 | lr: 4.1770e-07 | scale: 1024.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    838/  1000| tot_loss: 3.3497 | rl_loss: 1.3632 | pt_loss: 1.9865 | pg_loss: 0.5370 | reg_loss: 0.8262 | reward: -0.3265 | rev_kl: 0.4719 | stu_lens: 47.0000 | mixed_lens: 63.0000 | lr: 4.1288e-07 | scale: 1024.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    839/  1000| tot_loss: 4.2042 | rl_loss: 2.7668 | pt_loss: 1.4374 | pg_loss: 1.5888 | reg_loss: 1.1780 | reward: -0.4024 | rev_kl: 0.8976 | stu_lens: 27.0000 | mixed_lens: 29.5000 | lr: 4.0809e-07 | scale: 1024.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    840/  1000| tot_loss: 2.3568 | rl_loss: 0.9542 | pt_loss: 1.4026 | pg_loss: 0.0598 | reg_loss: 0.8944 | reward: -0.2060 | rev_kl: 1.1896 | stu_lens: 113.0000 | mixed_lens: 128.0000 | lr: 4.0332e-07 | scale: 1024.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    841/  1000| tot_loss: 3.1632 | rl_loss: 1.3864 | pt_loss: 1.7768 | pg_loss: 0.1827 | reg_loss: 1.2037 | reward: -0.2172 | rev_kl: 1.2600 | stu_lens: 110.5000 | mixed_lens: 103.5000 | lr: 3.9858e-07 | scale: 1024.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    842/  1000| tot_loss: 4.4539 | rl_loss: 2.4943 | pt_loss: 1.9597 | pg_loss: 1.6954 | reg_loss: 0.7988 | reward: -0.3913 | rev_kl: 0.4045 | stu_lens: 33.5000 | mixed_lens: 25.5000 | lr: 3.9387e-07 | scale: 1024.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    843/  1000| tot_loss: 3.3930 | rl_loss: 1.6062 | pt_loss: 1.7868 | pg_loss: 0.1951 | reg_loss: 1.4111 | reward: -0.1676 | rev_kl: 1.0081 | stu_lens: 121.0000 | mixed_lens: 111.0000 | lr: 3.8918e-07 | scale: 1024.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    844/  1000| tot_loss: 3.9839 | rl_loss: 2.2317 | pt_loss: 1.7522 | pg_loss: 1.1619 | reg_loss: 1.0698 | reward: -0.3310 | rev_kl: 0.7563 | stu_lens: 65.5000 | mixed_lens: 36.0000 | lr: 3.8452e-07 | scale: 1024.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    845/  1000| tot_loss: 3.0550 | rl_loss: 1.4383 | pt_loss: 1.6167 | pg_loss: 0.1829 | reg_loss: 1.2554 | reward: -0.4896 | rev_kl: 1.0315 | stu_lens: 124.5000 | mixed_lens: 109.5000 | lr: 3.7988e-07 | scale: 1024.00 | time: 26.361 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    846/  1000| tot_loss: 2.9479 | rl_loss: 1.6102 | pt_loss: 1.3377 | pg_loss: 0.5063 | reg_loss: 1.1039 | reward: -1.4261 | rev_kl: 1.0601 | stu_lens: 68.0000 | mixed_lens: 71.0000 | lr: 3.7527e-07 | scale: 1024.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    847/  1000| tot_loss: 2.2143 | rl_loss: 0.8532 | pt_loss: 1.3611 | pg_loss: 0.0846 | reg_loss: 0.7685 | reward: -0.2287 | rev_kl: 0.7778 | stu_lens: 37.5000 | mixed_lens: 116.0000 | lr: 3.7068e-07 | scale: 1024.00 | time: 26.343 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    848/  1000| tot_loss: 3.6743 | rl_loss: 1.9390 | pt_loss: 1.7353 | pg_loss: 0.5758 | reg_loss: 1.3632 | reward: -0.3096 | rev_kl: 0.7888 | stu_lens: 84.5000 | mixed_lens: 51.0000 | lr: 3.6612e-07 | scale: 1024.00 | time: 26.303 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    848/  1000| tot_loss: 3.2441 | rl_loss: 1.5387 | pt_loss: 1.7054 | pg_loss: 0.5237 | reg_loss: 1.0150 | reward: -0.4292 | rev_kl: 0.9556 | stu_lens: 73.8125 | mixed_lens: 76.7500 | lr: 3.6612e-07 | scale: 1024.00 | time: 26.303 | step time: 27.538
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    849/  1000| tot_loss: 3.3956 | rl_loss: 1.2543 | pt_loss: 2.1414 | pg_loss: 0.2161 | reg_loss: 1.0382 | reward: -0.3656 | rev_kl: 1.5612 | stu_lens: 128.0000 | mixed_lens: 89.5000 | lr: 3.6159e-07 | scale: 1024.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    850/  1000| tot_loss: 3.2803 | rl_loss: 1.9065 | pt_loss: 1.3739 | pg_loss: 0.6785 | reg_loss: 1.2280 | reward: -0.2811 | rev_kl: 0.5632 | stu_lens: 61.5000 | mixed_lens: 68.5000 | lr: 3.5708e-07 | scale: 1024.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    851/  1000| tot_loss: 3.4267 | rl_loss: 1.3202 | pt_loss: 2.1066 | pg_loss: 0.6231 | reg_loss: 0.6971 | reward: -0.2935 | rev_kl: 0.5839 | stu_lens: 78.5000 | mixed_lens: 46.5000 | lr: 3.5260e-07 | scale: 1024.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    852/  1000| tot_loss: 3.0533 | rl_loss: 1.0100 | pt_loss: 2.0433 | pg_loss: 0.0853 | reg_loss: 0.9247 | reward: -0.1136 | rev_kl: 0.8046 | stu_lens: 115.0000 | mixed_lens: 107.0000 | lr: 3.4814e-07 | scale: 1024.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    853/  1000| tot_loss: 2.8237 | rl_loss: 0.9739 | pt_loss: 1.8498 | pg_loss: 0.0022 | reg_loss: 0.9717 | reward: -0.3737 | rev_kl: 0.8211 | stu_lens: 88.5000 | mixed_lens: 128.0000 | lr: 3.4372e-07 | scale: 1024.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    854/  1000| tot_loss: 2.7267 | rl_loss: 1.3376 | pt_loss: 1.3891 | pg_loss: 0.3600 | reg_loss: 0.9776 | reward: -0.6202 | rev_kl: 0.6157 | stu_lens: 98.0000 | mixed_lens: 76.5000 | lr: 3.3931e-07 | scale: 1024.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    855/  1000| tot_loss: 2.6807 | rl_loss: 0.9991 | pt_loss: 1.6816 | pg_loss: -0.0075 | reg_loss: 1.0067 | reward: -0.1723 | rev_kl: 1.2253 | stu_lens: 110.5000 | mixed_lens: 128.0000 | lr: 3.3494e-07 | scale: 1024.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    856/  1000| tot_loss: 3.0432 | rl_loss: 1.3519 | pt_loss: 1.6913 | pg_loss: 0.5770 | reg_loss: 0.7749 | reward: -0.3173 | rev_kl: 0.9085 | stu_lens: 57.5000 | mixed_lens: 53.5000 | lr: 3.3059e-07 | scale: 1024.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    857/  1000| tot_loss: 3.6273 | rl_loss: 1.5303 | pt_loss: 2.0970 | pg_loss: 0.9020 | reg_loss: 0.6284 | reward: -0.1929 | rev_kl: 0.4533 | stu_lens: 23.0000 | mixed_lens: 53.5000 | lr: 3.2626e-07 | scale: 1024.00 | time: 26.361 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    858/  1000| tot_loss: 2.9795 | rl_loss: 1.2928 | pt_loss: 1.6867 | pg_loss: 0.1803 | reg_loss: 1.1126 | reward: -0.3417 | rev_kl: 0.8905 | stu_lens: 128.0000 | mixed_lens: 103.5000 | lr: 3.2197e-07 | scale: 1024.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    859/  1000| tot_loss: 3.6927 | rl_loss: 1.8820 | pt_loss: 1.8107 | pg_loss: 0.7963 | reg_loss: 1.0857 | reward: -0.7168 | rev_kl: 1.1189 | stu_lens: 56.5000 | mixed_lens: 56.5000 | lr: 3.1769e-07 | scale: 1024.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    860/  1000| tot_loss: 2.9955 | rl_loss: 1.0774 | pt_loss: 1.9181 | pg_loss: 0.2275 | reg_loss: 0.8499 | reward: -0.4110 | rev_kl: 0.7948 | stu_lens: 59.0000 | mixed_lens: 76.5000 | lr: 3.1345e-07 | scale: 1024.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    861/  1000| tot_loss: 3.3667 | rl_loss: 2.0766 | pt_loss: 1.2900 | pg_loss: 1.0992 | reg_loss: 0.9775 | reward: -1.4895 | rev_kl: 1.2351 | stu_lens: 49.5000 | mixed_lens: 28.0000 | lr: 3.0923e-07 | scale: 1024.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    862/  1000| tot_loss: 3.0667 | rl_loss: 1.0668 | pt_loss: 1.9998 | pg_loss: 0.3401 | reg_loss: 0.7268 | reward: -0.1839 | rev_kl: 0.8920 | stu_lens: 71.5000 | mixed_lens: 71.0000 | lr: 3.0504e-07 | scale: 1024.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    863/  1000| tot_loss: 3.2736 | rl_loss: 1.3913 | pt_loss: 1.8823 | pg_loss: 0.6136 | reg_loss: 0.7777 | reward: -0.1092 | rev_kl: 0.6494 | stu_lens: 66.0000 | mixed_lens: 42.5000 | lr: 3.0088e-07 | scale: 1024.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    864/  1000| tot_loss: 3.8448 | rl_loss: 2.4664 | pt_loss: 1.3784 | pg_loss: 1.4668 | reg_loss: 0.9996 | reward: -0.7090 | rev_kl: 0.7687 | stu_lens: 69.0000 | mixed_lens: 30.0000 | lr: 2.9674e-07 | scale: 1024.00 | time: 26.267 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    864/  1000| tot_loss: 3.0989 | rl_loss: 1.3652 | pt_loss: 1.7337 | pg_loss: 0.4361 | reg_loss: 0.9292 | reward: -0.3878 | rev_kl: 0.9878 | stu_lens: 77.1562 | mixed_lens: 77.8594 | lr: 2.9674e-07 | scale: 1024.00 | time: 26.267 | step time: 27.514
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    865/  1000| tot_loss: 2.5806 | rl_loss: 1.2695 | pt_loss: 1.3111 | pg_loss: 0.1745 | reg_loss: 1.0950 | reward: -0.5061 | rev_kl: 0.6421 | stu_lens: 120.5000 | mixed_lens: 109.5000 | lr: 2.9263e-07 | scale: 1024.00 | time: 26.363 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    866/  1000| tot_loss: 3.1930 | rl_loss: 1.6191 | pt_loss: 1.5740 | pg_loss: 0.4553 | reg_loss: 1.1638 | reward: -0.2505 | rev_kl: 0.6977 | stu_lens: 47.0000 | mixed_lens: 57.0000 | lr: 2.8855e-07 | scale: 1024.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    867/  1000| tot_loss: 2.4075 | rl_loss: 0.9252 | pt_loss: 1.4823 | pg_loss: 0.0777 | reg_loss: 0.8475 | reward: -0.3729 | rev_kl: 1.2069 | stu_lens: 114.0000 | mixed_lens: 112.0000 | lr: 2.8449e-07 | scale: 1024.00 | time: 26.371 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    868/  1000| tot_loss: 3.1720 | rl_loss: 1.0591 | pt_loss: 2.1129 | pg_loss: 0.2989 | reg_loss: 0.7601 | reward: -0.2560 | rev_kl: 0.6419 | stu_lens: 74.0000 | mixed_lens: 91.5000 | lr: 2.8046e-07 | scale: 1024.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    869/  1000| tot_loss: -0.7017 | rl_loss: -2.5110 | pt_loss: 1.8093 | pg_loss: -2.7780 | reg_loss: 0.2671 | reward: 0.1670 | rev_kl: 1.0548 | stu_lens: 8.0000 | mixed_lens: 5.5000 | lr: 2.7646e-07 | scale: 1024.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    870/  1000| tot_loss: 2.5491 | rl_loss: 1.3898 | pt_loss: 1.1593 | pg_loss: 0.5458 | reg_loss: 0.8440 | reward: -0.2584 | rev_kl: 1.6515 | stu_lens: 49.5000 | mixed_lens: 58.0000 | lr: 2.7248e-07 | scale: 1024.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    871/  1000| tot_loss: 2.5602 | rl_loss: 0.6699 | pt_loss: 1.8903 | pg_loss: 0.2222 | reg_loss: 0.4477 | reward: -0.1557 | rev_kl: 0.4307 | stu_lens: 97.5000 | mixed_lens: 97.0000 | lr: 2.6854e-07 | scale: 1024.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    872/  1000| tot_loss: 2.7224 | rl_loss: 1.2059 | pt_loss: 1.5165 | pg_loss: 0.1605 | reg_loss: 1.0454 | reward: -0.4806 | rev_kl: 1.2593 | stu_lens: 98.5000 | mixed_lens: 101.5000 | lr: 2.6461e-07 | scale: 1024.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    873/  1000| tot_loss: 2.5240 | rl_loss: 0.8922 | pt_loss: 1.6318 | pg_loss: 0.2273 | reg_loss: 0.6648 | reward: -0.3305 | rev_kl: 0.9750 | stu_lens: 71.5000 | mixed_lens: 70.5000 | lr: 2.6072e-07 | scale: 1024.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    874/  1000| tot_loss: 2.3977 | rl_loss: 1.1390 | pt_loss: 1.2587 | pg_loss: 0.2580 | reg_loss: 0.8811 | reward: -0.4057 | rev_kl: 1.3940 | stu_lens: 128.0000 | mixed_lens: 92.5000 | lr: 2.5685e-07 | scale: 1024.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    875/  1000| tot_loss: 2.5155 | rl_loss: 0.8964 | pt_loss: 1.6191 | pg_loss: 0.0628 | reg_loss: 0.8336 | reward: -0.1987 | rev_kl: 1.0404 | stu_lens: 60.5000 | mixed_lens: 114.5000 | lr: 2.5301e-07 | scale: 1024.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    876/  1000| tot_loss: 2.9560 | rl_loss: 1.3573 | pt_loss: 1.5987 | pg_loss: 0.3753 | reg_loss: 0.9821 | reward: -0.2297 | rev_kl: 0.9439 | stu_lens: 128.0000 | mixed_lens: 86.5000 | lr: 2.4920e-07 | scale: 1024.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    877/  1000| tot_loss: 2.6128 | rl_loss: 1.2793 | pt_loss: 1.3335 | pg_loss: 0.3628 | reg_loss: 0.9166 | reward: -0.5147 | rev_kl: 0.4961 | stu_lens: 68.5000 | mixed_lens: 91.0000 | lr: 2.4542e-07 | scale: 1024.00 | time: 26.317 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    878/  1000| tot_loss: 2.7516 | rl_loss: 1.3036 | pt_loss: 1.4479 | pg_loss: 0.5111 | reg_loss: 0.7926 | reward: -0.3294 | rev_kl: 0.7442 | stu_lens: 62.0000 | mixed_lens: 72.0000 | lr: 2.4166e-07 | scale: 1024.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    879/  1000| tot_loss: 4.1200 | rl_loss: 2.3654 | pt_loss: 1.7546 | pg_loss: 1.4741 | reg_loss: 0.8913 | reward: -0.9248 | rev_kl: 1.1669 | stu_lens: 28.0000 | mixed_lens: 18.5000 | lr: 2.3793e-07 | scale: 1024.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    880/  1000| tot_loss: 2.1143 | rl_loss: 0.3714 | pt_loss: 1.7428 | pg_loss: -0.1367 | reg_loss: 0.5081 | reward: -0.1880 | rev_kl: 0.1536 | stu_lens: 35.0000 | mixed_lens: 62.0000 | lr: 2.3423e-07 | scale: 1024.00 | time: 26.269 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    880/  1000| tot_loss: 2.8114 | rl_loss: 1.1547 | pt_loss: 1.6567 | pg_loss: 0.3494 | reg_loss: 0.8054 | reward: -0.4119 | rev_kl: 0.9497 | stu_lens: 75.7969 | mixed_lens: 76.2031 | lr: 2.3423e-07 | scale: 1024.00 | time: 26.269 | step time: 27.518
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    881/  1000| tot_loss: 2.9022 | rl_loss: 0.7482 | pt_loss: 2.1540 | pg_loss: 0.0610 | reg_loss: 0.6872 | reward: -0.3676 | rev_kl: 0.5688 | stu_lens: 115.0000 | mixed_lens: 128.0000 | lr: 2.3056e-07 | scale: 1024.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    882/  1000| tot_loss: 2.7850 | rl_loss: 0.7880 | pt_loss: 1.9970 | pg_loss: 0.1036 | reg_loss: 0.6844 | reward: -0.4087 | rev_kl: 1.1219 | stu_lens: 128.0000 | mixed_lens: 89.5000 | lr: 2.2691e-07 | scale: 1024.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    883/  1000| tot_loss: 3.6992 | rl_loss: 2.3077 | pt_loss: 1.3915 | pg_loss: 1.6145 | reg_loss: 0.6932 | reward: -0.3076 | rev_kl: 0.6794 | stu_lens: 63.0000 | mixed_lens: 23.0000 | lr: 2.2329e-07 | scale: 1024.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    884/  1000| tot_loss: 2.2757 | rl_loss: 0.8514 | pt_loss: 1.4242 | pg_loss: 0.4756 | reg_loss: 0.3758 | reward: -0.3917 | rev_kl: 1.3354 | stu_lens: 75.5000 | mixed_lens: 56.5000 | lr: 2.1970e-07 | scale: 1024.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    885/  1000| tot_loss: 2.4371 | rl_loss: 1.0681 | pt_loss: 1.3690 | pg_loss: 0.0704 | reg_loss: 0.9977 | reward: -0.3688 | rev_kl: 1.1767 | stu_lens: 104.5000 | mixed_lens: 114.5000 | lr: 2.1614e-07 | scale: 1024.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    886/  1000| tot_loss: 3.5677 | rl_loss: 2.1252 | pt_loss: 1.4425 | pg_loss: 1.0848 | reg_loss: 1.0404 | reward: -1.6101 | rev_kl: 1.2095 | stu_lens: 72.0000 | mixed_lens: 35.5000 | lr: 2.1260e-07 | scale: 1024.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    887/  1000| tot_loss: 2.9174 | rl_loss: 1.2621 | pt_loss: 1.6553 | pg_loss: 0.2820 | reg_loss: 0.9801 | reward: -0.4462 | rev_kl: 1.0176 | stu_lens: 94.0000 | mixed_lens: 98.0000 | lr: 2.0909e-07 | scale: 1024.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    888/  1000| tot_loss: 2.3240 | rl_loss: 0.6640 | pt_loss: 1.6600 | pg_loss: 0.1135 | reg_loss: 0.5505 | reward: -0.3215 | rev_kl: 0.6536 | stu_lens: 92.5000 | mixed_lens: 85.0000 | lr: 2.0561e-07 | scale: 1024.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    889/  1000| tot_loss: 2.9175 | rl_loss: 0.8344 | pt_loss: 2.0831 | pg_loss: 0.4398 | reg_loss: 0.3946 | reward: -0.3265 | rev_kl: 0.4719 | stu_lens: 47.0000 | mixed_lens: 63.0000 | lr: 2.0216e-07 | scale: 1024.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    890/  1000| tot_loss: 2.8645 | rl_loss: 1.0596 | pt_loss: 1.8049 | pg_loss: 0.4191 | reg_loss: 0.6406 | reward: -0.4571 | rev_kl: 0.7825 | stu_lens: 69.5000 | mixed_lens: 72.0000 | lr: 1.9874e-07 | scale: 1024.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    891/  1000| tot_loss: 3.4325 | rl_loss: 1.1664 | pt_loss: 2.2661 | pg_loss: 0.3198 | reg_loss: 0.8465 | reward: -0.6651 | rev_kl: 1.1702 | stu_lens: 58.0000 | mixed_lens: 76.5000 | lr: 1.9534e-07 | scale: 1024.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    892/  1000| tot_loss: 2.3965 | rl_loss: 0.9526 | pt_loss: 1.4440 | pg_loss: 0.1324 | reg_loss: 0.8201 | reward: -0.1847 | rev_kl: 0.9092 | stu_lens: 128.0000 | mixed_lens: 111.0000 | lr: 1.9197e-07 | scale: 1024.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    893/  1000| tot_loss: 3.0788 | rl_loss: 1.7315 | pt_loss: 1.3473 | pg_loss: 1.3801 | reg_loss: 0.3514 | reward: -0.3377 | rev_kl: 1.0413 | stu_lens: 15.5000 | mixed_lens: 14.0000 | lr: 1.8863e-07 | scale: 1024.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    894/  1000| tot_loss: 2.8176 | rl_loss: 1.0457 | pt_loss: 1.7719 | pg_loss: 0.0366 | reg_loss: 1.0091 | reward: -0.1773 | rev_kl: 0.6801 | stu_lens: 92.0000 | mixed_lens: 123.5000 | lr: 1.8532e-07 | scale: 1024.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    895/  1000| tot_loss: 2.5918 | rl_loss: 0.9352 | pt_loss: 1.6566 | pg_loss: 0.5206 | reg_loss: 0.4146 | reward: -0.2401 | rev_kl: 0.7378 | stu_lens: 34.0000 | mixed_lens: 78.0000 | lr: 1.8204e-07 | scale: 1024.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    896/  1000| tot_loss: 3.4993 | rl_loss: 1.5671 | pt_loss: 1.9322 | pg_loss: 0.5560 | reg_loss: 1.0112 | reward: -0.4779 | rev_kl: 0.7619 | stu_lens: 58.5000 | mixed_lens: 47.0000 | lr: 1.7879e-07 | scale: 1024.00 | time: 26.253 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    896/  1000| tot_loss: 2.9196 | rl_loss: 1.1928 | pt_loss: 1.7267 | pg_loss: 0.4678 | reg_loss: 0.7250 | reward: -0.4074 | rev_kl: 0.9520 | stu_lens: 77.1250 | mixed_lens: 77.0938 | lr: 1.7879e-07 | scale: 1024.00 | time: 26.253 | step time: 27.500
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    897/  1000| tot_loss: 2.9458 | rl_loss: 1.4462 | pt_loss: 1.4996 | pg_loss: 1.2443 | reg_loss: 0.2019 | reward: -0.2050 | rev_kl: 0.1992 | stu_lens: 13.0000 | mixed_lens: 13.0000 | lr: 1.7556e-07 | scale: 1024.00 | time: 26.329 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    898/  1000| tot_loss: 3.1451 | rl_loss: 1.5992 | pt_loss: 1.5459 | pg_loss: 0.3217 | reg_loss: 1.2775 | reward: -0.2158 | rev_kl: 0.2604 | stu_lens: 84.5000 | mixed_lens: 85.5000 | lr: 1.7236e-07 | scale: 1024.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    899/  1000| tot_loss: 3.7094 | rl_loss: 2.0013 | pt_loss: 1.7081 | pg_loss: 0.6693 | reg_loss: 1.3320 | reward: -0.4261 | rev_kl: 0.8557 | stu_lens: 77.0000 | mixed_lens: 70.0000 | lr: 1.6919e-07 | scale: 1024.00 | time: 26.262 | step time: 0.000
                                 Evaluation #9                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ That's a great attitude! If you're   │
│                                       │ looking for a new project, you       │
│                                       │ should check out our collection of   │
│                                       │ open source projects. We have a lot  │
│                                       │ of great projects that you can use   │
│                                       │ as a starting point for your own     │
│                                       │ work. If you have any questions      │
│                                       │ about our projects, you can contact  │
│                                       │ us at hello@octodev.com.             │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ That's what innovation is all about. │
│                                       │ It's about creating something new.   │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ You can create something new by      │
│                                       │ combining two or more existing       │
│                                       │ things. For example, you can combine │
│                                       │ a car and a boat to create a         │
│                                       │ motorboat.                           │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 15.936 | exact_match: 0.000 | rev_kl: 1.002 | lens: 84.738 | pt_loss: 1.094 | lm_loss: 1.185 | kd_loss: 1.002 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    900/  1000| tot_loss: 3.0365 | rl_loss: 1.1044 | pt_loss: 1.9321 | pg_loss: 0.0469 | reg_loss: 1.0575 | reward: -0.3076 | rev_kl: 1.3523 | stu_lens: 106.5000 | mixed_lens: 128.0000 | lr: 1.6605e-07 | scale: 1024.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    901/  1000| tot_loss: 3.5522 | rl_loss: 1.5985 | pt_loss: 1.9537 | pg_loss: 0.3724 | reg_loss: 1.2261 | reward: -0.1760 | rev_kl: 1.0889 | stu_lens: 100.5000 | mixed_lens: 93.0000 | lr: 1.6294e-07 | scale: 1024.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    902/  1000| tot_loss: 3.3945 | rl_loss: 1.5160 | pt_loss: 1.8785 | pg_loss: 0.1989 | reg_loss: 1.3171 | reward: -0.3566 | rev_kl: 0.9439 | stu_lens: 108.0000 | mixed_lens: 105.5000 | lr: 1.5985e-07 | scale: 1024.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    903/  1000| tot_loss: 3.1612 | rl_loss: 1.7426 | pt_loss: 1.4186 | pg_loss: 0.8849 | reg_loss: 0.8577 | reward: -0.3925 | rev_kl: 0.9099 | stu_lens: 69.5000 | mixed_lens: 49.0000 | lr: 1.5680e-07 | scale: 1024.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    904/  1000| tot_loss: 2.9661 | rl_loss: 1.2861 | pt_loss: 1.6800 | pg_loss: 0.3508 | reg_loss: 0.9353 | reward: -0.2937 | rev_kl: 0.8788 | stu_lens: 58.0000 | mixed_lens: 76.0000 | lr: 1.5377e-07 | scale: 1024.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    905/  1000| tot_loss: 2.8527 | rl_loss: 1.2709 | pt_loss: 1.5819 | pg_loss: 0.4327 | reg_loss: 0.8382 | reward: -0.3186 | rev_kl: 0.5240 | stu_lens: 68.5000 | mixed_lens: 68.5000 | lr: 1.5077e-07 | scale: 1024.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    906/  1000| tot_loss: 3.7565 | rl_loss: 1.7507 | pt_loss: 2.0059 | pg_loss: 0.2966 | reg_loss: 1.4541 | reward: -0.5059 | rev_kl: 1.4466 | stu_lens: 104.0000 | mixed_lens: 101.0000 | lr: 1.4780e-07 | scale: 1024.00 | time: 26.379 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    907/  1000| tot_loss: 3.2462 | rl_loss: 1.4165 | pt_loss: 1.8297 | pg_loss: 0.5367 | reg_loss: 0.8797 | reward: -0.3409 | rev_kl: 1.1435 | stu_lens: 9.5000 | mixed_lens: 68.0000 | lr: 1.4486e-07 | scale: 1024.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    908/  1000| tot_loss: 3.0918 | rl_loss: 1.2112 | pt_loss: 1.8806 | pg_loss: 0.4183 | reg_loss: 0.7929 | reward: -0.3220 | rev_kl: 1.0710 | stu_lens: 114.5000 | mixed_lens: 84.5000 | lr: 1.4194e-07 | scale: 1024.00 | time: 26.384 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    909/  1000| tot_loss: 3.2212 | rl_loss: 1.5468 | pt_loss: 1.6743 | pg_loss: 0.4381 | reg_loss: 1.1087 | reward: -2.3441 | rev_kl: 1.4606 | stu_lens: 51.0000 | mixed_lens: 42.0000 | lr: 1.3906e-07 | scale: 1024.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    910/  1000| tot_loss: 4.8974 | rl_loss: 3.0949 | pt_loss: 1.8025 | pg_loss: 2.2516 | reg_loss: 0.8433 | reward: -1.0255 | rev_kl: 0.3682 | stu_lens: 20.5000 | mixed_lens: 15.5000 | lr: 1.3620e-07 | scale: 1024.00 | time: 26.382 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    911/  1000| tot_loss: 2.5378 | rl_loss: 1.1053 | pt_loss: 1.4325 | pg_loss: 0.0432 | reg_loss: 1.0621 | reward: -0.2074 | rev_kl: 0.9282 | stu_lens: 115.5000 | mixed_lens: 128.0000 | lr: 1.3338e-07 | scale: 1024.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    912/  1000| tot_loss: 3.6760 | rl_loss: 1.9236 | pt_loss: 1.7524 | pg_loss: 0.5932 | reg_loss: 1.3303 | reward: -0.6735 | rev_kl: 0.9431 | stu_lens: 82.0000 | mixed_lens: 59.5000 | lr: 1.3058e-07 | scale: 1024.00 | time: 26.298 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    912/  1000| tot_loss: 3.1927 | rl_loss: 1.4672 | pt_loss: 1.7255 | pg_loss: 0.4457 | reg_loss: 1.0215 | reward: -0.5123 | rev_kl: 0.9323 | stu_lens: 76.3438 | mixed_lens: 77.9688 | lr: 1.3058e-07 | scale: 1024.00 | time: 26.298 | step time: 27.537
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    913/  1000| tot_loss: 3.6149 | rl_loss: 1.8713 | pt_loss: 1.7437 | pg_loss: 1.0498 | reg_loss: 0.8215 | reward: -0.3565 | rev_kl: 0.7715 | stu_lens: 66.5000 | mixed_lens: 48.0000 | lr: 1.2781e-07 | scale: 1024.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    914/  1000| tot_loss: 2.7184 | rl_loss: 0.9212 | pt_loss: 1.7971 | pg_loss: 0.0638 | reg_loss: 0.8575 | reward: -0.0932 | rev_kl: 0.2757 | stu_lens: 97.5000 | mixed_lens: 124.0000 | lr: 1.2507e-07 | scale: 1024.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    915/  1000| tot_loss: 3.2141 | rl_loss: 1.3533 | pt_loss: 1.8609 | pg_loss: 0.4995 | reg_loss: 0.8537 | reward: -0.6937 | rev_kl: 0.8203 | stu_lens: 24.5000 | mixed_lens: 36.5000 | lr: 1.2236e-07 | scale: 1024.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    916/  1000| tot_loss: 3.3218 | rl_loss: 1.3106 | pt_loss: 2.0112 | pg_loss: 0.3142 | reg_loss: 0.9965 | reward: -1.1958 | rev_kl: 0.5603 | stu_lens: 69.0000 | mixed_lens: 70.5000 | lr: 1.1968e-07 | scale: 1024.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    917/  1000| tot_loss: 2.9239 | rl_loss: 1.2406 | pt_loss: 1.6833 | pg_loss: 0.4095 | reg_loss: 0.8312 | reward: -0.4010 | rev_kl: 0.8936 | stu_lens: 66.5000 | mixed_lens: 67.5000 | lr: 1.1702e-07 | scale: 1024.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    918/  1000| tot_loss: 3.1255 | rl_loss: 1.1684 | pt_loss: 1.9571 | pg_loss: 0.2491 | reg_loss: 0.9193 | reward: -1.9721 | rev_kl: 1.0521 | stu_lens: 66.0000 | mixed_lens: 66.0000 | lr: 1.1440e-07 | scale: 1024.00 | time: 26.350 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    919/  1000| tot_loss: 2.5249 | rl_loss: 0.9414 | pt_loss: 1.5835 | pg_loss: 0.0995 | reg_loss: 0.8418 | reward: -0.3323 | rev_kl: 0.8534 | stu_lens: 128.0000 | mixed_lens: 108.5000 | lr: 1.1180e-07 | scale: 1024.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    920/  1000| tot_loss: 2.3258 | rl_loss: 0.7965 | pt_loss: 1.5292 | pg_loss: 0.0872 | reg_loss: 0.7094 | reward: -0.2555 | rev_kl: 0.8818 | stu_lens: 84.0000 | mixed_lens: 115.0000 | lr: 1.0924e-07 | scale: 1024.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    921/  1000| tot_loss: 4.2187 | rl_loss: 2.4944 | pt_loss: 1.7244 | pg_loss: 1.3336 | reg_loss: 1.1608 | reward: -1.5027 | rev_kl: 0.9725 | stu_lens: 25.5000 | mixed_lens: 15.5000 | lr: 1.0670e-07 | scale: 1024.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    922/  1000| tot_loss: 2.8902 | rl_loss: 1.4568 | pt_loss: 1.4334 | pg_loss: 0.1346 | reg_loss: 1.3222 | reward: -0.0695 | rev_kl: 1.0331 | stu_lens: 80.5000 | mixed_lens: 96.5000 | lr: 1.0419e-07 | scale: 1024.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    923/  1000| tot_loss: 3.4181 | rl_loss: 1.3315 | pt_loss: 2.0866 | pg_loss: 0.0684 | reg_loss: 1.2631 | reward: -0.2518 | rev_kl: 0.8791 | stu_lens: 128.0000 | mixed_lens: 118.5000 | lr: 1.0172e-07 | scale: 1024.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    924/  1000| tot_loss: 4.0492 | rl_loss: 1.8459 | pt_loss: 2.2033 | pg_loss: 0.6223 | reg_loss: 1.2236 | reward: -0.3920 | rev_kl: 1.1245 | stu_lens: 106.0000 | mixed_lens: 67.5000 | lr: 9.9266e-08 | scale: 1024.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    925/  1000| tot_loss: 2.9486 | rl_loss: 1.2537 | pt_loss: 1.6949 | pg_loss: 0.4055 | reg_loss: 0.8481 | reward: -0.2647 | rev_kl: 1.5893 | stu_lens: 56.0000 | mixed_lens: 84.5000 | lr: 9.6846e-08 | scale: 1024.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    926/  1000| tot_loss: 4.4429 | rl_loss: 2.5239 | pt_loss: 1.9191 | pg_loss: 1.5680 | reg_loss: 0.9559 | reward: -0.4779 | rev_kl: 0.3030 | stu_lens: 17.5000 | mixed_lens: 26.0000 | lr: 9.4455e-08 | scale: 1024.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    927/  1000| tot_loss: 1.9670 | rl_loss: 0.7399 | pt_loss: 1.2272 | pg_loss: 0.1921 | reg_loss: 0.5477 | reward: -0.3003 | rev_kl: 0.8473 | stu_lens: 76.5000 | mixed_lens: 94.0000 | lr: 9.2094e-08 | scale: 1024.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    928/  1000| tot_loss: 2.7953 | rl_loss: 1.2602 | pt_loss: 1.5351 | pg_loss: 0.4715 | reg_loss: 0.7888 | reward: -0.4134 | rev_kl: 0.7031 | stu_lens: 46.5000 | mixed_lens: 68.0000 | lr: 8.9761e-08 | scale: 1024.00 | time: 26.366 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    928/  1000| tot_loss: 3.1271 | rl_loss: 1.4737 | pt_loss: 1.6535 | pg_loss: 0.4366 | reg_loss: 1.0370 | reward: -0.4978 | rev_kl: 0.9266 | stu_lens: 75.8906 | mixed_lens: 76.1875 | lr: 8.9761e-08 | scale: 1024.00 | time: 26.366 | step time: 27.514
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    929/  1000| tot_loss: 2.9035 | rl_loss: 1.0130 | pt_loss: 1.8905 | pg_loss: 0.1563 | reg_loss: 0.8567 | reward: -0.5748 | rev_kl: 1.2282 | stu_lens: 86.0000 | mixed_lens: 104.0000 | lr: 8.7459e-08 | scale: 1024.00 | time: 26.320 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    930/  1000| tot_loss: 2.9064 | rl_loss: 1.6309 | pt_loss: 1.2755 | pg_loss: 0.3167 | reg_loss: 1.3142 | reward: -0.2095 | rev_kl: 0.6519 | stu_lens: 72.0000 | mixed_lens: 85.5000 | lr: 8.5185e-08 | scale: 1024.00 | time: 26.354 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    931/  1000| tot_loss: 2.8557 | rl_loss: 1.0688 | pt_loss: 1.7869 | pg_loss: 0.1966 | reg_loss: 0.8722 | reward: -0.1929 | rev_kl: 1.0307 | stu_lens: 128.0000 | mixed_lens: 88.5000 | lr: 8.2942e-08 | scale: 1024.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    932/  1000| tot_loss: 2.6597 | rl_loss: 1.0690 | pt_loss: 1.5906 | pg_loss: 0.0983 | reg_loss: 0.9707 | reward: -0.3771 | rev_kl: 0.9020 | stu_lens: 128.0000 | mixed_lens: 108.5000 | lr: 8.0727e-08 | scale: 1024.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    933/  1000| tot_loss: 4.2126 | rl_loss: 2.7239 | pt_loss: 1.4887 | pg_loss: 0.9623 | reg_loss: 1.7616 | reward: -1.2059 | rev_kl: 1.6182 | stu_lens: 69.5000 | mixed_lens: 55.0000 | lr: 7.8542e-08 | scale: 1024.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    934/  1000| tot_loss: 3.1684 | rl_loss: 1.0520 | pt_loss: 2.1163 | pg_loss: 0.0237 | reg_loss: 1.0284 | reward: -0.1733 | rev_kl: 0.7783 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 7.6387e-08 | scale: 1024.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    935/  1000| tot_loss: 3.1607 | rl_loss: 1.2396 | pt_loss: 1.9212 | pg_loss: 0.3354 | reg_loss: 0.9041 | reward: -0.1232 | rev_kl: 0.6711 | stu_lens: 100.0000 | mixed_lens: 96.5000 | lr: 7.4261e-08 | scale: 1024.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    936/  1000| tot_loss: 2.6576 | rl_loss: 0.9324 | pt_loss: 1.7252 | pg_loss: 0.1285 | reg_loss: 0.8039 | reward: -0.2998 | rev_kl: 1.0619 | stu_lens: 113.0000 | mixed_lens: 112.5000 | lr: 7.2164e-08 | scale: 1024.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    937/  1000| tot_loss: 3.4261 | rl_loss: 1.5915 | pt_loss: 1.8346 | pg_loss: 0.2627 | reg_loss: 1.3288 | reward: -0.5059 | rev_kl: 1.4466 | stu_lens: 104.0000 | mixed_lens: 101.0000 | lr: 7.0097e-08 | scale: 1024.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    938/  1000| tot_loss: 2.5362 | rl_loss: 1.0110 | pt_loss: 1.5251 | pg_loss: 0.1879 | reg_loss: 0.8231 | reward: -0.1264 | rev_kl: 0.5758 | stu_lens: 128.0000 | mixed_lens: 108.5000 | lr: 6.8060e-08 | scale: 1024.00 | time: 26.336 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    939/  1000| tot_loss: 2.8077 | rl_loss: 1.1488 | pt_loss: 1.6589 | pg_loss: 0.5739 | reg_loss: 0.5749 | reward: -0.1837 | rev_kl: 0.7066 | stu_lens: 53.5000 | mixed_lens: 62.5000 | lr: 6.6053e-08 | scale: 1024.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    940/  1000| tot_loss: 2.8432 | rl_loss: 1.3372 | pt_loss: 1.5060 | pg_loss: 0.4467 | reg_loss: 0.8905 | reward: -0.3422 | rev_kl: 1.0015 | stu_lens: 66.5000 | mixed_lens: 67.5000 | lr: 6.4075e-08 | scale: 1024.00 | time: 26.348 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    941/  1000| tot_loss: 2.7299 | rl_loss: 1.1009 | pt_loss: 1.6290 | pg_loss: -0.0096 | reg_loss: 1.1105 | reward: -0.2730 | rev_kl: 1.1837 | stu_lens: 108.5000 | mixed_lens: 128.0000 | lr: 6.2127e-08 | scale: 1024.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    942/  1000| tot_loss: 2.7656 | rl_loss: 1.0943 | pt_loss: 1.6714 | pg_loss: 0.3153 | reg_loss: 0.7790 | reward: -0.5348 | rev_kl: 0.6053 | stu_lens: 72.0000 | mixed_lens: 74.0000 | lr: 6.0208e-08 | scale: 1024.00 | time: 26.379 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    943/  1000| tot_loss: 2.3500 | rl_loss: 0.9001 | pt_loss: 1.4499 | pg_loss: 0.0792 | reg_loss: 0.8209 | reward: -0.1901 | rev_kl: 0.8536 | stu_lens: 84.0000 | mixed_lens: 115.0000 | lr: 5.8319e-08 | scale: 1024.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    944/  1000| tot_loss: 3.5786 | rl_loss: 1.4913 | pt_loss: 2.0873 | pg_loss: 0.6215 | reg_loss: 0.8698 | reward: -0.2975 | rev_kl: 0.8424 | stu_lens: 38.5000 | mixed_lens: 58.0000 | lr: 5.6460e-08 | scale: 1024.00 | time: 26.309 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    944/  1000| tot_loss: 3.0705 | rl_loss: 1.3514 | pt_loss: 1.7192 | pg_loss: 0.3762 | reg_loss: 0.9752 | reward: -0.5072 | rev_kl: 0.9698 | stu_lens: 78.9688 | mixed_lens: 80.4688 | lr: 5.6460e-08 | scale: 1024.00 | time: 26.309 | step time: 27.532
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    945/  1000| tot_loss: 2.7552 | rl_loss: 1.4337 | pt_loss: 1.3215 | pg_loss: 0.5936 | reg_loss: 0.8401 | reward: -0.3205 | rev_kl: 0.4504 | stu_lens: 43.5000 | mixed_lens: 66.5000 | lr: 5.4631e-08 | scale: 1024.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    946/  1000| tot_loss: 3.4746 | rl_loss: 1.4309 | pt_loss: 2.0437 | pg_loss: 0.3325 | reg_loss: 1.0984 | reward: -0.1760 | rev_kl: 1.0889 | stu_lens: 100.5000 | mixed_lens: 93.0000 | lr: 5.2832e-08 | scale: 1024.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    947/  1000| tot_loss: 2.4458 | rl_loss: 1.1226 | pt_loss: 1.3232 | pg_loss: 0.2383 | reg_loss: 0.8842 | reward: -0.2369 | rev_kl: 0.6754 | stu_lens: 98.5000 | mixed_lens: 90.5000 | lr: 5.1062e-08 | scale: 1024.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    948/  1000| tot_loss: 3.2089 | rl_loss: 1.3643 | pt_loss: 1.8445 | pg_loss: 0.3149 | reg_loss: 1.0495 | reward: -0.8687 | rev_kl: 1.0437 | stu_lens: 49.0000 | mixed_lens: 72.5000 | lr: 4.9322e-08 | scale: 1024.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    949/  1000| tot_loss: 2.9498 | rl_loss: 1.1528 | pt_loss: 1.7970 | pg_loss: 0.0343 | reg_loss: 1.1185 | reward: -0.4268 | rev_kl: 1.2892 | stu_lens: 104.0000 | mixed_lens: 128.0000 | lr: 4.7612e-08 | scale: 1024.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    950/  1000| tot_loss: 3.1674 | rl_loss: 1.2153 | pt_loss: 1.9521 | pg_loss: 0.3838 | reg_loss: 0.8315 | reward: -0.2591 | rev_kl: 0.4485 | stu_lens: 68.5000 | mixed_lens: 68.5000 | lr: 4.5932e-08 | scale: 1024.00 | time: 26.345 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    951/  1000| tot_loss: 3.8659 | rl_loss: 2.3227 | pt_loss: 1.5431 | pg_loss: 1.4559 | reg_loss: 0.8668 | reward: -1.4616 | rev_kl: 0.6984 | stu_lens: 42.0000 | mixed_lens: 25.0000 | lr: 4.4282e-08 | scale: 1024.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    952/  1000| tot_loss: 2.1240 | rl_loss: 0.5640 | pt_loss: 1.5601 | pg_loss: 0.0429 | reg_loss: 0.5211 | reward: -0.2673 | rev_kl: 0.7514 | stu_lens: 97.5000 | mixed_lens: 124.0000 | lr: 4.2662e-08 | scale: 1024.00 | time: 26.382 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    953/  1000| tot_loss: 2.9076 | rl_loss: 1.2422 | pt_loss: 1.6654 | pg_loss: 0.1478 | reg_loss: 1.0944 | reward: -0.2721 | rev_kl: 0.5986 | stu_lens: 108.0000 | mixed_lens: 105.5000 | lr: 4.1071e-08 | scale: 1024.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    954/  1000| tot_loss: 3.7561 | rl_loss: 1.9772 | pt_loss: 1.7789 | pg_loss: 1.1438 | reg_loss: 0.8334 | reward: -0.7660 | rev_kl: 0.4875 | stu_lens: 31.0000 | mixed_lens: 31.5000 | lr: 3.9511e-08 | scale: 1024.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    955/  1000| tot_loss: 3.0608 | rl_loss: 1.0881 | pt_loss: 1.9727 | pg_loss: 0.1419 | reg_loss: 0.9462 | reward: -0.3093 | rev_kl: 1.1928 | stu_lens: 106.5000 | mixed_lens: 112.5000 | lr: 3.7981e-08 | scale: 1024.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    956/  1000| tot_loss: 3.3314 | rl_loss: 1.9471 | pt_loss: 1.3843 | pg_loss: 1.3001 | reg_loss: 0.6470 | reward: 0.0284 | rev_kl: 0.9820 | stu_lens: 26.0000 | mixed_lens: 23.5000 | lr: 3.6480e-08 | scale: 1024.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    957/  1000| tot_loss: 3.0369 | rl_loss: 1.6483 | pt_loss: 1.3886 | pg_loss: 0.4145 | reg_loss: 1.2337 | reward: -0.7030 | rev_kl: 1.8045 | stu_lens: 54.0000 | mixed_lens: 58.5000 | lr: 3.5010e-08 | scale: 1024.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    958/  1000| tot_loss: 3.1580 | rl_loss: 1.3287 | pt_loss: 1.8293 | pg_loss: 0.1221 | reg_loss: 1.2066 | reward: -0.4540 | rev_kl: 1.4282 | stu_lens: 97.5000 | mixed_lens: 97.5000 | lr: 3.3570e-08 | scale: 1024.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    959/  1000| tot_loss: 3.7731 | rl_loss: 1.9225 | pt_loss: 1.8506 | pg_loss: 0.5541 | reg_loss: 1.3684 | reward: -0.8528 | rev_kl: 0.8082 | stu_lens: 55.5000 | mixed_lens: 68.0000 | lr: 3.2159e-08 | scale: 1024.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    960/  1000| tot_loss: 3.9151 | rl_loss: 0.9606 | pt_loss: 2.9544 | pg_loss: 0.0056 | reg_loss: 0.9550 | reward: -0.2649 | rev_kl: 0.9756 | stu_lens: 101.0000 | mixed_lens: 128.0000 | lr: 3.0779e-08 | scale: 1024.00 | time: 26.360 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    960/  1000| tot_loss: 3.1331 | rl_loss: 1.3600 | pt_loss: 1.7731 | pg_loss: 0.4005 | reg_loss: 0.9596 | reward: -0.5154 | rev_kl: 0.9137 | stu_lens: 81.0312 | mixed_lens: 79.4531 | lr: 3.0779e-08 | scale: 1024.00 | time: 26.360 | step time: 27.521
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    961/  1000| tot_loss: 2.0490 | rl_loss: 1.3692 | pt_loss: 0.6798 | pg_loss: 0.7027 | reg_loss: 0.6665 | reward: -0.2821 | rev_kl: 0.8265 | stu_lens: 30.0000 | mixed_lens: 44.5000 | lr: 2.9429e-08 | scale: 1024.00 | time: 26.317 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    962/  1000| tot_loss: 4.1926 | rl_loss: 2.3845 | pt_loss: 1.8081 | pg_loss: 0.9981 | reg_loss: 1.3864 | reward: 0.0468 | rev_kl: 0.9748 | stu_lens: 97.0000 | mixed_lens: 45.5000 | lr: 2.8109e-08 | scale: 1024.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    963/  1000| tot_loss: 3.7088 | rl_loss: 2.3951 | pt_loss: 1.3137 | pg_loss: 0.5154 | reg_loss: 1.8797 | reward: -2.6603 | rev_kl: 1.2075 | stu_lens: 66.0000 | mixed_lens: 66.5000 | lr: 2.6819e-08 | scale: 1024.00 | time: 26.359 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    964/  1000| tot_loss: 2.6771 | rl_loss: 1.3284 | pt_loss: 1.3486 | pg_loss: 0.4684 | reg_loss: 0.8600 | reward: -0.9681 | rev_kl: 1.2348 | stu_lens: 69.5000 | mixed_lens: 69.5000 | lr: 2.5559e-08 | scale: 1024.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    965/  1000| tot_loss: 2.7608 | rl_loss: 1.0615 | pt_loss: 1.6993 | pg_loss: 0.3076 | reg_loss: 0.7539 | reward: -0.0715 | rev_kl: 0.8560 | stu_lens: 95.0000 | mixed_lens: 81.5000 | lr: 2.4330e-08 | scale: 1024.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    966/  1000| tot_loss: 3.5748 | rl_loss: 1.3627 | pt_loss: 2.2121 | pg_loss: 0.1516 | reg_loss: 1.2112 | reward: -0.2283 | rev_kl: 0.7864 | stu_lens: 106.5000 | mixed_lens: 110.5000 | lr: 2.3130e-08 | scale: 1024.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    967/  1000| tot_loss: 3.7973 | rl_loss: 2.4200 | pt_loss: 1.3773 | pg_loss: 0.8797 | reg_loss: 1.5403 | reward: -0.4780 | rev_kl: 0.7866 | stu_lens: 73.0000 | mixed_lens: 54.5000 | lr: 2.1961e-08 | scale: 1024.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    968/  1000| tot_loss: 3.3092 | rl_loss: 1.3439 | pt_loss: 1.9653 | pg_loss: 0.3477 | reg_loss: 0.9962 | reward: -0.2454 | rev_kl: 0.7875 | stu_lens: 69.5000 | mixed_lens: 89.0000 | lr: 2.0822e-08 | scale: 1024.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    969/  1000| tot_loss: 3.1422 | rl_loss: 1.2034 | pt_loss: 1.9388 | pg_loss: 0.0770 | reg_loss: 1.1264 | reward: -0.1475 | rev_kl: 1.0351 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.9713e-08 | scale: 1024.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    970/  1000| tot_loss: 1.9545 | rl_loss: 0.6913 | pt_loss: 1.2631 | pg_loss: 0.2050 | reg_loss: 0.4864 | reward: -0.1466 | rev_kl: 1.4376 | stu_lens: 73.0000 | mixed_lens: 78.0000 | lr: 1.8635e-08 | scale: 1024.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    971/  1000| tot_loss: 3.5413 | rl_loss: 1.8170 | pt_loss: 1.7243 | pg_loss: 0.2017 | reg_loss: 1.6153 | reward: -0.4063 | rev_kl: 1.4599 | stu_lens: 101.0000 | mixed_lens: 110.0000 | lr: 1.7586e-08 | scale: 1024.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    972/  1000| tot_loss: 2.8521 | rl_loss: 1.0492 | pt_loss: 1.8029 | pg_loss: 0.2314 | reg_loss: 0.8178 | reward: -0.2026 | rev_kl: 0.5559 | stu_lens: 128.0000 | mixed_lens: 105.0000 | lr: 1.6568e-08 | scale: 1024.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    973/  1000| tot_loss: 2.7377 | rl_loss: 1.0651 | pt_loss: 1.6726 | pg_loss: 0.2916 | reg_loss: 0.7735 | reward: -0.3337 | rev_kl: 0.7328 | stu_lens: 69.0000 | mixed_lens: 68.0000 | lr: 1.5580e-08 | scale: 1024.00 | time: 26.327 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    974/  1000| tot_loss: 4.4373 | rl_loss: 2.0787 | pt_loss: 2.3586 | pg_loss: 1.2283 | reg_loss: 0.8504 | reward: -0.7919 | rev_kl: 0.8619 | stu_lens: 69.5000 | mixed_lens: 30.0000 | lr: 1.4623e-08 | scale: 1024.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    975/  1000| tot_loss: 2.2265 | rl_loss: 1.0181 | pt_loss: 1.2084 | pg_loss: 0.0824 | reg_loss: 0.9357 | reward: -0.4123 | rev_kl: 0.7728 | stu_lens: 56.0000 | mixed_lens: 86.5000 | lr: 1.3695e-08 | scale: 1024.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    976/  1000| tot_loss: 3.1558 | rl_loss: 1.5021 | pt_loss: 1.6537 | pg_loss: 0.6389 | reg_loss: 0.8632 | reward: -0.6943 | rev_kl: 0.3792 | stu_lens: 67.0000 | mixed_lens: 66.5000 | lr: 1.2798e-08 | scale: 1024.00 | time: 26.251 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    976/  1000| tot_loss: 3.2421 | rl_loss: 1.5524 | pt_loss: 1.6897 | pg_loss: 0.4787 | reg_loss: 1.0738 | reward: -0.4777 | rev_kl: 1.0173 | stu_lens: 79.1875 | mixed_lens: 82.1250 | lr: 1.2798e-08 | scale: 1024.00 | time: 26.251 | step time: 27.519
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    977/  1000| tot_loss: 2.6982 | rl_loss: 0.8193 | pt_loss: 1.8790 | pg_loss: 0.2501 | reg_loss: 0.5691 | reward: -1.1934 | rev_kl: 0.7730 | stu_lens: 70.0000 | mixed_lens: 70.0000 | lr: 1.1932e-08 | scale: 1024.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    978/  1000| tot_loss: 2.5831 | rl_loss: 0.7134 | pt_loss: 1.8697 | pg_loss: 0.0769 | reg_loss: 0.6365 | reward: -0.1754 | rev_kl: 1.3037 | stu_lens: 54.5000 | mixed_lens: 118.0000 | lr: 1.1095e-08 | scale: 1024.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    979/  1000| tot_loss: 4.0342 | rl_loss: 2.1328 | pt_loss: 1.9013 | pg_loss: 0.6406 | reg_loss: 1.4922 | reward: -0.7138 | rev_kl: 0.9342 | stu_lens: 54.5000 | mixed_lens: 66.5000 | lr: 1.0289e-08 | scale: 1024.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    980/  1000| tot_loss: 4.3727 | rl_loss: 2.0887 | pt_loss: 2.2840 | pg_loss: 0.8178 | reg_loss: 1.2709 | reward: -1.1656 | rev_kl: 1.9075 | stu_lens: 70.0000 | mixed_lens: 50.5000 | lr: 9.5133e-09 | scale: 1024.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    981/  1000| tot_loss: 2.9882 | rl_loss: 1.6484 | pt_loss: 1.3399 | pg_loss: 0.6995 | reg_loss: 0.9488 | reward: -1.6439 | rev_kl: 1.3483 | stu_lens: 71.5000 | mixed_lens: 33.0000 | lr: 8.7679e-09 | scale: 1024.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    982/  1000| tot_loss: 2.5675 | rl_loss: 1.3566 | pt_loss: 1.2109 | pg_loss: 0.2194 | reg_loss: 1.1373 | reward: -0.5196 | rev_kl: 0.9901 | stu_lens: 84.5000 | mixed_lens: 80.5000 | lr: 8.0528e-09 | scale: 1024.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    983/  1000| tot_loss: 2.6452 | rl_loss: 1.0835 | pt_loss: 1.5617 | pg_loss: 0.1140 | reg_loss: 0.9695 | reward: -0.2196 | rev_kl: 0.9905 | stu_lens: 109.5000 | mixed_lens: 120.5000 | lr: 7.3681e-09 | scale: 1024.00 | time: 26.363 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    984/  1000| tot_loss: 3.4247 | rl_loss: 1.7291 | pt_loss: 1.6957 | pg_loss: 0.1469 | reg_loss: 1.5822 | reward: -0.2721 | rev_kl: 1.0102 | stu_lens: 79.0000 | mixed_lens: 118.5000 | lr: 6.7138e-09 | scale: 1024.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    985/  1000| tot_loss: 3.5176 | rl_loss: 1.6110 | pt_loss: 1.9066 | pg_loss: 0.2722 | reg_loss: 1.3389 | reward: -0.2313 | rev_kl: 0.9196 | stu_lens: 89.5000 | mixed_lens: 97.0000 | lr: 6.0899e-09 | scale: 1024.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    986/  1000| tot_loss: 3.6795 | rl_loss: 2.1960 | pt_loss: 1.4835 | pg_loss: 0.7673 | reg_loss: 1.4287 | reward: -0.8878 | rev_kl: 1.0998 | stu_lens: 26.0000 | mixed_lens: 47.5000 | lr: 5.4963e-09 | scale: 1024.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    987/  1000| tot_loss: 2.8310 | rl_loss: 1.0897 | pt_loss: 1.7412 | pg_loss: 0.0541 | reg_loss: 1.0357 | reward: -0.2320 | rev_kl: 0.6767 | stu_lens: 126.5000 | mixed_lens: 128.0000 | lr: 4.9332e-09 | scale: 1024.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    988/  1000| tot_loss: 3.3412 | rl_loss: 1.9855 | pt_loss: 1.3557 | pg_loss: 0.3705 | reg_loss: 1.6150 | reward: -0.6461 | rev_kl: 1.1634 | stu_lens: 116.0000 | mixed_lens: 89.5000 | lr: 4.4004e-09 | scale: 1024.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    989/  1000| tot_loss: 5.0793 | rl_loss: 3.1132 | pt_loss: 1.9660 | pg_loss: 1.9349 | reg_loss: 1.1784 | reward: -3.0286 | rev_kl: 0.8041 | stu_lens: 15.5000 | mixed_lens: 14.5000 | lr: 3.8981e-09 | scale: 1024.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    990/  1000| tot_loss: 3.5154 | rl_loss: 1.5578 | pt_loss: 1.9576 | pg_loss: 0.1010 | reg_loss: 1.4568 | reward: -0.3125 | rev_kl: 1.5355 | stu_lens: 80.5000 | mixed_lens: 119.5000 | lr: 3.4262e-09 | scale: 1024.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    991/  1000| tot_loss: 2.6548 | rl_loss: 0.6640 | pt_loss: 1.9908 | pg_loss: 0.2598 | reg_loss: 0.4041 | reward: -0.1850 | rev_kl: 1.3200 | stu_lens: 64.0000 | mixed_lens: 76.0000 | lr: 2.9847e-09 | scale: 1024.00 | time: 26.329 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    992/  1000| tot_loss: 2.4869 | rl_loss: 0.9869 | pt_loss: 1.5000 | pg_loss: 0.1463 | reg_loss: 0.8406 | reward: -0.3699 | rev_kl: 1.1908 | stu_lens: 93.5000 | mixed_lens: 104.5000 | lr: 2.5736e-09 | scale: 1024.00 | time: 26.286 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    992/  1000| tot_loss: 3.2275 | rl_loss: 1.5046 | pt_loss: 1.7230 | pg_loss: 0.4119 | reg_loss: 1.0927 | reward: -0.5128 | rev_kl: 1.0117 | stu_lens: 82.7969 | mixed_lens: 84.6094 | lr: 2.5736e-09 | scale: 1024.00 | time: 26.286 | step time: 27.500
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    993/  1000| tot_loss: 3.4392 | rl_loss: 1.7250 | pt_loss: 1.7142 | pg_loss: 1.0115 | reg_loss: 0.7135 | reward: -1.2232 | rev_kl: 0.8768 | stu_lens: 51.5000 | mixed_lens: 22.5000 | lr: 2.1929e-09 | scale: 1024.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    994/  1000| tot_loss: 3.1912 | rl_loss: 1.0962 | pt_loss: 2.0950 | pg_loss: 0.0454 | reg_loss: 1.0508 | reward: -0.1683 | rev_kl: 0.9715 | stu_lens: 118.0000 | mixed_lens: 128.0000 | lr: 1.8427e-09 | scale: 1024.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    995/  1000| tot_loss: 1.8393 | rl_loss: 0.9262 | pt_loss: 0.9131 | pg_loss: 0.0692 | reg_loss: 0.8571 | reward: -0.0816 | rev_kl: 1.0020 | stu_lens: 128.0000 | mixed_lens: 127.5000 | lr: 1.5229e-09 | scale: 1024.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    996/  1000| tot_loss: 2.6403 | rl_loss: 1.4734 | pt_loss: 1.1668 | pg_loss: 0.7927 | reg_loss: 0.6808 | reward: -0.5002 | rev_kl: 0.7333 | stu_lens: 110.0000 | mixed_lens: 62.5000 | lr: 1.2336e-09 | scale: 1024.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    997/  1000| tot_loss: 3.9370 | rl_loss: 1.7795 | pt_loss: 2.1575 | pg_loss: 0.3996 | reg_loss: 1.3799 | reward: -1.1636 | rev_kl: 0.6801 | stu_lens: 70.5000 | mixed_lens: 72.0000 | lr: 9.7471e-10 | scale: 1024.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    998/  1000| tot_loss: 2.5738 | rl_loss: 0.9962 | pt_loss: 1.5776 | pg_loss: 0.0660 | reg_loss: 0.9302 | reward: -0.1417 | rev_kl: 0.8033 | stu_lens: 94.5000 | mixed_lens: 128.0000 | lr: 7.4628e-10 | scale: 1024.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    999/  1000| tot_loss: 3.6185 | rl_loss: 1.5051 | pt_loss: 2.1133 | pg_loss: 0.5306 | reg_loss: 0.9746 | reward: -0.6121 | rev_kl: 0.6965 | stu_lens: 41.5000 | mixed_lens: 74.5000 | lr: 5.4829e-10 | scale: 1024.00 | time: 26.272 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/1000
                                 Evaluation #10                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ That's why we have the concept of    │
│                                       │ intellectual property. You can       │
│                                       │ create something new and get paid    │
│                                       │ for it.                              │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ That's great! Here are some ideas to │
│                                       │ get you started.                     │
│                                       │                                      │
│                                       │ You can create a new language. For   │
│                                       │ example, you can create a language   │
│                                       │ that uses only numbers. You can also │
│                                       │ create a language that uses only     │
│                                       │ letters.                             │
│                                       │                                      │
│                                       │ You can also create a new alphabet.  │
│                                       │ For example, you can create an       │
│                                       │ alphabet that uses only circles.     │
│                                       │                                      │
│                                       │ Finally, you can create a new math   │
│                                       │ system. For example, you can create  │
│                                       │ a math system that uses only odd     │
│                                       │ numbers.                             │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ You should go to school and learn to │
│                                       │ be a programmer. Then you can create │
│                                       │ whatever you want.                   │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.046 | exact_match: 0.000 | rev_kl: 0.984 | lens: 84.011 | pt_loss: 1.093 | lm_loss: 1.185 | kd_loss: 1.002 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1000/  1000| tot_loss: 4.3708 | rl_loss: 2.6008 | pt_loss: 1.7700 | pg_loss: 1.4962 | reg_loss: 1.1047 | reward: -0.9641 | rev_kl: 0.9623 | stu_lens: 9.0000 | mixed_lens: 17.5000 | lr: 3.8076e-10 | scale: 1024.00 | time: 26.230 | step time: 0.000
Reached total steps 1000/1000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_both/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/1000
                                 Evaluation #11                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Okay, here is an example of how you  │
│                                       │ can use the Java API to create       │
│                                       │ something new.                       │
│                                       │                                      │
│                                       │ Imagine you want to create a new     │
│                                       │ kind of video game. You want to      │
│                                       │ create a game where you can          │
│                                       │                                      │
│                                       │ - walk around a virtual world        │
│                                       │ - talk to other players              │
│                                       │ - fight monsters                     │
│                                       │ - collect items                      │
│                                       │ - solve puzzles                      │
│                                       │ - complete quests                    │
│                                       │ - earn rewards                       │
│                                       │ - level up                           │
│                                       │ - customize your character           │
│                                       │ - use magic                          │
│                                       │ - fly on a broomstick                │
│                                       │ - use a sword                        │
│                                       │ - summon a dragon                    │
│                                       │ - cast a spell                       │
│                                       │ - breat                              │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ I'm not sure that's possible.        │
│                                       │ Everything that has been created has │
│                                       │ already been created. You can't      │
│                                       │ create something new without using   │
│                                       │ existing materials. For example, if  │
│                                       │ you want to create a painting, you   │
│                                       │ need to use paint. If you want to    │
│                                       │ create a song, you need to use a     │
│                                       │ guitar. If you want to create a      │
│                                       │ computer program, you need to use a  │
│                                       │ computer. You can't create something │
│                                       │ new without using existing           │
│                                       │ materials.                           │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ That sounds boring. I want to create  │ That sounds boring. I want to create │
│ something new.                        │ something new.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ That's great! You can create a new   │
│                                       │ class that extends the existing      │
│                                       │ class and override the method to add │
│                                       │ the functionality you want.          │
└───────────────────────────────────────┴──────────────────────────────────────┘
