Loaded module: cuda/12.1
/usr/lib64/python3.9/site-packages/scipy/__init__.py:138: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.26.2)
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion} is required for this version of "
/zhome/4e/b/208805/.local/lib/python3.9/site-packages/torch/cuda/__init__.py:173: UserWarning: 
NVIDIA H100 PCIe with CUDA capability sm_90 is not compatible with the current PyTorch installation.
The current PyTorch install supports CUDA capabilities sm_37 sm_50 sm_60 sm_70 sm_75 sm_80 sm_86.
If you want to use the NVIDIA H100 PCIe GPU with PyTorch, please check the instructions at https://pytorch.org/get-started/locally/

  warnings.warn(incompatible_device_warn.format(device_name, capability, " ".join(arch_list), device_name))
config.json:   0%|          | 0.00/693 [00:00<?, ?B/s]config.json: 100%|██████████| 693/693 [00:00<00:00, 359kB/s]
model.safetensors:   0%|          | 0.00/2.13G [00:00<?, ?B/s]model.safetensors:   0%|          | 10.5M/2.13G [00:00<00:28, 73.4MB/s]model.safetensors:   1%|▏         | 31.5M/2.13G [00:00<00:15, 136MB/s] model.safetensors:   2%|▏         | 52.4M/2.13G [00:00<00:12, 161MB/s]model.safetensors:   3%|▎         | 73.4M/2.13G [00:00<00:11, 174MB/s]model.safetensors:   4%|▍         | 94.4M/2.13G [00:00<00:11, 182MB/s]model.safetensors:   5%|▌         | 115M/2.13G [00:00<00:10, 187MB/s] model.safetensors:   6%|▋         | 136M/2.13G [00:00<00:10, 190MB/s]model.safetensors:   7%|▋         | 157M/2.13G [00:00<00:10, 191MB/s]model.safetensors:   8%|▊         | 178M/2.13G [00:01<00:10, 191MB/s]model.safetensors:   9%|▉         | 199M/2.13G [00:01<00:10, 193MB/s]model.safetensors:  10%|█         | 220M/2.13G [00:01<00:10, 190MB/s]model.safetensors:  11%|█▏        | 241M/2.13G [00:01<00:09, 191MB/s]model.safetensors:  12%|█▏        | 262M/2.13G [00:01<00:09, 192MB/s]model.safetensors:  13%|█▎        | 283M/2.13G [00:01<00:09, 193MB/s]model.safetensors:  14%|█▍        | 304M/2.13G [00:01<00:09, 193MB/s]model.safetensors:  15%|█▌        | 325M/2.13G [00:01<00:09, 193MB/s]model.safetensors:  16%|█▌        | 346M/2.13G [00:01<00:09, 194MB/s]model.safetensors:  17%|█▋        | 367M/2.13G [00:01<00:09, 194MB/s]model.safetensors:  18%|█▊        | 388M/2.13G [00:02<00:08, 195MB/s]model.safetensors:  19%|█▉        | 409M/2.13G [00:02<00:08, 195MB/s]model.safetensors:  20%|██        | 430M/2.13G [00:02<00:08, 195MB/s]model.safetensors:  21%|██        | 451M/2.13G [00:02<00:08, 195MB/s]model.safetensors:  22%|██▏       | 472M/2.13G [00:02<00:08, 195MB/s]model.safetensors:  23%|██▎       | 493M/2.13G [00:02<00:08, 191MB/s]model.safetensors:  24%|██▍       | 514M/2.13G [00:02<00:08, 192MB/s]model.safetensors:  25%|██▌       | 535M/2.13G [00:02<00:08, 193MB/s]model.safetensors:  26%|██▌       | 556M/2.13G [00:02<00:08, 194MB/s]model.safetensors:  27%|██▋       | 577M/2.13G [00:03<00:07, 194MB/s]model.safetensors:  28%|██▊       | 598M/2.13G [00:03<00:07, 195MB/s]model.safetensors:  29%|██▉       | 619M/2.13G [00:03<00:07, 195MB/s]model.safetensors:  30%|███       | 640M/2.13G [00:03<00:07, 195MB/s]model.safetensors:  31%|███       | 661M/2.13G [00:03<00:07, 196MB/s]model.safetensors:  32%|███▏      | 682M/2.13G [00:03<00:07, 196MB/s]model.safetensors:  33%|███▎      | 703M/2.13G [00:03<00:07, 196MB/s]model.safetensors:  34%|███▍      | 724M/2.13G [00:03<00:07, 196MB/s]model.safetensors:  35%|███▍      | 744M/2.13G [00:03<00:07, 196MB/s]model.safetensors:  36%|███▌      | 765M/2.13G [00:04<00:06, 197MB/s]model.safetensors:  37%|███▋      | 786M/2.13G [00:04<00:06, 197MB/s]model.safetensors:  38%|███▊      | 807M/2.13G [00:04<00:06, 196MB/s]model.safetensors:  39%|███▉      | 828M/2.13G [00:04<00:06, 196MB/s]model.safetensors:  40%|███▉      | 849M/2.13G [00:04<00:06, 196MB/s]model.safetensors:  41%|████      | 870M/2.13G [00:04<00:06, 196MB/s]model.safetensors:  42%|████▏     | 891M/2.13G [00:04<00:06, 195MB/s]model.safetensors:  43%|████▎     | 912M/2.13G [00:04<00:06, 195MB/s]model.safetensors:  44%|████▍     | 933M/2.13G [00:04<00:06, 195MB/s]model.safetensors:  45%|████▍     | 954M/2.13G [00:04<00:06, 196MB/s]model.safetensors:  46%|████▌     | 975M/2.13G [00:05<00:05, 196MB/s]model.safetensors:  47%|████▋     | 996M/2.13G [00:05<00:05, 196MB/s]model.safetensors:  48%|████▊     | 1.02G/2.13G [00:05<00:05, 196MB/s]model.safetensors:  49%|████▊     | 1.04G/2.13G [00:05<00:05, 196MB/s]model.safetensors:  50%|████▉     | 1.06G/2.13G [00:05<00:05, 196MB/s]model.safetensors:  51%|█████     | 1.08G/2.13G [00:05<00:05, 196MB/s]model.safetensors:  52%|█████▏    | 1.10G/2.13G [00:05<00:05, 196MB/s]model.safetensors:  53%|█████▎    | 1.12G/2.13G [00:05<00:05, 196MB/s]model.safetensors:  54%|█████▎    | 1.14G/2.13G [00:05<00:05, 196MB/s]model.safetensors:  55%|█████▍    | 1.16G/2.13G [00:06<00:04, 196MB/s]model.safetensors:  56%|█████▌    | 1.18G/2.13G [00:06<00:05, 184MB/s]model.safetensors:  57%|█████▋    | 1.21G/2.13G [00:06<00:04, 186MB/s]model.safetensors:  58%|█████▊    | 1.23G/2.13G [00:06<00:04, 187MB/s]model.safetensors:  59%|█████▊    | 1.25G/2.13G [00:06<00:04, 190MB/s]model.safetensors:  60%|█████▉    | 1.27G/2.13G [00:06<00:04, 190MB/s]model.safetensors:  61%|██████    | 1.29G/2.13G [00:06<00:04, 188MB/s]model.safetensors:  62%|██████▏   | 1.31G/2.13G [00:06<00:04, 190MB/s]model.safetensors:  63%|██████▎   | 1.33G/2.13G [00:06<00:04, 192MB/s]model.safetensors:  63%|██████▎   | 1.35G/2.13G [00:07<00:04, 193MB/s]model.safetensors:  64%|██████▍   | 1.37G/2.13G [00:07<00:03, 194MB/s]model.safetensors:  65%|██████▌   | 1.39G/2.13G [00:07<00:03, 194MB/s]model.safetensors:  66%|██████▋   | 1.42G/2.13G [00:07<00:03, 195MB/s]model.safetensors:  67%|██████▋   | 1.44G/2.13G [00:07<00:03, 194MB/s]model.safetensors:  68%|██████▊   | 1.46G/2.13G [00:07<00:03, 195MB/s]model.safetensors:  69%|██████▉   | 1.48G/2.13G [00:07<00:03, 195MB/s]model.safetensors:  70%|███████   | 1.50G/2.13G [00:07<00:03, 195MB/s]model.safetensors:  71%|███████▏  | 1.52G/2.13G [00:07<00:03, 196MB/s]model.safetensors:  72%|███████▏  | 1.54G/2.13G [00:08<00:03, 196MB/s]model.safetensors:  73%|███████▎  | 1.56G/2.13G [00:08<00:02, 197MB/s]model.safetensors:  74%|███████▍  | 1.58G/2.13G [00:08<00:02, 197MB/s]model.safetensors:  75%|███████▌  | 1.60G/2.13G [00:08<00:02, 197MB/s]model.safetensors:  76%|███████▋  | 1.63G/2.13G [00:08<00:02, 197MB/s]model.safetensors:  77%|███████▋  | 1.65G/2.13G [00:08<00:02, 196MB/s]model.safetensors:  78%|███████▊  | 1.67G/2.13G [00:08<00:02, 196MB/s]model.safetensors:  79%|███████▉  | 1.69G/2.13G [00:08<00:02, 196MB/s]model.safetensors:  80%|████████  | 1.71G/2.13G [00:08<00:02, 196MB/s]model.safetensors:  81%|████████  | 1.73G/2.13G [00:08<00:02, 196MB/s]model.safetensors:  82%|████████▏ | 1.75G/2.13G [00:09<00:01, 196MB/s]model.safetensors:  83%|████████▎ | 1.77G/2.13G [00:09<00:01, 196MB/s]model.safetensors:  84%|████████▍ | 1.79G/2.13G [00:09<00:01, 196MB/s]model.safetensors:  85%|████████▌ | 1.81G/2.13G [00:09<00:01, 197MB/s]model.safetensors:  86%|████████▌ | 1.84G/2.13G [00:09<00:01, 197MB/s]model.safetensors:  87%|████████▋ | 1.86G/2.13G [00:09<00:01, 197MB/s]model.safetensors:  88%|████████▊ | 1.88G/2.13G [00:09<00:01, 197MB/s]model.safetensors:  89%|████████▉ | 1.90G/2.13G [00:09<00:01, 196MB/s]model.safetensors:  90%|█████████ | 1.92G/2.13G [00:09<00:01, 196MB/s]model.safetensors:  91%|█████████ | 1.94G/2.13G [00:10<00:00, 196MB/s]model.safetensors:  92%|█████████▏| 1.96G/2.13G [00:10<00:00, 196MB/s]model.safetensors:  93%|█████████▎| 1.98G/2.13G [00:10<00:00, 196MB/s]model.safetensors:  94%|█████████▍| 2.00G/2.13G [00:10<00:00, 197MB/s]model.safetensors:  95%|█████████▍| 2.02G/2.13G [00:10<00:00, 197MB/s]model.safetensors:  96%|█████████▌| 2.04G/2.13G [00:10<00:00, 197MB/s]model.safetensors:  97%|█████████▋| 2.07G/2.13G [00:10<00:00, 197MB/s]model.safetensors:  98%|█████████▊| 2.09G/2.13G [00:10<00:00, 197MB/s]model.safetensors:  99%|█████████▉| 2.11G/2.13G [00:10<00:00, 197MB/s]model.safetensors: 100%|█████████▉| 2.13G/2.13G [00:11<00:00, 197MB/s]model.safetensors: 100%|██████████| 2.13G/2.13G [00:11<00:00, 193MB/s]
config.json:   0%|          | 0.00/693 [00:00<?, ?B/s]config.json: 100%|██████████| 693/693 [00:00<00:00, 1.39MB/s]
model.safetensors:   0%|          | 0.00/1.12G [00:00<?, ?B/s]model.safetensors:   2%|▏         | 21.0M/1.12G [00:00<00:05, 200MB/s]model.safetensors:   4%|▍         | 41.9M/1.12G [00:00<00:05, 199MB/s]model.safetensors:   6%|▌         | 62.9M/1.12G [00:00<00:05, 198MB/s]model.safetensors:   8%|▊         | 83.9M/1.12G [00:00<00:05, 197MB/s]model.safetensors:   9%|▉         | 105M/1.12G [00:00<00:05, 196MB/s] model.safetensors:  11%|█▏        | 126M/1.12G [00:00<00:05, 197MB/s]model.safetensors:  13%|█▎        | 147M/1.12G [00:00<00:04, 197MB/s]model.safetensors:  15%|█▌        | 168M/1.12G [00:00<00:04, 196MB/s]model.safetensors:  17%|█▋        | 189M/1.12G [00:00<00:04, 197MB/s]model.safetensors:  19%|█▉        | 210M/1.12G [00:01<00:04, 197MB/s]model.safetensors:  21%|██        | 231M/1.12G [00:01<00:04, 196MB/s]model.safetensors:  23%|██▎       | 252M/1.12G [00:01<00:04, 197MB/s]model.safetensors:  24%|██▍       | 273M/1.12G [00:01<00:04, 197MB/s]model.safetensors:  26%|██▋       | 294M/1.12G [00:01<00:04, 196MB/s]model.safetensors:  28%|██▊       | 315M/1.12G [00:01<00:04, 195MB/s]model.safetensors:  30%|███       | 336M/1.12G [00:01<00:03, 196MB/s]model.safetensors:  32%|███▏      | 357M/1.12G [00:01<00:03, 196MB/s]model.safetensors:  34%|███▍      | 377M/1.12G [00:01<00:03, 197MB/s]model.safetensors:  36%|███▌      | 398M/1.12G [00:02<00:03, 197MB/s]model.safetensors:  38%|███▊      | 419M/1.12G [00:02<00:03, 197MB/s]model.safetensors:  39%|███▉      | 440M/1.12G [00:02<00:03, 197MB/s]model.safetensors:  41%|████▏     | 461M/1.12G [00:02<00:03, 198MB/s]model.safetensors:  43%|████▎     | 482M/1.12G [00:02<00:03, 197MB/s]model.safetensors:  45%|████▌     | 503M/1.12G [00:02<00:03, 197MB/s]model.safetensors:  47%|████▋     | 524M/1.12G [00:02<00:03, 197MB/s]model.safetensors:  49%|████▉     | 545M/1.12G [00:02<00:02, 197MB/s]model.safetensors:  51%|█████     | 566M/1.12G [00:02<00:02, 197MB/s]model.safetensors:  53%|█████▎    | 587M/1.12G [00:02<00:02, 197MB/s]model.safetensors:  54%|█████▍    | 608M/1.12G [00:03<00:02, 198MB/s]model.safetensors:  56%|█████▋    | 629M/1.12G [00:03<00:02, 198MB/s]model.safetensors:  58%|█████▊    | 650M/1.12G [00:03<00:02, 198MB/s]model.safetensors:  60%|██████    | 671M/1.12G [00:03<00:02, 198MB/s]model.safetensors:  62%|██████▏   | 692M/1.12G [00:03<00:02, 197MB/s]model.safetensors:  64%|██████▍   | 713M/1.12G [00:03<00:02, 197MB/s]model.safetensors:  66%|██████▌   | 734M/1.12G [00:03<00:01, 197MB/s]model.safetensors:  68%|██████▊   | 755M/1.12G [00:03<00:01, 197MB/s]model.safetensors:  69%|██████▉   | 776M/1.12G [00:03<00:01, 197MB/s]model.safetensors:  71%|███████▏  | 797M/1.12G [00:04<00:01, 197MB/s]model.safetensors:  73%|███████▎  | 818M/1.12G [00:04<00:01, 197MB/s]model.safetensors:  75%|███████▌  | 839M/1.12G [00:04<00:01, 197MB/s]model.safetensors:  77%|███████▋  | 860M/1.12G [00:04<00:01, 197MB/s]model.safetensors:  79%|███████▉  | 881M/1.12G [00:04<00:01, 197MB/s]model.safetensors:  81%|████████  | 902M/1.12G [00:04<00:01, 196MB/s]model.safetensors:  83%|████████▎ | 923M/1.12G [00:04<00:00, 196MB/s]model.safetensors:  84%|████████▍ | 944M/1.12G [00:04<00:00, 197MB/s]model.safetensors:  86%|████████▋ | 965M/1.12G [00:04<00:00, 197MB/s]model.safetensors:  88%|████████▊ | 986M/1.12G [00:05<00:00, 197MB/s]model.safetensors:  90%|█████████ | 1.01G/1.12G [00:05<00:00, 197MB/s]model.safetensors:  92%|█████████▏| 1.03G/1.12G [00:05<00:00, 197MB/s]model.safetensors:  94%|█████████▍| 1.05G/1.12G [00:05<00:00, 197MB/s]model.safetensors:  96%|█████████▌| 1.07G/1.12G [00:05<00:00, 197MB/s]model.safetensors:  98%|█████████▊| 1.09G/1.12G [00:05<00:00, 197MB/s]model.safetensors:  99%|█████████▉| 1.11G/1.12G [00:05<00:00, 197MB/s]model.safetensors: 100%|██████████| 1.12G/1.12G [00:05<00:00, 197MB/s]
Traceback (most recent call last):
  File "/dtu/p1/johlau/LMOps/minillm/train_minillm.py", line 93, in <module>
    main()
  File "/dtu/p1/johlau/LMOps/minillm/train_minillm.py", line 79, in main
    train(
  File "/dtu/p1/johlau/LMOps/minillm/minillm/__init__.py", line 22, in train
    trainer = PPOTrainer(
  File "/dtu/p1/johlau/LMOps/minillm/minillm/trainer.py", line 82, in __init__
    self.model, self.opt, self.scheduler = self.setup_ds(self.model, self.opt, self.scheduler)
  File "/dtu/p1/johlau/LMOps/minillm/minillm/trainer.py", line 134, in setup_ds
    model, optimizer, _, scheduler = deepspeed.initialize(
  File "/zhome/4e/b/208805/.local/lib/python3.9/site-packages/deepspeed/__init__.py", line 171, in initialize
    engine = DeepSpeedEngine(args=args,
  File "/zhome/4e/b/208805/.local/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 304, in __init__
    self._configure_optimizer(optimizer, model_parameters)
  File "/zhome/4e/b/208805/.local/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1219, in _configure_optimizer
    self.optimizer = self._configure_zero_optimizer(basic_optimizer)
  File "/zhome/4e/b/208805/.local/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1480, in _configure_zero_optimizer
    optimizer = DeepSpeedZeroOptimizer(
  File "/zhome/4e/b/208805/.local/lib/python3.9/site-packages/deepspeed/runtime/zero/stage_1_and_2.py", line 371, in __init__
    self.single_partition_of_fp32_groups.append(self.parallel_partitioned_bit16_groups[i][partition_id].to(
RuntimeError: CUDA error: no kernel image is available for execution on the device
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 1893977) of binary: /bin/python3
Traceback (most recent call last):
  File "/usr/lib64/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib64/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/zhome/4e/b/208805/.local/lib/python3.9/site-packages/torch/distributed/run.py", line 798, in <module>
    main()
  File "/zhome/4e/b/208805/.local/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 346, in wrapper
    return f(*args, **kwargs)
  File "/zhome/4e/b/208805/.local/lib/python3.9/site-packages/torch/distributed/run.py", line 794, in main
    run(args)
  File "/zhome/4e/b/208805/.local/lib/python3.9/site-packages/torch/distributed/run.py", line 785, in run
    elastic_launch(
  File "/zhome/4e/b/208805/.local/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/zhome/4e/b/208805/.local/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 250, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/dtu/p1/johlau/LMOps/minillm/train_minillm.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-12-12_13:31:47
  host      : n-62-12-86.hpccluster.dtu.dk
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 1893977)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
