Mon Dec 18 13:39:46 2023       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.104.12             Driver Version: 535.104.12   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA H100 PCIe               On  | 00000000:A1:00.0 Off |                    0 |
| N/A   25C    P0              45W / 350W |      4MiB / 81559MiB |      0%   E. Process |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
python3 -m torch.distributed.run --nproc_per_node 1 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 3026 /dtu/p1/johlau/LMOps/minillm/train_minillm.py --base-path /dtu/p1/johlau/LMOps/minillm --model-path /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_init/llama-7B --teacher-model-path /dtu/p1/johlau/LMOps/minillm/results/llama/train/sft/llama-13B --ckpt-name 7B-init --teacher-ckpt-name 13B-sft --n-gpu 1 --n-nodes 1 --model-type llama --teacher-model-fp16 --gradient-checkpointing --prompt-data-dir /dtu/p1/johlau/LMOps/minillm/processed_data/dolly/prompt/llama/ --lm-data-dir /dtu/p1/johlau/LMOps/minillm/processed_data/roberta/llama/256/20M/ --dev-num 1000 --num-workers 0 --epochs 10 --total-iters 5000 --kd-ratio 0.5 --batch-size 2 --eval-batch-size 4 --lr 5e-6 --lr-min 5e-6 --gradient-accumulation-steps 2 --max-length 256 --max-prompt-length 128 --warmup-iters 100 --scheduler-name cosine_trm --save /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/ --seed 10 --seed-ppo 42 --seed-lm 7 --save-interval 250 --eval-interval 100 --log-interval 16 --mid-log-num 1 --type minillm --ppo-epochs 4 --num-rollouts 64 --chunk-size 2 --length-norm --single-step-reg --teacher-mixed-alpha 0.2 --reward-scaling 0.5 --cliprange-reward 100 --do-sample --top-k 0 --top-p 1.0 --temperature 1.0 --deepspeed --deepspeed_config /dtu/p1/johlau/LMOps/minillm/configs/deepspeed/ds_config_zero2_offload.json /dtu/p1/johlau/LMOps/minillm 3026
PYTHONPATH=/dtu/p1/johlau/LMOps/minillm
[2023-12-18 13:39:52,030] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
using world size: 1
[2023-12-18 13:39:53,609] [INFO] [comm.py:637:init_distributed] cdb=None
[2023-12-18 13:39:53,609] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_path ................... /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_init/llama-7B
  ckpt_name .................... 7B-init
  model_type ................... llama
  teacher_model_type ........... None
  n_gpu ........................ 1
  n_nodes ...................... 1
  teacher_model_path ........... /dtu/p1/johlau/LMOps/minillm/results/llama/train/sft/llama-13B
  teacher_ckpt_name ............ 13B-sft
  teacher_model_fp16 ........... True
  model_parallel ............... False
  model_parallel_size .......... None
  no_value ..................... False
  dropout_path_rate ............ None
  fp32 ......................... False
  type ......................... minillm
  do_train ..................... False
  do_valid ..................... False
  do_eval ...................... False
  base_path .................... /dtu/p1/johlau/LMOps/minillm
  load ......................... None
  save ......................... /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
  log_interval ................. 16
  mid_log_num .................. 1
  save_interval ................ 250
  eval_interval ................ 100
  local_rank ................... 0
  save_additional_suffix ....... 
  save_rollout ................. False
  eb_sample_times .............. 3
  data_dir ..................... None
  processed_data_dir ........... None
  force_process ................ False
  force_process_demo ........... False
  data_process_workers ......... -1
  train_num .................... -1
  train_ratio .................. 1
  dev_num ...................... 1000
  dev_ratio .................... 1
  gen_num ...................... -1
  data_names ................... None
  prompt_type .................. None
  num_workers .................. 0
  max_prompt_length ............ 128
  min_prompt_length ............ 64
  json_data .................... False
  bin_data ..................... False
  txt_data ..................... False
  prompt_data_dir .............. /dtu/p1/johlau/LMOps/minillm/processed_data/dolly/prompt/llama/
  lm_data_dir .................. /dtu/p1/johlau/LMOps/minillm/processed_data/roberta/llama/256/20M/
  eval_ppl ..................... False
  eval_rw ...................... False
  eval_gen ..................... False
  only_prompt .................. False
  batch_size ................... 2
  eval_batch_size .............. 4
  clip_grad .................... 1.0
  total_iters .................. 5000
  train_iters_per_epoch ........ -1
  max_length ................... 256
  seed ......................... 10
  seed_order ................... 42
  seed_data .................... 42
  seed_ppo ..................... 42
  seed_lm ...................... 7
  epochs ....................... 10
  training_epochs .............. 10000
  gradient_accumulation_steps .. 2
  gradient_checkpointing ....... True
  attn_dtype ................... None
  lr ........................... 5e-06
  lr_min ....................... 5e-06
  weight_decay ................. 0.01
  loss_scale ................... 65536
  kd_ratio ..................... 0.5
  warmup_iters ................. 100
  lr_decay_iters ............... None
  lr_decay_style ............... noam
  scheduler_name ............... cosine_trm
  reward_scaling ............... 0.5
  cliprange_reward ............. 100.0
  ppo_epochs ................... 4
  num_rollouts ................. 64
  num_rollouts_per_device ...... 64
  cliprange .................... 0.2
  chunk_size ................... 2
  gamma ........................ 0.95
  length_norm .................. True
  single_step_reg .............. True
  teacher_mixed_alpha .......... 0.2
  lm_coef ...................... 1
  top_k ........................ 0
  top_p ........................ 1.0
  do_sample .................... True
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  num_beams .................... 1
  temperature .................. 1.0
  peft ......................... None
  peft_lora_r .................. 8
  peft_lora_alpha .............. 32
  peft_lora_dropout ............ 0.1
  peft_name .................... None
  peft_path .................... None
  teacher_peft_name ............ None
  teacher_peft_path ............ None
  deepspeed .................... True
  deepspeed_config ............. /dtu/p1/johlau/LMOps/minillm/configs/deepspeed/ds_config_zero2_offload.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  rank ......................... 0
  world_size ................... 1
 > number of parameters: 13015864320
 > number of parameters: 6738415616
Model load time: 16.894356727600098s
 > number of parameters: 6738M
[2023-12-18 13:40:43,875] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.12.1, git-hash=unknown, git-branch=unknown
[2023-12-18 13:40:44,883] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-12-18 13:40:44,885] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2023-12-18 13:40:44,885] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2023-12-18 13:40:44,897] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = AdamW
[2023-12-18 13:40:44,897] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=AdamW type=<class 'torch.optim.adamw.AdamW'>
[2023-12-18 13:40:44,897] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2023-12-18 13:40:44,897] [INFO] [stage_1_and_2.py:147:__init__] Reduce bucket size 200000000
[2023-12-18 13:40:44,897] [INFO] [stage_1_and_2.py:148:__init__] Allgather bucket size 200000000
[2023-12-18 13:40:44,897] [INFO] [stage_1_and_2.py:149:__init__] CPU Offload: True
[2023-12-18 13:40:44,897] [INFO] [stage_1_and_2.py:150:__init__] Round robin gradient partitioning: False
[2023-12-18 13:40:58,344] [INFO] [utils.py:802:see_memory_usage] Before initializing optimizer states
[2023-12-18 13:40:58,345] [INFO] [utils.py:803:see_memory_usage] MA 37.23 GB         Max_MA 37.23 GB         CA 37.23 GB         Max_CA 37 GB 
[2023-12-18 13:40:58,345] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 84.42 GB, percent = 11.2%
[2023-12-18 13:41:47,858] [INFO] [utils.py:802:see_memory_usage] After initializing optimizer states
[2023-12-18 13:41:47,859] [INFO] [utils.py:803:see_memory_usage] MA 37.23 GB         Max_MA 37.23 GB         CA 37.23 GB         Max_CA 37 GB 
[2023-12-18 13:41:47,859] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 160.4 GB, percent = 21.2%
[2023-12-18 13:41:47,859] [INFO] [stage_1_and_2.py:514:__init__] optimizer state initialized
[2023-12-18 13:41:47,949] [INFO] [utils.py:802:see_memory_usage] After initializing ZeRO optimizer
[2023-12-18 13:41:47,950] [INFO] [utils.py:803:see_memory_usage] MA 37.23 GB         Max_MA 37.23 GB         CA 37.23 GB         Max_CA 37 GB 
[2023-12-18 13:41:47,950] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 160.4 GB, percent = 21.2%
[2023-12-18 13:41:47,958] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = AdamW
[2023-12-18 13:41:47,958] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2023-12-18 13:41:47,958] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <torch.optim.lr_scheduler.LambdaLR object at 0x7f086efacfa0>
[2023-12-18 13:41:47,958] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0], mom=[[0.9, 0.95]]
[2023-12-18 13:41:47,959] [INFO] [config.py:972:print] DeepSpeedEngine configuration:
[2023-12-18 13:41:47,959] [INFO] [config.py:976:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-12-18 13:41:47,959] [INFO] [config.py:976:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-12-18 13:41:47,959] [INFO] [config.py:976:print]   amp_enabled .................. False
[2023-12-18 13:41:47,959] [INFO] [config.py:976:print]   amp_params ................... False
[2023-12-18 13:41:47,959] [INFO] [config.py:976:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-12-18 13:41:47,959] [INFO] [config.py:976:print]   bfloat16_enabled ............. False
[2023-12-18 13:41:47,959] [INFO] [config.py:976:print]   checkpoint_parallel_write_pipeline  False
[2023-12-18 13:41:47,959] [INFO] [config.py:976:print]   checkpoint_tag_validation_enabled  True
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   checkpoint_tag_validation_fail  False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f086efac040>
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   communication_data_type ...... None
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   curriculum_enabled_legacy .... False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   curriculum_params_legacy ..... False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   data_efficiency_enabled ...... False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   dataloader_drop_last ......... False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   disable_allgather ............ False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   dump_state ................... False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 5000, 'delayed_shift': 4, 'consecutive_hysteresis': False, 'min_scale': 1}
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   eigenvalue_enabled ........... False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   eigenvalue_gas_boundary_resolution  1
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   eigenvalue_layer_num ......... 0
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   eigenvalue_max_iter .......... 100
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   eigenvalue_stability ......... 1e-06
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   eigenvalue_tol ............... 0.01
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   eigenvalue_verbose ........... False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   elasticity_enabled ........... False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   fp16_auto_cast ............... False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   fp16_enabled ................. True
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   fp16_master_weights_and_gradients  False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   global_rank .................. 0
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   grad_accum_dtype ............. None
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   gradient_accumulation_steps .. 2
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   gradient_clipping ............ 1.0
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   gradient_predivide_factor .... 1.0
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   initial_dynamic_scale ........ 2048
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   load_universal_checkpoint .... False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   loss_scale ................... 0
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   memory_breakdown ............. False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   mics_hierarchial_params_gather  False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   mics_shard_size .............. -1
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   optimizer_legacy_fusion ...... False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   optimizer_name ............... None
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   optimizer_params ............. None
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   pld_enabled .................. False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   pld_params ................... False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   prescale_gradients ........... False
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   scheduler_name ............... None
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   scheduler_params ............. None
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   seq_parallel_communication_data_type  torch.float32
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   sparse_attention ............. None
[2023-12-18 13:41:47,960] [INFO] [config.py:976:print]   sparse_gradients_enabled ..... False
[2023-12-18 13:41:47,961] [INFO] [config.py:976:print]   steps_per_print .............. 10000000
[2023-12-18 13:41:47,961] [INFO] [config.py:976:print]   train_batch_size ............. 4
[2023-12-18 13:41:47,961] [INFO] [config.py:976:print]   train_micro_batch_size_per_gpu  2
[2023-12-18 13:41:47,961] [INFO] [config.py:976:print]   use_node_local_storage ....... False
[2023-12-18 13:41:47,961] [INFO] [config.py:976:print]   wall_clock_breakdown ......... False
[2023-12-18 13:41:47,961] [INFO] [config.py:976:print]   weight_quantization_config ... None
[2023-12-18 13:41:47,961] [INFO] [config.py:976:print]   world_size ................... 1
[2023-12-18 13:41:47,961] [INFO] [config.py:976:print]   zero_allow_untested_optimizer  True
[2023-12-18 13:41:47,961] [INFO] [config.py:976:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=DeepSpeedZeroOffloadOptimizerConfig(device='cpu', nvme_path=None, buffer_count=4, pin_memory=False, pipeline=False, pipeline_read=False, pipeline_write=False, fast_init=False) sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2023-12-18 13:41:47,961] [INFO] [config.py:976:print]   zero_enabled ................. True
[2023-12-18 13:41:47,961] [INFO] [config.py:976:print]   zero_force_ds_cpu_optimizer .. False
[2023-12-18 13:41:47,961] [INFO] [config.py:976:print]   zero_optimization_stage ...... 2
[2023-12-18 13:41:47,961] [INFO] [config.py:962:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 2, 
    "zero_optimization": {
        "stage": 2, 
        "offload_optimizer": {
            "device": "cpu"
        }, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true
    }, 
    "zero_force_ds_cpu_optimizer": false, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 5.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1.000000e+07
}
Probing Dataset
Probing end. Max data state 1, total length 2569
Num PPO instances: 2569
Probing Dataset
Probing end. Max data state 1, total length 959
Num PPO instances: 959
Probing Dataset
Probing end. Max data state 1, total length 6958892
Num LM instances: 6958892
Probing Dataset
Probing end. Max data state 1, total length 10000
Num LM instances: 10000
                                 Evaluation #0                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Adicionales a los tres tipos bajos   │
│                                       │ conocidos tradicionalmente existen   │
│                                       │ tres tipos de quarks de encima, por  │
│                                       │ lo que hay siete tipos en total.     │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es un marco de referencia     │
│                                       │ para la definición aérea y marítima, │
│                                       │ para el control de la circulación    │
│                                       │ aérea y de naves marítimas, para la  │
│                                       │ utilización de los recursos          │
│                                       │ hídricos, por ejemplo, los canales,  │
│                                       │ los arcos o administraciones         │
│                                       │ interiores.                          │
│                                       │                                      │
│                                       │ Un IMC valúa la disponibilidad de la │
│                                       │ lluvia para los campos, tráfico y    │
│                                       │ carreteras para la incluyencia       │
│                                       │ localizada de cada región en un sólo │
│                                       │ IMC.                                 │
│                                       │ El IMC representa un aumento en la   │
│                                       │ valora                               │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ El sastre de Abraham Lincoln,        │
│                                       │ Batvisa que contenía el berilio y el │
│                                       │ cianuro, el "Veladero mausoleo" de   │
│                                       │ Tutankamen, la "Caja sin Tiempo" de  │
│                                       │ Persia, el cofre del Sol en El Baúl  │
│                                       │ de la Cápsula del Tiempo de          │
│                                       │ problemas Buzón, la Cápsula del      │
│                                       │ Tiempo que vio a al-Azif vestida de  │
│                                       │ bruja, el pozo de Jam o Segundo, la  │
│                                       │ Caja de Pandora, el Chrisstone y el  │
│                                       │ oro de Midas                         │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 12.437 | exact_match: 0.104 | rev_kl: 1.471 | lens: 88.993 | pt_loss: 1.792 | lm_loss: 1.930 | kd_loss: 1.654 
Total Steps: 5000 Data Epochs: 10
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:      2/  5000| tot_loss: 4.0542 | rl_loss: 1.8235 | pt_loss: 2.2307 | pg_loss: 0.3798 | reg_loss: 1.4437 | reward: -0.4350 | rev_kl: 1.1490 | stu_lens: 128.0000 | mixed_lens: 60.0000 | lr: 5.0000e-08 | scale: 2048.00 | time: 26.092 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:      3/  5000| tot_loss: 3.5716 | rl_loss: 1.8944 | pt_loss: 1.6772 | pg_loss: 0.2374 | reg_loss: 1.6570 | reward: -0.6367 | rev_kl: 1.0682 | stu_lens: 87.0000 | mixed_lens: 102.5000 | lr: 1.0000e-07 | scale: 2048.00 | time: 26.524 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:      4/  5000| tot_loss: 3.7684 | rl_loss: 1.7441 | pt_loss: 2.0243 | pg_loss: 0.0784 | reg_loss: 1.6657 | reward: -0.1253 | rev_kl: 1.8837 | stu_lens: 51.5000 | mixed_lens: 120.0000 | lr: 1.5000e-07 | scale: 2048.00 | time: 26.485 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:      5/  5000| tot_loss: 3.0076 | rl_loss: 1.2019 | pt_loss: 1.8057 | pg_loss: 0.2303 | reg_loss: 0.9716 | reward: -0.2155 | rev_kl: 0.9125 | stu_lens: 66.0000 | mixed_lens: 102.5000 | lr: 2.0000e-07 | scale: 2048.00 | time: 26.535 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:      6/  5000| tot_loss: 3.9774 | rl_loss: 1.6450 | pt_loss: 2.3323 | pg_loss: 0.2556 | reg_loss: 1.3895 | reward: -0.8313 | rev_kl: 1.2263 | stu_lens: 70.5000 | mixed_lens: 78.0000 | lr: 2.5000e-07 | scale: 2048.00 | time: 26.511 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:      7/  5000| tot_loss: 3.5857 | rl_loss: 1.4295 | pt_loss: 2.1562 | pg_loss: 0.0524 | reg_loss: 1.3771 | reward: -0.2642 | rev_kl: 1.1300 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.0000e-07 | scale: 2048.00 | time: 26.525 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:      8/  5000| tot_loss: 3.6163 | rl_loss: 1.8608 | pt_loss: 1.7555 | pg_loss: 0.2147 | reg_loss: 1.6461 | reward: -0.6107 | rev_kl: 1.7106 | stu_lens: 93.0000 | mixed_lens: 112.0000 | lr: 3.5000e-07 | scale: 2048.00 | time: 26.461 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:      9/  5000| tot_loss: 3.4832 | rl_loss: 1.7879 | pt_loss: 1.6953 | pg_loss: 0.1926 | reg_loss: 1.5953 | reward: -0.5229 | rev_kl: 1.5746 | stu_lens: 69.5000 | mixed_lens: 108.5000 | lr: 4.0000e-07 | scale: 2048.00 | time: 26.505 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:     10/  5000| tot_loss: 3.5152 | rl_loss: 1.5787 | pt_loss: 1.9365 | pg_loss: 0.4874 | reg_loss: 1.0913 | reward: -1.2259 | rev_kl: 0.7424 | stu_lens: 70.0000 | mixed_lens: 69.5000 | lr: 4.5000e-07 | scale: 2048.00 | time: 26.480 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:     11/  5000| tot_loss: 3.9394 | rl_loss: 2.1437 | pt_loss: 1.7956 | pg_loss: 0.2731 | reg_loss: 1.8706 | reward: -2.1957 | rev_kl: 1.1899 | stu_lens: 69.0000 | mixed_lens: 68.0000 | lr: 5.0000e-07 | scale: 2048.00 | time: 26.544 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:     12/  5000| tot_loss: 4.1619 | rl_loss: 1.9445 | pt_loss: 2.2174 | pg_loss: 0.3370 | reg_loss: 1.6074 | reward: -0.7602 | rev_kl: 1.3047 | stu_lens: 128.0000 | mixed_lens: 77.5000 | lr: 5.5000e-07 | scale: 2048.00 | time: 26.492 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:     13/  5000| tot_loss: 3.3086 | rl_loss: 1.5404 | pt_loss: 1.7681 | pg_loss: 0.0371 | reg_loss: 1.5034 | reward: -0.2287 | rev_kl: 1.2611 | stu_lens: 104.0000 | mixed_lens: 128.0000 | lr: 6.0000e-07 | scale: 2048.00 | time: 26.542 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:     14/  5000| tot_loss: 3.0740 | rl_loss: 1.6028 | pt_loss: 1.4712 | pg_loss: 0.0599 | reg_loss: 1.5429 | reward: -0.2381 | rev_kl: 1.0876 | stu_lens: 103.0000 | mixed_lens: 128.0000 | lr: 6.5000e-07 | scale: 2048.00 | time: 26.508 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:     15/  5000| tot_loss: 3.3208 | rl_loss: 1.7282 | pt_loss: 1.5926 | pg_loss: 0.2740 | reg_loss: 1.4542 | reward: -0.5598 | rev_kl: 2.2687 | stu_lens: 124.0000 | mixed_lens: 103.5000 | lr: 7.0000e-07 | scale: 2048.00 | time: 26.530 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     16/  5000| tot_loss: 3.5550 | rl_loss: 1.9890 | pt_loss: 1.5660 | pg_loss: 0.5690 | reg_loss: 1.4199 | reward: -1.0231 | rev_kl: 1.1832 | stu_lens: 69.0000 | mixed_lens: 71.0000 | lr: 7.5000e-07 | scale: 2048.00 | time: 26.547 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     16/  5000| tot_loss: 3.6179 | rl_loss: 1.9167 | pt_loss: 1.7012 | pg_loss: 0.4634 | reg_loss: 1.4533 | reward: -0.7199 | rev_kl: 1.2740 | stu_lens: 85.1406 | mixed_lens: 77.9219 | lr: 7.5000e-07 | scale: 2048.00 | time: 26.547 | step time: 26.173
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:     17/  5000| tot_loss: 3.2314 | rl_loss: 1.2743 | pt_loss: 1.9571 | pg_loss: 0.4480 | reg_loss: 0.8263 | reward: -0.5049 | rev_kl: 2.4192 | stu_lens: 13.0000 | mixed_lens: 69.5000 | lr: 8.0000e-07 | scale: 2048.00 | time: 26.529 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:     18/  5000| tot_loss: 3.9221 | rl_loss: 2.0022 | pt_loss: 1.9199 | pg_loss: 0.3555 | reg_loss: 1.6467 | reward: -3.5781 | rev_kl: 2.3647 | stu_lens: 103.0000 | mixed_lens: 67.0000 | lr: 8.5000e-07 | scale: 2048.00 | time: 26.495 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:     19/  5000| tot_loss: 5.6820 | rl_loss: 4.1308 | pt_loss: 1.5512 | pg_loss: 2.2487 | reg_loss: 1.8821 | reward: -1.0461 | rev_kl: 1.4098 | stu_lens: 25.5000 | mixed_lens: 12.0000 | lr: 9.0000e-07 | scale: 2048.00 | time: 26.560 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:     20/  5000| tot_loss: 3.7739 | rl_loss: 1.7327 | pt_loss: 2.0412 | pg_loss: 0.4099 | reg_loss: 1.3228 | reward: -1.3951 | rev_kl: 1.1910 | stu_lens: 11.5000 | mixed_lens: 65.0000 | lr: 9.5000e-07 | scale: 2048.00 | time: 26.538 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:     21/  5000| tot_loss: 2.7947 | rl_loss: 1.1956 | pt_loss: 1.5991 | pg_loss: 0.0265 | reg_loss: 1.1691 | reward: -0.2571 | rev_kl: 1.1525 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.0000e-06 | scale: 2048.00 | time: 26.577 | step time: 0.000
[2023-12-18 14:22:12,900] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, but hysteresis is 4. Reducing hysteresis to 3
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:     22/  5000| tot_loss: 2.7472 | rl_loss: 1.4784 | pt_loss: 1.2689 | pg_loss: 0.0245 | reg_loss: 1.4538 | reward: -0.4535 | rev_kl: 1.3437 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.0000e-06 | scale: 2048.00 | time: 2.840 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:     23/  5000| tot_loss: 3.5218 | rl_loss: 1.8067 | pt_loss: 1.7151 | pg_loss: 0.2144 | reg_loss: 1.5923 | reward: -2.0964 | rev_kl: 1.2203 | stu_lens: 45.0000 | mixed_lens: 68.0000 | lr: 1.0500e-06 | scale: 2048.00 | time: 26.524 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:     24/  5000| tot_loss: 4.0532 | rl_loss: 1.9979 | pt_loss: 2.0553 | pg_loss: 0.2340 | reg_loss: 1.7639 | reward: -0.7804 | rev_kl: 1.1529 | stu_lens: 128.0000 | mixed_lens: 86.5000 | lr: 1.1000e-06 | scale: 2048.00 | time: 26.553 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:     25/  5000| tot_loss: 2.9043 | rl_loss: 1.4217 | pt_loss: 1.4826 | pg_loss: 0.1829 | reg_loss: 1.2388 | reward: -0.5471 | rev_kl: 2.0172 | stu_lens: 30.5000 | mixed_lens: 69.5000 | lr: 1.1500e-06 | scale: 2048.00 | time: 26.530 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:     26/  5000| tot_loss: 3.7432 | rl_loss: 1.7765 | pt_loss: 1.9667 | pg_loss: 0.2177 | reg_loss: 1.5587 | reward: -0.5171 | rev_kl: 1.1870 | stu_lens: 83.5000 | mixed_lens: 101.0000 | lr: 1.2000e-06 | scale: 2048.00 | time: 26.542 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:     27/  5000| tot_loss: 3.4569 | rl_loss: 1.2516 | pt_loss: 2.2053 | pg_loss: 0.1729 | reg_loss: 1.0787 | reward: -0.1881 | rev_kl: 1.8406 | stu_lens: 35.0000 | mixed_lens: 94.5000 | lr: 1.2500e-06 | scale: 2048.00 | time: 26.506 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:     28/  5000| tot_loss: 3.8043 | rl_loss: 2.0425 | pt_loss: 1.7618 | pg_loss: 0.7402 | reg_loss: 1.3023 | reward: -0.7753 | rev_kl: 2.2952 | stu_lens: 124.0000 | mixed_lens: 66.5000 | lr: 1.3000e-06 | scale: 2048.00 | time: 26.542 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:     29/  5000| tot_loss: 3.7465 | rl_loss: 2.1115 | pt_loss: 1.6350 | pg_loss: 0.6321 | reg_loss: 1.4794 | reward: -0.7072 | rev_kl: 1.3690 | stu_lens: 128.0000 | mixed_lens: 64.0000 | lr: 1.3500e-06 | scale: 2048.00 | time: 26.482 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:     30/  5000| tot_loss: 4.2849 | rl_loss: 2.4944 | pt_loss: 1.7905 | pg_loss: 0.8747 | reg_loss: 1.6197 | reward: -0.5678 | rev_kl: 1.7245 | stu_lens: 128.0000 | mixed_lens: 37.0000 | lr: 1.4000e-06 | scale: 2048.00 | time: 26.538 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:     31/  5000| tot_loss: 3.7579 | rl_loss: 2.2209 | pt_loss: 1.5370 | pg_loss: 0.8509 | reg_loss: 1.3699 | reward: -0.9204 | rev_kl: 1.1788 | stu_lens: 95.0000 | mixed_lens: 45.0000 | lr: 1.4500e-06 | scale: 2048.00 | time: 26.513 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     32/  5000| tot_loss: 2.7871 | rl_loss: 1.0650 | pt_loss: 1.7221 | pg_loss: 0.0192 | reg_loss: 1.0457 | reward: -0.3438 | rev_kl: 1.5144 | stu_lens: 115.5000 | mixed_lens: 128.0000 | lr: 1.5000e-06 | scale: 2048.00 | time: 26.501 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     32/  5000| tot_loss: 3.5334 | rl_loss: 1.7380 | pt_loss: 1.7954 | pg_loss: 0.4085 | reg_loss: 1.3295 | reward: -0.7597 | rev_kl: 1.4251 | stu_lens: 84.1094 | mixed_lens: 81.2031 | lr: 1.5000e-06 | scale: 2048.00 | time: 26.501 | step time: 26.329
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:     33/  5000| tot_loss: 2.7722 | rl_loss: 1.1178 | pt_loss: 1.6544 | pg_loss: 0.0368 | reg_loss: 1.0811 | reward: -0.2828 | rev_kl: 1.1986 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.5500e-06 | scale: 2048.00 | time: 26.443 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:     34/  5000| tot_loss: 2.6814 | rl_loss: 1.1321 | pt_loss: 1.5493 | pg_loss: 0.1543 | reg_loss: 0.9778 | reward: -0.8117 | rev_kl: 1.4048 | stu_lens: 70.5000 | mixed_lens: 78.0000 | lr: 1.6000e-06 | scale: 2048.00 | time: 26.478 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:     35/  5000| tot_loss: 3.0062 | rl_loss: 1.2373 | pt_loss: 1.7689 | pg_loss: 0.3749 | reg_loss: 0.8624 | reward: -0.2238 | rev_kl: 1.5596 | stu_lens: 93.0000 | mixed_lens: 74.0000 | lr: 1.6500e-06 | scale: 2048.00 | time: 26.451 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:     36/  5000| tot_loss: 3.0695 | rl_loss: 1.5303 | pt_loss: 1.5393 | pg_loss: 0.2604 | reg_loss: 1.2698 | reward: -0.3960 | rev_kl: 1.1968 | stu_lens: 123.0000 | mixed_lens: 83.5000 | lr: 1.7000e-06 | scale: 2048.00 | time: 26.477 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:     37/  5000| tot_loss: 2.9886 | rl_loss: 1.0471 | pt_loss: 1.9414 | pg_loss: 0.1811 | reg_loss: 0.8660 | reward: -0.4208 | rev_kl: 1.5675 | stu_lens: 69.5000 | mixed_lens: 99.0000 | lr: 1.7500e-06 | scale: 2048.00 | time: 26.440 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:     38/  5000| tot_loss: 2.8158 | rl_loss: 1.0158 | pt_loss: 1.8000 | pg_loss: -0.0012 | reg_loss: 1.0170 | reward: -0.2523 | rev_kl: 1.2306 | stu_lens: 103.0000 | mixed_lens: 128.0000 | lr: 1.8000e-06 | scale: 2048.00 | time: 26.457 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:     39/  5000| tot_loss: 3.4067 | rl_loss: 1.5422 | pt_loss: 1.8645 | pg_loss: 0.4575 | reg_loss: 1.0846 | reward: -0.8147 | rev_kl: 1.4532 | stu_lens: 128.0000 | mixed_lens: 79.0000 | lr: 1.8500e-06 | scale: 2048.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:     40/  5000| tot_loss: 3.7238 | rl_loss: 1.5167 | pt_loss: 2.2071 | pg_loss: 0.5932 | reg_loss: 0.9235 | reward: -1.0549 | rev_kl: 1.0084 | stu_lens: 54.0000 | mixed_lens: 58.5000 | lr: 1.9000e-06 | scale: 2048.00 | time: 26.408 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:     41/  5000| tot_loss: 2.7967 | rl_loss: 0.9716 | pt_loss: 1.8251 | pg_loss: 0.1542 | reg_loss: 0.8173 | reward: -0.6026 | rev_kl: 2.0740 | stu_lens: 83.5000 | mixed_lens: 104.0000 | lr: 1.9500e-06 | scale: 2048.00 | time: 26.392 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:     42/  5000| tot_loss: 2.9054 | rl_loss: 1.3010 | pt_loss: 1.6044 | pg_loss: 0.4035 | reg_loss: 0.8975 | reward: -0.5316 | rev_kl: 2.4431 | stu_lens: 65.5000 | mixed_lens: 70.0000 | lr: 2.0000e-06 | scale: 2048.00 | time: 26.405 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:     43/  5000| tot_loss: 3.7863 | rl_loss: 1.8919 | pt_loss: 1.8944 | pg_loss: 0.8808 | reg_loss: 1.0111 | reward: -3.5181 | rev_kl: 1.8345 | stu_lens: 50.0000 | mixed_lens: 25.5000 | lr: 2.0500e-06 | scale: 2048.00 | time: 26.375 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:     44/  5000| tot_loss: 2.7361 | rl_loss: 1.2781 | pt_loss: 1.4581 | pg_loss: 0.5474 | reg_loss: 0.7306 | reward: -0.5515 | rev_kl: 1.4032 | stu_lens: 77.0000 | mixed_lens: 75.5000 | lr: 2.1000e-06 | scale: 2048.00 | time: 26.398 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:     45/  5000| tot_loss: 2.6020 | rl_loss: 1.1806 | pt_loss: 1.4214 | pg_loss: 0.7465 | reg_loss: 0.4340 | reward: -2.0460 | rev_kl: 1.1347 | stu_lens: 63.5000 | mixed_lens: 41.5000 | lr: 2.1500e-06 | scale: 2048.00 | time: 26.377 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:     46/  5000| tot_loss: 3.8769 | rl_loss: 1.7237 | pt_loss: 2.1531 | pg_loss: 0.7358 | reg_loss: 0.9879 | reward: -1.3874 | rev_kl: 0.9744 | stu_lens: 55.0000 | mixed_lens: 56.0000 | lr: 2.2000e-06 | scale: 2048.00 | time: 26.415 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:     47/  5000| tot_loss: 4.5647 | rl_loss: 2.5233 | pt_loss: 2.0415 | pg_loss: 1.1232 | reg_loss: 1.4001 | reward: -1.3533 | rev_kl: 1.2048 | stu_lens: 128.0000 | mixed_lens: 36.0000 | lr: 2.2500e-06 | scale: 2048.00 | time: 26.389 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:     48/  5000| tot_loss: 3.3625 | rl_loss: 1.3102 | pt_loss: 2.0522 | pg_loss: 0.4057 | reg_loss: 0.9046 | reward: -0.5827 | rev_kl: 1.4752 | stu_lens: 88.5000 | mixed_lens: 81.5000 | lr: 2.3000e-06 | scale: 2048.00 | time: 26.469 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:     48/  5000| tot_loss: 3.1315 | rl_loss: 1.3360 | pt_loss: 1.7955 | pg_loss: 0.4016 | reg_loss: 0.9344 | reward: -0.7655 | rev_kl: 1.4099 | stu_lens: 89.9844 | mixed_lens: 82.9375 | lr: 2.3000e-06 | scale: 2048.00 | time: 26.469 | step time: 27.706
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:     49/  5000| tot_loss: 3.2067 | rl_loss: 1.3717 | pt_loss: 1.8351 | pg_loss: 0.5465 | reg_loss: 0.8252 | reward: -0.0352 | rev_kl: 0.5783 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 2.3500e-06 | scale: 2048.00 | time: 26.431 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:     50/  5000| tot_loss: 3.3457 | rl_loss: 1.6435 | pt_loss: 1.7022 | pg_loss: 0.8851 | reg_loss: 0.7584 | reward: -1.1434 | rev_kl: 1.6293 | stu_lens: 37.0000 | mixed_lens: 47.0000 | lr: 2.4000e-06 | scale: 2048.00 | time: 26.477 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:     51/  5000| tot_loss: 2.6216 | rl_loss: 0.6925 | pt_loss: 1.9291 | pg_loss: 0.0277 | reg_loss: 0.6648 | reward: -0.4404 | rev_kl: 1.9309 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.4500e-06 | scale: 2048.00 | time: 26.424 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:     52/  5000| tot_loss: 2.4748 | rl_loss: 0.8845 | pt_loss: 1.5903 | pg_loss: 0.1539 | reg_loss: 0.7306 | reward: -0.4349 | rev_kl: 1.2627 | stu_lens: 113.0000 | mixed_lens: 114.5000 | lr: 2.5000e-06 | scale: 2048.00 | time: 26.457 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:     53/  5000| tot_loss: 2.4089 | rl_loss: 0.8662 | pt_loss: 1.5427 | pg_loss: 0.2873 | reg_loss: 0.5789 | reward: -0.4844 | rev_kl: 2.3337 | stu_lens: 59.5000 | mixed_lens: 69.5000 | lr: 2.5500e-06 | scale: 2048.00 | time: 26.425 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:     54/  5000| tot_loss: 3.3208 | rl_loss: 1.5542 | pt_loss: 1.7666 | pg_loss: 0.8429 | reg_loss: 0.7113 | reward: -0.7657 | rev_kl: 1.6386 | stu_lens: 24.5000 | mixed_lens: 44.5000 | lr: 2.6000e-06 | scale: 2048.00 | time: 26.466 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:     55/  5000| tot_loss: 2.5747 | rl_loss: 1.0022 | pt_loss: 1.5724 | pg_loss: 0.2718 | reg_loss: 0.7304 | reward: -0.7758 | rev_kl: 1.0186 | stu_lens: 128.0000 | mixed_lens: 86.5000 | lr: 2.6500e-06 | scale: 2048.00 | time: 26.415 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:     56/  5000| tot_loss: 4.0839 | rl_loss: 2.2266 | pt_loss: 1.8573 | pg_loss: 1.5456 | reg_loss: 0.6810 | reward: -4.0346 | rev_kl: 1.7992 | stu_lens: 103.0000 | mixed_lens: 17.0000 | lr: 2.7000e-06 | scale: 2048.00 | time: 26.423 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:     57/  5000| tot_loss: 2.1727 | rl_loss: 0.8057 | pt_loss: 1.3671 | pg_loss: 0.3196 | reg_loss: 0.4861 | reward: -0.7822 | rev_kl: 1.0420 | stu_lens: 96.0000 | mixed_lens: 77.5000 | lr: 2.7500e-06 | scale: 2048.00 | time: 26.380 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:     58/  5000| tot_loss: 2.2751 | rl_loss: 0.6550 | pt_loss: 1.6201 | pg_loss: 0.0224 | reg_loss: 0.6326 | reward: -0.2299 | rev_kl: 1.4083 | stu_lens: 104.0000 | mixed_lens: 128.0000 | lr: 2.8000e-06 | scale: 2048.00 | time: 26.407 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:     59/  5000| tot_loss: 3.0007 | rl_loss: 1.0511 | pt_loss: 1.9497 | pg_loss: 0.2925 | reg_loss: 0.7586 | reward: -0.3960 | rev_kl: 1.1968 | stu_lens: 123.0000 | mixed_lens: 83.5000 | lr: 2.8500e-06 | scale: 2048.00 | time: 26.410 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:     60/  5000| tot_loss: 2.2406 | rl_loss: 0.5866 | pt_loss: 1.6540 | pg_loss: -0.0039 | reg_loss: 0.5904 | reward: -0.2980 | rev_kl: 1.0391 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.9000e-06 | scale: 2048.00 | time: 26.426 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:     61/  5000| tot_loss: 2.5647 | rl_loss: 1.1482 | pt_loss: 1.4165 | pg_loss: 0.4377 | reg_loss: 0.7105 | reward: -0.2542 | rev_kl: 1.2932 | stu_lens: 98.0000 | mixed_lens: 73.0000 | lr: 2.9500e-06 | scale: 2048.00 | time: 26.396 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:     62/  5000| tot_loss: 2.8085 | rl_loss: 0.8797 | pt_loss: 1.9287 | pg_loss: 0.2505 | reg_loss: 0.6292 | reward: -0.8517 | rev_kl: 1.4587 | stu_lens: 36.5000 | mixed_lens: 79.5000 | lr: 3.0000e-06 | scale: 2048.00 | time: 26.414 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:     63/  5000| tot_loss: 2.4570 | rl_loss: 0.6104 | pt_loss: 1.8466 | pg_loss: 0.1185 | reg_loss: 0.4919 | reward: -0.3088 | rev_kl: 1.1505 | stu_lens: 128.0000 | mixed_lens: 113.0000 | lr: 3.0500e-06 | scale: 2048.00 | time: 26.372 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:     64/  5000| tot_loss: 3.3932 | rl_loss: 1.5577 | pt_loss: 1.8354 | pg_loss: 0.6765 | reg_loss: 0.8813 | reward: -2.4124 | rev_kl: 1.3534 | stu_lens: 69.0000 | mixed_lens: 31.0000 | lr: 3.1000e-06 | scale: 2048.00 | time: 26.398 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:     64/  5000| tot_loss: 2.7402 | rl_loss: 0.9776 | pt_loss: 1.7626 | pg_loss: 0.3430 | reg_loss: 0.6346 | reward: -0.6880 | rev_kl: 1.3678 | stu_lens: 89.8438 | mixed_lens: 85.6719 | lr: 3.1000e-06 | scale: 2048.00 | time: 26.398 | step time: 27.707
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:     65/  5000| tot_loss: 2.6893 | rl_loss: 0.8846 | pt_loss: 1.8046 | pg_loss: 0.4150 | reg_loss: 0.4696 | reward: -1.1245 | rev_kl: 0.8437 | stu_lens: 35.0000 | mixed_lens: 69.5000 | lr: 3.1500e-06 | scale: 2048.00 | time: 26.365 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:     66/  5000| tot_loss: 3.5322 | rl_loss: 1.2598 | pt_loss: 2.2723 | pg_loss: 0.0791 | reg_loss: 1.1807 | reward: -0.2648 | rev_kl: 0.9071 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.2000e-06 | scale: 2048.00 | time: 26.483 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:     67/  5000| tot_loss: 3.2920 | rl_loss: 1.4556 | pt_loss: 1.8364 | pg_loss: 0.3251 | reg_loss: 1.1305 | reward: -0.8696 | rev_kl: 1.4680 | stu_lens: 78.5000 | mixed_lens: 80.0000 | lr: 3.2500e-06 | scale: 2048.00 | time: 26.405 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:     68/  5000| tot_loss: 4.3031 | rl_loss: 2.7391 | pt_loss: 1.5640 | pg_loss: 1.7905 | reg_loss: 0.9486 | reward: -1.1839 | rev_kl: 1.1881 | stu_lens: 20.5000 | mixed_lens: 26.5000 | lr: 3.3000e-06 | scale: 2048.00 | time: 26.469 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:     69/  5000| tot_loss: 2.7969 | rl_loss: 1.1119 | pt_loss: 1.6849 | pg_loss: 0.0831 | reg_loss: 1.0288 | reward: -0.2291 | rev_kl: 0.8898 | stu_lens: 63.0000 | mixed_lens: 114.0000 | lr: 3.3500e-06 | scale: 2048.00 | time: 26.470 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:     70/  5000| tot_loss: 3.6418 | rl_loss: 1.5391 | pt_loss: 2.1027 | pg_loss: 0.4170 | reg_loss: 1.1221 | reward: -0.3052 | rev_kl: 1.1663 | stu_lens: 75.5000 | mixed_lens: 71.5000 | lr: 3.4000e-06 | scale: 2048.00 | time: 26.483 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:     71/  5000| tot_loss: 2.9404 | rl_loss: 1.1660 | pt_loss: 1.7744 | pg_loss: 0.2100 | reg_loss: 0.9560 | reward: -0.1542 | rev_kl: 0.6532 | stu_lens: 128.0000 | mixed_lens: 111.5000 | lr: 3.4500e-06 | scale: 2048.00 | time: 26.500 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:     72/  5000| tot_loss: 2.5187 | rl_loss: 1.0914 | pt_loss: 1.4273 | pg_loss: 0.0263 | reg_loss: 1.0651 | reward: -0.1524 | rev_kl: 0.7568 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5000e-06 | scale: 2048.00 | time: 26.468 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:     73/  5000| tot_loss: 2.8037 | rl_loss: 1.1439 | pt_loss: 1.6598 | pg_loss: 0.2049 | reg_loss: 0.9391 | reward: -0.3939 | rev_kl: 0.8588 | stu_lens: 128.0000 | mixed_lens: 107.0000 | lr: 3.5500e-06 | scale: 2048.00 | time: 26.442 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:     74/  5000| tot_loss: 3.2627 | rl_loss: 1.5316 | pt_loss: 1.7311 | pg_loss: 0.4022 | reg_loss: 1.1293 | reward: -0.2916 | rev_kl: 0.8351 | stu_lens: 70.5000 | mixed_lens: 83.0000 | lr: 3.6000e-06 | scale: 2048.00 | time: 26.458 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:     75/  5000| tot_loss: 3.1508 | rl_loss: 1.4928 | pt_loss: 1.6580 | pg_loss: 0.2175 | reg_loss: 1.2753 | reward: -0.2869 | rev_kl: 0.9440 | stu_lens: 105.0000 | mixed_lens: 111.0000 | lr: 3.6500e-06 | scale: 2048.00 | time: 26.490 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:     76/  5000| tot_loss: 3.2787 | rl_loss: 1.3153 | pt_loss: 1.9635 | pg_loss: 0.3414 | reg_loss: 0.9738 | reward: -0.1247 | rev_kl: 0.9126 | stu_lens: 115.0000 | mixed_lens: 92.0000 | lr: 3.7000e-06 | scale: 2048.00 | time: 26.513 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:     77/  5000| tot_loss: 3.5668 | rl_loss: 1.9028 | pt_loss: 1.6640 | pg_loss: 0.5094 | reg_loss: 1.3934 | reward: -1.1262 | rev_kl: 0.8152 | stu_lens: 122.5000 | mixed_lens: 55.0000 | lr: 3.7500e-06 | scale: 2048.00 | time: 26.428 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:     78/  5000| tot_loss: 3.1802 | rl_loss: 1.3001 | pt_loss: 1.8801 | pg_loss: 0.2843 | reg_loss: 1.0158 | reward: -0.3354 | rev_kl: 1.0136 | stu_lens: 71.5000 | mixed_lens: 83.0000 | lr: 3.8000e-06 | scale: 2048.00 | time: 26.493 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:     79/  5000| tot_loss: 2.8368 | rl_loss: 1.4172 | pt_loss: 1.4196 | pg_loss: 0.3952 | reg_loss: 1.0221 | reward: -0.5194 | rev_kl: 1.1771 | stu_lens: 60.5000 | mixed_lens: 81.0000 | lr: 3.8500e-06 | scale: 2048.00 | time: 26.494 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     80/  5000| tot_loss: 2.4872 | rl_loss: 0.8073 | pt_loss: 1.6799 | pg_loss: 0.1534 | reg_loss: 0.6539 | reward: -0.5034 | rev_kl: 0.4786 | stu_lens: 117.5000 | mixed_lens: 73.5000 | lr: 3.9000e-06 | scale: 2048.00 | time: 26.530 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     80/  5000| tot_loss: 3.2185 | rl_loss: 1.3875 | pt_loss: 1.8310 | pg_loss: 0.4098 | reg_loss: 0.9777 | reward: -0.4544 | rev_kl: 0.9160 | stu_lens: 90.2344 | mixed_lens: 87.9375 | lr: 3.9000e-06 | scale: 2048.00 | time: 26.530 | step time: 27.761
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:     81/  5000| tot_loss: 2.7813 | rl_loss: 0.8186 | pt_loss: 1.9626 | pg_loss: 0.1017 | reg_loss: 0.7169 | reward: -0.1880 | rev_kl: 0.6761 | stu_lens: 110.5000 | mixed_lens: 99.0000 | lr: 3.9500e-06 | scale: 2048.00 | time: 26.456 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:     82/  5000| tot_loss: 2.9001 | rl_loss: 0.8346 | pt_loss: 2.0655 | pg_loss: 0.0746 | reg_loss: 0.7600 | reward: -0.2367 | rev_kl: 0.7611 | stu_lens: 105.0000 | mixed_lens: 111.0000 | lr: 4.0000e-06 | scale: 2048.00 | time: 26.458 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:     83/  5000| tot_loss: 3.0041 | rl_loss: 1.1881 | pt_loss: 1.8160 | pg_loss: 0.5338 | reg_loss: 0.6543 | reward: -0.7798 | rev_kl: 0.9839 | stu_lens: 76.5000 | mixed_lens: 65.5000 | lr: 4.0500e-06 | scale: 2048.00 | time: 26.459 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:     84/  5000| tot_loss: 2.2225 | rl_loss: 0.4264 | pt_loss: 1.7961 | pg_loss: 0.1017 | reg_loss: 0.3247 | reward: -0.2730 | rev_kl: 0.5166 | stu_lens: 110.5000 | mixed_lens: 73.5000 | lr: 4.1000e-06 | scale: 2048.00 | time: 26.528 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:     85/  5000| tot_loss: 2.1552 | rl_loss: 0.6295 | pt_loss: 1.5257 | pg_loss: -0.0241 | reg_loss: 0.6536 | reward: -0.1307 | rev_kl: 0.6757 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1500e-06 | scale: 2048.00 | time: 26.485 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:     86/  5000| tot_loss: 3.5593 | rl_loss: 1.8188 | pt_loss: 1.7406 | pg_loss: 0.9078 | reg_loss: 0.9109 | reward: -1.4734 | rev_kl: 1.1961 | stu_lens: 128.0000 | mixed_lens: 32.0000 | lr: 4.2000e-06 | scale: 2048.00 | time: 26.462 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:     87/  5000| tot_loss: 2.0878 | rl_loss: 0.4252 | pt_loss: 1.6626 | pg_loss: -0.0042 | reg_loss: 0.4294 | reward: -0.2061 | rev_kl: 0.6530 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.2500e-06 | scale: 2048.00 | time: 26.455 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:     88/  5000| tot_loss: 2.7161 | rl_loss: 0.9590 | pt_loss: 1.7570 | pg_loss: 0.3886 | reg_loss: 0.5705 | reward: -0.3533 | rev_kl: 1.0091 | stu_lens: 45.5000 | mixed_lens: 69.0000 | lr: 4.3000e-06 | scale: 2048.00 | time: 26.519 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:     89/  5000| tot_loss: 1.9150 | rl_loss: 0.7170 | pt_loss: 1.1980 | pg_loss: 0.1095 | reg_loss: 0.6075 | reward: -0.3939 | rev_kl: 0.8588 | stu_lens: 128.0000 | mixed_lens: 107.0000 | lr: 4.3500e-06 | scale: 2048.00 | time: 26.501 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:     90/  5000| tot_loss: 2.8971 | rl_loss: 1.3159 | pt_loss: 1.5812 | pg_loss: 0.6607 | reg_loss: 0.6552 | reward: -0.2967 | rev_kl: 0.6025 | stu_lens: 25.5000 | mixed_lens: 54.5000 | lr: 4.4000e-06 | scale: 2048.00 | time: 26.518 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:     91/  5000| tot_loss: 2.7643 | rl_loss: 0.9773 | pt_loss: 1.7870 | pg_loss: 0.3325 | reg_loss: 0.6448 | reward: -0.4833 | rev_kl: 1.2462 | stu_lens: 35.5000 | mixed_lens: 80.5000 | lr: 4.4500e-06 | scale: 2048.00 | time: 26.477 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:     92/  5000| tot_loss: 2.6795 | rl_loss: 1.0099 | pt_loss: 1.6696 | pg_loss: 0.4427 | reg_loss: 0.5672 | reward: -0.1682 | rev_kl: 0.6626 | stu_lens: 128.0000 | mixed_lens: 80.0000 | lr: 4.5000e-06 | scale: 2048.00 | time: 26.480 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:     93/  5000| tot_loss: 3.2284 | rl_loss: 1.4550 | pt_loss: 1.7733 | pg_loss: 0.5391 | reg_loss: 0.9160 | reward: -0.4742 | rev_kl: 0.9269 | stu_lens: 70.0000 | mixed_lens: 70.0000 | lr: 4.5500e-06 | scale: 2048.00 | time: 26.376 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:     94/  5000| tot_loss: 2.7848 | rl_loss: 0.8748 | pt_loss: 1.9100 | pg_loss: 0.0240 | reg_loss: 0.8509 | reward: -0.3375 | rev_kl: 0.7879 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6000e-06 | scale: 2048.00 | time: 26.420 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:     95/  5000| tot_loss: 2.6669 | rl_loss: 0.8817 | pt_loss: 1.7852 | pg_loss: 0.0120 | reg_loss: 0.8697 | reward: -0.1609 | rev_kl: 0.8707 | stu_lens: 106.0000 | mixed_lens: 128.0000 | lr: 4.6500e-06 | scale: 2048.00 | time: 26.392 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     96/  5000| tot_loss: 2.2421 | rl_loss: 0.5410 | pt_loss: 1.7011 | pg_loss: -0.0209 | reg_loss: 0.5619 | reward: -0.2474 | rev_kl: 1.0313 | stu_lens: 89.0000 | mixed_lens: 128.0000 | lr: 4.7000e-06 | scale: 2048.00 | time: 26.435 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     96/  5000| tot_loss: 2.6744 | rl_loss: 0.9509 | pt_loss: 1.7234 | pg_loss: 0.3112 | reg_loss: 0.6398 | reward: -0.4177 | rev_kl: 0.8749 | stu_lens: 89.6719 | mixed_lens: 87.0781 | lr: 4.7000e-06 | scale: 2048.00 | time: 26.435 | step time: 27.750
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:     97/  5000| tot_loss: 2.5219 | rl_loss: 0.9019 | pt_loss: 1.6200 | pg_loss: 0.0595 | reg_loss: 0.8424 | reward: -0.2823 | rev_kl: 0.9815 | stu_lens: 119.0000 | mixed_lens: 123.0000 | lr: 4.7500e-06 | scale: 2048.00 | time: 26.369 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:     98/  5000| tot_loss: 2.5095 | rl_loss: 0.6628 | pt_loss: 1.8466 | pg_loss: 0.0073 | reg_loss: 0.6555 | reward: -0.1710 | rev_kl: 0.9786 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8000e-06 | scale: 2048.00 | time: 26.382 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:     99/  5000| tot_loss: 2.5137 | rl_loss: 0.4363 | pt_loss: 2.0774 | pg_loss: -0.0153 | reg_loss: 0.4516 | reward: -0.1521 | rev_kl: 0.9942 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8500e-06 | scale: 2048.00 | time: 26.379 | step time: 0.000
                                 Evaluation #1                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son los partículas        │
│                                       │ subatómicas que forman la            │
│                                       │ constitución de la materia. Los      │
│                                       │ cuarks tienen carga de color y carga │
│                                       │ de Electricidad. Existen seis tipos  │
│                                       │ de cuarks:                           │
│                                       │                                      │
│                                       │ * Cuark de baja masa o cuark up,     │
│                                       │ tiene carga de color de +2/3 y carga │
│                                       │ de Electricidad de +2/3.             │
│                                       │ * Cuark de mediana masa o cuark      │
│                                       │ charm, tiene carga de color de +1/3  │
│                                       │ y carga de Electricidad de +1/3.     │
│                                       │ * Cuark de alta masa                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es un tipo de estructura de   │
│                                       │ trabajo. El IMC es un término        │
│                                       │ acrónimo que se origina de las       │
│                                       │ palabras inglés: Integrated,         │
│                                       │ Management, and Control.             │
│                                       │                                      │
│                                       │ El IMC es usado ampliamente en los   │
│                                       │ negocios para describir un proceso   │
│                                       │ que se aplica para la gestión de una │
│                                       │ actividad. El IMC también se puede   │
│                                       │ utilizar para describir la           │
│                                       │ coordinación de los diferentes       │
│                                       │ objetivos y actividades asociadas a  │
│                                       │ una compleja estructura              │
│                                       │ organizacional.                      │
│                                       │                                      │
│                                       │ El IMC es una estructura que se      │
│                                       │ aplica para la coord                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ * Alfa (1974): En la década de 1970, │
│                                       │ el proyecto de la cápsula del tiempo │
│                                       │ Alfa fue encargado por los gobiernos │
│                                       │ francés y estadounidense. La nave    │
│                                       │ espacial fue lanzada por un cohete   │
│                                       │ Saturn V y se estrelló a finales de  │
│                                       │ 1974, siendo la primera cápsula del  │
│                                       │ tiempo en explotar. Se pueden        │
│                                       │ encontrar diversas fotografías de la │
│                                       │ cápsula en Google.                   │
│                                       │                                      │
│                                       │ * Snoopy (1977): Snoopy es la        │
│                                       │ cápsula del tiempo que               │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.025 | exact_match: 0.000 | rev_kl: 1.008 | lens: 97.709 | pt_loss: 1.766 | lm_loss: 1.916 | kd_loss: 1.615 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    100/  5000| tot_loss: 2.5517 | rl_loss: 0.6311 | pt_loss: 1.9206 | pg_loss: 0.2027 | reg_loss: 0.4284 | reward: -0.3139 | rev_kl: 0.6951 | stu_lens: 128.0000 | mixed_lens: 93.0000 | lr: 4.9000e-06 | scale: 2048.00 | time: 26.391 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    101/  5000| tot_loss: 1.8882 | rl_loss: 0.7183 | pt_loss: 1.1699 | pg_loss: 0.2831 | reg_loss: 0.4352 | reward: -1.0611 | rev_kl: 0.7751 | stu_lens: 128.0000 | mixed_lens: 54.5000 | lr: 4.9500e-06 | scale: 2048.00 | time: 26.388 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    102/  5000| tot_loss: 2.7471 | rl_loss: 0.8632 | pt_loss: 1.8839 | pg_loss: 0.2154 | reg_loss: 0.6478 | reward: -0.4081 | rev_kl: 0.7764 | stu_lens: 100.5000 | mixed_lens: 103.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.341 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    103/  5000| tot_loss: 1.6617 | rl_loss: 0.3682 | pt_loss: 1.2935 | pg_loss: 0.0121 | reg_loss: 0.3561 | reward: -0.2291 | rev_kl: 0.8898 | stu_lens: 63.0000 | mixed_lens: 114.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.349 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    104/  5000| tot_loss: 2.4357 | rl_loss: 0.6043 | pt_loss: 1.8314 | pg_loss: 0.1200 | reg_loss: 0.4842 | reward: -0.1331 | rev_kl: 0.6557 | stu_lens: 128.0000 | mixed_lens: 105.5000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    105/  5000| tot_loss: 2.8343 | rl_loss: 0.7438 | pt_loss: 2.0905 | pg_loss: 0.2923 | reg_loss: 0.4514 | reward: -0.4461 | rev_kl: 1.0762 | stu_lens: 71.5000 | mixed_lens: 83.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.376 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    106/  5000| tot_loss: 2.5315 | rl_loss: 0.6493 | pt_loss: 1.8822 | pg_loss: 0.1309 | reg_loss: 0.5184 | reward: -0.1621 | rev_kl: 0.7791 | stu_lens: 128.0000 | mixed_lens: 105.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.336 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    107/  5000| tot_loss: 2.7661 | rl_loss: 0.9549 | pt_loss: 1.8112 | pg_loss: 0.3980 | reg_loss: 0.5569 | reward: -0.9890 | rev_kl: 0.9581 | stu_lens: 68.0000 | mixed_lens: 70.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.406 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    108/  5000| tot_loss: 2.6204 | rl_loss: 0.6840 | pt_loss: 1.9364 | pg_loss: 0.2084 | reg_loss: 0.4756 | reward: -0.5584 | rev_kl: 1.0329 | stu_lens: 82.5000 | mixed_lens: 81.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.382 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    109/  5000| tot_loss: 2.3093 | rl_loss: 0.5219 | pt_loss: 1.7874 | pg_loss: 0.0024 | reg_loss: 0.5195 | reward: -0.1646 | rev_kl: 2.0761 | stu_lens: 66.5000 | mixed_lens: 128.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.389 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    110/  5000| tot_loss: 2.2706 | rl_loss: 0.5530 | pt_loss: 1.7176 | pg_loss: 0.0052 | reg_loss: 0.5477 | reward: -0.2581 | rev_kl: 1.1788 | stu_lens: 78.5000 | mixed_lens: 128.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.345 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    111/  5000| tot_loss: 2.8616 | rl_loss: 1.1983 | pt_loss: 1.6633 | pg_loss: 0.7322 | reg_loss: 0.4661 | reward: -0.4300 | rev_kl: 0.6275 | stu_lens: 70.0000 | mixed_lens: 45.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.359 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    112/  5000| tot_loss: 1.9487 | rl_loss: 0.3623 | pt_loss: 1.5864 | pg_loss: 0.0155 | reg_loss: 0.3468 | reward: -0.2534 | rev_kl: 1.0953 | stu_lens: 116.0000 | mixed_lens: 128.0000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    112/  5000| tot_loss: 2.5192 | rl_loss: 0.7484 | pt_loss: 1.7708 | pg_loss: 0.2514 | reg_loss: 0.4970 | reward: -0.3845 | rev_kl: 0.9130 | stu_lens: 93.3125 | mixed_lens: 91.7656 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.300 | step time: 27.658
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    113/  5000| tot_loss: 2.3988 | rl_loss: 0.8064 | pt_loss: 1.5924 | pg_loss: 0.1907 | reg_loss: 0.6156 | reward: -0.2830 | rev_kl: 0.6647 | stu_lens: 87.0000 | mixed_lens: 87.5000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.375 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    114/  5000| tot_loss: 2.8238 | rl_loss: 1.2758 | pt_loss: 1.5480 | pg_loss: 1.0135 | reg_loss: 0.2624 | reward: -0.7348 | rev_kl: 0.6441 | stu_lens: 59.5000 | mixed_lens: 15.5000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    115/  5000| tot_loss: 1.8843 | rl_loss: 0.4592 | pt_loss: 1.4251 | pg_loss: 0.0855 | reg_loss: 0.3737 | reward: -0.4216 | rev_kl: 0.8101 | stu_lens: 128.0000 | mixed_lens: 107.0000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.362 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    116/  5000| tot_loss: 2.6711 | rl_loss: 0.6472 | pt_loss: 2.0239 | pg_loss: 0.2241 | reg_loss: 0.4231 | reward: -0.1932 | rev_kl: 0.5549 | stu_lens: 70.5000 | mixed_lens: 70.5000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    117/  5000| tot_loss: 2.4379 | rl_loss: 0.5387 | pt_loss: 1.8991 | pg_loss: 0.2034 | reg_loss: 0.3353 | reward: -0.8227 | rev_kl: 1.0797 | stu_lens: 37.5000 | mixed_lens: 82.0000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.350 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    118/  5000| tot_loss: 2.2327 | rl_loss: 0.6446 | pt_loss: 1.5881 | pg_loss: 0.2473 | reg_loss: 0.3973 | reward: -0.8790 | rev_kl: 0.9095 | stu_lens: 128.0000 | mixed_lens: 80.0000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    119/  5000| tot_loss: 1.9426 | rl_loss: 0.5170 | pt_loss: 1.4256 | pg_loss: 0.1786 | reg_loss: 0.3385 | reward: -0.1987 | rev_kl: 0.5222 | stu_lens: 128.0000 | mixed_lens: 93.0000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.341 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    120/  5000| tot_loss: 2.3400 | rl_loss: 0.4414 | pt_loss: 1.8986 | pg_loss: 0.1309 | reg_loss: 0.3106 | reward: -0.3610 | rev_kl: 1.1321 | stu_lens: 71.0000 | mixed_lens: 103.0000 | lr: 4.9998e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    121/  5000| tot_loss: 1.9362 | rl_loss: 0.4049 | pt_loss: 1.5313 | pg_loss: -0.0153 | reg_loss: 0.4203 | reward: -0.2315 | rev_kl: 0.5459 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9998e-06 | scale: 2048.00 | time: 26.352 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    122/  5000| tot_loss: 2.3829 | rl_loss: 0.5632 | pt_loss: 1.8197 | pg_loss: 0.1854 | reg_loss: 0.3778 | reward: -0.4172 | rev_kl: 0.8017 | stu_lens: 83.0000 | mixed_lens: 86.5000 | lr: 4.9998e-06 | scale: 2048.00 | time: 26.354 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    123/  5000| tot_loss: 4.0831 | rl_loss: 0.6184 | pt_loss: 3.4646 | pg_loss: 0.3988 | reg_loss: 0.2196 | reward: -0.5767 | rev_kl: 0.9006 | stu_lens: 62.5000 | mixed_lens: 73.5000 | lr: 4.9998e-06 | scale: 2048.00 | time: 26.386 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    124/  5000| tot_loss: 2.6267 | rl_loss: 0.4477 | pt_loss: 2.1790 | pg_loss: -0.0233 | reg_loss: 0.4710 | reward: -0.1450 | rev_kl: 0.8211 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9998e-06 | scale: 2048.00 | time: 26.390 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    125/  5000| tot_loss: 2.2711 | rl_loss: 0.4668 | pt_loss: 1.8044 | pg_loss: 0.0997 | reg_loss: 0.3671 | reward: -0.7762 | rev_kl: 1.0743 | stu_lens: 128.0000 | mixed_lens: 80.0000 | lr: 4.9997e-06 | scale: 2048.00 | time: 26.354 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    126/  5000| tot_loss: 2.2978 | rl_loss: 0.9694 | pt_loss: 1.3284 | pg_loss: 0.6515 | reg_loss: 0.3179 | reward: -0.9830 | rev_kl: 1.1950 | stu_lens: 55.0000 | mixed_lens: 34.0000 | lr: 4.9997e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    127/  5000| tot_loss: 1.9978 | rl_loss: 0.6087 | pt_loss: 1.3891 | pg_loss: 0.2306 | reg_loss: 0.3781 | reward: -0.5233 | rev_kl: 0.6435 | stu_lens: 87.5000 | mixed_lens: 87.5000 | lr: 4.9997e-06 | scale: 2048.00 | time: 26.347 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    128/  5000| tot_loss: 2.2766 | rl_loss: 0.4163 | pt_loss: 1.8602 | pg_loss: 0.0229 | reg_loss: 0.3935 | reward: -0.1983 | rev_kl: 1.2311 | stu_lens: 68.0000 | mixed_lens: 124.5000 | lr: 4.9997e-06 | scale: 2048.00 | time: 26.310 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    128/  5000| tot_loss: 2.4576 | rl_loss: 0.6884 | pt_loss: 1.7693 | pg_loss: 0.2760 | reg_loss: 0.4124 | reward: -0.4293 | rev_kl: 0.8689 | stu_lens: 89.2344 | mixed_lens: 86.9531 | lr: 4.9997e-06 | scale: 2048.00 | time: 26.310 | step time: 27.632
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    129/  5000| tot_loss: 2.3443 | rl_loss: 0.5090 | pt_loss: 1.8353 | pg_loss: -0.0087 | reg_loss: 0.5176 | reward: -0.2780 | rev_kl: 0.7856 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9996e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    130/  5000| tot_loss: 4.9045 | rl_loss: 3.1023 | pt_loss: 1.8021 | pg_loss: 1.7835 | reg_loss: 1.3189 | reward: -1.7354 | rev_kl: 1.3023 | stu_lens: 56.0000 | mixed_lens: 19.0000 | lr: 4.9996e-06 | scale: 2048.00 | time: 26.387 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    131/  5000| tot_loss: 2.8709 | rl_loss: 1.3378 | pt_loss: 1.5331 | pg_loss: 0.2787 | reg_loss: 1.0591 | reward: -0.1594 | rev_kl: 1.1199 | stu_lens: 86.0000 | mixed_lens: 93.0000 | lr: 4.9996e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    132/  5000| tot_loss: 2.7161 | rl_loss: 1.1936 | pt_loss: 1.5226 | pg_loss: 0.2774 | reg_loss: 0.9161 | reward: -0.2564 | rev_kl: 14.2032 | stu_lens: 89.5000 | mixed_lens: 85.5000 | lr: 4.9995e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    133/  5000| tot_loss: 3.4928 | rl_loss: 1.8498 | pt_loss: 1.6430 | pg_loss: 0.9850 | reg_loss: 0.8648 | reward: -0.1778 | rev_kl: 0.5832 | stu_lens: 27.5000 | mixed_lens: 48.0000 | lr: 4.9995e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    134/  5000| tot_loss: 3.7164 | rl_loss: 1.9638 | pt_loss: 1.7526 | pg_loss: 0.5155 | reg_loss: 1.4484 | reward: -0.4212 | rev_kl: 1.3702 | stu_lens: 101.5000 | mixed_lens: 63.0000 | lr: 4.9995e-06 | scale: 2048.00 | time: 26.357 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    135/  5000| tot_loss: 3.9735 | rl_loss: 2.0711 | pt_loss: 1.9023 | pg_loss: 0.9455 | reg_loss: 1.1256 | reward: -0.7344 | rev_kl: 0.7358 | stu_lens: 55.5000 | mixed_lens: 45.5000 | lr: 4.9994e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    136/  5000| tot_loss: 2.8375 | rl_loss: 1.4579 | pt_loss: 1.3796 | pg_loss: 0.2723 | reg_loss: 1.1856 | reward: -0.4252 | rev_kl: 1.1920 | stu_lens: 113.0000 | mixed_lens: 103.0000 | lr: 4.9994e-06 | scale: 2048.00 | time: 26.314 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    137/  5000| tot_loss: 2.9165 | rl_loss: 1.1763 | pt_loss: 1.7402 | pg_loss: 0.2570 | reg_loss: 0.9193 | reward: -0.2174 | rev_kl: 1.3370 | stu_lens: 128.0000 | mixed_lens: 102.0000 | lr: 4.9994e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    138/  5000| tot_loss: 3.1543 | rl_loss: 1.2007 | pt_loss: 1.9536 | pg_loss: 0.0763 | reg_loss: 1.1245 | reward: -0.2923 | rev_kl: 0.8888 | stu_lens: 98.0000 | mixed_lens: 119.0000 | lr: 4.9993e-06 | scale: 2048.00 | time: 26.355 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    139/  5000| tot_loss: 3.1849 | rl_loss: 1.5558 | pt_loss: 1.6290 | pg_loss: 0.3337 | reg_loss: 1.2221 | reward: -0.3402 | rev_kl: 0.7086 | stu_lens: 43.0000 | mixed_lens: 84.0000 | lr: 4.9993e-06 | scale: 2048.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    140/  5000| tot_loss: 4.3114 | rl_loss: 2.4550 | pt_loss: 1.8564 | pg_loss: 1.1204 | reg_loss: 1.3346 | reward: -0.9812 | rev_kl: 0.9666 | stu_lens: 32.5000 | mixed_lens: 38.5000 | lr: 4.9993e-06 | scale: 2048.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    141/  5000| tot_loss: 3.0273 | rl_loss: 1.0924 | pt_loss: 1.9349 | pg_loss: 0.1454 | reg_loss: 0.9470 | reward: -0.4220 | rev_kl: 1.4619 | stu_lens: 128.0000 | mixed_lens: 111.5000 | lr: 4.9992e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    142/  5000| tot_loss: 2.5571 | rl_loss: 0.9126 | pt_loss: 1.6445 | pg_loss: 0.1398 | reg_loss: 0.7727 | reward: -0.0724 | rev_kl: 0.9912 | stu_lens: 88.5000 | mixed_lens: 121.0000 | lr: 4.9992e-06 | scale: 2048.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    143/  5000| tot_loss: 4.5383 | rl_loss: 2.5568 | pt_loss: 1.9815 | pg_loss: 0.5773 | reg_loss: 1.9795 | reward: -0.2194 | rev_kl: 1.0961 | stu_lens: 73.5000 | mixed_lens: 73.5000 | lr: 4.9991e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    144/  5000| tot_loss: 2.7863 | rl_loss: 1.3202 | pt_loss: 1.4662 | pg_loss: 0.0543 | reg_loss: 1.2659 | reward: -0.3539 | rev_kl: 1.0857 | stu_lens: 123.5000 | mixed_lens: 128.0000 | lr: 4.9991e-06 | scale: 2048.00 | time: 26.323 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    144/  5000| tot_loss: 3.1597 | rl_loss: 1.4527 | pt_loss: 1.7070 | pg_loss: 0.3705 | reg_loss: 1.0822 | reward: -0.4615 | rev_kl: 1.4690 | stu_lens: 88.2031 | mixed_lens: 92.8125 | lr: 4.9991e-06 | scale: 2048.00 | time: 26.323 | step time: 27.610
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    145/  5000| tot_loss: 3.3591 | rl_loss: 1.5767 | pt_loss: 1.7824 | pg_loss: 0.5241 | reg_loss: 1.0526 | reward: -0.3791 | rev_kl: 2.2583 | stu_lens: 58.5000 | mixed_lens: 75.5000 | lr: 4.9990e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    146/  5000| tot_loss: 2.6121 | rl_loss: 0.8156 | pt_loss: 1.7965 | pg_loss: 0.3269 | reg_loss: 0.4888 | reward: -0.6772 | rev_kl: 0.8809 | stu_lens: 40.5000 | mixed_lens: 73.5000 | lr: 4.9990e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    147/  5000| tot_loss: 2.5155 | rl_loss: 0.6924 | pt_loss: 1.8231 | pg_loss: 0.0468 | reg_loss: 0.6456 | reward: -0.1633 | rev_kl: 1.7412 | stu_lens: 128.0000 | mixed_lens: 125.5000 | lr: 4.9990e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    148/  5000| tot_loss: 2.7334 | rl_loss: 0.5819 | pt_loss: 2.1515 | pg_loss: 0.0038 | reg_loss: 0.5781 | reward: -0.1031 | rev_kl: 0.6499 | stu_lens: 108.0000 | mixed_lens: 128.0000 | lr: 4.9989e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    149/  5000| tot_loss: 4.1064 | rl_loss: 2.2809 | pt_loss: 1.8255 | pg_loss: 1.6278 | reg_loss: 0.6530 | reward: -1.5224 | rev_kl: 0.8320 | stu_lens: 56.5000 | mixed_lens: 19.5000 | lr: 4.9989e-06 | scale: 2048.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    150/  5000| tot_loss: 2.7136 | rl_loss: 0.7980 | pt_loss: 1.9156 | pg_loss: 0.0103 | reg_loss: 0.7877 | reward: -0.3194 | rev_kl: 1.2137 | stu_lens: 97.5000 | mixed_lens: 128.0000 | lr: 4.9988e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    151/  5000| tot_loss: 2.6616 | rl_loss: 1.1922 | pt_loss: 1.4694 | pg_loss: 0.2553 | reg_loss: 0.9369 | reward: -0.3332 | rev_kl: 1.1614 | stu_lens: 101.5000 | mixed_lens: 98.0000 | lr: 4.9988e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    152/  5000| tot_loss: 3.0223 | rl_loss: 1.0643 | pt_loss: 1.9580 | pg_loss: 0.5933 | reg_loss: 0.4710 | reward: -0.5398 | rev_kl: 0.5341 | stu_lens: 34.0000 | mixed_lens: 67.5000 | lr: 4.9987e-06 | scale: 2048.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    153/  5000| tot_loss: 3.2757 | rl_loss: 1.7187 | pt_loss: 1.5569 | pg_loss: 1.0303 | reg_loss: 0.6885 | reward: -2.0710 | rev_kl: 0.9391 | stu_lens: 113.0000 | mixed_lens: 41.0000 | lr: 4.9987e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    154/  5000| tot_loss: 2.9746 | rl_loss: 1.2006 | pt_loss: 1.7741 | pg_loss: 0.3304 | reg_loss: 0.8701 | reward: -0.3861 | rev_kl: 1.0162 | stu_lens: 98.0000 | mixed_lens: 84.0000 | lr: 4.9986e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    155/  5000| tot_loss: 2.6194 | rl_loss: 0.7984 | pt_loss: 1.8211 | pg_loss: 0.2071 | reg_loss: 0.5913 | reward: -0.3070 | rev_kl: 0.6425 | stu_lens: 44.5000 | mixed_lens: 84.0000 | lr: 4.9986e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    156/  5000| tot_loss: 2.1147 | rl_loss: 0.4686 | pt_loss: 1.6460 | pg_loss: 0.1168 | reg_loss: 0.3518 | reward: -0.1655 | rev_kl: 0.8373 | stu_lens: 110.0000 | mixed_lens: 72.0000 | lr: 4.9985e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    157/  5000| tot_loss: 2.8483 | rl_loss: 1.1842 | pt_loss: 1.6641 | pg_loss: 0.3939 | reg_loss: 0.7903 | reward: -1.2543 | rev_kl: 1.2906 | stu_lens: 64.0000 | mixed_lens: 58.5000 | lr: 4.9984e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    158/  5000| tot_loss: 2.0774 | rl_loss: 0.5697 | pt_loss: 1.5078 | pg_loss: -0.0142 | reg_loss: 0.5838 | reward: -0.0744 | rev_kl: 1.0407 | stu_lens: 117.0000 | mixed_lens: 128.0000 | lr: 4.9984e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    159/  5000| tot_loss: 3.0674 | rl_loss: 1.0761 | pt_loss: 1.9913 | pg_loss: 0.3325 | reg_loss: 0.7436 | reward: -1.3393 | rev_kl: 0.9188 | stu_lens: 28.0000 | mixed_lens: 67.5000 | lr: 4.9983e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    160/  5000| tot_loss: 2.5377 | rl_loss: 1.1797 | pt_loss: 1.3580 | pg_loss: 0.1365 | reg_loss: 1.0431 | reward: -0.4923 | rev_kl: 1.3305 | stu_lens: 110.0000 | mixed_lens: 101.5000 | lr: 4.9983e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    160/  5000| tot_loss: 2.7728 | rl_loss: 1.0372 | pt_loss: 1.7357 | pg_loss: 0.3331 | reg_loss: 0.7041 | reward: -0.4873 | rev_kl: 1.5470 | stu_lens: 79.5469 | mixed_lens: 87.4062 | lr: 4.9983e-06 | scale: 2048.00 | time: 26.305 | step time: 27.581
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    161/  5000| tot_loss: 2.1911 | rl_loss: 0.7691 | pt_loss: 1.4220 | pg_loss: 0.1300 | reg_loss: 0.6390 | reward: -0.5510 | rev_kl: 1.1834 | stu_lens: 128.0000 | mixed_lens: 111.5000 | lr: 4.9982e-06 | scale: 2048.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    162/  5000| tot_loss: 2.7413 | rl_loss: 1.0051 | pt_loss: 1.7362 | pg_loss: 0.3840 | reg_loss: 0.6212 | reward: -1.2934 | rev_kl: 1.1347 | stu_lens: 56.5000 | mixed_lens: 49.0000 | lr: 4.9982e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    163/  5000| tot_loss: 2.6572 | rl_loss: 0.8602 | pt_loss: 1.7970 | pg_loss: 0.2948 | reg_loss: 0.5655 | reward: -0.6015 | rev_kl: 1.6147 | stu_lens: 95.5000 | mixed_lens: 92.5000 | lr: 4.9981e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    164/  5000| tot_loss: 2.0208 | rl_loss: 0.3361 | pt_loss: 1.6847 | pg_loss: -0.0069 | reg_loss: 0.3430 | reward: -0.1283 | rev_kl: 0.9224 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9980e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    165/  5000| tot_loss: 2.2549 | rl_loss: 0.4018 | pt_loss: 1.8531 | pg_loss: 0.0010 | reg_loss: 0.4008 | reward: -0.1791 | rev_kl: 1.1025 | stu_lens: 128.0000 | mixed_lens: 125.0000 | lr: 4.9980e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    166/  5000| tot_loss: 1.9181 | rl_loss: 0.5009 | pt_loss: 1.4172 | pg_loss: 0.0083 | reg_loss: 0.4926 | reward: -0.3578 | rev_kl: 1.4649 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9979e-06 | scale: 2048.00 | time: 26.314 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    167/  5000| tot_loss: 3.6213 | rl_loss: 0.8586 | pt_loss: 2.7627 | pg_loss: 0.2440 | reg_loss: 0.6147 | reward: -0.4467 | rev_kl: 1.2277 | stu_lens: 57.0000 | mixed_lens: 112.0000 | lr: 4.9978e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    168/  5000| tot_loss: 2.1761 | rl_loss: 0.7929 | pt_loss: 1.3832 | pg_loss: 0.3288 | reg_loss: 0.4641 | reward: -0.7104 | rev_kl: 1.0303 | stu_lens: 116.0000 | mixed_lens: 79.5000 | lr: 4.9978e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    169/  5000| tot_loss: 3.2325 | rl_loss: 1.6040 | pt_loss: 1.6285 | pg_loss: 1.1938 | reg_loss: 0.4103 | reward: -1.2408 | rev_kl: 0.8387 | stu_lens: 18.5000 | mixed_lens: 29.0000 | lr: 4.9977e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    170/  5000| tot_loss: 2.1626 | rl_loss: 0.5707 | pt_loss: 1.5919 | pg_loss: 0.0840 | reg_loss: 0.4867 | reward: -0.1633 | rev_kl: 1.1673 | stu_lens: 98.0000 | mixed_lens: 119.0000 | lr: 4.9976e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    171/  5000| tot_loss: 2.8251 | rl_loss: 0.9725 | pt_loss: 1.8526 | pg_loss: 0.3855 | reg_loss: 0.5870 | reward: -1.9403 | rev_kl: 14.1688 | stu_lens: 96.0000 | mixed_lens: 41.5000 | lr: 4.9976e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    172/  5000| tot_loss: 2.4102 | rl_loss: 0.6488 | pt_loss: 1.7614 | pg_loss: 0.1885 | reg_loss: 0.4603 | reward: -0.3108 | rev_kl: 1.1428 | stu_lens: 113.0000 | mixed_lens: 103.0000 | lr: 4.9975e-06 | scale: 2048.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    173/  5000| tot_loss: 3.0060 | rl_loss: 0.9567 | pt_loss: 2.0494 | pg_loss: 0.5431 | reg_loss: 0.4135 | reward: -0.3701 | rev_kl: 2.0964 | stu_lens: 30.0000 | mixed_lens: 71.0000 | lr: 4.9974e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    174/  5000| tot_loss: 2.1236 | rl_loss: 0.6145 | pt_loss: 1.5091 | pg_loss: 0.0340 | reg_loss: 0.5805 | reward: -0.3371 | rev_kl: 1.0516 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9973e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    175/  5000| tot_loss: 2.7906 | rl_loss: 0.6454 | pt_loss: 2.1453 | pg_loss: 0.2008 | reg_loss: 0.4446 | reward: -0.2178 | rev_kl: 0.5934 | stu_lens: 88.0000 | mixed_lens: 102.0000 | lr: 4.9973e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    176/  5000| tot_loss: 2.1718 | rl_loss: 0.4469 | pt_loss: 1.7249 | pg_loss: -0.0067 | reg_loss: 0.4536 | reward: -0.1226 | rev_kl: 0.8569 | stu_lens: 104.0000 | mixed_lens: 128.0000 | lr: 4.9972e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    176/  5000| tot_loss: 2.5163 | rl_loss: 0.7546 | pt_loss: 1.7616 | pg_loss: 0.2448 | reg_loss: 0.5099 | reward: -0.4283 | rev_kl: 1.5131 | stu_lens: 89.2656 | mixed_lens: 93.3438 | lr: 4.9972e-06 | scale: 2048.00 | time: 26.298 | step time: 27.582
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    177/  5000| tot_loss: 2.1334 | rl_loss: 0.8524 | pt_loss: 1.2810 | pg_loss: 0.4709 | reg_loss: 0.3815 | reward: -1.0631 | rev_kl: 0.7552 | stu_lens: 57.5000 | mixed_lens: 68.0000 | lr: 4.9971e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    178/  5000| tot_loss: 2.1267 | rl_loss: 0.3500 | pt_loss: 1.7768 | pg_loss: 0.0489 | reg_loss: 0.3010 | reward: -0.0932 | rev_kl: 1.3763 | stu_lens: 110.0000 | mixed_lens: 99.0000 | lr: 4.9970e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    179/  5000| tot_loss: 3.0189 | rl_loss: 0.9719 | pt_loss: 2.0470 | pg_loss: 0.2324 | reg_loss: 0.7395 | reward: -0.1436 | rev_kl: 1.7586 | stu_lens: 86.0000 | mixed_lens: 93.5000 | lr: 4.9970e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    180/  5000| tot_loss: 2.5454 | rl_loss: 0.4554 | pt_loss: 2.0900 | pg_loss: 0.2108 | reg_loss: 0.2446 | reward: -0.2167 | rev_kl: 1.0510 | stu_lens: 128.0000 | mixed_lens: 98.5000 | lr: 4.9969e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    181/  5000| tot_loss: 2.5185 | rl_loss: 0.5648 | pt_loss: 1.9537 | pg_loss: 0.1443 | reg_loss: 0.4205 | reward: -0.3977 | rev_kl: 0.8315 | stu_lens: 82.5000 | mixed_lens: 102.5000 | lr: 4.9968e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    182/  5000| tot_loss: 2.3550 | rl_loss: 0.7020 | pt_loss: 1.6531 | pg_loss: 0.2316 | reg_loss: 0.4704 | reward: -0.4046 | rev_kl: 0.8568 | stu_lens: 83.5000 | mixed_lens: 81.5000 | lr: 4.9967e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    183/  5000| tot_loss: 2.1533 | rl_loss: 0.5915 | pt_loss: 1.5618 | pg_loss: 0.0704 | reg_loss: 0.5211 | reward: -0.3862 | rev_kl: 1.0476 | stu_lens: 65.0000 | mixed_lens: 119.0000 | lr: 4.9966e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    184/  5000| tot_loss: 2.5315 | rl_loss: 0.6611 | pt_loss: 1.8704 | pg_loss: 0.1097 | reg_loss: 0.5514 | reward: -0.6927 | rev_kl: 2.2864 | stu_lens: 95.5000 | mixed_lens: 119.5000 | lr: 4.9965e-06 | scale: 2048.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    185/  5000| tot_loss: 2.2745 | rl_loss: 0.5807 | pt_loss: 1.6938 | pg_loss: 0.1537 | reg_loss: 0.4270 | reward: -0.3160 | rev_kl: 1.3889 | stu_lens: 66.0000 | mixed_lens: 106.5000 | lr: 4.9965e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    186/  5000| tot_loss: 2.8495 | rl_loss: 0.7440 | pt_loss: 2.1055 | pg_loss: 0.4136 | reg_loss: 0.3304 | reward: -0.8488 | rev_kl: 0.7702 | stu_lens: 27.0000 | mixed_lens: 77.0000 | lr: 4.9964e-06 | scale: 2048.00 | time: 26.329 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    187/  5000| tot_loss: 3.5804 | rl_loss: 1.6018 | pt_loss: 1.9786 | pg_loss: 1.0172 | reg_loss: 0.5846 | reward: -0.9477 | rev_kl: 2.1736 | stu_lens: 16.5000 | mixed_lens: 27.5000 | lr: 4.9963e-06 | scale: 2048.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    188/  5000| tot_loss: 1.8720 | rl_loss: 0.6213 | pt_loss: 1.2506 | pg_loss: 0.3269 | reg_loss: 0.2944 | reward: -0.1295 | rev_kl: 0.6214 | stu_lens: 88.0000 | mixed_lens: 81.5000 | lr: 4.9962e-06 | scale: 2048.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    189/  5000| tot_loss: 2.3348 | rl_loss: 0.8774 | pt_loss: 1.4574 | pg_loss: 0.3325 | reg_loss: 0.5449 | reward: -0.4445 | rev_kl: 14.4941 | stu_lens: 96.0000 | mixed_lens: 68.5000 | lr: 4.9961e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    190/  5000| tot_loss: 2.3614 | rl_loss: 0.7917 | pt_loss: 1.5697 | pg_loss: 0.3577 | reg_loss: 0.4340 | reward: -0.2368 | rev_kl: 1.1080 | stu_lens: 101.5000 | mixed_lens: 72.0000 | lr: 4.9960e-06 | scale: 2048.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    191/  5000| tot_loss: 2.2869 | rl_loss: 0.7968 | pt_loss: 1.4902 | pg_loss: 0.4524 | reg_loss: 0.3444 | reward: -0.6121 | rev_kl: 0.3894 | stu_lens: 33.5000 | mixed_lens: 72.0000 | lr: 4.9959e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    192/  5000| tot_loss: 1.9229 | rl_loss: 0.4533 | pt_loss: 1.4695 | pg_loss: 0.0165 | reg_loss: 0.4368 | reward: -0.1155 | rev_kl: 1.8671 | stu_lens: 66.5000 | mixed_lens: 128.0000 | lr: 4.9958e-06 | scale: 2048.00 | time: 26.338 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    192/  5000| tot_loss: 2.5160 | rl_loss: 0.7887 | pt_loss: 1.7273 | pg_loss: 0.3387 | reg_loss: 0.4501 | reward: -0.5326 | rev_kl: 1.5180 | stu_lens: 83.0938 | mixed_lens: 87.8594 | lr: 4.9958e-06 | scale: 2048.00 | time: 26.338 | step time: 27.591
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    193/  5000| tot_loss: 2.1673 | rl_loss: 0.5764 | pt_loss: 1.5909 | pg_loss: 0.2209 | reg_loss: 0.3556 | reward: -0.4895 | rev_kl: 0.9624 | stu_lens: 68.5000 | mixed_lens: 84.0000 | lr: 4.9957e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    194/  5000| tot_loss: 3.1231 | rl_loss: 1.2000 | pt_loss: 1.9231 | pg_loss: 0.1838 | reg_loss: 1.0162 | reward: -0.3920 | rev_kl: 1.2359 | stu_lens: 114.5000 | mixed_lens: 98.5000 | lr: 4.9957e-06 | scale: 2048.00 | time: 26.399 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    195/  5000| tot_loss: 3.3502 | rl_loss: 1.3637 | pt_loss: 1.9865 | pg_loss: 0.1841 | reg_loss: 1.1795 | reward: -0.2360 | rev_kl: 0.7804 | stu_lens: 128.0000 | mixed_lens: 112.5000 | lr: 4.9956e-06 | scale: 2048.00 | time: 26.411 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    196/  5000| tot_loss: 3.5744 | rl_loss: 1.9038 | pt_loss: 1.6706 | pg_loss: 0.5694 | reg_loss: 1.3344 | reward: -0.3409 | rev_kl: 1.1609 | stu_lens: 128.0000 | mixed_lens: 79.5000 | lr: 4.9955e-06 | scale: 2048.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    197/  5000| tot_loss: 3.5210 | rl_loss: 1.3587 | pt_loss: 2.1623 | pg_loss: 0.4415 | reg_loss: 0.9172 | reward: -0.3009 | rev_kl: 0.5207 | stu_lens: 71.5000 | mixed_lens: 91.0000 | lr: 4.9954e-06 | scale: 2048.00 | time: 26.338 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    198/  5000| tot_loss: 2.4086 | rl_loss: 1.0591 | pt_loss: 1.3495 | pg_loss: 0.0690 | reg_loss: 0.9902 | reward: -0.1266 | rev_kl: 0.8195 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9953e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    199/  5000| tot_loss: 2.4617 | rl_loss: 0.9917 | pt_loss: 1.4700 | pg_loss: 0.0433 | reg_loss: 0.9484 | reward: -0.2401 | rev_kl: 0.8131 | stu_lens: 88.5000 | mixed_lens: 128.0000 | lr: 4.9952e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
                                 Evaluation #2                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son parte de la teoría de │
│                                       │ la relatividad. De acuerdo con esta  │
│                                       │ teoría, los cuarks son partículas    │
│                                       │ subatómicas que forman las llamadas  │
│                                       │ familias de cuarks. Las familias de  │
│                                       │ cuarks se pueden dividir en dos      │
│                                       │ categorías: los quarks pesados y los │
│                                       │ quarks leves. Los quarks pesados son │
│                                       │ los quarks b, c y t, mientras que    │
│                                       │ los quarks leves son los quarks d, s │
│                                       │ y b. Los quarks pesados tienen una   │
│                                       │ carga electrogénica mayor que los    │
│                                       │ quarks leves.                        │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es un sistema de enrutamiento │
│                                       │ (masculino) o de redistribución      │
│                                       │ (femenino) de carácter global que se │
│                                       │ utiliza para conectar los diferentes │
│                                       │ niveles de enrutamiento de una red.  │
│                                       │                                      │
│                                       │ El IMC es utilizado principalmente   │
│                                       │ para establecer un enrutamiento      │
│                                       │ persistente y estandarizado de datos │
│                                       │ en toda una red.                     │
│                                       │                                      │
│                                       │ Un IMC global es una única red de    │
│                                       │ enrutamiento global que consiste en  │
│                                       │ una red de comienzo y una red de     │
│                                       │ fin. Ambos segmentos son conectados  │
│                                       │ por una red de borde                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los casquetes de tiempos más famosos │
│                                       │ de la historia son:                  │
│                                       │                                      │
│                                       │ - La cápsula del tiempo de 1969,     │
│                                       │ inventada por el doctor Gregory      │
│                                       │ Bokor, y que contenía un video       │
│                                       │ grabado en 2005, abierto el 20 de    │
│                                       │ julio de 2069.                       │
│                                       │ - La cápsula del tiempo de 1795,     │
│                                       │ inventada por el doctor Foster       │
│                                       │ Morey, y que contenia una grabación  │
│                                       │ de 2019, abierta el 10 de julio de   │
│                                       │ 1919                                 │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 18.024 | exact_match: 0.000 | rev_kl: 0.915 | lens: 111.880 | pt_loss: 1.751 | lm_loss: 1.889 | kd_loss: 1.612 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    200/  5000| tot_loss: 3.1921 | rl_loss: 1.2205 | pt_loss: 1.9716 | pg_loss: 0.1271 | reg_loss: 1.0934 | reward: -0.0710 | rev_kl: 0.8497 | stu_lens: 128.0000 | mixed_lens: 119.0000 | lr: 4.9951e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    201/  5000| tot_loss: 3.1808 | rl_loss: 1.2316 | pt_loss: 1.9492 | pg_loss: 0.1453 | reg_loss: 1.0863 | reward: -0.4083 | rev_kl: 0.8506 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 4.9950e-06 | scale: 2048.00 | time: 26.370 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    202/  5000| tot_loss: 2.3280 | rl_loss: 0.8654 | pt_loss: 1.4626 | pg_loss: 0.0359 | reg_loss: 0.8295 | reward: -0.1241 | rev_kl: 0.8979 | stu_lens: 97.5000 | mixed_lens: 128.0000 | lr: 4.9949e-06 | scale: 2048.00 | time: 26.317 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    203/  5000| tot_loss: 2.2630 | rl_loss: 0.9240 | pt_loss: 1.3390 | pg_loss: 0.1197 | reg_loss: 0.8043 | reward: -0.1548 | rev_kl: 0.6851 | stu_lens: 116.5000 | mixed_lens: 99.0000 | lr: 4.9948e-06 | scale: 2048.00 | time: 26.359 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    204/  5000| tot_loss: 3.3496 | rl_loss: 1.5167 | pt_loss: 1.8329 | pg_loss: 0.2844 | reg_loss: 1.2323 | reward: -0.3158 | rev_kl: 1.2254 | stu_lens: 128.0000 | mixed_lens: 99.5000 | lr: 4.9947e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    205/  5000| tot_loss: 3.0728 | rl_loss: 1.0668 | pt_loss: 2.0061 | pg_loss: 0.1608 | reg_loss: 0.9060 | reward: -0.3241 | rev_kl: 1.0779 | stu_lens: 117.0000 | mixed_lens: 111.0000 | lr: 4.9946e-06 | scale: 2048.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    206/  5000| tot_loss: 2.5920 | rl_loss: 1.1770 | pt_loss: 1.4150 | pg_loss: 0.4733 | reg_loss: 0.7038 | reward: -0.2482 | rev_kl: 0.9638 | stu_lens: 97.5000 | mixed_lens: 72.5000 | lr: 4.9944e-06 | scale: 2048.00 | time: 26.367 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    207/  5000| tot_loss: 2.6785 | rl_loss: 1.0235 | pt_loss: 1.6549 | pg_loss: 0.0946 | reg_loss: 0.9289 | reward: -0.1572 | rev_kl: 0.5519 | stu_lens: 64.0000 | mixed_lens: 119.5000 | lr: 4.9943e-06 | scale: 2048.00 | time: 26.314 | step time: 0.000
[2023-12-18 17:00:15,038] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, but hysteresis is 3. Reducing hysteresis to 2
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    208/  5000| tot_loss: 3.8471 | rl_loss: 0.8923 | pt_loss: 2.9548 | pg_loss: 0.0459 | reg_loss: 0.8464 | reward: -0.2066 | rev_kl: 0.8266 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9943e-06 | scale: 2048.00 | time: 2.856 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    208/  5000| tot_loss: 2.8933 | rl_loss: 1.1551 | pt_loss: 1.7382 | pg_loss: 0.2154 | reg_loss: 0.9397 | reward: -0.2612 | rev_kl: 0.9072 | stu_lens: 103.8438 | mixed_lens: 104.3906 | lr: 4.9943e-06 | scale: 2048.00 | time: 2.856 | step time: 26.162
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    209/  5000| tot_loss: 3.1665 | rl_loss: 1.1705 | pt_loss: 1.9960 | pg_loss: 0.0710 | reg_loss: 1.0994 | reward: -0.1896 | rev_kl: 0.8512 | stu_lens: 109.0000 | mixed_lens: 128.0000 | lr: 4.9942e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    210/  5000| tot_loss: 2.3359 | rl_loss: 1.0456 | pt_loss: 1.2903 | pg_loss: 0.2288 | reg_loss: 0.8168 | reward: -0.1570 | rev_kl: 0.9532 | stu_lens: 128.0000 | mixed_lens: 105.5000 | lr: 4.9941e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    211/  5000| tot_loss: 3.0419 | rl_loss: 1.0178 | pt_loss: 2.0242 | pg_loss: 0.4176 | reg_loss: 0.6002 | reward: -0.2709 | rev_kl: 0.9692 | stu_lens: 116.5000 | mixed_lens: 75.0000 | lr: 4.9940e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    212/  5000| tot_loss: 3.0493 | rl_loss: 1.1939 | pt_loss: 1.8554 | pg_loss: 0.5847 | reg_loss: 0.6092 | reward: -0.5408 | rev_kl: 0.9903 | stu_lens: 67.5000 | mixed_lens: 60.0000 | lr: 4.9939e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    213/  5000| tot_loss: 2.3646 | rl_loss: 0.6926 | pt_loss: 1.6719 | pg_loss: 0.0593 | reg_loss: 0.6334 | reward: -0.3680 | rev_kl: 1.0945 | stu_lens: 114.5000 | mixed_lens: 128.0000 | lr: 4.9938e-06 | scale: 2048.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    214/  5000| tot_loss: 2.0050 | rl_loss: 0.3487 | pt_loss: 1.6563 | pg_loss: -0.0046 | reg_loss: 0.3533 | reward: -0.1256 | rev_kl: 0.6829 | stu_lens: 106.0000 | mixed_lens: 126.5000 | lr: 4.9937e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    215/  5000| tot_loss: 2.9739 | rl_loss: 1.1991 | pt_loss: 1.7748 | pg_loss: 0.6507 | reg_loss: 0.5484 | reward: -0.3617 | rev_kl: 0.6097 | stu_lens: 78.0000 | mixed_lens: 72.0000 | lr: 4.9936e-06 | scale: 2048.00 | time: 26.323 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    216/  5000| tot_loss: 2.8942 | rl_loss: 0.7664 | pt_loss: 2.1279 | pg_loss: 0.1241 | reg_loss: 0.6423 | reward: -0.2235 | rev_kl: 1.0407 | stu_lens: 128.0000 | mixed_lens: 126.5000 | lr: 4.9934e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    217/  5000| tot_loss: 2.9429 | rl_loss: 0.8107 | pt_loss: 2.1322 | pg_loss: 0.2918 | reg_loss: 0.5189 | reward: -0.1407 | rev_kl: 0.5816 | stu_lens: 83.5000 | mixed_lens: 81.0000 | lr: 4.9933e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    218/  5000| tot_loss: 2.8829 | rl_loss: 0.5771 | pt_loss: 2.3058 | pg_loss: -0.0113 | reg_loss: 0.5884 | reward: -0.2019 | rev_kl: 0.7897 | stu_lens: 114.0000 | mixed_lens: 128.0000 | lr: 4.9932e-06 | scale: 2048.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    219/  5000| tot_loss: 2.5026 | rl_loss: 0.6294 | pt_loss: 1.8732 | pg_loss: 0.0228 | reg_loss: 0.6066 | reward: -0.1899 | rev_kl: 0.7988 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9931e-06 | scale: 2048.00 | time: 26.378 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    220/  5000| tot_loss: 3.0322 | rl_loss: 0.7523 | pt_loss: 2.2799 | pg_loss: 0.0851 | reg_loss: 0.6672 | reward: -0.4099 | rev_kl: 1.0848 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 4.9930e-06 | scale: 2048.00 | time: 26.349 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    221/  5000| tot_loss: 2.8959 | rl_loss: 0.6685 | pt_loss: 2.2274 | pg_loss: 0.0200 | reg_loss: 0.6486 | reward: -0.1319 | rev_kl: 1.1431 | stu_lens: 95.0000 | mixed_lens: 115.5000 | lr: 4.9928e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    222/  5000| tot_loss: 2.2794 | rl_loss: 0.6267 | pt_loss: 1.6527 | pg_loss: 0.0400 | reg_loss: 0.5867 | reward: -0.1833 | rev_kl: 1.0299 | stu_lens: 112.0000 | mixed_lens: 118.0000 | lr: 4.9927e-06 | scale: 2048.00 | time: 26.323 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    223/  5000| tot_loss: 2.1552 | rl_loss: 0.4471 | pt_loss: 1.7082 | pg_loss: -0.0055 | reg_loss: 0.4525 | reward: -0.1065 | rev_kl: 1.0104 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9926e-06 | scale: 2048.00 | time: 26.338 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    224/  5000| tot_loss: 2.6499 | rl_loss: 0.7716 | pt_loss: 1.8782 | pg_loss: 0.2297 | reg_loss: 0.5420 | reward: -0.0827 | rev_kl: 0.9829 | stu_lens: 115.0000 | mixed_lens: 101.0000 | lr: 4.9925e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    224/  5000| tot_loss: 2.6248 | rl_loss: 0.8180 | pt_loss: 1.8068 | pg_loss: 0.1756 | reg_loss: 0.6424 | reward: -0.2440 | rev_kl: 0.9201 | stu_lens: 110.1406 | mixed_lens: 104.9844 | lr: 4.9925e-06 | scale: 2048.00 | time: 26.305 | step time: 27.607
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    225/  5000| tot_loss: 2.7468 | rl_loss: 0.8408 | pt_loss: 1.9059 | pg_loss: 0.0368 | reg_loss: 0.8040 | reward: -0.2100 | rev_kl: 0.9198 | stu_lens: 70.0000 | mixed_lens: 128.0000 | lr: 4.9924e-06 | scale: 2048.00 | time: 26.323 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    226/  5000| tot_loss: 2.8831 | rl_loss: 1.1071 | pt_loss: 1.7760 | pg_loss: 0.6358 | reg_loss: 0.4713 | reward: -0.1593 | rev_kl: 0.7868 | stu_lens: 83.5000 | mixed_lens: 58.5000 | lr: 4.9922e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    227/  5000| tot_loss: 1.8546 | rl_loss: 0.2973 | pt_loss: 1.5574 | pg_loss: 0.0347 | reg_loss: 0.2625 | reward: -0.1292 | rev_kl: 0.9102 | stu_lens: 95.0000 | mixed_lens: 115.5000 | lr: 4.9921e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    228/  5000| tot_loss: 2.2532 | rl_loss: 0.5400 | pt_loss: 1.7132 | pg_loss: 0.0844 | reg_loss: 0.4557 | reward: -0.4534 | rev_kl: 0.7945 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 4.9920e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    229/  5000| tot_loss: 2.3819 | rl_loss: 0.6010 | pt_loss: 1.7809 | pg_loss: 0.1963 | reg_loss: 0.4048 | reward: -0.2734 | rev_kl: 0.7738 | stu_lens: 116.5000 | mixed_lens: 99.0000 | lr: 4.9918e-06 | scale: 2048.00 | time: 26.348 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    230/  5000| tot_loss: 2.8371 | rl_loss: 0.8619 | pt_loss: 1.9752 | pg_loss: 0.3755 | reg_loss: 0.4864 | reward: -0.1415 | rev_kl: 1.6051 | stu_lens: 78.0000 | mixed_lens: 71.5000 | lr: 4.9917e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    231/  5000| tot_loss: 2.2800 | rl_loss: 0.5690 | pt_loss: 1.7110 | pg_loss: 0.0278 | reg_loss: 0.5411 | reward: -0.1096 | rev_kl: 0.9291 | stu_lens: 109.0000 | mixed_lens: 128.0000 | lr: 4.9916e-06 | scale: 2048.00 | time: 26.368 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    232/  5000| tot_loss: 2.3492 | rl_loss: 0.8689 | pt_loss: 1.4803 | pg_loss: 0.3508 | reg_loss: 0.5181 | reward: -0.2851 | rev_kl: 0.9622 | stu_lens: 97.5000 | mixed_lens: 70.5000 | lr: 4.9915e-06 | scale: 2048.00 | time: 26.375 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    233/  5000| tot_loss: 2.2093 | rl_loss: 0.5386 | pt_loss: 1.6706 | pg_loss: 0.0540 | reg_loss: 0.4846 | reward: -0.1114 | rev_kl: 0.6428 | stu_lens: 128.0000 | mixed_lens: 109.5000 | lr: 4.9913e-06 | scale: 2048.00 | time: 26.365 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    234/  5000| tot_loss: 1.8452 | rl_loss: 0.5490 | pt_loss: 1.2962 | pg_loss: -0.0227 | reg_loss: 0.5718 | reward: -0.1157 | rev_kl: 0.8804 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9912e-06 | scale: 2048.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    235/  5000| tot_loss: 2.4382 | rl_loss: 0.6223 | pt_loss: 1.8159 | pg_loss: 0.0285 | reg_loss: 0.5938 | reward: -0.1173 | rev_kl: 0.6917 | stu_lens: 128.0000 | mixed_lens: 112.5000 | lr: 4.9911e-06 | scale: 2048.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    236/  5000| tot_loss: 2.5585 | rl_loss: 0.5246 | pt_loss: 2.0339 | pg_loss: 0.0388 | reg_loss: 0.4858 | reward: -0.1307 | rev_kl: 0.9300 | stu_lens: 128.0000 | mixed_lens: 119.0000 | lr: 4.9909e-06 | scale: 2048.00 | time: 26.381 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    237/  5000| tot_loss: 2.6271 | rl_loss: 0.7119 | pt_loss: 1.9153 | pg_loss: 0.1717 | reg_loss: 0.5401 | reward: -0.8598 | rev_kl: 0.9479 | stu_lens: 128.0000 | mixed_lens: 74.5000 | lr: 4.9908e-06 | scale: 2048.00 | time: 26.434 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    238/  5000| tot_loss: 2.4893 | rl_loss: 0.7454 | pt_loss: 1.7438 | pg_loss: 0.4417 | reg_loss: 0.3037 | reward: -0.3199 | rev_kl: 0.8063 | stu_lens: 57.5000 | mixed_lens: 70.5000 | lr: 4.9906e-06 | scale: 2048.00 | time: 26.447 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    239/  5000| tot_loss: 1.8326 | rl_loss: 0.5599 | pt_loss: 1.2727 | pg_loss: 0.0254 | reg_loss: 0.5345 | reward: -0.2368 | rev_kl: 0.7612 | stu_lens: 126.5000 | mixed_lens: 128.0000 | lr: 4.9905e-06 | scale: 2048.00 | time: 26.483 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    240/  5000| tot_loss: 2.7054 | rl_loss: 0.6137 | pt_loss: 2.0916 | pg_loss: 0.0072 | reg_loss: 0.6065 | reward: -0.2676 | rev_kl: 0.9914 | stu_lens: 33.0000 | mixed_lens: 128.0000 | lr: 4.9904e-06 | scale: 2048.00 | time: 26.443 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    240/  5000| tot_loss: 2.4493 | rl_loss: 0.6500 | pt_loss: 1.7993 | pg_loss: 0.1560 | reg_loss: 0.4940 | reward: -0.2482 | rev_kl: 0.9010 | stu_lens: 102.3281 | mixed_lens: 104.2969 | lr: 4.9904e-06 | scale: 2048.00 | time: 26.443 | step time: 27.656
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    241/  5000| tot_loss: 2.5073 | rl_loss: 0.4837 | pt_loss: 2.0236 | pg_loss: -0.0138 | reg_loss: 0.4976 | reward: -0.2682 | rev_kl: 0.8591 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9902e-06 | scale: 2048.00 | time: 26.467 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    242/  5000| tot_loss: 1.9497 | rl_loss: 0.4617 | pt_loss: 1.4880 | pg_loss: 0.0377 | reg_loss: 0.4241 | reward: -0.3378 | rev_kl: 1.0548 | stu_lens: 128.0000 | mixed_lens: 126.5000 | lr: 4.9901e-06 | scale: 2048.00 | time: 26.394 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    243/  5000| tot_loss: 2.5514 | rl_loss: 0.4686 | pt_loss: 2.0828 | pg_loss: 0.0492 | reg_loss: 0.4194 | reward: -0.1269 | rev_kl: 0.7743 | stu_lens: 128.0000 | mixed_lens: 112.5000 | lr: 4.9899e-06 | scale: 2048.00 | time: 26.443 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    244/  5000| tot_loss: 2.9406 | rl_loss: 1.3443 | pt_loss: 1.5963 | pg_loss: 0.9074 | reg_loss: 0.4369 | reward: -0.5020 | rev_kl: 1.1695 | stu_lens: 78.5000 | mixed_lens: 47.5000 | lr: 4.9898e-06 | scale: 2048.00 | time: 26.405 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    245/  5000| tot_loss: 2.2532 | rl_loss: 0.6168 | pt_loss: 1.6364 | pg_loss: 0.1981 | reg_loss: 0.4186 | reward: -0.1250 | rev_kl: 0.9304 | stu_lens: 97.5000 | mixed_lens: 96.5000 | lr: 4.9896e-06 | scale: 2048.00 | time: 26.446 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    246/  5000| tot_loss: 1.9074 | rl_loss: 0.3247 | pt_loss: 1.5826 | pg_loss: -0.0210 | reg_loss: 0.3458 | reward: -0.2443 | rev_kl: 0.7056 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9895e-06 | scale: 2048.00 | time: 26.434 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    247/  5000| tot_loss: 2.1534 | rl_loss: 0.6140 | pt_loss: 1.5393 | pg_loss: 0.1943 | reg_loss: 0.4197 | reward: -0.3770 | rev_kl: 0.9715 | stu_lens: 128.0000 | mixed_lens: 85.5000 | lr: 4.9894e-06 | scale: 2048.00 | time: 26.475 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    248/  5000| tot_loss: 1.6972 | rl_loss: 0.3307 | pt_loss: 1.3665 | pg_loss: -0.0148 | reg_loss: 0.3455 | reward: -0.1264 | rev_kl: 0.7520 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9892e-06 | scale: 2048.00 | time: 26.420 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    249/  5000| tot_loss: 2.0540 | rl_loss: 0.4743 | pt_loss: 1.5797 | pg_loss: 0.1057 | reg_loss: 0.3686 | reward: -0.3413 | rev_kl: 1.0914 | stu_lens: 95.0000 | mixed_lens: 112.0000 | lr: 4.9891e-06 | scale: 2048.00 | time: 26.443 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/250
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    250/  5000| tot_loss: 1.7428 | rl_loss: 0.4973 | pt_loss: 1.2455 | pg_loss: -0.0070 | reg_loss: 0.5043 | reward: -0.2676 | rev_kl: 0.9914 | stu_lens: 33.0000 | mixed_lens: 128.0000 | lr: 4.9889e-06 | scale: 2048.00 | time: 26.435 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    251/  5000| tot_loss: 2.2432 | rl_loss: 0.4822 | pt_loss: 1.7610 | pg_loss: 0.1073 | reg_loss: 0.3749 | reward: -0.3009 | rev_kl: 0.9048 | stu_lens: 117.0000 | mixed_lens: 111.0000 | lr: 4.9888e-06 | scale: 2048.00 | time: 26.421 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    252/  5000| tot_loss: 2.0462 | rl_loss: 0.5582 | pt_loss: 1.4880 | pg_loss: 0.1001 | reg_loss: 0.4581 | reward: -0.3230 | rev_kl: 0.8888 | stu_lens: 109.0000 | mixed_lens: 115.0000 | lr: 4.9886e-06 | scale: 2048.00 | time: 26.444 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    253/  5000| tot_loss: 2.4268 | rl_loss: 0.5938 | pt_loss: 1.8329 | pg_loss: 0.1584 | reg_loss: 0.4354 | reward: 0.0054 | rev_kl: 1.0028 | stu_lens: 84.5000 | mixed_lens: 101.0000 | lr: 4.9884e-06 | scale: 2048.00 | time: 26.433 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    254/  5000| tot_loss: 2.9429 | rl_loss: 0.4653 | pt_loss: 2.4776 | pg_loss: 0.0890 | reg_loss: 0.3764 | reward: -0.1321 | rev_kl: 1.2105 | stu_lens: 95.0000 | mixed_lens: 115.5000 | lr: 4.9883e-06 | scale: 2048.00 | time: 26.404 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    255/  5000| tot_loss: 2.7297 | rl_loss: 0.8236 | pt_loss: 1.9061 | pg_loss: 0.5500 | reg_loss: 0.2737 | reward: -0.2871 | rev_kl: 0.8075 | stu_lens: 63.5000 | mixed_lens: 62.0000 | lr: 4.9881e-06 | scale: 2048.00 | time: 26.432 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    256/  5000| tot_loss: 2.6508 | rl_loss: 0.6002 | pt_loss: 2.0507 | pg_loss: 0.2706 | reg_loss: 0.3296 | reward: -0.2563 | rev_kl: 0.5331 | stu_lens: 33.5000 | mixed_lens: 91.0000 | lr: 4.9880e-06 | scale: 2048.00 | time: 26.452 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    256/  5000| tot_loss: 2.3196 | rl_loss: 0.5530 | pt_loss: 1.7666 | pg_loss: 0.1663 | reg_loss: 0.3867 | reward: -0.2500 | rev_kl: 0.8916 | stu_lens: 106.7344 | mixed_lens: 106.0938 | lr: 4.9880e-06 | scale: 2048.00 | time: 26.452 | step time: 27.718
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    257/  5000| tot_loss: 1.4281 | rl_loss: 0.4125 | pt_loss: 1.0156 | pg_loss: 0.0353 | reg_loss: 0.3772 | reward: -0.1328 | rev_kl: 0.9169 | stu_lens: 128.0000 | mixed_lens: 119.0000 | lr: 4.9878e-06 | scale: 2048.00 | time: 26.436 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    258/  5000| tot_loss: 2.8510 | rl_loss: 0.8627 | pt_loss: 1.9883 | pg_loss: 0.0568 | reg_loss: 0.8058 | reward: -0.2451 | rev_kl: 0.8260 | stu_lens: 93.0000 | mixed_lens: 128.0000 | lr: 4.9877e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    259/  5000| tot_loss: 3.0290 | rl_loss: 1.0744 | pt_loss: 1.9546 | pg_loss: 0.0764 | reg_loss: 0.9980 | reward: -0.2196 | rev_kl: 0.7972 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9875e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    260/  5000| tot_loss: 3.2877 | rl_loss: 1.4551 | pt_loss: 1.8326 | pg_loss: 0.4234 | reg_loss: 1.0317 | reward: -0.5033 | rev_kl: 0.9315 | stu_lens: 94.0000 | mixed_lens: 80.5000 | lr: 4.9873e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    261/  5000| tot_loss: 3.5262 | rl_loss: 1.6886 | pt_loss: 1.8376 | pg_loss: 0.4700 | reg_loss: 1.2187 | reward: -0.8988 | rev_kl: 2.3990 | stu_lens: 65.5000 | mixed_lens: 70.5000 | lr: 4.9872e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    262/  5000| tot_loss: 2.9127 | rl_loss: 1.1755 | pt_loss: 1.7372 | pg_loss: 0.4690 | reg_loss: 0.7065 | reward: -0.2532 | rev_kl: 0.9426 | stu_lens: 71.5000 | mixed_lens: 49.0000 | lr: 4.9870e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    263/  5000| tot_loss: 3.4055 | rl_loss: 0.8652 | pt_loss: 2.5403 | pg_loss: 0.2237 | reg_loss: 0.6415 | reward: -0.2016 | rev_kl: 0.5655 | stu_lens: 67.0000 | mixed_lens: 86.0000 | lr: 4.9869e-06 | scale: 2048.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    264/  5000| tot_loss: 2.8103 | rl_loss: 0.8747 | pt_loss: 1.9357 | pg_loss: 0.1486 | reg_loss: 0.7261 | reward: -0.0874 | rev_kl: 0.7271 | stu_lens: 80.5000 | mixed_lens: 114.5000 | lr: 4.9867e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    265/  5000| tot_loss: 2.8991 | rl_loss: 1.1780 | pt_loss: 1.7211 | pg_loss: 0.0388 | reg_loss: 1.1392 | reward: -0.2704 | rev_kl: 0.9202 | stu_lens: 125.0000 | mixed_lens: 128.0000 | lr: 4.9865e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    266/  5000| tot_loss: 2.7816 | rl_loss: 0.9397 | pt_loss: 1.8418 | pg_loss: 0.2591 | reg_loss: 0.6806 | reward: -0.2413 | rev_kl: 0.8827 | stu_lens: 77.0000 | mixed_lens: 88.5000 | lr: 4.9864e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    267/  5000| tot_loss: 2.7006 | rl_loss: 1.0080 | pt_loss: 1.6926 | pg_loss: 0.0762 | reg_loss: 0.9318 | reward: -0.2630 | rev_kl: 1.2935 | stu_lens: 84.0000 | mixed_lens: 125.5000 | lr: 4.9862e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    268/  5000| tot_loss: 2.4716 | rl_loss: 0.8746 | pt_loss: 1.5970 | pg_loss: 0.0753 | reg_loss: 0.7993 | reward: -0.0793 | rev_kl: 1.5237 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9860e-06 | scale: 2048.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    269/  5000| tot_loss: 2.6712 | rl_loss: 0.8582 | pt_loss: 1.8130 | pg_loss: 0.0805 | reg_loss: 0.7777 | reward: -0.1889 | rev_kl: 0.9600 | stu_lens: 74.0000 | mixed_lens: 117.5000 | lr: 4.9859e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    270/  5000| tot_loss: 2.8961 | rl_loss: 1.3281 | pt_loss: 1.5680 | pg_loss: 0.2679 | reg_loss: 1.0601 | reward: -0.1445 | rev_kl: 0.9970 | stu_lens: 128.0000 | mixed_lens: 120.0000 | lr: 4.9857e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    271/  5000| tot_loss: 3.7392 | rl_loss: 1.7847 | pt_loss: 1.9546 | pg_loss: 0.9363 | reg_loss: 0.8484 | reward: 0.0733 | rev_kl: 0.6519 | stu_lens: 59.0000 | mixed_lens: 57.0000 | lr: 4.9855e-06 | scale: 2048.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    272/  5000| tot_loss: 2.8628 | rl_loss: 1.1393 | pt_loss: 1.7235 | pg_loss: 0.0845 | reg_loss: 1.0549 | reward: -0.1611 | rev_kl: 0.7748 | stu_lens: 106.0000 | mixed_lens: 128.0000 | lr: 4.9853e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    272/  5000| tot_loss: 3.0075 | rl_loss: 1.1988 | pt_loss: 1.8088 | pg_loss: 0.2790 | reg_loss: 0.9198 | reward: -0.2302 | rev_kl: 0.9549 | stu_lens: 97.7656 | mixed_lens: 101.0469 | lr: 4.9853e-06 | scale: 2048.00 | time: 26.296 | step time: 27.574
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    273/  5000| tot_loss: 2.8516 | rl_loss: 1.3398 | pt_loss: 1.5118 | pg_loss: 0.4307 | reg_loss: 0.9090 | reward: 0.0427 | rev_kl: 1.1404 | stu_lens: 71.0000 | mixed_lens: 66.0000 | lr: 4.9852e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    274/  5000| tot_loss: 2.4970 | rl_loss: 0.6392 | pt_loss: 1.8577 | pg_loss: 0.2393 | reg_loss: 0.4000 | reward: -0.1685 | rev_kl: 0.5076 | stu_lens: 58.5000 | mixed_lens: 74.5000 | lr: 4.9850e-06 | scale: 2048.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    275/  5000| tot_loss: 2.8515 | rl_loss: 0.5683 | pt_loss: 2.2832 | pg_loss: 0.0083 | reg_loss: 0.5600 | reward: -0.1197 | rev_kl: 0.8947 | stu_lens: 121.0000 | mixed_lens: 127.0000 | lr: 4.9848e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    276/  5000| tot_loss: 2.4644 | rl_loss: 0.4906 | pt_loss: 1.9738 | pg_loss: 0.0290 | reg_loss: 0.4615 | reward: -0.1592 | rev_kl: 0.6479 | stu_lens: 107.5000 | mixed_lens: 117.5000 | lr: 4.9846e-06 | scale: 2048.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    277/  5000| tot_loss: 2.9972 | rl_loss: 1.2450 | pt_loss: 1.7522 | pg_loss: 0.4503 | reg_loss: 0.7947 | reward: 0.0563 | rev_kl: 1.1235 | stu_lens: 71.0000 | mixed_lens: 66.0000 | lr: 4.9845e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    278/  5000| tot_loss: 2.2327 | rl_loss: 0.6012 | pt_loss: 1.6315 | pg_loss: 0.0332 | reg_loss: 0.5680 | reward: -0.1488 | rev_kl: 1.0135 | stu_lens: 128.0000 | mixed_lens: 122.0000 | lr: 4.9843e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    279/  5000| tot_loss: 1.3937 | rl_loss: 0.6018 | pt_loss: 0.7919 | pg_loss: -0.0032 | reg_loss: 0.6050 | reward: -0.0902 | rev_kl: 0.7438 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9841e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    280/  5000| tot_loss: 1.6680 | rl_loss: 0.3431 | pt_loss: 1.3249 | pg_loss: 0.0087 | reg_loss: 0.3344 | reward: -0.3006 | rev_kl: 0.6182 | stu_lens: 91.5000 | mixed_lens: 127.0000 | lr: 4.9839e-06 | scale: 2048.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    281/  5000| tot_loss: 2.7276 | rl_loss: 0.8048 | pt_loss: 1.9227 | pg_loss: 0.1625 | reg_loss: 0.6423 | reward: -0.3728 | rev_kl: 0.8407 | stu_lens: 106.5000 | mixed_lens: 111.5000 | lr: 4.9837e-06 | scale: 2048.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    282/  5000| tot_loss: 2.6898 | rl_loss: 0.7486 | pt_loss: 1.9412 | pg_loss: 0.0748 | reg_loss: 0.6738 | reward: -0.1021 | rev_kl: 0.9018 | stu_lens: 128.0000 | mixed_lens: 108.0000 | lr: 4.9836e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    283/  5000| tot_loss: 3.2694 | rl_loss: 1.1851 | pt_loss: 2.0844 | pg_loss: 0.2003 | reg_loss: 0.9847 | reward: -0.6092 | rev_kl: 0.9038 | stu_lens: 94.0000 | mixed_lens: 91.5000 | lr: 4.9834e-06 | scale: 2048.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    284/  5000| tot_loss: 2.4489 | rl_loss: 0.7475 | pt_loss: 1.7014 | pg_loss: 0.0131 | reg_loss: 0.7344 | reward: -0.2313 | rev_kl: 0.7962 | stu_lens: 93.0000 | mixed_lens: 128.0000 | lr: 4.9832e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    285/  5000| tot_loss: 2.9144 | rl_loss: 0.8646 | pt_loss: 2.0498 | pg_loss: 0.1585 | reg_loss: 0.7061 | reward: -0.4702 | rev_kl: 0.9186 | stu_lens: 128.0000 | mixed_lens: 101.0000 | lr: 4.9830e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    286/  5000| tot_loss: 2.4020 | rl_loss: 0.6835 | pt_loss: 1.7185 | pg_loss: 0.0126 | reg_loss: 0.6710 | reward: -0.3668 | rev_kl: 1.2157 | stu_lens: 79.5000 | mixed_lens: 122.0000 | lr: 4.9828e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    287/  5000| tot_loss: 2.4679 | rl_loss: 0.8628 | pt_loss: 1.6051 | pg_loss: 0.2802 | reg_loss: 0.5826 | reward: -0.2609 | rev_kl: 0.8399 | stu_lens: 83.5000 | mixed_lens: 88.5000 | lr: 4.9826e-06 | scale: 2048.00 | time: 26.353 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    288/  5000| tot_loss: 2.2486 | rl_loss: 0.5968 | pt_loss: 1.6518 | pg_loss: 0.0305 | reg_loss: 0.5663 | reward: -0.2087 | rev_kl: 1.2122 | stu_lens: 94.5000 | mixed_lens: 120.0000 | lr: 4.9824e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    288/  5000| tot_loss: 2.6027 | rl_loss: 0.8393 | pt_loss: 1.7634 | pg_loss: 0.2199 | reg_loss: 0.6194 | reward: -0.2040 | rev_kl: 0.9321 | stu_lens: 92.3125 | mixed_lens: 98.7344 | lr: 4.9824e-06 | scale: 2048.00 | time: 26.290 | step time: 27.560
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    289/  5000| tot_loss: 2.6933 | rl_loss: 0.7311 | pt_loss: 1.9622 | pg_loss: 0.0107 | reg_loss: 0.7204 | reward: -0.1357 | rev_kl: 0.7678 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9822e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    290/  5000| tot_loss: 2.3716 | rl_loss: 0.6268 | pt_loss: 1.7448 | pg_loss: 0.0555 | reg_loss: 0.5714 | reward: -0.1874 | rev_kl: 0.9860 | stu_lens: 108.0000 | mixed_lens: 128.0000 | lr: 4.9821e-06 | scale: 2048.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    291/  5000| tot_loss: 2.3753 | rl_loss: 0.3805 | pt_loss: 1.9948 | pg_loss: 0.0061 | reg_loss: 0.3744 | reward: -0.1605 | rev_kl: 1.0698 | stu_lens: 94.5000 | mixed_lens: 127.0000 | lr: 4.9819e-06 | scale: 2048.00 | time: 26.322 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    292/  5000| tot_loss: 2.2902 | rl_loss: 0.4694 | pt_loss: 1.8207 | pg_loss: 0.0200 | reg_loss: 0.4494 | reward: -0.1137 | rev_kl: 0.6324 | stu_lens: 84.0000 | mixed_lens: 128.0000 | lr: 4.9817e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    293/  5000| tot_loss: 2.4622 | rl_loss: 0.5367 | pt_loss: 1.9254 | pg_loss: 0.1402 | reg_loss: 0.3965 | reward: -0.1985 | rev_kl: 0.8910 | stu_lens: 79.0000 | mixed_lens: 86.5000 | lr: 4.9815e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    294/  5000| tot_loss: 2.3027 | rl_loss: 0.5442 | pt_loss: 1.7585 | pg_loss: -0.0164 | reg_loss: 0.5606 | reward: -0.2943 | rev_kl: 0.6787 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9813e-06 | scale: 2048.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    295/  5000| tot_loss: 2.4460 | rl_loss: 0.4619 | pt_loss: 1.9841 | pg_loss: 0.0013 | reg_loss: 0.4605 | reward: -0.0691 | rev_kl: 0.9595 | stu_lens: 121.0000 | mixed_lens: 128.0000 | lr: 4.9811e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    296/  5000| tot_loss: 2.1553 | rl_loss: 0.3699 | pt_loss: 1.7854 | pg_loss: 0.0408 | reg_loss: 0.3291 | reward: -0.1434 | rev_kl: 0.4897 | stu_lens: 91.5000 | mixed_lens: 128.0000 | lr: 4.9809e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    297/  5000| tot_loss: 2.6877 | rl_loss: 0.8033 | pt_loss: 1.8844 | pg_loss: 0.3018 | reg_loss: 0.5016 | reward: -0.1380 | rev_kl: 0.7058 | stu_lens: 82.0000 | mixed_lens: 80.5000 | lr: 4.9807e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    298/  5000| tot_loss: 2.2211 | rl_loss: 0.3158 | pt_loss: 1.9054 | pg_loss: 0.0007 | reg_loss: 0.3151 | reward: -0.2133 | rev_kl: 1.0860 | stu_lens: 85.5000 | mixed_lens: 125.5000 | lr: 4.9805e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    299/  5000| tot_loss: 2.4018 | rl_loss: 0.6385 | pt_loss: 1.7633 | pg_loss: 0.2236 | reg_loss: 0.4149 | reward: -0.3755 | rev_kl: 0.8680 | stu_lens: 83.5000 | mixed_lens: 88.5000 | lr: 4.9803e-06 | scale: 2048.00 | time: 26.315 | step time: 0.000
                                 Evaluation #3                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son partículas            │
│                                       │ elementales que forman la base de la │
│                                       │ composición de los habíaos. Existen  │
│                                       │ seis tipos de cuarks, los cuales     │
│                                       │ son:                                 │
│                                       │                                      │
│                                       │ - Cuark de calibre pesado (heavy     │
│                                       │ quark), que son cuarks (partículas   │
│                                       │ elementales) que tienen una masa por │
│                                       │ encima de la del electrón.           │
│                                       │ - Cuark de calibre ligero (light     │
│                                       │ quark), que son cuarks que tienen    │
│                                       │ una masa por debajo de la del        │
│                                       │ electrón.                            │
│                                       │ - Cuark de carga (charm quark), que  │
│                                       │ es                                   │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es una extensión de la LED y  │
│                                       │ se utiliza para iluminar pantallas   │
│                                       │ de ordenador o televisor. La         │
│                                       │ principal utilidad es que requiere   │
│                                       │ un solo cable de alimentación, el    │
│                                       │ cual se conecta a la red.            │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Las cápsulas del tiempo más famosas  │
│                                       │ de la historia son:                  │
│                                       │                                      │
│                                       │ - 1960: Cápsula del tiempo, primera  │
│                                       │ cápsula del tiempo en alcanzar la    │
│                                       │ velocidad de la luz.                 │
│                                       │ - 1971: Cápsula del tiempo, primera  │
│                                       │ cápsula del tiempo en alcanzar la    │
│                                       │ velocidad de la luz, y regresar a la │
│                                       │ misma velocidad de la luz.           │
│                                       │ - 1980: Cápsula del tiempo, primera  │
│                                       │ cápsula del tiempo en llegar a la    │
│                                       │ velocidad de la l                    │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.909 | exact_match: 0.000 | rev_kl: 0.921 | lens: 97.523 | pt_loss: 1.751 | lm_loss: 1.892 | kd_loss: 1.611 
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    300/  5000| tot_loss: 2.6541 | rl_loss: 0.9102 | pt_loss: 1.7440 | pg_loss: 0.2547 | reg_loss: 0.6555 | reward: -0.2669 | rev_kl: 0.9266 | stu_lens: 86.0000 | mixed_lens: 86.0000 | lr: 4.9801e-06 | scale: 2048.00 | time: 26.322 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    301/  5000| tot_loss: 2.4541 | rl_loss: 0.6601 | pt_loss: 1.7940 | pg_loss: 0.1142 | reg_loss: 0.5459 | reward: -0.2141 | rev_kl: 0.7438 | stu_lens: 105.5000 | mixed_lens: 100.5000 | lr: 4.9799e-06 | scale: 2048.00 | time: 26.323 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    302/  5000| tot_loss: 2.2842 | rl_loss: 0.9214 | pt_loss: 1.3628 | pg_loss: 0.4003 | reg_loss: 0.5211 | reward: -0.4930 | rev_kl: 0.8509 | stu_lens: 128.0000 | mixed_lens: 83.0000 | lr: 4.9797e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    303/  5000| tot_loss: 2.2259 | rl_loss: 0.4976 | pt_loss: 1.7283 | pg_loss: 0.0379 | reg_loss: 0.4597 | reward: -0.2815 | rev_kl: 0.9695 | stu_lens: 128.0000 | mixed_lens: 117.0000 | lr: 4.9795e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    304/  5000| tot_loss: 1.8236 | rl_loss: 0.6717 | pt_loss: 1.1519 | pg_loss: 0.0406 | reg_loss: 0.6311 | reward: -0.0993 | rev_kl: 1.1883 | stu_lens: 45.0000 | mixed_lens: 57.0000 | lr: 4.9793e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    304/  5000| tot_loss: 2.3435 | rl_loss: 0.5954 | pt_loss: 1.7481 | pg_loss: 0.1408 | reg_loss: 0.4546 | reward: -0.1973 | rev_kl: 0.9384 | stu_lens: 95.1719 | mixed_lens: 101.1406 | lr: 4.9793e-06 | scale: 2048.00 | time: 26.264 | step time: 27.583
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    305/  5000| tot_loss: 2.5318 | rl_loss: 0.7847 | pt_loss: 1.7471 | pg_loss: 0.2786 | reg_loss: 0.5061 | reward: -0.8476 | rev_kl: 0.6715 | stu_lens: 112.0000 | mixed_lens: 82.5000 | lr: 4.9791e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    306/  5000| tot_loss: 1.9053 | rl_loss: 0.3580 | pt_loss: 1.5473 | pg_loss: 0.0195 | reg_loss: 0.3385 | reward: -0.2085 | rev_kl: 0.8749 | stu_lens: 108.0000 | mixed_lens: 128.0000 | lr: 4.9789e-06 | scale: 2048.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    307/  5000| tot_loss: 2.0611 | rl_loss: 0.2698 | pt_loss: 1.7914 | pg_loss: -0.0067 | reg_loss: 0.2764 | reward: -0.0516 | rev_kl: 1.3037 | stu_lens: 121.0000 | mixed_lens: 128.0000 | lr: 4.9786e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    308/  5000| tot_loss: 1.8757 | rl_loss: 0.1602 | pt_loss: 1.7155 | pg_loss: -0.0265 | reg_loss: 0.1867 | reward: -0.0275 | rev_kl: 0.8286 | stu_lens: 121.5000 | mixed_lens: 128.0000 | lr: 4.9784e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    309/  5000| tot_loss: 2.1816 | rl_loss: 0.5280 | pt_loss: 1.6536 | pg_loss: 0.1693 | reg_loss: 0.3587 | reward: -0.4346 | rev_kl: 0.8489 | stu_lens: 128.0000 | mixed_lens: 101.0000 | lr: 4.9782e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    310/  5000| tot_loss: 2.1426 | rl_loss: 0.5772 | pt_loss: 1.5654 | pg_loss: 0.2373 | reg_loss: 0.3400 | reward: -0.2973 | rev_kl: 0.4908 | stu_lens: 99.5000 | mixed_lens: 91.5000 | lr: 4.9780e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    311/  5000| tot_loss: 1.7569 | rl_loss: 0.4687 | pt_loss: 1.2882 | pg_loss: -0.0105 | reg_loss: 0.4792 | reward: 0.0456 | rev_kl: 0.8970 | stu_lens: 106.0000 | mixed_lens: 128.0000 | lr: 4.9778e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    312/  5000| tot_loss: 1.8073 | rl_loss: 0.2634 | pt_loss: 1.5439 | pg_loss: -0.1128 | reg_loss: 0.3761 | reward: -0.0701 | rev_kl: 1.0892 | stu_lens: 52.0000 | mixed_lens: 46.5000 | lr: 4.9776e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    313/  5000| tot_loss: 2.0448 | rl_loss: 0.4870 | pt_loss: 1.5577 | pg_loss: 0.1964 | reg_loss: 0.2906 | reward: -0.2043 | rev_kl: 1.1231 | stu_lens: 128.0000 | mixed_lens: 108.0000 | lr: 4.9774e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    314/  5000| tot_loss: 2.3251 | rl_loss: 0.4276 | pt_loss: 1.8975 | pg_loss: 0.1676 | reg_loss: 0.2600 | reward: -0.3721 | rev_kl: 1.0809 | stu_lens: 83.5000 | mixed_lens: 80.5000 | lr: 4.9772e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    315/  5000| tot_loss: 2.7254 | rl_loss: 0.6919 | pt_loss: 2.0335 | pg_loss: 0.3292 | reg_loss: 0.3628 | reward: -0.1588 | rev_kl: 0.7239 | stu_lens: 84.0000 | mixed_lens: 82.5000 | lr: 4.9769e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    316/  5000| tot_loss: 1.6721 | rl_loss: 0.3283 | pt_loss: 1.3439 | pg_loss: 0.0229 | reg_loss: 0.3053 | reward: -0.1608 | rev_kl: 0.5233 | stu_lens: 71.0000 | mixed_lens: 117.5000 | lr: 4.9767e-06 | scale: 2048.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    317/  5000| tot_loss: 1.7368 | rl_loss: 0.2067 | pt_loss: 1.5301 | pg_loss: -0.0232 | reg_loss: 0.2299 | reward: -0.0850 | rev_kl: 0.6611 | stu_lens: 80.5000 | mixed_lens: 72.5000 | lr: 4.9765e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    318/  5000| tot_loss: 2.9907 | rl_loss: 0.9556 | pt_loss: 2.0351 | pg_loss: 0.6265 | reg_loss: 0.3291 | reward: 0.5337 | rev_kl: 1.6362 | stu_lens: 65.0000 | mixed_lens: 65.5000 | lr: 4.9763e-06 | scale: 2048.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    319/  5000| tot_loss: 2.8863 | rl_loss: 0.8077 | pt_loss: 2.0786 | pg_loss: 0.3206 | reg_loss: 0.4871 | reward: -0.1937 | rev_kl: 0.8321 | stu_lens: 79.0000 | mixed_lens: 80.5000 | lr: 4.9761e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    320/  5000| tot_loss: 2.0960 | rl_loss: 0.7982 | pt_loss: 1.2978 | pg_loss: 0.2318 | reg_loss: 0.5663 | reward: -0.4145 | rev_kl: 0.9988 | stu_lens: 94.0000 | mixed_lens: 76.0000 | lr: 4.9758e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    320/  5000| tot_loss: 2.2518 | rl_loss: 0.5347 | pt_loss: 1.7171 | pg_loss: 0.1557 | reg_loss: 0.3790 | reward: -0.2342 | rev_kl: 0.9429 | stu_lens: 95.9375 | mixed_lens: 99.9219 | lr: 4.9758e-06 | scale: 2048.00 | time: 26.289 | step time: 27.556
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    321/  5000| tot_loss: 2.0313 | rl_loss: 0.7064 | pt_loss: 1.3249 | pg_loss: 0.3162 | reg_loss: 0.3902 | reward: -0.3028 | rev_kl: 0.8015 | stu_lens: 86.0000 | mixed_lens: 86.0000 | lr: 4.9756e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    322/  5000| tot_loss: 2.0900 | rl_loss: 0.8255 | pt_loss: 1.2645 | pg_loss: 0.0632 | reg_loss: 0.7623 | reward: -0.2907 | rev_kl: 0.6736 | stu_lens: 95.5000 | mixed_lens: 117.0000 | lr: 4.9754e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    323/  5000| tot_loss: 2.3641 | rl_loss: 0.8794 | pt_loss: 1.4848 | pg_loss: 0.0745 | reg_loss: 0.8049 | reward: -0.0649 | rev_kl: 0.9598 | stu_lens: 83.5000 | mixed_lens: 119.0000 | lr: 4.9752e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    324/  5000| tot_loss: 3.2616 | rl_loss: 1.1855 | pt_loss: 2.0761 | pg_loss: 0.4762 | reg_loss: 0.7093 | reward: -0.5655 | rev_kl: 1.0489 | stu_lens: 29.0000 | mixed_lens: 81.0000 | lr: 4.9749e-06 | scale: 2048.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    325/  5000| tot_loss: 2.5927 | rl_loss: 1.2219 | pt_loss: 1.3708 | pg_loss: 0.0732 | reg_loss: 1.1487 | reward: -0.1625 | rev_kl: 0.7973 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9747e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    326/  5000| tot_loss: 4.0465 | rl_loss: 2.0281 | pt_loss: 2.0184 | pg_loss: 0.3960 | reg_loss: 1.6321 | reward: -0.4503 | rev_kl: 1.5124 | stu_lens: 91.5000 | mixed_lens: 86.5000 | lr: 4.9745e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    327/  5000| tot_loss: 3.4533 | rl_loss: 1.8327 | pt_loss: 1.6205 | pg_loss: 0.6783 | reg_loss: 1.1545 | reward: -0.4592 | rev_kl: 1.0968 | stu_lens: 112.5000 | mixed_lens: 59.5000 | lr: 4.9743e-06 | scale: 2048.00 | time: 26.362 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    328/  5000| tot_loss: 3.1244 | rl_loss: 1.1549 | pt_loss: 1.9696 | pg_loss: 0.3766 | reg_loss: 0.7783 | reward: -0.4078 | rev_kl: 0.8863 | stu_lens: 88.5000 | mixed_lens: 70.5000 | lr: 4.9740e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    329/  5000| tot_loss: 3.6310 | rl_loss: 1.8003 | pt_loss: 1.8307 | pg_loss: 0.5810 | reg_loss: 1.2193 | reward: -2.2424 | rev_kl: 1.2532 | stu_lens: 66.5000 | mixed_lens: 57.5000 | lr: 4.9738e-06 | scale: 2048.00 | time: 26.361 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    330/  5000| tot_loss: 3.1406 | rl_loss: 1.3756 | pt_loss: 1.7650 | pg_loss: 0.4218 | reg_loss: 0.9538 | reward: -0.6854 | rev_kl: 2.2291 | stu_lens: 25.0000 | mixed_lens: 77.0000 | lr: 4.9736e-06 | scale: 2048.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    331/  5000| tot_loss: 2.5182 | rl_loss: 1.0022 | pt_loss: 1.5160 | pg_loss: 0.0603 | reg_loss: 0.9419 | reward: -0.3016 | rev_kl: 0.8485 | stu_lens: 128.0000 | mixed_lens: 124.5000 | lr: 4.9733e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    332/  5000| tot_loss: 3.1589 | rl_loss: 1.1359 | pt_loss: 2.0231 | pg_loss: 0.0393 | reg_loss: 1.0966 | reward: -0.2874 | rev_kl: 1.3463 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9731e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    333/  5000| tot_loss: 3.0750 | rl_loss: 1.3506 | pt_loss: 1.7245 | pg_loss: 0.2821 | reg_loss: 1.0685 | reward: -0.3752 | rev_kl: 0.5211 | stu_lens: 103.5000 | mixed_lens: 95.0000 | lr: 4.9729e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    334/  5000| tot_loss: 2.3793 | rl_loss: 0.7255 | pt_loss: 1.6538 | pg_loss: 0.0313 | reg_loss: 0.6942 | reward: -0.1230 | rev_kl: 0.8623 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9726e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    335/  5000| tot_loss: 3.2115 | rl_loss: 1.1814 | pt_loss: 2.0300 | pg_loss: 0.2157 | reg_loss: 0.9657 | reward: -0.2803 | rev_kl: 0.9398 | stu_lens: 128.0000 | mixed_lens: 102.0000 | lr: 4.9724e-06 | scale: 2048.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    336/  5000| tot_loss: 2.6687 | rl_loss: 1.5206 | pt_loss: 1.1481 | pg_loss: 0.6283 | reg_loss: 0.8923 | reward: -0.5962 | rev_kl: 1.1194 | stu_lens: 16.0000 | mixed_lens: 70.5000 | lr: 4.9722e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    336/  5000| tot_loss: 2.9524 | rl_loss: 1.2658 | pt_loss: 1.6867 | pg_loss: 0.3528 | reg_loss: 0.9130 | reward: -0.4543 | rev_kl: 0.9757 | stu_lens: 95.3281 | mixed_lens: 91.1562 | lr: 4.9722e-06 | scale: 2048.00 | time: 26.263 | step time: 27.587
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    337/  5000| tot_loss: 2.3698 | rl_loss: 1.1304 | pt_loss: 1.2394 | pg_loss: 0.1268 | reg_loss: 1.0036 | reward: -0.0726 | rev_kl: 1.0074 | stu_lens: 120.0000 | mixed_lens: 103.0000 | lr: 4.9719e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    338/  5000| tot_loss: 3.4141 | rl_loss: 1.5843 | pt_loss: 1.8298 | pg_loss: 0.4802 | reg_loss: 1.1042 | reward: -0.2840 | rev_kl: 1.4541 | stu_lens: 91.5000 | mixed_lens: 53.0000 | lr: 4.9717e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    339/  5000| tot_loss: 3.2857 | rl_loss: 1.2013 | pt_loss: 2.0844 | pg_loss: 0.6481 | reg_loss: 0.5532 | reward: -0.3040 | rev_kl: 0.6280 | stu_lens: 116.0000 | mixed_lens: 65.0000 | lr: 4.9714e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    340/  5000| tot_loss: 2.6146 | rl_loss: 0.6698 | pt_loss: 1.9448 | pg_loss: 0.0800 | reg_loss: 0.5898 | reward: 0.0279 | rev_kl: 0.5315 | stu_lens: 70.5000 | mixed_lens: 69.0000 | lr: 4.9712e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    341/  5000| tot_loss: 2.2822 | rl_loss: 0.8057 | pt_loss: 1.4765 | pg_loss: 0.2198 | reg_loss: 0.5859 | reward: -0.3518 | rev_kl: 1.3305 | stu_lens: 117.0000 | mixed_lens: 100.5000 | lr: 4.9710e-06 | scale: 2048.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    342/  5000| tot_loss: 3.0271 | rl_loss: 1.0637 | pt_loss: 1.9634 | pg_loss: 0.3951 | reg_loss: 0.6686 | reward: -0.6953 | rev_kl: 0.7373 | stu_lens: 77.5000 | mixed_lens: 70.5000 | lr: 4.9707e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    343/  5000| tot_loss: 2.4040 | rl_loss: 0.5857 | pt_loss: 1.8183 | pg_loss: 0.0216 | reg_loss: 0.5641 | reward: -0.2473 | rev_kl: 1.2947 | stu_lens: 75.0000 | mixed_lens: 120.5000 | lr: 4.9705e-06 | scale: 2048.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    344/  5000| tot_loss: 2.9147 | rl_loss: 0.9612 | pt_loss: 1.9535 | pg_loss: 0.2206 | reg_loss: 0.7407 | reward: -0.2003 | rev_kl: 0.9806 | stu_lens: 111.0000 | mixed_lens: 93.0000 | lr: 4.9702e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    345/  5000| tot_loss: 2.2280 | rl_loss: 0.6497 | pt_loss: 1.5784 | pg_loss: 0.0489 | reg_loss: 0.6007 | reward: -0.4485 | rev_kl: 0.7711 | stu_lens: 103.5000 | mixed_lens: 124.5000 | lr: 4.9700e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    346/  5000| tot_loss: 2.5705 | rl_loss: 1.0090 | pt_loss: 1.5615 | pg_loss: 0.3431 | reg_loss: 0.6659 | reward: -0.3533 | rev_kl: 1.5016 | stu_lens: 103.5000 | mixed_lens: 74.0000 | lr: 4.9697e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    347/  5000| tot_loss: 2.4145 | rl_loss: 0.8293 | pt_loss: 1.5852 | pg_loss: 0.3334 | reg_loss: 0.4959 | reward: -0.0814 | rev_kl: 0.8146 | stu_lens: 43.0000 | mixed_lens: 87.0000 | lr: 4.9695e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    348/  5000| tot_loss: 1.6223 | rl_loss: 0.4857 | pt_loss: 1.1366 | pg_loss: 0.1234 | reg_loss: 0.3624 | reward: -0.2656 | rev_kl: 0.8143 | stu_lens: 128.0000 | mixed_lens: 102.0000 | lr: 4.9692e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    349/  5000| tot_loss: 2.2249 | rl_loss: 0.6466 | pt_loss: 1.5784 | pg_loss: -0.0024 | reg_loss: 0.6489 | reward: 0.0414 | rev_kl: 1.4547 | stu_lens: 66.5000 | mixed_lens: 128.0000 | lr: 4.9690e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    350/  5000| tot_loss: 2.2022 | rl_loss: 0.5409 | pt_loss: 1.6613 | pg_loss: 0.0011 | reg_loss: 0.5397 | reward: -0.1721 | rev_kl: 0.6568 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9687e-06 | scale: 2048.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    351/  5000| tot_loss: 4.0223 | rl_loss: 2.4995 | pt_loss: 1.5229 | pg_loss: 1.6968 | reg_loss: 0.8026 | reward: -1.3579 | rev_kl: 1.2056 | stu_lens: 32.5000 | mixed_lens: 13.0000 | lr: 4.9685e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    352/  5000| tot_loss: 2.4648 | rl_loss: 0.6523 | pt_loss: 1.8125 | pg_loss: 0.0686 | reg_loss: 0.5837 | reward: -0.1843 | rev_kl: 0.7593 | stu_lens: 128.0000 | mixed_lens: 119.0000 | lr: 4.9682e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    352/  5000| tot_loss: 2.5713 | rl_loss: 0.9431 | pt_loss: 1.6283 | pg_loss: 0.2964 | reg_loss: 0.6466 | reward: -0.4434 | rev_kl: 0.9929 | stu_lens: 94.9375 | mixed_lens: 87.8750 | lr: 4.9682e-06 | scale: 2048.00 | time: 26.342 | step time: 27.583
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    353/  5000| tot_loss: 2.7531 | rl_loss: 0.9561 | pt_loss: 1.7970 | pg_loss: 0.4678 | reg_loss: 0.4883 | reward: -0.2089 | rev_kl: 0.6953 | stu_lens: 104.5000 | mixed_lens: 73.0000 | lr: 4.9680e-06 | scale: 2048.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    354/  5000| tot_loss: 2.5331 | rl_loss: 0.4057 | pt_loss: 2.1274 | pg_loss: -0.0015 | reg_loss: 0.4071 | reward: -0.1540 | rev_kl: 0.6222 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9677e-06 | scale: 2048.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    355/  5000| tot_loss: 2.3233 | rl_loss: 0.4182 | pt_loss: 1.9051 | pg_loss: 0.0096 | reg_loss: 0.4086 | reward: -0.1622 | rev_kl: 1.1601 | stu_lens: 128.0000 | mixed_lens: 120.5000 | lr: 4.9674e-06 | scale: 2048.00 | time: 26.353 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    356/  5000| tot_loss: 2.2283 | rl_loss: 0.6535 | pt_loss: 1.5748 | pg_loss: 0.2878 | reg_loss: 0.3657 | reward: -0.3724 | rev_kl: 0.9904 | stu_lens: 71.0000 | mixed_lens: 63.0000 | lr: 4.9672e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    357/  5000| tot_loss: 3.1861 | rl_loss: 1.7183 | pt_loss: 1.4679 | pg_loss: 1.1356 | reg_loss: 0.5827 | reward: -2.1736 | rev_kl: 1.2358 | stu_lens: 54.5000 | mixed_lens: 31.5000 | lr: 4.9669e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    358/  5000| tot_loss: 2.2597 | rl_loss: 0.4137 | pt_loss: 1.8460 | pg_loss: 0.0065 | reg_loss: 0.4072 | reward: -0.3498 | rev_kl: 0.9177 | stu_lens: 128.0000 | mixed_lens: 124.5000 | lr: 4.9667e-06 | scale: 2048.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    359/  5000| tot_loss: 2.9742 | rl_loss: 0.8445 | pt_loss: 2.1297 | pg_loss: 0.3194 | reg_loss: 0.5252 | reward: -1.1048 | rev_kl: 1.1220 | stu_lens: 72.0000 | mixed_lens: 70.5000 | lr: 4.9664e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    360/  5000| tot_loss: 2.5442 | rl_loss: 0.7890 | pt_loss: 1.7551 | pg_loss: 0.3017 | reg_loss: 0.4873 | reward: -0.1103 | rev_kl: 1.2240 | stu_lens: 66.5000 | mixed_lens: 95.0000 | lr: 4.9661e-06 | scale: 2048.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    361/  5000| tot_loss: 2.8944 | rl_loss: 1.2634 | pt_loss: 1.6310 | pg_loss: 0.8447 | reg_loss: 0.4187 | reward: -0.1582 | rev_kl: 1.0105 | stu_lens: 86.5000 | mixed_lens: 40.0000 | lr: 4.9659e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    362/  5000| tot_loss: 2.6651 | rl_loss: 0.7858 | pt_loss: 1.8793 | pg_loss: 0.2766 | reg_loss: 0.5092 | reward: -0.3486 | rev_kl: 1.0619 | stu_lens: 82.0000 | mixed_lens: 82.0000 | lr: 4.9656e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    363/  5000| tot_loss: 2.6618 | rl_loss: 0.6168 | pt_loss: 2.0450 | pg_loss: 0.0601 | reg_loss: 0.5567 | reward: -0.3651 | rev_kl: 1.3423 | stu_lens: 128.0000 | mixed_lens: 119.0000 | lr: 4.9653e-06 | scale: 2048.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    364/  5000| tot_loss: 3.5785 | rl_loss: 1.7156 | pt_loss: 1.8629 | pg_loss: 1.3264 | reg_loss: 0.3892 | reward: -0.2163 | rev_kl: 0.8251 | stu_lens: 31.0000 | mixed_lens: 11.5000 | lr: 4.9651e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    365/  5000| tot_loss: 2.3243 | rl_loss: 0.4160 | pt_loss: 1.9083 | pg_loss: 0.1190 | reg_loss: 0.2970 | reward: -0.2648 | rev_kl: 0.6817 | stu_lens: 117.0000 | mixed_lens: 100.5000 | lr: 4.9648e-06 | scale: 2048.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    366/  5000| tot_loss: 2.4900 | rl_loss: 0.6712 | pt_loss: 1.8188 | pg_loss: 0.1367 | reg_loss: 0.5345 | reward: -0.1009 | rev_kl: 0.8517 | stu_lens: 128.0000 | mixed_lens: 106.0000 | lr: 4.9645e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    367/  5000| tot_loss: 1.9906 | rl_loss: 0.9765 | pt_loss: 1.0141 | pg_loss: 0.3685 | reg_loss: 0.6080 | reward: -1.1101 | rev_kl: 1.2027 | stu_lens: 67.5000 | mixed_lens: 66.0000 | lr: 4.9643e-06 | scale: 2048.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    368/  5000| tot_loss: 2.4981 | rl_loss: 0.4159 | pt_loss: 2.0822 | pg_loss: 0.0246 | reg_loss: 0.3913 | reward: -0.1294 | rev_kl: 0.8154 | stu_lens: 79.0000 | mixed_lens: 128.0000 | lr: 4.9640e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    368/  5000| tot_loss: 2.5493 | rl_loss: 0.7530 | pt_loss: 1.7963 | pg_loss: 0.2816 | reg_loss: 0.4714 | reward: -0.4401 | rev_kl: 0.9997 | stu_lens: 97.9062 | mixed_lens: 90.3438 | lr: 4.9640e-06 | scale: 2048.00 | time: 26.312 | step time: 27.590
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    369/  5000| tot_loss: 2.1152 | rl_loss: 0.7819 | pt_loss: 1.3332 | pg_loss: 0.2587 | reg_loss: 0.5233 | reward: -0.3186 | rev_kl: 0.6353 | stu_lens: 114.0000 | mixed_lens: 90.0000 | lr: 4.9637e-06 | scale: 2048.00 | time: 26.323 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    370/  5000| tot_loss: 2.4292 | rl_loss: 0.6247 | pt_loss: 1.8045 | pg_loss: 0.2346 | reg_loss: 0.3901 | reward: -0.3821 | rev_kl: 0.6521 | stu_lens: 81.5000 | mixed_lens: 79.0000 | lr: 4.9635e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    371/  5000| tot_loss: 2.0781 | rl_loss: 0.3198 | pt_loss: 1.7583 | pg_loss: -0.0113 | reg_loss: 0.3311 | reward: -0.0711 | rev_kl: 0.8923 | stu_lens: 79.0000 | mixed_lens: 128.0000 | lr: 4.9632e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    372/  5000| tot_loss: 2.1987 | rl_loss: 0.3448 | pt_loss: 1.8539 | pg_loss: 0.0164 | reg_loss: 0.3284 | reward: -0.4834 | rev_kl: 0.5174 | stu_lens: 103.5000 | mixed_lens: 128.0000 | lr: 4.9629e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    373/  5000| tot_loss: 2.4867 | rl_loss: 0.3811 | pt_loss: 2.1057 | pg_loss: 0.0050 | reg_loss: 0.3761 | reward: -0.2555 | rev_kl: 1.1130 | stu_lens: 75.0000 | mixed_lens: 128.0000 | lr: 4.9626e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    374/  5000| tot_loss: 2.3406 | rl_loss: 0.4925 | pt_loss: 1.8481 | pg_loss: 0.2011 | reg_loss: 0.2913 | reward: -0.1336 | rev_kl: 0.7628 | stu_lens: 128.0000 | mixed_lens: 83.0000 | lr: 4.9624e-06 | scale: 2048.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    375/  5000| tot_loss: 2.1674 | rl_loss: 0.6153 | pt_loss: 1.5521 | pg_loss: 0.3437 | reg_loss: 0.2716 | reward: -1.0764 | rev_kl: 0.9102 | stu_lens: 72.0000 | mixed_lens: 70.5000 | lr: 4.9621e-06 | scale: 2048.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    376/  5000| tot_loss: 2.4301 | rl_loss: 0.3208 | pt_loss: 2.1092 | pg_loss: 0.1642 | reg_loss: 0.1567 | reward: -0.2292 | rev_kl: 0.9365 | stu_lens: 114.0000 | mixed_lens: 78.0000 | lr: 4.9618e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    377/  5000| tot_loss: 2.5230 | rl_loss: 0.8187 | pt_loss: 1.7043 | pg_loss: 0.5504 | reg_loss: 0.2683 | reward: -0.2662 | rev_kl: 1.1359 | stu_lens: 86.5000 | mixed_lens: 39.0000 | lr: 4.9615e-06 | scale: 2048.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    378/  5000| tot_loss: 2.3405 | rl_loss: 0.6757 | pt_loss: 1.6648 | pg_loss: 0.2789 | reg_loss: 0.3968 | reward: -0.3106 | rev_kl: 0.5327 | stu_lens: 128.0000 | mixed_lens: 77.5000 | lr: 4.9612e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    379/  5000| tot_loss: 2.7264 | rl_loss: 1.2078 | pt_loss: 1.5186 | pg_loss: 0.7992 | reg_loss: 0.4086 | reward: -0.9754 | rev_kl: 1.3360 | stu_lens: 61.0000 | mixed_lens: 43.0000 | lr: 4.9610e-06 | scale: 2048.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    380/  5000| tot_loss: 2.3563 | rl_loss: 0.8282 | pt_loss: 1.5282 | pg_loss: 0.2973 | reg_loss: 0.5308 | reward: -0.3422 | rev_kl: 1.6451 | stu_lens: 20.5000 | mixed_lens: 82.0000 | lr: 4.9607e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    381/  5000| tot_loss: 1.8177 | rl_loss: 0.3613 | pt_loss: 1.4564 | pg_loss: -0.0120 | reg_loss: 0.3733 | reward: -0.1922 | rev_kl: 0.7521 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9604e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    382/  5000| tot_loss: 2.7463 | rl_loss: 1.0124 | pt_loss: 1.7338 | pg_loss: 0.3937 | reg_loss: 0.6188 | reward: -1.9026 | rev_kl: 1.0441 | stu_lens: 71.5000 | mixed_lens: 69.5000 | lr: 4.9601e-06 | scale: 2048.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    383/  5000| tot_loss: 1.8609 | rl_loss: 0.3184 | pt_loss: 1.5425 | pg_loss: 0.0110 | reg_loss: 0.3074 | reward: -0.2711 | rev_kl: 1.8522 | stu_lens: 71.0000 | mixed_lens: 123.0000 | lr: 4.9598e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    384/  5000| tot_loss: 2.0433 | rl_loss: 0.4879 | pt_loss: 1.5554 | pg_loss: 0.0973 | reg_loss: 0.3906 | reward: -0.2369 | rev_kl: 0.6190 | stu_lens: 116.0000 | mixed_lens: 98.0000 | lr: 4.9595e-06 | scale: 2048.00 | time: 26.222 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    384/  5000| tot_loss: 2.3382 | rl_loss: 0.6155 | pt_loss: 1.7227 | pg_loss: 0.2276 | reg_loss: 0.3878 | reward: -0.4518 | rev_kl: 1.0074 | stu_lens: 94.6562 | mixed_lens: 88.6875 | lr: 4.9595e-06 | scale: 2048.00 | time: 26.222 | step time: 27.565
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    385/  5000| tot_loss: 2.3098 | rl_loss: 0.4181 | pt_loss: 1.8916 | pg_loss: 0.1425 | reg_loss: 0.2757 | reward: -0.2345 | rev_kl: 0.7917 | stu_lens: 117.0000 | mixed_lens: 100.5000 | lr: 4.9592e-06 | scale: 2048.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    386/  5000| tot_loss: 3.4305 | rl_loss: 1.4238 | pt_loss: 2.0066 | pg_loss: 0.3384 | reg_loss: 1.0854 | reward: -0.2965 | rev_kl: 1.0743 | stu_lens: 128.0000 | mixed_lens: 91.5000 | lr: 4.9590e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    387/  5000| tot_loss: 3.0155 | rl_loss: 1.4328 | pt_loss: 1.5827 | pg_loss: 0.2395 | reg_loss: 1.1933 | reward: -0.4952 | rev_kl: 0.8962 | stu_lens: 128.0000 | mixed_lens: 76.0000 | lr: 4.9587e-06 | scale: 2048.00 | time: 26.220 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    388/  5000| tot_loss: 3.6483 | rl_loss: 2.0532 | pt_loss: 1.5951 | pg_loss: 1.1426 | reg_loss: 0.9106 | reward: -1.0229 | rev_kl: 1.4516 | stu_lens: 30.5000 | mixed_lens: 38.5000 | lr: 4.9584e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    389/  5000| tot_loss: 3.0364 | rl_loss: 0.8926 | pt_loss: 2.1438 | pg_loss: 0.0328 | reg_loss: 0.8599 | reward: 0.0044 | rev_kl: 1.1675 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9581e-06 | scale: 2048.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    390/  5000| tot_loss: 3.1392 | rl_loss: 1.1597 | pt_loss: 1.9795 | pg_loss: 0.0770 | reg_loss: 1.0826 | reward: -0.1106 | rev_kl: 0.9444 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9578e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    391/  5000| tot_loss: 3.1695 | rl_loss: 1.3341 | pt_loss: 1.8354 | pg_loss: 0.1588 | reg_loss: 1.1753 | reward: -0.0599 | rev_kl: 1.2201 | stu_lens: 119.5000 | mixed_lens: 106.0000 | lr: 4.9575e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    392/  5000| tot_loss: 2.8918 | rl_loss: 1.2046 | pt_loss: 1.6872 | pg_loss: 0.0728 | reg_loss: 1.1318 | reward: -0.4730 | rev_kl: 0.8733 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9572e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    393/  5000| tot_loss: 2.9460 | rl_loss: 1.0781 | pt_loss: 1.8679 | pg_loss: 0.0534 | reg_loss: 1.0247 | reward: -0.2359 | rev_kl: 1.2118 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9569e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    394/  5000| tot_loss: 2.8849 | rl_loss: 1.1615 | pt_loss: 1.7234 | pg_loss: 0.0840 | reg_loss: 1.0776 | reward: -0.1800 | rev_kl: 1.0146 | stu_lens: 87.5000 | mixed_lens: 87.5000 | lr: 4.9566e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    395/  5000| tot_loss: 2.8164 | rl_loss: 1.0156 | pt_loss: 1.8008 | pg_loss: 0.0540 | reg_loss: 0.9616 | reward: -0.1557 | rev_kl: 0.8053 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9563e-06 | scale: 2048.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    396/  5000| tot_loss: 2.7160 | rl_loss: 1.1466 | pt_loss: 1.5694 | pg_loss: 0.0528 | reg_loss: 1.0938 | reward: -0.2983 | rev_kl: 1.1208 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9560e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    397/  5000| tot_loss: 2.8972 | rl_loss: 0.9780 | pt_loss: 1.9192 | pg_loss: 0.0544 | reg_loss: 0.9236 | reward: -0.1501 | rev_kl: 0.8372 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9557e-06 | scale: 2048.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    398/  5000| tot_loss: 2.9126 | rl_loss: 1.1115 | pt_loss: 1.8011 | pg_loss: 0.3351 | reg_loss: 0.7764 | reward: -0.0900 | rev_kl: 0.9619 | stu_lens: 87.5000 | mixed_lens: 90.5000 | lr: 4.9554e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    399/  5000| tot_loss: 2.8882 | rl_loss: 1.2260 | pt_loss: 1.6622 | pg_loss: 0.0515 | reg_loss: 1.1744 | reward: -0.1433 | rev_kl: 0.7528 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9551e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
                                 Evaluation #4                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son particles elementales │
│                                       │ que pueden hallarse en el modelo     │
│                                       │ estándar de la física de partículas. │
│                                       │ En el modelo estándar, hay seis      │
│                                       │ tipos de cuarks:                     │
│                                       │                                      │
│                                       │ - Cuark top                          │
│                                       │ - Cuark bottom                       │
│                                       │ - Cuark strange                      │
│                                       │ - Cuark charm                        │
│                                       │ - Cuark beauty                       │
│                                       │ - Cuarkantiquedad                    │
│                                       │                                      │
│                                       │ Los cuarks strange y charming se     │
│                                       │ diferencian del resto de los cuarks  │
│                                       │ en que son más lentos que los otros  │
│                                       │ cuarks.                              │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es el indicador de            │
│                                       │ calentamiento global. Es una medida  │
│                                       │ del calentamiento global sobre el    │
│                                       │ periodo de 1951 a 1980. Se utiliza   │
│                                       │ para verificar la existencia del     │
│                                       │ calentamiento global y cuantificar   │
│                                       │ su intensidad.                       │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ La lista de cápsulas del tiempo más  │
│                                       │ famosas de la historia es:           │
│                                       │                                      │
│                                       │ - El Jardín de la Eternidad: creada  │
│                                       │ en 1887, contenía aparecidas de la   │
│                                       │ gente valorada por el hombre, así    │
│                                       │ como las aparientes de otros seres.  │
│                                       │ La cápsula fue abierta el 10 de      │
│                                       │ octubre de 1995.                     │
│                                       │                                      │
│                                       │ - La cápsula del tiempo: creada en   │
│                                       │ 1992, estuvo "en espera" durante 20  │
│                                       │ años. Fue abierta el 26 de           │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.979 | exact_match: 0.104 | rev_kl: 0.932 | lens: 93.295 | pt_loss: 1.753 | lm_loss: 1.891 | kd_loss: 1.615 
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    400/  5000| tot_loss: 3.3276 | rl_loss: 1.4635 | pt_loss: 1.8641 | pg_loss: 0.4749 | reg_loss: 0.9886 | reward: -0.3704 | rev_kl: 0.7356 | stu_lens: 84.5000 | mixed_lens: 81.5000 | lr: 4.9548e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    400/  5000| tot_loss: 2.8514 | rl_loss: 1.1274 | pt_loss: 1.7241 | pg_loss: 0.2087 | reg_loss: 0.9187 | reward: -0.2023 | rev_kl: 0.8943 | stu_lens: 111.9375 | mixed_lens: 102.3594 | lr: 4.9548e-06 | scale: 2048.00 | time: 26.312 | step time: 27.556
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    401/  5000| tot_loss: 2.2108 | rl_loss: 1.1560 | pt_loss: 1.0548 | pg_loss: 0.0448 | reg_loss: 1.1112 | reward: -0.3491 | rev_kl: 0.8908 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9545e-06 | scale: 2048.00 | time: 26.349 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    402/  5000| tot_loss: 2.6528 | rl_loss: 0.5000 | pt_loss: 2.1527 | pg_loss: 0.0287 | reg_loss: 0.4714 | reward: -0.3924 | rev_kl: 0.9275 | stu_lens: 128.0000 | mixed_lens: 73.0000 | lr: 4.9542e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    403/  5000| tot_loss: 2.5768 | rl_loss: 0.6845 | pt_loss: 1.8922 | pg_loss: -0.0203 | reg_loss: 0.7048 | reward: -0.1117 | rev_kl: 0.8678 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9539e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    404/  5000| tot_loss: 2.7460 | rl_loss: 0.6897 | pt_loss: 2.0564 | pg_loss: 0.0024 | reg_loss: 0.6873 | reward: -0.1204 | rev_kl: 0.8216 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9536e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    405/  5000| tot_loss: 2.4260 | rl_loss: 0.6516 | pt_loss: 1.7745 | pg_loss: 0.0143 | reg_loss: 0.6372 | reward: 0.0024 | rev_kl: 1.2311 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9533e-06 | scale: 2048.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    406/  5000| tot_loss: 2.6094 | rl_loss: 1.1050 | pt_loss: 1.5045 | pg_loss: 0.3803 | reg_loss: 0.7247 | reward: -0.2533 | rev_kl: 0.5304 | stu_lens: 128.0000 | mixed_lens: 76.5000 | lr: 4.9530e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    407/  5000| tot_loss: 2.3391 | rl_loss: 0.6083 | pt_loss: 1.7308 | pg_loss: 0.0245 | reg_loss: 0.5838 | reward: -0.2137 | rev_kl: 0.9220 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9527e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    408/  5000| tot_loss: 3.1767 | rl_loss: 1.4544 | pt_loss: 1.7223 | pg_loss: 0.5289 | reg_loss: 0.9255 | reward: -0.7235 | rev_kl: 1.6906 | stu_lens: 76.0000 | mixed_lens: 61.0000 | lr: 4.9524e-06 | scale: 2048.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    409/  5000| tot_loss: 2.5398 | rl_loss: 0.8552 | pt_loss: 1.6845 | pg_loss: 0.3588 | reg_loss: 0.4964 | reward: -0.3141 | rev_kl: 0.8086 | stu_lens: 128.0000 | mixed_lens: 83.0000 | lr: 4.9520e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    410/  5000| tot_loss: 2.4514 | rl_loss: 0.8966 | pt_loss: 1.5547 | pg_loss: 0.3434 | reg_loss: 0.5532 | reward: -0.3444 | rev_kl: 0.8689 | stu_lens: 84.5000 | mixed_lens: 81.5000 | lr: 4.9517e-06 | scale: 2048.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    411/  5000| tot_loss: 2.3616 | rl_loss: 0.6553 | pt_loss: 1.7062 | pg_loss: 0.2148 | reg_loss: 0.4405 | reward: 1.9995 | rev_kl: 0.9055 | stu_lens: 63.0000 | mixed_lens: 66.0000 | lr: 4.9514e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    412/  5000| tot_loss: 2.8978 | rl_loss: 1.1816 | pt_loss: 1.7162 | pg_loss: 0.4546 | reg_loss: 0.7270 | reward: -1.1721 | rev_kl: 0.8732 | stu_lens: 67.5000 | mixed_lens: 65.5000 | lr: 4.9511e-06 | scale: 2048.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    413/  5000| tot_loss: 2.2458 | rl_loss: 0.5031 | pt_loss: 1.7426 | pg_loss: 0.0555 | reg_loss: 0.4476 | reward: -0.1032 | rev_kl: 0.2115 | stu_lens: 128.0000 | mixed_lens: 82.0000 | lr: 4.9508e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    414/  5000| tot_loss: 2.5333 | rl_loss: 0.6608 | pt_loss: 1.8725 | pg_loss: 0.0860 | reg_loss: 0.5748 | reward: -0.2110 | rev_kl: 0.8809 | stu_lens: 128.0000 | mixed_lens: 111.0000 | lr: 4.9505e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    415/  5000| tot_loss: 2.2532 | rl_loss: 0.4613 | pt_loss: 1.7919 | pg_loss: 0.0684 | reg_loss: 0.3930 | reward: -0.1419 | rev_kl: 0.9754 | stu_lens: 128.0000 | mixed_lens: 107.5000 | lr: 4.9501e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    416/  5000| tot_loss: 2.2130 | rl_loss: 0.5127 | pt_loss: 1.7002 | pg_loss: -0.0063 | reg_loss: 0.5190 | reward: -0.1801 | rev_kl: 1.1815 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9498e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    416/  5000| tot_loss: 2.5369 | rl_loss: 0.7793 | pt_loss: 1.7576 | pg_loss: 0.1509 | reg_loss: 0.6283 | reward: -0.2603 | rev_kl: 0.8597 | stu_lens: 110.5312 | mixed_lens: 99.3438 | lr: 4.9498e-06 | scale: 2048.00 | time: 26.267 | step time: 27.565
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    417/  5000| tot_loss: 2.5159 | rl_loss: 0.7728 | pt_loss: 1.7431 | pg_loss: -0.0103 | reg_loss: 0.7831 | reward: -0.2398 | rev_kl: 1.2670 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9495e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    418/  5000| tot_loss: 1.6586 | rl_loss: 0.4525 | pt_loss: 1.2061 | pg_loss: -0.0037 | reg_loss: 0.4562 | reward: -0.0646 | rev_kl: 1.0377 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9492e-06 | scale: 2048.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    419/  5000| tot_loss: 2.0737 | rl_loss: 0.2927 | pt_loss: 1.7811 | pg_loss: 0.0208 | reg_loss: 0.2719 | reward: 0.0090 | rev_kl: 0.6203 | stu_lens: 117.5000 | mixed_lens: 82.0000 | lr: 4.9489e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    420/  5000| tot_loss: 2.5333 | rl_loss: 0.4611 | pt_loss: 2.0722 | pg_loss: 0.0461 | reg_loss: 0.4150 | reward: -0.2811 | rev_kl: 0.8925 | stu_lens: 128.0000 | mixed_lens: 121.0000 | lr: 4.9485e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    421/  5000| tot_loss: 1.9041 | rl_loss: 0.5314 | pt_loss: 1.3727 | pg_loss: 0.1861 | reg_loss: 0.3453 | reward: -0.2528 | rev_kl: 0.9930 | stu_lens: 87.5000 | mixed_lens: 84.5000 | lr: 4.9482e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    422/  5000| tot_loss: 2.1972 | rl_loss: 0.3500 | pt_loss: 1.8473 | pg_loss: -0.0071 | reg_loss: 0.3570 | reward: -0.1221 | rev_kl: 1.1043 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9479e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    423/  5000| tot_loss: 2.1012 | rl_loss: 0.4910 | pt_loss: 1.6102 | pg_loss: 0.0016 | reg_loss: 0.4894 | reward: -0.1761 | rev_kl: 0.7691 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9476e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    424/  5000| tot_loss: 2.7295 | rl_loss: 0.7878 | pt_loss: 1.9417 | pg_loss: 0.2548 | reg_loss: 0.5330 | reward: -0.2078 | rev_kl: 1.0806 | stu_lens: 88.5000 | mixed_lens: 79.5000 | lr: 4.9472e-06 | scale: 2048.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    425/  5000| tot_loss: 2.4654 | rl_loss: 0.8611 | pt_loss: 1.6043 | pg_loss: 0.2723 | reg_loss: 0.5888 | reward: -0.3074 | rev_kl: 0.4695 | stu_lens: 128.0000 | mixed_lens: 76.5000 | lr: 4.9469e-06 | scale: 2048.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    426/  5000| tot_loss: 2.1590 | rl_loss: 0.4458 | pt_loss: 1.7132 | pg_loss: 0.0120 | reg_loss: 0.4338 | reward: -0.1458 | rev_kl: 0.7295 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9466e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    427/  5000| tot_loss: 2.5078 | rl_loss: 0.5835 | pt_loss: 1.9244 | pg_loss: -0.0190 | reg_loss: 0.6025 | reward: -0.4828 | rev_kl: 1.1719 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9463e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    428/  5000| tot_loss: 2.4239 | rl_loss: 0.4912 | pt_loss: 1.9327 | pg_loss: 0.1256 | reg_loss: 0.3657 | reward: -0.1026 | rev_kl: 0.9370 | stu_lens: 128.0000 | mixed_lens: 107.5000 | lr: 4.9459e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    429/  5000| tot_loss: 3.1097 | rl_loss: 1.2170 | pt_loss: 1.8926 | pg_loss: 0.3894 | reg_loss: 0.8277 | reward: -1.0630 | rev_kl: 0.5079 | stu_lens: 67.5000 | mixed_lens: 65.5000 | lr: 4.9456e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    430/  5000| tot_loss: 2.4296 | rl_loss: 0.8908 | pt_loss: 1.5388 | pg_loss: 0.4076 | reg_loss: 0.4832 | reward: -0.3609 | rev_kl: 0.4784 | stu_lens: 84.5000 | mixed_lens: 81.5000 | lr: 4.9453e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    431/  5000| tot_loss: 2.6855 | rl_loss: 0.8808 | pt_loss: 1.8048 | pg_loss: 0.4079 | reg_loss: 0.4729 | reward: -0.6499 | rev_kl: 0.8831 | stu_lens: 87.5000 | mixed_lens: 76.0000 | lr: 4.9449e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    432/  5000| tot_loss: 1.9554 | rl_loss: 0.5211 | pt_loss: 1.4342 | pg_loss: 0.0564 | reg_loss: 0.4647 | reward: -0.3116 | rev_kl: 0.5337 | stu_lens: 128.0000 | mixed_lens: 112.0000 | lr: 4.9446e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    432/  5000| tot_loss: 2.3067 | rl_loss: 0.6169 | pt_loss: 1.6898 | pg_loss: 0.1575 | reg_loss: 0.4594 | reward: -0.2461 | rev_kl: 0.8911 | stu_lens: 110.0938 | mixed_lens: 100.2969 | lr: 4.9446e-06 | scale: 2048.00 | time: 26.257 | step time: 27.547
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    433/  5000| tot_loss: 2.4322 | rl_loss: 0.4652 | pt_loss: 1.9670 | pg_loss: -0.0036 | reg_loss: 0.4688 | reward: -0.1404 | rev_kl: 1.1197 | stu_lens: 119.5000 | mixed_lens: 128.0000 | lr: 4.9443e-06 | scale: 2048.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    434/  5000| tot_loss: 2.3835 | rl_loss: 0.6102 | pt_loss: 1.7733 | pg_loss: 0.1386 | reg_loss: 0.4716 | reward: 0.0484 | rev_kl: 1.0946 | stu_lens: 128.0000 | mixed_lens: 106.0000 | lr: 4.9439e-06 | scale: 2048.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    435/  5000| tot_loss: 2.4425 | rl_loss: 0.5361 | pt_loss: 1.9063 | pg_loss: 0.0046 | reg_loss: 0.5315 | reward: -0.1779 | rev_kl: 0.8760 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9436e-06 | scale: 2048.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    436/  5000| tot_loss: 2.6295 | rl_loss: 0.7839 | pt_loss: 1.8456 | pg_loss: 0.3611 | reg_loss: 0.4228 | reward: -0.4710 | rev_kl: 1.0369 | stu_lens: 84.5000 | mixed_lens: 81.5000 | lr: 4.9432e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    437/  5000| tot_loss: 1.8881 | rl_loss: 0.3906 | pt_loss: 1.4975 | pg_loss: 0.0222 | reg_loss: 0.3684 | reward: -0.1158 | rev_kl: 0.7897 | stu_lens: 128.0000 | mixed_lens: 114.0000 | lr: 4.9429e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    438/  5000| tot_loss: 1.7839 | rl_loss: 0.2649 | pt_loss: 1.5189 | pg_loss: -0.0035 | reg_loss: 0.2684 | reward: 0.0262 | rev_kl: 1.0850 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9426e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    439/  5000| tot_loss: 2.3048 | rl_loss: 0.6512 | pt_loss: 1.6536 | pg_loss: 0.2950 | reg_loss: 0.3562 | reward: -0.1843 | rev_kl: 0.7375 | stu_lens: 88.5000 | mixed_lens: 79.5000 | lr: 4.9422e-06 | scale: 2048.00 | time: 26.327 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    440/  5000| tot_loss: 2.8466 | rl_loss: 0.6369 | pt_loss: 2.2096 | pg_loss: 0.0670 | reg_loss: 0.5700 | reward: -0.3250 | rev_kl: 0.8998 | stu_lens: 128.0000 | mixed_lens: 121.0000 | lr: 4.9419e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    441/  5000| tot_loss: 1.6084 | rl_loss: 0.4212 | pt_loss: 1.1872 | pg_loss: 0.1103 | reg_loss: 0.3109 | reward: -0.3032 | rev_kl: 1.0626 | stu_lens: 87.5000 | mixed_lens: 101.5000 | lr: 4.9415e-06 | scale: 2048.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    442/  5000| tot_loss: 2.2704 | rl_loss: 0.3333 | pt_loss: 1.9371 | pg_loss: 0.0118 | reg_loss: 0.3215 | reward: -0.0609 | rev_kl: 0.9219 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9412e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    443/  5000| tot_loss: 2.6304 | rl_loss: 0.6889 | pt_loss: 1.9415 | pg_loss: 0.3937 | reg_loss: 0.2952 | reward: -0.3561 | rev_kl: 0.9791 | stu_lens: 128.0000 | mixed_lens: 62.5000 | lr: 4.9408e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    444/  5000| tot_loss: 2.1803 | rl_loss: 0.2792 | pt_loss: 1.9010 | pg_loss: -0.0088 | reg_loss: 0.2880 | reward: -0.1434 | rev_kl: 0.9467 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9405e-06 | scale: 2048.00 | time: 26.220 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    445/  5000| tot_loss: 1.8629 | rl_loss: 0.3727 | pt_loss: 1.4902 | pg_loss: -0.0147 | reg_loss: 0.3874 | reward: -0.2126 | rev_kl: 0.8932 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9401e-06 | scale: 2048.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    446/  5000| tot_loss: 2.4790 | rl_loss: 0.6989 | pt_loss: 1.7801 | pg_loss: 0.1372 | reg_loss: 0.5617 | reward: -0.9603 | rev_kl: 0.6563 | stu_lens: 65.5000 | mixed_lens: 66.5000 | lr: 4.9398e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    447/  5000| tot_loss: 2.1793 | rl_loss: 0.3829 | pt_loss: 1.7965 | pg_loss: 0.0082 | reg_loss: 0.3747 | reward: -0.1633 | rev_kl: 0.9497 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9394e-06 | scale: 2048.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    448/  5000| tot_loss: 2.4417 | rl_loss: 0.6629 | pt_loss: 1.7788 | pg_loss: 0.2734 | reg_loss: 0.3896 | reward: -0.4237 | rev_kl: 0.9910 | stu_lens: 86.5000 | mixed_lens: 93.5000 | lr: 4.9391e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    448/  5000| tot_loss: 2.2870 | rl_loss: 0.5089 | pt_loss: 1.7781 | pg_loss: 0.1297 | reg_loss: 0.3792 | reward: -0.2306 | rev_kl: 0.9078 | stu_lens: 112.2812 | mixed_lens: 102.7656 | lr: 4.9391e-06 | scale: 2048.00 | time: 26.278 | step time: 27.552
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    449/  5000| tot_loss: 1.9174 | rl_loss: 0.3163 | pt_loss: 1.6012 | pg_loss: 0.0052 | reg_loss: 0.3111 | reward: -0.1395 | rev_kl: 0.7430 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9387e-06 | scale: 2048.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    450/  5000| tot_loss: 3.4124 | rl_loss: 1.8498 | pt_loss: 1.5626 | pg_loss: 0.7963 | reg_loss: 1.0536 | reward: -0.6198 | rev_kl: 0.6283 | stu_lens: 17.5000 | mixed_lens: 36.0000 | lr: 4.9384e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    451/  5000| tot_loss: 3.4603 | rl_loss: 2.0691 | pt_loss: 1.3912 | pg_loss: 1.3234 | reg_loss: 0.7457 | reward: -0.5750 | rev_kl: 0.2169 | stu_lens: 31.5000 | mixed_lens: 29.5000 | lr: 4.9380e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    452/  5000| tot_loss: 2.4487 | rl_loss: 1.0139 | pt_loss: 1.4348 | pg_loss: 0.0775 | reg_loss: 0.9363 | reward: -0.2143 | rev_kl: 0.8363 | stu_lens: 128.0000 | mixed_lens: 125.0000 | lr: 4.9377e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    453/  5000| tot_loss: 3.0142 | rl_loss: 1.1372 | pt_loss: 1.8770 | pg_loss: 0.0525 | reg_loss: 1.0847 | reward: -0.0861 | rev_kl: 0.6473 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9373e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    454/  5000| tot_loss: 2.8304 | rl_loss: 0.9943 | pt_loss: 1.8362 | pg_loss: 0.0368 | reg_loss: 0.9574 | reward: -0.2555 | rev_kl: 1.4095 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9370e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    455/  5000| tot_loss: 2.9581 | rl_loss: 1.0800 | pt_loss: 1.8781 | pg_loss: 0.1612 | reg_loss: 0.9188 | reward: -0.4997 | rev_kl: 0.9407 | stu_lens: 128.0000 | mixed_lens: 91.5000 | lr: 4.9366e-06 | scale: 2048.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    456/  5000| tot_loss: 2.5621 | rl_loss: 0.9179 | pt_loss: 1.6442 | pg_loss: 0.0914 | reg_loss: 0.8265 | reward: -0.0105 | rev_kl: 1.1065 | stu_lens: 118.5000 | mixed_lens: 121.5000 | lr: 4.9362e-06 | scale: 2048.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    457/  5000| tot_loss: 3.9823 | rl_loss: 2.2442 | pt_loss: 1.7381 | pg_loss: 0.9709 | reg_loss: 1.2734 | reward: -1.3464 | rev_kl: 0.7042 | stu_lens: 117.0000 | mixed_lens: 38.5000 | lr: 4.9359e-06 | scale: 2048.00 | time: 26.348 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    458/  5000| tot_loss: 2.4121 | rl_loss: 1.0483 | pt_loss: 1.3637 | pg_loss: 0.0635 | reg_loss: 0.9848 | reward: -0.3730 | rev_kl: 0.8158 | stu_lens: 92.5000 | mixed_lens: 128.0000 | lr: 4.9355e-06 | scale: 2048.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    459/  5000| tot_loss: 3.0264 | rl_loss: 1.3406 | pt_loss: 1.6858 | pg_loss: 0.4987 | reg_loss: 0.8418 | reward: -0.0865 | rev_kl: 0.3848 | stu_lens: 74.0000 | mixed_lens: 74.5000 | lr: 4.9352e-06 | scale: 2048.00 | time: 26.338 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    460/  5000| tot_loss: 2.1631 | rl_loss: 0.2669 | pt_loss: 1.8961 | pg_loss: 0.0288 | reg_loss: 0.2381 | reward: -0.0163 | rev_kl: 0.4372 | stu_lens: 128.0000 | mixed_lens: 102.0000 | lr: 4.9348e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    461/  5000| tot_loss: 2.9953 | rl_loss: 1.3580 | pt_loss: 1.6373 | pg_loss: 0.3445 | reg_loss: 1.0135 | reward: -0.4389 | rev_kl: 1.0222 | stu_lens: 128.0000 | mixed_lens: 96.5000 | lr: 4.9344e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    462/  5000| tot_loss: 2.7487 | rl_loss: 1.1758 | pt_loss: 1.5729 | pg_loss: 0.1612 | reg_loss: 1.0146 | reward: -0.1515 | rev_kl: 0.7635 | stu_lens: 128.0000 | mixed_lens: 106.5000 | lr: 4.9341e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    463/  5000| tot_loss: 3.9486 | rl_loss: 2.2636 | pt_loss: 1.6850 | pg_loss: 1.6728 | reg_loss: 0.5908 | reward: -0.7103 | rev_kl: 0.4136 | stu_lens: 17.5000 | mixed_lens: 20.0000 | lr: 4.9337e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    464/  5000| tot_loss: 3.4083 | rl_loss: 1.2924 | pt_loss: 2.1159 | pg_loss: 0.0688 | reg_loss: 1.2236 | reward: -0.4427 | rev_kl: 1.0451 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9333e-06 | scale: 2048.00 | time: 26.261 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    464/  5000| tot_loss: 3.0136 | rl_loss: 1.2994 | pt_loss: 1.7142 | pg_loss: 0.3619 | reg_loss: 0.9376 | reward: -0.3846 | rev_kl: 0.8240 | stu_lens: 101.6562 | mixed_lens: 96.4219 | lr: 4.9333e-06 | scale: 2048.00 | time: 26.261 | step time: 27.577
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    465/  5000| tot_loss: 3.4151 | rl_loss: 1.4503 | pt_loss: 1.9648 | pg_loss: 0.5082 | reg_loss: 0.9422 | reward: -0.1714 | rev_kl: 0.5659 | stu_lens: 66.5000 | mixed_lens: 66.5000 | lr: 4.9330e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    466/  5000| tot_loss: 2.4195 | rl_loss: 0.8812 | pt_loss: 1.5383 | pg_loss: 0.0299 | reg_loss: 0.8514 | reward: -0.2635 | rev_kl: 1.1948 | stu_lens: 128.0000 | mixed_lens: 125.0000 | lr: 4.9326e-06 | scale: 2048.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    467/  5000| tot_loss: 2.9179 | rl_loss: 0.9597 | pt_loss: 1.9582 | pg_loss: 0.2271 | reg_loss: 0.7326 | reward: -0.9127 | rev_kl: 0.4862 | stu_lens: 80.5000 | mixed_lens: 75.0000 | lr: 4.9322e-06 | scale: 2048.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    468/  5000| tot_loss: 2.4089 | rl_loss: 0.8001 | pt_loss: 1.6088 | pg_loss: 0.0427 | reg_loss: 0.7574 | reward: -0.0900 | rev_kl: 0.9988 | stu_lens: 128.0000 | mixed_lens: 121.5000 | lr: 4.9319e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    469/  5000| tot_loss: 3.1157 | rl_loss: 0.8707 | pt_loss: 2.2450 | pg_loss: 0.0589 | reg_loss: 0.8119 | reward: -0.2959 | rev_kl: 0.9916 | stu_lens: 115.5000 | mixed_lens: 128.0000 | lr: 4.9315e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    470/  5000| tot_loss: 1.8952 | rl_loss: 0.3448 | pt_loss: 1.5504 | pg_loss: 0.0951 | reg_loss: 0.2498 | reward: -0.1904 | rev_kl: 0.7538 | stu_lens: 128.0000 | mixed_lens: 100.5000 | lr: 4.9311e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    471/  5000| tot_loss: 2.4902 | rl_loss: 0.9400 | pt_loss: 1.5502 | pg_loss: 0.5919 | reg_loss: 0.3482 | reward: -0.5584 | rev_kl: 0.6025 | stu_lens: 78.0000 | mixed_lens: 24.5000 | lr: 4.9307e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    472/  5000| tot_loss: 2.6513 | rl_loss: 0.6950 | pt_loss: 1.9563 | pg_loss: 0.0309 | reg_loss: 0.6642 | reward: -0.1546 | rev_kl: 0.8411 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9304e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    473/  5000| tot_loss: 2.1588 | rl_loss: 0.7548 | pt_loss: 1.4039 | pg_loss: 0.0069 | reg_loss: 0.7479 | reward: -0.1937 | rev_kl: 1.2321 | stu_lens: 95.0000 | mixed_lens: 128.0000 | lr: 4.9300e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    474/  5000| tot_loss: 2.3251 | rl_loss: 0.6661 | pt_loss: 1.6591 | pg_loss: -0.0148 | reg_loss: 0.6809 | reward: -0.4458 | rev_kl: 1.0222 | stu_lens: 101.5000 | mixed_lens: 128.0000 | lr: 4.9296e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    475/  5000| tot_loss: 1.9890 | rl_loss: 0.7027 | pt_loss: 1.2863 | pg_loss: 0.1736 | reg_loss: 0.5291 | reward: -0.7570 | rev_kl: 0.7071 | stu_lens: 117.0000 | mixed_lens: 83.0000 | lr: 4.9292e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    476/  5000| tot_loss: 2.6027 | rl_loss: 0.8074 | pt_loss: 1.7953 | pg_loss: 0.0099 | reg_loss: 0.7975 | reward: -0.4666 | rev_kl: 0.9800 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9289e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    477/  5000| tot_loss: 2.2583 | rl_loss: 0.6837 | pt_loss: 1.5746 | pg_loss: 0.1371 | reg_loss: 0.5466 | reward: -0.3661 | rev_kl: 0.8158 | stu_lens: 119.0000 | mixed_lens: 96.5000 | lr: 4.9285e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    478/  5000| tot_loss: 2.3669 | rl_loss: 0.6435 | pt_loss: 1.7233 | pg_loss: 0.0323 | reg_loss: 0.6113 | reward: -0.1803 | rev_kl: 0.7462 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9281e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    479/  5000| tot_loss: 2.3509 | rl_loss: 0.4790 | pt_loss: 1.8719 | pg_loss: -0.0009 | reg_loss: 0.4799 | reward: -0.1756 | rev_kl: 0.9382 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9277e-06 | scale: 2048.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    480/  5000| tot_loss: 2.5055 | rl_loss: 0.8511 | pt_loss: 1.6543 | pg_loss: 0.3951 | reg_loss: 0.4560 | reward: -0.0922 | rev_kl: 0.6044 | stu_lens: 74.0000 | mixed_lens: 64.0000 | lr: 4.9273e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    480/  5000| tot_loss: 2.6090 | rl_loss: 0.8813 | pt_loss: 1.7277 | pg_loss: 0.2296 | reg_loss: 0.6517 | reward: -0.3860 | rev_kl: 0.7827 | stu_lens: 99.7500 | mixed_lens: 93.9688 | lr: 4.9273e-06 | scale: 2048.00 | time: 26.260 | step time: 27.567
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    481/  5000| tot_loss: 2.5701 | rl_loss: 0.5016 | pt_loss: 2.0685 | pg_loss: 0.0290 | reg_loss: 0.4725 | reward: -0.1401 | rev_kl: 0.8271 | stu_lens: 111.5000 | mixed_lens: 128.0000 | lr: 4.9269e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    482/  5000| tot_loss: 1.9740 | rl_loss: 0.7769 | pt_loss: 1.1971 | pg_loss: 0.3721 | reg_loss: 0.4048 | reward: -0.6940 | rev_kl: 0.6841 | stu_lens: 70.0000 | mixed_lens: 73.5000 | lr: 4.9266e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    483/  5000| tot_loss: 2.4079 | rl_loss: 0.7845 | pt_loss: 1.6234 | pg_loss: 0.1623 | reg_loss: 0.6222 | reward: -0.3943 | rev_kl: 0.7691 | stu_lens: 128.0000 | mixed_lens: 91.0000 | lr: 4.9262e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    484/  5000| tot_loss: 2.0936 | rl_loss: 0.5624 | pt_loss: 1.5313 | pg_loss: 0.0711 | reg_loss: 0.4912 | reward: -0.0824 | rev_kl: 0.8617 | stu_lens: 128.0000 | mixed_lens: 117.5000 | lr: 4.9258e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    485/  5000| tot_loss: 2.3846 | rl_loss: 0.6582 | pt_loss: 1.7264 | pg_loss: 0.1171 | reg_loss: 0.5411 | reward: -0.2552 | rev_kl: 0.8980 | stu_lens: 128.0000 | mixed_lens: 100.5000 | lr: 4.9254e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    486/  5000| tot_loss: 2.1990 | rl_loss: 0.5848 | pt_loss: 1.6142 | pg_loss: 0.0099 | reg_loss: 0.5749 | reward: -0.2301 | rev_kl: 0.9943 | stu_lens: 115.5000 | mixed_lens: 128.0000 | lr: 4.9250e-06 | scale: 2048.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    487/  5000| tot_loss: 2.4231 | rl_loss: 0.6640 | pt_loss: 1.7591 | pg_loss: 0.1615 | reg_loss: 0.5024 | reward: -0.4408 | rev_kl: 0.4903 | stu_lens: 74.0000 | mixed_lens: 38.0000 | lr: 4.9246e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    488/  5000| tot_loss: 2.2768 | rl_loss: 0.4829 | pt_loss: 1.7939 | pg_loss: 0.0621 | reg_loss: 0.4208 | reward: -0.0595 | rev_kl: 0.8188 | stu_lens: 102.0000 | mixed_lens: 121.5000 | lr: 4.9242e-06 | scale: 2048.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    489/  5000| tot_loss: 2.3898 | rl_loss: 0.9115 | pt_loss: 1.4782 | pg_loss: 0.3333 | reg_loss: 0.5782 | reward: -0.7485 | rev_kl: 1.1040 | stu_lens: 128.0000 | mixed_lens: 83.5000 | lr: 4.9238e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    490/  5000| tot_loss: 1.8512 | rl_loss: 0.5394 | pt_loss: 1.3118 | pg_loss: 0.0418 | reg_loss: 0.4976 | reward: -0.1587 | rev_kl: 1.1919 | stu_lens: 128.0000 | mixed_lens: 121.5000 | lr: 4.9234e-06 | scale: 2048.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    491/  5000| tot_loss: 2.2316 | rl_loss: 0.2827 | pt_loss: 1.9489 | pg_loss: -0.0337 | reg_loss: 0.3164 | reward: -0.6655 | rev_kl: 0.4711 | stu_lens: 117.0000 | mixed_lens: 57.0000 | lr: 4.9230e-06 | scale: 2048.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    492/  5000| tot_loss: 2.6916 | rl_loss: 0.4711 | pt_loss: 2.2205 | pg_loss: 0.2119 | reg_loss: 0.2592 | reward: -0.6145 | rev_kl: 0.5452 | stu_lens: 65.0000 | mixed_lens: 65.0000 | lr: 4.9226e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    493/  5000| tot_loss: 2.2653 | rl_loss: 0.5755 | pt_loss: 1.6898 | pg_loss: 0.1572 | reg_loss: 0.4184 | reward: -0.5955 | rev_kl: 1.4937 | stu_lens: 73.0000 | mixed_lens: 79.5000 | lr: 4.9223e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    494/  5000| tot_loss: 2.4848 | rl_loss: 0.6493 | pt_loss: 1.8355 | pg_loss: 0.1260 | reg_loss: 0.5233 | reward: -0.3174 | rev_kl: 1.0961 | stu_lens: 122.5000 | mixed_lens: 96.5000 | lr: 4.9219e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    495/  5000| tot_loss: 2.6916 | rl_loss: 0.4914 | pt_loss: 2.2002 | pg_loss: 0.0111 | reg_loss: 0.4803 | reward: -0.3248 | rev_kl: 1.2769 | stu_lens: 119.0000 | mixed_lens: 128.0000 | lr: 4.9215e-06 | scale: 2048.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    496/  5000| tot_loss: 3.1955 | rl_loss: 1.1787 | pt_loss: 2.0169 | pg_loss: 0.5338 | reg_loss: 0.6449 | reward: -1.7529 | rev_kl: 1.0938 | stu_lens: 65.5000 | mixed_lens: 65.0000 | lr: 4.9211e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    496/  5000| tot_loss: 2.4374 | rl_loss: 0.6631 | pt_loss: 1.7743 | pg_loss: 0.1698 | reg_loss: 0.4933 | reward: -0.3651 | rev_kl: 0.8415 | stu_lens: 103.8750 | mixed_lens: 98.6875 | lr: 4.9211e-06 | scale: 2048.00 | time: 26.273 | step time: 27.554
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    497/  5000| tot_loss: 2.9657 | rl_loss: 1.0569 | pt_loss: 1.9088 | pg_loss: 0.7169 | reg_loss: 0.3400 | reward: -0.9659 | rev_kl: 0.3313 | stu_lens: 24.5000 | mixed_lens: 38.5000 | lr: 4.9207e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    498/  5000| tot_loss: 2.4496 | rl_loss: 0.4538 | pt_loss: 1.9958 | pg_loss: -0.0141 | reg_loss: 0.4679 | reward: -0.2551 | rev_kl: 0.7670 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9203e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    499/  5000| tot_loss: 2.3444 | rl_loss: 0.2614 | pt_loss: 2.0830 | pg_loss: 0.0058 | reg_loss: 0.2555 | reward: -0.1220 | rev_kl: 1.1069 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9199e-06 | scale: 2048.00 | time: 26.244 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/500
                                 Evaluation #5                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son Partículas            │
│                                       │ elementales que forman parte del     │
│                                       │ modelo estándar de particles .       │
│                                       │ Hay siete tipos de cuarks:           │
│                                       │                                      │
│                                       │ - CuarkUp (u)                        │
│                                       │ - CuarkDown (d)                      │
│                                       │ - CuarkCharm (c)                     │
│                                       │ - CuarkStrange (s)                   │
│                                       │ - CuarkBorón (b)                     │
│                                       │ - CuarkTau (τ)                       │
│                                       │ - CuarkXi (ξ)                        │
│                                       │ - CuarkY (Y)                         │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es un Índice de Mediación     │
│                                       │ Científica, un número que medea la   │
│                                       │ influencia de la mediación           │
│                                       │ científica. Se calcula dividiendo el │
│                                       │ número de citas por el número de     │
│                                       │ artículos publicados en un periodo   │
│                                       │ de tiempo con el número de autores   │
│                                       │ de los artículos. El IMC también se  │
│                                       │ puede usar para comparar las         │
│                                       │ influencias de los autores y las     │
│                                       │ revistas. El IMC es sometido a una   │
│                                       │ correlación de Pearson con otros     │
│                                       │ índices de impacto como el IF o el   │
│                                       │ JCR.                                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ 1. 1633 — la primera cápsula del     │
│                                       │ tiempo fue creada por el astrónomo y │
│                                       │ físico inglés Robert Hutchings       │
│                                       │ Goddard, quien la abrió el 6 de      │
│                                       │ diciembre de 2022, y contenía una    │
│                                       │ tarjeta de visita con los nombres de │
│                                       │ Dios, Jesucristo, María y José,      │
│                                       │ junto con la fecha del nacimiento de │
│                                       │ Jesús.                               │
│                                       │ 2. 1753 — la segunda cápsula del     │
│                                       │ tiempo, creada por el escocés        │
│                                       │ Matthew Boulton, fue abierta el 26   │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.315 | exact_match: 0.104 | rev_kl: 0.888 | lens: 97.822 | pt_loss: 1.750 | lm_loss: 1.885 | kd_loss: 1.615 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    500/  5000| tot_loss: 2.1852 | rl_loss: 0.5999 | pt_loss: 1.5853 | pg_loss: 0.1929 | reg_loss: 0.4070 | reward: -0.7922 | rev_kl: 0.8022 | stu_lens: 117.0000 | mixed_lens: 83.0000 | lr: 4.9195e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    501/  5000| tot_loss: 1.7321 | rl_loss: 0.3849 | pt_loss: 1.3472 | pg_loss: 0.0194 | reg_loss: 0.3655 | reward: -0.2108 | rev_kl: 0.9032 | stu_lens: 128.0000 | mixed_lens: 127.0000 | lr: 4.9190e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    502/  5000| tot_loss: 2.1558 | rl_loss: 0.4959 | pt_loss: 1.6599 | pg_loss: 0.1690 | reg_loss: 0.3269 | reward: -0.2912 | rev_kl: 1.0308 | stu_lens: 128.0000 | mixed_lens: 90.0000 | lr: 4.9186e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    503/  5000| tot_loss: 2.0779 | rl_loss: 0.4469 | pt_loss: 1.6311 | pg_loss: 0.0125 | reg_loss: 0.4343 | reward: -0.1489 | rev_kl: 0.8302 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9182e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    504/  5000| tot_loss: 3.0362 | rl_loss: 1.1087 | pt_loss: 1.9275 | pg_loss: 0.7497 | reg_loss: 0.3591 | reward: -0.5963 | rev_kl: 0.7317 | stu_lens: 70.0000 | mixed_lens: 53.0000 | lr: 4.9178e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    505/  5000| tot_loss: 2.2643 | rl_loss: 0.3319 | pt_loss: 1.9324 | pg_loss: 0.0223 | reg_loss: 0.3097 | reward: -0.1711 | rev_kl: 0.7251 | stu_lens: 128.0000 | mixed_lens: 125.0000 | lr: 4.9174e-06 | scale: 2048.00 | time: 26.373 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    506/  5000| tot_loss: 2.4583 | rl_loss: 0.7858 | pt_loss: 1.6725 | pg_loss: 0.3487 | reg_loss: 0.4372 | reward: -0.3588 | rev_kl: 0.2987 | stu_lens: 72.5000 | mixed_lens: 84.5000 | lr: 4.9170e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    507/  5000| tot_loss: 2.5573 | rl_loss: 0.9883 | pt_loss: 1.5689 | pg_loss: 0.5768 | reg_loss: 0.4115 | reward: -0.0782 | rev_kl: 0.7699 | stu_lens: 78.0000 | mixed_lens: 69.0000 | lr: 4.9166e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    508/  5000| tot_loss: 2.4659 | rl_loss: 0.4937 | pt_loss: 1.9723 | pg_loss: 0.0244 | reg_loss: 0.4693 | reward: -0.3119 | rev_kl: 1.5954 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9162e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    509/  5000| tot_loss: 2.1302 | rl_loss: 0.4596 | pt_loss: 1.6706 | pg_loss: 0.0108 | reg_loss: 0.4488 | reward: -0.1954 | rev_kl: 1.0771 | stu_lens: 122.5000 | mixed_lens: 128.0000 | lr: 4.9158e-06 | scale: 2048.00 | time: 26.340 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    510/  5000| tot_loss: 2.3739 | rl_loss: 0.5276 | pt_loss: 1.8463 | pg_loss: 0.2130 | reg_loss: 0.3147 | reward: -0.0546 | rev_kl: 0.4471 | stu_lens: 78.0000 | mixed_lens: 92.5000 | lr: 4.9154e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    511/  5000| tot_loss: 2.6161 | rl_loss: 1.1021 | pt_loss: 1.5140 | pg_loss: 0.7509 | reg_loss: 0.3512 | reward: -0.4551 | rev_kl: 0.6478 | stu_lens: 19.0000 | mixed_lens: 26.0000 | lr: 4.9150e-06 | scale: 2048.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    512/  5000| tot_loss: 2.5182 | rl_loss: 0.9180 | pt_loss: 1.6002 | pg_loss: 0.3232 | reg_loss: 0.5948 | reward: -1.7012 | rev_kl: 1.1742 | stu_lens: 65.5000 | mixed_lens: 65.0000 | lr: 4.9145e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    512/  5000| tot_loss: 2.3097 | rl_loss: 0.6047 | pt_loss: 1.7050 | pg_loss: 0.2209 | reg_loss: 0.3838 | reward: -0.4089 | rev_kl: 0.8121 | stu_lens: 100.1406 | mixed_lens: 95.2188 | lr: 4.9145e-06 | scale: 2048.00 | time: 26.324 | step time: 27.598
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    513/  5000| tot_loss: 1.8533 | rl_loss: 0.3550 | pt_loss: 1.4983 | pg_loss: 0.0026 | reg_loss: 0.3524 | reward: -0.1609 | rev_kl: 0.8983 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9141e-06 | scale: 2048.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    514/  5000| tot_loss: 3.0310 | rl_loss: 1.5101 | pt_loss: 1.5209 | pg_loss: 0.3032 | reg_loss: 1.2068 | reward: -0.3584 | rev_kl: 0.8617 | stu_lens: 128.0000 | mixed_lens: 93.5000 | lr: 4.9137e-06 | scale: 2048.00 | time: 26.376 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    515/  5000| tot_loss: 3.8471 | rl_loss: 1.6999 | pt_loss: 2.1471 | pg_loss: 0.7619 | reg_loss: 0.9380 | reward: -0.2956 | rev_kl: 0.7242 | stu_lens: 94.0000 | mixed_lens: 61.5000 | lr: 4.9133e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    516/  5000| tot_loss: 3.3716 | rl_loss: 1.3150 | pt_loss: 2.0566 | pg_loss: 0.4519 | reg_loss: 0.8632 | reward: -0.8488 | rev_kl: 0.4230 | stu_lens: 102.5000 | mixed_lens: 76.0000 | lr: 4.9129e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    517/  5000| tot_loss: 2.4969 | rl_loss: 1.2567 | pt_loss: 1.2401 | pg_loss: 0.0997 | reg_loss: 1.1571 | reward: -0.0517 | rev_kl: 0.7609 | stu_lens: 112.5000 | mixed_lens: 120.0000 | lr: 4.9124e-06 | scale: 2048.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    518/  5000| tot_loss: 3.4235 | rl_loss: 1.0228 | pt_loss: 2.4007 | pg_loss: 0.1996 | reg_loss: 0.8232 | reward: -0.2327 | rev_kl: 0.9709 | stu_lens: 61.5000 | mixed_lens: 86.0000 | lr: 4.9120e-06 | scale: 2048.00 | time: 26.317 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    519/  5000| tot_loss: 2.8553 | rl_loss: 1.0726 | pt_loss: 1.7827 | pg_loss: 0.2495 | reg_loss: 0.8230 | reward: -0.2392 | rev_kl: 1.3277 | stu_lens: 111.5000 | mixed_lens: 94.5000 | lr: 4.9116e-06 | scale: 2048.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    520/  5000| tot_loss: 2.4752 | rl_loss: 0.8336 | pt_loss: 1.6416 | pg_loss: 0.0394 | reg_loss: 0.7942 | reward: -0.1051 | rev_kl: 0.7125 | stu_lens: 94.5000 | mixed_lens: 125.0000 | lr: 4.9112e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    521/  5000| tot_loss: 3.1879 | rl_loss: 1.0972 | pt_loss: 2.0907 | pg_loss: 0.0812 | reg_loss: 1.0160 | reward: -0.1959 | rev_kl: 0.7440 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9108e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    522/  5000| tot_loss: 2.8157 | rl_loss: 1.0452 | pt_loss: 1.7706 | pg_loss: 0.0493 | reg_loss: 0.9958 | reward: -0.2105 | rev_kl: 1.0307 | stu_lens: 113.0000 | mixed_lens: 128.0000 | lr: 4.9103e-06 | scale: 2048.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    523/  5000| tot_loss: 2.8185 | rl_loss: 0.9851 | pt_loss: 1.8334 | pg_loss: 0.2411 | reg_loss: 0.7439 | reward: 0.1513 | rev_kl: 0.7551 | stu_lens: 128.0000 | mixed_lens: 75.0000 | lr: 4.9099e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    524/  5000| tot_loss: 3.5227 | rl_loss: 1.3183 | pt_loss: 2.2044 | pg_loss: 0.0564 | reg_loss: 1.2619 | reward: -0.2091 | rev_kl: 1.0793 | stu_lens: 64.5000 | mixed_lens: 128.0000 | lr: 4.9095e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    525/  5000| tot_loss: 2.2793 | rl_loss: 0.6375 | pt_loss: 1.6418 | pg_loss: 0.1791 | reg_loss: 0.4585 | reward: -0.1347 | rev_kl: 0.4856 | stu_lens: 61.0000 | mixed_lens: 93.0000 | lr: 4.9091e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    526/  5000| tot_loss: 3.6294 | rl_loss: 1.5938 | pt_loss: 2.0356 | pg_loss: 0.4229 | reg_loss: 1.1709 | reward: -0.1606 | rev_kl: 0.5524 | stu_lens: 81.0000 | mixed_lens: 82.0000 | lr: 4.9086e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    527/  5000| tot_loss: 2.9377 | rl_loss: 1.3488 | pt_loss: 1.5889 | pg_loss: 0.3554 | reg_loss: 0.9935 | reward: -0.6688 | rev_kl: 0.5097 | stu_lens: 79.5000 | mixed_lens: 73.5000 | lr: 4.9082e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    528/  5000| tot_loss: 3.3679 | rl_loss: 1.3930 | pt_loss: 1.9749 | pg_loss: 0.2956 | reg_loss: 1.0974 | reward: -0.2899 | rev_kl: 0.8239 | stu_lens: 109.0000 | mixed_lens: 95.5000 | lr: 4.9078e-06 | scale: 2048.00 | time: 26.358 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    528/  5000| tot_loss: 2.9217 | rl_loss: 1.1382 | pt_loss: 1.7835 | pg_loss: 0.1867 | reg_loss: 0.9516 | reward: -0.2372 | rev_kl: 0.8355 | stu_lens: 102.7656 | mixed_lens: 107.4219 | lr: 4.9078e-06 | scale: 2048.00 | time: 26.358 | step time: 27.586
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    529/  5000| tot_loss: 3.3308 | rl_loss: 1.3546 | pt_loss: 1.9763 | pg_loss: 0.0436 | reg_loss: 1.3110 | reward: -0.3371 | rev_kl: 1.3482 | stu_lens: 78.0000 | mixed_lens: 128.0000 | lr: 4.9073e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    530/  5000| tot_loss: 2.3360 | rl_loss: 0.8070 | pt_loss: 1.5290 | pg_loss: 0.1451 | reg_loss: 0.6619 | reward: 0.0025 | rev_kl: 0.6962 | stu_lens: 128.0000 | mixed_lens: 75.0000 | lr: 4.9069e-06 | scale: 2048.00 | time: 26.347 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    531/  5000| tot_loss: 2.7950 | rl_loss: 0.9320 | pt_loss: 1.8630 | pg_loss: 0.2133 | reg_loss: 0.7188 | reward: -0.1381 | rev_kl: 0.7283 | stu_lens: 97.0000 | mixed_lens: 93.0000 | lr: 4.9065e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
[2023-12-18 21:20:52,258] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, but hysteresis is 2. Reducing hysteresis to 1
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    532/  5000| tot_loss: 3.9321 | rl_loss: 0.9338 | pt_loss: 2.9983 | pg_loss: 0.1087 | reg_loss: 0.8251 | reward: -0.2711 | rev_kl: 0.9100 | stu_lens: 128.0000 | mixed_lens: 114.5000 | lr: 4.9065e-06 | scale: 2048.00 | time: 2.856 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    533/  5000| tot_loss: 3.0011 | rl_loss: 0.9948 | pt_loss: 2.0063 | pg_loss: 0.0165 | reg_loss: 0.9783 | reward: -0.5158 | rev_kl: 1.4921 | stu_lens: 109.0000 | mixed_lens: 128.0000 | lr: 4.9060e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    534/  5000| tot_loss: 2.8243 | rl_loss: 1.2000 | pt_loss: 1.6243 | pg_loss: 0.2989 | reg_loss: 0.9012 | reward: -0.5859 | rev_kl: 0.8126 | stu_lens: 39.5000 | mixed_lens: 73.5000 | lr: 4.9056e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    535/  5000| tot_loss: 3.0924 | rl_loss: 1.4020 | pt_loss: 1.6903 | pg_loss: 0.5604 | reg_loss: 0.8416 | reward: -0.7920 | rev_kl: 0.6908 | stu_lens: 128.0000 | mixed_lens: 66.0000 | lr: 4.9052e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    536/  5000| tot_loss: 2.3297 | rl_loss: 0.7530 | pt_loss: 1.5767 | pg_loss: 0.0191 | reg_loss: 0.7339 | reward: -0.1670 | rev_kl: 0.9852 | stu_lens: 90.0000 | mixed_lens: 128.0000 | lr: 4.9047e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    537/  5000| tot_loss: 2.0993 | rl_loss: 0.5160 | pt_loss: 1.5833 | pg_loss: -0.0212 | reg_loss: 0.5373 | reward: -0.1820 | rev_kl: 0.7085 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9043e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    538/  5000| tot_loss: 2.2660 | rl_loss: 0.6207 | pt_loss: 1.6454 | pg_loss: -0.0084 | reg_loss: 0.6291 | reward: -0.1378 | rev_kl: 0.9413 | stu_lens: 113.0000 | mixed_lens: 128.0000 | lr: 4.9038e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    539/  5000| tot_loss: 2.6063 | rl_loss: 0.6673 | pt_loss: 1.9389 | pg_loss: 0.0185 | reg_loss: 0.6488 | reward: -0.0949 | rev_kl: 0.9260 | stu_lens: 46.0000 | mixed_lens: 128.0000 | lr: 4.9034e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    540/  5000| tot_loss: 2.4754 | rl_loss: 0.8734 | pt_loss: 1.6020 | pg_loss: 0.3816 | reg_loss: 0.4919 | reward: -0.2684 | rev_kl: 0.7221 | stu_lens: 94.0000 | mixed_lens: 97.0000 | lr: 4.9030e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    541/  5000| tot_loss: 2.6554 | rl_loss: 0.6732 | pt_loss: 1.9822 | pg_loss: 0.1284 | reg_loss: 0.5448 | reward: -0.2685 | rev_kl: 1.2501 | stu_lens: 119.5000 | mixed_lens: 94.0000 | lr: 4.9025e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    542/  5000| tot_loss: 2.4143 | rl_loss: 0.8609 | pt_loss: 1.5534 | pg_loss: 0.1623 | reg_loss: 0.6986 | reward: -0.1333 | rev_kl: 0.9656 | stu_lens: 128.0000 | mixed_lens: 109.0000 | lr: 4.9021e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    543/  5000| tot_loss: 2.6679 | rl_loss: 0.7868 | pt_loss: 1.8811 | pg_loss: 0.1695 | reg_loss: 0.6173 | reward: -0.1354 | rev_kl: 0.9630 | stu_lens: 128.0000 | mixed_lens: 105.0000 | lr: 4.9016e-06 | scale: 2048.00 | time: 26.344 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    544/  5000| tot_loss: 2.5663 | rl_loss: 0.6270 | pt_loss: 1.9393 | pg_loss: 0.0078 | reg_loss: 0.6191 | reward: -0.1477 | rev_kl: 0.7862 | stu_lens: 120.0000 | mixed_lens: 128.0000 | lr: 4.9012e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    544/  5000| tot_loss: 2.5877 | rl_loss: 0.8112 | pt_loss: 1.7765 | pg_loss: 0.1403 | reg_loss: 0.6709 | reward: -0.2422 | rev_kl: 0.8741 | stu_lens: 99.7812 | mixed_lens: 107.2656 | lr: 4.9012e-06 | scale: 2048.00 | time: 26.276 | step time: 26.122
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    545/  5000| tot_loss: 2.5396 | rl_loss: 0.6157 | pt_loss: 1.9239 | pg_loss: 0.0188 | reg_loss: 0.5969 | reward: -0.0624 | rev_kl: 0.6588 | stu_lens: 112.5000 | mixed_lens: 128.0000 | lr: 4.9007e-06 | scale: 2048.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    546/  5000| tot_loss: 2.4044 | rl_loss: 0.5258 | pt_loss: 1.8786 | pg_loss: -0.0172 | reg_loss: 0.5430 | reward: -0.0843 | rev_kl: 1.1381 | stu_lens: 82.0000 | mixed_lens: 128.0000 | lr: 4.9003e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    547/  5000| tot_loss: 2.6219 | rl_loss: 0.8735 | pt_loss: 1.7485 | pg_loss: 0.4071 | reg_loss: 0.4663 | reward: -0.1760 | rev_kl: 1.2896 | stu_lens: 119.5000 | mixed_lens: 71.5000 | lr: 4.8998e-06 | scale: 2048.00 | time: 26.328 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    548/  5000| tot_loss: 1.7131 | rl_loss: 0.5109 | pt_loss: 1.2022 | pg_loss: 0.0823 | reg_loss: 0.4286 | reward: -0.2216 | rev_kl: 1.1747 | stu_lens: 63.5000 | mixed_lens: 110.5000 | lr: 4.8994e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    549/  5000| tot_loss: 2.2183 | rl_loss: 0.4113 | pt_loss: 1.8071 | pg_loss: -0.0058 | reg_loss: 0.4170 | reward: -0.5469 | rev_kl: 1.2407 | stu_lens: 118.0000 | mixed_lens: 128.0000 | lr: 4.8989e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    550/  5000| tot_loss: 1.8709 | rl_loss: 0.3891 | pt_loss: 1.4819 | pg_loss: 0.0021 | reg_loss: 0.3870 | reward: -0.0693 | rev_kl: 0.5627 | stu_lens: 57.0000 | mixed_lens: 125.0000 | lr: 4.8985e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    551/  5000| tot_loss: 2.7686 | rl_loss: 0.8533 | pt_loss: 1.9152 | pg_loss: 0.1909 | reg_loss: 0.6624 | reward: -0.3310 | rev_kl: 0.6324 | stu_lens: 53.0000 | mixed_lens: 103.0000 | lr: 4.8980e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    552/  5000| tot_loss: 1.8019 | rl_loss: 0.4868 | pt_loss: 1.3151 | pg_loss: -0.0002 | reg_loss: 0.4870 | reward: 0.0274 | rev_kl: 0.7850 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8976e-06 | scale: 2048.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    553/  5000| tot_loss: 2.2449 | rl_loss: 0.5180 | pt_loss: 1.7270 | pg_loss: 0.0148 | reg_loss: 0.5032 | reward: -0.2928 | rev_kl: 0.8501 | stu_lens: 127.0000 | mixed_lens: 128.0000 | lr: 4.8971e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    554/  5000| tot_loss: 2.3636 | rl_loss: 0.3220 | pt_loss: 2.0416 | pg_loss: -0.0324 | reg_loss: 0.3543 | reward: -0.0551 | rev_kl: 0.6481 | stu_lens: 101.5000 | mixed_lens: 128.0000 | lr: 4.8967e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    555/  5000| tot_loss: 2.4331 | rl_loss: 0.7057 | pt_loss: 1.7274 | pg_loss: 0.2699 | reg_loss: 0.4358 | reward: -0.1582 | rev_kl: 0.7576 | stu_lens: 97.0000 | mixed_lens: 85.0000 | lr: 4.8962e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    556/  5000| tot_loss: 2.2963 | rl_loss: 0.8407 | pt_loss: 1.4556 | pg_loss: 0.2132 | reg_loss: 0.6275 | reward: -0.1158 | rev_kl: 0.9802 | stu_lens: 78.0000 | mixed_lens: 91.5000 | lr: 4.8958e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    557/  5000| tot_loss: 2.5767 | rl_loss: 0.6130 | pt_loss: 1.9638 | pg_loss: 0.0691 | reg_loss: 0.5439 | reward: 0.0330 | rev_kl: 1.1946 | stu_lens: 88.0000 | mixed_lens: 118.0000 | lr: 4.8953e-06 | scale: 2048.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    558/  5000| tot_loss: 2.7513 | rl_loss: 0.8591 | pt_loss: 1.8922 | pg_loss: 0.1814 | reg_loss: 0.6777 | reward: -0.4141 | rev_kl: 1.0827 | stu_lens: 88.0000 | mixed_lens: 86.0000 | lr: 4.8948e-06 | scale: 2048.00 | time: 26.315 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    559/  5000| tot_loss: 2.0627 | rl_loss: 0.4935 | pt_loss: 1.5692 | pg_loss: 0.0164 | reg_loss: 0.4771 | reward: -0.0624 | rev_kl: 0.6588 | stu_lens: 112.5000 | mixed_lens: 128.0000 | lr: 4.8944e-06 | scale: 2048.00 | time: 26.355 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    560/  5000| tot_loss: 2.3928 | rl_loss: 1.0626 | pt_loss: 1.3302 | pg_loss: 0.5668 | reg_loss: 0.4958 | reward: -0.2967 | rev_kl: 0.4435 | stu_lens: 84.0000 | mixed_lens: 64.5000 | lr: 4.8939e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    560/  5000| tot_loss: 2.3038 | rl_loss: 0.6083 | pt_loss: 1.6954 | pg_loss: 0.1185 | reg_loss: 0.4898 | reward: -0.2293 | rev_kl: 0.8531 | stu_lens: 102.4531 | mixed_lens: 109.9531 | lr: 4.8939e-06 | scale: 2048.00 | time: 26.342 | step time: 27.596
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    561/  5000| tot_loss: 2.1281 | rl_loss: 0.6078 | pt_loss: 1.5204 | pg_loss: 0.0726 | reg_loss: 0.5351 | reward: -0.2534 | rev_kl: 0.7514 | stu_lens: 128.0000 | mixed_lens: 114.0000 | lr: 4.8935e-06 | scale: 2048.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    562/  5000| tot_loss: 1.7604 | rl_loss: 0.3400 | pt_loss: 1.4203 | pg_loss: -0.0129 | reg_loss: 0.3530 | reward: -0.2069 | rev_kl: 0.8539 | stu_lens: 101.5000 | mixed_lens: 128.0000 | lr: 4.8930e-06 | scale: 2048.00 | time: 26.329 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    563/  5000| tot_loss: 2.5693 | rl_loss: 0.7544 | pt_loss: 1.8149 | pg_loss: 0.3384 | reg_loss: 0.4159 | reward: -0.2085 | rev_kl: 0.8677 | stu_lens: 91.5000 | mixed_lens: 93.0000 | lr: 4.8925e-06 | scale: 2048.00 | time: 26.327 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    564/  5000| tot_loss: 1.8976 | rl_loss: 0.4265 | pt_loss: 1.4711 | pg_loss: -0.0034 | reg_loss: 0.4299 | reward: -0.3094 | rev_kl: 0.7797 | stu_lens: 102.5000 | mixed_lens: 128.0000 | lr: 4.8921e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    565/  5000| tot_loss: 2.0061 | rl_loss: 0.3961 | pt_loss: 1.6100 | pg_loss: 0.0522 | reg_loss: 0.3439 | reward: -0.0943 | rev_kl: 1.0252 | stu_lens: 94.5000 | mixed_lens: 115.0000 | lr: 4.8916e-06 | scale: 2048.00 | time: 26.323 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    566/  5000| tot_loss: 2.3661 | rl_loss: 0.7397 | pt_loss: 1.6264 | pg_loss: 0.3504 | reg_loss: 0.3892 | reward: -0.1430 | rev_kl: 0.6531 | stu_lens: 78.5000 | mixed_lens: 80.0000 | lr: 4.8911e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    567/  5000| tot_loss: 2.4852 | rl_loss: 0.5752 | pt_loss: 1.9100 | pg_loss: 0.2019 | reg_loss: 0.3733 | reward: -0.3888 | rev_kl: 1.0524 | stu_lens: 88.0000 | mixed_lens: 86.0000 | lr: 4.8907e-06 | scale: 2048.00 | time: 26.314 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    568/  5000| tot_loss: 2.3566 | rl_loss: 0.3670 | pt_loss: 1.9896 | pg_loss: 0.0047 | reg_loss: 0.3624 | reward: -0.2028 | rev_kl: 1.0908 | stu_lens: 93.5000 | mixed_lens: 128.0000 | lr: 4.8902e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    569/  5000| tot_loss: 2.6628 | rl_loss: 0.4996 | pt_loss: 2.1632 | pg_loss: 0.1582 | reg_loss: 0.3414 | reward: -0.4042 | rev_kl: 0.8232 | stu_lens: 128.0000 | mixed_lens: 93.0000 | lr: 4.8897e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    570/  5000| tot_loss: 1.9828 | rl_loss: 0.5124 | pt_loss: 1.4704 | pg_loss: 0.0467 | reg_loss: 0.4657 | reward: -0.3067 | rev_kl: 0.6761 | stu_lens: 128.0000 | mixed_lens: 114.5000 | lr: 4.8892e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    571/  5000| tot_loss: 1.6200 | rl_loss: 0.5508 | pt_loss: 1.0692 | pg_loss: 0.1923 | reg_loss: 0.3585 | reward: -0.2468 | rev_kl: 1.2387 | stu_lens: 119.5000 | mixed_lens: 94.5000 | lr: 4.8888e-06 | scale: 2048.00 | time: 26.366 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    572/  5000| tot_loss: 1.8523 | rl_loss: 0.3300 | pt_loss: 1.5222 | pg_loss: 0.0088 | reg_loss: 0.3212 | reward: -0.3137 | rev_kl: 0.9330 | stu_lens: 78.0000 | mixed_lens: 125.5000 | lr: 4.8883e-06 | scale: 2048.00 | time: 26.366 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    573/  5000| tot_loss: 2.2126 | rl_loss: 0.5733 | pt_loss: 1.6393 | pg_loss: 0.2091 | reg_loss: 0.3641 | reward: -0.0123 | rev_kl: 0.4572 | stu_lens: 51.0000 | mixed_lens: 91.5000 | lr: 4.8878e-06 | scale: 2048.00 | time: 26.384 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    574/  5000| tot_loss: 2.3213 | rl_loss: 0.4204 | pt_loss: 1.9009 | pg_loss: -0.0159 | reg_loss: 0.4362 | reward: -0.2026 | rev_kl: 1.0707 | stu_lens: 93.5000 | mixed_lens: 128.0000 | lr: 4.8874e-06 | scale: 2048.00 | time: 26.347 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    575/  5000| tot_loss: 2.2290 | rl_loss: 0.4129 | pt_loss: 1.8161 | pg_loss: 0.0045 | reg_loss: 0.4084 | reward: -0.2412 | rev_kl: 0.6955 | stu_lens: 87.0000 | mixed_lens: 128.0000 | lr: 4.8869e-06 | scale: 2048.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    576/  5000| tot_loss: 2.2838 | rl_loss: 0.3895 | pt_loss: 1.8943 | pg_loss: 0.0201 | reg_loss: 0.3694 | reward: 0.0207 | rev_kl: 0.7622 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8864e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    576/  5000| tot_loss: 2.2357 | rl_loss: 0.5199 | pt_loss: 1.7159 | pg_loss: 0.1029 | reg_loss: 0.4170 | reward: -0.2511 | rev_kl: 0.8656 | stu_lens: 104.0781 | mixed_lens: 107.8750 | lr: 4.8864e-06 | scale: 2048.00 | time: 26.316 | step time: 27.615
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    577/  5000| tot_loss: 2.3232 | rl_loss: 0.4301 | pt_loss: 1.8931 | pg_loss: 0.0257 | reg_loss: 0.4044 | reward: 0.0580 | rev_kl: 0.7321 | stu_lens: 50.5000 | mixed_lens: 128.0000 | lr: 4.8859e-06 | scale: 2048.00 | time: 26.338 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    578/  5000| tot_loss: 2.9149 | rl_loss: 1.0889 | pt_loss: 1.8259 | pg_loss: 0.0415 | reg_loss: 1.0474 | reward: -0.2501 | rev_kl: 0.6978 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8854e-06 | scale: 2048.00 | time: 26.350 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    579/  5000| tot_loss: 2.9871 | rl_loss: 1.2939 | pt_loss: 1.6932 | pg_loss: 0.0684 | reg_loss: 1.2255 | reward: -0.1215 | rev_kl: 0.8586 | stu_lens: 123.0000 | mixed_lens: 128.0000 | lr: 4.8850e-06 | scale: 2048.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    580/  5000| tot_loss: 3.3555 | rl_loss: 1.2726 | pt_loss: 2.0829 | pg_loss: 0.0841 | reg_loss: 1.1886 | reward: -0.1759 | rev_kl: 0.7140 | stu_lens: 83.5000 | mixed_lens: 120.5000 | lr: 4.8845e-06 | scale: 2048.00 | time: 26.357 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    581/  5000| tot_loss: 3.3360 | rl_loss: 1.4818 | pt_loss: 1.8542 | pg_loss: 0.0690 | reg_loss: 1.4128 | reward: -0.2929 | rev_kl: 0.7472 | stu_lens: 95.5000 | mixed_lens: 128.0000 | lr: 4.8840e-06 | scale: 2048.00 | time: 26.340 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    582/  5000| tot_loss: 2.4452 | rl_loss: 0.9637 | pt_loss: 1.4815 | pg_loss: 0.1621 | reg_loss: 0.8016 | reward: -0.1720 | rev_kl: 1.5001 | stu_lens: 39.0000 | mixed_lens: 83.0000 | lr: 4.8835e-06 | scale: 2048.00 | time: 26.354 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    583/  5000| tot_loss: 3.2199 | rl_loss: 1.4668 | pt_loss: 1.7531 | pg_loss: 0.4180 | reg_loss: 1.0488 | reward: -0.6021 | rev_kl: 0.8641 | stu_lens: 109.0000 | mixed_lens: 71.0000 | lr: 4.8830e-06 | scale: 2048.00 | time: 26.327 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    584/  5000| tot_loss: 2.6954 | rl_loss: 0.8742 | pt_loss: 1.8211 | pg_loss: 0.0516 | reg_loss: 0.8226 | reward: -0.2401 | rev_kl: 0.8100 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8825e-06 | scale: 2048.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    585/  5000| tot_loss: 2.7286 | rl_loss: 0.9326 | pt_loss: 1.7960 | pg_loss: 0.1283 | reg_loss: 0.8044 | reward: -0.3830 | rev_kl: 1.0237 | stu_lens: 126.0000 | mixed_lens: 106.0000 | lr: 4.8821e-06 | scale: 2048.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    586/  5000| tot_loss: 2.9246 | rl_loss: 1.0186 | pt_loss: 1.9061 | pg_loss: 0.0759 | reg_loss: 0.9427 | reward: -0.0827 | rev_kl: 0.8156 | stu_lens: 97.5000 | mixed_lens: 128.0000 | lr: 4.8816e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    587/  5000| tot_loss: 3.5718 | rl_loss: 1.7888 | pt_loss: 1.7830 | pg_loss: 0.4313 | reg_loss: 1.3574 | reward: -0.2333 | rev_kl: 1.0782 | stu_lens: 103.5000 | mixed_lens: 79.5000 | lr: 4.8811e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    588/  5000| tot_loss: 2.6097 | rl_loss: 0.9484 | pt_loss: 1.6612 | pg_loss: 0.0513 | reg_loss: 0.8971 | reward: -0.1722 | rev_kl: 0.6082 | stu_lens: 91.5000 | mixed_lens: 128.0000 | lr: 4.8806e-06 | scale: 2048.00 | time: 26.336 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    589/  5000| tot_loss: 2.8506 | rl_loss: 1.3401 | pt_loss: 1.5105 | pg_loss: 0.0555 | reg_loss: 1.2846 | reward: -0.1797 | rev_kl: 0.5012 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8801e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    590/  5000| tot_loss: 3.0187 | rl_loss: 1.2005 | pt_loss: 1.8183 | pg_loss: 0.3311 | reg_loss: 0.8693 | reward: -0.2727 | rev_kl: 0.7266 | stu_lens: 77.0000 | mixed_lens: 70.0000 | lr: 4.8796e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    591/  5000| tot_loss: 2.9578 | rl_loss: 1.4248 | pt_loss: 1.5330 | pg_loss: 0.1381 | reg_loss: 1.2866 | reward: -0.2475 | rev_kl: 0.9032 | stu_lens: 128.0000 | mixed_lens: 121.0000 | lr: 4.8791e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    592/  5000| tot_loss: 2.3485 | rl_loss: 1.0619 | pt_loss: 1.2866 | pg_loss: 0.0746 | reg_loss: 0.9873 | reward: -0.1620 | rev_kl: 0.3456 | stu_lens: 75.0000 | mixed_lens: 128.0000 | lr: 4.8786e-06 | scale: 2048.00 | time: 26.363 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    592/  5000| tot_loss: 2.9670 | rl_loss: 1.1732 | pt_loss: 1.7938 | pg_loss: 0.1755 | reg_loss: 0.9977 | reward: -0.3973 | rev_kl: 0.9727 | stu_lens: 103.0469 | mixed_lens: 105.6094 | lr: 4.8786e-06 | scale: 2048.00 | time: 26.363 | step time: 27.611
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    593/  5000| tot_loss: 2.5487 | rl_loss: 0.9174 | pt_loss: 1.6313 | pg_loss: 0.1539 | reg_loss: 0.7635 | reward: -0.4569 | rev_kl: 0.7568 | stu_lens: 113.0000 | mixed_lens: 78.0000 | lr: 4.8781e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    594/  5000| tot_loss: 2.3923 | rl_loss: 0.9767 | pt_loss: 1.4156 | pg_loss: 0.1585 | reg_loss: 0.8182 | reward: -0.3100 | rev_kl: 0.8828 | stu_lens: 123.0000 | mixed_lens: 107.0000 | lr: 4.8776e-06 | scale: 2048.00 | time: 26.317 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    595/  5000| tot_loss: 2.2844 | rl_loss: 0.6616 | pt_loss: 1.6228 | pg_loss: 0.1056 | reg_loss: 0.5560 | reward: -0.3338 | rev_kl: 0.9939 | stu_lens: 128.0000 | mixed_lens: 98.5000 | lr: 4.8771e-06 | scale: 2048.00 | time: 26.348 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    596/  5000| tot_loss: 1.9613 | rl_loss: 0.6790 | pt_loss: 1.2823 | pg_loss: 0.0078 | reg_loss: 0.6712 | reward: -0.2354 | rev_kl: 0.4802 | stu_lens: 95.5000 | mixed_lens: 128.0000 | lr: 4.8766e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    597/  5000| tot_loss: 2.1923 | rl_loss: 0.5242 | pt_loss: 1.6681 | pg_loss: -0.0152 | reg_loss: 0.5394 | reward: -0.0072 | rev_kl: 0.6010 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8762e-06 | scale: 2048.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    598/  5000| tot_loss: 2.7114 | rl_loss: 0.7418 | pt_loss: 1.9696 | pg_loss: 0.0000 | reg_loss: 0.7417 | reward: -0.1792 | rev_kl: 0.6812 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8757e-06 | scale: 2048.00 | time: 26.349 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    599/  5000| tot_loss: 2.4092 | rl_loss: 0.6461 | pt_loss: 1.7631 | pg_loss: -0.0058 | reg_loss: 0.6519 | reward: -0.2254 | rev_kl: 1.1288 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8752e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
                                 Evaluation #6                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ En física de partículas, existen     │
│                                       │ cuatro tipos de cuarks: el           │
│                                       │ cuarmiono, el top, el bottom y el    │
│                                       │ strange.                             │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es un nuevo tipo de           │
│                                       │ agrupamiento social, un nuevo medio  │
│                                       │ de hermandad, un nuevo modelo de     │
│                                       │ sociedad.                            │
│                                       │                                      │
│                                       │ El IMC está basado en la idea de que │
│                                       │ la medición de la felicidad es una   │
│                                       │ actividad de la comunidad, que la    │
│                                       │ felicidad es un bien común, y que la │
│                                       │ relación entre la felicidad y la     │
│                                       │ necesidad es una relación de         │
│                                       │ dependencia entre los miembros de la │
│                                       │ comunidad.                           │
│                                       │                                      │
│                                       │ El IMC es una organización que busca │
│                                       │ mejorar la calidad de vida de sus    │
│                                       │ miembros, algo que podemos lograr    │
│                                       │ junt                                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ 1. Cápsula del tiempo de Jules       │
│                                       │ Verne: 1867, contenido: 200.000      │
│                                       │ dólares, fecha de apertura: 1967     │
│                                       │ 2. Cápsula del tiempo de Willy Ley:  │
│                                       │ 1939, contenido: algunas             │
│                                       │ fotografías, fecha de apertura: 1973 │
│                                       │ 3. Cápsula del tiempo del Ministerio │
│                                       │ de Cultura de Italia: 1940,          │
│                                       │ contenido: pinturas, esculturas,     │
│                                       │ libros, algunos datos sobre la       │
│                                       │ historia de Italia,                  │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.297 | exact_match: 0.104 | rev_kl: 0.923 | lens: 104.600 | pt_loss: 1.752 | lm_loss: 1.889 | kd_loss: 1.615 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    600/  5000| tot_loss: 2.2500 | rl_loss: 0.5667 | pt_loss: 1.6833 | pg_loss: 0.0330 | reg_loss: 0.5336 | reward: -0.2413 | rev_kl: 0.6287 | stu_lens: 83.5000 | mixed_lens: 120.5000 | lr: 4.8747e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    601/  5000| tot_loss: 2.5465 | rl_loss: 0.7215 | pt_loss: 1.8250 | pg_loss: 0.0585 | reg_loss: 0.6630 | reward: -0.2951 | rev_kl: 1.1256 | stu_lens: 103.5000 | mixed_lens: 117.5000 | lr: 4.8742e-06 | scale: 2048.00 | time: 26.387 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    602/  5000| tot_loss: 2.3307 | rl_loss: 0.4076 | pt_loss: 1.9231 | pg_loss: 0.0037 | reg_loss: 0.4039 | reward: -0.0076 | rev_kl: 1.4464 | stu_lens: 79.5000 | mixed_lens: 128.0000 | lr: 4.8736e-06 | scale: 2048.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    603/  5000| tot_loss: 3.1276 | rl_loss: 1.0186 | pt_loss: 2.1090 | pg_loss: 0.2103 | reg_loss: 0.8083 | reward: -0.2728 | rev_kl: 0.8536 | stu_lens: 102.0000 | mixed_lens: 52.5000 | lr: 4.8731e-06 | scale: 2048.00 | time: 26.338 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    604/  5000| tot_loss: 2.4602 | rl_loss: 0.6267 | pt_loss: 1.8335 | pg_loss: -0.0062 | reg_loss: 0.6329 | reward: -0.1796 | rev_kl: 0.9439 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8726e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    605/  5000| tot_loss: 2.5788 | rl_loss: 0.5270 | pt_loss: 2.0518 | pg_loss: 0.0797 | reg_loss: 0.4473 | reward: -0.2135 | rev_kl: 0.7012 | stu_lens: 87.5000 | mixed_lens: 83.0000 | lr: 4.8721e-06 | scale: 2048.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    606/  5000| tot_loss: 2.7357 | rl_loss: 0.6624 | pt_loss: 2.0733 | pg_loss: 0.1143 | reg_loss: 0.5481 | reward: -0.3022 | rev_kl: 1.2058 | stu_lens: 75.5000 | mixed_lens: 76.5000 | lr: 4.8716e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    607/  5000| tot_loss: 3.3231 | rl_loss: 1.4059 | pt_loss: 1.9172 | pg_loss: 0.6620 | reg_loss: 0.7439 | reward: -1.2665 | rev_kl: 1.4874 | stu_lens: 68.0000 | mixed_lens: 69.5000 | lr: 4.8711e-06 | scale: 2048.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    608/  5000| tot_loss: 2.5656 | rl_loss: 0.9552 | pt_loss: 1.6104 | pg_loss: 0.1484 | reg_loss: 0.8068 | reward: -0.3269 | rev_kl: 1.2881 | stu_lens: 92.5000 | mixed_lens: 75.0000 | lr: 4.8706e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    608/  5000| tot_loss: 2.5191 | rl_loss: 0.7838 | pt_loss: 1.7353 | pg_loss: 0.1156 | reg_loss: 0.6683 | reward: -0.4169 | rev_kl: 0.9404 | stu_lens: 105.4531 | mixed_lens: 104.1719 | lr: 4.8706e-06 | scale: 2048.00 | time: 26.254 | step time: 27.608
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    609/  5000| tot_loss: 2.2755 | rl_loss: 0.8620 | pt_loss: 1.4136 | pg_loss: 0.1505 | reg_loss: 0.7114 | reward: -0.1503 | rev_kl: 1.2469 | stu_lens: 108.5000 | mixed_lens: 106.5000 | lr: 4.8701e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    610/  5000| tot_loss: 2.3134 | rl_loss: 0.5443 | pt_loss: 1.7691 | pg_loss: 0.0243 | reg_loss: 0.5200 | reward: -0.3238 | rev_kl: 0.6417 | stu_lens: 128.0000 | mixed_lens: 117.0000 | lr: 4.8696e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    611/  5000| tot_loss: 2.6490 | rl_loss: 0.7270 | pt_loss: 1.9220 | pg_loss: 0.1313 | reg_loss: 0.5957 | reward: -5.0982 | rev_kl: 3.7698 | stu_lens: 56.0000 | mixed_lens: 66.0000 | lr: 4.8691e-06 | scale: 2048.00 | time: 26.341 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    612/  5000| tot_loss: 2.0441 | rl_loss: 0.3902 | pt_loss: 1.6539 | pg_loss: 0.0723 | reg_loss: 0.3179 | reward: -0.7057 | rev_kl: 0.8545 | stu_lens: 68.5000 | mixed_lens: 26.0000 | lr: 4.8686e-06 | scale: 2048.00 | time: 26.347 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    613/  5000| tot_loss: 1.7509 | rl_loss: 0.4626 | pt_loss: 1.2883 | pg_loss: 0.0229 | reg_loss: 0.4397 | reward: -0.4061 | rev_kl: 0.8040 | stu_lens: 75.5000 | mixed_lens: 69.5000 | lr: 4.8681e-06 | scale: 2048.00 | time: 26.338 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    614/  5000| tot_loss: 2.3959 | rl_loss: 0.6007 | pt_loss: 1.7951 | pg_loss: 0.1882 | reg_loss: 0.4125 | reward: -0.1230 | rev_kl: 0.2718 | stu_lens: 73.0000 | mixed_lens: 102.5000 | lr: 4.8675e-06 | scale: 2048.00 | time: 26.315 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    615/  5000| tot_loss: 2.2571 | rl_loss: 0.4525 | pt_loss: 1.8046 | pg_loss: 0.0068 | reg_loss: 0.4457 | reward: -0.1358 | rev_kl: 0.5979 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8670e-06 | scale: 2048.00 | time: 26.347 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    616/  5000| tot_loss: 2.2843 | rl_loss: 0.5562 | pt_loss: 1.7281 | pg_loss: 0.1319 | reg_loss: 0.4243 | reward: -0.1507 | rev_kl: 0.9964 | stu_lens: 128.0000 | mixed_lens: 90.0000 | lr: 4.8665e-06 | scale: 2048.00 | time: 26.322 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    617/  5000| tot_loss: 2.4777 | rl_loss: 0.7026 | pt_loss: 1.7751 | pg_loss: 0.0104 | reg_loss: 0.6922 | reward: -0.1385 | rev_kl: 0.7309 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8660e-06 | scale: 2048.00 | time: 26.344 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    618/  5000| tot_loss: 2.4892 | rl_loss: 0.3995 | pt_loss: 2.0897 | pg_loss: 0.0001 | reg_loss: 0.3994 | reward: -0.2091 | rev_kl: 0.6602 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8655e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    619/  5000| tot_loss: 2.2610 | rl_loss: 0.4095 | pt_loss: 1.8515 | pg_loss: -0.0068 | reg_loss: 0.4163 | reward: -0.2364 | rev_kl: 0.9306 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8650e-06 | scale: 2048.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    620/  5000| tot_loss: 2.1410 | rl_loss: 0.4563 | pt_loss: 1.6847 | pg_loss: 0.0327 | reg_loss: 0.4235 | reward: -0.1049 | rev_kl: 0.7104 | stu_lens: 83.5000 | mixed_lens: 120.5000 | lr: 4.8644e-06 | scale: 2048.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    621/  5000| tot_loss: 2.1907 | rl_loss: 0.5364 | pt_loss: 1.6543 | pg_loss: -0.0093 | reg_loss: 0.5457 | reward: -0.1388 | rev_kl: 0.8516 | stu_lens: 91.5000 | mixed_lens: 128.0000 | lr: 4.8639e-06 | scale: 2048.00 | time: 26.336 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    622/  5000| tot_loss: 2.5057 | rl_loss: 0.7330 | pt_loss: 1.7726 | pg_loss: 0.1711 | reg_loss: 0.5620 | reward: -0.2130 | rev_kl: 1.1834 | stu_lens: 101.5000 | mixed_lens: 95.5000 | lr: 4.8634e-06 | scale: 2048.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    623/  5000| tot_loss: 2.1921 | rl_loss: 0.3811 | pt_loss: 1.8111 | pg_loss: 0.0066 | reg_loss: 0.3745 | reward: -0.1316 | rev_kl: 1.2116 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8629e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    624/  5000| tot_loss: 2.4189 | rl_loss: 0.6315 | pt_loss: 1.7874 | pg_loss: 0.0192 | reg_loss: 0.6123 | reward: -0.1904 | rev_kl: 0.6712 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8623e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    624/  5000| tot_loss: 2.3516 | rl_loss: 0.5706 | pt_loss: 1.7810 | pg_loss: 0.0879 | reg_loss: 0.4827 | reward: -0.4124 | rev_kl: 0.9920 | stu_lens: 106.9219 | mixed_lens: 106.0469 | lr: 4.8623e-06 | scale: 2048.00 | time: 26.298 | step time: 27.610
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    625/  5000| tot_loss: 2.6148 | rl_loss: 0.7422 | pt_loss: 1.8725 | pg_loss: 0.3121 | reg_loss: 0.4301 | reward: -0.2888 | rev_kl: 1.1797 | stu_lens: 92.5000 | mixed_lens: 75.0000 | lr: 4.8618e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    626/  5000| tot_loss: 2.2876 | rl_loss: 0.5672 | pt_loss: 1.7204 | pg_loss: 0.1096 | reg_loss: 0.4576 | reward: -0.3292 | rev_kl: 0.4172 | stu_lens: 75.0000 | mixed_lens: 117.0000 | lr: 4.8613e-06 | scale: 2048.00 | time: 26.315 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    627/  5000| tot_loss: 2.5047 | rl_loss: 0.8809 | pt_loss: 1.6237 | pg_loss: 0.4496 | reg_loss: 0.4314 | reward: -1.3373 | rev_kl: 1.2549 | stu_lens: 35.5000 | mixed_lens: 69.5000 | lr: 4.8608e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    628/  5000| tot_loss: 1.9352 | rl_loss: 0.3546 | pt_loss: 1.5806 | pg_loss: -0.0015 | reg_loss: 0.3561 | reward: -0.2190 | rev_kl: 0.7051 | stu_lens: 125.0000 | mixed_lens: 127.0000 | lr: 4.8602e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    629/  5000| tot_loss: 2.2969 | rl_loss: 0.6532 | pt_loss: 1.6438 | pg_loss: 0.1230 | reg_loss: 0.5302 | reward: -0.2390 | rev_kl: 1.1708 | stu_lens: 103.5000 | mixed_lens: 117.5000 | lr: 4.8597e-06 | scale: 2048.00 | time: 26.379 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    630/  5000| tot_loss: 1.8173 | rl_loss: 0.4293 | pt_loss: 1.3881 | pg_loss: -0.0093 | reg_loss: 0.4386 | reward: -0.1594 | rev_kl: 0.8155 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8592e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    631/  5000| tot_loss: 2.3176 | rl_loss: 1.0714 | pt_loss: 1.2463 | pg_loss: 0.7384 | reg_loss: 0.3330 | reward: -0.5183 | rev_kl: 0.8096 | stu_lens: 113.0000 | mixed_lens: 57.0000 | lr: 4.8586e-06 | scale: 2048.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    632/  5000| tot_loss: 2.0417 | rl_loss: 0.3058 | pt_loss: 1.7359 | pg_loss: 0.0226 | reg_loss: 0.2832 | reward: -0.0490 | rev_kl: 0.6475 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8581e-06 | scale: 2048.00 | time: 26.341 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    633/  5000| tot_loss: 1.8543 | rl_loss: 0.3942 | pt_loss: 1.4601 | pg_loss: 0.0498 | reg_loss: 0.3444 | reward: -0.2241 | rev_kl: 0.7105 | stu_lens: 126.0000 | mixed_lens: 106.0000 | lr: 4.8576e-06 | scale: 2048.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    634/  5000| tot_loss: 2.3392 | rl_loss: 0.6071 | pt_loss: 1.7321 | pg_loss: 0.0182 | reg_loss: 0.5889 | reward: -0.2206 | rev_kl: 0.6269 | stu_lens: 118.5000 | mixed_lens: 128.0000 | lr: 4.8570e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    635/  5000| tot_loss: 2.3431 | rl_loss: 0.5478 | pt_loss: 1.7954 | pg_loss: 0.0472 | reg_loss: 0.5006 | reward: -0.2097 | rev_kl: 0.7993 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8565e-06 | scale: 2048.00 | time: 26.314 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    636/  5000| tot_loss: 1.8444 | rl_loss: 0.4103 | pt_loss: 1.4341 | pg_loss: 0.1598 | reg_loss: 0.2504 | reward: -5.0265 | rev_kl: 4.6130 | stu_lens: 17.0000 | mixed_lens: 66.0000 | lr: 4.8560e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    637/  5000| tot_loss: 2.8835 | rl_loss: 0.8973 | pt_loss: 1.9862 | pg_loss: 0.3420 | reg_loss: 0.5553 | reward: -0.2798 | rev_kl: 1.2812 | stu_lens: 92.5000 | mixed_lens: 75.0000 | lr: 4.8554e-06 | scale: 2048.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    638/  5000| tot_loss: 2.5163 | rl_loss: 0.6716 | pt_loss: 1.8447 | pg_loss: 0.3790 | reg_loss: 0.2926 | reward: -0.6122 | rev_kl: 0.8043 | stu_lens: 109.0000 | mixed_lens: 71.0000 | lr: 4.8549e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    639/  5000| tot_loss: 2.1926 | rl_loss: 0.4091 | pt_loss: 1.7835 | pg_loss: -0.0129 | reg_loss: 0.4219 | reward: -0.1979 | rev_kl: 0.9186 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8544e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    640/  5000| tot_loss: 2.1798 | rl_loss: 0.3018 | pt_loss: 1.8780 | pg_loss: 0.0056 | reg_loss: 0.2962 | reward: -0.0970 | rev_kl: 0.8787 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8538e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    640/  5000| tot_loss: 2.2493 | rl_loss: 0.5310 | pt_loss: 1.7182 | pg_loss: 0.1265 | reg_loss: 0.4045 | reward: -0.4127 | rev_kl: 0.9787 | stu_lens: 103.0938 | mixed_lens: 105.5938 | lr: 4.8538e-06 | scale: 2048.00 | time: 26.266 | step time: 27.599
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    641/  5000| tot_loss: 2.0433 | rl_loss: 0.2930 | pt_loss: 1.7502 | pg_loss: 0.0585 | reg_loss: 0.2345 | reward: -0.2678 | rev_kl: 0.9267 | stu_lens: 128.0000 | mixed_lens: 98.5000 | lr: 4.8533e-06 | scale: 2048.00 | time: 26.341 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    642/  5000| tot_loss: 2.9895 | rl_loss: 1.3684 | pt_loss: 1.6211 | pg_loss: 0.1698 | reg_loss: 1.1985 | reward: -0.1788 | rev_kl: 1.0523 | stu_lens: 112.0000 | mixed_lens: 113.0000 | lr: 4.8527e-06 | scale: 2048.00 | time: 26.381 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    643/  5000| tot_loss: 2.3906 | rl_loss: 0.9896 | pt_loss: 1.4010 | pg_loss: 0.0529 | reg_loss: 0.9366 | reward: -0.1490 | rev_kl: 1.5028 | stu_lens: 114.5000 | mixed_lens: 128.0000 | lr: 4.8522e-06 | scale: 2048.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    644/  5000| tot_loss: 3.1018 | rl_loss: 1.2260 | pt_loss: 1.8758 | pg_loss: 0.0642 | reg_loss: 1.1618 | reward: -0.2012 | rev_kl: 1.1190 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8517e-06 | scale: 2048.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    645/  5000| tot_loss: 2.5554 | rl_loss: 0.9373 | pt_loss: 1.6182 | pg_loss: 0.2556 | reg_loss: 0.6817 | reward: -0.1607 | rev_kl: 0.6932 | stu_lens: 77.0000 | mixed_lens: 92.5000 | lr: 4.8511e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    646/  5000| tot_loss: 2.9985 | rl_loss: 1.3585 | pt_loss: 1.6400 | pg_loss: 0.1533 | reg_loss: 1.2052 | reward: -0.1670 | rev_kl: 0.5502 | stu_lens: 128.0000 | mixed_lens: 114.5000 | lr: 4.8506e-06 | scale: 2048.00 | time: 26.314 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    647/  5000| tot_loss: 3.3383 | rl_loss: 1.8175 | pt_loss: 1.5208 | pg_loss: 0.8896 | reg_loss: 0.9279 | reward: -0.4780 | rev_kl: 0.7181 | stu_lens: 38.0000 | mixed_lens: 57.0000 | lr: 4.8500e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    648/  5000| tot_loss: 2.2032 | rl_loss: 0.9164 | pt_loss: 1.2868 | pg_loss: 0.0484 | reg_loss: 0.8680 | reward: -0.2082 | rev_kl: 0.9115 | stu_lens: 108.0000 | mixed_lens: 128.0000 | lr: 4.8495e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    649/  5000| tot_loss: 3.2928 | rl_loss: 1.2997 | pt_loss: 1.9931 | pg_loss: 0.0532 | reg_loss: 1.2465 | reward: -0.2569 | rev_kl: 1.1877 | stu_lens: 99.5000 | mixed_lens: 128.0000 | lr: 4.8489e-06 | scale: 2048.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    650/  5000| tot_loss: 3.2589 | rl_loss: 1.3644 | pt_loss: 1.8944 | pg_loss: 0.4872 | reg_loss: 0.8773 | reward: -0.4170 | rev_kl: 0.6320 | stu_lens: 72.5000 | mixed_lens: 68.0000 | lr: 4.8484e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    651/  5000| tot_loss: 2.7104 | rl_loss: 0.9930 | pt_loss: 1.7174 | pg_loss: 0.3153 | reg_loss: 0.6777 | reward: -0.4632 | rev_kl: 0.9770 | stu_lens: 69.5000 | mixed_lens: 81.5000 | lr: 4.8478e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    652/  5000| tot_loss: 2.3587 | rl_loss: 1.2185 | pt_loss: 1.1403 | pg_loss: 0.4335 | reg_loss: 0.7850 | reward: -0.1575 | rev_kl: 1.4261 | stu_lens: 117.5000 | mixed_lens: 76.5000 | lr: 4.8473e-06 | scale: 2048.00 | time: 26.387 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    653/  5000| tot_loss: 2.6104 | rl_loss: 0.8325 | pt_loss: 1.7779 | pg_loss: 0.0879 | reg_loss: 0.7447 | reward: -0.0991 | rev_kl: 0.7229 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8467e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    654/  5000| tot_loss: 2.8953 | rl_loss: 0.9986 | pt_loss: 1.8967 | pg_loss: 0.2752 | reg_loss: 0.7234 | reward: -0.8643 | rev_kl: 1.2450 | stu_lens: 76.5000 | mixed_lens: 72.5000 | lr: 4.8462e-06 | scale: 2048.00 | time: 26.340 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    655/  5000| tot_loss: 2.8286 | rl_loss: 0.9634 | pt_loss: 1.8651 | pg_loss: 0.0464 | reg_loss: 0.9171 | reward: -0.0855 | rev_kl: 0.6600 | stu_lens: 54.5000 | mixed_lens: 128.0000 | lr: 4.8456e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    656/  5000| tot_loss: 3.0249 | rl_loss: 1.3558 | pt_loss: 1.6692 | pg_loss: 0.0504 | reg_loss: 1.3053 | reward: -0.2446 | rev_kl: 1.0800 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8451e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    656/  5000| tot_loss: 2.8387 | rl_loss: 1.1034 | pt_loss: 1.7353 | pg_loss: 0.2214 | reg_loss: 0.8820 | reward: -0.2720 | rev_kl: 0.9494 | stu_lens: 93.3438 | mixed_lens: 96.9375 | lr: 4.8451e-06 | scale: 2048.00 | time: 26.321 | step time: 27.590
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    657/  5000| tot_loss: 3.0740 | rl_loss: 1.0848 | pt_loss: 1.9892 | pg_loss: 0.2783 | reg_loss: 0.8065 | reward: -0.0647 | rev_kl: 1.1539 | stu_lens: 77.0000 | mixed_lens: 77.0000 | lr: 4.8445e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    658/  5000| tot_loss: 2.6989 | rl_loss: 1.2124 | pt_loss: 1.4865 | pg_loss: 0.3506 | reg_loss: 0.8618 | reward: -0.1798 | rev_kl: 0.8997 | stu_lens: 89.0000 | mixed_lens: 83.5000 | lr: 4.8439e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    659/  5000| tot_loss: 2.5264 | rl_loss: 0.5812 | pt_loss: 1.9451 | pg_loss: -0.0246 | reg_loss: 0.6058 | reward: -0.1213 | rev_kl: 0.6727 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8434e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    660/  5000| tot_loss: 2.5878 | rl_loss: 0.9815 | pt_loss: 1.6063 | pg_loss: 0.4238 | reg_loss: 0.5576 | reward: -1.2008 | rev_kl: 3.8579 | stu_lens: 97.0000 | mixed_lens: 72.5000 | lr: 4.8428e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    661/  5000| tot_loss: 2.6177 | rl_loss: 0.5606 | pt_loss: 2.0571 | pg_loss: 0.0356 | reg_loss: 0.5250 | reward: -0.1868 | rev_kl: 1.4084 | stu_lens: 58.0000 | mixed_lens: 128.0000 | lr: 4.8423e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    662/  5000| tot_loss: 2.0470 | rl_loss: 0.3074 | pt_loss: 1.7396 | pg_loss: 0.0292 | reg_loss: 0.2782 | reward: -0.2394 | rev_kl: 0.6952 | stu_lens: 83.0000 | mixed_lens: 85.5000 | lr: 4.8417e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    663/  5000| tot_loss: 1.5516 | rl_loss: -0.2667 | pt_loss: 1.8183 | pg_loss: -0.4881 | reg_loss: 0.2214 | reward: 1.2641 | rev_kl: 1.2171 | stu_lens: 17.0000 | mixed_lens: 7.5000 | lr: 4.8411e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    664/  5000| tot_loss: 2.4903 | rl_loss: 0.4759 | pt_loss: 2.0144 | pg_loss: 0.1519 | reg_loss: 0.3240 | reward: -0.2805 | rev_kl: 0.7845 | stu_lens: 77.0000 | mixed_lens: 92.5000 | lr: 4.8406e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    665/  5000| tot_loss: 3.0850 | rl_loss: 1.0058 | pt_loss: 2.0793 | pg_loss: 0.1723 | reg_loss: 0.8334 | reward: -0.1005 | rev_kl: 0.7137 | stu_lens: 89.0000 | mixed_lens: 114.5000 | lr: 4.8400e-06 | scale: 2048.00 | time: 26.350 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    666/  5000| tot_loss: 2.5943 | rl_loss: 0.8009 | pt_loss: 1.7934 | pg_loss: 0.1890 | reg_loss: 0.6119 | reward: -0.1409 | rev_kl: 0.9689 | stu_lens: 128.0000 | mixed_lens: 105.0000 | lr: 4.8395e-06 | scale: 2048.00 | time: 26.395 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    667/  5000| tot_loss: 2.0123 | rl_loss: 0.5295 | pt_loss: 1.4828 | pg_loss: 0.0121 | reg_loss: 0.5174 | reward: -0.0269 | rev_kl: 0.5819 | stu_lens: 105.0000 | mixed_lens: 128.0000 | lr: 4.8389e-06 | scale: 2048.00 | time: 26.374 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    668/  5000| tot_loss: 2.4031 | rl_loss: 0.8486 | pt_loss: 1.5545 | pg_loss: 0.3606 | reg_loss: 0.4880 | reward: -0.3927 | rev_kl: 0.9445 | stu_lens: 68.0000 | mixed_lens: 61.5000 | lr: 4.8383e-06 | scale: 2048.00 | time: 26.345 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    669/  5000| tot_loss: 2.1402 | rl_loss: 0.7895 | pt_loss: 1.3507 | pg_loss: 0.1731 | reg_loss: 0.6164 | reward: -0.2786 | rev_kl: 0.6802 | stu_lens: 118.5000 | mixed_lens: 95.5000 | lr: 4.8378e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    670/  5000| tot_loss: 2.1018 | rl_loss: 0.5841 | pt_loss: 1.5177 | pg_loss: 0.0782 | reg_loss: 0.5059 | reward: -0.0414 | rev_kl: 0.7991 | stu_lens: 94.0000 | mixed_lens: 113.5000 | lr: 4.8372e-06 | scale: 2048.00 | time: 26.350 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    671/  5000| tot_loss: 2.2854 | rl_loss: 0.6126 | pt_loss: 1.6729 | pg_loss: 0.0496 | reg_loss: 0.5630 | reward: -0.1995 | rev_kl: 1.3221 | stu_lens: 85.5000 | mixed_lens: 128.0000 | lr: 4.8366e-06 | scale: 2048.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    672/  5000| tot_loss: 2.4896 | rl_loss: 0.7492 | pt_loss: 1.7404 | pg_loss: 0.2102 | reg_loss: 0.5390 | reward: -0.0963 | rev_kl: 1.4277 | stu_lens: 117.5000 | mixed_lens: 99.5000 | lr: 4.8361e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    672/  5000| tot_loss: 2.4983 | rl_loss: 0.7718 | pt_loss: 1.7266 | pg_loss: 0.1808 | reg_loss: 0.5910 | reward: -0.3385 | rev_kl: 1.1282 | stu_lens: 91.2344 | mixed_lens: 93.7969 | lr: 4.8361e-06 | scale: 2048.00 | time: 26.275 | step time: 27.589
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    673/  5000| tot_loss: 2.4637 | rl_loss: 1.0445 | pt_loss: 1.4192 | pg_loss: 0.2576 | reg_loss: 0.7869 | reward: -0.1264 | rev_kl: 1.1590 | stu_lens: 63.5000 | mixed_lens: 71.5000 | lr: 4.8355e-06 | scale: 2048.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    674/  5000| tot_loss: 2.1736 | rl_loss: 0.6531 | pt_loss: 1.5205 | pg_loss: 0.4046 | reg_loss: 0.2485 | reward: -0.2527 | rev_kl: 0.9330 | stu_lens: 74.0000 | mixed_lens: 71.5000 | lr: 4.8349e-06 | scale: 2048.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    675/  5000| tot_loss: 2.7719 | rl_loss: 0.9169 | pt_loss: 1.8550 | pg_loss: 0.2788 | reg_loss: 0.6381 | reward: -1.1854 | rev_kl: 3.9511 | stu_lens: 97.0000 | mixed_lens: 72.5000 | lr: 4.8343e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    676/  5000| tot_loss: 2.4067 | rl_loss: 0.6978 | pt_loss: 1.7089 | pg_loss: 0.1691 | reg_loss: 0.5286 | reward: -0.1670 | rev_kl: 1.2577 | stu_lens: 117.5000 | mixed_lens: 99.5000 | lr: 4.8338e-06 | scale: 2048.00 | time: 26.352 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    677/  5000| tot_loss: 2.0863 | rl_loss: 0.6012 | pt_loss: 1.4852 | pg_loss: 0.2967 | reg_loss: 0.3045 | reward: -0.4488 | rev_kl: 0.4538 | stu_lens: 74.0000 | mixed_lens: 65.0000 | lr: 4.8332e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    678/  5000| tot_loss: 2.2434 | rl_loss: 0.6413 | pt_loss: 1.6020 | pg_loss: 0.2355 | reg_loss: 0.4059 | reward: -0.1784 | rev_kl: 1.2693 | stu_lens: 77.0000 | mixed_lens: 92.5000 | lr: 4.8326e-06 | scale: 2048.00 | time: 26.385 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    679/  5000| tot_loss: 2.2463 | rl_loss: 0.6197 | pt_loss: 1.6266 | pg_loss: 0.0554 | reg_loss: 0.5643 | reward: -0.1289 | rev_kl: 1.3958 | stu_lens: 85.5000 | mixed_lens: 128.0000 | lr: 4.8320e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    680/  5000| tot_loss: 2.3567 | rl_loss: 0.5480 | pt_loss: 1.8087 | pg_loss: 0.2027 | reg_loss: 0.3453 | reward: -0.2306 | rev_kl: 0.6344 | stu_lens: 128.0000 | mixed_lens: 99.0000 | lr: 4.8315e-06 | scale: 2048.00 | time: 26.382 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    681/  5000| tot_loss: 2.2675 | rl_loss: 0.7328 | pt_loss: 1.5348 | pg_loss: 0.1789 | reg_loss: 0.5539 | reward: -0.2650 | rev_kl: 0.5582 | stu_lens: 76.0000 | mixed_lens: 95.5000 | lr: 4.8309e-06 | scale: 2048.00 | time: 26.340 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    682/  5000| tot_loss: 2.0199 | rl_loss: 0.4641 | pt_loss: 1.5558 | pg_loss: -0.0097 | reg_loss: 0.4739 | reward: -0.1053 | rev_kl: 1.2929 | stu_lens: 117.5000 | mixed_lens: 128.0000 | lr: 4.8303e-06 | scale: 2048.00 | time: 26.352 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    683/  5000| tot_loss: 2.2417 | rl_loss: 0.6931 | pt_loss: 1.5487 | pg_loss: 0.3387 | reg_loss: 0.3543 | reward: -0.3841 | rev_kl: 0.7930 | stu_lens: 19.0000 | mixed_lens: 81.5000 | lr: 4.8297e-06 | scale: 2048.00 | time: 26.323 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    684/  5000| tot_loss: 2.4272 | rl_loss: 0.5782 | pt_loss: 1.8491 | pg_loss: 0.1406 | reg_loss: 0.4375 | reward: -0.6419 | rev_kl: 0.5002 | stu_lens: 128.0000 | mixed_lens: 83.0000 | lr: 4.8291e-06 | scale: 2048.00 | time: 26.336 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    685/  5000| tot_loss: 1.9349 | rl_loss: 0.5263 | pt_loss: 1.4086 | pg_loss: 0.1325 | reg_loss: 0.3937 | reward: -0.1423 | rev_kl: 0.9517 | stu_lens: 128.0000 | mixed_lens: 105.0000 | lr: 4.8285e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    686/  5000| tot_loss: 2.2962 | rl_loss: 0.3272 | pt_loss: 1.9690 | pg_loss: 0.0198 | reg_loss: 0.3074 | reward: -0.3194 | rev_kl: 0.8749 | stu_lens: 104.5000 | mixed_lens: 105.5000 | lr: 4.8280e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    687/  5000| tot_loss: 1.6593 | rl_loss: 0.3218 | pt_loss: 1.3375 | pg_loss: -0.0136 | reg_loss: 0.3354 | reward: -0.2043 | rev_kl: 0.8005 | stu_lens: 79.5000 | mixed_lens: 128.0000 | lr: 4.8274e-06 | scale: 2048.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    688/  5000| tot_loss: 3.2443 | rl_loss: 1.8328 | pt_loss: 1.4114 | pg_loss: 1.2921 | reg_loss: 0.5407 | reward: -0.5956 | rev_kl: 1.0354 | stu_lens: 81.0000 | mixed_lens: 84.5000 | lr: 4.8268e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    688/  5000| tot_loss: 2.3672 | rl_loss: 0.6733 | pt_loss: 1.6940 | pg_loss: 0.2212 | reg_loss: 0.4521 | reward: -0.2985 | rev_kl: 1.0440 | stu_lens: 89.5469 | mixed_lens: 92.7500 | lr: 4.8268e-06 | scale: 2048.00 | time: 26.303 | step time: 27.599
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    689/  5000| tot_loss: 2.2704 | rl_loss: 0.4859 | pt_loss: 1.7845 | pg_loss: 0.0062 | reg_loss: 0.4797 | reward: -0.0641 | rev_kl: 0.8048 | stu_lens: 87.5000 | mixed_lens: 128.0000 | lr: 4.8262e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    690/  5000| tot_loss: 2.4463 | rl_loss: 0.9087 | pt_loss: 1.5376 | pg_loss: 0.3143 | reg_loss: 0.5944 | reward: -0.6248 | rev_kl: 0.7744 | stu_lens: 105.0000 | mixed_lens: 83.0000 | lr: 4.8256e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    691/  5000| tot_loss: 2.9527 | rl_loss: 1.1606 | pt_loss: 1.7922 | pg_loss: 0.8792 | reg_loss: 0.2814 | reward: -0.3934 | rev_kl: 1.2214 | stu_lens: 30.5000 | mixed_lens: 37.0000 | lr: 4.8250e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    692/  5000| tot_loss: 1.6880 | rl_loss: 0.4693 | pt_loss: 1.2187 | pg_loss: 0.0118 | reg_loss: 0.4575 | reward: -0.2493 | rev_kl: 0.8462 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8244e-06 | scale: 2048.00 | time: 26.371 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    693/  5000| tot_loss: 1.9413 | rl_loss: 0.7101 | pt_loss: 1.2313 | pg_loss: 0.3830 | reg_loss: 0.3271 | reward: -0.1357 | rev_kl: 0.8577 | stu_lens: 68.5000 | mixed_lens: 70.5000 | lr: 4.8239e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    694/  5000| tot_loss: 2.3045 | rl_loss: 0.9679 | pt_loss: 1.3366 | pg_loss: 0.4117 | reg_loss: 0.5562 | reward: -1.5372 | rev_kl: 2.2196 | stu_lens: 57.5000 | mixed_lens: 57.5000 | lr: 4.8233e-06 | scale: 2048.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    695/  5000| tot_loss: 3.8841 | rl_loss: 2.0038 | pt_loss: 1.8803 | pg_loss: 1.2777 | reg_loss: 0.7261 | reward: 0.6224 | rev_kl: 1.5546 | stu_lens: 25.0000 | mixed_lens: 9.5000 | lr: 4.8227e-06 | scale: 2048.00 | time: 26.383 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    696/  5000| tot_loss: 2.0485 | rl_loss: 0.3032 | pt_loss: 1.7453 | pg_loss: 0.1163 | reg_loss: 0.1869 | reward: -0.0764 | rev_kl: 0.7198 | stu_lens: 77.0000 | mixed_lens: 77.0000 | lr: 4.8221e-06 | scale: 2048.00 | time: 26.359 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    697/  5000| tot_loss: 2.1055 | rl_loss: 0.2624 | pt_loss: 1.8431 | pg_loss: -0.0219 | reg_loss: 0.2844 | reward: -0.2633 | rev_kl: 0.9517 | stu_lens: 81.5000 | mixed_lens: 65.5000 | lr: 4.8215e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    698/  5000| tot_loss: 2.1200 | rl_loss: 0.2825 | pt_loss: 1.8374 | pg_loss: 0.1372 | reg_loss: 0.1454 | reward: -0.1350 | rev_kl: 0.9454 | stu_lens: 64.5000 | mixed_lens: 61.5000 | lr: 4.8209e-06 | scale: 2048.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    699/  5000| tot_loss: 1.8009 | rl_loss: 0.3909 | pt_loss: 1.4100 | pg_loss: 0.0094 | reg_loss: 0.3816 | reward: -0.1965 | rev_kl: 1.3528 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8203e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
                                 Evaluation #7                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son una clasificación de  │
│                                       │ partículas subatómicas que forman la │
│                                       │ fuerza nuclear. Los cuarks pueden    │
│                                       │ clasificarse en tres tipos básicos:  │
│                                       │ el cuarkUp, el cuarkDown y el        │
│                                       │ cuarkStrange.                        │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC (Inbound Marketing            │
│                                       │ Certification) es una certificación  │
│                                       │ que muestra que quien la posee ha    │
│                                       │ completado un curso de inbound       │
│                                       │ marketing y entiende las técnicas    │
│                                       │ básicas para desarrollar una         │
│                                       │ estrategia de marketing inbound. La  │
│                                       │ certificación seda como resultado de │
│                                       │ la práctica de estos técnicas y el   │
│                                       │ aprender a entender los retos que    │
│                                       │ podrían enfrentarse al desarrollo de │
│                                       │ la estrategia. El IMC están diseñado │
│                                       │ para mejorar las habilidades del     │
│                                       │ emprendedor para desarrollar         │
│                                       │ estrategias de                       │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ 1. La cápsula del tiempo del siglo   │
│                                       │ XIX, que fue abierta el 26 de        │
│                                       │ febrero de 2022, está equipada con   │
│                                       │ un software que puede almacenar      │
│                                       │ hasta 250.000 artículos, así como    │
│                                       │ con una radio para comunicarse con   │
│                                       │ la tierra.                           │
│                                       │ 2. La cápsula del tiempo del siglo   │
│                                       │ XIX, que fue abierta el 1 mars 2022, │
│                                       │ está equipada con un software que    │
│                                       │ puede almacenar hasta 250.000        │
│                                       │ artículos, así como con una radio    │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.494 | exact_match: 0.104 | rev_kl: 0.919 | lens: 103.614 | pt_loss: 1.751 | lm_loss: 1.887 | kd_loss: 1.615 
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    700/  5000| tot_loss: 2.4832 | rl_loss: 0.6259 | pt_loss: 1.8573 | pg_loss: 0.0927 | reg_loss: 0.5332 | reward: -0.3069 | rev_kl: 0.7184 | stu_lens: 118.5000 | mixed_lens: 95.5000 | lr: 4.8197e-06 | scale: 2048.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    701/  5000| tot_loss: 1.8043 | rl_loss: 0.3580 | pt_loss: 1.4464 | pg_loss: -0.0270 | reg_loss: 0.3849 | reward: -0.1748 | rev_kl: 0.9309 | stu_lens: 57.0000 | mixed_lens: 128.0000 | lr: 4.8191e-06 | scale: 2048.00 | time: 26.347 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    702/  5000| tot_loss: 3.0960 | rl_loss: 1.3008 | pt_loss: 1.7952 | pg_loss: 0.7580 | reg_loss: 0.5429 | reward: -0.5370 | rev_kl: 0.6054 | stu_lens: 72.0000 | mixed_lens: 58.0000 | lr: 4.8185e-06 | scale: 2048.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    703/  5000| tot_loss: 2.3443 | rl_loss: 0.3738 | pt_loss: 1.9706 | pg_loss: -0.0133 | reg_loss: 0.3871 | reward: -0.1825 | rev_kl: 0.8056 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8179e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    704/  5000| tot_loss: 2.2777 | rl_loss: 0.4250 | pt_loss: 1.8527 | pg_loss: 0.0213 | reg_loss: 0.4037 | reward: -0.2428 | rev_kl: 1.2116 | stu_lens: 117.5000 | mixed_lens: 128.0000 | lr: 4.8173e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    704/  5000| tot_loss: 2.2479 | rl_loss: 0.5639 | pt_loss: 1.6840 | pg_loss: 0.1842 | reg_loss: 0.3797 | reward: -0.3003 | rev_kl: 1.0771 | stu_lens: 92.1406 | mixed_lens: 95.1562 | lr: 4.8173e-06 | scale: 2048.00 | time: 26.330 | step time: 27.615
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    705/  5000| tot_loss: 2.1733 | rl_loss: 0.5022 | pt_loss: 1.6710 | pg_loss: 0.1232 | reg_loss: 0.3790 | reward: -0.1028 | rev_kl: 0.7706 | stu_lens: 43.5000 | mixed_lens: 113.5000 | lr: 4.8167e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    706/  5000| tot_loss: 3.1075 | rl_loss: 1.2940 | pt_loss: 1.8135 | pg_loss: 0.3361 | reg_loss: 0.9579 | reward: 0.4412 | rev_kl: 0.6478 | stu_lens: 66.0000 | mixed_lens: 42.5000 | lr: 4.8161e-06 | scale: 2048.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    707/  5000| tot_loss: 3.0707 | rl_loss: 1.4159 | pt_loss: 1.6548 | pg_loss: 0.4287 | reg_loss: 0.9872 | reward: -0.3005 | rev_kl: 0.7344 | stu_lens: 108.0000 | mixed_lens: 86.0000 | lr: 4.8155e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    708/  5000| tot_loss: 2.7023 | rl_loss: 1.0825 | pt_loss: 1.6198 | pg_loss: 0.0655 | reg_loss: 1.0170 | reward: -0.0694 | rev_kl: 1.0869 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8149e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    709/  5000| tot_loss: 2.0533 | rl_loss: 0.9286 | pt_loss: 1.1247 | pg_loss: 0.0337 | reg_loss: 0.8949 | reward: -0.1014 | rev_kl: 0.7733 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8143e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    710/  5000| tot_loss: 2.6476 | rl_loss: 1.0938 | pt_loss: 1.5538 | pg_loss: 0.1233 | reg_loss: 0.9705 | reward: -0.1077 | rev_kl: 0.8355 | stu_lens: 128.0000 | mixed_lens: 117.0000 | lr: 4.8137e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    711/  5000| tot_loss: 2.1572 | rl_loss: 0.6884 | pt_loss: 1.4688 | pg_loss: 0.0323 | reg_loss: 0.6561 | reward: -0.2566 | rev_kl: 0.5068 | stu_lens: 111.0000 | mixed_lens: 128.0000 | lr: 4.8131e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    712/  5000| tot_loss: 2.7934 | rl_loss: 1.1743 | pt_loss: 1.6190 | pg_loss: 0.1790 | reg_loss: 0.9953 | reward: -0.3579 | rev_kl: 0.6401 | stu_lens: 35.0000 | mixed_lens: 99.0000 | lr: 4.8124e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    713/  5000| tot_loss: 2.3861 | rl_loss: 1.0430 | pt_loss: 1.3431 | pg_loss: 0.4549 | reg_loss: 0.5881 | reward: -0.0421 | rev_kl: 0.6958 | stu_lens: 81.0000 | mixed_lens: 80.0000 | lr: 4.8118e-06 | scale: 2048.00 | time: 26.347 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    714/  5000| tot_loss: 2.4875 | rl_loss: 0.9928 | pt_loss: 1.4947 | pg_loss: 0.0708 | reg_loss: 0.9220 | reward: -0.2153 | rev_kl: 0.9329 | stu_lens: 119.5000 | mixed_lens: 128.0000 | lr: 4.8112e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    715/  5000| tot_loss: 3.0426 | rl_loss: 1.1490 | pt_loss: 1.8936 | pg_loss: 0.0492 | reg_loss: 1.0998 | reward: -0.2887 | rev_kl: 0.6469 | stu_lens: 128.0000 | mixed_lens: 124.5000 | lr: 4.8106e-06 | scale: 2048.00 | time: 26.327 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    716/  5000| tot_loss: 2.7364 | rl_loss: 0.9843 | pt_loss: 1.7521 | pg_loss: 0.2768 | reg_loss: 0.7076 | reward: -0.3826 | rev_kl: 0.3711 | stu_lens: 128.0000 | mixed_lens: 95.5000 | lr: 4.8100e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    717/  5000| tot_loss: 2.7699 | rl_loss: 1.0817 | pt_loss: 1.6881 | pg_loss: 0.0602 | reg_loss: 1.0215 | reward: -0.3241 | rev_kl: 1.0767 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8094e-06 | scale: 2048.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    718/  5000| tot_loss: 4.9229 | rl_loss: 3.0256 | pt_loss: 1.8972 | pg_loss: 1.5882 | reg_loss: 1.4374 | reward: -3.5733 | rev_kl: 3.2451 | stu_lens: 26.0000 | mixed_lens: 16.5000 | lr: 4.8088e-06 | scale: 2048.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    719/  5000| tot_loss: 2.7958 | rl_loss: 0.7595 | pt_loss: 2.0363 | pg_loss: 0.0236 | reg_loss: 0.7359 | reward: -0.2723 | rev_kl: 0.6469 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8082e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    720/  5000| tot_loss: 3.1414 | rl_loss: 1.0894 | pt_loss: 2.0520 | pg_loss: 0.0424 | reg_loss: 1.0470 | reward: -0.1455 | rev_kl: 0.7221 | stu_lens: 74.5000 | mixed_lens: 128.0000 | lr: 4.8075e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    720/  5000| tot_loss: 2.8630 | rl_loss: 1.1545 | pt_loss: 1.7085 | pg_loss: 0.2362 | reg_loss: 0.9183 | reward: -0.3283 | rev_kl: 0.8171 | stu_lens: 97.7969 | mixed_lens: 102.7031 | lr: 4.8075e-06 | scale: 2048.00 | time: 26.284 | step time: 27.592
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    721/  5000| tot_loss: 2.8897 | rl_loss: 0.8737 | pt_loss: 2.0159 | pg_loss: 0.0236 | reg_loss: 0.8501 | reward: -0.2662 | rev_kl: 1.5645 | stu_lens: 16.0000 | mixed_lens: 128.0000 | lr: 4.8069e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    722/  5000| tot_loss: 2.6689 | rl_loss: 0.8774 | pt_loss: 1.7914 | pg_loss: 0.3118 | reg_loss: 0.5656 | reward: -0.2538 | rev_kl: 1.3572 | stu_lens: 33.0000 | mixed_lens: 99.0000 | lr: 4.8063e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    723/  5000| tot_loss: 2.5077 | rl_loss: 0.9048 | pt_loss: 1.6029 | pg_loss: 0.3658 | reg_loss: 0.5390 | reward: 0.2924 | rev_kl: 0.8100 | stu_lens: 77.0000 | mixed_lens: 75.5000 | lr: 4.8057e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    724/  5000| tot_loss: 2.8087 | rl_loss: 0.7140 | pt_loss: 2.0947 | pg_loss: -0.0029 | reg_loss: 0.7168 | reward: -0.2964 | rev_kl: 0.9641 | stu_lens: 69.5000 | mixed_lens: 128.0000 | lr: 4.8051e-06 | scale: 2048.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    725/  5000| tot_loss: 2.7044 | rl_loss: 0.8232 | pt_loss: 1.8811 | pg_loss: 0.3025 | reg_loss: 0.5207 | reward: -0.1404 | rev_kl: 0.6986 | stu_lens: 81.0000 | mixed_lens: 80.0000 | lr: 4.8045e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    726/  5000| tot_loss: 2.2002 | rl_loss: 0.6924 | pt_loss: 1.5078 | pg_loss: 0.0456 | reg_loss: 0.6468 | reward: -0.0457 | rev_kl: 0.6473 | stu_lens: 128.0000 | mixed_lens: 117.0000 | lr: 4.8038e-06 | scale: 2048.00 | time: 26.348 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    727/  5000| tot_loss: 2.1178 | rl_loss: 1.1538 | pt_loss: 0.9640 | pg_loss: 0.3429 | reg_loss: 0.8109 | reward: -0.3650 | rev_kl: 1.0067 | stu_lens: 65.0000 | mixed_lens: 82.0000 | lr: 4.8032e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    728/  5000| tot_loss: 2.5466 | rl_loss: 0.7105 | pt_loss: 1.8360 | pg_loss: -0.0229 | reg_loss: 0.7335 | reward: -0.1541 | rev_kl: 0.9323 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8026e-06 | scale: 2048.00 | time: 26.341 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    729/  5000| tot_loss: 2.5907 | rl_loss: 0.7022 | pt_loss: 1.8886 | pg_loss: 0.0058 | reg_loss: 0.6963 | reward: -0.1765 | rev_kl: 1.1943 | stu_lens: 118.0000 | mixed_lens: 128.0000 | lr: 4.8020e-06 | scale: 2048.00 | time: 26.349 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    730/  5000| tot_loss: 2.4502 | rl_loss: 0.7433 | pt_loss: 1.7070 | pg_loss: 0.1923 | reg_loss: 0.5510 | reward: -0.0366 | rev_kl: 0.5258 | stu_lens: 116.0000 | mixed_lens: 87.5000 | lr: 4.8013e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    731/  5000| tot_loss: 1.6458 | rl_loss: 0.6596 | pt_loss: 0.9862 | pg_loss: 0.1183 | reg_loss: 0.5413 | reward: -0.0830 | rev_kl: 0.9431 | stu_lens: 128.0000 | mixed_lens: 99.5000 | lr: 4.8007e-06 | scale: 2048.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    732/  5000| tot_loss: 2.5274 | rl_loss: 0.7957 | pt_loss: 1.7317 | pg_loss: 0.2307 | reg_loss: 0.5650 | reward: -0.3257 | rev_kl: 0.9065 | stu_lens: 111.0000 | mixed_lens: 95.5000 | lr: 4.8001e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    733/  5000| tot_loss: 2.5014 | rl_loss: 0.5974 | pt_loss: 1.9040 | pg_loss: -0.0022 | reg_loss: 0.5996 | reward: -0.1394 | rev_kl: 1.0199 | stu_lens: 103.0000 | mixed_lens: 128.0000 | lr: 4.7994e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    734/  5000| tot_loss: 2.6500 | rl_loss: 0.6495 | pt_loss: 2.0004 | pg_loss: 0.0811 | reg_loss: 0.5684 | reward: -0.1343 | rev_kl: 0.5687 | stu_lens: 128.0000 | mixed_lens: 108.0000 | lr: 4.7988e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    735/  5000| tot_loss: 2.3456 | rl_loss: 0.4637 | pt_loss: 1.8820 | pg_loss: 0.0512 | reg_loss: 0.4125 | reward: -0.1806 | rev_kl: 0.5467 | stu_lens: 110.5000 | mixed_lens: 119.0000 | lr: 4.7982e-06 | scale: 2048.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    736/  5000| tot_loss: 2.3545 | rl_loss: 0.4883 | pt_loss: 1.8661 | pg_loss: -0.0292 | reg_loss: 0.5175 | reward: -0.3554 | rev_kl: 0.5701 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7976e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    736/  5000| tot_loss: 2.5367 | rl_loss: 0.7915 | pt_loss: 1.7452 | pg_loss: 0.1324 | reg_loss: 0.6591 | reward: -0.3179 | rev_kl: 0.9089 | stu_lens: 94.5469 | mixed_lens: 105.3906 | lr: 4.7976e-06 | scale: 2048.00 | time: 26.279 | step time: 27.585
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    737/  5000| tot_loss: 1.7347 | rl_loss: 0.6270 | pt_loss: 1.1077 | pg_loss: 0.1964 | reg_loss: 0.4306 | reward: -0.3048 | rev_kl: 0.8035 | stu_lens: 128.0000 | mixed_lens: 92.0000 | lr: 4.7969e-06 | scale: 2048.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    738/  5000| tot_loss: 2.7900 | rl_loss: 0.7080 | pt_loss: 2.0819 | pg_loss: 0.2370 | reg_loss: 0.4710 | reward: -0.5060 | rev_kl: 0.9123 | stu_lens: 128.0000 | mixed_lens: 95.5000 | lr: 4.7963e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    739/  5000| tot_loss: 2.1753 | rl_loss: 0.4458 | pt_loss: 1.7295 | pg_loss: -0.0112 | reg_loss: 0.4570 | reward: -0.2007 | rev_kl: 0.5354 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7957e-06 | scale: 2048.00 | time: 26.314 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    740/  5000| tot_loss: 2.2575 | rl_loss: 0.3140 | pt_loss: 1.9434 | pg_loss: -0.0203 | reg_loss: 0.3344 | reward: -0.2419 | rev_kl: 0.5946 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7950e-06 | scale: 2048.00 | time: 26.329 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    741/  5000| tot_loss: 2.3961 | rl_loss: 0.9056 | pt_loss: 1.4905 | pg_loss: 0.2861 | reg_loss: 0.6196 | reward: 0.2494 | rev_kl: 0.6319 | stu_lens: 77.0000 | mixed_lens: 75.5000 | lr: 4.7944e-06 | scale: 2048.00 | time: 26.354 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    742/  5000| tot_loss: 2.0265 | rl_loss: 0.4999 | pt_loss: 1.5266 | pg_loss: 0.0018 | reg_loss: 0.4981 | reward: -0.2904 | rev_kl: 0.9291 | stu_lens: 99.0000 | mixed_lens: 128.0000 | lr: 4.7937e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    743/  5000| tot_loss: 2.3196 | rl_loss: 0.6671 | pt_loss: 1.6524 | pg_loss: 0.0307 | reg_loss: 0.6364 | reward: -0.2065 | rev_kl: 0.6262 | stu_lens: 103.0000 | mixed_lens: 124.5000 | lr: 4.7931e-06 | scale: 2048.00 | time: 26.414 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    744/  5000| tot_loss: 2.3361 | rl_loss: 0.4977 | pt_loss: 1.8383 | pg_loss: -0.0077 | reg_loss: 0.5054 | reward: -0.1364 | rev_kl: 0.7254 | stu_lens: 111.0000 | mixed_lens: 128.0000 | lr: 4.7925e-06 | scale: 2048.00 | time: 26.412 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    745/  5000| tot_loss: 1.6309 | rl_loss: 0.3173 | pt_loss: 1.3135 | pg_loss: -0.0199 | reg_loss: 0.3372 | reward: -0.2589 | rev_kl: 0.3905 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7918e-06 | scale: 2048.00 | time: 26.409 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    746/  5000| tot_loss: 1.9812 | rl_loss: 0.4350 | pt_loss: 1.5462 | pg_loss: -0.0021 | reg_loss: 0.4371 | reward: -0.2570 | rev_kl: 0.8189 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7912e-06 | scale: 2048.00 | time: 26.400 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    747/  5000| tot_loss: 3.0375 | rl_loss: 1.5314 | pt_loss: 1.5060 | pg_loss: 0.9079 | reg_loss: 0.6235 | reward: -0.6100 | rev_kl: 2.5587 | stu_lens: 82.5000 | mixed_lens: 49.0000 | lr: 4.7906e-06 | scale: 2048.00 | time: 26.404 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    748/  5000| tot_loss: 2.5819 | rl_loss: 0.9128 | pt_loss: 1.6692 | pg_loss: 0.5353 | reg_loss: 0.3775 | reward: -0.3955 | rev_kl: 0.5648 | stu_lens: 63.5000 | mixed_lens: 72.5000 | lr: 4.7899e-06 | scale: 2048.00 | time: 26.370 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    749/  5000| tot_loss: 2.7619 | rl_loss: 0.7660 | pt_loss: 1.9960 | pg_loss: 0.2787 | reg_loss: 0.4873 | reward: -0.1096 | rev_kl: 0.9236 | stu_lens: 71.0000 | mixed_lens: 80.0000 | lr: 4.7893e-06 | scale: 2048.00 | time: 26.378 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/750
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    750/  5000| tot_loss: 3.2121 | rl_loss: 1.5277 | pt_loss: 1.6844 | pg_loss: 0.9271 | reg_loss: 0.6006 | reward: -0.4181 | rev_kl: 0.6041 | stu_lens: 29.0000 | mixed_lens: 44.0000 | lr: 4.7886e-06 | scale: 2048.00 | time: 26.380 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    751/  5000| tot_loss: 2.5107 | rl_loss: 0.6818 | pt_loss: 1.8288 | pg_loss: 0.0372 | reg_loss: 0.6447 | reward: -0.5016 | rev_kl: 0.6648 | stu_lens: 68.5000 | mixed_lens: 128.0000 | lr: 4.7880e-06 | scale: 2048.00 | time: 26.430 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    752/  5000| tot_loss: 2.3842 | rl_loss: 0.6259 | pt_loss: 1.7583 | pg_loss: 0.1590 | reg_loss: 0.4669 | reward: -0.3706 | rev_kl: 0.9855 | stu_lens: 69.5000 | mixed_lens: 92.0000 | lr: 4.7873e-06 | scale: 2048.00 | time: 26.360 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    752/  5000| tot_loss: 2.3929 | rl_loss: 0.6792 | pt_loss: 1.7136 | pg_loss: 0.1900 | reg_loss: 0.4892 | reward: -0.3337 | rev_kl: 0.8627 | stu_lens: 93.9219 | mixed_lens: 101.5156 | lr: 4.7873e-06 | scale: 2048.00 | time: 26.360 | step time: 27.651
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    753/  5000| tot_loss: 2.3747 | rl_loss: 0.5844 | pt_loss: 1.7903 | pg_loss: 0.2459 | reg_loss: 0.3386 | reward: -0.1091 | rev_kl: 0.7950 | stu_lens: 108.0000 | mixed_lens: 93.5000 | lr: 4.7867e-06 | scale: 2048.00 | time: 26.443 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    754/  5000| tot_loss: 2.6597 | rl_loss: 0.5720 | pt_loss: 2.0877 | pg_loss: 0.1793 | reg_loss: 0.3926 | reward: -0.2663 | rev_kl: 0.8378 | stu_lens: 111.0000 | mixed_lens: 108.0000 | lr: 4.7860e-06 | scale: 2048.00 | time: 26.376 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    755/  5000| tot_loss: 2.5158 | rl_loss: 0.3938 | pt_loss: 2.1221 | pg_loss: -0.0218 | reg_loss: 0.4156 | reward: -0.1483 | rev_kl: 0.6064 | stu_lens: 74.5000 | mixed_lens: 128.0000 | lr: 4.7854e-06 | scale: 2048.00 | time: 26.395 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    756/  5000| tot_loss: 2.5358 | rl_loss: 0.7488 | pt_loss: 1.7870 | pg_loss: 0.3349 | reg_loss: 0.4139 | reward: -0.4599 | rev_kl: 0.9525 | stu_lens: 53.0000 | mixed_lens: 87.5000 | lr: 4.7847e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    757/  5000| tot_loss: 3.0836 | rl_loss: 0.6513 | pt_loss: 2.4323 | pg_loss: 0.1709 | reg_loss: 0.4804 | reward: 0.4254 | rev_kl: 0.8125 | stu_lens: 66.0000 | mixed_lens: 71.0000 | lr: 4.7841e-06 | scale: 2048.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    758/  5000| tot_loss: 2.5001 | rl_loss: 0.6772 | pt_loss: 1.8229 | pg_loss: 0.0542 | reg_loss: 0.6230 | reward: -0.3566 | rev_kl: 0.3331 | stu_lens: 128.0000 | mixed_lens: 124.5000 | lr: 4.7834e-06 | scale: 2048.00 | time: 26.193 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    759/  5000| tot_loss: 2.8706 | rl_loss: 1.0195 | pt_loss: 1.8511 | pg_loss: 0.6432 | reg_loss: 0.3763 | reward: -0.3098 | rev_kl: 0.6539 | stu_lens: 50.5000 | mixed_lens: 67.0000 | lr: 4.7828e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    760/  5000| tot_loss: 1.9522 | rl_loss: 0.3887 | pt_loss: 1.5635 | pg_loss: -0.0079 | reg_loss: 0.3966 | reward: -0.3262 | rev_kl: 0.8660 | stu_lens: 113.5000 | mixed_lens: 128.0000 | lr: 4.7821e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    761/  5000| tot_loss: 2.2357 | rl_loss: 0.2639 | pt_loss: 1.9718 | pg_loss: -0.0118 | reg_loss: 0.2757 | reward: -0.1220 | rev_kl: 1.2206 | stu_lens: 74.5000 | mixed_lens: 128.0000 | lr: 4.7815e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    762/  5000| tot_loss: 1.8417 | rl_loss: 0.3375 | pt_loss: 1.5042 | pg_loss: -0.0156 | reg_loss: 0.3531 | reward: -0.1830 | rev_kl: 0.9583 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7808e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    763/  5000| tot_loss: 2.1877 | rl_loss: 0.3452 | pt_loss: 1.8425 | pg_loss: 0.0131 | reg_loss: 0.3321 | reward: -0.1826 | rev_kl: 0.7727 | stu_lens: 113.5000 | mixed_lens: 128.0000 | lr: 4.7802e-06 | scale: 2048.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    764/  5000| tot_loss: 2.2057 | rl_loss: 0.4561 | pt_loss: 1.7496 | pg_loss: 0.0120 | reg_loss: 0.4442 | reward: -0.2507 | rev_kl: 0.8698 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7795e-06 | scale: 2048.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    765/  5000| tot_loss: 2.4812 | rl_loss: 0.7645 | pt_loss: 1.7167 | pg_loss: 0.3692 | reg_loss: 0.3953 | reward: -0.1648 | rev_kl: 0.7251 | stu_lens: 86.5000 | mixed_lens: 88.0000 | lr: 4.7788e-06 | scale: 2048.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    766/  5000| tot_loss: 2.3876 | rl_loss: 0.6095 | pt_loss: 1.7781 | pg_loss: 0.2698 | reg_loss: 0.3397 | reward: -3.2126 | rev_kl: 1.4560 | stu_lens: 71.5000 | mixed_lens: 67.0000 | lr: 4.7782e-06 | scale: 2048.00 | time: 26.189 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    767/  5000| tot_loss: 2.2707 | rl_loss: 0.5135 | pt_loss: 1.7572 | pg_loss: 0.0123 | reg_loss: 0.5011 | reward: -0.4708 | rev_kl: 0.8899 | stu_lens: 58.5000 | mixed_lens: 128.0000 | lr: 4.7775e-06 | scale: 2048.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    768/  5000| tot_loss: 2.2764 | rl_loss: 0.5635 | pt_loss: 1.7129 | pg_loss: 0.2699 | reg_loss: 0.2936 | reward: -0.4259 | rev_kl: 0.8187 | stu_lens: 128.0000 | mixed_lens: 95.5000 | lr: 4.7769e-06 | scale: 2048.00 | time: 26.187 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    768/  5000| tot_loss: 2.2638 | rl_loss: 0.5065 | pt_loss: 1.7573 | pg_loss: 0.1386 | reg_loss: 0.3679 | reward: -0.3306 | rev_kl: 0.8039 | stu_lens: 99.2812 | mixed_lens: 102.7656 | lr: 4.7769e-06 | scale: 2048.00 | time: 26.187 | step time: 27.548
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    769/  5000| tot_loss: 2.2510 | rl_loss: 0.4590 | pt_loss: 1.7920 | pg_loss: 0.1424 | reg_loss: 0.3165 | reward: -0.4212 | rev_kl: 0.8919 | stu_lens: 69.5000 | mixed_lens: 92.0000 | lr: 4.7762e-06 | scale: 2048.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    770/  5000| tot_loss: 3.0448 | rl_loss: 1.0416 | pt_loss: 2.0032 | pg_loss: 0.2795 | reg_loss: 0.7621 | reward: -0.4270 | rev_kl: 0.7388 | stu_lens: 91.0000 | mixed_lens: 86.0000 | lr: 4.7755e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    771/  5000| tot_loss: 4.3280 | rl_loss: 2.6560 | pt_loss: 1.6720 | pg_loss: 1.8320 | reg_loss: 0.8239 | reward: -0.7315 | rev_kl: 0.6268 | stu_lens: 65.5000 | mixed_lens: 23.0000 | lr: 4.7749e-06 | scale: 2048.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    772/  5000| tot_loss: 3.0024 | rl_loss: 1.3032 | pt_loss: 1.6992 | pg_loss: 0.3185 | reg_loss: 0.9847 | reward: -0.3595 | rev_kl: 0.6924 | stu_lens: 106.5000 | mixed_lens: 91.0000 | lr: 4.7742e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    773/  5000| tot_loss: 2.5758 | rl_loss: 1.3072 | pt_loss: 1.2685 | pg_loss: 0.0426 | reg_loss: 1.2646 | reward: -0.2189 | rev_kl: 0.8797 | stu_lens: 87.5000 | mixed_lens: 128.0000 | lr: 4.7735e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    774/  5000| tot_loss: 2.5748 | rl_loss: 0.9047 | pt_loss: 1.6701 | pg_loss: 0.0762 | reg_loss: 0.8285 | reward: -0.2200 | rev_kl: 0.7849 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7729e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    775/  5000| tot_loss: 2.8087 | rl_loss: 1.2090 | pt_loss: 1.5997 | pg_loss: 0.1554 | reg_loss: 1.0536 | reward: -0.2924 | rev_kl: 0.8651 | stu_lens: 128.0000 | mixed_lens: 103.5000 | lr: 4.7722e-06 | scale: 2048.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    776/  5000| tot_loss: 2.3551 | rl_loss: 1.0824 | pt_loss: 1.2727 | pg_loss: 0.3092 | reg_loss: 0.7732 | reward: -0.4961 | rev_kl: 0.6268 | stu_lens: 113.5000 | mixed_lens: 76.0000 | lr: 4.7715e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    777/  5000| tot_loss: 3.0092 | rl_loss: 1.1262 | pt_loss: 1.8830 | pg_loss: 0.2667 | reg_loss: 0.8595 | reward: -0.2848 | rev_kl: 0.8508 | stu_lens: 84.0000 | mixed_lens: 93.5000 | lr: 4.7709e-06 | scale: 2048.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    778/  5000| tot_loss: 2.6911 | rl_loss: 0.7483 | pt_loss: 1.9428 | pg_loss: 0.0347 | reg_loss: 0.7136 | reward: -0.2228 | rev_kl: 0.7618 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7702e-06 | scale: 2048.00 | time: 26.203 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    779/  5000| tot_loss: 2.8464 | rl_loss: 0.8995 | pt_loss: 1.9468 | pg_loss: 0.0607 | reg_loss: 0.8388 | reward: -0.0132 | rev_kl: 0.7906 | stu_lens: 87.0000 | mixed_lens: 128.0000 | lr: 4.7695e-06 | scale: 2048.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    780/  5000| tot_loss: 2.9464 | rl_loss: 1.3230 | pt_loss: 1.6234 | pg_loss: 0.3997 | reg_loss: 0.9233 | reward: -0.2412 | rev_kl: 0.7666 | stu_lens: 113.5000 | mixed_lens: 75.5000 | lr: 4.7688e-06 | scale: 2048.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    781/  5000| tot_loss: 2.7784 | rl_loss: 0.9621 | pt_loss: 1.8163 | pg_loss: 0.0298 | reg_loss: 0.9323 | reward: -0.3175 | rev_kl: 0.7292 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7682e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    782/  5000| tot_loss: 2.9092 | rl_loss: 1.1496 | pt_loss: 1.7596 | pg_loss: 0.4208 | reg_loss: 0.7288 | reward: 0.0604 | rev_kl: 0.9945 | stu_lens: 128.0000 | mixed_lens: 44.0000 | lr: 4.7675e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    783/  5000| tot_loss: 1.9947 | rl_loss: 0.9831 | pt_loss: 1.0117 | pg_loss: 0.0510 | reg_loss: 0.9321 | reward: -0.2036 | rev_kl: 1.0458 | stu_lens: 81.5000 | mixed_lens: 128.0000 | lr: 4.7668e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    784/  5000| tot_loss: 2.7394 | rl_loss: 0.9644 | pt_loss: 1.7749 | pg_loss: 0.3181 | reg_loss: 0.6463 | reward: -0.3973 | rev_kl: 0.6339 | stu_lens: 67.5000 | mixed_lens: 67.0000 | lr: 4.7661e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    784/  5000| tot_loss: 2.9812 | rl_loss: 1.2690 | pt_loss: 1.7122 | pg_loss: 0.3647 | reg_loss: 0.9043 | reward: -0.3762 | rev_kl: 0.8942 | stu_lens: 95.5781 | mixed_lens: 89.7656 | lr: 4.7661e-06 | scale: 2048.00 | time: 26.274 | step time: 27.533
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    785/  5000| tot_loss: 2.8746 | rl_loss: 1.3946 | pt_loss: 1.4800 | pg_loss: 0.4222 | reg_loss: 0.9724 | reward: -0.0068 | rev_kl: 0.9589 | stu_lens: 83.5000 | mixed_lens: 70.0000 | lr: 4.7655e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    786/  5000| tot_loss: 2.7095 | rl_loss: 0.9226 | pt_loss: 1.7869 | pg_loss: 0.4105 | reg_loss: 0.5121 | reward: -0.3581 | rev_kl: 0.9937 | stu_lens: 80.5000 | mixed_lens: 83.5000 | lr: 4.7648e-06 | scale: 2048.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    787/  5000| tot_loss: 2.7118 | rl_loss: 0.7996 | pt_loss: 1.9122 | pg_loss: 0.2670 | reg_loss: 0.5326 | reward: -0.3506 | rev_kl: 0.7371 | stu_lens: 113.5000 | mixed_lens: 84.0000 | lr: 4.7641e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    788/  5000| tot_loss: 2.1637 | rl_loss: 0.6890 | pt_loss: 1.4747 | pg_loss: -0.0071 | reg_loss: 0.6962 | reward: -0.4069 | rev_kl: 0.8183 | stu_lens: 87.5000 | mixed_lens: 128.0000 | lr: 4.7634e-06 | scale: 2048.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    789/  5000| tot_loss: 2.8644 | rl_loss: 0.7843 | pt_loss: 2.0801 | pg_loss: 0.0758 | reg_loss: 0.7085 | reward: -0.3138 | rev_kl: 0.7358 | stu_lens: 128.0000 | mixed_lens: 120.0000 | lr: 4.7627e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    790/  5000| tot_loss: 2.5309 | rl_loss: 0.5711 | pt_loss: 1.9598 | pg_loss: 0.0402 | reg_loss: 0.5308 | reward: -0.2403 | rev_kl: 0.6307 | stu_lens: 128.0000 | mixed_lens: 115.5000 | lr: 4.7621e-06 | scale: 2048.00 | time: 26.225 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    791/  5000| tot_loss: 2.3678 | rl_loss: 0.3784 | pt_loss: 1.9895 | pg_loss: -0.0033 | reg_loss: 0.3817 | reward: -0.2853 | rev_kl: 1.0221 | stu_lens: 111.0000 | mixed_lens: 128.0000 | lr: 4.7614e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    792/  5000| tot_loss: 2.0001 | rl_loss: 0.6071 | pt_loss: 1.3929 | pg_loss: 0.0617 | reg_loss: 0.5454 | reward: -0.1676 | rev_kl: 0.9503 | stu_lens: 128.0000 | mixed_lens: 117.5000 | lr: 4.7607e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    793/  5000| tot_loss: 2.7362 | rl_loss: 0.7909 | pt_loss: 1.9453 | pg_loss: 0.1092 | reg_loss: 0.6817 | reward: -0.2290 | rev_kl: 1.0242 | stu_lens: 124.0000 | mixed_lens: 109.0000 | lr: 4.7600e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    794/  5000| tot_loss: 2.5465 | rl_loss: 0.6797 | pt_loss: 1.8669 | pg_loss: 0.0235 | reg_loss: 0.6562 | reward: -0.1658 | rev_kl: 0.7225 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7593e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    795/  5000| tot_loss: 4.4198 | rl_loss: 2.6072 | pt_loss: 1.8126 | pg_loss: 1.9818 | reg_loss: 0.6253 | reward: -1.5975 | rev_kl: 0.8920 | stu_lens: 56.5000 | mixed_lens: 20.0000 | lr: 4.7586e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    796/  5000| tot_loss: 2.3643 | rl_loss: 0.7038 | pt_loss: 1.6604 | pg_loss: 0.0749 | reg_loss: 0.6289 | reward: -0.1219 | rev_kl: 0.9298 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 4.7580e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    797/  5000| tot_loss: 2.5958 | rl_loss: 0.7292 | pt_loss: 1.8666 | pg_loss: 0.1417 | reg_loss: 0.5875 | reward: -0.1967 | rev_kl: 0.7143 | stu_lens: 112.0000 | mixed_lens: 90.5000 | lr: 4.7573e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    798/  5000| tot_loss: 2.3009 | rl_loss: 0.5992 | pt_loss: 1.7017 | pg_loss: 0.0373 | reg_loss: 0.5619 | reward: -0.0900 | rev_kl: 1.0044 | stu_lens: 87.0000 | mixed_lens: 128.0000 | lr: 4.7566e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    799/  5000| tot_loss: 2.5295 | rl_loss: 0.7173 | pt_loss: 1.8122 | pg_loss: 0.0912 | reg_loss: 0.6261 | reward: -0.2073 | rev_kl: 0.8512 | stu_lens: 128.0000 | mixed_lens: 95.0000 | lr: 4.7559e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
                                 Evaluation #8                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks tienen tres tipos         │
│                                       │ diferentes:                          │
│                                       │                                      │
│                                       │ - Cuark c (charm)                    │
│                                       │ - Cuark b (bottom)                   │
│                                       │ - Cuark t (top)                      │
│                                       │                                      │
│                                       │ Los cuarks c y b son llamados de     │
│                                       │ "first generation" porque fueron     │
│                                       │ descubiertos antes que los cuarks t. │
│                                       │                                      │
│                                       │ Los cuarks t son llamados de "second │
│                                       │ generation" porque fueron            │
│                                       │ descubiertos después que los cuarks  │
│                                       │ c y b.                               │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es el acrónimo de "Invoicing  │
│                                       │ and Management Center", es una       │
│                                       │ aplicación de cloud computing que se │
│                                       │ puede utilizar para generar          │
│                                       │ invoices, cupones de bonificación,   │
│                                       │ retenciones, demandas y otras        │
│                                       │ funciones de administración de       │
│                                       │ financias. La utilidad del IMC       │
│                                       │ radica en la flexibilidad que ofrece │
│                                       │ para el día a día de una empresa, ya │
│                                       │ que no se requiere de instalación de │
│                                       │ programa ni de personal              │
│                                       │ especializado para utilizarla, solo  │
│                                       │ debe estar conectada a internet y    │
│                                       │ poder seguir las pautas de seguridad │
│                                       │ de                                   │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los dispositivos de cápsulas del     │
│                                       │ tiempo más famosos de la historia    │
│                                       │ son:                                 │
│                                       │                                      │
│                                       │ - La cápsula del tiempo de           │
│                                       │ Kettering, que fue ideada por Thomas │
│                                       │ Edison y que fue lanzada por primera │
│                                       │ vez el 26 de septiembre de 1933.     │
│                                       │                                      │
│                                       │ - La cápsula del tiempo de TNT, que  │
│                                       │ fue lanzada por primera vez el 7 de  │
│                                       │ junio de 1967.                       │
│                                       │                                      │
│                                       │ - La cápsula del tiempo de Pyramid,  │
│                                       │ que fue lanzada por primera vez el   │
│                                       │ 14 de abril de 19                    │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.733 | exact_match: 0.104 | rev_kl: 0.882 | lens: 100.705 | pt_loss: 1.751 | lm_loss: 1.887 | kd_loss: 1.615 
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    800/  5000| tot_loss: 2.7099 | rl_loss: 0.9987 | pt_loss: 1.7112 | pg_loss: 0.3552 | reg_loss: 0.6435 | reward: -0.0795 | rev_kl: 0.7676 | stu_lens: 83.5000 | mixed_lens: 70.5000 | lr: 4.7552e-06 | scale: 2048.00 | time: 26.227 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    800/  5000| tot_loss: 2.7152 | rl_loss: 0.9720 | pt_loss: 1.7432 | pg_loss: 0.3065 | reg_loss: 0.6656 | reward: -0.3454 | rev_kl: 0.8433 | stu_lens: 96.5000 | mixed_lens: 91.4375 | lr: 4.7552e-06 | scale: 2048.00 | time: 26.227 | step time: 27.537
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    801/  5000| tot_loss: 2.4673 | rl_loss: 0.6355 | pt_loss: 1.8318 | pg_loss: 0.1965 | reg_loss: 0.4391 | reward: -0.1069 | rev_kl: 0.7959 | stu_lens: 128.0000 | mixed_lens: 84.5000 | lr: 4.7545e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    802/  5000| tot_loss: 2.3210 | rl_loss: 0.7424 | pt_loss: 1.5786 | pg_loss: 0.2576 | reg_loss: 0.4848 | reward: -0.4394 | rev_kl: 0.6385 | stu_lens: 97.5000 | mixed_lens: 51.0000 | lr: 4.7538e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    803/  5000| tot_loss: 2.2623 | rl_loss: 0.8472 | pt_loss: 1.4151 | pg_loss: 0.4797 | reg_loss: 0.3675 | reward: -0.2393 | rev_kl: 1.0418 | stu_lens: 80.5000 | mixed_lens: 59.0000 | lr: 4.7531e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    804/  5000| tot_loss: 1.9008 | rl_loss: 0.9348 | pt_loss: 0.9659 | pg_loss: 0.3573 | reg_loss: 0.5775 | reward: -0.9661 | rev_kl: 0.8329 | stu_lens: 118.5000 | mixed_lens: 83.0000 | lr: 4.7524e-06 | scale: 2048.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    805/  5000| tot_loss: 2.5898 | rl_loss: 0.8790 | pt_loss: 1.7108 | pg_loss: 0.3062 | reg_loss: 0.5728 | reward: -0.3949 | rev_kl: 0.9341 | stu_lens: 67.5000 | mixed_lens: 42.5000 | lr: 4.7517e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    806/  5000| tot_loss: 4.3190 | rl_loss: 2.4430 | pt_loss: 1.8761 | pg_loss: 1.8879 | reg_loss: 0.5551 | reward: -1.5975 | rev_kl: 0.8920 | stu_lens: 56.5000 | mixed_lens: 20.0000 | lr: 4.7510e-06 | scale: 2048.00 | time: 26.194 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    807/  5000| tot_loss: 2.1535 | rl_loss: 0.6940 | pt_loss: 1.4595 | pg_loss: 0.0998 | reg_loss: 0.5942 | reward: -0.1913 | rev_kl: 0.9373 | stu_lens: 86.0000 | mixed_lens: 101.0000 | lr: 4.7503e-06 | scale: 2048.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    808/  5000| tot_loss: 2.8173 | rl_loss: 0.9920 | pt_loss: 1.8254 | pg_loss: 0.3748 | reg_loss: 0.6172 | reward: -0.3830 | rev_kl: 0.9506 | stu_lens: 78.5000 | mixed_lens: 85.5000 | lr: 4.7496e-06 | scale: 2048.00 | time: 26.188 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    809/  5000| tot_loss: 1.9647 | rl_loss: 0.4390 | pt_loss: 1.5257 | pg_loss: 0.0208 | reg_loss: 0.4182 | reward: -0.2751 | rev_kl: 1.1954 | stu_lens: 87.5000 | mixed_lens: 128.0000 | lr: 4.7489e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    810/  5000| tot_loss: 2.4625 | rl_loss: 0.4866 | pt_loss: 1.9759 | pg_loss: 0.0063 | reg_loss: 0.4803 | reward: -0.3448 | rev_kl: 0.8446 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7482e-06 | scale: 2048.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    811/  5000| tot_loss: 1.8408 | rl_loss: 0.5542 | pt_loss: 1.2866 | pg_loss: 0.1316 | reg_loss: 0.4226 | reward: -0.3875 | rev_kl: 0.6578 | stu_lens: 91.0000 | mixed_lens: 86.0000 | lr: 4.7475e-06 | scale: 2048.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    812/  5000| tot_loss: 2.6926 | rl_loss: 0.8974 | pt_loss: 1.7952 | pg_loss: 0.4465 | reg_loss: 0.4508 | reward: -0.3799 | rev_kl: 1.1059 | stu_lens: 80.0000 | mixed_lens: 74.5000 | lr: 4.7468e-06 | scale: 2048.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    813/  5000| tot_loss: 2.3472 | rl_loss: 0.4713 | pt_loss: 1.8759 | pg_loss: 0.1775 | reg_loss: 0.2938 | reward: -0.0665 | rev_kl: 0.5820 | stu_lens: 128.0000 | mixed_lens: 68.5000 | lr: 4.7461e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    814/  5000| tot_loss: 2.0279 | rl_loss: 0.4069 | pt_loss: 1.6210 | pg_loss: 0.0054 | reg_loss: 0.4014 | reward: -0.1509 | rev_kl: 0.9232 | stu_lens: 87.0000 | mixed_lens: 128.0000 | lr: 4.7454e-06 | scale: 2048.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    815/  5000| tot_loss: 2.7766 | rl_loss: 0.6659 | pt_loss: 2.1107 | pg_loss: 0.0873 | reg_loss: 0.5786 | reward: -0.2740 | rev_kl: 0.9257 | stu_lens: 128.0000 | mixed_lens: 117.5000 | lr: 4.7447e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    816/  5000| tot_loss: 2.4311 | rl_loss: 0.6495 | pt_loss: 1.7817 | pg_loss: 0.0244 | reg_loss: 0.6251 | reward: -0.4794 | rev_kl: 0.9207 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7440e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    816/  5000| tot_loss: 2.4278 | rl_loss: 0.7051 | pt_loss: 1.7227 | pg_loss: 0.2539 | reg_loss: 0.4513 | reward: -0.3495 | rev_kl: 0.8359 | stu_lens: 99.8594 | mixed_lens: 93.2500 | lr: 4.7440e-06 | scale: 2048.00 | time: 26.247 | step time: 27.535
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    817/  5000| tot_loss: 3.4316 | rl_loss: 1.7593 | pt_loss: 1.6723 | pg_loss: 0.8782 | reg_loss: 0.8811 | reward: -0.5103 | rev_kl: 0.7556 | stu_lens: 89.5000 | mixed_lens: 45.5000 | lr: 4.7433e-06 | scale: 2048.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    818/  5000| tot_loss: 2.6264 | rl_loss: 0.4959 | pt_loss: 2.1305 | pg_loss: 0.1202 | reg_loss: 0.3757 | reward: -0.5189 | rev_kl: 0.6278 | stu_lens: 83.5000 | mixed_lens: 98.5000 | lr: 4.7426e-06 | scale: 2048.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    819/  5000| tot_loss: 2.0889 | rl_loss: 0.3786 | pt_loss: 1.7103 | pg_loss: 0.1570 | reg_loss: 0.2215 | reward: -0.2438 | rev_kl: 0.4373 | stu_lens: 104.5000 | mixed_lens: 104.5000 | lr: 4.7419e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    820/  5000| tot_loss: 2.2805 | rl_loss: 0.9906 | pt_loss: 1.2899 | pg_loss: 0.4289 | reg_loss: 0.5617 | reward: -0.2037 | rev_kl: 0.9646 | stu_lens: 100.0000 | mixed_lens: 80.0000 | lr: 4.7412e-06 | scale: 2048.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    821/  5000| tot_loss: 2.2951 | rl_loss: 0.4556 | pt_loss: 1.8395 | pg_loss: -0.0222 | reg_loss: 0.4778 | reward: -0.3734 | rev_kl: 0.8104 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7405e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    822/  5000| tot_loss: 3.3000 | rl_loss: 1.4016 | pt_loss: 1.8984 | pg_loss: 0.9905 | reg_loss: 0.4111 | reward: -1.0740 | rev_kl: 0.8595 | stu_lens: 71.0000 | mixed_lens: 38.5000 | lr: 4.7398e-06 | scale: 2048.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    823/  5000| tot_loss: 2.8460 | rl_loss: 0.8536 | pt_loss: 1.9924 | pg_loss: 0.6131 | reg_loss: 0.2405 | reward: -0.7737 | rev_kl: 0.6638 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 4.7390e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    824/  5000| tot_loss: 2.1344 | rl_loss: 0.3575 | pt_loss: 1.7769 | pg_loss: 0.1555 | reg_loss: 0.2020 | reward: -0.2391 | rev_kl: 1.4444 | stu_lens: 64.0000 | mixed_lens: 100.0000 | lr: 4.7383e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    825/  5000| tot_loss: 1.9947 | rl_loss: 0.4039 | pt_loss: 1.5908 | pg_loss: 0.0901 | reg_loss: 0.3138 | reward: -0.3915 | rev_kl: 0.6419 | stu_lens: 91.0000 | mixed_lens: 67.0000 | lr: 4.7376e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    826/  5000| tot_loss: 2.0858 | rl_loss: 0.2730 | pt_loss: 1.8128 | pg_loss: -0.0034 | reg_loss: 0.2764 | reward: -0.2466 | rev_kl: 1.0250 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7369e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    827/  5000| tot_loss: 2.5828 | rl_loss: 0.5654 | pt_loss: 2.0174 | pg_loss: 0.0694 | reg_loss: 0.4961 | reward: -0.2116 | rev_kl: 0.8278 | stu_lens: 86.0000 | mixed_lens: 109.5000 | lr: 4.7362e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    828/  5000| tot_loss: 2.1210 | rl_loss: 0.3423 | pt_loss: 1.7786 | pg_loss: 0.0592 | reg_loss: 0.2831 | reward: -0.1314 | rev_kl: 0.6711 | stu_lens: 128.0000 | mixed_lens: 117.5000 | lr: 4.7355e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    829/  5000| tot_loss: 2.5641 | rl_loss: 0.9086 | pt_loss: 1.6555 | pg_loss: 0.3870 | reg_loss: 0.5216 | reward: -0.4004 | rev_kl: 0.9922 | stu_lens: 104.5000 | mixed_lens: 67.5000 | lr: 4.7347e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    830/  5000| tot_loss: 2.3810 | rl_loss: 0.6117 | pt_loss: 1.7693 | pg_loss: 0.2318 | reg_loss: 0.3799 | reward: -0.2871 | rev_kl: 0.7079 | stu_lens: 89.0000 | mixed_lens: 88.5000 | lr: 4.7340e-06 | scale: 2048.00 | time: 26.220 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    831/  5000| tot_loss: 2.0221 | rl_loss: 0.5426 | pt_loss: 1.4796 | pg_loss: 0.1372 | reg_loss: 0.4054 | reward: -0.0546 | rev_kl: 0.8013 | stu_lens: 128.0000 | mixed_lens: 103.5000 | lr: 4.7333e-06 | scale: 2048.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    832/  5000| tot_loss: 1.8737 | rl_loss: 0.2852 | pt_loss: 1.5885 | pg_loss: -0.0085 | reg_loss: 0.2937 | reward: -0.1543 | rev_kl: 0.6238 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7326e-06 | scale: 2048.00 | time: 26.230 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    832/  5000| tot_loss: 2.4068 | rl_loss: 0.6616 | pt_loss: 1.7452 | pg_loss: 0.2714 | reg_loss: 0.3902 | reward: -0.3546 | rev_kl: 0.8286 | stu_lens: 95.2344 | mixed_lens: 86.9531 | lr: 4.7326e-06 | scale: 2048.00 | time: 26.230 | step time: 27.532
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    833/  5000| tot_loss: 2.4585 | rl_loss: 0.7616 | pt_loss: 1.6969 | pg_loss: 0.2317 | reg_loss: 0.5299 | reward: -0.5874 | rev_kl: 0.7814 | stu_lens: 106.5000 | mixed_lens: 91.0000 | lr: 4.7319e-06 | scale: 2048.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    834/  5000| tot_loss: 3.6731 | rl_loss: 1.5858 | pt_loss: 2.0873 | pg_loss: 0.2664 | reg_loss: 1.3194 | reward: -0.4471 | rev_kl: 1.0103 | stu_lens: 102.0000 | mixed_lens: 78.0000 | lr: 4.7311e-06 | scale: 2048.00 | time: 26.336 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    835/  5000| tot_loss: 2.7735 | rl_loss: 1.1247 | pt_loss: 1.6489 | pg_loss: 0.0548 | reg_loss: 1.0699 | reward: -0.1060 | rev_kl: 0.9212 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7304e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    836/  5000| tot_loss: 2.4330 | rl_loss: 0.8971 | pt_loss: 1.5359 | pg_loss: 0.0537 | reg_loss: 0.8434 | reward: 0.0022 | rev_kl: 1.1003 | stu_lens: 94.0000 | mixed_lens: 128.0000 | lr: 4.7297e-06 | scale: 2048.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    837/  5000| tot_loss: 2.3784 | rl_loss: 1.0131 | pt_loss: 1.3653 | pg_loss: 0.2792 | reg_loss: 0.7340 | reward: -0.4985 | rev_kl: 1.0022 | stu_lens: 88.5000 | mixed_lens: 87.0000 | lr: 4.7290e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    838/  5000| tot_loss: 2.4980 | rl_loss: 0.8532 | pt_loss: 1.6448 | pg_loss: 0.0496 | reg_loss: 0.8036 | reward: -0.1241 | rev_kl: 0.7444 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7282e-06 | scale: 2048.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    839/  5000| tot_loss: 2.3507 | rl_loss: 0.8576 | pt_loss: 1.4931 | pg_loss: 0.1416 | reg_loss: 0.7160 | reward: -0.1142 | rev_kl: 0.9181 | stu_lens: 71.0000 | mixed_lens: 106.5000 | lr: 4.7275e-06 | scale: 2048.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    840/  5000| tot_loss: 3.5424 | rl_loss: 1.7029 | pt_loss: 1.8394 | pg_loss: 0.6619 | reg_loss: 1.0410 | reward: -0.6313 | rev_kl: 0.6142 | stu_lens: 62.5000 | mixed_lens: 56.0000 | lr: 4.7268e-06 | scale: 2048.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    841/  5000| tot_loss: 2.8043 | rl_loss: 1.0395 | pt_loss: 1.7649 | pg_loss: 0.1977 | reg_loss: 0.8418 | reward: -0.1881 | rev_kl: 0.6734 | stu_lens: 124.0000 | mixed_lens: 104.5000 | lr: 4.7261e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    842/  5000| tot_loss: 2.7655 | rl_loss: 1.1670 | pt_loss: 1.5984 | pg_loss: 0.0294 | reg_loss: 1.1376 | reward: -0.3130 | rev_kl: 0.7537 | stu_lens: 123.5000 | mixed_lens: 126.0000 | lr: 4.7253e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    843/  5000| tot_loss: 3.0632 | rl_loss: 0.9774 | pt_loss: 2.0858 | pg_loss: 0.0503 | reg_loss: 0.9271 | reward: -0.1789 | rev_kl: 0.7758 | stu_lens: 110.0000 | mixed_lens: 125.5000 | lr: 4.7246e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    844/  5000| tot_loss: 2.4643 | rl_loss: 1.0107 | pt_loss: 1.4536 | pg_loss: 0.0904 | reg_loss: 0.9203 | reward: -0.1640 | rev_kl: 0.7269 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7239e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    845/  5000| tot_loss: 3.7552 | rl_loss: 2.0117 | pt_loss: 1.7436 | pg_loss: 0.6800 | reg_loss: 1.3317 | reward: -0.5511 | rev_kl: 0.8463 | stu_lens: 92.5000 | mixed_lens: 60.5000 | lr: 4.7231e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    846/  5000| tot_loss: 2.6513 | rl_loss: 0.9811 | pt_loss: 1.6702 | pg_loss: 0.1470 | reg_loss: 0.8341 | reward: -0.1745 | rev_kl: 0.3722 | stu_lens: 78.5000 | mixed_lens: 114.5000 | lr: 4.7224e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    847/  5000| tot_loss: 2.5587 | rl_loss: 0.8959 | pt_loss: 1.6629 | pg_loss: 0.1605 | reg_loss: 0.7353 | reward: -0.2728 | rev_kl: 0.8506 | stu_lens: 67.5000 | mixed_lens: 88.5000 | lr: 4.7217e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    848/  5000| tot_loss: 2.8427 | rl_loss: 0.9153 | pt_loss: 1.9274 | pg_loss: 0.3318 | reg_loss: 0.5835 | reward: -0.2216 | rev_kl: 0.5104 | stu_lens: 36.0000 | mixed_lens: 84.5000 | lr: 4.7209e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    848/  5000| tot_loss: 2.8940 | rl_loss: 1.0765 | pt_loss: 1.8174 | pg_loss: 0.1599 | reg_loss: 0.9166 | reward: -0.2713 | rev_kl: 0.8227 | stu_lens: 99.2031 | mixed_lens: 101.7031 | lr: 4.7209e-06 | scale: 2048.00 | time: 26.268 | step time: 27.530
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    849/  5000| tot_loss: 3.0819 | rl_loss: 1.6261 | pt_loss: 1.4559 | pg_loss: 0.4079 | reg_loss: 1.2182 | reward: -0.4673 | rev_kl: 0.8232 | stu_lens: 78.5000 | mixed_lens: 83.0000 | lr: 4.7202e-06 | scale: 2048.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    850/  5000| tot_loss: 2.6490 | rl_loss: 0.6826 | pt_loss: 1.9664 | pg_loss: 0.0017 | reg_loss: 0.6809 | reward: -0.3043 | rev_kl: 0.9626 | stu_lens: 128.0000 | mixed_lens: 125.5000 | lr: 4.7195e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    851/  5000| tot_loss: 2.6586 | rl_loss: 0.5986 | pt_loss: 2.0600 | pg_loss: 0.0056 | reg_loss: 0.5930 | reward: -0.0565 | rev_kl: 0.8362 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7187e-06 | scale: 2048.00 | time: 26.204 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    852/  5000| tot_loss: 2.2995 | rl_loss: 0.5036 | pt_loss: 1.7960 | pg_loss: 0.0191 | reg_loss: 0.4844 | reward: -0.1815 | rev_kl: 0.6938 | stu_lens: 66.5000 | mixed_lens: 128.0000 | lr: 4.7180e-06 | scale: 2048.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    853/  5000| tot_loss: 2.1632 | rl_loss: 0.6946 | pt_loss: 1.4686 | pg_loss: 0.0137 | reg_loss: 0.6809 | reward: -0.3275 | rev_kl: 0.8030 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7172e-06 | scale: 2048.00 | time: 26.225 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    854/  5000| tot_loss: 1.6134 | rl_loss: 0.3890 | pt_loss: 1.2244 | pg_loss: -0.0206 | reg_loss: 0.4096 | reward: -0.1126 | rev_kl: 1.1289 | stu_lens: 88.5000 | mixed_lens: 128.0000 | lr: 4.7165e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    855/  5000| tot_loss: 2.7820 | rl_loss: 0.9032 | pt_loss: 1.8788 | pg_loss: 0.4038 | reg_loss: 0.4994 | reward: 0.1624 | rev_kl: 0.7003 | stu_lens: 71.5000 | mixed_lens: 69.5000 | lr: 4.7158e-06 | scale: 2048.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    856/  5000| tot_loss: 2.0505 | rl_loss: 0.6186 | pt_loss: 1.4319 | pg_loss: -0.0153 | reg_loss: 0.6339 | reward: -0.1482 | rev_kl: 0.6676 | stu_lens: 123.5000 | mixed_lens: 126.0000 | lr: 4.7150e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    857/  5000| tot_loss: 2.4864 | rl_loss: 0.6568 | pt_loss: 1.8296 | pg_loss: -0.0035 | reg_loss: 0.6604 | reward: -0.2304 | rev_kl: 0.8264 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7143e-06 | scale: 2048.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    858/  5000| tot_loss: 2.2922 | rl_loss: 0.7132 | pt_loss: 1.5789 | pg_loss: 0.1177 | reg_loss: 0.5955 | reward: -0.2377 | rev_kl: 0.5725 | stu_lens: 83.5000 | mixed_lens: 104.5000 | lr: 4.7135e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    859/  5000| tot_loss: 1.8253 | rl_loss: 0.6804 | pt_loss: 1.1449 | pg_loss: 0.0045 | reg_loss: 0.6759 | reward: -0.1842 | rev_kl: 1.2092 | stu_lens: 126.0000 | mixed_lens: 127.5000 | lr: 4.7128e-06 | scale: 2048.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    860/  5000| tot_loss: 3.1026 | rl_loss: 0.8619 | pt_loss: 2.2407 | pg_loss: 0.1618 | reg_loss: 0.7001 | reward: -0.2784 | rev_kl: 0.9150 | stu_lens: 128.0000 | mixed_lens: 103.5000 | lr: 4.7120e-06 | scale: 2048.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    861/  5000| tot_loss: 1.7236 | rl_loss: 0.5331 | pt_loss: 1.1905 | pg_loss: 0.0094 | reg_loss: 0.5237 | reward: -0.2055 | rev_kl: 0.8179 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7113e-06 | scale: 2048.00 | time: 26.186 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    862/  5000| tot_loss: 2.1739 | rl_loss: 0.4618 | pt_loss: 1.7121 | pg_loss: 0.1885 | reg_loss: 0.2733 | reward: -0.5053 | rev_kl: 0.7379 | stu_lens: 30.0000 | mixed_lens: 66.5000 | lr: 4.7105e-06 | scale: 2048.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    863/  5000| tot_loss: 2.0359 | rl_loss: 0.7495 | pt_loss: 1.2864 | pg_loss: 0.1077 | reg_loss: 0.6419 | reward: -0.2788 | rev_kl: 0.7528 | stu_lens: 128.0000 | mixed_lens: 104.0000 | lr: 4.7098e-06 | scale: 2048.00 | time: 26.186 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    864/  5000| tot_loss: 2.7062 | rl_loss: 1.1321 | pt_loss: 1.5741 | pg_loss: 0.2469 | reg_loss: 0.8852 | reward: -0.3725 | rev_kl: 1.3392 | stu_lens: 81.0000 | mixed_lens: 97.0000 | lr: 4.7090e-06 | scale: 2048.00 | time: 26.207 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    864/  5000| tot_loss: 2.4646 | rl_loss: 0.7850 | pt_loss: 1.6796 | pg_loss: 0.1383 | reg_loss: 0.6467 | reward: -0.2471 | rev_kl: 0.8415 | stu_lens: 97.8594 | mixed_lens: 104.6250 | lr: 4.7090e-06 | scale: 2048.00 | time: 26.207 | step time: 27.513
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    865/  5000| tot_loss: 2.8779 | rl_loss: 1.2341 | pt_loss: 1.6438 | pg_loss: 0.4065 | reg_loss: 0.8277 | reward: -0.5776 | rev_kl: 0.4436 | stu_lens: 43.0000 | mixed_lens: 68.5000 | lr: 4.7083e-06 | scale: 2048.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    866/  5000| tot_loss: 2.2774 | rl_loss: 0.6788 | pt_loss: 1.5985 | pg_loss: 0.0447 | reg_loss: 0.6342 | reward: 0.0318 | rev_kl: 0.8081 | stu_lens: 71.0000 | mixed_lens: 75.0000 | lr: 4.7075e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    867/  5000| tot_loss: 2.0283 | rl_loss: 0.3640 | pt_loss: 1.6642 | pg_loss: 0.0929 | reg_loss: 0.2711 | reward: -0.4780 | rev_kl: 0.6435 | stu_lens: 85.0000 | mixed_lens: 87.5000 | lr: 4.7068e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    868/  5000| tot_loss: 2.8498 | rl_loss: 0.4744 | pt_loss: 2.3754 | pg_loss: 0.0736 | reg_loss: 0.4009 | reward: -0.2038 | rev_kl: 0.3908 | stu_lens: 78.5000 | mixed_lens: 114.5000 | lr: 4.7060e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    869/  5000| tot_loss: 2.5349 | rl_loss: 0.7253 | pt_loss: 1.8096 | pg_loss: 0.3607 | reg_loss: 0.3646 | reward: -0.1022 | rev_kl: 0.4253 | stu_lens: 74.0000 | mixed_lens: 73.5000 | lr: 4.7053e-06 | scale: 2048.00 | time: 26.205 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    870/  5000| tot_loss: 2.1805 | rl_loss: 0.3977 | pt_loss: 1.7828 | pg_loss: -0.0196 | reg_loss: 0.4173 | reward: -0.1046 | rev_kl: 0.8263 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7045e-06 | scale: 2048.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    871/  5000| tot_loss: 1.7026 | rl_loss: 0.4090 | pt_loss: 1.2936 | pg_loss: 0.0010 | reg_loss: 0.4080 | reward: -0.1812 | rev_kl: 0.6028 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7038e-06 | scale: 2048.00 | time: 26.187 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    872/  5000| tot_loss: 2.9303 | rl_loss: 1.0328 | pt_loss: 1.8975 | pg_loss: 0.3248 | reg_loss: 0.7081 | reward: -0.6024 | rev_kl: 0.9035 | stu_lens: 116.0000 | mixed_lens: 92.5000 | lr: 4.7030e-06 | scale: 2048.00 | time: 26.200 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    873/  5000| tot_loss: 2.5237 | rl_loss: 0.4398 | pt_loss: 2.0839 | pg_loss: 0.0016 | reg_loss: 0.4383 | reward: -0.1926 | rev_kl: 1.0832 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7022e-06 | scale: 2048.00 | time: 26.184 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    874/  5000| tot_loss: 2.2619 | rl_loss: 0.5984 | pt_loss: 1.6635 | pg_loss: 0.2535 | reg_loss: 0.3449 | reward: -0.3584 | rev_kl: 1.0351 | stu_lens: 104.5000 | mixed_lens: 83.0000 | lr: 4.7015e-06 | scale: 2048.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    875/  5000| tot_loss: 2.9038 | rl_loss: 0.7707 | pt_loss: 2.1331 | pg_loss: 0.2397 | reg_loss: 0.5310 | reward: -0.5883 | rev_kl: 0.7527 | stu_lens: 102.0000 | mixed_lens: 78.0000 | lr: 4.7007e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    876/  5000| tot_loss: 2.8549 | rl_loss: 0.7057 | pt_loss: 2.1492 | pg_loss: 0.1444 | reg_loss: 0.5613 | reward: -0.2232 | rev_kl: 0.4505 | stu_lens: 106.0000 | mixed_lens: 104.5000 | lr: 4.7000e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    877/  5000| tot_loss: 2.6012 | rl_loss: 0.6480 | pt_loss: 1.9532 | pg_loss: 0.2147 | reg_loss: 0.4333 | reward: -0.3670 | rev_kl: 0.7784 | stu_lens: 128.0000 | mixed_lens: 103.5000 | lr: 4.6992e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    878/  5000| tot_loss: 2.3928 | rl_loss: 0.8813 | pt_loss: 1.5115 | pg_loss: 0.4231 | reg_loss: 0.4583 | reward: -0.4330 | rev_kl: 0.6070 | stu_lens: 105.5000 | mixed_lens: 63.5000 | lr: 4.6984e-06 | scale: 2048.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    879/  5000| tot_loss: 2.7677 | rl_loss: 0.8928 | pt_loss: 1.8749 | pg_loss: 0.3706 | reg_loss: 0.5222 | reward: -0.3546 | rev_kl: 0.5298 | stu_lens: 44.5000 | mixed_lens: 74.5000 | lr: 4.6977e-06 | scale: 2048.00 | time: 26.205 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    880/  5000| tot_loss: 2.6462 | rl_loss: 0.4561 | pt_loss: 2.1902 | pg_loss: -0.0192 | reg_loss: 0.4753 | reward: -0.2014 | rev_kl: 1.0370 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6969e-06 | scale: 2048.00 | time: 26.227 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    880/  5000| tot_loss: 2.4892 | rl_loss: 0.6707 | pt_loss: 1.8186 | pg_loss: 0.1774 | reg_loss: 0.4933 | reward: -0.2852 | rev_kl: 0.7939 | stu_lens: 96.4062 | mixed_lens: 98.1875 | lr: 4.6969e-06 | scale: 2048.00 | time: 26.227 | step time: 27.511
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    881/  5000| tot_loss: 2.3094 | rl_loss: 0.3605 | pt_loss: 1.9489 | pg_loss: -0.0033 | reg_loss: 0.3638 | reward: -0.1884 | rev_kl: 1.0053 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6961e-06 | scale: 2048.00 | time: 26.185 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    882/  5000| tot_loss: 2.0932 | rl_loss: 0.6610 | pt_loss: 1.4322 | pg_loss: 0.2495 | reg_loss: 0.4115 | reward: -0.5957 | rev_kl: 0.7252 | stu_lens: 59.0000 | mixed_lens: 87.5000 | lr: 4.6954e-06 | scale: 2048.00 | time: 26.204 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    883/  5000| tot_loss: 2.1088 | rl_loss: 0.7210 | pt_loss: 1.3878 | pg_loss: 0.1592 | reg_loss: 0.5619 | reward: -0.4471 | rev_kl: 1.3655 | stu_lens: 81.0000 | mixed_lens: 97.0000 | lr: 4.6946e-06 | scale: 2048.00 | time: 26.185 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    884/  5000| tot_loss: 2.1616 | rl_loss: 0.5581 | pt_loss: 1.6034 | pg_loss: 0.2192 | reg_loss: 0.3390 | reward: -0.7360 | rev_kl: 0.7330 | stu_lens: 128.0000 | mixed_lens: 54.0000 | lr: 4.6938e-06 | scale: 2048.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    885/  5000| tot_loss: 3.6902 | rl_loss: 2.2170 | pt_loss: 1.4732 | pg_loss: 1.2292 | reg_loss: 0.9878 | reward: -0.9013 | rev_kl: 0.4164 | stu_lens: 39.0000 | mixed_lens: 24.0000 | lr: 4.6931e-06 | scale: 2048.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    886/  5000| tot_loss: 2.0684 | rl_loss: 0.2224 | pt_loss: 1.8460 | pg_loss: -0.0091 | reg_loss: 0.2315 | reward: -0.0946 | rev_kl: 0.8384 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6923e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    887/  5000| tot_loss: 1.9177 | rl_loss: 0.4432 | pt_loss: 1.4745 | pg_loss: 0.0323 | reg_loss: 0.4109 | reward: -0.1784 | rev_kl: 1.1886 | stu_lens: 128.0000 | mixed_lens: 125.5000 | lr: 4.6915e-06 | scale: 2048.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    888/  5000| tot_loss: 2.0399 | rl_loss: 0.3273 | pt_loss: 1.7126 | pg_loss: 0.0321 | reg_loss: 0.2952 | reward: -0.2377 | rev_kl: 1.0550 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6908e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    889/  5000| tot_loss: 2.1046 | rl_loss: 0.1771 | pt_loss: 1.9275 | pg_loss: -0.0193 | reg_loss: 0.1964 | reward: -0.1241 | rev_kl: 0.7444 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6900e-06 | scale: 2048.00 | time: 26.205 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    890/  5000| tot_loss: 2.4982 | rl_loss: 0.5907 | pt_loss: 1.9076 | pg_loss: 0.2118 | reg_loss: 0.3788 | reward: -0.3240 | rev_kl: 0.7280 | stu_lens: 97.5000 | mixed_lens: 84.5000 | lr: 4.6892e-06 | scale: 2048.00 | time: 26.220 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    891/  5000| tot_loss: 1.6833 | rl_loss: 0.3985 | pt_loss: 1.2848 | pg_loss: 0.0228 | reg_loss: 0.3756 | reward: -0.2165 | rev_kl: 0.9331 | stu_lens: 106.0000 | mixed_lens: 120.5000 | lr: 4.6884e-06 | scale: 2048.00 | time: 26.184 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    892/  5000| tot_loss: 2.1618 | rl_loss: 0.7512 | pt_loss: 1.4106 | pg_loss: 0.4038 | reg_loss: 0.3474 | reward: 0.1274 | rev_kl: 0.4774 | stu_lens: 53.5000 | mixed_lens: 69.5000 | lr: 4.6877e-06 | scale: 2048.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    893/  5000| tot_loss: 3.1658 | rl_loss: 1.1134 | pt_loss: 2.0524 | pg_loss: 0.4798 | reg_loss: 0.6336 | reward: -0.2493 | rev_kl: 0.4879 | stu_lens: 74.0000 | mixed_lens: 73.5000 | lr: 4.6869e-06 | scale: 2048.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    894/  5000| tot_loss: 1.9036 | rl_loss: 0.3486 | pt_loss: 1.5550 | pg_loss: -0.0329 | reg_loss: 0.3815 | reward: -0.1358 | rev_kl: 0.8337 | stu_lens: 87.5000 | mixed_lens: 128.0000 | lr: 4.6861e-06 | scale: 2048.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    895/  5000| tot_loss: 2.0530 | rl_loss: 0.3476 | pt_loss: 1.7054 | pg_loss: 0.0049 | reg_loss: 0.3427 | reward: -0.3537 | rev_kl: 0.6913 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6853e-06 | scale: 2048.00 | time: 26.225 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    896/  5000| tot_loss: 2.2813 | rl_loss: 0.5782 | pt_loss: 1.7030 | pg_loss: 0.2887 | reg_loss: 0.2895 | reward: 0.1584 | rev_kl: 1.1470 | stu_lens: 31.5000 | mixed_lens: 75.0000 | lr: 4.6846e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    896/  5000| tot_loss: 2.2263 | rl_loss: 0.5414 | pt_loss: 1.6849 | pg_loss: 0.1653 | reg_loss: 0.3762 | reward: -0.2521 | rev_kl: 0.8280 | stu_lens: 94.4844 | mixed_lens: 102.2344 | lr: 4.6846e-06 | scale: 2048.00 | time: 26.240 | step time: 27.502
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    897/  5000| tot_loss: 2.1967 | rl_loss: 0.4325 | pt_loss: 1.7642 | pg_loss: -0.0051 | reg_loss: 0.4375 | reward: -0.0908 | rev_kl: 1.0709 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6838e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    898/  5000| tot_loss: 3.2608 | rl_loss: 1.3747 | pt_loss: 1.8861 | pg_loss: 0.5039 | reg_loss: 0.8708 | reward: 0.1078 | rev_kl: 0.8196 | stu_lens: 96.5000 | mixed_lens: 46.0000 | lr: 4.6830e-06 | scale: 2048.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    899/  5000| tot_loss: 2.4174 | rl_loss: 0.7453 | pt_loss: 1.6721 | pg_loss: 0.0568 | reg_loss: 0.6885 | reward: -0.1397 | rev_kl: 0.6029 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6822e-06 | scale: 2048.00 | time: 26.258 | step time: 0.000
                                 Evaluation #9                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son corrientes de cuerpo  │
│                                       │ en física de partículas. Hay seis    │
│                                       │ tipos de cuarks, que han sido        │
│                                       │ descubiertos por la física de        │
│                                       │ partículas:                          │
│                                       │                                      │
│                                       │ 1. Cuark up, que tiene una carga     │
│                                       │ eléctrica +1.                        │
│                                       │ 2. Cuark charm, que tiene una carga  │
│                                       │ eléctrica +2.                        │
│                                       │ 3. Cuark strange, que tiene una      │
│                                       │ carga eléctrica +3.                  │
│                                       │ 4. Cuark bottom, que tiene una carga │
│                                       │ eléctrica −1.                        │
│                                       │ 5. Cuark top, que tiene              │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es un acrónimo de             │
│                                       │ International Medical Congress, es   │
│                                       │ decir, 'Congreso Internacional de    │
│                                       │ Medicina'. Este congreso se ha       │
│                                       │ realizado anualmente desde 1906,     │
│                                       │ cuando se creó el Fermenta, una      │
│                                       │ revista médica británica.            │
│                                       │                                      │
│                                       │ El IMC ha evolucionado y actualmente │
│                                       │ se dedica a la promoción de la       │
│                                       │ investigación médica y el            │
│                                       │ intercambio de información entre     │
│                                       │ científicos de todo el mundo.        │
│                                       │                                      │
│                                       │ También se realizan charlas y        │
│                                       │ debates para discutir temas de       │
│                                       │ actualidad en el                     │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ 1. Cápsula del tiempo de los mochis, │
│                                       │ 1983                                 │
│                                       │ 2. Cápsula del tiempo del parque de  │
│                                       │ atracciones, 1988                    │
│                                       │ 3. Cápsula del tiempo del Taj Mahal, │
│                                       │ 1993                                 │
│                                       │ 4. Cápsula del tiempo de la sala de  │
│                                       │ representaciones, 1994               │
│                                       │ 5. Cápsula del tiempo del aeropuerto │
│                                       │ de Schiphol, 1996                    │
│                                       │ 6. Cápsula del tiempo del muelle de  │
│                                       │ las Luces de París, 1                │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.219 | exact_match: 0.000 | rev_kl: 0.981 | lens: 96.209 | pt_loss: 1.748 | lm_loss: 1.881 | kd_loss: 1.616 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    900/  5000| tot_loss: 2.5787 | rl_loss: 0.8390 | pt_loss: 1.7397 | pg_loss: 0.4539 | reg_loss: 0.3851 | reward: -0.0678 | rev_kl: 0.4906 | stu_lens: 49.5000 | mixed_lens: 63.5000 | lr: 4.6814e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    901/  5000| tot_loss: 2.8454 | rl_loss: 1.4002 | pt_loss: 1.4453 | pg_loss: 0.3658 | reg_loss: 1.0344 | reward: -0.6018 | rev_kl: 0.5875 | stu_lens: 128.0000 | mixed_lens: 74.0000 | lr: 4.6807e-06 | scale: 2048.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    902/  5000| tot_loss: 3.5836 | rl_loss: 1.4004 | pt_loss: 2.1833 | pg_loss: 0.0340 | reg_loss: 1.3664 | reward: -0.2235 | rev_kl: 1.0805 | stu_lens: 126.0000 | mixed_lens: 128.0000 | lr: 4.6799e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    903/  5000| tot_loss: 2.9056 | rl_loss: 1.1626 | pt_loss: 1.7430 | pg_loss: 0.2100 | reg_loss: 0.9526 | reward: -0.6509 | rev_kl: 2.6743 | stu_lens: 72.0000 | mixed_lens: 92.5000 | lr: 4.6791e-06 | scale: 2048.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    904/  5000| tot_loss: 3.5722 | rl_loss: 1.8231 | pt_loss: 1.7490 | pg_loss: 0.4506 | reg_loss: 1.3725 | reward: -0.5684 | rev_kl: 1.2044 | stu_lens: 92.5000 | mixed_lens: 63.0000 | lr: 4.6783e-06 | scale: 2048.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    905/  5000| tot_loss: 2.5128 | rl_loss: 1.1430 | pt_loss: 1.3698 | pg_loss: 0.0482 | reg_loss: 1.0948 | reward: -0.1885 | rev_kl: 0.4825 | stu_lens: 73.5000 | mixed_lens: 128.0000 | lr: 4.6775e-06 | scale: 2048.00 | time: 26.182 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    906/  5000| tot_loss: 2.7194 | rl_loss: 0.7487 | pt_loss: 1.9707 | pg_loss: 0.0287 | reg_loss: 0.7201 | reward: -0.3622 | rev_kl: 0.6176 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6767e-06 | scale: 2048.00 | time: 26.206 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    907/  5000| tot_loss: 2.8198 | rl_loss: 0.8282 | pt_loss: 1.9916 | pg_loss: 0.1601 | reg_loss: 0.6680 | reward: -0.3925 | rev_kl: 0.7113 | stu_lens: 106.5000 | mixed_lens: 71.5000 | lr: 4.6759e-06 | scale: 2048.00 | time: 26.181 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    908/  5000| tot_loss: 3.3160 | rl_loss: 1.5387 | pt_loss: 1.7773 | pg_loss: 0.3528 | reg_loss: 1.1859 | reward: -2.2739 | rev_kl: 1.4553 | stu_lens: 69.5000 | mixed_lens: 61.5000 | lr: 4.6751e-06 | scale: 2048.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    909/  5000| tot_loss: 3.0610 | rl_loss: 1.2379 | pt_loss: 1.8231 | pg_loss: 0.3261 | reg_loss: 0.9117 | reward: -0.2561 | rev_kl: 1.2249 | stu_lens: 84.0000 | mixed_lens: 80.0000 | lr: 4.6744e-06 | scale: 2048.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    910/  5000| tot_loss: 3.3882 | rl_loss: 1.4170 | pt_loss: 1.9712 | pg_loss: 0.4067 | reg_loss: 1.0103 | reward: -0.5238 | rev_kl: 0.7359 | stu_lens: 107.5000 | mixed_lens: 81.5000 | lr: 4.6736e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    911/  5000| tot_loss: 2.0466 | rl_loss: 1.0833 | pt_loss: 0.9634 | pg_loss: 0.1029 | reg_loss: 0.9803 | reward: -0.2064 | rev_kl: 0.9089 | stu_lens: 94.0000 | mixed_lens: 120.0000 | lr: 4.6728e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    912/  5000| tot_loss: 4.0646 | rl_loss: 2.1290 | pt_loss: 1.9356 | pg_loss: 1.0655 | reg_loss: 1.0635 | reward: -0.5618 | rev_kl: 0.5466 | stu_lens: 29.0000 | mixed_lens: 42.5000 | lr: 4.6720e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    912/  5000| tot_loss: 2.9865 | rl_loss: 1.2331 | pt_loss: 1.7534 | pg_loss: 0.2848 | reg_loss: 0.9483 | reward: -0.3692 | rev_kl: 1.0595 | stu_lens: 95.2656 | mixed_lens: 92.7031 | lr: 4.6720e-06 | scale: 2048.00 | time: 26.300 | step time: 27.542
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    913/  5000| tot_loss: 2.9623 | rl_loss: 1.2935 | pt_loss: 1.6688 | pg_loss: 0.3831 | reg_loss: 0.9104 | reward: -0.5156 | rev_kl: 0.6503 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 4.6712e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    914/  5000| tot_loss: 2.6452 | rl_loss: 1.0051 | pt_loss: 1.6401 | pg_loss: 0.4051 | reg_loss: 0.6000 | reward: -0.4593 | rev_kl: 0.9663 | stu_lens: 128.0000 | mixed_lens: 69.5000 | lr: 4.6704e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    915/  5000| tot_loss: 3.4158 | rl_loss: 1.6347 | pt_loss: 1.7811 | pg_loss: 0.9376 | reg_loss: 0.6971 | reward: -0.5724 | rev_kl: 0.4390 | stu_lens: 65.5000 | mixed_lens: 38.5000 | lr: 4.6696e-06 | scale: 2048.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    916/  5000| tot_loss: 2.6858 | rl_loss: 0.7618 | pt_loss: 1.9240 | pg_loss: 0.1654 | reg_loss: 0.5964 | reward: -0.2874 | rev_kl: 1.2920 | stu_lens: 105.5000 | mixed_lens: 97.0000 | lr: 4.6688e-06 | scale: 2048.00 | time: 26.206 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    917/  5000| tot_loss: 3.0074 | rl_loss: 1.2137 | pt_loss: 1.7937 | pg_loss: 0.5030 | reg_loss: 0.7108 | reward: -0.4911 | rev_kl: 0.4037 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 4.6680e-06 | scale: 2048.00 | time: 26.180 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    918/  5000| tot_loss: 2.9691 | rl_loss: 0.7323 | pt_loss: 2.2368 | pg_loss: 0.0357 | reg_loss: 0.6966 | reward: -0.2595 | rev_kl: 1.1936 | stu_lens: 82.5000 | mixed_lens: 123.5000 | lr: 4.6672e-06 | scale: 2048.00 | time: 26.204 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    919/  5000| tot_loss: 2.6537 | rl_loss: 0.9127 | pt_loss: 1.7410 | pg_loss: 0.0873 | reg_loss: 0.8254 | reward: -0.2957 | rev_kl: 1.3841 | stu_lens: 123.0000 | mixed_lens: 119.5000 | lr: 4.6664e-06 | scale: 2048.00 | time: 26.202 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    920/  5000| tot_loss: 2.7146 | rl_loss: 0.9458 | pt_loss: 1.7688 | pg_loss: 0.3182 | reg_loss: 0.6276 | reward: -1.1050 | rev_kl: 0.9751 | stu_lens: 71.5000 | mixed_lens: 69.5000 | lr: 4.6656e-06 | scale: 2048.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    921/  5000| tot_loss: 2.6694 | rl_loss: 0.7499 | pt_loss: 1.9195 | pg_loss: 0.0169 | reg_loss: 0.7330 | reward: -0.5936 | rev_kl: 1.2353 | stu_lens: 92.5000 | mixed_lens: 44.5000 | lr: 4.6648e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    922/  5000| tot_loss: 2.1473 | rl_loss: 0.5409 | pt_loss: 1.6064 | pg_loss: -0.0149 | reg_loss: 0.5557 | reward: -0.1285 | rev_kl: 2.0160 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6640e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    923/  5000| tot_loss: 2.5298 | rl_loss: 1.1112 | pt_loss: 1.4186 | pg_loss: 0.3737 | reg_loss: 0.7374 | reward: 0.4423 | rev_kl: 0.7182 | stu_lens: 74.0000 | mixed_lens: 66.0000 | lr: 4.6632e-06 | scale: 2048.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    924/  5000| tot_loss: 2.6506 | rl_loss: 0.8368 | pt_loss: 1.8138 | pg_loss: 0.2779 | reg_loss: 0.5589 | reward: -0.4558 | rev_kl: 0.5289 | stu_lens: 100.0000 | mixed_lens: 92.5000 | lr: 4.6624e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    925/  5000| tot_loss: 4.5489 | rl_loss: 3.0051 | pt_loss: 1.5438 | pg_loss: 1.9971 | reg_loss: 1.0080 | reward: -2.3731 | rev_kl: 1.1529 | stu_lens: 49.0000 | mixed_lens: 13.5000 | lr: 4.6616e-06 | scale: 2048.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    926/  5000| tot_loss: 2.4937 | rl_loss: 0.5484 | pt_loss: 1.9452 | pg_loss: 0.0144 | reg_loss: 0.5340 | reward: -0.1898 | rev_kl: 0.4446 | stu_lens: 73.5000 | mixed_lens: 128.0000 | lr: 4.6608e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    927/  5000| tot_loss: 2.4714 | rl_loss: 0.4929 | pt_loss: 1.9785 | pg_loss: 0.0425 | reg_loss: 0.4504 | reward: -0.3159 | rev_kl: 2.8259 | stu_lens: 100.0000 | mixed_lens: 128.0000 | lr: 4.6600e-06 | scale: 2048.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    928/  5000| tot_loss: 2.0944 | rl_loss: 0.4505 | pt_loss: 1.6439 | pg_loss: 0.1017 | reg_loss: 0.3488 | reward: -0.1918 | rev_kl: 0.7558 | stu_lens: 77.0000 | mixed_lens: 91.0000 | lr: 4.6592e-06 | scale: 2048.00 | time: 26.248 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    928/  5000| tot_loss: 2.6509 | rl_loss: 0.9144 | pt_loss: 1.7366 | pg_loss: 0.2729 | reg_loss: 0.6415 | reward: -0.3731 | rev_kl: 1.0144 | stu_lens: 92.3906 | mixed_lens: 92.7031 | lr: 4.6592e-06 | scale: 2048.00 | time: 26.248 | step time: 27.517
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    929/  5000| tot_loss: 2.9950 | rl_loss: 1.3322 | pt_loss: 1.6628 | pg_loss: 0.8639 | reg_loss: 0.4682 | reward: -0.4113 | rev_kl: 1.2062 | stu_lens: 84.0000 | mixed_lens: 41.0000 | lr: 4.6584e-06 | scale: 2048.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    930/  5000| tot_loss: 2.0919 | rl_loss: 0.7183 | pt_loss: 1.3736 | pg_loss: 0.1753 | reg_loss: 0.5430 | reward: 0.1386 | rev_kl: 1.0020 | stu_lens: 62.5000 | mixed_lens: 64.0000 | lr: 4.6575e-06 | scale: 2048.00 | time: 26.315 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    931/  5000| tot_loss: 2.5953 | rl_loss: 0.5784 | pt_loss: 2.0169 | pg_loss: 0.1252 | reg_loss: 0.4533 | reward: -0.2434 | rev_kl: 1.0521 | stu_lens: 100.5000 | mixed_lens: 100.5000 | lr: 4.6567e-06 | scale: 2048.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    932/  5000| tot_loss: 3.1411 | rl_loss: 1.2029 | pt_loss: 1.9383 | pg_loss: 0.5702 | reg_loss: 0.6326 | reward: -0.3501 | rev_kl: 0.7536 | stu_lens: 66.0000 | mixed_lens: 70.0000 | lr: 4.6559e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    933/  5000| tot_loss: 3.2513 | rl_loss: 0.9914 | pt_loss: 2.2600 | pg_loss: 0.4942 | reg_loss: 0.4972 | reward: -0.2514 | rev_kl: 0.5902 | stu_lens: 54.5000 | mixed_lens: 69.0000 | lr: 4.6551e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    934/  5000| tot_loss: 2.5039 | rl_loss: 0.6511 | pt_loss: 1.8528 | pg_loss: 0.2000 | reg_loss: 0.4512 | reward: -0.3511 | rev_kl: 1.3261 | stu_lens: 105.5000 | mixed_lens: 97.0000 | lr: 4.6543e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    935/  5000| tot_loss: 2.6072 | rl_loss: 0.5536 | pt_loss: 2.0535 | pg_loss: 0.1798 | reg_loss: 0.3738 | reward: -0.1238 | rev_kl: 1.0009 | stu_lens: 128.0000 | mixed_lens: 80.5000 | lr: 4.6535e-06 | scale: 2048.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    936/  5000| tot_loss: 1.9844 | rl_loss: 0.2954 | pt_loss: 1.6890 | pg_loss: -0.0016 | reg_loss: 0.2970 | reward: -0.1208 | rev_kl: 0.6805 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6527e-06 | scale: 2048.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    937/  5000| tot_loss: 2.0103 | rl_loss: 0.3833 | pt_loss: 1.6270 | pg_loss: -0.0009 | reg_loss: 0.3842 | reward: -0.3622 | rev_kl: 0.6176 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6519e-06 | scale: 2048.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    938/  5000| tot_loss: 2.4586 | rl_loss: 0.4538 | pt_loss: 2.0048 | pg_loss: 0.0127 | reg_loss: 0.4411 | reward: -0.2676 | rev_kl: 1.1812 | stu_lens: 82.5000 | mixed_lens: 128.0000 | lr: 4.6510e-06 | scale: 2048.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    939/  5000| tot_loss: 2.5317 | rl_loss: 0.6030 | pt_loss: 1.9286 | pg_loss: 0.1018 | reg_loss: 0.5013 | reward: -0.4468 | rev_kl: 2.8308 | stu_lens: 95.5000 | mixed_lens: 108.5000 | lr: 4.6502e-06 | scale: 2048.00 | time: 26.187 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    940/  5000| tot_loss: 2.7382 | rl_loss: 1.0702 | pt_loss: 1.6681 | pg_loss: 0.4058 | reg_loss: 0.6644 | reward: -0.5157 | rev_kl: 0.4856 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 4.6494e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    941/  5000| tot_loss: 2.4687 | rl_loss: 0.5384 | pt_loss: 1.9303 | pg_loss: 0.0087 | reg_loss: 0.5297 | reward: -0.1312 | rev_kl: 1.8999 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6486e-06 | scale: 2048.00 | time: 26.225 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    942/  5000| tot_loss: 3.3968 | rl_loss: 1.5515 | pt_loss: 1.8452 | pg_loss: 0.9207 | reg_loss: 0.6309 | reward: -0.5214 | rev_kl: 0.7368 | stu_lens: 65.5000 | mixed_lens: 47.0000 | lr: 4.6478e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    943/  5000| tot_loss: 2.6531 | rl_loss: 0.9753 | pt_loss: 1.6778 | pg_loss: 0.4383 | reg_loss: 0.5370 | reward: -1.1603 | rev_kl: 0.9973 | stu_lens: 71.5000 | mixed_lens: 69.5000 | lr: 4.6469e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    944/  5000| tot_loss: 1.9790 | rl_loss: 0.4639 | pt_loss: 1.5151 | pg_loss: 0.0486 | reg_loss: 0.4153 | reward: -0.5142 | rev_kl: 0.8345 | stu_lens: 92.5000 | mixed_lens: 81.5000 | lr: 4.6461e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    944/  5000| tot_loss: 2.5180 | rl_loss: 0.7803 | pt_loss: 1.7377 | pg_loss: 0.3039 | reg_loss: 0.4764 | reward: -0.3781 | rev_kl: 1.0683 | stu_lens: 94.0781 | mixed_lens: 86.9531 | lr: 4.6461e-06 | scale: 2048.00 | time: 26.287 | step time: 27.548
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    945/  5000| tot_loss: 2.8350 | rl_loss: 0.6144 | pt_loss: 2.2205 | pg_loss: -0.0063 | reg_loss: 0.6208 | reward: -0.2188 | rev_kl: 0.5958 | stu_lens: 60.0000 | mixed_lens: 128.0000 | lr: 4.6453e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    946/  5000| tot_loss: 2.7895 | rl_loss: 0.6358 | pt_loss: 2.1537 | pg_loss: 0.2487 | reg_loss: 0.3871 | reward: -0.6018 | rev_kl: 0.5875 | stu_lens: 128.0000 | mixed_lens: 74.0000 | lr: 4.6445e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    947/  5000| tot_loss: 2.4710 | rl_loss: 0.4828 | pt_loss: 1.9882 | pg_loss: 0.0336 | reg_loss: 0.4493 | reward: -0.2606 | rev_kl: 1.0317 | stu_lens: 124.0000 | mixed_lens: 128.0000 | lr: 4.6437e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    948/  5000| tot_loss: 2.8100 | rl_loss: 1.0310 | pt_loss: 1.7789 | pg_loss: 1.0098 | reg_loss: 0.0212 | reward: -1.2492 | rev_kl: 0.6521 | stu_lens: 11.5000 | mixed_lens: 10.5000 | lr: 4.6428e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    949/  5000| tot_loss: 2.2009 | rl_loss: 0.7374 | pt_loss: 1.4634 | pg_loss: 0.4415 | reg_loss: 0.2959 | reward: -0.4365 | rev_kl: 0.4596 | stu_lens: 70.0000 | mixed_lens: 70.0000 | lr: 4.6420e-06 | scale: 2048.00 | time: 26.197 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    950/  5000| tot_loss: 2.4200 | rl_loss: 0.7068 | pt_loss: 1.7132 | pg_loss: 0.2213 | reg_loss: 0.4855 | reward: -0.3617 | rev_kl: 1.0760 | stu_lens: 51.0000 | mixed_lens: 97.0000 | lr: 4.6412e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    951/  5000| tot_loss: 2.0578 | rl_loss: 0.1831 | pt_loss: 1.8748 | pg_loss: -0.1059 | reg_loss: 0.2889 | reward: 0.1575 | rev_kl: 1.1328 | stu_lens: 96.5000 | mixed_lens: 35.0000 | lr: 4.6403e-06 | scale: 2048.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    952/  5000| tot_loss: 2.3683 | rl_loss: 0.6554 | pt_loss: 1.7129 | pg_loss: 0.2011 | reg_loss: 0.4543 | reward: -0.2988 | rev_kl: 0.8932 | stu_lens: 128.0000 | mixed_lens: 95.5000 | lr: 4.6395e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    953/  5000| tot_loss: 1.7677 | rl_loss: 0.6639 | pt_loss: 1.1039 | pg_loss: 0.1878 | reg_loss: 0.4761 | reward: -0.3381 | rev_kl: 1.0966 | stu_lens: 126.0000 | mixed_lens: 102.0000 | lr: 4.6387e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    954/  5000| tot_loss: 1.7072 | rl_loss: 0.3342 | pt_loss: 1.3730 | pg_loss: 0.1957 | reg_loss: 0.1385 | reward: -0.4924 | rev_kl: 0.3657 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 4.6379e-06 | scale: 2048.00 | time: 26.296 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    955/  5000| tot_loss: 2.5665 | rl_loss: 0.5767 | pt_loss: 1.9898 | pg_loss: 0.2043 | reg_loss: 0.3724 | reward: -0.0482 | rev_kl: 0.6987 | stu_lens: 77.0000 | mixed_lens: 91.0000 | lr: 4.6370e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    956/  5000| tot_loss: 2.3122 | rl_loss: 0.4160 | pt_loss: 1.8962 | pg_loss: 0.0168 | reg_loss: 0.3992 | reward: -0.2484 | rev_kl: 1.3193 | stu_lens: 77.0000 | mixed_lens: 128.0000 | lr: 4.6362e-06 | scale: 2048.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    957/  5000| tot_loss: 2.1958 | rl_loss: 0.2079 | pt_loss: 1.9878 | pg_loss: -0.0297 | reg_loss: 0.2376 | reward: -0.1980 | rev_kl: 1.0902 | stu_lens: 107.5000 | mixed_lens: 128.0000 | lr: 4.6354e-06 | scale: 2048.00 | time: 26.211 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    958/  5000| tot_loss: 1.8786 | rl_loss: 0.6059 | pt_loss: 1.2727 | pg_loss: 0.1719 | reg_loss: 0.4340 | reward: -0.1300 | rev_kl: 0.9348 | stu_lens: 103.0000 | mixed_lens: 105.5000 | lr: 4.6345e-06 | scale: 2048.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    959/  5000| tot_loss: 2.3320 | rl_loss: 0.5046 | pt_loss: 1.8275 | pg_loss: 0.0292 | reg_loss: 0.4753 | reward: -0.1637 | rev_kl: 0.9575 | stu_lens: 94.0000 | mixed_lens: 120.0000 | lr: 4.6337e-06 | scale: 2048.00 | time: 26.209 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    960/  5000| tot_loss: 2.4529 | rl_loss: 0.6487 | pt_loss: 1.8041 | pg_loss: 0.2682 | reg_loss: 0.3805 | reward: -0.3495 | rev_kl: 0.9728 | stu_lens: 128.0000 | mixed_lens: 84.5000 | lr: 4.6329e-06 | scale: 2048.00 | time: 26.244 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    960/  5000| tot_loss: 2.2431 | rl_loss: 0.5408 | pt_loss: 1.7024 | pg_loss: 0.1657 | reg_loss: 0.3750 | reward: -0.3514 | rev_kl: 0.9682 | stu_lens: 94.0000 | mixed_lens: 94.9844 | lr: 4.6329e-06 | scale: 2048.00 | time: 26.244 | step time: 27.534
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    961/  5000| tot_loss: 2.1774 | rl_loss: 0.5828 | pt_loss: 1.5946 | pg_loss: 0.1723 | reg_loss: 0.4105 | reward: -0.6514 | rev_kl: 0.9157 | stu_lens: 88.0000 | mixed_lens: 62.0000 | lr: 4.6320e-06 | scale: 2048.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    962/  5000| tot_loss: 2.9775 | rl_loss: 0.9622 | pt_loss: 2.0153 | pg_loss: 0.0753 | reg_loss: 0.8869 | reward: -0.3607 | rev_kl: 1.1570 | stu_lens: 128.0000 | mixed_lens: 122.5000 | lr: 4.6312e-06 | scale: 2048.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    963/  5000| tot_loss: 2.8823 | rl_loss: 1.0243 | pt_loss: 1.8580 | pg_loss: 0.0675 | reg_loss: 0.9568 | reward: -0.2853 | rev_kl: 0.9144 | stu_lens: 109.0000 | mixed_lens: 125.0000 | lr: 4.6303e-06 | scale: 2048.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    964/  5000| tot_loss: 3.1229 | rl_loss: 1.5877 | pt_loss: 1.5353 | pg_loss: 0.7043 | reg_loss: 0.8833 | reward: -1.6815 | rev_kl: 1.3053 | stu_lens: 59.0000 | mixed_lens: 43.0000 | lr: 4.6295e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    965/  5000| tot_loss: 2.4437 | rl_loss: 0.9774 | pt_loss: 1.4663 | pg_loss: 0.0447 | reg_loss: 0.9327 | reward: -0.2197 | rev_kl: 0.5880 | stu_lens: 82.0000 | mixed_lens: 128.0000 | lr: 4.6287e-06 | scale: 2048.00 | time: 26.189 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    966/  5000| tot_loss: 3.8967 | rl_loss: 1.6534 | pt_loss: 2.2433 | pg_loss: 0.4188 | reg_loss: 1.2345 | reward: -0.5929 | rev_kl: 0.4964 | stu_lens: 8.0000 | mixed_lens: 68.5000 | lr: 4.6278e-06 | scale: 2048.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    967/  5000| tot_loss: 3.0076 | rl_loss: 1.2694 | pt_loss: 1.7382 | pg_loss: 0.2510 | reg_loss: 1.0184 | reward: -0.3812 | rev_kl: 0.9984 | stu_lens: 75.5000 | mixed_lens: 74.5000 | lr: 4.6270e-06 | scale: 2048.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    968/  5000| tot_loss: 3.6220 | rl_loss: 1.8570 | pt_loss: 1.7649 | pg_loss: 0.7259 | reg_loss: 1.1312 | reward: -0.6287 | rev_kl: 0.4318 | stu_lens: 116.0000 | mixed_lens: 54.0000 | lr: 4.6261e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    969/  5000| tot_loss: 2.9625 | rl_loss: 0.9782 | pt_loss: 1.9843 | pg_loss: 0.0692 | reg_loss: 0.9090 | reward: -0.2170 | rev_kl: 0.6456 | stu_lens: 96.0000 | mixed_lens: 112.5000 | lr: 4.6253e-06 | scale: 2048.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    970/  5000| tot_loss: 2.6801 | rl_loss: 0.8619 | pt_loss: 1.8183 | pg_loss: 0.0390 | reg_loss: 0.8229 | reward: -0.0721 | rev_kl: 0.7087 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6245e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    971/  5000| tot_loss: 2.7117 | rl_loss: 0.8766 | pt_loss: 1.8351 | pg_loss: 0.0415 | reg_loss: 0.8351 | reward: -0.2571 | rev_kl: 0.7609 | stu_lens: 128.0000 | mixed_lens: 126.0000 | lr: 4.6236e-06 | scale: 2048.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    972/  5000| tot_loss: 2.6003 | rl_loss: 1.4326 | pt_loss: 1.1677 | pg_loss: 0.3205 | reg_loss: 1.1121 | reward: -1.0457 | rev_kl: 1.3137 | stu_lens: 83.0000 | mixed_lens: 77.0000 | lr: 4.6228e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    973/  5000| tot_loss: 3.5938 | rl_loss: 1.7356 | pt_loss: 1.8581 | pg_loss: 0.3005 | reg_loss: 1.4352 | reward: -0.4937 | rev_kl: 0.9082 | stu_lens: 49.0000 | mixed_lens: 74.5000 | lr: 4.6219e-06 | scale: 2048.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    974/  5000| tot_loss: 3.6086 | rl_loss: 1.8429 | pt_loss: 1.7657 | pg_loss: 0.6461 | reg_loss: 1.1967 | reward: -0.7879 | rev_kl: 0.7841 | stu_lens: 72.5000 | mixed_lens: 41.0000 | lr: 4.6211e-06 | scale: 2048.00 | time: 26.216 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    975/  5000| tot_loss: 3.4639 | rl_loss: 1.2326 | pt_loss: 2.2314 | pg_loss: 0.3881 | reg_loss: 0.8445 | reward: -0.2342 | rev_kl: 0.7883 | stu_lens: 55.5000 | mixed_lens: 88.5000 | lr: 4.6202e-06 | scale: 2048.00 | time: 26.197 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    976/  5000| tot_loss: 2.1652 | rl_loss: 0.8816 | pt_loss: 1.2837 | pg_loss: 0.0801 | reg_loss: 0.8015 | reward: -0.2957 | rev_kl: 0.7175 | stu_lens: 85.5000 | mixed_lens: 114.5000 | lr: 4.6194e-06 | scale: 2048.00 | time: 26.216 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    976/  5000| tot_loss: 3.0228 | rl_loss: 1.2702 | pt_loss: 1.7526 | pg_loss: 0.3356 | reg_loss: 0.9346 | reward: -0.4617 | rev_kl: 0.9154 | stu_lens: 83.1094 | mixed_lens: 86.5781 | lr: 4.6194e-06 | scale: 2048.00 | time: 26.216 | step time: 27.522
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    977/  5000| tot_loss: 2.8271 | rl_loss: 1.1843 | pt_loss: 1.6428 | pg_loss: 0.0536 | reg_loss: 1.1308 | reward: -0.3051 | rev_kl: 0.7376 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6185e-06 | scale: 2048.00 | time: 26.181 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    978/  5000| tot_loss: 3.0158 | rl_loss: 1.3597 | pt_loss: 1.6561 | pg_loss: 0.7154 | reg_loss: 0.6443 | reward: -0.4627 | rev_kl: 0.6572 | stu_lens: 96.5000 | mixed_lens: 53.0000 | lr: 4.6177e-06 | scale: 2048.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    979/  5000| tot_loss: 2.2221 | rl_loss: 0.6256 | pt_loss: 1.5964 | pg_loss: 0.2441 | reg_loss: 0.3815 | reward: -0.2296 | rev_kl: 0.8115 | stu_lens: 85.5000 | mixed_lens: 89.5000 | lr: 4.6168e-06 | scale: 2048.00 | time: 26.202 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    980/  5000| tot_loss: 2.9070 | rl_loss: 0.8104 | pt_loss: 2.0967 | pg_loss: 0.0994 | reg_loss: 0.7109 | reward: -0.1950 | rev_kl: 0.8911 | stu_lens: 82.5000 | mixed_lens: 111.5000 | lr: 4.6160e-06 | scale: 2048.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    981/  5000| tot_loss: 2.8929 | rl_loss: 1.0780 | pt_loss: 1.8149 | pg_loss: 0.1965 | reg_loss: 0.8815 | reward: -0.4137 | rev_kl: 1.1606 | stu_lens: 121.0000 | mixed_lens: 101.0000 | lr: 4.6151e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    982/  5000| tot_loss: 2.0753 | rl_loss: 0.5814 | pt_loss: 1.4939 | pg_loss: 0.0301 | reg_loss: 0.5513 | reward: -0.1669 | rev_kl: 0.6445 | stu_lens: 96.0000 | mixed_lens: 112.5000 | lr: 4.6142e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    983/  5000| tot_loss: 2.8621 | rl_loss: 0.9597 | pt_loss: 1.9024 | pg_loss: 0.2086 | reg_loss: 0.7511 | reward: -0.4677 | rev_kl: 1.1571 | stu_lens: 83.5000 | mixed_lens: 74.5000 | lr: 4.6134e-06 | scale: 2048.00 | time: 26.203 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    984/  5000| tot_loss: 2.2299 | rl_loss: 0.4921 | pt_loss: 1.7378 | pg_loss: -0.0071 | reg_loss: 0.4991 | reward: -0.1866 | rev_kl: 1.0012 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6125e-06 | scale: 2048.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    985/  5000| tot_loss: 2.5682 | rl_loss: 0.6747 | pt_loss: 1.8935 | pg_loss: 0.0117 | reg_loss: 0.6629 | reward: -0.1697 | rev_kl: 0.7218 | stu_lens: 66.0000 | mixed_lens: 128.0000 | lr: 4.6117e-06 | scale: 2048.00 | time: 26.180 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    986/  5000| tot_loss: 3.4061 | rl_loss: 1.7473 | pt_loss: 1.6588 | pg_loss: 1.1813 | reg_loss: 0.5660 | reward: -0.5371 | rev_kl: 0.6137 | stu_lens: 44.0000 | mixed_lens: 50.5000 | lr: 4.6108e-06 | scale: 2048.00 | time: 26.205 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    987/  5000| tot_loss: 2.2646 | rl_loss: 0.9209 | pt_loss: 1.3436 | pg_loss: 0.4049 | reg_loss: 0.5160 | reward: -0.8941 | rev_kl: 0.3512 | stu_lens: 24.0000 | mixed_lens: 70.5000 | lr: 4.6100e-06 | scale: 2048.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    988/  5000| tot_loss: 2.3604 | rl_loss: 0.8539 | pt_loss: 1.5065 | pg_loss: 0.1645 | reg_loss: 0.6894 | reward: -0.4320 | rev_kl: 1.0181 | stu_lens: 75.5000 | mixed_lens: 74.5000 | lr: 4.6091e-06 | scale: 2048.00 | time: 26.225 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    989/  5000| tot_loss: 2.6854 | rl_loss: 0.8175 | pt_loss: 1.8679 | pg_loss: 0.3449 | reg_loss: 0.4727 | reward: -0.3214 | rev_kl: 0.6631 | stu_lens: 68.0000 | mixed_lens: 80.0000 | lr: 4.6082e-06 | scale: 2048.00 | time: 26.197 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    990/  5000| tot_loss: 2.5029 | rl_loss: 0.5889 | pt_loss: 1.9140 | pg_loss: 0.0372 | reg_loss: 0.5517 | reward: -0.2077 | rev_kl: 0.8833 | stu_lens: 128.0000 | mixed_lens: 126.0000 | lr: 4.6074e-06 | scale: 2048.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    991/  5000| tot_loss: 2.2647 | rl_loss: 0.7872 | pt_loss: 1.4775 | pg_loss: 0.3219 | reg_loss: 0.4654 | reward: -0.2666 | rev_kl: 0.8192 | stu_lens: 123.0000 | mixed_lens: 95.5000 | lr: 4.6065e-06 | scale: 2048.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    992/  5000| tot_loss: 2.6017 | rl_loss: 0.7534 | pt_loss: 1.8483 | pg_loss: 0.0213 | reg_loss: 0.7321 | reward: -0.3575 | rev_kl: 0.6578 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6057e-06 | scale: 2048.00 | time: 26.235 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    992/  5000| tot_loss: 2.7537 | rl_loss: 0.9700 | pt_loss: 1.7837 | pg_loss: 0.3242 | reg_loss: 0.6458 | reward: -0.4343 | rev_kl: 0.8427 | stu_lens: 87.0312 | mixed_lens: 93.3594 | lr: 4.6057e-06 | scale: 2048.00 | time: 26.235 | step time: 27.497
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    993/  5000| tot_loss: 2.5663 | rl_loss: 0.6231 | pt_loss: 1.9432 | pg_loss: 0.2354 | reg_loss: 0.3877 | reward: -0.3177 | rev_kl: 0.8169 | stu_lens: 113.5000 | mixed_lens: 63.0000 | lr: 4.6048e-06 | scale: 2048.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    994/  5000| tot_loss: 2.2342 | rl_loss: 0.9658 | pt_loss: 1.2684 | pg_loss: 0.4585 | reg_loss: 0.5073 | reward: 0.0457 | rev_kl: 0.5743 | stu_lens: 87.5000 | mixed_lens: 71.5000 | lr: 4.6039e-06 | scale: 2048.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    995/  5000| tot_loss: 2.0615 | rl_loss: 0.5201 | pt_loss: 1.5414 | pg_loss: 0.1613 | reg_loss: 0.3588 | reward: -0.4710 | rev_kl: 1.4942 | stu_lens: 46.0000 | mixed_lens: 74.5000 | lr: 4.6031e-06 | scale: 2048.00 | time: 26.191 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    996/  5000| tot_loss: 2.6847 | rl_loss: 0.4897 | pt_loss: 2.1950 | pg_loss: 0.1498 | reg_loss: 0.3399 | reward: -0.2113 | rev_kl: 0.8628 | stu_lens: 128.0000 | mixed_lens: 92.5000 | lr: 4.6022e-06 | scale: 2048.00 | time: 26.205 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    997/  5000| tot_loss: 3.2324 | rl_loss: 1.8258 | pt_loss: 1.4066 | pg_loss: 1.4323 | reg_loss: 0.3935 | reward: -0.5674 | rev_kl: 0.2142 | stu_lens: 29.0000 | mixed_lens: 32.5000 | lr: 4.6013e-06 | scale: 2048.00 | time: 26.183 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    998/  5000| tot_loss: 2.0065 | rl_loss: 0.4063 | pt_loss: 1.6002 | pg_loss: 0.0956 | reg_loss: 0.3106 | reward: -0.3628 | rev_kl: 0.7285 | stu_lens: 106.5000 | mixed_lens: 98.5000 | lr: 4.6005e-06 | scale: 2048.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    999/  5000| tot_loss: 3.2682 | rl_loss: 1.3942 | pt_loss: 1.8740 | pg_loss: 0.9428 | reg_loss: 0.4514 | reward: -0.9472 | rev_kl: 0.5639 | stu_lens: 62.5000 | mixed_lens: 28.5000 | lr: 4.5996e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/1000
                                 Evaluation #10                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los distintos tipos de cuarks en     │
│                                       │ física de partículas son los que se  │
│                                       │ encuentran en el modelo estándar de  │
│                                       │ la física de partículas, que         │
│                                       │ consiste en seis quarks, de los que  │
│                                       │ sólo hay dos tipos distintos, el de  │
│                                       │ baja masa y el de alta masa.         │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC (Identity Management and Core │
│                                       │ Services) es un framework que        │
│                                       │ proporciona una manera de integrar y │
│                                       │ gestionar las identidades de         │
│                                       │ usuarios dentro de una organización. │
│                                       │ El IMC incluye una serie de          │
│                                       │ servicios que simplifican la gestión │
│                                       │ de las identidades y permiten que    │
│                                       │ estas se utilicen para lograr        │
│                                       │ objetivos específicos. Por ejemplo,  │
│                                       │ el IMC permite que usuarios logются  │
│                                       │ en diversos sistemas de información  │
│                                       │ de una organización utilizando un    │
│                                       │ único nombre de usuario, y el IMC es │
│                                       │ capaz de manejar el estado de los    │
│                                       │ usuarios                             │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ 1. Cápsula del tiempo de Kiev, 1997. │
│                                       │ Contenido: Instrucciones para abrir  │
│                                       │ la cápsula del tiempo, fechas        │
│                                       │ importantes de la historia de Kiev,  │
│                                       │ imágenes de la ciudad y su entorno.  │
│                                       │ La cápsula fue abierta el 19 de      │
│                                       │ septiembre de 2021.                  │
│                                       │ 2. Cápsula del tiempo de Miami,      │
│                                       │ 2007. Contenido: una lista de 100    │
│                                       │ personas que han configurado el día  │
│                                       │ de hoy, imágenes de Miami,           │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.665 | exact_match: 0.000 | rev_kl: 0.971 | lens: 96.550 | pt_loss: 1.746 | lm_loss: 1.877 | kd_loss: 1.616 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1000/  5000| tot_loss: 2.5756 | rl_loss: 0.8177 | pt_loss: 1.7578 | pg_loss: 0.4074 | reg_loss: 0.4103 | reward: -0.3655 | rev_kl: 0.8565 | stu_lens: 108.5000 | mixed_lens: 66.0000 | lr: 4.5987e-06 | scale: 2048.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1001/  5000| tot_loss: 2.4594 | rl_loss: 0.5183 | pt_loss: 1.9411 | pg_loss: 0.1278 | reg_loss: 0.3906 | reward: -0.1358 | rev_kl: 0.9002 | stu_lens: 128.0000 | mixed_lens: 103.0000 | lr: 4.5978e-06 | scale: 2048.00 | time: 26.376 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1002/  5000| tot_loss: 2.1183 | rl_loss: 0.8243 | pt_loss: 1.2939 | pg_loss: 0.2796 | reg_loss: 0.5447 | reward: -0.7161 | rev_kl: 1.0665 | stu_lens: 69.5000 | mixed_lens: 82.5000 | lr: 4.5970e-06 | scale: 2048.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1003/  5000| tot_loss: 2.3517 | rl_loss: 0.5684 | pt_loss: 1.7833 | pg_loss: 0.2250 | reg_loss: 0.3434 | reward: -0.1712 | rev_kl: 0.7842 | stu_lens: 81.5000 | mixed_lens: 91.5000 | lr: 4.5961e-06 | scale: 2048.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1004/  5000| tot_loss: 2.2300 | rl_loss: 0.4965 | pt_loss: 1.7335 | pg_loss: -0.0116 | reg_loss: 0.5081 | reward: -0.1819 | rev_kl: 1.0616 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5952e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1005/  5000| tot_loss: 3.1274 | rl_loss: 1.3057 | pt_loss: 1.8217 | pg_loss: 0.6395 | reg_loss: 0.6662 | reward: -1.1296 | rev_kl: 1.1087 | stu_lens: 83.0000 | mixed_lens: 50.0000 | lr: 4.5943e-06 | scale: 2048.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1006/  5000| tot_loss: 2.0541 | rl_loss: 0.5732 | pt_loss: 1.4809 | pg_loss: 0.0248 | reg_loss: 0.5484 | reward: -0.1979 | rev_kl: 0.7355 | stu_lens: 113.0000 | mixed_lens: 125.0000 | lr: 4.5935e-06 | scale: 2048.00 | time: 26.178 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1007/  5000| tot_loss: 2.7039 | rl_loss: 0.5220 | pt_loss: 2.1819 | pg_loss: 0.0051 | reg_loss: 0.5169 | reward: -0.2555 | rev_kl: 0.7765 | stu_lens: 128.0000 | mixed_lens: 126.0000 | lr: 4.5926e-06 | scale: 2048.00 | time: 26.220 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1008/  5000| tot_loss: 2.4252 | rl_loss: 0.6813 | pt_loss: 1.7439 | pg_loss: 0.4086 | reg_loss: 0.2727 | reward: -0.6727 | rev_kl: 0.8224 | stu_lens: 72.5000 | mixed_lens: 76.5000 | lr: 4.5917e-06 | scale: 2048.00 | time: 26.210 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1008/  5000| tot_loss: 2.4161 | rl_loss: 0.7014 | pt_loss: 1.7146 | pg_loss: 0.2451 | reg_loss: 0.4563 | reward: -0.4333 | rev_kl: 0.8512 | stu_lens: 88.5469 | mixed_lens: 90.2656 | lr: 4.5917e-06 | scale: 2048.00 | time: 26.210 | step time: 27.523
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1009/  5000| tot_loss: 2.8101 | rl_loss: 1.2896 | pt_loss: 1.5205 | pg_loss: 0.8819 | reg_loss: 0.4076 | reward: -0.5940 | rev_kl: 0.5319 | stu_lens: 53.5000 | mixed_lens: 43.5000 | lr: 4.5908e-06 | scale: 2048.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1010/  5000| tot_loss: 2.0111 | rl_loss: 0.5644 | pt_loss: 1.4468 | pg_loss: 0.2012 | reg_loss: 0.3632 | reward: -0.2516 | rev_kl: 0.8359 | stu_lens: 128.0000 | mixed_lens: 92.5000 | lr: 4.5900e-06 | scale: 2048.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1011/  5000| tot_loss: 1.7578 | rl_loss: 0.2689 | pt_loss: 1.4889 | pg_loss: -0.0230 | reg_loss: 0.2918 | reward: -0.1288 | rev_kl: 0.9859 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5891e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1012/  5000| tot_loss: 2.0006 | rl_loss: 0.3732 | pt_loss: 1.6274 | pg_loss: 0.0034 | reg_loss: 0.3698 | reward: -0.1603 | rev_kl: 1.1369 | stu_lens: 124.0000 | mixed_lens: 128.0000 | lr: 4.5882e-06 | scale: 2048.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1013/  5000| tot_loss: 2.4526 | rl_loss: 0.7046 | pt_loss: 1.7480 | pg_loss: 0.2494 | reg_loss: 0.4552 | reward: -0.5881 | rev_kl: 1.5529 | stu_lens: 71.5000 | mixed_lens: 95.5000 | lr: 4.5873e-06 | scale: 2048.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1014/  5000| tot_loss: 2.3586 | rl_loss: 0.4168 | pt_loss: 1.9418 | pg_loss: 0.0002 | reg_loss: 0.4166 | reward: -0.1423 | rev_kl: 0.8629 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5864e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1015/  5000| tot_loss: 2.3070 | rl_loss: 0.4595 | pt_loss: 1.8475 | pg_loss: 0.0531 | reg_loss: 0.4064 | reward: -0.3005 | rev_kl: 0.6673 | stu_lens: 82.5000 | mixed_lens: 112.5000 | lr: 4.5855e-06 | scale: 2048.00 | time: 26.205 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1016/  5000| tot_loss: 2.8765 | rl_loss: 0.7446 | pt_loss: 2.1319 | pg_loss: 0.4165 | reg_loss: 0.3281 | reward: -0.6474 | rev_kl: 0.7912 | stu_lens: 72.5000 | mixed_lens: 76.5000 | lr: 4.5847e-06 | scale: 2048.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1017/  5000| tot_loss: 1.9620 | rl_loss: 0.3903 | pt_loss: 1.5717 | pg_loss: -0.0146 | reg_loss: 0.4048 | reward: -0.3507 | rev_kl: 0.9547 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5838e-06 | scale: 2048.00 | time: 26.177 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1018/  5000| tot_loss: 2.3066 | rl_loss: 0.5156 | pt_loss: 1.7910 | pg_loss: 0.1552 | reg_loss: 0.3604 | reward: -0.0461 | rev_kl: 0.6113 | stu_lens: 85.5000 | mixed_lens: 91.5000 | lr: 4.5829e-06 | scale: 2048.00 | time: 26.199 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1019/  5000| tot_loss: 1.9987 | rl_loss: 0.5252 | pt_loss: 1.4735 | pg_loss: 0.1615 | reg_loss: 0.3637 | reward: -0.3369 | rev_kl: 0.6023 | stu_lens: 72.0000 | mixed_lens: 78.0000 | lr: 4.5820e-06 | scale: 2048.00 | time: 26.195 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1020/  5000| tot_loss: 2.6230 | rl_loss: 1.0108 | pt_loss: 1.6122 | pg_loss: 0.5707 | reg_loss: 0.4401 | reward: -0.5127 | rev_kl: 0.6127 | stu_lens: 55.5000 | mixed_lens: 72.0000 | lr: 4.5811e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1021/  5000| tot_loss: 2.3337 | rl_loss: 0.5330 | pt_loss: 1.8007 | pg_loss: 0.1982 | reg_loss: 0.3348 | reward: -0.3097 | rev_kl: 0.5772 | stu_lens: 106.5000 | mixed_lens: 98.5000 | lr: 4.5802e-06 | scale: 2048.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1022/  5000| tot_loss: 2.5833 | rl_loss: 0.5857 | pt_loss: 1.9976 | pg_loss: 0.1378 | reg_loss: 0.4478 | reward: -0.3455 | rev_kl: 0.5571 | stu_lens: 128.0000 | mixed_lens: 101.0000 | lr: 4.5793e-06 | scale: 2048.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1023/  5000| tot_loss: 2.0966 | rl_loss: 0.3713 | pt_loss: 1.7253 | pg_loss: -0.0117 | reg_loss: 0.3830 | reward: -0.2846 | rev_kl: 0.6279 | stu_lens: 82.0000 | mixed_lens: 128.0000 | lr: 4.5785e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1024/  5000| tot_loss: 1.9410 | rl_loss: 0.6457 | pt_loss: 1.2953 | pg_loss: 0.3749 | reg_loss: 0.2708 | reward: -0.5867 | rev_kl: 0.6946 | stu_lens: 74.5000 | mixed_lens: 75.5000 | lr: 4.5776e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1024/  5000| tot_loss: 2.3782 | rl_loss: 0.6700 | pt_loss: 1.7081 | pg_loss: 0.2834 | reg_loss: 0.3866 | reward: -0.4444 | rev_kl: 0.8387 | stu_lens: 85.6875 | mixed_lens: 90.6406 | lr: 4.5776e-06 | scale: 2048.00 | time: 26.265 | step time: 27.512
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1025/  5000| tot_loss: 2.8376 | rl_loss: 0.9819 | pt_loss: 1.8557 | pg_loss: 0.7511 | reg_loss: 0.2308 | reward: -0.3924 | rev_kl: 0.7646 | stu_lens: 62.5000 | mixed_lens: 36.0000 | lr: 4.5767e-06 | scale: 2048.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1026/  5000| tot_loss: 2.5469 | rl_loss: 1.0857 | pt_loss: 1.4612 | pg_loss: 0.0456 | reg_loss: 1.0402 | reward: -0.3130 | rev_kl: 0.8031 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5758e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1027/  5000| tot_loss: 3.2260 | rl_loss: 1.2685 | pt_loss: 1.9576 | pg_loss: 0.0745 | reg_loss: 1.1940 | reward: -0.1705 | rev_kl: 0.8464 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5749e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1028/  5000| tot_loss: 3.1354 | rl_loss: 1.1177 | pt_loss: 2.0178 | pg_loss: 0.0693 | reg_loss: 1.0484 | reward: -0.0986 | rev_kl: 0.6858 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5740e-06 | scale: 2048.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1029/  5000| tot_loss: 2.4814 | rl_loss: 0.8525 | pt_loss: 1.6289 | pg_loss: 0.0531 | reg_loss: 0.7994 | reward: -0.1910 | rev_kl: 0.5437 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5731e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1030/  5000| tot_loss: 3.0246 | rl_loss: 1.2294 | pt_loss: 1.7952 | pg_loss: 0.1731 | reg_loss: 1.0562 | reward: -0.1009 | rev_kl: 0.9231 | stu_lens: 60.5000 | mixed_lens: 110.5000 | lr: 4.5722e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1031/  5000| tot_loss: 4.5087 | rl_loss: 2.4464 | pt_loss: 2.0623 | pg_loss: 1.4141 | reg_loss: 1.0323 | reward: -0.8372 | rev_kl: 0.7960 | stu_lens: 98.5000 | mixed_lens: 29.0000 | lr: 4.5713e-06 | scale: 2048.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1032/  5000| tot_loss: 2.6541 | rl_loss: 1.2393 | pt_loss: 1.4148 | pg_loss: 0.3621 | reg_loss: 0.8772 | reward: -0.2907 | rev_kl: 0.7125 | stu_lens: 91.5000 | mixed_lens: 85.5000 | lr: 4.5704e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1033/  5000| tot_loss: 2.9909 | rl_loss: 1.1120 | pt_loss: 1.8789 | pg_loss: 0.3540 | reg_loss: 0.7580 | reward: -1.5446 | rev_kl: 1.1833 | stu_lens: 66.5000 | mixed_lens: 66.5000 | lr: 4.5695e-06 | scale: 2048.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1034/  5000| tot_loss: 2.8253 | rl_loss: 1.0525 | pt_loss: 1.7728 | pg_loss: 0.1694 | reg_loss: 0.8831 | reward: -0.1660 | rev_kl: 1.4298 | stu_lens: 128.0000 | mixed_lens: 110.0000 | lr: 4.5686e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1035/  5000| tot_loss: 2.8613 | rl_loss: 1.1681 | pt_loss: 1.6932 | pg_loss: 0.2669 | reg_loss: 0.9012 | reward: -0.4075 | rev_kl: 0.6387 | stu_lens: 91.5000 | mixed_lens: 84.5000 | lr: 4.5677e-06 | scale: 2048.00 | time: 26.204 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1036/  5000| tot_loss: 3.3754 | rl_loss: 1.5237 | pt_loss: 1.8517 | pg_loss: 0.3133 | reg_loss: 1.2103 | reward: -0.4406 | rev_kl: 0.8135 | stu_lens: 106.5000 | mixed_lens: 82.0000 | lr: 4.5668e-06 | scale: 2048.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1037/  5000| tot_loss: 2.9405 | rl_loss: 1.3596 | pt_loss: 1.5809 | pg_loss: 0.2457 | reg_loss: 1.1139 | reward: -0.2575 | rev_kl: 0.7235 | stu_lens: 64.5000 | mixed_lens: 109.5000 | lr: 4.5659e-06 | scale: 2048.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1038/  5000| tot_loss: 2.7180 | rl_loss: 0.9993 | pt_loss: 1.7187 | pg_loss: 0.0328 | reg_loss: 0.9665 | reward: -0.2328 | rev_kl: 1.0535 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5650e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1039/  5000| tot_loss: 3.5224 | rl_loss: 1.7039 | pt_loss: 1.8185 | pg_loss: 1.0146 | reg_loss: 0.6893 | reward: -0.6150 | rev_kl: 0.8289 | stu_lens: 66.5000 | mixed_lens: 43.5000 | lr: 4.5641e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1040/  5000| tot_loss: 2.7780 | rl_loss: 0.9523 | pt_loss: 1.8257 | pg_loss: 0.0642 | reg_loss: 0.8882 | reward: -0.1028 | rev_kl: 0.9896 | stu_lens: 70.0000 | mixed_lens: 128.0000 | lr: 4.5632e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1040/  5000| tot_loss: 2.9623 | rl_loss: 1.1992 | pt_loss: 1.7631 | pg_loss: 0.2713 | reg_loss: 0.9279 | reward: -0.3256 | rev_kl: 0.8912 | stu_lens: 94.8281 | mixed_lens: 100.1719 | lr: 4.5632e-06 | scale: 2048.00 | time: 26.290 | step time: 27.539
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1041/  5000| tot_loss: 2.8790 | rl_loss: 1.2923 | pt_loss: 1.5867 | pg_loss: 0.4403 | reg_loss: 0.8519 | reward: -1.3057 | rev_kl: 0.8950 | stu_lens: 67.5000 | mixed_lens: 67.5000 | lr: 4.5623e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1042/  5000| tot_loss: 2.1808 | rl_loss: 0.6224 | pt_loss: 1.5584 | pg_loss: 0.0185 | reg_loss: 0.6038 | reward: -0.1411 | rev_kl: 0.8916 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5614e-06 | scale: 2048.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1043/  5000| tot_loss: 2.0564 | rl_loss: 0.6097 | pt_loss: 1.4466 | pg_loss: -0.0188 | reg_loss: 0.6285 | reward: -0.1053 | rev_kl: 0.6550 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5605e-06 | scale: 2048.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1044/  5000| tot_loss: 2.9205 | rl_loss: 1.2155 | pt_loss: 1.7050 | pg_loss: 0.4191 | reg_loss: 0.7964 | reward: -0.2941 | rev_kl: 1.0539 | stu_lens: 98.5000 | mixed_lens: 77.5000 | lr: 4.5596e-06 | scale: 2048.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1045/  5000| tot_loss: 2.4727 | rl_loss: 0.8931 | pt_loss: 1.5796 | pg_loss: 0.3866 | reg_loss: 0.5066 | reward: -1.4906 | rev_kl: 1.7063 | stu_lens: 66.5000 | mixed_lens: 66.5000 | lr: 4.5586e-06 | scale: 2048.00 | time: 26.180 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1046/  5000| tot_loss: 2.9774 | rl_loss: 1.1146 | pt_loss: 1.8628 | pg_loss: 0.4155 | reg_loss: 0.6991 | reward: -0.2932 | rev_kl: 0.7634 | stu_lens: 108.0000 | mixed_lens: 91.5000 | lr: 4.5577e-06 | scale: 2048.00 | time: 26.211 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1047/  5000| tot_loss: 2.8968 | rl_loss: 1.1581 | pt_loss: 1.7387 | pg_loss: 0.4460 | reg_loss: 0.7121 | reward: -0.3970 | rev_kl: 0.6586 | stu_lens: 48.0000 | mixed_lens: 84.5000 | lr: 4.5568e-06 | scale: 2048.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1048/  5000| tot_loss: 1.9828 | rl_loss: 0.8178 | pt_loss: 1.1650 | pg_loss: 0.1943 | reg_loss: 0.6235 | reward: -0.1645 | rev_kl: 1.1444 | stu_lens: 92.5000 | mixed_lens: 93.5000 | lr: 4.5559e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1049/  5000| tot_loss: 2.5983 | rl_loss: 0.9874 | pt_loss: 1.6108 | pg_loss: 0.4118 | reg_loss: 0.5757 | reward: -0.7635 | rev_kl: 0.5696 | stu_lens: 77.0000 | mixed_lens: 68.0000 | lr: 4.5550e-06 | scale: 2048.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1050/  5000| tot_loss: 2.9725 | rl_loss: 1.1194 | pt_loss: 1.8531 | pg_loss: 0.3267 | reg_loss: 0.7928 | reward: -0.7060 | rev_kl: 0.7839 | stu_lens: 102.0000 | mixed_lens: 78.0000 | lr: 4.5541e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1051/  5000| tot_loss: 2.4633 | rl_loss: 0.5914 | pt_loss: 1.8719 | pg_loss: -0.0320 | reg_loss: 0.6234 | reward: -0.2508 | rev_kl: 0.7140 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5532e-06 | scale: 2048.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1052/  5000| tot_loss: 2.5205 | rl_loss: 0.7295 | pt_loss: 1.7910 | pg_loss: 0.2462 | reg_loss: 0.4833 | reward: -0.1527 | rev_kl: 0.9532 | stu_lens: 71.5000 | mixed_lens: 76.5000 | lr: 4.5523e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1053/  5000| tot_loss: 3.2025 | rl_loss: 1.1417 | pt_loss: 2.0607 | pg_loss: 0.1768 | reg_loss: 0.9650 | reward: -0.4264 | rev_kl: 0.9664 | stu_lens: 128.0000 | mixed_lens: 108.5000 | lr: 4.5513e-06 | scale: 2048.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1054/  5000| tot_loss: 2.6410 | rl_loss: 0.6287 | pt_loss: 2.0123 | pg_loss: 0.1206 | reg_loss: 0.5080 | reward: -0.3036 | rev_kl: 0.7338 | stu_lens: 106.5000 | mixed_lens: 101.5000 | lr: 4.5504e-06 | scale: 2048.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1055/  5000| tot_loss: 3.2884 | rl_loss: 1.1941 | pt_loss: 2.0943 | pg_loss: 0.3120 | reg_loss: 0.8821 | reward: -0.3873 | rev_kl: 1.0816 | stu_lens: 123.0000 | mixed_lens: 93.5000 | lr: 4.5495e-06 | scale: 2048.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1056/  5000| tot_loss: 2.3130 | rl_loss: 0.6102 | pt_loss: 1.7028 | pg_loss: 0.0965 | reg_loss: 0.5137 | reward: -0.2029 | rev_kl: 0.6428 | stu_lens: 128.0000 | mixed_lens: 111.5000 | lr: 4.5486e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1056/  5000| tot_loss: 2.6657 | rl_loss: 0.9470 | pt_loss: 1.7186 | pg_loss: 0.2824 | reg_loss: 0.6646 | reward: -0.3690 | rev_kl: 0.9137 | stu_lens: 93.2500 | mixed_lens: 94.0156 | lr: 4.5486e-06 | scale: 2048.00 | time: 26.255 | step time: 27.530
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1057/  5000| tot_loss: 3.1116 | rl_loss: 0.9729 | pt_loss: 2.1387 | pg_loss: 0.2640 | reg_loss: 0.7089 | reward: -0.5196 | rev_kl: 0.8477 | stu_lens: 92.5000 | mixed_lens: 85.5000 | lr: 4.5477e-06 | scale: 2048.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1058/  5000| tot_loss: 2.3769 | rl_loss: 0.6601 | pt_loss: 1.7168 | pg_loss: 0.1512 | reg_loss: 0.5089 | reward: -0.2285 | rev_kl: 0.5970 | stu_lens: 108.0000 | mixed_lens: 109.5000 | lr: 4.5468e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1059/  5000| tot_loss: 2.5545 | rl_loss: 0.4030 | pt_loss: 2.1516 | pg_loss: 0.0128 | reg_loss: 0.3901 | reward: -0.1385 | rev_kl: 0.6306 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5458e-06 | scale: 2048.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1060/  5000| tot_loss: 1.9086 | rl_loss: 0.4443 | pt_loss: 1.4643 | pg_loss: -0.0165 | reg_loss: 0.4608 | reward: -0.1325 | rev_kl: 0.5756 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5449e-06 | scale: 2048.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1061/  5000| tot_loss: 3.0403 | rl_loss: 1.1250 | pt_loss: 1.9153 | pg_loss: 0.4397 | reg_loss: 0.6853 | reward: -1.2582 | rev_kl: 0.8473 | stu_lens: 18.5000 | mixed_lens: 67.5000 | lr: 4.5440e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1062/  5000| tot_loss: 1.5945 | rl_loss: 0.5041 | pt_loss: 1.0904 | pg_loss: -0.0133 | reg_loss: 0.5174 | reward: -0.1033 | rev_kl: 0.6879 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5431e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1063/  5000| tot_loss: 2.6147 | rl_loss: 0.9655 | pt_loss: 1.6492 | pg_loss: 0.5088 | reg_loss: 0.4567 | reward: -0.2642 | rev_kl: 1.2466 | stu_lens: 71.5000 | mixed_lens: 76.5000 | lr: 4.5421e-06 | scale: 2048.00 | time: 26.207 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1064/  5000| tot_loss: 2.1722 | rl_loss: 0.7600 | pt_loss: 1.4122 | pg_loss: 0.2859 | reg_loss: 0.4741 | reward: -0.4798 | rev_kl: 0.8193 | stu_lens: 128.0000 | mixed_lens: 86.0000 | lr: 4.5412e-06 | scale: 2048.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1065/  5000| tot_loss: 2.2387 | rl_loss: 0.8365 | pt_loss: 1.4022 | pg_loss: 0.2963 | reg_loss: 0.5402 | reward: 0.4678 | rev_kl: 0.7163 | stu_lens: 47.0000 | mixed_lens: 32.0000 | lr: 4.5403e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1066/  5000| tot_loss: 1.8242 | rl_loss: 0.6942 | pt_loss: 1.1300 | pg_loss: 0.4581 | reg_loss: 0.2361 | reward: -1.5882 | rev_kl: 0.9851 | stu_lens: 45.0000 | mixed_lens: 40.0000 | lr: 4.5394e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1067/  5000| tot_loss: 2.4007 | rl_loss: 0.7941 | pt_loss: 1.6066 | pg_loss: 0.2187 | reg_loss: 0.5754 | reward: -0.2305 | rev_kl: 0.9990 | stu_lens: 81.5000 | mixed_lens: 103.0000 | lr: 4.5384e-06 | scale: 2048.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1068/  5000| tot_loss: 2.0265 | rl_loss: 0.5298 | pt_loss: 1.4967 | pg_loss: -0.0093 | reg_loss: 0.5392 | reward: -0.2166 | rev_kl: 1.0313 | stu_lens: 114.5000 | mixed_lens: 128.0000 | lr: 4.5375e-06 | scale: 2048.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1069/  5000| tot_loss: 2.5308 | rl_loss: 0.4333 | pt_loss: 2.0976 | pg_loss: -0.0220 | reg_loss: 0.4553 | reward: -0.0917 | rev_kl: 1.3825 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5366e-06 | scale: 2048.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1070/  5000| tot_loss: 2.3428 | rl_loss: 0.6155 | pt_loss: 1.7273 | pg_loss: 0.2002 | reg_loss: 0.4152 | reward: -0.3903 | rev_kl: 0.8878 | stu_lens: 88.0000 | mixed_lens: 111.5000 | lr: 4.5357e-06 | scale: 2048.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1071/  5000| tot_loss: 1.7823 | rl_loss: 0.3399 | pt_loss: 1.4425 | pg_loss: -0.0141 | reg_loss: 0.3540 | reward: -0.1520 | rev_kl: 0.6261 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5347e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1072/  5000| tot_loss: 1.7117 | rl_loss: 0.5695 | pt_loss: 1.1421 | pg_loss: -0.0041 | reg_loss: 0.5736 | reward: -0.1589 | rev_kl: 1.0525 | stu_lens: 84.5000 | mixed_lens: 128.0000 | lr: 4.5338e-06 | scale: 2048.00 | time: 26.290 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1072/  5000| tot_loss: 2.3277 | rl_loss: 0.7025 | pt_loss: 1.6252 | pg_loss: 0.2023 | reg_loss: 0.5002 | reward: -0.3583 | rev_kl: 0.8924 | stu_lens: 93.7031 | mixed_lens: 98.8281 | lr: 4.5338e-06 | scale: 2048.00 | time: 26.290 | step time: 27.542
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1073/  5000| tot_loss: 2.8294 | rl_loss: 0.8900 | pt_loss: 1.9393 | pg_loss: 0.4211 | reg_loss: 0.4689 | reward: -0.2944 | rev_kl: 0.8709 | stu_lens: 101.5000 | mixed_lens: 75.0000 | lr: 4.5329e-06 | scale: 2048.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1074/  5000| tot_loss: 3.3824 | rl_loss: 1.3696 | pt_loss: 2.0128 | pg_loss: 1.0257 | reg_loss: 0.3439 | reward: -0.9326 | rev_kl: 0.8491 | stu_lens: 77.0000 | mixed_lens: 31.0000 | lr: 4.5319e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1075/  5000| tot_loss: 2.2595 | rl_loss: 0.3579 | pt_loss: 1.9016 | pg_loss: -0.0200 | reg_loss: 0.3779 | reward: -0.1770 | rev_kl: 0.7814 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5310e-06 | scale: 2048.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1076/  5000| tot_loss: 2.2409 | rl_loss: 0.4331 | pt_loss: 1.8078 | pg_loss: -0.0146 | reg_loss: 0.4477 | reward: -0.1922 | rev_kl: 1.0152 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5301e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1077/  5000| tot_loss: 2.4444 | rl_loss: 0.6209 | pt_loss: 1.8235 | pg_loss: 0.2448 | reg_loss: 0.3761 | reward: 0.3517 | rev_kl: 1.0943 | stu_lens: 33.5000 | mixed_lens: 71.5000 | lr: 4.5291e-06 | scale: 2048.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1078/  5000| tot_loss: 2.3454 | rl_loss: 0.4605 | pt_loss: 1.8848 | pg_loss: 0.0610 | reg_loss: 0.3995 | reward: -0.2351 | rev_kl: 1.3438 | stu_lens: 109.5000 | mixed_lens: 110.5000 | lr: 4.5282e-06 | scale: 2048.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1079/  5000| tot_loss: 2.5414 | rl_loss: 0.7377 | pt_loss: 1.8036 | pg_loss: 0.3589 | reg_loss: 0.3788 | reward: -0.6616 | rev_kl: 0.6971 | stu_lens: 102.0000 | mixed_lens: 78.0000 | lr: 4.5272e-06 | scale: 2048.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1080/  5000| tot_loss: 2.3357 | rl_loss: 0.7941 | pt_loss: 1.5416 | pg_loss: 0.2946 | reg_loss: 0.4994 | reward: -0.2866 | rev_kl: 0.6806 | stu_lens: 91.5000 | mixed_lens: 85.5000 | lr: 4.5263e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1081/  5000| tot_loss: 2.4015 | rl_loss: 0.6191 | pt_loss: 1.7824 | pg_loss: 0.1509 | reg_loss: 0.4681 | reward: -0.5257 | rev_kl: 0.9035 | stu_lens: 77.0000 | mixed_lens: 108.5000 | lr: 4.5254e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1082/  5000| tot_loss: 2.4384 | rl_loss: 0.5028 | pt_loss: 1.9355 | pg_loss: 0.0330 | reg_loss: 0.4699 | reward: -0.0276 | rev_kl: 1.0314 | stu_lens: 69.0000 | mixed_lens: 114.5000 | lr: 4.5244e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1083/  5000| tot_loss: 2.4906 | rl_loss: 0.7562 | pt_loss: 1.7344 | pg_loss: 0.2393 | reg_loss: 0.5169 | reward: -0.5841 | rev_kl: 1.3892 | stu_lens: 68.5000 | mixed_lens: 87.0000 | lr: 4.5235e-06 | scale: 2048.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1084/  5000| tot_loss: 2.1410 | rl_loss: 0.8087 | pt_loss: 1.3323 | pg_loss: 0.3268 | reg_loss: 0.4818 | reward: -0.3873 | rev_kl: 1.0816 | stu_lens: 123.0000 | mixed_lens: 93.5000 | lr: 4.5225e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1085/  5000| tot_loss: 3.3933 | rl_loss: 1.3987 | pt_loss: 1.9946 | pg_loss: 1.2352 | reg_loss: 0.1635 | reward: -0.7113 | rev_kl: 0.6601 | stu_lens: 62.0000 | mixed_lens: 27.5000 | lr: 4.5216e-06 | scale: 2048.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1086/  5000| tot_loss: 2.4027 | rl_loss: 0.4638 | pt_loss: 1.9389 | pg_loss: 0.0789 | reg_loss: 0.3849 | reward: -0.2301 | rev_kl: 0.8131 | stu_lens: 111.0000 | mixed_lens: 116.5000 | lr: 4.5207e-06 | scale: 2048.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1087/  5000| tot_loss: 2.9240 | rl_loss: 0.9813 | pt_loss: 1.9427 | pg_loss: 0.4934 | reg_loss: 0.4879 | reward: -0.2375 | rev_kl: 0.9048 | stu_lens: 58.0000 | mixed_lens: 75.0000 | lr: 4.5197e-06 | scale: 2048.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1088/  5000| tot_loss: 2.8491 | rl_loss: 0.8551 | pt_loss: 1.9940 | pg_loss: 0.4029 | reg_loss: 0.4522 | reward: -1.3718 | rev_kl: 0.9366 | stu_lens: 67.5000 | mixed_lens: 67.5000 | lr: 4.5188e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1088/  5000| tot_loss: 2.4715 | rl_loss: 0.6367 | pt_loss: 1.8349 | pg_loss: 0.2326 | reg_loss: 0.4040 | reward: -0.3468 | rev_kl: 0.9001 | stu_lens: 93.6562 | mixed_lens: 95.7500 | lr: 4.5188e-06 | scale: 2048.00 | time: 26.301 | step time: 27.537
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1089/  5000| tot_loss: 2.2950 | rl_loss: 0.4274 | pt_loss: 1.8676 | pg_loss: 0.0069 | reg_loss: 0.4205 | reward: -0.2981 | rev_kl: 1.2953 | stu_lens: 114.5000 | mixed_lens: 128.0000 | lr: 4.5178e-06 | scale: 2048.00 | time: 26.201 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1090/  5000| tot_loss: 3.0204 | rl_loss: 1.2213 | pt_loss: 1.7991 | pg_loss: 0.2738 | reg_loss: 0.9474 | reward: -1.7729 | rev_kl: 0.6025 | stu_lens: 63.0000 | mixed_lens: 66.0000 | lr: 4.5169e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1091/  5000| tot_loss: 2.5269 | rl_loss: 1.0156 | pt_loss: 1.5114 | pg_loss: 0.0583 | reg_loss: 0.9573 | reward: -0.2292 | rev_kl: 1.0036 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5159e-06 | scale: 2048.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1092/  5000| tot_loss: 3.1987 | rl_loss: 1.2699 | pt_loss: 1.9289 | pg_loss: 0.1997 | reg_loss: 1.0701 | reward: -0.1184 | rev_kl: 0.8124 | stu_lens: 115.0000 | mixed_lens: 100.0000 | lr: 4.5150e-06 | scale: 2048.00 | time: 26.199 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1093/  5000| tot_loss: 3.0924 | rl_loss: 1.3812 | pt_loss: 1.7111 | pg_loss: 0.4961 | reg_loss: 0.8851 | reward: -1.0612 | rev_kl: 1.4452 | stu_lens: 48.5000 | mixed_lens: 67.0000 | lr: 4.5140e-06 | scale: 2048.00 | time: 26.206 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1094/  5000| tot_loss: 2.4482 | rl_loss: 0.6769 | pt_loss: 1.7714 | pg_loss: 0.0468 | reg_loss: 0.6301 | reward: -0.2914 | rev_kl: 0.9691 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5131e-06 | scale: 2048.00 | time: 26.177 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1095/  5000| tot_loss: 1.9107 | rl_loss: 0.6392 | pt_loss: 1.2715 | pg_loss: 0.0512 | reg_loss: 0.5880 | reward: -0.1268 | rev_kl: 0.5395 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5121e-06 | scale: 2048.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1096/  5000| tot_loss: 2.6815 | rl_loss: 1.1010 | pt_loss: 1.5805 | pg_loss: 0.1324 | reg_loss: 0.9687 | reward: -0.0558 | rev_kl: 1.2281 | stu_lens: 67.0000 | mixed_lens: 105.0000 | lr: 4.5112e-06 | scale: 2048.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1097/  5000| tot_loss: 2.9036 | rl_loss: 1.1351 | pt_loss: 1.7685 | pg_loss: 0.0482 | reg_loss: 1.0868 | reward: -0.1467 | rev_kl: 1.0507 | stu_lens: 81.5000 | mixed_lens: 128.0000 | lr: 4.5102e-06 | scale: 2048.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1098/  5000| tot_loss: 2.9521 | rl_loss: 1.1078 | pt_loss: 1.8443 | pg_loss: 0.0794 | reg_loss: 1.0284 | reward: -0.1184 | rev_kl: 0.8889 | stu_lens: 111.5000 | mixed_lens: 128.0000 | lr: 4.5093e-06 | scale: 2048.00 | time: 26.200 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1099/  5000| tot_loss: 3.0407 | rl_loss: 1.0904 | pt_loss: 1.9503 | pg_loss: 0.0826 | reg_loss: 1.0077 | reward: -0.1793 | rev_kl: 0.9359 | stu_lens: 113.0000 | mixed_lens: 119.5000 | lr: 4.5083e-06 | scale: 2048.00 | time: 26.215 | step time: 0.000
                                 Evaluation #11                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son quarks que pertenecen │
│                                       │ a la familia de cuarks arriba de la  │
│                                       │ familia de quarks conocida como      │
│                                       │ cuarks barios. Los cuarks barios son │
│                                       │ tres: el cuark up, el cuark down y   │
│                                       │ el cuark strange. Los cuarks arriba  │
│                                       │ de la familia de quarks barios son   │
│                                       │ los llamados cuarks leptones, que    │
│                                       │ son tres: el cuark electron, el      │
│                                       │ cuark muon y el cuark tau. Los       │
│                                       │ cuarks arriba de la familia de       │
│                                       │ quarks que pertenecen al cuark up es │
│                                       │ el cuark charm, y los de la          │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es un acrónimo de Imán de     │
│                                       │ Corriente (Magnetic Current          │
│                                       │ Inductor), es una pequeña bobina de  │
│                                       │ ángulo recto de alambre de 1 m de    │
│                                       │ largo, con un imán de core de        │
│                                       │ hierro. Su utilidad es servir de     │
│                                       │ indicador de velocidad de un motor   │
│                                       │ eléctrico, ya que si se aplica una   │
│                                       │ corriente eléctrica a través del     │
│                                       │ imán, éste se empuja hacia delante y │
│                                       │ produce una fuerza de empuje que     │
│                                       │ equivale a la corriente que está     │
│                                       │ soport                               │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ 1. Cápsula del tiempo de Tutankamen: │
│                                       │ 1323 a. C., contenido desconocido,   │
│                                       │ abierta en 1923                      │
│                                       │ 2. Cápsula del tiempo de Senedj:     │
│                                       │ 1079 a. C., contenido desconocido,   │
│                                       │ abierta en 2019                      │
│                                       │ 3. Cápsula del tiempo de Roanoke:    │
│                                       │ 1590, contenido desconocido, abierta │
│                                       │ en 1996                              │
│                                       │ 4. Cápsula del tiempo de Stepnor:    │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.358 | exact_match: 0.000 | rev_kl: 1.075 | lens: 110.388 | pt_loss: 1.746 | lm_loss: 1.878 | kd_loss: 1.614 
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1100/  5000| tot_loss: 3.7163 | rl_loss: 1.9162 | pt_loss: 1.8001 | pg_loss: 0.5844 | reg_loss: 1.3318 | reward: -1.3097 | rev_kl: 0.6164 | stu_lens: 57.0000 | mixed_lens: 72.0000 | lr: 4.5074e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1101/  5000| tot_loss: 2.9455 | rl_loss: 1.2064 | pt_loss: 1.7391 | pg_loss: 0.1492 | reg_loss: 1.0572 | reward: -0.1693 | rev_kl: 0.9822 | stu_lens: 122.0000 | mixed_lens: 111.5000 | lr: 4.5064e-06 | scale: 2048.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1102/  5000| tot_loss: 2.8369 | rl_loss: 0.9438 | pt_loss: 1.8931 | pg_loss: 0.0327 | reg_loss: 0.9110 | reward: -0.0740 | rev_kl: 0.7095 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5054e-06 | scale: 2048.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1103/  5000| tot_loss: 3.1059 | rl_loss: 1.3539 | pt_loss: 1.7520 | pg_loss: 0.3548 | reg_loss: 0.9990 | reward: -0.1610 | rev_kl: 1.0030 | stu_lens: 82.5000 | mixed_lens: 94.0000 | lr: 4.5045e-06 | scale: 2048.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1104/  5000| tot_loss: 4.2199 | rl_loss: 2.3013 | pt_loss: 1.9186 | pg_loss: 0.9338 | reg_loss: 1.3676 | reward: -0.8921 | rev_kl: 0.6404 | stu_lens: 33.0000 | mixed_lens: 49.0000 | lr: 4.5035e-06 | scale: 2048.00 | time: 26.261 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1104/  5000| tot_loss: 2.9065 | rl_loss: 1.1301 | pt_loss: 1.7764 | pg_loss: 0.1848 | reg_loss: 0.9453 | reward: -0.3084 | rev_kl: 1.0340 | stu_lens: 102.5781 | mixed_lens: 107.4219 | lr: 4.5035e-06 | scale: 2048.00 | time: 26.261 | step time: 27.510
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1105/  5000| tot_loss: 2.8200 | rl_loss: 1.7774 | pt_loss: 1.0426 | pg_loss: 0.6693 | reg_loss: 1.1081 | reward: -0.3038 | rev_kl: 1.1899 | stu_lens: 62.5000 | mixed_lens: 64.0000 | lr: 4.5026e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1106/  5000| tot_loss: 2.1463 | rl_loss: 0.7076 | pt_loss: 1.4387 | pg_loss: -0.0190 | reg_loss: 0.7266 | reward: -0.0758 | rev_kl: 0.7704 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5016e-06 | scale: 2048.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1107/  5000| tot_loss: 2.4883 | rl_loss: 0.5948 | pt_loss: 1.8935 | pg_loss: -0.0064 | reg_loss: 0.6011 | reward: -0.1791 | rev_kl: 1.3483 | stu_lens: 115.5000 | mixed_lens: 128.0000 | lr: 4.5007e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1108/  5000| tot_loss: 2.3636 | rl_loss: 0.8698 | pt_loss: 1.4938 | pg_loss: 0.2521 | reg_loss: 0.6177 | reward: -1.7559 | rev_kl: 0.3492 | stu_lens: 47.5000 | mixed_lens: 66.0000 | lr: 4.4997e-06 | scale: 2048.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1109/  5000| tot_loss: 2.4712 | rl_loss: 0.7194 | pt_loss: 1.7518 | pg_loss: -0.0072 | reg_loss: 0.7266 | reward: -0.1472 | rev_kl: 0.6985 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4987e-06 | scale: 2048.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1110/  5000| tot_loss: 2.7572 | rl_loss: 0.8516 | pt_loss: 1.9056 | pg_loss: 0.2488 | reg_loss: 0.6028 | reward: -0.1794 | rev_kl: 1.1056 | stu_lens: 82.5000 | mixed_lens: 94.0000 | lr: 4.4978e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1111/  5000| tot_loss: 2.4741 | rl_loss: 0.8627 | pt_loss: 1.6114 | pg_loss: 0.2624 | reg_loss: 0.6003 | reward: -0.1872 | rev_kl: 0.6435 | stu_lens: 68.0000 | mixed_lens: 89.5000 | lr: 4.4968e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1112/  5000| tot_loss: 2.7002 | rl_loss: 0.8677 | pt_loss: 1.8325 | pg_loss: 0.2330 | reg_loss: 0.6347 | reward: -1.0356 | rev_kl: 1.5195 | stu_lens: 66.5000 | mixed_lens: 67.0000 | lr: 4.4958e-06 | scale: 2048.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1113/  5000| tot_loss: 2.0803 | rl_loss: 0.5928 | pt_loss: 1.4875 | pg_loss: 0.1990 | reg_loss: 0.3938 | reward: -0.2446 | rev_kl: 0.6368 | stu_lens: 114.5000 | mixed_lens: 75.0000 | lr: 4.4949e-06 | scale: 2048.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1114/  5000| tot_loss: 0.4333 | rl_loss: -0.9690 | pt_loss: 1.4023 | pg_loss: -1.3851 | reg_loss: 0.4161 | reward: -1.7658 | rev_kl: 0.8467 | stu_lens: 102.0000 | mixed_lens: 8.0000 | lr: 4.4939e-06 | scale: 2048.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1115/  5000| tot_loss: 2.4451 | rl_loss: 0.5565 | pt_loss: 1.8886 | pg_loss: 0.0083 | reg_loss: 0.5482 | reward: -0.1843 | rev_kl: 0.5528 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4929e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1116/  5000| tot_loss: 2.6467 | rl_loss: 0.7172 | pt_loss: 1.9295 | pg_loss: 0.1364 | reg_loss: 0.5807 | reward: -0.2595 | rev_kl: 0.9076 | stu_lens: 88.5000 | mixed_lens: 98.5000 | lr: 4.4920e-06 | scale: 2048.00 | time: 26.351 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1117/  5000| tot_loss: 2.8778 | rl_loss: 1.1863 | pt_loss: 1.6915 | pg_loss: 0.5516 | reg_loss: 0.6347 | reward: -0.2974 | rev_kl: 1.0042 | stu_lens: 76.0000 | mixed_lens: 62.0000 | lr: 4.4910e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1118/  5000| tot_loss: 2.7230 | rl_loss: 0.7587 | pt_loss: 1.9643 | pg_loss: -0.0079 | reg_loss: 0.7666 | reward: -0.1175 | rev_kl: 0.8899 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4900e-06 | scale: 2048.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1119/  5000| tot_loss: 2.7467 | rl_loss: 0.8891 | pt_loss: 1.8576 | pg_loss: 0.1454 | reg_loss: 0.7438 | reward: -0.1744 | rev_kl: 0.4964 | stu_lens: 127.5000 | mixed_lens: 109.5000 | lr: 4.4891e-06 | scale: 2048.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1120/  5000| tot_loss: 2.3338 | rl_loss: 0.5474 | pt_loss: 1.7864 | pg_loss: 0.0412 | reg_loss: 0.5063 | reward: -0.2050 | rev_kl: 1.1704 | stu_lens: 99.5000 | mixed_lens: 121.5000 | lr: 4.4881e-06 | scale: 2048.00 | time: 26.277 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1120/  5000| tot_loss: 2.4979 | rl_loss: 0.7684 | pt_loss: 1.7295 | pg_loss: 0.1225 | reg_loss: 0.6459 | reward: -0.4392 | rev_kl: 1.0197 | stu_lens: 96.0938 | mixed_lens: 98.5938 | lr: 4.4881e-06 | scale: 2048.00 | time: 26.277 | step time: 27.563
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1121/  5000| tot_loss: 2.3899 | rl_loss: 0.7407 | pt_loss: 1.6491 | pg_loss: 0.1901 | reg_loss: 0.5507 | reward: -0.2471 | rev_kl: 0.9158 | stu_lens: 110.0000 | mixed_lens: 84.5000 | lr: 4.4871e-06 | scale: 2048.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1122/  5000| tot_loss: 1.9114 | rl_loss: 0.4012 | pt_loss: 1.5102 | pg_loss: 0.0343 | reg_loss: 0.3670 | reward: -0.0161 | rev_kl: 0.9427 | stu_lens: 128.0000 | mixed_lens: 121.5000 | lr: 4.4861e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1123/  5000| tot_loss: 2.8050 | rl_loss: 0.7017 | pt_loss: 2.1033 | pg_loss: 0.2183 | reg_loss: 0.4834 | reward: -0.1864 | rev_kl: 0.4428 | stu_lens: 108.5000 | mixed_lens: 100.5000 | lr: 4.4852e-06 | scale: 2048.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1124/  5000| tot_loss: 2.2964 | rl_loss: 0.4094 | pt_loss: 1.8870 | pg_loss: -0.0155 | reg_loss: 0.4249 | reward: -0.1504 | rev_kl: 1.0728 | stu_lens: 109.5000 | mixed_lens: 128.0000 | lr: 4.4842e-06 | scale: 2048.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1125/  5000| tot_loss: 1.9292 | rl_loss: 0.3565 | pt_loss: 1.5727 | pg_loss: 0.0017 | reg_loss: 0.3548 | reward: -0.2446 | rev_kl: 0.8811 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4832e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1126/  5000| tot_loss: 2.2691 | rl_loss: 0.6271 | pt_loss: 1.6419 | pg_loss: 0.0499 | reg_loss: 0.5773 | reward: -0.1873 | rev_kl: 1.2605 | stu_lens: 67.0000 | mixed_lens: 111.5000 | lr: 4.4822e-06 | scale: 2048.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1127/  5000| tot_loss: 2.6657 | rl_loss: 1.0566 | pt_loss: 1.6091 | pg_loss: 0.4393 | reg_loss: 0.6173 | reward: -0.8933 | rev_kl: 0.6521 | stu_lens: 48.5000 | mixed_lens: 78.5000 | lr: 4.4813e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1128/  5000| tot_loss: 2.2466 | rl_loss: 0.5674 | pt_loss: 1.6792 | pg_loss: 0.0072 | reg_loss: 0.5602 | reward: -0.2278 | rev_kl: 0.9179 | stu_lens: 116.0000 | mixed_lens: 128.0000 | lr: 4.4803e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1129/  5000| tot_loss: 1.9668 | rl_loss: 0.5456 | pt_loss: 1.4212 | pg_loss: 0.0883 | reg_loss: 0.4573 | reward: -0.3317 | rev_kl: 0.8673 | stu_lens: 110.0000 | mixed_lens: 103.0000 | lr: 4.4793e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1130/  5000| tot_loss: 2.3344 | rl_loss: 0.4476 | pt_loss: 1.8868 | pg_loss: 0.0411 | reg_loss: 0.4065 | reward: -0.1893 | rev_kl: 1.8346 | stu_lens: 59.0000 | mixed_lens: 121.5000 | lr: 4.4783e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1131/  5000| tot_loss: 2.0483 | rl_loss: 0.3608 | pt_loss: 1.6876 | pg_loss: -0.0139 | reg_loss: 0.3747 | reward: -0.1998 | rev_kl: 5.6596 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4774e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1132/  5000| tot_loss: 2.4001 | rl_loss: 0.4558 | pt_loss: 1.9443 | pg_loss: -0.0163 | reg_loss: 0.4722 | reward: -0.2070 | rev_kl: 0.8978 | stu_lens: 82.0000 | mixed_lens: 128.0000 | lr: 4.4764e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1133/  5000| tot_loss: 2.0462 | rl_loss: 0.4250 | pt_loss: 1.6211 | pg_loss: -0.0180 | reg_loss: 0.4430 | reward: -0.1256 | rev_kl: 1.0900 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4754e-06 | scale: 2048.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1134/  5000| tot_loss: 2.1981 | rl_loss: 0.3654 | pt_loss: 1.8327 | pg_loss: 0.0115 | reg_loss: 0.3538 | reward: -0.2209 | rev_kl: 0.7541 | stu_lens: 128.0000 | mixed_lens: 119.5000 | lr: 4.4744e-06 | scale: 2048.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1135/  5000| tot_loss: 1.7313 | rl_loss: 0.3335 | pt_loss: 1.3978 | pg_loss: -0.0120 | reg_loss: 0.3454 | reward: -0.1915 | rev_kl: 0.3978 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4734e-06 | scale: 2048.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1136/  5000| tot_loss: 2.3681 | rl_loss: 0.6812 | pt_loss: 1.6869 | pg_loss: 0.0930 | reg_loss: 0.5882 | reward: -0.1695 | rev_kl: 0.8216 | stu_lens: 127.5000 | mixed_lens: 109.5000 | lr: 4.4724e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1136/  5000| tot_loss: 2.2863 | rl_loss: 0.5839 | pt_loss: 1.7024 | pg_loss: 0.1134 | reg_loss: 0.4706 | reward: -0.3734 | rev_kl: 1.0087 | stu_lens: 100.9844 | mixed_lens: 102.4688 | lr: 4.4724e-06 | scale: 2048.00 | time: 26.273 | step time: 27.546
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1137/  5000| tot_loss: 2.9406 | rl_loss: 0.7690 | pt_loss: 2.1716 | pg_loss: 0.3417 | reg_loss: 0.4272 | reward: -0.2390 | rev_kl: 0.9589 | stu_lens: 70.5000 | mixed_lens: 80.0000 | lr: 4.4715e-06 | scale: 2048.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1138/  5000| tot_loss: 1.9756 | rl_loss: 0.4217 | pt_loss: 1.5539 | pg_loss: -0.0005 | reg_loss: 0.4223 | reward: -0.1815 | rev_kl: 1.2309 | stu_lens: 107.0000 | mixed_lens: 128.0000 | lr: 4.4705e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1139/  5000| tot_loss: 3.0454 | rl_loss: 1.2800 | pt_loss: 1.7654 | pg_loss: 1.0343 | reg_loss: 0.2458 | reward: -1.0577 | rev_kl: 1.2337 | stu_lens: 6.5000 | mixed_lens: 30.0000 | lr: 4.4695e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1140/  5000| tot_loss: 1.7220 | rl_loss: 0.3852 | pt_loss: 1.3368 | pg_loss: -0.0114 | reg_loss: 0.3966 | reward: -0.1533 | rev_kl: 0.9255 | stu_lens: 91.5000 | mixed_lens: 128.0000 | lr: 4.4685e-06 | scale: 2048.00 | time: 26.320 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1141/  5000| tot_loss: 2.2622 | rl_loss: 0.6488 | pt_loss: 1.6134 | pg_loss: 0.2248 | reg_loss: 0.4240 | reward: -0.2882 | rev_kl: 0.7602 | stu_lens: 54.5000 | mixed_lens: 98.5000 | lr: 4.4675e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1142/  5000| tot_loss: 2.6684 | rl_loss: 0.6077 | pt_loss: 2.0607 | pg_loss: 0.1437 | reg_loss: 0.4640 | reward: -2.3226 | rev_kl: 0.9931 | stu_lens: 128.0000 | mixed_lens: 66.0000 | lr: 4.4665e-06 | scale: 2048.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1143/  5000| tot_loss: 2.1752 | rl_loss: 0.4360 | pt_loss: 1.7392 | pg_loss: 0.2817 | reg_loss: 0.1543 | reward: -0.3456 | rev_kl: 0.9460 | stu_lens: 91.0000 | mixed_lens: 70.5000 | lr: 4.4655e-06 | scale: 2048.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1144/  5000| tot_loss: 2.0629 | rl_loss: 0.3612 | pt_loss: 1.7017 | pg_loss: 0.0529 | reg_loss: 0.3083 | reward: -0.2554 | rev_kl: 1.2679 | stu_lens: 99.5000 | mixed_lens: 120.0000 | lr: 4.4645e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1145/  5000| tot_loss: 2.1589 | rl_loss: 0.3480 | pt_loss: 1.8110 | pg_loss: -0.0217 | reg_loss: 0.3697 | reward: -0.0790 | rev_kl: 0.9142 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4635e-06 | scale: 2048.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1146/  5000| tot_loss: 2.3044 | rl_loss: 0.6810 | pt_loss: 1.6234 | pg_loss: 0.2536 | reg_loss: 0.4274 | reward: -0.1815 | rev_kl: 0.8155 | stu_lens: 114.5000 | mixed_lens: 75.0000 | lr: 4.4625e-06 | scale: 2048.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1147/  5000| tot_loss: 2.0647 | rl_loss: 0.3544 | pt_loss: 1.7103 | pg_loss: -0.0010 | reg_loss: 0.3554 | reward: -0.0293 | rev_kl: 0.8319 | stu_lens: 128.0000 | mixed_lens: 121.5000 | lr: 4.4616e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1148/  5000| tot_loss: 3.6998 | rl_loss: 2.2529 | pt_loss: 1.4469 | pg_loss: 1.8351 | reg_loss: 0.4178 | reward: -2.3599 | rev_kl: 0.2294 | stu_lens: 26.0000 | mixed_lens: 16.5000 | lr: 4.4606e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1149/  5000| tot_loss: 2.6547 | rl_loss: 0.8511 | pt_loss: 1.8036 | pg_loss: 0.5350 | reg_loss: 0.3161 | reward: -1.2065 | rev_kl: 0.4239 | stu_lens: 56.0000 | mixed_lens: 44.0000 | lr: 4.4596e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1150/  5000| tot_loss: 2.0400 | rl_loss: 0.3685 | pt_loss: 1.6716 | pg_loss: 0.0277 | reg_loss: 0.3408 | reward: -0.2526 | rev_kl: 5.5562 | stu_lens: 107.5000 | mixed_lens: 128.0000 | lr: 4.4586e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1151/  5000| tot_loss: 2.0114 | rl_loss: 0.4169 | pt_loss: 1.5945 | pg_loss: 0.0170 | reg_loss: 0.3999 | reward: -0.1996 | rev_kl: 1.2267 | stu_lens: 115.5000 | mixed_lens: 128.0000 | lr: 4.4576e-06 | scale: 2048.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1152/  5000| tot_loss: 2.2359 | rl_loss: 0.4103 | pt_loss: 1.8256 | pg_loss: -0.0006 | reg_loss: 0.4109 | reward: -0.1297 | rev_kl: 0.6012 | stu_lens: 111.5000 | mixed_lens: 128.0000 | lr: 4.4566e-06 | scale: 2048.00 | time: 26.357 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1152/  5000| tot_loss: 2.3004 | rl_loss: 0.5652 | pt_loss: 1.7352 | pg_loss: 0.1886 | reg_loss: 0.3765 | reward: -0.3732 | rev_kl: 1.0573 | stu_lens: 96.3125 | mixed_lens: 101.3906 | lr: 4.4566e-06 | scale: 2048.00 | time: 26.357 | step time: 27.561
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1153/  5000| tot_loss: 2.4295 | rl_loss: 0.3588 | pt_loss: 2.0707 | pg_loss: -0.0105 | reg_loss: 0.3694 | reward: -0.2297 | rev_kl: 0.6244 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4556e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1154/  5000| tot_loss: 3.5040 | rl_loss: 2.1899 | pt_loss: 1.3141 | pg_loss: 0.7201 | reg_loss: 1.4698 | reward: -2.4198 | rev_kl: 0.6815 | stu_lens: 54.5000 | mixed_lens: 38.5000 | lr: 4.4546e-06 | scale: 2048.00 | time: 26.318 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1155/  5000| tot_loss: 3.4664 | rl_loss: 1.4500 | pt_loss: 2.0164 | pg_loss: 0.3722 | reg_loss: 1.0779 | reward: -0.2016 | rev_kl: 0.7925 | stu_lens: 128.0000 | mixed_lens: 79.5000 | lr: 4.4536e-06 | scale: 2048.00 | time: 26.317 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1156/  5000| tot_loss: 2.8949 | rl_loss: 1.4903 | pt_loss: 1.4046 | pg_loss: 0.4450 | reg_loss: 1.0453 | reward: 0.2333 | rev_kl: 0.7739 | stu_lens: 128.0000 | mixed_lens: 74.5000 | lr: 4.4526e-06 | scale: 2048.00 | time: 26.323 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1157/  5000| tot_loss: 2.5780 | rl_loss: 0.6232 | pt_loss: 1.9548 | pg_loss: 0.0806 | reg_loss: 0.5425 | reward: -0.2146 | rev_kl: 0.4765 | stu_lens: 78.5000 | mixed_lens: 128.0000 | lr: 4.4516e-06 | scale: 2048.00 | time: 26.366 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1158/  5000| tot_loss: 4.3514 | rl_loss: 2.2895 | pt_loss: 2.0619 | pg_loss: 0.6787 | reg_loss: 1.6108 | reward: -0.6547 | rev_kl: 0.9962 | stu_lens: 67.5000 | mixed_lens: 68.0000 | lr: 4.4506e-06 | scale: 2048.00 | time: 26.341 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1159/  5000| tot_loss: 2.6679 | rl_loss: 0.7598 | pt_loss: 1.9081 | pg_loss: 0.2614 | reg_loss: 0.4984 | reward: -0.4519 | rev_kl: 0.4960 | stu_lens: 117.5000 | mixed_lens: 73.5000 | lr: 4.4496e-06 | scale: 2048.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1160/  5000| tot_loss: 2.7139 | rl_loss: 0.9090 | pt_loss: 1.8049 | pg_loss: 0.0559 | reg_loss: 0.8531 | reward: -0.2688 | rev_kl: 1.0590 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4486e-06 | scale: 2048.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1161/  5000| tot_loss: 2.8098 | rl_loss: 1.1123 | pt_loss: 1.6975 | pg_loss: 0.0447 | reg_loss: 1.0675 | reward: -0.1762 | rev_kl: 0.9060 | stu_lens: 113.5000 | mixed_lens: 128.0000 | lr: 4.4476e-06 | scale: 2048.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1162/  5000| tot_loss: 2.9099 | rl_loss: 1.0265 | pt_loss: 1.8833 | pg_loss: 0.0382 | reg_loss: 0.9883 | reward: -0.2961 | rev_kl: 1.0730 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4466e-06 | scale: 2048.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1163/  5000| tot_loss: 3.3463 | rl_loss: 1.6168 | pt_loss: 1.7295 | pg_loss: 0.8959 | reg_loss: 0.7209 | reward: -0.6826 | rev_kl: 1.0762 | stu_lens: 128.0000 | mixed_lens: 29.0000 | lr: 4.4456e-06 | scale: 2048.00 | time: 26.329 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1164/  5000| tot_loss: 2.5705 | rl_loss: 1.2618 | pt_loss: 1.3086 | pg_loss: 0.4181 | reg_loss: 0.8438 | reward: -0.4224 | rev_kl: 0.7986 | stu_lens: 83.5000 | mixed_lens: 70.0000 | lr: 4.4445e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1165/  5000| tot_loss: 3.8715 | rl_loss: 2.0413 | pt_loss: 1.8302 | pg_loss: 1.3861 | reg_loss: 0.6552 | reward: -0.3782 | rev_kl: 0.9064 | stu_lens: 76.0000 | mixed_lens: 33.0000 | lr: 4.4435e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1166/  5000| tot_loss: 2.0869 | rl_loss: 0.8603 | pt_loss: 1.2265 | pg_loss: 0.1463 | reg_loss: 0.7140 | reward: -0.2113 | rev_kl: 0.6755 | stu_lens: 119.0000 | mixed_lens: 85.5000 | lr: 4.4425e-06 | scale: 2048.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1167/  5000| tot_loss: 3.6484 | rl_loss: 1.3715 | pt_loss: 2.2769 | pg_loss: 0.4167 | reg_loss: 0.9548 | reward: -0.5688 | rev_kl: 1.0231 | stu_lens: 78.0000 | mixed_lens: 77.0000 | lr: 4.4415e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1168/  5000| tot_loss: 3.6806 | rl_loss: 2.0404 | pt_loss: 1.6403 | pg_loss: 1.1409 | reg_loss: 0.8995 | reward: -1.0514 | rev_kl: 1.1633 | stu_lens: 70.0000 | mixed_lens: 45.5000 | lr: 4.4405e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1168/  5000| tot_loss: 2.9301 | rl_loss: 1.2447 | pt_loss: 1.6854 | pg_loss: 0.3559 | reg_loss: 0.8888 | reward: -0.4028 | rev_kl: 0.8868 | stu_lens: 94.9375 | mixed_lens: 89.1250 | lr: 4.4405e-06 | scale: 2048.00 | time: 26.291 | step time: 27.600
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1169/  5000| tot_loss: 2.4525 | rl_loss: 1.0081 | pt_loss: 1.4444 | pg_loss: 0.2673 | reg_loss: 0.7408 | reward: -1.0683 | rev_kl: 0.5782 | stu_lens: 74.0000 | mixed_lens: 66.0000 | lr: 4.4395e-06 | scale: 2048.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1170/  5000| tot_loss: 2.6107 | rl_loss: 0.6115 | pt_loss: 1.9992 | pg_loss: 0.1406 | reg_loss: 0.4709 | reward: -0.7848 | rev_kl: 1.2440 | stu_lens: 67.5000 | mixed_lens: 19.0000 | lr: 4.4385e-06 | scale: 2048.00 | time: 26.351 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1171/  5000| tot_loss: 2.6233 | rl_loss: 1.1181 | pt_loss: 1.5052 | pg_loss: 0.3461 | reg_loss: 0.7720 | reward: -0.2441 | rev_kl: 0.8825 | stu_lens: 128.0000 | mixed_lens: 87.0000 | lr: 4.4375e-06 | scale: 2048.00 | time: 26.371 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1172/  5000| tot_loss: 3.2879 | rl_loss: 1.6300 | pt_loss: 1.6579 | pg_loss: 1.0687 | reg_loss: 0.5613 | reward: -0.3317 | rev_kl: 1.7883 | stu_lens: 17.5000 | mixed_lens: 40.5000 | lr: 4.4365e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1173/  5000| tot_loss: 2.7973 | rl_loss: 0.8312 | pt_loss: 1.9662 | pg_loss: 0.4026 | reg_loss: 0.4286 | reward: -0.2264 | rev_kl: 1.3540 | stu_lens: 114.0000 | mixed_lens: 67.0000 | lr: 4.4354e-06 | scale: 2048.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1174/  5000| tot_loss: 2.7547 | rl_loss: 0.7815 | pt_loss: 1.9732 | pg_loss: 0.0611 | reg_loss: 0.7203 | reward: -0.1569 | rev_kl: 0.8784 | stu_lens: 128.0000 | mixed_lens: 117.0000 | lr: 4.4344e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1175/  5000| tot_loss: 2.7358 | rl_loss: 0.8444 | pt_loss: 1.8914 | pg_loss: 0.1731 | reg_loss: 0.6713 | reward: -0.3628 | rev_kl: 0.7690 | stu_lens: 128.0000 | mixed_lens: 104.0000 | lr: 4.4334e-06 | scale: 2048.00 | time: 26.366 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1176/  5000| tot_loss: 1.9793 | rl_loss: 0.8849 | pt_loss: 1.0944 | pg_loss: 0.2409 | reg_loss: 0.6440 | reward: -0.3921 | rev_kl: 0.6029 | stu_lens: 117.5000 | mixed_lens: 73.5000 | lr: 4.4324e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1177/  5000| tot_loss: 2.4905 | rl_loss: 0.7312 | pt_loss: 1.7593 | pg_loss: 0.1295 | reg_loss: 0.6017 | reward: -0.4380 | rev_kl: 0.7454 | stu_lens: 80.0000 | mixed_lens: 88.5000 | lr: 4.4314e-06 | scale: 2048.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1178/  5000| tot_loss: 2.2700 | rl_loss: 0.4741 | pt_loss: 1.7959 | pg_loss: -0.0009 | reg_loss: 0.4750 | reward: -0.2359 | rev_kl: 1.1697 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4304e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1179/  5000| tot_loss: 2.2740 | rl_loss: 0.5440 | pt_loss: 1.7300 | pg_loss: 0.0400 | reg_loss: 0.5039 | reward: -0.1437 | rev_kl: 0.5895 | stu_lens: 99.0000 | mixed_lens: 128.0000 | lr: 4.4293e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1180/  5000| tot_loss: 2.3286 | rl_loss: 0.6821 | pt_loss: 1.6465 | pg_loss: -0.0010 | reg_loss: 0.6831 | reward: -0.1285 | rev_kl: 1.2324 | stu_lens: 95.5000 | mixed_lens: 128.0000 | lr: 4.4283e-06 | scale: 2048.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1181/  5000| tot_loss: 2.9063 | rl_loss: 0.9267 | pt_loss: 1.9796 | pg_loss: 0.2540 | reg_loss: 0.6727 | reward: -0.3873 | rev_kl: 1.2165 | stu_lens: 61.0000 | mixed_lens: 98.5000 | lr: 4.4273e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1182/  5000| tot_loss: 2.6896 | rl_loss: 0.6840 | pt_loss: 2.0056 | pg_loss: 0.3925 | reg_loss: 0.2915 | reward: -0.9519 | rev_kl: 0.8322 | stu_lens: 49.5000 | mixed_lens: 69.5000 | lr: 4.4263e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1183/  5000| tot_loss: 2.9094 | rl_loss: 0.9305 | pt_loss: 1.9789 | pg_loss: 0.3273 | reg_loss: 0.6032 | reward: -0.3736 | rev_kl: 0.8510 | stu_lens: 126.0000 | mixed_lens: 78.0000 | lr: 4.4253e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1184/  5000| tot_loss: 3.3768 | rl_loss: 1.4057 | pt_loss: 1.9710 | pg_loss: 0.6965 | reg_loss: 0.7092 | reward: -0.0067 | rev_kl: 1.5658 | stu_lens: 66.0000 | mixed_lens: 67.0000 | lr: 4.4242e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1184/  5000| tot_loss: 2.7290 | rl_loss: 0.9669 | pt_loss: 1.7621 | pg_loss: 0.3514 | reg_loss: 0.6155 | reward: -0.4393 | rev_kl: 0.8583 | stu_lens: 92.3750 | mixed_lens: 85.7344 | lr: 4.4242e-06 | scale: 2048.00 | time: 26.301 | step time: 27.597
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1185/  5000| tot_loss: 2.9333 | rl_loss: 0.8894 | pt_loss: 2.0439 | pg_loss: 0.2902 | reg_loss: 0.5992 | reward: -0.1881 | rev_kl: 0.8504 | stu_lens: 104.5000 | mixed_lens: 85.5000 | lr: 4.4232e-06 | scale: 2048.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1186/  5000| tot_loss: 2.0849 | rl_loss: 0.3882 | pt_loss: 1.6968 | pg_loss: 0.0178 | reg_loss: 0.3704 | reward: -0.1613 | rev_kl: 0.7315 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4222e-06 | scale: 2048.00 | time: 26.328 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1187/  5000| tot_loss: 2.3331 | rl_loss: 0.8669 | pt_loss: 1.4663 | pg_loss: 0.5017 | reg_loss: 0.3652 | reward: -0.4673 | rev_kl: 0.8328 | stu_lens: 85.5000 | mixed_lens: 70.0000 | lr: 4.4212e-06 | scale: 2048.00 | time: 26.350 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1188/  5000| tot_loss: 3.2503 | rl_loss: 1.7004 | pt_loss: 1.5499 | pg_loss: 0.6286 | reg_loss: 1.0718 | reward: -0.5140 | rev_kl: 1.1168 | stu_lens: 67.5000 | mixed_lens: 55.0000 | lr: 4.4201e-06 | scale: 2048.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1189/  5000| tot_loss: 1.6095 | rl_loss: 0.2076 | pt_loss: 1.4019 | pg_loss: -0.0147 | reg_loss: 0.2223 | reward: -0.0975 | rev_kl: 0.6965 | stu_lens: 81.0000 | mixed_lens: 118.0000 | lr: 4.4191e-06 | scale: 2048.00 | time: 26.328 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1190/  5000| tot_loss: 2.1605 | rl_loss: 0.5044 | pt_loss: 1.6562 | pg_loss: -0.0094 | reg_loss: 0.5137 | reward: -0.1650 | rev_kl: 0.8246 | stu_lens: 95.5000 | mixed_lens: 128.0000 | lr: 4.4181e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1191/  5000| tot_loss: 2.5923 | rl_loss: 0.5695 | pt_loss: 2.0228 | pg_loss: 0.0983 | reg_loss: 0.4711 | reward: -0.1223 | rev_kl: 0.6937 | stu_lens: 88.5000 | mixed_lens: 116.5000 | lr: 4.4171e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1192/  5000| tot_loss: 2.5478 | rl_loss: 0.7488 | pt_loss: 1.7990 | pg_loss: 0.4399 | reg_loss: 0.3089 | reward: -2.1550 | rev_kl: 0.5980 | stu_lens: 75.5000 | mixed_lens: 25.5000 | lr: 4.4160e-06 | scale: 2048.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1193/  5000| tot_loss: 2.4742 | rl_loss: 0.7687 | pt_loss: 1.7055 | pg_loss: 0.2237 | reg_loss: 0.5450 | reward: -0.4905 | rev_kl: 0.7595 | stu_lens: 98.0000 | mixed_lens: 79.5000 | lr: 4.4150e-06 | scale: 2048.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1194/  5000| tot_loss: 1.5813 | rl_loss: 0.2506 | pt_loss: 1.3308 | pg_loss: -0.0335 | reg_loss: 0.2841 | reward: -0.2112 | rev_kl: 0.6882 | stu_lens: 68.0000 | mixed_lens: 128.0000 | lr: 4.4140e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1195/  5000| tot_loss: 1.7595 | rl_loss: 0.4800 | pt_loss: 1.2795 | pg_loss: 0.0044 | reg_loss: 0.4756 | reward: 0.1701 | rev_kl: 0.6471 | stu_lens: 128.0000 | mixed_lens: 74.5000 | lr: 4.4129e-06 | scale: 2048.00 | time: 26.340 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1196/  5000| tot_loss: 3.5064 | rl_loss: 1.5207 | pt_loss: 1.9857 | pg_loss: 1.1524 | reg_loss: 0.3683 | reward: -0.6686 | rev_kl: 0.8777 | stu_lens: 78.0000 | mixed_lens: 36.0000 | lr: 4.4119e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1197/  5000| tot_loss: 1.8439 | rl_loss: 0.4350 | pt_loss: 1.4090 | pg_loss: 0.1447 | reg_loss: 0.2903 | reward: -0.4061 | rev_kl: 0.6125 | stu_lens: 107.5000 | mixed_lens: 104.5000 | lr: 4.4109e-06 | scale: 2048.00 | time: 26.366 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1198/  5000| tot_loss: 2.1041 | rl_loss: 0.3609 | pt_loss: 1.7432 | pg_loss: 0.2019 | reg_loss: 0.1590 | reward: -0.3715 | rev_kl: 1.0054 | stu_lens: 108.5000 | mixed_lens: 79.0000 | lr: 4.4098e-06 | scale: 2048.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1199/  5000| tot_loss: 2.0064 | rl_loss: 0.6165 | pt_loss: 1.3899 | pg_loss: -0.0025 | reg_loss: 0.6190 | reward: -0.2261 | rev_kl: 0.8103 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4088e-06 | scale: 2048.00 | time: 26.328 | step time: 0.000
                                 Evaluation #12                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son una de las siete      │
│                                       │ partículas fundamentales de la       │
│                                       │ física de partículas. Los cuarks     │
│                                       │ existen en tres tipos, con tres      │
│                                       │ diversos colores: rojo, verde y      │
│                                       │ azul.                                │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es un acrónimo de "Informes   │
│                                       │ de mayor capital" y se debe a que    │
│                                       │ los informes son descargados por     │
│                                       │ imprenta de memoria, sin embargo,    │
│                                       │ actualmente se usa también para      │
│                                       │ referir a la plataforma de           │
│                                       │ almacenamiento de datos, que permite │
│                                       │ realizar trabajos dinámicos en       │
│                                       │ tiempo real.                         │
│                                       │                                      │
│                                       │ El IMC tiene muchas utilidades,      │
│                                       │ entre las que destacan:              │
│                                       │                                      │
│                                       │ - Espacio para almacenar grandes     │
│                                       │ cantidades de información.           │
│                                       │ - Memoria de trabajo para ejecutar   │
│                                       │ tareas que requieren                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Lista de cápsulas del tiempo:        │
│                                       │                                      │
│                                       │ - Cápsulas del tiempo de los         │
│                                       │ habitantes de la prehistoria:        │
│                                       │                                      │
│                                       │ - Cápsulas del tiempo de los         │
│                                       │ griegos:                             │
│                                       │                                      │
│                                       │ - Cápsulas del tiempo de los         │
│                                       │ romanos:                             │
│                                       │                                      │
│                                       │ - Cápsulas del tiempo de los         │
│                                       │ ingleses:                            │
│                                       │                                      │
│                                       │ - Cápsulas del tiempo de los         │
│                                       │ franceses:                           │
│                                       │                                      │
│                                       │ - Cápsulas del tiempo de los         │
│                                       │ alemanes:                            │
│                                       │                                      │
│                                       │ - Cápsulas del tiempo de los         │
│                                       │ italianos:                           │
│                                       │                                      │
│                                       │ - Cápsulas del tiempo de los         │
│                                       │ españoles                            │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 15.938 | exact_match: 0.000 | rev_kl: 0.911 | lens: 95.800 | pt_loss: 1.745 | lm_loss: 1.874 | kd_loss: 1.616 
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1200/  5000| tot_loss: 1.7537 | rl_loss: 0.3516 | pt_loss: 1.4021 | pg_loss: 0.1544 | reg_loss: 0.1972 | reward: -0.4519 | rev_kl: 0.4960 | stu_lens: 117.5000 | mixed_lens: 73.5000 | lr: 4.4078e-06 | scale: 2048.00 | time: 26.287 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1200/  5000| tot_loss: 2.5092 | rl_loss: 0.7927 | pt_loss: 1.7166 | pg_loss: 0.3307 | reg_loss: 0.4620 | reward: -0.4257 | rev_kl: 0.8565 | stu_lens: 92.7344 | mixed_lens: 86.7656 | lr: 4.4078e-06 | scale: 2048.00 | time: 26.287 | step time: 27.597
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1201/  5000| tot_loss: 2.0201 | rl_loss: 0.6690 | pt_loss: 1.3511 | pg_loss: -0.0133 | reg_loss: 0.6822 | reward: -0.2614 | rev_kl: 1.0668 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4067e-06 | scale: 2048.00 | time: 26.378 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1202/  5000| tot_loss: 2.7505 | rl_loss: 0.8238 | pt_loss: 1.9267 | pg_loss: 0.4888 | reg_loss: 0.3350 | reward: -1.5083 | rev_kl: 0.6371 | stu_lens: 55.0000 | mixed_lens: 65.0000 | lr: 4.4057e-06 | scale: 2048.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1203/  5000| tot_loss: 2.1668 | rl_loss: 0.5370 | pt_loss: 1.6298 | pg_loss: -0.0127 | reg_loss: 0.5497 | reward: -0.2882 | rev_kl: 0.9552 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4047e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1204/  5000| tot_loss: 2.3095 | rl_loss: 0.8008 | pt_loss: 1.5087 | pg_loss: 0.3803 | reg_loss: 0.4204 | reward: -0.2441 | rev_kl: 0.8825 | stu_lens: 128.0000 | mixed_lens: 87.0000 | lr: 4.4036e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1205/  5000| tot_loss: 2.3754 | rl_loss: 0.8450 | pt_loss: 1.5303 | pg_loss: 0.6145 | reg_loss: 0.2305 | reward: -0.5701 | rev_kl: 0.7521 | stu_lens: 65.5000 | mixed_lens: 19.5000 | lr: 4.4026e-06 | scale: 2048.00 | time: 26.338 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1206/  5000| tot_loss: 2.1927 | rl_loss: 0.0991 | pt_loss: 2.0935 | pg_loss: 0.0073 | reg_loss: 0.0918 | reward: -0.1377 | rev_kl: 0.7983 | stu_lens: 108.5000 | mixed_lens: 128.0000 | lr: 4.4015e-06 | scale: 2048.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1207/  5000| tot_loss: 2.3607 | rl_loss: 0.6381 | pt_loss: 1.7226 | pg_loss: 0.0889 | reg_loss: 0.5492 | reward: -0.1292 | rev_kl: 1.1981 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 4.4005e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1208/  5000| tot_loss: 2.3206 | rl_loss: 0.4660 | pt_loss: 1.8547 | pg_loss: -0.0013 | reg_loss: 0.4673 | reward: -0.1573 | rev_kl: 0.5819 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3995e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1209/  5000| tot_loss: 2.4386 | rl_loss: 0.4008 | pt_loss: 2.0378 | pg_loss: 0.1421 | reg_loss: 0.2586 | reward: 0.0733 | rev_kl: 1.4135 | stu_lens: 48.0000 | mixed_lens: 57.0000 | lr: 4.3984e-06 | scale: 2048.00 | time: 26.360 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1210/  5000| tot_loss: 1.5743 | rl_loss: 0.3949 | pt_loss: 1.1795 | pg_loss: 0.0920 | reg_loss: 0.3028 | reward: -0.2486 | rev_kl: 0.8305 | stu_lens: 118.5000 | mixed_lens: 100.5000 | lr: 4.3974e-06 | scale: 2048.00 | time: 26.361 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1211/  5000| tot_loss: 2.5485 | rl_loss: 0.9359 | pt_loss: 1.6126 | pg_loss: 0.5047 | reg_loss: 0.4311 | reward: -0.6014 | rev_kl: 0.7759 | stu_lens: 85.5000 | mixed_lens: 70.0000 | lr: 4.3963e-06 | scale: 2048.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1212/  5000| tot_loss: 1.8830 | rl_loss: 0.2755 | pt_loss: 1.6075 | pg_loss: -0.0357 | reg_loss: 0.3112 | reward: -0.3714 | rev_kl: 0.4602 | stu_lens: 82.5000 | mixed_lens: 128.0000 | lr: 4.3953e-06 | scale: 2048.00 | time: 26.359 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1213/  5000| tot_loss: 2.8409 | rl_loss: 0.8544 | pt_loss: 1.9866 | pg_loss: 0.3392 | reg_loss: 0.5152 | reward: -0.3105 | rev_kl: 2.0734 | stu_lens: 39.5000 | mixed_lens: 94.5000 | lr: 4.3942e-06 | scale: 2048.00 | time: 26.365 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1214/  5000| tot_loss: 2.4255 | rl_loss: 0.3691 | pt_loss: 2.0564 | pg_loss: -0.0015 | reg_loss: 0.3706 | reward: -0.1580 | rev_kl: 0.9029 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3932e-06 | scale: 2048.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1215/  5000| tot_loss: 3.0510 | rl_loss: 1.1646 | pt_loss: 1.8865 | pg_loss: 0.5113 | reg_loss: 0.6533 | reward: -0.5489 | rev_kl: 1.0353 | stu_lens: 57.0000 | mixed_lens: 68.0000 | lr: 4.3921e-06 | scale: 2048.00 | time: 26.364 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1216/  5000| tot_loss: 2.3744 | rl_loss: 0.4391 | pt_loss: 1.9353 | pg_loss: -0.0109 | reg_loss: 0.4500 | reward: -0.1919 | rev_kl: 1.0386 | stu_lens: 95.5000 | mixed_lens: 128.0000 | lr: 4.3911e-06 | scale: 2048.00 | time: 26.323 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1216/  5000| tot_loss: 2.3337 | rl_loss: 0.6174 | pt_loss: 1.7163 | pg_loss: 0.2361 | reg_loss: 0.3813 | reward: -0.4306 | rev_kl: 0.9046 | stu_lens: 96.0625 | mixed_lens: 89.4531 | lr: 4.3911e-06 | scale: 2048.00 | time: 26.323 | step time: 27.620
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1217/  5000| tot_loss: 2.3210 | rl_loss: 0.4049 | pt_loss: 1.9160 | pg_loss: 0.1353 | reg_loss: 0.2696 | reward: -0.1193 | rev_kl: 0.5064 | stu_lens: 128.0000 | mixed_lens: 98.5000 | lr: 4.3900e-06 | scale: 2048.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1218/  5000| tot_loss: 3.3698 | rl_loss: 1.2513 | pt_loss: 2.1185 | pg_loss: 0.4056 | reg_loss: 0.8457 | reward: -0.3713 | rev_kl: 0.9662 | stu_lens: 87.0000 | mixed_lens: 90.5000 | lr: 4.3890e-06 | scale: 2048.00 | time: 26.391 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1219/  5000| tot_loss: 2.9230 | rl_loss: 1.0894 | pt_loss: 1.8336 | pg_loss: 0.1465 | reg_loss: 0.9429 | reward: -0.1740 | rev_kl: 0.7004 | stu_lens: 88.5000 | mixed_lens: 111.5000 | lr: 4.3879e-06 | scale: 2048.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1220/  5000| tot_loss: 2.1589 | rl_loss: 1.1740 | pt_loss: 0.9849 | pg_loss: 0.4038 | reg_loss: 0.7702 | reward: -0.0091 | rev_kl: 0.2469 | stu_lens: 56.5000 | mixed_lens: 61.5000 | lr: 4.3869e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1221/  5000| tot_loss: 3.1375 | rl_loss: 1.1862 | pt_loss: 1.9513 | pg_loss: 0.4348 | reg_loss: 0.7515 | reward: -0.1927 | rev_kl: 0.9830 | stu_lens: 76.5000 | mixed_lens: 56.0000 | lr: 4.3858e-06 | scale: 2048.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1222/  5000| tot_loss: 2.9169 | rl_loss: 1.1769 | pt_loss: 1.7400 | pg_loss: 0.5533 | reg_loss: 0.6236 | reward: -0.3236 | rev_kl: 0.5749 | stu_lens: 40.0000 | mixed_lens: 39.0000 | lr: 4.3848e-06 | scale: 2048.00 | time: 26.320 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1223/  5000| tot_loss: 3.1934 | rl_loss: 1.3562 | pt_loss: 1.8372 | pg_loss: 0.2697 | reg_loss: 1.0865 | reward: -0.2130 | rev_kl: 0.8590 | stu_lens: 40.0000 | mixed_lens: 64.5000 | lr: 4.3837e-06 | scale: 2048.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1224/  5000| tot_loss: 3.4664 | rl_loss: 1.3560 | pt_loss: 2.1105 | pg_loss: 0.3153 | reg_loss: 1.0407 | reward: -0.2934 | rev_kl: 0.6373 | stu_lens: 90.5000 | mixed_lens: 92.5000 | lr: 4.3827e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1225/  5000| tot_loss: 3.3595 | rl_loss: 1.5712 | pt_loss: 1.7884 | pg_loss: 0.6378 | reg_loss: 0.9334 | reward: -0.2909 | rev_kl: 0.8289 | stu_lens: 83.0000 | mixed_lens: 49.5000 | lr: 4.3816e-06 | scale: 2048.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1226/  5000| tot_loss: 3.2612 | rl_loss: 1.4319 | pt_loss: 1.8293 | pg_loss: 0.2940 | reg_loss: 1.1379 | reward: -0.2391 | rev_kl: 0.7824 | stu_lens: 128.0000 | mixed_lens: 104.0000 | lr: 4.3806e-06 | scale: 2048.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1227/  5000| tot_loss: 3.0036 | rl_loss: 1.2944 | pt_loss: 1.7093 | pg_loss: 0.4358 | reg_loss: 0.8586 | reward: -0.5293 | rev_kl: 0.8366 | stu_lens: 76.5000 | mixed_lens: 76.0000 | lr: 4.3795e-06 | scale: 2048.00 | time: 26.351 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1228/  5000| tot_loss: 2.3902 | rl_loss: 0.9736 | pt_loss: 1.4166 | pg_loss: 0.3174 | reg_loss: 0.6562 | reward: -0.1390 | rev_kl: 0.7521 | stu_lens: 107.0000 | mixed_lens: 94.0000 | lr: 4.3785e-06 | scale: 2048.00 | time: 26.307 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1229/  5000| tot_loss: 4.5415 | rl_loss: 2.7573 | pt_loss: 1.7842 | pg_loss: 1.6748 | reg_loss: 1.0825 | reward: -2.8015 | rev_kl: 0.5697 | stu_lens: 44.5000 | mixed_lens: 18.0000 | lr: 4.3774e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1230/  5000| tot_loss: 3.1261 | rl_loss: 0.9876 | pt_loss: 2.1386 | pg_loss: 0.0457 | reg_loss: 0.9419 | reward: -0.1155 | rev_kl: 0.7113 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3763e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1231/  5000| tot_loss: 2.9806 | rl_loss: 1.0545 | pt_loss: 1.9261 | pg_loss: 0.0787 | reg_loss: 0.9758 | reward: -0.2001 | rev_kl: 0.9391 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3753e-06 | scale: 2048.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1232/  5000| tot_loss: 3.2252 | rl_loss: 1.5831 | pt_loss: 1.6421 | pg_loss: 0.6861 | reg_loss: 0.8970 | reward: -0.1930 | rev_kl: 0.8757 | stu_lens: 73.5000 | mixed_lens: 62.5000 | lr: 4.3742e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1232/  5000| tot_loss: 2.9070 | rl_loss: 1.1834 | pt_loss: 1.7236 | pg_loss: 0.2995 | reg_loss: 0.8839 | reward: -0.2753 | rev_kl: 0.8684 | stu_lens: 92.1875 | mixed_lens: 91.7812 | lr: 4.3742e-06 | scale: 2048.00 | time: 26.304 | step time: 27.606
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1233/  5000| tot_loss: 2.9649 | rl_loss: 1.0697 | pt_loss: 1.8951 | pg_loss: 0.3648 | reg_loss: 0.7049 | reward: -0.0629 | rev_kl: 0.6614 | stu_lens: 128.0000 | mixed_lens: 93.0000 | lr: 4.3732e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1234/  5000| tot_loss: 2.8480 | rl_loss: 1.0649 | pt_loss: 1.7831 | pg_loss: 0.1522 | reg_loss: 0.9127 | reward: -0.2948 | rev_kl: 0.6276 | stu_lens: 86.0000 | mixed_lens: 101.5000 | lr: 4.3721e-06 | scale: 2048.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1235/  5000| tot_loss: 2.6505 | rl_loss: 0.5667 | pt_loss: 2.0839 | pg_loss: -0.0091 | reg_loss: 0.5758 | reward: -0.1273 | rev_kl: 0.7509 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3710e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1236/  5000| tot_loss: 2.3251 | rl_loss: 0.5742 | pt_loss: 1.7510 | pg_loss: 0.0086 | reg_loss: 0.5656 | reward: -0.1432 | rev_kl: 0.8968 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3700e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1237/  5000| tot_loss: 2.9266 | rl_loss: 1.0572 | pt_loss: 1.8694 | pg_loss: 0.4740 | reg_loss: 0.5832 | reward: -0.1152 | rev_kl: 0.8982 | stu_lens: 66.5000 | mixed_lens: 70.0000 | lr: 4.3689e-06 | scale: 2048.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1238/  5000| tot_loss: 2.1330 | rl_loss: 0.5696 | pt_loss: 1.5634 | pg_loss: 0.2096 | reg_loss: 0.3600 | reward: 0.1341 | rev_kl: 1.1527 | stu_lens: 87.5000 | mixed_lens: 74.5000 | lr: 4.3678e-06 | scale: 2048.00 | time: 26.341 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1239/  5000| tot_loss: 2.1797 | rl_loss: 0.7670 | pt_loss: 1.4128 | pg_loss: 0.1599 | reg_loss: 0.6070 | reward: -0.3294 | rev_kl: 0.8953 | stu_lens: 96.5000 | mixed_lens: 89.0000 | lr: 4.3668e-06 | scale: 2048.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1240/  5000| tot_loss: 2.8013 | rl_loss: 1.2552 | pt_loss: 1.5461 | pg_loss: 0.5861 | reg_loss: 0.6691 | reward: -0.4999 | rev_kl: 1.0845 | stu_lens: 65.5000 | mixed_lens: 72.0000 | lr: 4.3657e-06 | scale: 2048.00 | time: 26.352 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1241/  5000| tot_loss: 2.1393 | rl_loss: 0.8601 | pt_loss: 1.2792 | pg_loss: 0.1629 | reg_loss: 0.6972 | reward: -0.2231 | rev_kl: 1.1833 | stu_lens: 101.5000 | mixed_lens: 111.0000 | lr: 4.3646e-06 | scale: 2048.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1242/  5000| tot_loss: 2.3105 | rl_loss: 0.4886 | pt_loss: 1.8219 | pg_loss: 0.0005 | reg_loss: 0.4881 | reward: -0.2004 | rev_kl: 1.0748 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3636e-06 | scale: 2048.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1243/  5000| tot_loss: 2.4977 | rl_loss: 0.8313 | pt_loss: 1.6664 | pg_loss: 0.3120 | reg_loss: 0.5193 | reward: 0.5619 | rev_kl: 0.6384 | stu_lens: 56.0000 | mixed_lens: 53.5000 | lr: 4.3625e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1244/  5000| tot_loss: 2.5580 | rl_loss: 0.6079 | pt_loss: 1.9502 | pg_loss: -0.0090 | reg_loss: 0.6169 | reward: -0.1607 | rev_kl: 2.4871 | stu_lens: 98.0000 | mixed_lens: 128.0000 | lr: 4.3614e-06 | scale: 2048.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1245/  5000| tot_loss: 2.7226 | rl_loss: 0.8010 | pt_loss: 1.9216 | pg_loss: 0.1697 | reg_loss: 0.6313 | reward: -0.3251 | rev_kl: 1.0864 | stu_lens: 116.5000 | mixed_lens: 107.5000 | lr: 4.3604e-06 | scale: 2048.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1246/  5000| tot_loss: 2.4966 | rl_loss: 0.7962 | pt_loss: 1.7004 | pg_loss: 0.2582 | reg_loss: 0.5380 | reward: -0.1260 | rev_kl: 0.8107 | stu_lens: 128.0000 | mixed_lens: 93.0000 | lr: 4.3593e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1247/  5000| tot_loss: 2.6598 | rl_loss: 0.6190 | pt_loss: 2.0408 | pg_loss: 0.0117 | reg_loss: 0.6073 | reward: -0.1551 | rev_kl: 0.7325 | stu_lens: 88.5000 | mixed_lens: 128.0000 | lr: 4.3582e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1248/  5000| tot_loss: 2.6030 | rl_loss: 0.7705 | pt_loss: 1.8325 | pg_loss: 0.1331 | reg_loss: 0.6374 | reward: -0.2286 | rev_kl: 0.6401 | stu_lens: 90.5000 | mixed_lens: 104.0000 | lr: 4.3571e-06 | scale: 2048.00 | time: 26.307 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1248/  5000| tot_loss: 2.5979 | rl_loss: 0.8484 | pt_loss: 1.7495 | pg_loss: 0.2328 | reg_loss: 0.6156 | reward: -0.2683 | rev_kl: 0.8462 | stu_lens: 94.3281 | mixed_lens: 91.8438 | lr: 4.3571e-06 | scale: 2048.00 | time: 26.307 | step time: 27.597
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1249/  5000| tot_loss: 2.6301 | rl_loss: 0.9991 | pt_loss: 1.6310 | pg_loss: 0.4109 | reg_loss: 0.5882 | reward: -0.1153 | rev_kl: 0.9088 | stu_lens: 83.0000 | mixed_lens: 59.5000 | lr: 4.3561e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/1250
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1250/  5000| tot_loss: 2.3408 | rl_loss: 0.5771 | pt_loss: 1.7638 | pg_loss: 0.1037 | reg_loss: 0.4733 | reward: -0.1610 | rev_kl: 0.9114 | stu_lens: 117.0000 | mixed_lens: 111.5000 | lr: 4.3550e-06 | scale: 2048.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1251/  5000| tot_loss: 2.2682 | rl_loss: 0.6716 | pt_loss: 1.5966 | pg_loss: 0.0716 | reg_loss: 0.6000 | reward: -0.2529 | rev_kl: 0.6613 | stu_lens: 85.5000 | mixed_lens: 93.0000 | lr: 4.3539e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1252/  5000| tot_loss: 2.3691 | rl_loss: 0.7648 | pt_loss: 1.6043 | pg_loss: 0.3042 | reg_loss: 0.4606 | reward: 0.5158 | rev_kl: 0.8361 | stu_lens: 77.0000 | mixed_lens: 69.5000 | lr: 4.3528e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1253/  5000| tot_loss: 2.0847 | rl_loss: 0.5407 | pt_loss: 1.5439 | pg_loss: 0.1650 | reg_loss: 0.3758 | reward: -0.3277 | rev_kl: 0.7423 | stu_lens: 96.5000 | mixed_lens: 89.0000 | lr: 4.3518e-06 | scale: 2048.00 | time: 26.306 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1254/  5000| tot_loss: 2.5354 | rl_loss: 0.4526 | pt_loss: 2.0828 | pg_loss: -0.0092 | reg_loss: 0.4618 | reward: -0.1862 | rev_kl: 0.9509 | stu_lens: 106.5000 | mixed_lens: 128.0000 | lr: 4.3507e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1255/  5000| tot_loss: 2.2935 | rl_loss: 0.6112 | pt_loss: 1.6823 | pg_loss: 0.1274 | reg_loss: 0.4839 | reward: -0.3146 | rev_kl: 0.9440 | stu_lens: 79.0000 | mixed_lens: 107.5000 | lr: 4.3496e-06 | scale: 2048.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1256/  5000| tot_loss: 2.1226 | rl_loss: 0.4441 | pt_loss: 1.6785 | pg_loss: -0.0028 | reg_loss: 0.4469 | reward: -0.1555 | rev_kl: 0.8355 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3485e-06 | scale: 2048.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1257/  5000| tot_loss: 2.0912 | rl_loss: 0.2516 | pt_loss: 1.8396 | pg_loss: -0.0367 | reg_loss: 0.2883 | reward: -0.3246 | rev_kl: 0.2995 | stu_lens: 48.0000 | mixed_lens: 50.5000 | lr: 4.3475e-06 | scale: 2048.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1258/  5000| tot_loss: 2.7948 | rl_loss: 1.0457 | pt_loss: 1.7490 | pg_loss: 0.6335 | reg_loss: 0.4122 | reward: -0.3137 | rev_kl: 0.6780 | stu_lens: 107.0000 | mixed_lens: 58.5000 | lr: 4.3464e-06 | scale: 2048.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1259/  5000| tot_loss: 2.4430 | rl_loss: 0.6660 | pt_loss: 1.7770 | pg_loss: 0.2306 | reg_loss: 0.4354 | reward: -0.0489 | rev_kl: 0.7405 | stu_lens: 82.5000 | mixed_lens: 83.0000 | lr: 4.3453e-06 | scale: 2048.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1260/  5000| tot_loss: 2.7184 | rl_loss: 1.0647 | pt_loss: 1.6537 | pg_loss: 0.6123 | reg_loss: 0.4525 | reward: -0.0742 | rev_kl: 0.8343 | stu_lens: 87.5000 | mixed_lens: 48.0000 | lr: 4.3442e-06 | scale: 2048.00 | time: 26.412 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1261/  5000| tot_loss: 2.2624 | rl_loss: 0.4860 | pt_loss: 1.7763 | pg_loss: -0.0072 | reg_loss: 0.4932 | reward: -0.1563 | rev_kl: 0.7709 | stu_lens: 113.5000 | mixed_lens: 128.0000 | lr: 4.3431e-06 | scale: 2048.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1262/  5000| tot_loss: 2.6148 | rl_loss: 0.7222 | pt_loss: 1.8926 | pg_loss: 0.2624 | reg_loss: 0.4598 | reward: -0.4598 | rev_kl: 1.0279 | stu_lens: 93.5000 | mixed_lens: 90.5000 | lr: 4.3420e-06 | scale: 2048.00 | time: 26.401 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1263/  5000| tot_loss: 2.6843 | rl_loss: 0.8291 | pt_loss: 1.8552 | pg_loss: 0.4348 | reg_loss: 0.3943 | reward: -0.3498 | rev_kl: 1.1655 | stu_lens: 66.0000 | mixed_lens: 31.0000 | lr: 4.3410e-06 | scale: 2048.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1264/  5000| tot_loss: 2.2836 | rl_loss: 0.7009 | pt_loss: 1.5827 | pg_loss: 0.1865 | reg_loss: 0.5143 | reward: -0.1341 | rev_kl: 0.7206 | stu_lens: 128.0000 | mixed_lens: 87.0000 | lr: 4.3399e-06 | scale: 2048.00 | time: 26.369 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1264/  5000| tot_loss: 2.3442 | rl_loss: 0.6194 | pt_loss: 1.7248 | pg_loss: 0.1642 | reg_loss: 0.4552 | reward: -0.2643 | rev_kl: 0.8739 | stu_lens: 95.7812 | mixed_lens: 96.2188 | lr: 4.3399e-06 | scale: 2048.00 | time: 26.369 | step time: 27.606
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1265/  5000| tot_loss: 2.6345 | rl_loss: 1.0251 | pt_loss: 1.6095 | pg_loss: 0.5862 | reg_loss: 0.4389 | reward: -0.1052 | rev_kl: 0.7992 | stu_lens: 69.0000 | mixed_lens: 45.0000 | lr: 4.3388e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1266/  5000| tot_loss: 1.9162 | rl_loss: 0.1974 | pt_loss: 1.7188 | pg_loss: -0.0332 | reg_loss: 0.2307 | reward: -0.0367 | rev_kl: 0.8077 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3377e-06 | scale: 2048.00 | time: 26.351 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1267/  5000| tot_loss: 1.7972 | rl_loss: 0.0632 | pt_loss: 1.7341 | pg_loss: -0.0833 | reg_loss: 0.1465 | reward: 0.2833 | rev_kl: 0.6223 | stu_lens: 48.0000 | mixed_lens: 38.5000 | lr: 4.3366e-06 | scale: 2048.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1268/  5000| tot_loss: 1.9364 | rl_loss: 0.3838 | pt_loss: 1.5527 | pg_loss: 0.0204 | reg_loss: 0.3634 | reward: -0.1665 | rev_kl: 1.0382 | stu_lens: 117.0000 | mixed_lens: 128.0000 | lr: 4.3355e-06 | scale: 2048.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1269/  5000| tot_loss: 1.8355 | rl_loss: 0.6089 | pt_loss: 1.2266 | pg_loss: 0.2956 | reg_loss: 0.3133 | reward: -0.1347 | rev_kl: 0.6851 | stu_lens: 81.5000 | mixed_lens: 80.5000 | lr: 4.3344e-06 | scale: 2048.00 | time: 26.328 | step time: 0.000
[2023-12-19 07:17:18,144] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, reducing to 1024
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1270/  5000| tot_loss: 1.6216 | rl_loss: 0.4950 | pt_loss: 1.1266 | pg_loss: 0.1257 | reg_loss: 0.3693 | reward: -0.3759 | rev_kl: 0.9298 | stu_lens: 85.5000 | mixed_lens: 107.5000 | lr: 4.3344e-06 | scale: 1024.00 | time: 2.849 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1271/  5000| tot_loss: 2.3893 | rl_loss: 0.5402 | pt_loss: 1.8490 | pg_loss: 0.1605 | reg_loss: 0.3798 | reward: -0.3496 | rev_kl: 0.6205 | stu_lens: 88.5000 | mixed_lens: 101.5000 | lr: 4.3334e-06 | scale: 1024.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1272/  5000| tot_loss: 1.6239 | rl_loss: 0.3085 | pt_loss: 1.3154 | pg_loss: 0.0014 | reg_loss: 0.3071 | reward: -0.1137 | rev_kl: 0.7790 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3323e-06 | scale: 1024.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1273/  5000| tot_loss: 2.3172 | rl_loss: 0.3313 | pt_loss: 1.9859 | pg_loss: 0.0011 | reg_loss: 0.3302 | reward: -0.0708 | rev_kl: 0.7246 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3312e-06 | scale: 1024.00 | time: 26.357 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1274/  5000| tot_loss: 2.4594 | rl_loss: 0.5626 | pt_loss: 1.8968 | pg_loss: 0.0278 | reg_loss: 0.5348 | reward: -0.2994 | rev_kl: 0.6861 | stu_lens: 85.5000 | mixed_lens: 128.0000 | lr: 4.3301e-06 | scale: 1024.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1275/  5000| tot_loss: 2.6616 | rl_loss: 0.7961 | pt_loss: 1.8655 | pg_loss: 0.4328 | reg_loss: 0.3633 | reward: -0.3027 | rev_kl: 0.6496 | stu_lens: 58.0000 | mixed_lens: 74.5000 | lr: 4.3290e-06 | scale: 1024.00 | time: 26.357 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1276/  5000| tot_loss: 1.5368 | rl_loss: 0.3584 | pt_loss: 1.1783 | pg_loss: -0.0125 | reg_loss: 0.3710 | reward: -0.0975 | rev_kl: 2.3135 | stu_lens: 113.0000 | mixed_lens: 128.0000 | lr: 4.3279e-06 | scale: 1024.00 | time: 26.384 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1277/  5000| tot_loss: 2.7038 | rl_loss: 0.4910 | pt_loss: 2.2128 | pg_loss: 0.2650 | reg_loss: 0.2261 | reward: -0.5130 | rev_kl: 1.0963 | stu_lens: 93.5000 | mixed_lens: 90.5000 | lr: 4.3268e-06 | scale: 1024.00 | time: 26.426 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1278/  5000| tot_loss: 1.8330 | rl_loss: 0.4133 | pt_loss: 1.4197 | pg_loss: 0.0433 | reg_loss: 0.3700 | reward: -0.2077 | rev_kl: 0.8648 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3257e-06 | scale: 1024.00 | time: 26.393 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1279/  5000| tot_loss: 2.4516 | rl_loss: 0.4396 | pt_loss: 2.0120 | pg_loss: 0.0973 | reg_loss: 0.3423 | reward: -0.1846 | rev_kl: 0.7897 | stu_lens: 128.0000 | mixed_lens: 87.0000 | lr: 4.3246e-06 | scale: 1024.00 | time: 26.395 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1280/  5000| tot_loss: 2.4708 | rl_loss: 0.3646 | pt_loss: 2.1062 | pg_loss: 0.1591 | reg_loss: 0.2055 | reward: -0.3102 | rev_kl: 0.8706 | stu_lens: 96.5000 | mixed_lens: 89.0000 | lr: 4.3235e-06 | scale: 1024.00 | time: 26.366 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1280/  5000| tot_loss: 2.3121 | rl_loss: 0.5992 | pt_loss: 1.7129 | pg_loss: 0.2574 | reg_loss: 0.3417 | reward: -0.2847 | rev_kl: 0.8464 | stu_lens: 89.8125 | mixed_lens: 87.7344 | lr: 4.3235e-06 | scale: 1024.00 | time: 26.366 | step time: 26.162
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1281/  5000| tot_loss: 2.6040 | rl_loss: 0.7185 | pt_loss: 1.8855 | pg_loss: 0.1365 | reg_loss: 0.5820 | reward: -0.2929 | rev_kl: 1.0791 | stu_lens: 74.5000 | mixed_lens: 107.5000 | lr: 4.3224e-06 | scale: 1024.00 | time: 26.375 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1282/  5000| tot_loss: 2.7941 | rl_loss: 1.0638 | pt_loss: 1.7304 | pg_loss: 0.0530 | reg_loss: 1.0108 | reward: -0.3129 | rev_kl: 0.6874 | stu_lens: 76.5000 | mixed_lens: 128.0000 | lr: 4.3213e-06 | scale: 1024.00 | time: 26.427 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1283/  5000| tot_loss: 3.0000 | rl_loss: 1.1066 | pt_loss: 1.8934 | pg_loss: 0.0672 | reg_loss: 1.0394 | reward: -0.2641 | rev_kl: 0.9169 | stu_lens: 128.0000 | mixed_lens: 125.0000 | lr: 4.3202e-06 | scale: 1024.00 | time: 26.417 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1284/  5000| tot_loss: 2.6340 | rl_loss: 0.8487 | pt_loss: 1.7853 | pg_loss: 0.0498 | reg_loss: 0.7990 | reward: -0.1645 | rev_kl: 0.5014 | stu_lens: 101.5000 | mixed_lens: 128.0000 | lr: 4.3191e-06 | scale: 1024.00 | time: 26.370 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1285/  5000| tot_loss: 6.3970 | rl_loss: 4.5843 | pt_loss: 1.8127 | pg_loss: 3.9530 | reg_loss: 0.6313 | reward: -2.7476 | rev_kl: 0.4892 | stu_lens: 27.5000 | mixed_lens: 6.5000 | lr: 4.3180e-06 | scale: 1024.00 | time: 26.368 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1286/  5000| tot_loss: 2.9339 | rl_loss: 1.0156 | pt_loss: 1.9182 | pg_loss: 0.0510 | reg_loss: 0.9646 | reward: -0.0304 | rev_kl: 0.5203 | stu_lens: 98.5000 | mixed_lens: 128.0000 | lr: 4.3169e-06 | scale: 1024.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1287/  5000| tot_loss: 3.3600 | rl_loss: 1.4687 | pt_loss: 1.8912 | pg_loss: 0.2515 | reg_loss: 1.2172 | reward: -0.5004 | rev_kl: 0.8355 | stu_lens: 62.5000 | mixed_lens: 79.0000 | lr: 4.3158e-06 | scale: 1024.00 | time: 26.357 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1288/  5000| tot_loss: 2.6641 | rl_loss: 0.9402 | pt_loss: 1.7238 | pg_loss: 0.2701 | reg_loss: 0.6702 | reward: -0.0979 | rev_kl: 0.6023 | stu_lens: 128.0000 | mixed_lens: 83.5000 | lr: 4.3147e-06 | scale: 1024.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1289/  5000| tot_loss: 3.1713 | rl_loss: 1.2897 | pt_loss: 1.8816 | pg_loss: 0.4179 | reg_loss: 0.8718 | reward: -0.3528 | rev_kl: 1.0574 | stu_lens: 82.0000 | mixed_lens: 79.0000 | lr: 4.3136e-06 | scale: 1024.00 | time: 26.338 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1290/  5000| tot_loss: 2.5049 | rl_loss: 0.9399 | pt_loss: 1.5650 | pg_loss: 0.1767 | reg_loss: 0.7632 | reward: -0.1249 | rev_kl: 1.0239 | stu_lens: 107.5000 | mixed_lens: 102.5000 | lr: 4.3125e-06 | scale: 1024.00 | time: 26.349 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1291/  5000| tot_loss: 3.4111 | rl_loss: 1.9788 | pt_loss: 1.4323 | pg_loss: 0.7211 | reg_loss: 1.2578 | reward: -0.2577 | rev_kl: 1.4271 | stu_lens: 93.5000 | mixed_lens: 29.5000 | lr: 4.3114e-06 | scale: 1024.00 | time: 26.316 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1292/  5000| tot_loss: 3.4083 | rl_loss: 1.3144 | pt_loss: 2.0939 | pg_loss: 0.3028 | reg_loss: 1.0116 | reward: -0.2148 | rev_kl: 0.8901 | stu_lens: 86.0000 | mixed_lens: 90.5000 | lr: 4.3103e-06 | scale: 1024.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1293/  5000| tot_loss: 3.1669 | rl_loss: 1.5040 | pt_loss: 1.6629 | pg_loss: 0.3322 | reg_loss: 1.1718 | reward: -0.1636 | rev_kl: 1.2400 | stu_lens: 46.0000 | mixed_lens: 98.5000 | lr: 4.3092e-06 | scale: 1024.00 | time: 26.365 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1294/  5000| tot_loss: 3.1304 | rl_loss: 1.5491 | pt_loss: 1.5813 | pg_loss: 0.5785 | reg_loss: 0.9706 | reward: -0.5597 | rev_kl: 0.4733 | stu_lens: 84.5000 | mixed_lens: 75.0000 | lr: 4.3081e-06 | scale: 1024.00 | time: 26.359 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1295/  5000| tot_loss: 3.1951 | rl_loss: 1.1215 | pt_loss: 2.0736 | pg_loss: 0.1533 | reg_loss: 0.9682 | reward: -0.2451 | rev_kl: 1.0069 | stu_lens: 128.0000 | mixed_lens: 107.5000 | lr: 4.3070e-06 | scale: 1024.00 | time: 26.443 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1296/  5000| tot_loss: 2.8069 | rl_loss: 1.1554 | pt_loss: 1.6516 | pg_loss: 0.4363 | reg_loss: 0.7191 | reward: -0.4866 | rev_kl: 0.6373 | stu_lens: 69.0000 | mixed_lens: 68.5000 | lr: 4.3059e-06 | scale: 1024.00 | time: 26.398 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1296/  5000| tot_loss: 3.0836 | rl_loss: 1.3405 | pt_loss: 1.7431 | pg_loss: 0.4629 | reg_loss: 0.8776 | reward: -0.4030 | rev_kl: 0.8390 | stu_lens: 91.5781 | mixed_lens: 87.0469 | lr: 4.3059e-06 | scale: 1024.00 | time: 26.398 | step time: 27.649
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1297/  5000| tot_loss: 3.3657 | rl_loss: 1.3522 | pt_loss: 2.0135 | pg_loss: 0.4972 | reg_loss: 0.8550 | reward: -0.2054 | rev_kl: 0.5413 | stu_lens: 91.5000 | mixed_lens: 84.5000 | lr: 4.3048e-06 | scale: 1024.00 | time: 26.431 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1298/  5000| tot_loss: 2.3868 | rl_loss: 0.6561 | pt_loss: 1.7307 | pg_loss: 0.0055 | reg_loss: 0.6506 | reward: -0.2519 | rev_kl: 0.7850 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3037e-06 | scale: 1024.00 | time: 26.398 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1299/  5000| tot_loss: 2.4531 | rl_loss: 0.6523 | pt_loss: 1.8007 | pg_loss: 0.0462 | reg_loss: 0.6061 | reward: -0.1843 | rev_kl: 0.7672 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3026e-06 | scale: 1024.00 | time: 26.409 | step time: 0.000
                                 Evaluation #13                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son las partículas que    │
│                                       │ constituyen la estructura de los     │
│                                       │ hadrones. Existen tres tipos de      │
│                                       │ cuarks:                              │
│                                       │                                      │
│                                       │ - Cuarks up (cuarks superiores)      │
│                                       │ - Cuarks down (cuarks inferiores)    │
│                                       │ - Cuarks strange (cuarks estranños)  │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es el acrónimo de Imagen en   │
│                                       │ Movimiento. Es una técnica de        │
│                                       │ animación que consiste en dibujar    │
│                                       │ una imagen en movimiento mediante el │
│                                       │ empleo de diferentes tipos de        │
│                                       │ arañazos, o más simplemente, dibujar │
│                                       │ una imagen en movimiento. El IMC es  │
│                                       │ utilizado en muchas formas de        │
│                                       │ animación, tanto dibujada            │
│                                       │ manualmente, como por ordenador. La  │
│                                       │ utilidad del IMC viene dada por la   │
│                                       │ cantidad de detalles que puede ser   │
│                                       │ representado a la manera de una      │
│                                       │ simple imagen en movimiento.         │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ - Cápsula del tiempo de Ruso: creada │
│                                       │ en 1967, abierta en 1987, contenido: │
│                                       │ información sobre la cultura rusa y  │
│                                       │ un libro deaciones con un abstract   │
│                                       │ de la historia de Rusia.             │
│                                       │ - Cápsula del tiempo de Carl Sagan:  │
│                                       │ creada en 1977, abierta en 1999,     │
│                                       │ contenido: una grabación de Carl     │
│                                       │ Sagan, con información sobre la      │
│                                       │ historia de la tierra, la vida en    │
│                                       │ ella y los seres humanos.            │
│                                       │ - Cápsula del tiempo de Aust         │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.146 | exact_match: 0.000 | rev_kl: 0.864 | lens: 101.136 | pt_loss: 1.743 | lm_loss: 1.872 | kd_loss: 1.613 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1300/  5000| tot_loss: 4.5908 | rl_loss: 2.6173 | pt_loss: 1.9735 | pg_loss: 1.7576 | reg_loss: 0.8597 | reward: -1.1123 | rev_kl: 1.1304 | stu_lens: 87.0000 | mixed_lens: 21.5000 | lr: 4.3014e-06 | scale: 1024.00 | time: 26.387 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1301/  5000| tot_loss: 3.3515 | rl_loss: 1.3814 | pt_loss: 1.9701 | pg_loss: 0.8232 | reg_loss: 0.5582 | reward: -0.2464 | rev_kl: 0.7485 | stu_lens: 79.0000 | mixed_lens: 54.5000 | lr: 4.3003e-06 | scale: 1024.00 | time: 26.444 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1302/  5000| tot_loss: 2.5874 | rl_loss: 0.9994 | pt_loss: 1.5880 | pg_loss: 0.2656 | reg_loss: 0.7338 | reward: -0.5880 | rev_kl: 0.9148 | stu_lens: 124.5000 | mixed_lens: 84.0000 | lr: 4.2992e-06 | scale: 1024.00 | time: 26.390 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1303/  5000| tot_loss: 2.1440 | rl_loss: 0.5737 | pt_loss: 1.5704 | pg_loss: 0.0015 | reg_loss: 0.5721 | reward: -0.2984 | rev_kl: 0.6101 | stu_lens: 128.0000 | mixed_lens: 125.0000 | lr: 4.2981e-06 | scale: 1024.00 | time: 26.371 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1304/  5000| tot_loss: 2.6417 | rl_loss: 0.9751 | pt_loss: 1.6666 | pg_loss: 0.4377 | reg_loss: 0.5374 | reward: -0.5565 | rev_kl: 0.7952 | stu_lens: 74.5000 | mixed_lens: 81.0000 | lr: 4.2970e-06 | scale: 1024.00 | time: 26.412 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1305/  5000| tot_loss: 2.5486 | rl_loss: 0.8606 | pt_loss: 1.6880 | pg_loss: 0.2400 | reg_loss: 0.6206 | reward: -0.1925 | rev_kl: 0.8769 | stu_lens: 82.5000 | mixed_lens: 83.0000 | lr: 4.2959e-06 | scale: 1024.00 | time: 26.360 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1306/  5000| tot_loss: 2.6184 | rl_loss: 0.8641 | pt_loss: 1.7544 | pg_loss: 0.6499 | reg_loss: 0.2142 | reward: -0.2388 | rev_kl: 0.4002 | stu_lens: 91.5000 | mixed_lens: 40.0000 | lr: 4.2948e-06 | scale: 1024.00 | time: 26.386 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1307/  5000| tot_loss: 2.6495 | rl_loss: 1.1881 | pt_loss: 1.4615 | pg_loss: 0.4368 | reg_loss: 0.7512 | reward: -0.7177 | rev_kl: 1.0317 | stu_lens: 58.5000 | mixed_lens: 85.5000 | lr: 4.2936e-06 | scale: 1024.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1308/  5000| tot_loss: 3.3182 | rl_loss: 1.8726 | pt_loss: 1.4455 | pg_loss: 0.9974 | reg_loss: 0.8752 | reward: -1.2727 | rev_kl: 0.8528 | stu_lens: 86.0000 | mixed_lens: 39.0000 | lr: 4.2925e-06 | scale: 1024.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1309/  5000| tot_loss: 2.8122 | rl_loss: 0.7110 | pt_loss: 2.1013 | pg_loss: -0.0039 | reg_loss: 0.7149 | reward: -0.0149 | rev_kl: 0.6476 | stu_lens: 98.5000 | mixed_lens: 126.5000 | lr: 4.2914e-06 | scale: 1024.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1310/  5000| tot_loss: 2.5343 | rl_loss: 0.7930 | pt_loss: 1.7413 | pg_loss: 0.1248 | reg_loss: 0.6682 | reward: -0.2488 | rev_kl: 0.8926 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.2903e-06 | scale: 1024.00 | time: 26.360 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1311/  5000| tot_loss: 2.7639 | rl_loss: 1.1657 | pt_loss: 1.5982 | pg_loss: 0.6459 | reg_loss: 0.5198 | reward: -0.3603 | rev_kl: 0.9723 | stu_lens: 88.0000 | mixed_lens: 85.0000 | lr: 4.2892e-06 | scale: 1024.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1312/  5000| tot_loss: 2.2964 | rl_loss: 0.7990 | pt_loss: 1.4974 | pg_loss: 0.1809 | reg_loss: 0.6182 | reward: -0.1124 | rev_kl: 1.0049 | stu_lens: 116.5000 | mixed_lens: 104.0000 | lr: 4.2880e-06 | scale: 1024.00 | time: 26.390 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1312/  5000| tot_loss: 2.7352 | rl_loss: 0.9605 | pt_loss: 1.7747 | pg_loss: 0.3349 | reg_loss: 0.6256 | reward: -0.4033 | rev_kl: 0.8045 | stu_lens: 93.9531 | mixed_lens: 85.8438 | lr: 4.2880e-06 | scale: 1024.00 | time: 26.390 | step time: 27.661
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1313/  5000| tot_loss: 2.5566 | rl_loss: 0.7011 | pt_loss: 1.8555 | pg_loss: 0.3888 | reg_loss: 0.3122 | reward: -0.2447 | rev_kl: 0.3859 | stu_lens: 93.5000 | mixed_lens: 93.5000 | lr: 4.2869e-06 | scale: 1024.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1314/  5000| tot_loss: 3.3408 | rl_loss: 1.4729 | pt_loss: 1.8679 | pg_loss: 0.9825 | reg_loss: 0.4904 | reward: 0.0188 | rev_kl: 1.2195 | stu_lens: 72.0000 | mixed_lens: 42.0000 | lr: 4.2858e-06 | scale: 1024.00 | time: 26.375 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1315/  5000| tot_loss: 2.2872 | rl_loss: 0.6927 | pt_loss: 1.5945 | pg_loss: 0.0994 | reg_loss: 0.5932 | reward: -0.0869 | rev_kl: 0.8489 | stu_lens: 118.5000 | mixed_lens: 111.5000 | lr: 4.2847e-06 | scale: 1024.00 | time: 26.402 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1316/  5000| tot_loss: 2.3168 | rl_loss: 0.4870 | pt_loss: 1.8298 | pg_loss: 0.1696 | reg_loss: 0.3174 | reward: -0.1562 | rev_kl: 0.8011 | stu_lens: 62.0000 | mixed_lens: 83.0000 | lr: 4.2836e-06 | scale: 1024.00 | time: 26.432 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1317/  5000| tot_loss: 3.0100 | rl_loss: 0.9717 | pt_loss: 2.0383 | pg_loss: 0.4213 | reg_loss: 0.5505 | reward: -0.1122 | rev_kl: 0.8939 | stu_lens: 106.0000 | mixed_lens: 80.0000 | lr: 4.2824e-06 | scale: 1024.00 | time: 26.414 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1318/  5000| tot_loss: 2.1989 | rl_loss: 0.9869 | pt_loss: 1.2119 | pg_loss: 0.4357 | reg_loss: 0.5513 | reward: -0.3330 | rev_kl: 0.6149 | stu_lens: 80.0000 | mixed_lens: 84.5000 | lr: 4.2813e-06 | scale: 1024.00 | time: 26.421 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1319/  5000| tot_loss: 2.0574 | rl_loss: 0.6634 | pt_loss: 1.3940 | pg_loss: 0.3838 | reg_loss: 0.2796 | reward: -0.8951 | rev_kl: 0.6645 | stu_lens: 71.5000 | mixed_lens: 67.5000 | lr: 4.2802e-06 | scale: 1024.00 | time: 26.388 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1320/  5000| tot_loss: 4.1687 | rl_loss: 2.1386 | pt_loss: 2.0301 | pg_loss: 1.6783 | reg_loss: 0.4603 | reward: -0.7403 | rev_kl: 0.7994 | stu_lens: 23.0000 | mixed_lens: 19.5000 | lr: 4.2791e-06 | scale: 1024.00 | time: 26.395 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1321/  5000| tot_loss: 2.6628 | rl_loss: 0.8188 | pt_loss: 1.8440 | pg_loss: 0.3514 | reg_loss: 0.4673 | reward: -0.6119 | rev_kl: 0.8851 | stu_lens: 111.0000 | mixed_lens: 85.5000 | lr: 4.2779e-06 | scale: 1024.00 | time: 26.361 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1322/  5000| tot_loss: 2.8350 | rl_loss: 1.3427 | pt_loss: 1.4923 | pg_loss: 0.8558 | reg_loss: 0.4869 | reward: -0.6253 | rev_kl: 0.5710 | stu_lens: 84.5000 | mixed_lens: 46.5000 | lr: 4.2768e-06 | scale: 1024.00 | time: 26.385 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1323/  5000| tot_loss: 2.0073 | rl_loss: 0.4804 | pt_loss: 1.5269 | pg_loss: 0.0152 | reg_loss: 0.4651 | reward: -0.1440 | rev_kl: 0.8042 | stu_lens: 101.5000 | mixed_lens: 128.0000 | lr: 4.2757e-06 | scale: 1024.00 | time: 26.364 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1324/  5000| tot_loss: 2.7347 | rl_loss: 0.6464 | pt_loss: 2.0883 | pg_loss: 0.1735 | reg_loss: 0.4729 | reward: -0.1131 | rev_kl: 1.3640 | stu_lens: 76.5000 | mixed_lens: 98.5000 | lr: 4.2746e-06 | scale: 1024.00 | time: 26.387 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1325/  5000| tot_loss: 1.8142 | rl_loss: 0.3996 | pt_loss: 1.4146 | pg_loss: 0.2375 | reg_loss: 0.1621 | reward: -0.1825 | rev_kl: 0.8335 | stu_lens: 86.0000 | mixed_lens: 90.5000 | lr: 4.2734e-06 | scale: 1024.00 | time: 26.342 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1326/  5000| tot_loss: 2.4513 | rl_loss: 0.7910 | pt_loss: 1.6604 | pg_loss: 0.2211 | reg_loss: 0.5698 | reward: -0.2941 | rev_kl: 0.6295 | stu_lens: 128.0000 | mixed_lens: 97.0000 | lr: 4.2723e-06 | scale: 1024.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1327/  5000| tot_loss: 2.3239 | rl_loss: 0.4894 | pt_loss: 1.8345 | pg_loss: -0.0248 | reg_loss: 0.5142 | reward: -0.2114 | rev_kl: 0.8657 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.2712e-06 | scale: 1024.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1328/  5000| tot_loss: 2.3063 | rl_loss: 0.4877 | pt_loss: 1.8185 | pg_loss: -0.0238 | reg_loss: 0.5116 | reward: -0.4329 | rev_kl: 0.5777 | stu_lens: 86.5000 | mixed_lens: 128.0000 | lr: 4.2700e-06 | scale: 1024.00 | time: 26.399 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1328/  5000| tot_loss: 2.5325 | rl_loss: 0.8075 | pt_loss: 1.7250 | pg_loss: 0.3430 | reg_loss: 0.4646 | reward: -0.4087 | rev_kl: 0.8326 | stu_lens: 91.0000 | mixed_lens: 83.2500 | lr: 4.2700e-06 | scale: 1024.00 | time: 26.399 | step time: 27.665
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1329/  5000| tot_loss: 2.0298 | rl_loss: 0.2567 | pt_loss: 1.7731 | pg_loss: -0.0068 | reg_loss: 0.2635 | reward: -0.1031 | rev_kl: 0.7019 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.2689e-06 | scale: 1024.00 | time: 26.379 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1330/  5000| tot_loss: 1.9590 | rl_loss: 0.4161 | pt_loss: 1.5430 | pg_loss: 0.0200 | reg_loss: 0.3961 | reward: -0.1913 | rev_kl: 0.5086 | stu_lens: 128.0000 | mixed_lens: 122.0000 | lr: 4.2678e-06 | scale: 1024.00 | time: 26.395 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1331/  5000| tot_loss: 2.3032 | rl_loss: 0.5327 | pt_loss: 1.7704 | pg_loss: 0.1127 | reg_loss: 0.4200 | reward: -0.1478 | rev_kl: 0.8002 | stu_lens: 92.0000 | mixed_lens: 111.5000 | lr: 4.2666e-06 | scale: 1024.00 | time: 26.418 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1332/  5000| tot_loss: 2.5848 | rl_loss: 1.2459 | pt_loss: 1.3388 | pg_loss: 0.7820 | reg_loss: 0.4639 | reward: -2.0899 | rev_kl: 0.7881 | stu_lens: 23.0000 | mixed_lens: 22.5000 | lr: 4.2655e-06 | scale: 1024.00 | time: 26.467 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1333/  5000| tot_loss: 1.7835 | rl_loss: 0.4966 | pt_loss: 1.2869 | pg_loss: 0.2422 | reg_loss: 0.2543 | reward: -0.8814 | rev_kl: 0.4832 | stu_lens: 87.0000 | mixed_lens: 67.0000 | lr: 4.2644e-06 | scale: 1024.00 | time: 26.409 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1334/  5000| tot_loss: 2.7299 | rl_loss: 1.0100 | pt_loss: 1.7199 | pg_loss: 0.5348 | reg_loss: 0.4752 | reward: -0.7853 | rev_kl: 0.9809 | stu_lens: 71.5000 | mixed_lens: 67.5000 | lr: 4.2632e-06 | scale: 1024.00 | time: 26.433 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1335/  5000| tot_loss: 2.7117 | rl_loss: 0.6825 | pt_loss: 2.0292 | pg_loss: 0.3060 | reg_loss: 0.3766 | reward: -0.2890 | rev_kl: 0.9889 | stu_lens: 128.0000 | mixed_lens: 76.5000 | lr: 4.2621e-06 | scale: 1024.00 | time: 26.412 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1336/  5000| tot_loss: 2.1121 | rl_loss: 0.3887 | pt_loss: 1.7234 | pg_loss: -0.0116 | reg_loss: 0.4003 | reward: -0.3451 | rev_kl: 0.7016 | stu_lens: 86.5000 | mixed_lens: 128.0000 | lr: 4.2610e-06 | scale: 1024.00 | time: 26.430 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1337/  5000| tot_loss: 2.0730 | rl_loss: 0.3892 | pt_loss: 1.6837 | pg_loss: 0.0001 | reg_loss: 0.3892 | reward: -0.1508 | rev_kl: 0.8306 | stu_lens: 107.5000 | mixed_lens: 128.0000 | lr: 4.2598e-06 | scale: 1024.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1338/  5000| tot_loss: 2.3965 | rl_loss: 0.4237 | pt_loss: 1.9727 | pg_loss: 0.0055 | reg_loss: 0.4182 | reward: -0.2641 | rev_kl: 0.9169 | stu_lens: 128.0000 | mixed_lens: 125.0000 | lr: 4.2587e-06 | scale: 1024.00 | time: 26.421 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1339/  5000| tot_loss: 2.0283 | rl_loss: 0.3492 | pt_loss: 1.6791 | pg_loss: 0.1504 | reg_loss: 0.1989 | reward: -0.4062 | rev_kl: 0.6208 | stu_lens: 74.0000 | mixed_lens: 34.5000 | lr: 4.2575e-06 | scale: 1024.00 | time: 26.384 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1340/  5000| tot_loss: 2.1958 | rl_loss: 0.4491 | pt_loss: 1.7467 | pg_loss: 0.2195 | reg_loss: 0.2296 | reward: -0.2106 | rev_kl: 1.0133 | stu_lens: 128.0000 | mixed_lens: 98.0000 | lr: 4.2564e-06 | scale: 1024.00 | time: 26.379 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1341/  5000| tot_loss: 3.1382 | rl_loss: 1.5347 | pt_loss: 1.6035 | pg_loss: 0.7435 | reg_loss: 0.7912 | reward: -1.2324 | rev_kl: 1.0697 | stu_lens: 128.0000 | mixed_lens: 51.0000 | lr: 4.2553e-06 | scale: 1024.00 | time: 26.372 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1342/  5000| tot_loss: 2.5763 | rl_loss: 1.0048 | pt_loss: 1.5715 | pg_loss: 0.6425 | reg_loss: 0.3623 | reward: 0.2098 | rev_kl: 1.0759 | stu_lens: 50.0000 | mixed_lens: 50.5000 | lr: 4.2541e-06 | scale: 1024.00 | time: 26.390 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1343/  5000| tot_loss: 2.4295 | rl_loss: 0.4655 | pt_loss: 1.9640 | pg_loss: 0.0084 | reg_loss: 0.4572 | reward: -0.0541 | rev_kl: 0.8973 | stu_lens: 82.0000 | mixed_lens: 75.0000 | lr: 4.2530e-06 | scale: 1024.00 | time: 26.353 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1344/  5000| tot_loss: 3.0709 | rl_loss: 1.6967 | pt_loss: 1.3742 | pg_loss: 1.1312 | reg_loss: 0.5655 | reward: -0.6754 | rev_kl: 0.6007 | stu_lens: 88.0000 | mixed_lens: 40.5000 | lr: 4.2518e-06 | scale: 1024.00 | time: 26.345 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1344/  5000| tot_loss: 2.3454 | rl_loss: 0.6352 | pt_loss: 1.7101 | pg_loss: 0.2525 | reg_loss: 0.3827 | reward: -0.3864 | rev_kl: 0.8127 | stu_lens: 93.6875 | mixed_lens: 88.5469 | lr: 4.2518e-06 | scale: 1024.00 | time: 26.345 | step time: 27.684
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1345/  5000| tot_loss: 2.4638 | rl_loss: 1.5557 | pt_loss: 0.9080 | pg_loss: 1.1736 | reg_loss: 0.3821 | reward: -0.4874 | rev_kl: 1.0987 | stu_lens: 17.5000 | mixed_lens: 39.0000 | lr: 4.2507e-06 | scale: 1024.00 | time: 26.323 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1346/  5000| tot_loss: 3.0834 | rl_loss: 1.6123 | pt_loss: 1.4711 | pg_loss: 0.6113 | reg_loss: 1.0010 | reward: -0.4050 | rev_kl: 0.7447 | stu_lens: 51.0000 | mixed_lens: 38.0000 | lr: 4.2495e-06 | scale: 1024.00 | time: 26.361 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1347/  5000| tot_loss: 3.5701 | rl_loss: 1.9356 | pt_loss: 1.6345 | pg_loss: 0.5365 | reg_loss: 1.3991 | reward: -0.7994 | rev_kl: 0.4669 | stu_lens: 82.0000 | mixed_lens: 82.0000 | lr: 4.2484e-06 | scale: 1024.00 | time: 26.349 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1348/  5000| tot_loss: 2.6156 | rl_loss: 1.0249 | pt_loss: 1.5907 | pg_loss: 0.0380 | reg_loss: 0.9869 | reward: -0.4292 | rev_kl: 0.6956 | stu_lens: 120.5000 | mixed_lens: 128.0000 | lr: 4.2472e-06 | scale: 1024.00 | time: 26.353 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1349/  5000| tot_loss: 3.6312 | rl_loss: 2.0160 | pt_loss: 1.6152 | pg_loss: 1.1024 | reg_loss: 0.9136 | reward: -0.9002 | rev_kl: 0.5200 | stu_lens: 33.5000 | mixed_lens: 38.0000 | lr: 4.2461e-06 | scale: 1024.00 | time: 26.412 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1350/  5000| tot_loss: 2.5131 | rl_loss: 1.0427 | pt_loss: 1.4703 | pg_loss: 0.2440 | reg_loss: 0.7987 | reward: -0.2028 | rev_kl: 0.7551 | stu_lens: 63.5000 | mixed_lens: 94.5000 | lr: 4.2450e-06 | scale: 1024.00 | time: 26.419 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1351/  5000| tot_loss: 3.2705 | rl_loss: 1.6291 | pt_loss: 1.6414 | pg_loss: 0.5355 | reg_loss: 1.0937 | reward: -0.4972 | rev_kl: 0.9722 | stu_lens: 74.0000 | mixed_lens: 77.5000 | lr: 4.2438e-06 | scale: 1024.00 | time: 26.402 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1352/  5000| tot_loss: 2.9202 | rl_loss: 1.3788 | pt_loss: 1.5414 | pg_loss: 0.3847 | reg_loss: 0.9940 | reward: -0.3242 | rev_kl: 0.9723 | stu_lens: 93.5000 | mixed_lens: 93.5000 | lr: 4.2427e-06 | scale: 1024.00 | time: 26.383 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1353/  5000| tot_loss: 2.9888 | rl_loss: 1.7620 | pt_loss: 1.2268 | pg_loss: 1.0470 | reg_loss: 0.7150 | reward: -0.7414 | rev_kl: 0.7867 | stu_lens: 75.5000 | mixed_lens: 40.0000 | lr: 4.2415e-06 | scale: 1024.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1354/  5000| tot_loss: 2.8038 | rl_loss: 1.3123 | pt_loss: 1.4915 | pg_loss: 0.2433 | reg_loss: 1.0690 | reward: -0.2568 | rev_kl: 0.7799 | stu_lens: 87.0000 | mixed_lens: 88.0000 | lr: 4.2404e-06 | scale: 1024.00 | time: 26.368 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1355/  5000| tot_loss: 3.0310 | rl_loss: 0.9969 | pt_loss: 2.0341 | pg_loss: 0.1696 | reg_loss: 0.8274 | reward: -0.1158 | rev_kl: 0.6376 | stu_lens: 128.0000 | mixed_lens: 101.0000 | lr: 4.2392e-06 | scale: 1024.00 | time: 26.384 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1356/  5000| tot_loss: 3.2464 | rl_loss: 1.4290 | pt_loss: 1.8173 | pg_loss: 0.4017 | reg_loss: 1.0274 | reward: -0.1856 | rev_kl: 0.8803 | stu_lens: 78.0000 | mixed_lens: 77.0000 | lr: 4.2381e-06 | scale: 1024.00 | time: 26.348 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1357/  5000| tot_loss: 2.8962 | rl_loss: 0.7895 | pt_loss: 2.1067 | pg_loss: 0.1457 | reg_loss: 0.6438 | reward: -0.1412 | rev_kl: 0.6764 | stu_lens: 91.5000 | mixed_lens: 95.0000 | lr: 4.2369e-06 | scale: 1024.00 | time: 26.388 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1358/  5000| tot_loss: 3.2175 | rl_loss: 1.2129 | pt_loss: 2.0046 | pg_loss: 0.3103 | reg_loss: 0.9026 | reward: -0.4781 | rev_kl: 0.9054 | stu_lens: 77.5000 | mixed_lens: 74.5000 | lr: 4.2357e-06 | scale: 1024.00 | time: 26.341 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1359/  5000| tot_loss: 2.5989 | rl_loss: 0.9086 | pt_loss: 1.6903 | pg_loss: 0.0351 | reg_loss: 0.8735 | reward: -0.1526 | rev_kl: 0.9986 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.2346e-06 | scale: 1024.00 | time: 26.354 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1360/  5000| tot_loss: 3.7707 | rl_loss: 1.3832 | pt_loss: 2.3875 | pg_loss: 0.1606 | reg_loss: 1.2226 | reward: -0.4047 | rev_kl: 0.9486 | stu_lens: 93.0000 | mixed_lens: 116.0000 | lr: 4.2334e-06 | scale: 1024.00 | time: 26.332 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1360/  5000| tot_loss: 2.9536 | rl_loss: 1.2488 | pt_loss: 1.7048 | pg_loss: 0.3442 | reg_loss: 0.9046 | reward: -0.3352 | rev_kl: 0.8831 | stu_lens: 92.2969 | mixed_lens: 89.0781 | lr: 4.2334e-06 | scale: 1024.00 | time: 26.332 | step time: 27.657
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1361/  5000| tot_loss: 3.3793 | rl_loss: 1.5249 | pt_loss: 1.8544 | pg_loss: 0.6658 | reg_loss: 0.8591 | reward: -0.2351 | rev_kl: 0.5791 | stu_lens: 63.5000 | mixed_lens: 75.5000 | lr: 4.2323e-06 | scale: 1024.00 | time: 26.364 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1362/  5000| tot_loss: 2.5671 | rl_loss: 0.7401 | pt_loss: 1.8270 | pg_loss: 0.0173 | reg_loss: 0.7228 | reward: -0.0763 | rev_kl: 0.7519 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.2311e-06 | scale: 1024.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1363/  5000| tot_loss: 2.6054 | rl_loss: 0.7379 | pt_loss: 1.8675 | pg_loss: -0.0083 | reg_loss: 0.7462 | reward: -0.1356 | rev_kl: 0.9556 | stu_lens: 121.5000 | mixed_lens: 128.0000 | lr: 4.2300e-06 | scale: 1024.00 | time: 26.378 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1364/  5000| tot_loss: 2.7771 | rl_loss: 0.8706 | pt_loss: 1.9065 | pg_loss: 0.2386 | reg_loss: 0.6321 | reward: -0.2636 | rev_kl: 1.0139 | stu_lens: 128.0000 | mixed_lens: 96.0000 | lr: 4.2288e-06 | scale: 1024.00 | time: 26.354 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1365/  5000| tot_loss: 2.9483 | rl_loss: 1.3269 | pt_loss: 1.6214 | pg_loss: 0.3402 | reg_loss: 0.9867 | reward: -0.4357 | rev_kl: 0.9366 | stu_lens: 75.5000 | mixed_lens: 75.5000 | lr: 4.2277e-06 | scale: 1024.00 | time: 26.375 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1366/  5000| tot_loss: 2.4617 | rl_loss: 0.9969 | pt_loss: 1.4648 | pg_loss: 0.5184 | reg_loss: 0.4785 | reward: -0.1329 | rev_kl: 1.4575 | stu_lens: 69.5000 | mixed_lens: 44.5000 | lr: 4.2265e-06 | scale: 1024.00 | time: 26.386 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1367/  5000| tot_loss: 2.2197 | rl_loss: 0.6728 | pt_loss: 1.5468 | pg_loss: 0.1507 | reg_loss: 0.5221 | reward: -0.2111 | rev_kl: 0.9800 | stu_lens: 93.5000 | mixed_lens: 93.5000 | lr: 4.2253e-06 | scale: 1024.00 | time: 26.449 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1368/  5000| tot_loss: 1.5485 | rl_loss: 0.5944 | pt_loss: 0.9541 | pg_loss: 0.0404 | reg_loss: 0.5540 | reward: -0.0785 | rev_kl: 0.7766 | stu_lens: 98.5000 | mixed_lens: 128.0000 | lr: 4.2242e-06 | scale: 1024.00 | time: 26.405 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1369/  5000| tot_loss: 2.4850 | rl_loss: 0.9805 | pt_loss: 1.5045 | pg_loss: 0.2726 | reg_loss: 0.7080 | reward: -0.2295 | rev_kl: 0.7380 | stu_lens: 98.5000 | mixed_lens: 90.5000 | lr: 4.2230e-06 | scale: 1024.00 | time: 26.456 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1370/  5000| tot_loss: 2.5878 | rl_loss: 0.8372 | pt_loss: 1.7506 | pg_loss: 0.2179 | reg_loss: 0.6193 | reward: -0.2479 | rev_kl: 0.6718 | stu_lens: 87.0000 | mixed_lens: 88.0000 | lr: 4.2219e-06 | scale: 1024.00 | time: 26.437 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1371/  5000| tot_loss: 2.6907 | rl_loss: 0.9997 | pt_loss: 1.6910 | pg_loss: 0.3796 | reg_loss: 0.6202 | reward: -0.3846 | rev_kl: 0.7882 | stu_lens: 102.0000 | mixed_lens: 79.5000 | lr: 4.2207e-06 | scale: 1024.00 | time: 26.398 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1372/  5000| tot_loss: 2.6260 | rl_loss: 0.7207 | pt_loss: 1.9053 | pg_loss: 0.1294 | reg_loss: 0.5913 | reward: -0.3760 | rev_kl: 0.8579 | stu_lens: 93.0000 | mixed_lens: 116.0000 | lr: 4.2195e-06 | scale: 1024.00 | time: 26.388 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1373/  5000| tot_loss: 1.9025 | rl_loss: 0.7664 | pt_loss: 1.1361 | pg_loss: 0.0269 | reg_loss: 0.7395 | reward: -0.1840 | rev_kl: 2.2370 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.2184e-06 | scale: 1024.00 | time: 26.386 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1374/  5000| tot_loss: 3.6509 | rl_loss: 1.6971 | pt_loss: 1.9538 | pg_loss: 1.0213 | reg_loss: 0.6759 | reward: -0.5241 | rev_kl: 0.8865 | stu_lens: 103.5000 | mixed_lens: 39.0000 | lr: 4.2172e-06 | scale: 1024.00 | time: 26.347 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1375/  5000| tot_loss: 2.1132 | rl_loss: 0.6628 | pt_loss: 1.4503 | pg_loss: -0.0052 | reg_loss: 0.6680 | reward: -0.2505 | rev_kl: 0.6796 | stu_lens: 116.5000 | mixed_lens: 128.0000 | lr: 4.2160e-06 | scale: 1024.00 | time: 26.401 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1376/  5000| tot_loss: 2.9379 | rl_loss: 1.0012 | pt_loss: 1.9367 | pg_loss: 0.4765 | reg_loss: 0.5248 | reward: -0.2273 | rev_kl: 0.7233 | stu_lens: 67.0000 | mixed_lens: 72.0000 | lr: 4.2149e-06 | scale: 1024.00 | time: 26.344 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1376/  5000| tot_loss: 2.6173 | rl_loss: 0.9290 | pt_loss: 1.6883 | pg_loss: 0.2955 | reg_loss: 0.6335 | reward: -0.3190 | rev_kl: 0.8702 | stu_lens: 92.8594 | mixed_lens: 89.4688 | lr: 4.2149e-06 | scale: 1024.00 | time: 26.344 | step time: 27.668
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1377/  5000| tot_loss: 2.6763 | rl_loss: 0.6410 | pt_loss: 2.0352 | pg_loss: 0.0854 | reg_loss: 0.5556 | reward: -0.5517 | rev_kl: 1.1404 | stu_lens: 91.5000 | mixed_lens: 99.5000 | lr: 4.2137e-06 | scale: 1024.00 | time: 26.400 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1378/  5000| tot_loss: 2.3080 | rl_loss: 0.5657 | pt_loss: 1.7423 | pg_loss: 0.0745 | reg_loss: 0.4913 | reward: -0.2479 | rev_kl: 0.7825 | stu_lens: 80.0000 | mixed_lens: 117.0000 | lr: 4.2125e-06 | scale: 1024.00 | time: 26.354 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1379/  5000| tot_loss: 2.4871 | rl_loss: 0.9437 | pt_loss: 1.5434 | pg_loss: 0.2181 | reg_loss: 0.7256 | reward: -0.5036 | rev_kl: 0.7604 | stu_lens: 92.0000 | mixed_lens: 91.0000 | lr: 4.2114e-06 | scale: 1024.00 | time: 26.413 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1380/  5000| tot_loss: 1.9352 | rl_loss: 0.4744 | pt_loss: 1.4608 | pg_loss: 0.0253 | reg_loss: 0.4491 | reward: -0.1215 | rev_kl: 0.7220 | stu_lens: 98.5000 | mixed_lens: 128.0000 | lr: 4.2102e-06 | scale: 1024.00 | time: 26.406 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1381/  5000| tot_loss: 1.9707 | rl_loss: 0.5385 | pt_loss: 1.4322 | pg_loss: 0.2391 | reg_loss: 0.2995 | reward: -0.2390 | rev_kl: 1.5867 | stu_lens: 101.0000 | mixed_lens: 102.0000 | lr: 4.2090e-06 | scale: 1024.00 | time: 26.440 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1382/  5000| tot_loss: 2.5012 | rl_loss: 0.4435 | pt_loss: 2.0578 | pg_loss: -0.0032 | reg_loss: 0.4467 | reward: -0.3428 | rev_kl: 0.5338 | stu_lens: 108.0000 | mixed_lens: 128.0000 | lr: 4.2079e-06 | scale: 1024.00 | time: 26.407 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1383/  5000| tot_loss: 3.0835 | rl_loss: 1.1768 | pt_loss: 1.9067 | pg_loss: 0.5747 | reg_loss: 0.6022 | reward: -0.6899 | rev_kl: 0.5812 | stu_lens: 82.0000 | mixed_lens: 55.0000 | lr: 4.2067e-06 | scale: 1024.00 | time: 26.463 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1384/  5000| tot_loss: 2.9848 | rl_loss: 1.3871 | pt_loss: 1.5977 | pg_loss: 0.8638 | reg_loss: 0.5233 | reward: -0.3040 | rev_kl: 0.6806 | stu_lens: 42.5000 | mixed_lens: 42.0000 | lr: 4.2055e-06 | scale: 1024.00 | time: 26.453 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1385/  5000| tot_loss: 3.7389 | rl_loss: 1.6528 | pt_loss: 2.0861 | pg_loss: 1.1955 | reg_loss: 0.4573 | reward: -0.6729 | rev_kl: 0.8416 | stu_lens: 45.0000 | mixed_lens: 38.0000 | lr: 4.2043e-06 | scale: 1024.00 | time: 26.484 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1386/  5000| tot_loss: 2.6122 | rl_loss: 0.7878 | pt_loss: 1.8244 | pg_loss: 0.2210 | reg_loss: 0.5668 | reward: -0.5217 | rev_kl: 2.1200 | stu_lens: 113.5000 | mixed_lens: 90.5000 | lr: 4.2032e-06 | scale: 1024.00 | time: 26.459 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1387/  5000| tot_loss: 1.9173 | rl_loss: 0.4130 | pt_loss: 1.5044 | pg_loss: 0.0064 | reg_loss: 0.4065 | reward: -0.0837 | rev_kl: 1.1371 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.2020e-06 | scale: 1024.00 | time: 26.466 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1388/  5000| tot_loss: 2.4638 | rl_loss: 0.7886 | pt_loss: 1.6753 | pg_loss: 0.2166 | reg_loss: 0.5720 | reward: -0.2625 | rev_kl: 1.1917 | stu_lens: 128.0000 | mixed_lens: 96.0000 | lr: 4.2008e-06 | scale: 1024.00 | time: 26.443 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1389/  5000| tot_loss: 2.5840 | rl_loss: 0.6510 | pt_loss: 1.9330 | pg_loss: 0.1118 | reg_loss: 0.5392 | reward: -0.5244 | rev_kl: 1.1559 | stu_lens: 105.5000 | mixed_lens: 99.5000 | lr: 4.1996e-06 | scale: 1024.00 | time: 26.461 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1390/  5000| tot_loss: 2.4799 | rl_loss: 0.7600 | pt_loss: 1.7199 | pg_loss: 0.4051 | reg_loss: 0.3549 | reward: -0.3502 | rev_kl: 0.8628 | stu_lens: 75.5000 | mixed_lens: 75.5000 | lr: 4.1985e-06 | scale: 1024.00 | time: 26.405 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1391/  5000| tot_loss: 2.0810 | rl_loss: 0.5267 | pt_loss: 1.5543 | pg_loss: 0.0137 | reg_loss: 0.5131 | reward: -0.1213 | rev_kl: 1.1774 | stu_lens: 121.5000 | mixed_lens: 128.0000 | lr: 4.1973e-06 | scale: 1024.00 | time: 26.460 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1392/  5000| tot_loss: 2.3183 | rl_loss: 0.3473 | pt_loss: 1.9710 | pg_loss: 0.0087 | reg_loss: 0.3386 | reward: -0.1394 | rev_kl: 0.7018 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1961e-06 | scale: 1024.00 | time: 26.376 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1392/  5000| tot_loss: 2.5095 | rl_loss: 0.7537 | pt_loss: 1.7557 | pg_loss: 0.2662 | reg_loss: 0.4875 | reward: -0.3441 | rev_kl: 0.8941 | stu_lens: 95.0312 | mixed_lens: 91.7344 | lr: 4.1961e-06 | scale: 1024.00 | time: 26.376 | step time: 27.711
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1393/  5000| tot_loss: 2.2965 | rl_loss: 0.3458 | pt_loss: 1.9507 | pg_loss: -0.0053 | reg_loss: 0.3511 | reward: -0.0977 | rev_kl: 0.7191 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1949e-06 | scale: 1024.00 | time: 26.390 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1394/  5000| tot_loss: 1.8261 | rl_loss: 0.3906 | pt_loss: 1.4354 | pg_loss: 0.1088 | reg_loss: 0.2819 | reward: -0.0812 | rev_kl: 1.4506 | stu_lens: 71.5000 | mixed_lens: 102.0000 | lr: 4.1938e-06 | scale: 1024.00 | time: 26.406 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1395/  5000| tot_loss: 2.0606 | rl_loss: 0.2117 | pt_loss: 1.8489 | pg_loss: -0.0215 | reg_loss: 0.2332 | reward: -0.2869 | rev_kl: 0.7808 | stu_lens: 108.0000 | mixed_lens: 128.0000 | lr: 4.1926e-06 | scale: 1024.00 | time: 26.427 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1396/  5000| tot_loss: 2.4029 | rl_loss: 0.6350 | pt_loss: 1.7680 | pg_loss: 0.2699 | reg_loss: 0.3651 | reward: -0.3782 | rev_kl: 0.7291 | stu_lens: 77.5000 | mixed_lens: 74.5000 | lr: 4.1914e-06 | scale: 1024.00 | time: 26.396 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1397/  5000| tot_loss: 2.6466 | rl_loss: 0.5438 | pt_loss: 2.1027 | pg_loss: 0.2333 | reg_loss: 0.3105 | reward: -0.5879 | rev_kl: 0.9099 | stu_lens: 113.5000 | mixed_lens: 90.5000 | lr: 4.1902e-06 | scale: 1024.00 | time: 26.427 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1398/  5000| tot_loss: 2.5044 | rl_loss: 0.5017 | pt_loss: 2.0028 | pg_loss: 0.0022 | reg_loss: 0.4994 | reward: -0.2257 | rev_kl: 0.6076 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1890e-06 | scale: 1024.00 | time: 26.406 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1399/  5000| tot_loss: 2.2731 | rl_loss: 0.4618 | pt_loss: 1.8113 | pg_loss: 0.0252 | reg_loss: 0.4366 | reward: -0.2227 | rev_kl: 0.9291 | stu_lens: 124.5000 | mixed_lens: 124.5000 | lr: 4.1879e-06 | scale: 1024.00 | time: 26.394 | step time: 0.000
                                 Evaluation #14                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Existen dos tipos de cuarks: los     │
│                                       │ cuarks estándar y los cuarks de      │
│                                       │ Higgs. Los cuarks estándar son los   │
│                                       │ cuarks que se encuentran en la       │
│                                       │ teoría de la física de partículas de │
│                                       │ una dimensión de galaxia, mientras   │
│                                       │ que los cuarks de Higgs son los      │
│                                       │ cuarks que se encuentran en la       │
│                                       │ teoría de la física de partículas de │
│                                       │ dos dimensiones de galaxia.          │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es una herramienta de gestión │
│                                       │ de proyectos. Sus principales        │
│                                       │ propiedades son:                     │
│                                       │                                      │
│                                       │ 1. Es un entorno de desarrollo       │
│                                       │ integrado que includes un compiler   │
│                                       │ de sintaxis de lenguaje de           │
│                                       │ programación y herramientas de       │
│                                       │ dibujo.                              │
│                                       │ 2. Es un entorno de desarrollo       │
│                                       │ integrado que incluye un compilador  │
│                                       │ de sintaxis de lenguaje de           │
│                                       │ programación y herramientas de       │
│                                       │ dibujo.                              │
│                                       │ 3. Es un entorno de desarrollo       │
│                                       │ integrado que incluye un compilador  │
│                                       │ de sintaxis de lenguaje de           │
│                                       │ programación y herram                │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ 1. Pandora, 4000 a.C.                │
│                                       │ 2. Ark of the Covenant, 1250 a.C.    │
│                                       │ 3. Taj Mahal, 1632 a.C.              │
│                                       │ 4. Stonehenge, 2500 a.C.             │
│                                       │ 5. Great Pyramid of Giza, 2550 a.C.  │
│                                       │ 6. Mayan Calendar, 2600 a.C.         │
│                                       │ 7. Ayutthaya, 1350 a.C.              │
│                                       │ 8. Great Wall of China,              │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.910 | exact_match: 0.000 | rev_kl: 0.862 | lens: 99.240 | pt_loss: 1.744 | lm_loss: 1.874 | kd_loss: 1.614 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1400/  5000| tot_loss: 2.5142 | rl_loss: 0.8218 | pt_loss: 1.6924 | pg_loss: 0.4531 | reg_loss: 0.3687 | reward: -0.2803 | rev_kl: 0.8642 | stu_lens: 93.5000 | mixed_lens: 66.5000 | lr: 4.1867e-06 | scale: 1024.00 | time: 26.407 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1401/  5000| tot_loss: 2.5831 | rl_loss: 0.6301 | pt_loss: 1.9530 | pg_loss: 0.3708 | reg_loss: 0.2593 | reward: -0.1867 | rev_kl: 0.7024 | stu_lens: 78.0000 | mixed_lens: 77.0000 | lr: 4.1855e-06 | scale: 1024.00 | time: 26.437 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1402/  5000| tot_loss: 2.4962 | rl_loss: 0.4363 | pt_loss: 2.0599 | pg_loss: 0.0921 | reg_loss: 0.3442 | reward: -0.1564 | rev_kl: 0.7304 | stu_lens: 65.0000 | mixed_lens: 117.0000 | lr: 4.1843e-06 | scale: 1024.00 | time: 26.404 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1403/  5000| tot_loss: 2.5339 | rl_loss: 0.5553 | pt_loss: 1.9786 | pg_loss: 0.1149 | reg_loss: 0.4404 | reward: -0.2418 | rev_kl: 2.0050 | stu_lens: 100.5000 | mixed_lens: 95.0000 | lr: 4.1831e-06 | scale: 1024.00 | time: 26.380 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1404/  5000| tot_loss: 2.4177 | rl_loss: 0.6309 | pt_loss: 1.7868 | pg_loss: 0.2200 | reg_loss: 0.4109 | reward: -0.5351 | rev_kl: 0.5921 | stu_lens: 92.0000 | mixed_lens: 91.0000 | lr: 4.1819e-06 | scale: 1024.00 | time: 26.402 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1405/  5000| tot_loss: 2.2129 | rl_loss: 0.4941 | pt_loss: 1.7188 | pg_loss: 0.1709 | reg_loss: 0.3232 | reward: -0.4128 | rev_kl: 0.9600 | stu_lens: 102.0000 | mixed_lens: 103.5000 | lr: 4.1808e-06 | scale: 1024.00 | time: 26.461 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1406/  5000| tot_loss: 2.1825 | rl_loss: 0.5882 | pt_loss: 1.5943 | pg_loss: 0.1901 | reg_loss: 0.3980 | reward: -0.2225 | rev_kl: 1.0010 | stu_lens: 100.0000 | mixed_lens: 102.0000 | lr: 4.1796e-06 | scale: 1024.00 | time: 26.473 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1407/  5000| tot_loss: 1.9818 | rl_loss: 0.3200 | pt_loss: 1.6618 | pg_loss: 0.0424 | reg_loss: 0.2776 | reward: -0.4396 | rev_kl: 0.7137 | stu_lens: 90.0000 | mixed_lens: 51.0000 | lr: 4.1784e-06 | scale: 1024.00 | time: 26.431 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1408/  5000| tot_loss: 2.7230 | rl_loss: 0.9416 | pt_loss: 1.7814 | pg_loss: 0.3511 | reg_loss: 0.5905 | reward: -0.4954 | rev_kl: 0.5303 | stu_lens: 128.0000 | mixed_lens: 76.0000 | lr: 4.1772e-06 | scale: 1024.00 | time: 26.431 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1408/  5000| tot_loss: 2.4255 | rl_loss: 0.6084 | pt_loss: 1.8171 | pg_loss: 0.2359 | reg_loss: 0.3725 | reward: -0.3222 | rev_kl: 0.8684 | stu_lens: 93.6875 | mixed_lens: 90.2969 | lr: 4.1772e-06 | scale: 1024.00 | time: 26.431 | step time: 27.696
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1409/  5000| tot_loss: 2.6543 | rl_loss: 0.6008 | pt_loss: 2.0535 | pg_loss: 0.3009 | reg_loss: 0.2999 | reward: -0.4612 | rev_kl: 0.6260 | stu_lens: 67.5000 | mixed_lens: 78.5000 | lr: 4.1760e-06 | scale: 1024.00 | time: 26.455 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1410/  5000| tot_loss: 3.3978 | rl_loss: 1.4133 | pt_loss: 1.9845 | pg_loss: 0.6196 | reg_loss: 0.7937 | reward: -0.4001 | rev_kl: 0.5804 | stu_lens: 84.0000 | mixed_lens: 52.5000 | lr: 4.1748e-06 | scale: 1024.00 | time: 26.500 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1411/  5000| tot_loss: 2.9551 | rl_loss: 1.0392 | pt_loss: 1.9158 | pg_loss: 0.0634 | reg_loss: 0.9758 | reward: -0.1217 | rev_kl: 1.1479 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1736e-06 | scale: 1024.00 | time: 26.448 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1412/  5000| tot_loss: 2.3233 | rl_loss: 0.6715 | pt_loss: 1.6518 | pg_loss: 0.0647 | reg_loss: 0.6068 | reward: -0.0845 | rev_kl: 0.7191 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1724e-06 | scale: 1024.00 | time: 26.443 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1413/  5000| tot_loss: 3.0363 | rl_loss: 1.2782 | pt_loss: 1.7581 | pg_loss: 0.1523 | reg_loss: 1.1259 | reward: -0.2710 | rev_kl: 0.9999 | stu_lens: 128.0000 | mixed_lens: 107.5000 | lr: 4.1712e-06 | scale: 1024.00 | time: 26.449 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1414/  5000| tot_loss: 2.7236 | rl_loss: 0.9882 | pt_loss: 1.7354 | pg_loss: 0.1673 | reg_loss: 0.8210 | reward: -0.1554 | rev_kl: 0.7566 | stu_lens: 123.5000 | mixed_lens: 104.0000 | lr: 4.1700e-06 | scale: 1024.00 | time: 26.390 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1415/  5000| tot_loss: 3.2389 | rl_loss: 1.1430 | pt_loss: 2.0959 | pg_loss: 0.3137 | reg_loss: 0.8292 | reward: -0.3341 | rev_kl: 0.9081 | stu_lens: 128.0000 | mixed_lens: 88.5000 | lr: 4.1689e-06 | scale: 1024.00 | time: 26.416 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1416/  5000| tot_loss: 2.4753 | rl_loss: 0.8974 | pt_loss: 1.5779 | pg_loss: 0.0458 | reg_loss: 0.8516 | reward: -0.1820 | rev_kl: 0.6645 | stu_lens: 100.0000 | mixed_lens: 128.0000 | lr: 4.1677e-06 | scale: 1024.00 | time: 26.380 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1417/  5000| tot_loss: 3.0371 | rl_loss: 1.0750 | pt_loss: 1.9621 | pg_loss: 0.1960 | reg_loss: 0.8791 | reward: -0.2168 | rev_kl: 0.8735 | stu_lens: 128.0000 | mixed_lens: 107.0000 | lr: 4.1665e-06 | scale: 1024.00 | time: 26.418 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1418/  5000| tot_loss: 2.7827 | rl_loss: 1.2100 | pt_loss: 1.5727 | pg_loss: 0.0944 | reg_loss: 1.1156 | reward: -0.3337 | rev_kl: 0.8056 | stu_lens: 93.0000 | mixed_lens: 123.5000 | lr: 4.1653e-06 | scale: 1024.00 | time: 26.417 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1419/  5000| tot_loss: 3.0619 | rl_loss: 0.9968 | pt_loss: 2.0651 | pg_loss: 0.0246 | reg_loss: 0.9723 | reward: -0.0907 | rev_kl: 0.6844 | stu_lens: 73.0000 | mixed_lens: 128.0000 | lr: 4.1641e-06 | scale: 1024.00 | time: 26.463 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1420/  5000| tot_loss: 2.6253 | rl_loss: 1.0551 | pt_loss: 1.5702 | pg_loss: 0.2996 | reg_loss: 0.7556 | reward: -0.0561 | rev_kl: 0.4900 | stu_lens: 75.5000 | mixed_lens: 92.5000 | lr: 4.1629e-06 | scale: 1024.00 | time: 26.421 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1421/  5000| tot_loss: 2.2327 | rl_loss: 0.8927 | pt_loss: 1.3400 | pg_loss: 0.2767 | reg_loss: 0.6160 | reward: -0.0184 | rev_kl: 0.9560 | stu_lens: 48.5000 | mixed_lens: 77.5000 | lr: 4.1617e-06 | scale: 1024.00 | time: 26.446 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1422/  5000| tot_loss: 2.9534 | rl_loss: 1.0220 | pt_loss: 1.9314 | pg_loss: 0.2353 | reg_loss: 0.7867 | reward: -0.5136 | rev_kl: 0.4164 | stu_lens: 55.0000 | mixed_lens: 79.0000 | lr: 4.1605e-06 | scale: 1024.00 | time: 26.418 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1423/  5000| tot_loss: 2.4682 | rl_loss: 1.0754 | pt_loss: 1.3928 | pg_loss: 0.1364 | reg_loss: 0.9390 | reward: -0.1370 | rev_kl: 1.1625 | stu_lens: 124.5000 | mixed_lens: 116.5000 | lr: 4.1593e-06 | scale: 1024.00 | time: 26.465 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1424/  5000| tot_loss: 2.6644 | rl_loss: 1.0695 | pt_loss: 1.5949 | pg_loss: 0.1523 | reg_loss: 0.9172 | reward: -0.5094 | rev_kl: 0.9467 | stu_lens: 128.0000 | mixed_lens: 74.0000 | lr: 4.1581e-06 | scale: 1024.00 | time: 26.442 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1424/  5000| tot_loss: 2.8530 | rl_loss: 1.1023 | pt_loss: 1.7507 | pg_loss: 0.2508 | reg_loss: 0.8514 | reward: -0.2875 | rev_kl: 0.7864 | stu_lens: 95.6250 | mixed_lens: 96.1875 | lr: 4.1581e-06 | scale: 1024.00 | time: 26.442 | step time: 27.721
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1425/  5000| tot_loss: 3.1163 | rl_loss: 0.9912 | pt_loss: 2.1251 | pg_loss: 0.0241 | reg_loss: 0.9671 | reward: -0.0477 | rev_kl: 0.6915 | stu_lens: 79.5000 | mixed_lens: 128.0000 | lr: 4.1569e-06 | scale: 1024.00 | time: 26.464 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1426/  5000| tot_loss: 2.4229 | rl_loss: 0.8296 | pt_loss: 1.5933 | pg_loss: 0.1131 | reg_loss: 0.7165 | reward: -0.6171 | rev_kl: 0.7152 | stu_lens: 46.0000 | mixed_lens: 77.5000 | lr: 4.1557e-06 | scale: 1024.00 | time: 26.490 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1427/  5000| tot_loss: 2.4919 | rl_loss: 0.6559 | pt_loss: 1.8360 | pg_loss: 0.1907 | reg_loss: 0.4653 | reward: -0.4956 | rev_kl: 0.4753 | stu_lens: 84.0000 | mixed_lens: 79.0000 | lr: 4.1545e-06 | scale: 1024.00 | time: 26.450 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1428/  5000| tot_loss: 2.7235 | rl_loss: 0.8157 | pt_loss: 1.9078 | pg_loss: 0.1311 | reg_loss: 0.6846 | reward: -0.2400 | rev_kl: 1.1686 | stu_lens: 128.0000 | mixed_lens: 102.0000 | lr: 4.1533e-06 | scale: 1024.00 | time: 26.503 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1429/  5000| tot_loss: 2.5025 | rl_loss: 0.6119 | pt_loss: 1.8906 | pg_loss: 0.0642 | reg_loss: 0.5478 | reward: -0.1988 | rev_kl: 0.6802 | stu_lens: 65.5000 | mixed_lens: 114.5000 | lr: 4.1521e-06 | scale: 1024.00 | time: 26.514 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1430/  5000| tot_loss: 2.2411 | rl_loss: 0.4702 | pt_loss: 1.7710 | pg_loss: -0.0128 | reg_loss: 0.4830 | reward: -0.0568 | rev_kl: 0.8017 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1509e-06 | scale: 1024.00 | time: 26.497 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1431/  5000| tot_loss: 2.4651 | rl_loss: 0.7080 | pt_loss: 1.7571 | pg_loss: -0.0008 | reg_loss: 0.7088 | reward: -0.1737 | rev_kl: 0.8942 | stu_lens: 117.0000 | mixed_lens: 128.0000 | lr: 4.1497e-06 | scale: 1024.00 | time: 26.504 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1432/  5000| tot_loss: 2.1109 | rl_loss: 1.0289 | pt_loss: 1.0820 | pg_loss: 0.4424 | reg_loss: 0.5865 | reward: -0.1382 | rev_kl: 1.1544 | stu_lens: 62.5000 | mixed_lens: 75.0000 | lr: 4.1485e-06 | scale: 1024.00 | time: 26.474 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1433/  5000| tot_loss: 2.6197 | rl_loss: 1.0058 | pt_loss: 1.6140 | pg_loss: 0.2019 | reg_loss: 0.8039 | reward: -0.0429 | rev_kl: 0.5516 | stu_lens: 42.5000 | mixed_lens: 74.0000 | lr: 4.1473e-06 | scale: 1024.00 | time: 26.482 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1434/  5000| tot_loss: 2.0960 | rl_loss: 0.7389 | pt_loss: 1.3571 | pg_loss: 0.1663 | reg_loss: 0.5726 | reward: -0.1378 | rev_kl: 0.5822 | stu_lens: 100.5000 | mixed_lens: 100.0000 | lr: 4.1461e-06 | scale: 1024.00 | time: 26.423 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1435/  5000| tot_loss: 2.6771 | rl_loss: 0.7813 | pt_loss: 1.8958 | pg_loss: 0.0364 | reg_loss: 0.7449 | reward: -0.0885 | rev_kl: 0.7170 | stu_lens: 127.5000 | mixed_lens: 126.0000 | lr: 4.1448e-06 | scale: 1024.00 | time: 26.439 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1436/  5000| tot_loss: 2.3343 | rl_loss: 0.6970 | pt_loss: 1.6373 | pg_loss: 0.1733 | reg_loss: 0.5237 | reward: -0.5361 | rev_kl: 0.6646 | stu_lens: 62.0000 | mixed_lens: 81.0000 | lr: 4.1436e-06 | scale: 1024.00 | time: 26.457 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1437/  5000| tot_loss: 2.3921 | rl_loss: 0.6725 | pt_loss: 1.7196 | pg_loss: 0.0852 | reg_loss: 0.5872 | reward: 0.0269 | rev_kl: 0.2801 | stu_lens: 31.5000 | mixed_lens: 92.5000 | lr: 4.1424e-06 | scale: 1024.00 | time: 26.486 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1438/  5000| tot_loss: 2.5739 | rl_loss: 0.7233 | pt_loss: 1.8505 | pg_loss: 0.1079 | reg_loss: 0.6155 | reward: -0.1171 | rev_kl: 0.5942 | stu_lens: 113.5000 | mixed_lens: 99.5000 | lr: 4.1412e-06 | scale: 1024.00 | time: 26.458 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1439/  5000| tot_loss: 2.7389 | rl_loss: 1.0341 | pt_loss: 1.7048 | pg_loss: 0.4066 | reg_loss: 0.6275 | reward: -0.5097 | rev_kl: 0.7640 | stu_lens: 53.0000 | mixed_lens: 64.0000 | lr: 4.1400e-06 | scale: 1024.00 | time: 26.474 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1440/  5000| tot_loss: 2.7566 | rl_loss: 0.9452 | pt_loss: 1.8114 | pg_loss: 0.3454 | reg_loss: 0.5999 | reward: -0.4179 | rev_kl: 0.3634 | stu_lens: 77.5000 | mixed_lens: 77.5000 | lr: 4.1388e-06 | scale: 1024.00 | time: 26.435 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1440/  5000| tot_loss: 2.4999 | rl_loss: 0.7638 | pt_loss: 1.7361 | pg_loss: 0.1307 | reg_loss: 0.6331 | reward: -0.2450 | rev_kl: 0.7905 | stu_lens: 93.8281 | mixed_lens: 101.7656 | lr: 4.1388e-06 | scale: 1024.00 | time: 26.435 | step time: 27.752
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1441/  5000| tot_loss: 2.4224 | rl_loss: 0.8090 | pt_loss: 1.6134 | pg_loss: 0.2361 | reg_loss: 0.5729 | reward: -0.3560 | rev_kl: 0.6400 | stu_lens: 110.5000 | mixed_lens: 83.0000 | lr: 4.1376e-06 | scale: 1024.00 | time: 26.462 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1442/  5000| tot_loss: 2.8352 | rl_loss: 0.8131 | pt_loss: 2.0220 | pg_loss: 0.2611 | reg_loss: 0.5521 | reward: -0.5893 | rev_kl: 0.9156 | stu_lens: 75.0000 | mixed_lens: 77.5000 | lr: 4.1364e-06 | scale: 1024.00 | time: 26.437 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1443/  5000| tot_loss: 2.7343 | rl_loss: 1.1482 | pt_loss: 1.5861 | pg_loss: 0.8526 | reg_loss: 0.2955 | reward: -0.4489 | rev_kl: 0.6723 | stu_lens: 43.0000 | mixed_lens: 28.5000 | lr: 4.1352e-06 | scale: 1024.00 | time: 26.467 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1444/  5000| tot_loss: 1.9778 | rl_loss: 0.5035 | pt_loss: 1.4744 | pg_loss: -0.0173 | reg_loss: 0.5208 | reward: -0.2124 | rev_kl: 1.1506 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1340e-06 | scale: 1024.00 | time: 26.440 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1445/  5000| tot_loss: 2.5500 | rl_loss: 0.4942 | pt_loss: 2.0558 | pg_loss: -0.0141 | reg_loss: 0.5083 | reward: -0.0933 | rev_kl: 0.6470 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1327e-06 | scale: 1024.00 | time: 26.461 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1446/  5000| tot_loss: 2.2924 | rl_loss: 0.3785 | pt_loss: 1.9139 | pg_loss: -0.0030 | reg_loss: 0.3815 | reward: -0.0332 | rev_kl: 0.5434 | stu_lens: 79.5000 | mixed_lens: 128.0000 | lr: 4.1315e-06 | scale: 1024.00 | time: 26.443 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1447/  5000| tot_loss: 1.8455 | rl_loss: 0.4029 | pt_loss: 1.4426 | pg_loss: -0.0091 | reg_loss: 0.4120 | reward: -0.0626 | rev_kl: 0.6058 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1303e-06 | scale: 1024.00 | time: 26.462 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1448/  5000| tot_loss: 1.6833 | rl_loss: 0.5521 | pt_loss: 1.1312 | pg_loss: 0.2274 | reg_loss: 0.3246 | reward: -0.5633 | rev_kl: 0.8133 | stu_lens: 80.5000 | mixed_lens: 74.0000 | lr: 4.1291e-06 | scale: 1024.00 | time: 26.455 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1449/  5000| tot_loss: 2.2670 | rl_loss: 0.3737 | pt_loss: 1.8932 | pg_loss: 0.0263 | reg_loss: 0.3474 | reward: -0.0399 | rev_kl: 0.2713 | stu_lens: 46.5000 | mixed_lens: 92.5000 | lr: 4.1279e-06 | scale: 1024.00 | time: 26.504 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1450/  5000| tot_loss: 3.1353 | rl_loss: 1.1686 | pt_loss: 1.9667 | pg_loss: 0.6606 | reg_loss: 0.5079 | reward: -0.0854 | rev_kl: 1.0799 | stu_lens: 85.0000 | mixed_lens: 46.5000 | lr: 4.1267e-06 | scale: 1024.00 | time: 26.446 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1451/  5000| tot_loss: 2.2039 | rl_loss: 0.4068 | pt_loss: 1.7971 | pg_loss: 0.0098 | reg_loss: 0.3970 | reward: -0.0479 | rev_kl: 0.8252 | stu_lens: 127.5000 | mixed_lens: 126.0000 | lr: 4.1254e-06 | scale: 1024.00 | time: 26.481 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1452/  5000| tot_loss: 2.2768 | rl_loss: 0.5069 | pt_loss: 1.7699 | pg_loss: 0.0171 | reg_loss: 0.4898 | reward: -0.1553 | rev_kl: 0.2412 | stu_lens: 77.5000 | mixed_lens: 124.5000 | lr: 4.1242e-06 | scale: 1024.00 | time: 26.495 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1453/  5000| tot_loss: 2.0808 | rl_loss: 0.4544 | pt_loss: 1.6264 | pg_loss: 0.0118 | reg_loss: 0.4425 | reward: -0.1404 | rev_kl: 0.8662 | stu_lens: 128.0000 | mixed_lens: 123.5000 | lr: 4.1230e-06 | scale: 1024.00 | time: 26.491 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1454/  5000| tot_loss: 2.1019 | rl_loss: 0.3687 | pt_loss: 1.7332 | pg_loss: -0.0170 | reg_loss: 0.3857 | reward: -0.1378 | rev_kl: 0.7136 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1218e-06 | scale: 1024.00 | time: 26.518 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1455/  5000| tot_loss: 2.0544 | rl_loss: 0.7949 | pt_loss: 1.2594 | pg_loss: 0.1543 | reg_loss: 0.6406 | reward: -0.2527 | rev_kl: 1.0541 | stu_lens: 117.0000 | mixed_lens: 107.0000 | lr: 4.1206e-06 | scale: 1024.00 | time: 26.522 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1456/  5000| tot_loss: 2.0648 | rl_loss: 0.4794 | pt_loss: 1.5855 | pg_loss: 0.0828 | reg_loss: 0.3966 | reward: -0.0801 | rev_kl: 0.8825 | stu_lens: 71.5000 | mixed_lens: 114.5000 | lr: 4.1194e-06 | scale: 1024.00 | time: 26.490 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1456/  5000| tot_loss: 2.3521 | rl_loss: 0.6392 | pt_loss: 1.7129 | pg_loss: 0.2020 | reg_loss: 0.4372 | reward: -0.2940 | rev_kl: 0.7688 | stu_lens: 94.6094 | mixed_lens: 94.3125 | lr: 4.1194e-06 | scale: 1024.00 | time: 26.490 | step time: 27.753
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1457/  5000| tot_loss: 1.9069 | rl_loss: 0.4315 | pt_loss: 1.4755 | pg_loss: -0.0218 | reg_loss: 0.4532 | reward: -0.0480 | rev_kl: 0.6879 | stu_lens: 84.0000 | mixed_lens: 128.0000 | lr: 4.1181e-06 | scale: 1024.00 | time: 26.521 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1458/  5000| tot_loss: 2.0172 | rl_loss: 0.4710 | pt_loss: 1.5462 | pg_loss: 0.2007 | reg_loss: 0.2703 | reward: -0.5807 | rev_kl: 1.1638 | stu_lens: 128.0000 | mixed_lens: 74.0000 | lr: 4.1169e-06 | scale: 1024.00 | time: 26.493 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1459/  5000| tot_loss: 2.2647 | rl_loss: 0.5716 | pt_loss: 1.6930 | pg_loss: 0.2370 | reg_loss: 0.3347 | reward: -0.3341 | rev_kl: 0.9081 | stu_lens: 128.0000 | mixed_lens: 88.5000 | lr: 4.1157e-06 | scale: 1024.00 | time: 26.512 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1460/  5000| tot_loss: 2.4369 | rl_loss: 0.9881 | pt_loss: 1.4488 | pg_loss: 0.6065 | reg_loss: 0.3816 | reward: -0.3875 | rev_kl: 0.4021 | stu_lens: 63.0000 | mixed_lens: 49.0000 | lr: 4.1145e-06 | scale: 1024.00 | time: 26.448 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1461/  5000| tot_loss: 2.3162 | rl_loss: 0.2952 | pt_loss: 2.0210 | pg_loss: -0.0020 | reg_loss: 0.2972 | reward: -0.1841 | rev_kl: 0.7315 | stu_lens: 109.0000 | mixed_lens: 128.0000 | lr: 4.1132e-06 | scale: 1024.00 | time: 26.464 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1462/  5000| tot_loss: 1.6767 | rl_loss: 0.5942 | pt_loss: 1.0824 | pg_loss: 0.2019 | reg_loss: 0.3923 | reward: -0.6016 | rev_kl: 0.9346 | stu_lens: 75.0000 | mixed_lens: 77.5000 | lr: 4.1120e-06 | scale: 1024.00 | time: 26.464 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1463/  5000| tot_loss: 2.0853 | rl_loss: 0.3506 | pt_loss: 1.7348 | pg_loss: 0.0049 | reg_loss: 0.3457 | reward: -0.1421 | rev_kl: 0.7093 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.1108e-06 | scale: 1024.00 | time: 26.447 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1464/  5000| tot_loss: 2.1641 | rl_loss: 0.8508 | pt_loss: 1.3133 | pg_loss: 0.4191 | reg_loss: 0.4317 | reward: -0.3963 | rev_kl: 1.0878 | stu_lens: 94.5000 | mixed_lens: 78.5000 | lr: 4.1096e-06 | scale: 1024.00 | time: 26.424 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1465/  5000| tot_loss: 2.5354 | rl_loss: 0.6412 | pt_loss: 1.8942 | pg_loss: 0.2771 | reg_loss: 0.3641 | reward: -0.5895 | rev_kl: 0.4329 | stu_lens: 56.0000 | mixed_lens: 79.0000 | lr: 4.1083e-06 | scale: 1024.00 | time: 26.442 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1466/  5000| tot_loss: 2.0748 | rl_loss: 0.3541 | pt_loss: 1.7207 | pg_loss: -0.0235 | reg_loss: 0.3775 | reward: -0.0248 | rev_kl: 0.7484 | stu_lens: 84.0000 | mixed_lens: 128.0000 | lr: 4.1071e-06 | scale: 1024.00 | time: 26.413 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1467/  5000| tot_loss: 2.4285 | rl_loss: 0.3513 | pt_loss: 2.0772 | pg_loss: 0.0102 | reg_loss: 0.3412 | reward: -0.0896 | rev_kl: 0.3546 | stu_lens: 83.5000 | mixed_lens: 124.5000 | lr: 4.1059e-06 | scale: 1024.00 | time: 26.440 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1468/  5000| tot_loss: 2.4878 | rl_loss: 0.7527 | pt_loss: 1.7350 | pg_loss: 0.5151 | reg_loss: 0.2376 | reward: -0.4944 | rev_kl: 0.7030 | stu_lens: 24.5000 | mixed_lens: 67.5000 | lr: 4.1046e-06 | scale: 1024.00 | time: 26.416 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1469/  5000| tot_loss: 2.4129 | rl_loss: 0.5143 | pt_loss: 1.8986 | pg_loss: 0.1203 | reg_loss: 0.3940 | reward: -0.1230 | rev_kl: 0.6679 | stu_lens: 52.0000 | mixed_lens: 100.0000 | lr: 4.1034e-06 | scale: 1024.00 | time: 26.460 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1470/  5000| tot_loss: 1.9676 | rl_loss: 0.5345 | pt_loss: 1.4331 | pg_loss: -0.0318 | reg_loss: 0.5663 | reward: -0.3097 | rev_kl: 0.8064 | stu_lens: 82.0000 | mixed_lens: 128.0000 | lr: 4.1022e-06 | scale: 1024.00 | time: 26.452 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1471/  5000| tot_loss: 1.6178 | rl_loss: 0.3665 | pt_loss: 1.2513 | pg_loss: -0.0197 | reg_loss: 0.3861 | reward: -0.1606 | rev_kl: 0.5391 | stu_lens: 122.0000 | mixed_lens: 128.0000 | lr: 4.1010e-06 | scale: 1024.00 | time: 26.478 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1472/  5000| tot_loss: 2.1331 | rl_loss: 0.5339 | pt_loss: 1.5992 | pg_loss: 0.1259 | reg_loss: 0.4079 | reward: -0.1546 | rev_kl: 0.9861 | stu_lens: 128.0000 | mixed_lens: 107.0000 | lr: 4.0997e-06 | scale: 1024.00 | time: 26.453 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1472/  5000| tot_loss: 2.2235 | rl_loss: 0.5030 | pt_loss: 1.7205 | pg_loss: 0.1523 | reg_loss: 0.3507 | reward: -0.2627 | rev_kl: 0.7656 | stu_lens: 93.9688 | mixed_lens: 100.8281 | lr: 4.0997e-06 | scale: 1024.00 | time: 26.453 | step time: 27.738
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1473/  5000| tot_loss: 2.1595 | rl_loss: 0.6146 | pt_loss: 1.5449 | pg_loss: 0.1787 | reg_loss: 0.4359 | reward: -0.1056 | rev_kl: 0.8078 | stu_lens: 128.0000 | mixed_lens: 99.5000 | lr: 4.0985e-06 | scale: 1024.00 | time: 26.502 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1474/  5000| tot_loss: 2.2853 | rl_loss: 0.7169 | pt_loss: 1.5684 | pg_loss: 0.1020 | reg_loss: 0.6148 | reward: -0.2157 | rev_kl: 0.9711 | stu_lens: 128.0000 | mixed_lens: 117.5000 | lr: 4.0973e-06 | scale: 1024.00 | time: 26.553 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1475/  5000| tot_loss: 3.8410 | rl_loss: 1.8994 | pt_loss: 1.9416 | pg_loss: 0.4629 | reg_loss: 1.4365 | reward: -0.3491 | rev_kl: 0.6158 | stu_lens: 56.5000 | mixed_lens: 72.0000 | lr: 4.0960e-06 | scale: 1024.00 | time: 26.481 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1476/  5000| tot_loss: 2.9697 | rl_loss: 1.4534 | pt_loss: 1.5163 | pg_loss: 0.3712 | reg_loss: 1.0823 | reward: -0.3473 | rev_kl: 1.0138 | stu_lens: 72.0000 | mixed_lens: 73.0000 | lr: 4.0948e-06 | scale: 1024.00 | time: 26.505 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1477/  5000| tot_loss: 3.2262 | rl_loss: 1.7091 | pt_loss: 1.5172 | pg_loss: 0.5078 | reg_loss: 1.2013 | reward: -0.4026 | rev_kl: 0.9971 | stu_lens: 100.5000 | mixed_lens: 76.0000 | lr: 4.0936e-06 | scale: 1024.00 | time: 26.486 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1478/  5000| tot_loss: 3.0027 | rl_loss: 1.1380 | pt_loss: 1.8646 | pg_loss: 0.4438 | reg_loss: 0.6942 | reward: -0.4929 | rev_kl: 1.0879 | stu_lens: 49.5000 | mixed_lens: 81.0000 | lr: 4.0923e-06 | scale: 1024.00 | time: 26.490 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1479/  5000| tot_loss: 3.3661 | rl_loss: 1.8457 | pt_loss: 1.5205 | pg_loss: 1.1333 | reg_loss: 0.7124 | reward: 0.1622 | rev_kl: 0.2789 | stu_lens: 65.5000 | mixed_lens: 37.0000 | lr: 4.0911e-06 | scale: 1024.00 | time: 26.472 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1480/  5000| tot_loss: 2.8230 | rl_loss: 0.9692 | pt_loss: 1.8538 | pg_loss: 0.0275 | reg_loss: 0.9417 | reward: -0.1850 | rev_kl: 1.0928 | stu_lens: 79.0000 | mixed_lens: 128.0000 | lr: 4.0899e-06 | scale: 1024.00 | time: 26.506 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1481/  5000| tot_loss: 3.1255 | rl_loss: 1.3446 | pt_loss: 1.7809 | pg_loss: 0.1513 | reg_loss: 1.1933 | reward: -0.3767 | rev_kl: 1.0498 | stu_lens: 128.0000 | mixed_lens: 118.5000 | lr: 4.0886e-06 | scale: 1024.00 | time: 26.482 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1482/  5000| tot_loss: 4.6799 | rl_loss: 2.9818 | pt_loss: 1.6981 | pg_loss: 1.0796 | reg_loss: 1.9022 | reward: -2.4250 | rev_kl: 1.2669 | stu_lens: 9.5000 | mixed_lens: 54.5000 | lr: 4.0874e-06 | scale: 1024.00 | time: 26.464 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1483/  5000| tot_loss: 3.8753 | rl_loss: 1.9014 | pt_loss: 1.9738 | pg_loss: 1.0724 | reg_loss: 0.8290 | reward: -0.6879 | rev_kl: 0.8200 | stu_lens: 128.0000 | mixed_lens: 32.0000 | lr: 4.0861e-06 | scale: 1024.00 | time: 26.450 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1484/  5000| tot_loss: 2.7846 | rl_loss: 1.0166 | pt_loss: 1.7680 | pg_loss: 0.3081 | reg_loss: 0.7085 | reward: -0.1652 | rev_kl: 0.9211 | stu_lens: 75.0000 | mixed_lens: 75.0000 | lr: 4.0849e-06 | scale: 1024.00 | time: 26.458 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1485/  5000| tot_loss: 2.8000 | rl_loss: 0.9226 | pt_loss: 1.8774 | pg_loss: 0.1213 | reg_loss: 0.8013 | reward: -0.1196 | rev_kl: 0.5467 | stu_lens: 122.0000 | mixed_lens: 120.5000 | lr: 4.0837e-06 | scale: 1024.00 | time: 26.444 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1486/  5000| tot_loss: 1.9073 | rl_loss: 1.1670 | pt_loss: 0.7403 | pg_loss: 0.0929 | reg_loss: 1.0742 | reward: -0.1728 | rev_kl: 1.0579 | stu_lens: 82.5000 | mixed_lens: 128.0000 | lr: 4.0824e-06 | scale: 1024.00 | time: 26.448 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1487/  5000| tot_loss: 2.0843 | rl_loss: 0.3449 | pt_loss: 1.7394 | pg_loss: -0.0523 | reg_loss: 0.3972 | reward: 0.0724 | rev_kl: 0.5666 | stu_lens: 90.5000 | mixed_lens: 48.0000 | lr: 4.0812e-06 | scale: 1024.00 | time: 26.480 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1488/  5000| tot_loss: 3.0875 | rl_loss: 1.3497 | pt_loss: 1.7378 | pg_loss: 0.4141 | reg_loss: 0.9356 | reward: -0.2316 | rev_kl: 0.8671 | stu_lens: 32.5000 | mixed_lens: 20.0000 | lr: 4.0799e-06 | scale: 1024.00 | time: 26.486 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1488/  5000| tot_loss: 3.0207 | rl_loss: 1.3072 | pt_loss: 1.7134 | pg_loss: 0.3708 | reg_loss: 0.9364 | reward: -0.3692 | rev_kl: 0.8736 | stu_lens: 89.5469 | mixed_lens: 86.4375 | lr: 4.0799e-06 | scale: 1024.00 | time: 26.486 | step time: 27.767
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1489/  5000| tot_loss: 2.6280 | rl_loss: 1.1477 | pt_loss: 1.4803 | pg_loss: 0.3859 | reg_loss: 0.7618 | reward: -0.6408 | rev_kl: 0.8519 | stu_lens: 35.5000 | mixed_lens: 80.5000 | lr: 4.0787e-06 | scale: 1024.00 | time: 26.464 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1490/  5000| tot_loss: 2.9024 | rl_loss: 0.8134 | pt_loss: 2.0890 | pg_loss: -0.0217 | reg_loss: 0.8351 | reward: -0.1585 | rev_kl: 1.0564 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.0774e-06 | scale: 1024.00 | time: 26.489 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1491/  5000| tot_loss: 4.7472 | rl_loss: 2.6393 | pt_loss: 2.1079 | pg_loss: 1.6641 | reg_loss: 0.9752 | reward: -1.6409 | rev_kl: 0.8567 | stu_lens: 38.0000 | mixed_lens: 23.0000 | lr: 4.0762e-06 | scale: 1024.00 | time: 26.488 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1492/  5000| tot_loss: 3.0844 | rl_loss: 1.6098 | pt_loss: 1.4746 | pg_loss: 1.0010 | reg_loss: 0.6087 | reward: -0.7282 | rev_kl: 0.8574 | stu_lens: 93.0000 | mixed_lens: 35.5000 | lr: 4.0750e-06 | scale: 1024.00 | time: 26.505 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1493/  5000| tot_loss: 2.6426 | rl_loss: 1.2904 | pt_loss: 1.3522 | pg_loss: 0.5657 | reg_loss: 0.7247 | reward: -0.2984 | rev_kl: 1.1526 | stu_lens: 123.0000 | mixed_lens: 55.0000 | lr: 4.0737e-06 | scale: 1024.00 | time: 26.472 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1494/  5000| tot_loss: 2.8192 | rl_loss: 0.9955 | pt_loss: 1.8238 | pg_loss: 0.4683 | reg_loss: 0.5272 | reward: -0.0797 | rev_kl: 0.4360 | stu_lens: 84.5000 | mixed_lens: 67.0000 | lr: 4.0725e-06 | scale: 1024.00 | time: 26.476 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1495/  5000| tot_loss: 3.2102 | rl_loss: 1.2828 | pt_loss: 1.9274 | pg_loss: 0.4117 | reg_loss: 0.8711 | reward: -0.0441 | rev_kl: 0.5277 | stu_lens: 51.5000 | mixed_lens: 65.5000 | lr: 4.0712e-06 | scale: 1024.00 | time: 26.474 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1496/  5000| tot_loss: 2.8024 | rl_loss: 1.2655 | pt_loss: 1.5369 | pg_loss: 0.4863 | reg_loss: 0.7792 | reward: -0.3868 | rev_kl: 0.7813 | stu_lens: 63.0000 | mixed_lens: 68.0000 | lr: 4.0700e-06 | scale: 1024.00 | time: 26.480 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1497/  5000| tot_loss: 2.3944 | rl_loss: 0.5953 | pt_loss: 1.7991 | pg_loss: 0.0853 | reg_loss: 0.5099 | reward: -0.1070 | rev_kl: 0.8186 | stu_lens: 84.5000 | mixed_lens: 106.5000 | lr: 4.0687e-06 | scale: 1024.00 | time: 26.482 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1498/  5000| tot_loss: 3.4655 | rl_loss: 1.6119 | pt_loss: 1.8535 | pg_loss: 0.7736 | reg_loss: 0.8384 | reward: -0.3317 | rev_kl: 1.0880 | stu_lens: 75.0000 | mixed_lens: 49.0000 | lr: 4.0675e-06 | scale: 1024.00 | time: 26.463 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1499/  5000| tot_loss: 2.6630 | rl_loss: 1.2130 | pt_loss: 1.4500 | pg_loss: 0.4423 | reg_loss: 0.7706 | reward: -0.0269 | rev_kl: 0.9040 | stu_lens: 87.0000 | mixed_lens: 71.5000 | lr: 4.0662e-06 | scale: 1024.00 | time: 26.448 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/1500
                                 Evaluation #15                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son una clase de          │
│                                       │ partículas elementales que se pueden │
│                                       │ encontrar en la naturaleza. Existen  │
│                                       │ cuatro tipos de cuarks:              │
│                                       │                                      │
│                                       │ - Cuark treseler (t): se puede       │
│                                       │ encontrar en la naturaleza y es el   │
│                                       │ cuark más estable.                   │
│                                       │ - Cuark doseler (u): se puede        │
│                                       │ encontrar en la naturaleza y es el   │
│                                       │ cuark más liviano.                   │
│                                       │ - Cuark treselo (c): se puede        │
│                                       │ encontrar en la naturaleza y es el   │
│                                       │ cuark más pesado.                    │
│                                       │ - Cuark doselo (b): se puede         │
│                                       │ encontrar en                         │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es un acrónimo que significa  │
│                                       │ "Interactive Multimedia Courseware". │
│                                       │ Es un modelo de apoyo al aprendizaje │
│                                       │ que combina la interacción con el    │
│                                       │ entorno virtual con una estructura   │
│                                       │ de apoyo al aprendizaje de contenido │
│                                       │ asociado.                            │
│                                       │                                      │
│                                       │ El IMC tiene diversas aplicaciones,  │
│                                       │ ya sea para enseñar un área          │
│                                       │ específica de conocimiento, para     │
│                                       │ apoyar a los estudiantes con una     │
│                                       │ tarea específica o para aprender de  │
│                                       │ una actividad académica.             │
│                                       │                                      │
│                                       │ El IMC puede ser utilizado por el    │
│                                       │ profesor                             │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ 1. Cápsula del tiempo de Walt        │
│                                       │ Disney, 1960, es una cápsula del     │
│                                       │ tiempo que alberga varias películas  │
│                                       │ clásicas de Disney, como El Blanco y │
│                                       │ el Negro, Pinocchio, Pinocho, y      │
│                                       │ Aladdín.                             │
│                                       │ 2. Cápsula del tiempo de Tutankamen, │
│                                       │ 1881, contiene restos del llamado    │
│                                       │ "Maíz de Tutankamen", es una cápsula │
│                                       │ del tiempo que contiene restos de la │
│                                       │ tumba de Tutankamen.                 │
│                                       │ 3. Cápsula del                       │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.892 | exact_match: 0.000 | rev_kl: 0.866 | lens: 97.108 | pt_loss: 1.744 | lm_loss: 1.875 | kd_loss: 1.613 
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1500/  5000| tot_loss: 2.6507 | rl_loss: 1.0236 | pt_loss: 1.6271 | pg_loss: 0.5034 | reg_loss: 0.5201 | reward: -2.3305 | rev_kl: 1.1155 | stu_lens: 48.5000 | mixed_lens: 65.5000 | lr: 4.0650e-06 | scale: 1024.00 | time: 26.491 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1501/  5000| tot_loss: 2.6456 | rl_loss: 1.0431 | pt_loss: 1.6025 | pg_loss: 0.3698 | reg_loss: 0.6733 | reward: -0.6987 | rev_kl: 1.0973 | stu_lens: 95.5000 | mixed_lens: 79.5000 | lr: 4.0637e-06 | scale: 1024.00 | time: 26.569 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1502/  5000| tot_loss: 2.6699 | rl_loss: 0.8352 | pt_loss: 1.8347 | pg_loss: 0.1646 | reg_loss: 0.6706 | reward: -0.1187 | rev_kl: 0.8077 | stu_lens: 102.5000 | mixed_lens: 104.5000 | lr: 4.0625e-06 | scale: 1024.00 | time: 26.535 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1503/  5000| tot_loss: 1.8043 | rl_loss: 0.7256 | pt_loss: 1.0786 | pg_loss: 0.0050 | reg_loss: 0.7206 | reward: -0.2081 | rev_kl: 1.1291 | stu_lens: 82.5000 | mixed_lens: 128.0000 | lr: 4.0612e-06 | scale: 1024.00 | time: 26.526 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1504/  5000| tot_loss: 1.9272 | rl_loss: 0.6217 | pt_loss: 1.3056 | pg_loss: 0.0436 | reg_loss: 0.5781 | reward: -0.3344 | rev_kl: 0.6713 | stu_lens: 117.0000 | mixed_lens: 123.5000 | lr: 4.0600e-06 | scale: 1024.00 | time: 26.531 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1504/  5000| tot_loss: 2.6805 | rl_loss: 0.9679 | pt_loss: 1.7127 | pg_loss: 0.3153 | reg_loss: 0.6526 | reward: -0.3869 | rev_kl: 0.8992 | stu_lens: 88.2656 | mixed_lens: 88.1094 | lr: 4.0600e-06 | scale: 1024.00 | time: 26.531 | step time: 27.785
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1505/  5000| tot_loss: 3.9743 | rl_loss: 1.7652 | pt_loss: 2.2092 | pg_loss: 1.5840 | reg_loss: 0.1812 | reward: -0.2871 | rev_kl: 0.5264 | stu_lens: 14.5000 | mixed_lens: 17.0000 | lr: 4.0587e-06 | scale: 1024.00 | time: 26.556 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1506/  5000| tot_loss: 2.3078 | rl_loss: 0.6244 | pt_loss: 1.6834 | pg_loss: 0.1216 | reg_loss: 0.5028 | reward: -0.0960 | rev_kl: 1.0037 | stu_lens: 102.5000 | mixed_lens: 104.5000 | lr: 4.0575e-06 | scale: 1024.00 | time: 26.511 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1507/  5000| tot_loss: 2.3217 | rl_loss: 0.6688 | pt_loss: 1.6529 | pg_loss: 0.1274 | reg_loss: 0.5414 | reward: -0.3641 | rev_kl: 0.9329 | stu_lens: 128.0000 | mixed_lens: 102.0000 | lr: 4.0562e-06 | scale: 1024.00 | time: 26.552 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1508/  5000| tot_loss: 2.6186 | rl_loss: 0.6691 | pt_loss: 1.9495 | pg_loss: 0.3365 | reg_loss: 0.3326 | reward: -0.3033 | rev_kl: 0.6099 | stu_lens: 72.0000 | mixed_lens: 73.0000 | lr: 4.0550e-06 | scale: 1024.00 | time: 26.546 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1509/  5000| tot_loss: 2.2600 | rl_loss: 0.7557 | pt_loss: 1.5043 | pg_loss: 0.2516 | reg_loss: 0.5041 | reward: -0.2382 | rev_kl: 0.8847 | stu_lens: 100.5000 | mixed_lens: 80.5000 | lr: 4.0537e-06 | scale: 1024.00 | time: 26.478 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1510/  5000| tot_loss: 2.5912 | rl_loss: 0.6856 | pt_loss: 1.9055 | pg_loss: 0.1471 | reg_loss: 0.5385 | reward: -0.2686 | rev_kl: 0.9639 | stu_lens: 82.5000 | mixed_lens: 93.0000 | lr: 4.0525e-06 | scale: 1024.00 | time: 26.496 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1511/  5000| tot_loss: 2.2622 | rl_loss: 0.5215 | pt_loss: 1.7407 | pg_loss: -0.0037 | reg_loss: 0.5252 | reward: -0.3965 | rev_kl: 1.0619 | stu_lens: 82.0000 | mixed_lens: 128.0000 | lr: 4.0512e-06 | scale: 1024.00 | time: 26.511 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1512/  5000| tot_loss: 2.1700 | rl_loss: 0.8956 | pt_loss: 1.2744 | pg_loss: 0.5610 | reg_loss: 0.3346 | reward: -2.3615 | rev_kl: 1.4494 | stu_lens: 60.0000 | mixed_lens: 65.5000 | lr: 4.0499e-06 | scale: 1024.00 | time: 26.468 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1513/  5000| tot_loss: 2.9473 | rl_loss: 1.2819 | pt_loss: 1.6654 | pg_loss: 0.6800 | reg_loss: 0.6019 | reward: -0.0485 | rev_kl: 0.6482 | stu_lens: 64.5000 | mixed_lens: 44.5000 | lr: 4.0487e-06 | scale: 1024.00 | time: 26.522 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1514/  5000| tot_loss: 2.4705 | rl_loss: 0.4950 | pt_loss: 1.9755 | pg_loss: 0.0125 | reg_loss: 0.4824 | reward: -0.0668 | rev_kl: 0.9234 | stu_lens: 25.5000 | mixed_lens: 128.0000 | lr: 4.0474e-06 | scale: 1024.00 | time: 26.495 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1515/  5000| tot_loss: 2.0099 | rl_loss: 0.2276 | pt_loss: 1.7823 | pg_loss: -0.0329 | reg_loss: 0.2605 | reward: -0.6716 | rev_kl: 0.3615 | stu_lens: 66.5000 | mixed_lens: 43.0000 | lr: 4.0462e-06 | scale: 1024.00 | time: 26.479 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1516/  5000| tot_loss: 2.3572 | rl_loss: 0.5460 | pt_loss: 1.8112 | pg_loss: 0.0041 | reg_loss: 0.5419 | reward: -0.2346 | rev_kl: 1.1086 | stu_lens: 119.5000 | mixed_lens: 123.5000 | lr: 4.0449e-06 | scale: 1024.00 | time: 26.455 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1517/  5000| tot_loss: 2.9701 | rl_loss: 1.0272 | pt_loss: 1.9429 | pg_loss: 0.4537 | reg_loss: 0.5735 | reward: -0.2039 | rev_kl: 1.0276 | stu_lens: 75.0000 | mixed_lens: 75.0000 | lr: 4.0436e-06 | scale: 1024.00 | time: 26.472 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1518/  5000| tot_loss: 2.6258 | rl_loss: 0.7951 | pt_loss: 1.8307 | pg_loss: 0.3825 | reg_loss: 0.4127 | reward: -0.4423 | rev_kl: 0.8821 | stu_lens: 37.0000 | mixed_lens: 81.0000 | lr: 4.0424e-06 | scale: 1024.00 | time: 26.465 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1519/  5000| tot_loss: 2.7572 | rl_loss: 1.0227 | pt_loss: 1.7344 | pg_loss: 0.5663 | reg_loss: 0.4565 | reward: -0.5435 | rev_kl: 0.9969 | stu_lens: 128.0000 | mixed_lens: 67.0000 | lr: 4.0411e-06 | scale: 1024.00 | time: 26.487 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1520/  5000| tot_loss: 4.2443 | rl_loss: 1.8044 | pt_loss: 2.4399 | pg_loss: 1.2343 | reg_loss: 0.5701 | reward: -0.6565 | rev_kl: 1.3599 | stu_lens: 54.5000 | mixed_lens: 26.0000 | lr: 4.0399e-06 | scale: 1024.00 | time: 26.486 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1520/  5000| tot_loss: 2.5774 | rl_loss: 0.7980 | pt_loss: 1.7795 | pg_loss: 0.3167 | reg_loss: 0.4812 | reward: -0.3743 | rev_kl: 0.8723 | stu_lens: 86.0312 | mixed_lens: 86.1250 | lr: 4.0399e-06 | scale: 1024.00 | time: 26.486 | step time: 27.784
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1521/  5000| tot_loss: 2.8677 | rl_loss: 0.6452 | pt_loss: 2.2225 | pg_loss: 0.1363 | reg_loss: 0.5089 | reward: -0.3038 | rev_kl: 0.8538 | stu_lens: 128.0000 | mixed_lens: 104.0000 | lr: 4.0386e-06 | scale: 1024.00 | time: 26.489 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1522/  5000| tot_loss: 2.1732 | rl_loss: 0.1675 | pt_loss: 2.0057 | pg_loss: -0.0387 | reg_loss: 0.2061 | reward: -0.1033 | rev_kl: 0.2966 | stu_lens: 70.5000 | mixed_lens: 48.5000 | lr: 4.0373e-06 | scale: 1024.00 | time: 26.454 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1523/  5000| tot_loss: 2.7987 | rl_loss: 1.1879 | pt_loss: 1.6108 | pg_loss: 0.6513 | reg_loss: 0.5366 | reward: -0.1658 | rev_kl: 1.0378 | stu_lens: 96.5000 | mixed_lens: 50.0000 | lr: 4.0361e-06 | scale: 1024.00 | time: 26.517 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1524/  5000| tot_loss: 2.2925 | rl_loss: 0.3839 | pt_loss: 1.9086 | pg_loss: -0.0040 | reg_loss: 0.3879 | reward: -0.2164 | rev_kl: 1.2218 | stu_lens: 119.5000 | mixed_lens: 127.0000 | lr: 4.0348e-06 | scale: 1024.00 | time: 26.494 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1525/  5000| tot_loss: 2.1248 | rl_loss: 0.4380 | pt_loss: 1.6868 | pg_loss: 0.0146 | reg_loss: 0.4235 | reward: -0.3653 | rev_kl: 0.6993 | stu_lens: 114.0000 | mixed_lens: 128.0000 | lr: 4.0335e-06 | scale: 1024.00 | time: 26.522 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1526/  5000| tot_loss: 2.2943 | rl_loss: 0.5080 | pt_loss: 1.7863 | pg_loss: 0.3245 | reg_loss: 0.1835 | reward: -0.3024 | rev_kl: 0.7351 | stu_lens: 72.0000 | mixed_lens: 73.0000 | lr: 4.0323e-06 | scale: 1024.00 | time: 26.499 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1527/  5000| tot_loss: 2.7560 | rl_loss: 0.9092 | pt_loss: 1.8468 | pg_loss: 0.5541 | reg_loss: 0.3551 | reward: 0.2066 | rev_kl: 0.4809 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 4.0310e-06 | scale: 1024.00 | time: 26.548 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1528/  5000| tot_loss: 2.4627 | rl_loss: 0.5338 | pt_loss: 1.9289 | pg_loss: 0.1562 | reg_loss: 0.3776 | reward: -0.0393 | rev_kl: 0.6660 | stu_lens: 25.5000 | mixed_lens: 95.5000 | lr: 4.0297e-06 | scale: 1024.00 | time: 26.517 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1529/  5000| tot_loss: 1.9746 | rl_loss: 0.7428 | pt_loss: 1.2318 | pg_loss: 0.3620 | reg_loss: 0.3808 | reward: -0.6532 | rev_kl: 1.0148 | stu_lens: 83.0000 | mixed_lens: 80.5000 | lr: 4.0285e-06 | scale: 1024.00 | time: 26.567 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1530/  5000| tot_loss: 2.1775 | rl_loss: 0.7997 | pt_loss: 1.3778 | pg_loss: 0.3655 | reg_loss: 0.4342 | reward: -0.1990 | rev_kl: 1.1047 | stu_lens: 66.5000 | mixed_lens: 70.5000 | lr: 4.0272e-06 | scale: 1024.00 | time: 26.519 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1531/  5000| tot_loss: 2.8235 | rl_loss: 0.8726 | pt_loss: 1.9508 | pg_loss: 0.3785 | reg_loss: 0.4941 | reward: -0.5024 | rev_kl: 0.9701 | stu_lens: 81.5000 | mixed_lens: 81.0000 | lr: 4.0259e-06 | scale: 1024.00 | time: 26.551 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1532/  5000| tot_loss: 3.0319 | rl_loss: 1.1547 | pt_loss: 1.8772 | pg_loss: 0.7259 | reg_loss: 0.4288 | reward: -0.2068 | rev_kl: 1.0701 | stu_lens: 52.0000 | mixed_lens: 43.0000 | lr: 4.0247e-06 | scale: 1024.00 | time: 26.518 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1533/  5000| tot_loss: 2.3794 | rl_loss: 0.7765 | pt_loss: 1.6029 | pg_loss: 0.3068 | reg_loss: 0.4697 | reward: -2.2895 | rev_kl: 1.0536 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 4.0234e-06 | scale: 1024.00 | time: 26.540 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1534/  5000| tot_loss: 2.2858 | rl_loss: 0.4462 | pt_loss: 1.8396 | pg_loss: 0.3098 | reg_loss: 0.1364 | reward: -0.6768 | rev_kl: 0.3562 | stu_lens: 66.5000 | mixed_lens: 66.5000 | lr: 4.0221e-06 | scale: 1024.00 | time: 26.556 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1535/  5000| tot_loss: 2.3879 | rl_loss: 0.6922 | pt_loss: 1.6957 | pg_loss: 0.2890 | reg_loss: 0.4033 | reward: -0.3500 | rev_kl: 1.0720 | stu_lens: 128.0000 | mixed_lens: 82.5000 | lr: 4.0208e-06 | scale: 1024.00 | time: 26.539 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1536/  5000| tot_loss: 2.0417 | rl_loss: 0.5770 | pt_loss: 1.4647 | pg_loss: 0.0490 | reg_loss: 0.5280 | reward: -0.2814 | rev_kl: 1.3737 | stu_lens: 82.5000 | mixed_lens: 118.5000 | lr: 4.0196e-06 | scale: 1024.00 | time: 26.562 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1536/  5000| tot_loss: 2.3132 | rl_loss: 0.6003 | pt_loss: 1.7129 | pg_loss: 0.2288 | reg_loss: 0.3715 | reward: -0.3760 | rev_kl: 0.8598 | stu_lens: 91.5469 | mixed_lens: 88.6094 | lr: 4.0196e-06 | scale: 1024.00 | time: 26.562 | step time: 27.809
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1537/  5000| tot_loss: 3.5915 | rl_loss: 1.5504 | pt_loss: 2.0410 | pg_loss: 0.7848 | reg_loss: 0.7656 | reward: -0.2045 | rev_kl: 1.1954 | stu_lens: 10.5000 | mixed_lens: 61.0000 | lr: 4.0183e-06 | scale: 1024.00 | time: 26.610 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1538/  5000| tot_loss: 2.7875 | rl_loss: 0.9871 | pt_loss: 1.8004 | pg_loss: 0.2812 | reg_loss: 0.7059 | reward: 0.0506 | rev_kl: 0.8419 | stu_lens: 65.5000 | mixed_lens: 83.0000 | lr: 4.0170e-06 | scale: 1024.00 | time: 26.603 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1539/  5000| tot_loss: 2.3387 | rl_loss: 1.1273 | pt_loss: 1.2113 | pg_loss: 0.2042 | reg_loss: 0.9231 | reward: -0.2172 | rev_kl: 1.0783 | stu_lens: 58.5000 | mixed_lens: 105.0000 | lr: 4.0158e-06 | scale: 1024.00 | time: 26.512 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1540/  5000| tot_loss: 3.6225 | rl_loss: 1.9088 | pt_loss: 1.7137 | pg_loss: 0.4611 | reg_loss: 1.4477 | reward: -0.6898 | rev_kl: 0.5120 | stu_lens: 65.0000 | mixed_lens: 65.0000 | lr: 4.0145e-06 | scale: 1024.00 | time: 26.519 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1541/  5000| tot_loss: 3.1141 | rl_loss: 1.4880 | pt_loss: 1.6261 | pg_loss: 0.3189 | reg_loss: 1.1691 | reward: -0.2782 | rev_kl: 0.9270 | stu_lens: 76.5000 | mixed_lens: 98.5000 | lr: 4.0132e-06 | scale: 1024.00 | time: 26.509 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1542/  5000| tot_loss: 2.9458 | rl_loss: 0.9680 | pt_loss: 1.9778 | pg_loss: 0.0078 | reg_loss: 0.9602 | reward: -0.2628 | rev_kl: 0.8709 | stu_lens: 71.0000 | mixed_lens: 50.5000 | lr: 4.0119e-06 | scale: 1024.00 | time: 26.560 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1543/  5000| tot_loss: 2.4119 | rl_loss: 1.0959 | pt_loss: 1.3160 | pg_loss: 0.0531 | reg_loss: 1.0428 | reward: -0.2002 | rev_kl: 0.8660 | stu_lens: 80.5000 | mixed_lens: 128.0000 | lr: 4.0106e-06 | scale: 1024.00 | time: 26.539 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1544/  5000| tot_loss: 2.4104 | rl_loss: 0.8678 | pt_loss: 1.5426 | pg_loss: 0.0549 | reg_loss: 0.8128 | reward: -0.1246 | rev_kl: 0.6303 | stu_lens: 96.5000 | mixed_lens: 128.0000 | lr: 4.0094e-06 | scale: 1024.00 | time: 26.542 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1545/  5000| tot_loss: 3.5811 | rl_loss: 1.4414 | pt_loss: 2.1397 | pg_loss: 0.3033 | reg_loss: 1.1381 | reward: -0.2379 | rev_kl: 1.6277 | stu_lens: 97.5000 | mixed_lens: 100.5000 | lr: 4.0081e-06 | scale: 1024.00 | time: 26.567 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1546/  5000| tot_loss: 4.1123 | rl_loss: 2.3452 | pt_loss: 1.7671 | pg_loss: 1.2272 | reg_loss: 1.1180 | reward: -0.1405 | rev_kl: 0.8444 | stu_lens: 66.5000 | mixed_lens: 34.0000 | lr: 4.0068e-06 | scale: 1024.00 | time: 26.579 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1547/  5000| tot_loss: 2.7992 | rl_loss: 1.2802 | pt_loss: 1.5190 | pg_loss: 0.2412 | reg_loss: 1.0391 | reward: -0.3116 | rev_kl: 0.9274 | stu_lens: 78.0000 | mixed_lens: 88.5000 | lr: 4.0055e-06 | scale: 1024.00 | time: 26.572 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1548/  5000| tot_loss: 2.6696 | rl_loss: 1.0065 | pt_loss: 1.6631 | pg_loss: 0.2563 | reg_loss: 0.7502 | reward: -0.1752 | rev_kl: 0.6516 | stu_lens: 84.5000 | mixed_lens: 96.0000 | lr: 4.0043e-06 | scale: 1024.00 | time: 26.584 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1549/  5000| tot_loss: 2.5956 | rl_loss: 0.8292 | pt_loss: 1.7664 | pg_loss: 0.1531 | reg_loss: 0.6761 | reward: -0.1718 | rev_kl: 1.8627 | stu_lens: 128.0000 | mixed_lens: 105.0000 | lr: 4.0030e-06 | scale: 1024.00 | time: 26.571 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1550/  5000| tot_loss: 3.0343 | rl_loss: 1.1910 | pt_loss: 1.8433 | pg_loss: 0.0326 | reg_loss: 1.1584 | reward: -0.1523 | rev_kl: 0.9389 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.0017e-06 | scale: 1024.00 | time: 26.581 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1551/  5000| tot_loss: 2.8677 | rl_loss: 1.0442 | pt_loss: 1.8235 | pg_loss: 0.0507 | reg_loss: 0.9935 | reward: -0.1158 | rev_kl: 0.7663 | stu_lens: 84.0000 | mixed_lens: 128.0000 | lr: 4.0004e-06 | scale: 1024.00 | time: 26.591 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1552/  5000| tot_loss: 3.9223 | rl_loss: 2.7326 | pt_loss: 1.1898 | pg_loss: 1.0396 | reg_loss: 1.6930 | reward: -0.8690 | rev_kl: 0.6067 | stu_lens: 16.5000 | mixed_lens: 34.0000 | lr: 3.9991e-06 | scale: 1024.00 | time: 26.583 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1552/  5000| tot_loss: 2.9982 | rl_loss: 1.2384 | pt_loss: 1.7598 | pg_loss: 0.2824 | reg_loss: 0.9561 | reward: -0.3663 | rev_kl: 0.9620 | stu_lens: 81.9688 | mixed_lens: 92.7188 | lr: 3.9991e-06 | scale: 1024.00 | time: 26.583 | step time: 27.839
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1553/  5000| tot_loss: 2.8441 | rl_loss: 1.1586 | pt_loss: 1.6855 | pg_loss: 0.3608 | reg_loss: 0.7977 | reward: -0.4153 | rev_kl: 0.5837 | stu_lens: 103.5000 | mixed_lens: 95.0000 | lr: 3.9978e-06 | scale: 1024.00 | time: 26.580 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1554/  5000| tot_loss: 2.8960 | rl_loss: 1.1099 | pt_loss: 1.7861 | pg_loss: 0.5414 | reg_loss: 0.5685 | reward: -0.5063 | rev_kl: 0.6137 | stu_lens: 103.5000 | mixed_lens: 81.5000 | lr: 3.9966e-06 | scale: 1024.00 | time: 26.604 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1555/  5000| tot_loss: 2.4775 | rl_loss: 0.6143 | pt_loss: 1.8632 | pg_loss: 0.1978 | reg_loss: 0.4165 | reward: -0.3103 | rev_kl: 0.7869 | stu_lens: 75.0000 | mixed_lens: 78.5000 | lr: 3.9953e-06 | scale: 1024.00 | time: 26.578 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1556/  5000| tot_loss: 2.5741 | rl_loss: 0.8148 | pt_loss: 1.7593 | pg_loss: 0.1735 | reg_loss: 0.6413 | reward: 0.0088 | rev_kl: 0.8385 | stu_lens: 119.5000 | mixed_lens: 96.5000 | lr: 3.9940e-06 | scale: 1024.00 | time: 26.569 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1557/  5000| tot_loss: 2.0668 | rl_loss: 0.7069 | pt_loss: 1.3599 | pg_loss: -0.0101 | reg_loss: 0.7170 | reward: -0.2252 | rev_kl: 1.1853 | stu_lens: 124.0000 | mixed_lens: 128.0000 | lr: 3.9927e-06 | scale: 1024.00 | time: 26.534 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1558/  5000| tot_loss: 3.0378 | rl_loss: 1.1043 | pt_loss: 1.9335 | pg_loss: 0.2665 | reg_loss: 0.8379 | reward: -0.3179 | rev_kl: 1.9575 | stu_lens: 41.0000 | mixed_lens: 91.0000 | lr: 3.9914e-06 | scale: 1024.00 | time: 26.548 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1559/  5000| tot_loss: 2.4918 | rl_loss: 0.7788 | pt_loss: 1.7130 | pg_loss: -0.0048 | reg_loss: 0.7836 | reward: -0.0269 | rev_kl: 0.6755 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.9901e-06 | scale: 1024.00 | time: 26.569 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1560/  5000| tot_loss: 3.1712 | rl_loss: 0.9680 | pt_loss: 2.2032 | pg_loss: 0.1429 | reg_loss: 0.8251 | reward: -0.1846 | rev_kl: 0.7351 | stu_lens: 103.5000 | mixed_lens: 89.0000 | lr: 3.9888e-06 | scale: 1024.00 | time: 26.546 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1561/  5000| tot_loss: 2.0136 | rl_loss: 0.4425 | pt_loss: 1.5711 | pg_loss: 0.0684 | reg_loss: 0.3741 | reward: -0.1472 | rev_kl: 0.6721 | stu_lens: 102.0000 | mixed_lens: 116.5000 | lr: 3.9876e-06 | scale: 1024.00 | time: 26.573 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1562/  5000| tot_loss: 2.5785 | rl_loss: 1.0205 | pt_loss: 1.5579 | pg_loss: 0.5901 | reg_loss: 0.4304 | reward: 0.0358 | rev_kl: 0.7417 | stu_lens: 66.0000 | mixed_lens: 71.0000 | lr: 3.9863e-06 | scale: 1024.00 | time: 26.624 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1563/  5000| tot_loss: 2.5736 | rl_loss: 0.6844 | pt_loss: 1.8893 | pg_loss: 0.0594 | reg_loss: 0.6249 | reward: -0.2709 | rev_kl: 1.0884 | stu_lens: 74.0000 | mixed_lens: 114.5000 | lr: 3.9850e-06 | scale: 1024.00 | time: 26.569 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1564/  5000| tot_loss: 2.3387 | rl_loss: 0.9936 | pt_loss: 1.3451 | pg_loss: 0.1895 | reg_loss: 0.8042 | reward: -0.2318 | rev_kl: 1.2066 | stu_lens: 101.5000 | mixed_lens: 100.5000 | lr: 3.9837e-06 | scale: 1024.00 | time: 26.581 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1565/  5000| tot_loss: 2.2107 | rl_loss: 0.6954 | pt_loss: 1.5153 | pg_loss: 0.1932 | reg_loss: 0.5022 | reward: -0.2496 | rev_kl: 0.6849 | stu_lens: 34.5000 | mixed_lens: 103.0000 | lr: 3.9824e-06 | scale: 1024.00 | time: 26.570 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1566/  5000| tot_loss: 2.7488 | rl_loss: 0.6440 | pt_loss: 2.1048 | pg_loss: 0.0842 | reg_loss: 0.5598 | reward: -0.3632 | rev_kl: 1.0132 | stu_lens: 98.0000 | mixed_lens: 114.0000 | lr: 3.9811e-06 | scale: 1024.00 | time: 26.580 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1567/  5000| tot_loss: 2.7567 | rl_loss: 0.9715 | pt_loss: 1.7852 | pg_loss: 0.3224 | reg_loss: 0.6491 | reward: -0.3381 | rev_kl: 0.4875 | stu_lens: 74.5000 | mixed_lens: 76.5000 | lr: 3.9798e-06 | scale: 1024.00 | time: 26.528 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1568/  5000| tot_loss: 2.6098 | rl_loss: 0.8581 | pt_loss: 1.7517 | pg_loss: 0.0190 | reg_loss: 0.8391 | reward: -0.2307 | rev_kl: 0.9567 | stu_lens: 128.0000 | mixed_lens: 127.5000 | lr: 3.9785e-06 | scale: 1024.00 | time: 26.586 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1568/  5000| tot_loss: 2.6153 | rl_loss: 0.8723 | pt_loss: 1.7430 | pg_loss: 0.2141 | reg_loss: 0.6582 | reward: -0.3990 | rev_kl: 0.9776 | stu_lens: 86.7656 | mixed_lens: 96.3438 | lr: 3.9785e-06 | scale: 1024.00 | time: 26.586 | step time: 27.851
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1569/  5000| tot_loss: 2.4274 | rl_loss: 0.9375 | pt_loss: 1.4899 | pg_loss: 0.2503 | reg_loss: 0.6871 | reward: -1.2309 | rev_kl: 1.0343 | stu_lens: 64.0000 | mixed_lens: 70.0000 | lr: 3.9772e-06 | scale: 1024.00 | time: 26.557 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1570/  5000| tot_loss: 2.7591 | rl_loss: 0.9527 | pt_loss: 1.8063 | pg_loss: 0.4215 | reg_loss: 0.5313 | reward: -0.6021 | rev_kl: 0.8606 | stu_lens: 83.0000 | mixed_lens: 73.0000 | lr: 3.9759e-06 | scale: 1024.00 | time: 26.568 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1571/  5000| tot_loss: 1.6886 | rl_loss: 0.3768 | pt_loss: 1.3118 | pg_loss: 0.0153 | reg_loss: 0.3616 | reward: -0.1009 | rev_kl: 0.6616 | stu_lens: 111.0000 | mixed_lens: 128.0000 | lr: 3.9746e-06 | scale: 1024.00 | time: 26.544 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1572/  5000| tot_loss: 2.3859 | rl_loss: 0.5707 | pt_loss: 1.8151 | pg_loss: 0.1839 | reg_loss: 0.3868 | reward: -0.2500 | rev_kl: 0.7788 | stu_lens: 85.5000 | mixed_lens: 100.5000 | lr: 3.9734e-06 | scale: 1024.00 | time: 26.567 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1573/  5000| tot_loss: 3.3799 | rl_loss: 1.2721 | pt_loss: 2.1078 | pg_loss: 0.8782 | reg_loss: 0.3939 | reward: -2.3311 | rev_kl: 1.4122 | stu_lens: 67.5000 | mixed_lens: 35.5000 | lr: 3.9721e-06 | scale: 1024.00 | time: 26.536 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1574/  5000| tot_loss: 1.8383 | rl_loss: 0.3231 | pt_loss: 1.5151 | pg_loss: 0.0418 | reg_loss: 0.2813 | reward: -0.0648 | rev_kl: 0.6382 | stu_lens: 43.5000 | mixed_lens: 115.0000 | lr: 3.9708e-06 | scale: 1024.00 | time: 26.559 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1575/  5000| tot_loss: 2.3246 | rl_loss: 0.6245 | pt_loss: 1.7001 | pg_loss: 0.2047 | reg_loss: 0.4198 | reward: -0.2396 | rev_kl: 0.7962 | stu_lens: 78.0000 | mixed_lens: 97.0000 | lr: 3.9695e-06 | scale: 1024.00 | time: 26.543 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1576/  5000| tot_loss: 2.8000 | rl_loss: 0.5732 | pt_loss: 2.2268 | pg_loss: 0.2419 | reg_loss: 0.3313 | reward: -0.0512 | rev_kl: 0.7427 | stu_lens: 87.0000 | mixed_lens: 58.0000 | lr: 3.9682e-06 | scale: 1024.00 | time: 26.522 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1577/  5000| tot_loss: 3.1338 | rl_loss: 1.9028 | pt_loss: 1.2310 | pg_loss: 1.1044 | reg_loss: 0.7984 | reward: -0.8129 | rev_kl: 1.0050 | stu_lens: 38.5000 | mixed_lens: 37.5000 | lr: 3.9669e-06 | scale: 1024.00 | time: 26.498 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1578/  5000| tot_loss: 2.3604 | rl_loss: 0.6677 | pt_loss: 1.6926 | pg_loss: 0.2175 | reg_loss: 0.4502 | reward: -0.8298 | rev_kl: 1.3224 | stu_lens: 72.0000 | mixed_lens: 93.5000 | lr: 3.9656e-06 | scale: 1024.00 | time: 26.511 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1579/  5000| tot_loss: 2.4196 | rl_loss: 0.4916 | pt_loss: 1.9280 | pg_loss: 0.1935 | reg_loss: 0.2981 | reward: -0.3103 | rev_kl: 0.7869 | stu_lens: 75.0000 | mixed_lens: 78.5000 | lr: 3.9643e-06 | scale: 1024.00 | time: 26.526 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1580/  5000| tot_loss: 1.7789 | rl_loss: 0.4680 | pt_loss: 1.3109 | pg_loss: 0.0817 | reg_loss: 0.3863 | reward: -0.1472 | rev_kl: 0.8384 | stu_lens: 112.5000 | mixed_lens: 116.5000 | lr: 3.9630e-06 | scale: 1024.00 | time: 26.507 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1581/  5000| tot_loss: 2.6874 | rl_loss: 0.7252 | pt_loss: 1.9621 | pg_loss: 0.1859 | reg_loss: 0.5393 | reward: -0.3230 | rev_kl: 1.6584 | stu_lens: 64.0000 | mixed_lens: 97.5000 | lr: 3.9617e-06 | scale: 1024.00 | time: 26.555 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1582/  5000| tot_loss: 2.5689 | rl_loss: 0.7396 | pt_loss: 1.8293 | pg_loss: 0.2041 | reg_loss: 0.5355 | reward: -1.3824 | rev_kl: 1.0535 | stu_lens: 70.5000 | mixed_lens: 70.0000 | lr: 3.9604e-06 | scale: 1024.00 | time: 26.550 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1583/  5000| tot_loss: 2.2405 | rl_loss: 0.6274 | pt_loss: 1.6131 | pg_loss: 0.0148 | reg_loss: 0.6126 | reward: -0.1643 | rev_kl: 0.7572 | stu_lens: 128.0000 | mixed_lens: 122.0000 | lr: 3.9591e-06 | scale: 1024.00 | time: 26.520 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1584/  5000| tot_loss: 2.3588 | rl_loss: 0.7787 | pt_loss: 1.5800 | pg_loss: 0.3501 | reg_loss: 0.4286 | reward: -0.0162 | rev_kl: 1.9535 | stu_lens: 35.5000 | mixed_lens: 71.0000 | lr: 3.9578e-06 | scale: 1024.00 | time: 26.545 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1584/  5000| tot_loss: 2.3839 | rl_loss: 0.6745 | pt_loss: 1.7093 | pg_loss: 0.2016 | reg_loss: 0.4729 | reward: -0.4528 | rev_kl: 0.9900 | stu_lens: 83.6875 | mixed_lens: 90.5000 | lr: 3.9578e-06 | scale: 1024.00 | time: 26.545 | step time: 27.818
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1585/  5000| tot_loss: 2.3269 | rl_loss: 0.3740 | pt_loss: 1.9529 | pg_loss: -0.0065 | reg_loss: 0.3805 | reward: -0.1283 | rev_kl: 0.6580 | stu_lens: 40.5000 | mixed_lens: 128.0000 | lr: 3.9565e-06 | scale: 1024.00 | time: 26.528 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1586/  5000| tot_loss: 2.2211 | rl_loss: 0.3834 | pt_loss: 1.8377 | pg_loss: -0.0199 | reg_loss: 0.4033 | reward: -0.1397 | rev_kl: 2.0315 | stu_lens: 54.5000 | mixed_lens: 128.0000 | lr: 3.9552e-06 | scale: 1024.00 | time: 26.517 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1587/  5000| tot_loss: 1.9206 | rl_loss: 0.3464 | pt_loss: 1.5742 | pg_loss: 0.0143 | reg_loss: 0.3321 | reward: -0.2920 | rev_kl: 1.0032 | stu_lens: 121.5000 | mixed_lens: 128.0000 | lr: 3.9539e-06 | scale: 1024.00 | time: 26.534 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1588/  5000| tot_loss: 2.7300 | rl_loss: 1.0941 | pt_loss: 1.6359 | pg_loss: 0.7696 | reg_loss: 0.3246 | reward: -0.0628 | rev_kl: 1.0617 | stu_lens: 75.0000 | mixed_lens: 39.5000 | lr: 3.9526e-06 | scale: 1024.00 | time: 26.512 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1589/  5000| tot_loss: 2.1631 | rl_loss: 0.4914 | pt_loss: 1.6717 | pg_loss: -0.0177 | reg_loss: 0.5091 | reward: -0.2628 | rev_kl: 0.8709 | stu_lens: 71.0000 | mixed_lens: 50.5000 | lr: 3.9512e-06 | scale: 1024.00 | time: 26.530 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1590/  5000| tot_loss: 2.7187 | rl_loss: 0.8430 | pt_loss: 1.8757 | pg_loss: 0.4460 | reg_loss: 0.3970 | reward: -0.3603 | rev_kl: 0.8571 | stu_lens: 78.0000 | mixed_lens: 83.5000 | lr: 3.9499e-06 | scale: 1024.00 | time: 26.560 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1591/  5000| tot_loss: 2.5708 | rl_loss: 0.7045 | pt_loss: 1.8663 | pg_loss: 0.3787 | reg_loss: 0.3258 | reward: -1.3311 | rev_kl: 0.9771 | stu_lens: 47.0000 | mixed_lens: 56.0000 | lr: 3.9486e-06 | scale: 1024.00 | time: 26.543 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1592/  5000| tot_loss: 2.0015 | rl_loss: 0.5625 | pt_loss: 1.4390 | pg_loss: 0.1815 | reg_loss: 0.3810 | reward: -0.1627 | rev_kl: 0.7598 | stu_lens: 128.0000 | mixed_lens: 96.0000 | lr: 3.9473e-06 | scale: 1024.00 | time: 26.581 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1593/  5000| tot_loss: 1.6984 | rl_loss: 0.4612 | pt_loss: 1.2372 | pg_loss: -0.0109 | reg_loss: 0.4721 | reward: -0.0691 | rev_kl: 0.6820 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.9460e-06 | scale: 1024.00 | time: 26.529 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1594/  5000| tot_loss: 2.4464 | rl_loss: 0.4192 | pt_loss: 2.0273 | pg_loss: 0.1422 | reg_loss: 0.2769 | reward: -0.1557 | rev_kl: 0.8561 | stu_lens: 72.5000 | mixed_lens: 105.0000 | lr: 3.9447e-06 | scale: 1024.00 | time: 26.575 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1595/  5000| tot_loss: 2.0484 | rl_loss: 0.5386 | pt_loss: 1.5099 | pg_loss: 0.0912 | reg_loss: 0.4474 | reward: -0.1195 | rev_kl: 0.9089 | stu_lens: 109.0000 | mixed_lens: 114.5000 | lr: 3.9434e-06 | scale: 1024.00 | time: 26.557 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1596/  5000| tot_loss: 2.5940 | rl_loss: 0.5388 | pt_loss: 2.0553 | pg_loss: 0.2366 | reg_loss: 0.3021 | reward: -1.5632 | rev_kl: 1.2872 | stu_lens: 22.5000 | mixed_lens: 70.0000 | lr: 3.9421e-06 | scale: 1024.00 | time: 26.553 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1597/  5000| tot_loss: 2.7173 | rl_loss: 0.8453 | pt_loss: 1.8720 | pg_loss: 0.6447 | reg_loss: 0.2006 | reward: -0.5572 | rev_kl: 0.2104 | stu_lens: 50.0000 | mixed_lens: 55.5000 | lr: 3.9408e-06 | scale: 1024.00 | time: 26.556 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1598/  5000| tot_loss: 2.4817 | rl_loss: 0.6078 | pt_loss: 1.8739 | pg_loss: 0.3395 | reg_loss: 0.2683 | reward: -0.4809 | rev_kl: 0.8289 | stu_lens: 71.5000 | mixed_lens: 71.5000 | lr: 3.9395e-06 | scale: 1024.00 | time: 26.577 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1599/  5000| tot_loss: 2.8523 | rl_loss: 0.9350 | pt_loss: 1.9173 | pg_loss: 0.4468 | reg_loss: 0.4882 | reward: -0.0328 | rev_kl: 1.1284 | stu_lens: 93.0000 | mixed_lens: 69.0000 | lr: 3.9382e-06 | scale: 1024.00 | time: 26.558 | step time: 0.000
                                 Evaluation #16                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son particles subatomicas │
│                                       │ esencialmente de carácter cerrado,   │
│                                       │ con carga eléctrica complementaria.  │
│                                       │ Existen seis tipos de cuarks, dos de │
│                                       │ cada tipo, que se diferencian por su │
│                                       │ color, o suaió de bencino, y por su  │
│                                       │ electrocuantum, o componente del     │
│                                       │ quark en un estado cuántico de       │
│                                       │ partículas. Los seis tipos de cuarks │
│                                       │ son:                                 │
│                                       │                                      │
│                                       │ - El cuark azul (B) es el más blando │
│                                       │ y tiene la más baja masa. Es un      │
│                                       │ cuark de color azul                  │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ IMC es el acrónimo de “Informática   │
│                                       │ de la Margen”, es una metodología    │
│                                       │ que tiene por objeto mejorar la      │
│                                       │ productividad de una empresa a       │
│                                       │ través de la mejora de los procesos  │
│                                       │ de negocio. La IMC se aplica en      │
│                                       │ todas las áreas de negocio de una    │
│                                       │ empresa, ya sea en el desarrollo de  │
│                                       │ nuevos productos, en la recepción de │
│                                       │ clientes, en la administración de    │
│                                       │ los procesos, o en cualquier otro    │
│                                       │ proceso de negocio.                  │
│                                       │                                      │
│                                       │ La IMC se basa en el análisis de los │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ 1. Cápsula del tiempo, 1939          │
│                                       │ 2. Cápsula del tiempo, 1960          │
│                                       │ 3. Cápsula del tiempo, 1970          │
│                                       │ 4. Cápsula del tiempo, 1972          │
│                                       │ 5. Cápsula del tiempo, 1975          │
│                                       │ 6. Cápsula del tiempo, 1979          │
│                                       │ 7. Cápsula del tiempo, 1983          │
│                                       │ 8. Cápsula del tiempo, 1986          │
│                                       │ 9. Cápsula del tiempo                │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.774 | exact_match: 0.000 | rev_kl: 0.853 | lens: 100.414 | pt_loss: 1.742 | lm_loss: 1.872 | kd_loss: 1.612 
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1600/  5000| tot_loss: 2.3842 | rl_loss: 0.4750 | pt_loss: 1.9091 | pg_loss: 0.1666 | reg_loss: 0.3084 | reward: -0.2675 | rev_kl: 0.4657 | stu_lens: 72.5000 | mixed_lens: 68.5000 | lr: 3.9369e-06 | scale: 1024.00 | time: 26.566 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1600/  5000| tot_loss: 2.2381 | rl_loss: 0.5521 | pt_loss: 1.6859 | pg_loss: 0.1799 | reg_loss: 0.3722 | reward: -0.3914 | rev_kl: 0.9609 | stu_lens: 83.4375 | mixed_lens: 96.0000 | lr: 3.9369e-06 | scale: 1024.00 | time: 26.566 | step time: 27.828
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1601/  5000| tot_loss: 2.3356 | rl_loss: 0.7216 | pt_loss: 1.6139 | pg_loss: 0.3174 | reg_loss: 0.4043 | reward: -0.8273 | rev_kl: 0.6875 | stu_lens: 65.0000 | mixed_lens: 50.5000 | lr: 3.9355e-06 | scale: 1024.00 | time: 26.585 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1602/  5000| tot_loss: 2.8700 | rl_loss: 1.2745 | pt_loss: 1.5955 | pg_loss: 0.3523 | reg_loss: 0.9222 | reward: -0.3399 | rev_kl: 0.6900 | stu_lens: 128.0000 | mixed_lens: 88.0000 | lr: 3.9342e-06 | scale: 1024.00 | time: 26.623 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1603/  5000| tot_loss: 2.6883 | rl_loss: 0.9234 | pt_loss: 1.7649 | pg_loss: 0.0366 | reg_loss: 0.8867 | reward: -0.1619 | rev_kl: 0.6609 | stu_lens: 97.0000 | mixed_lens: 128.0000 | lr: 3.9329e-06 | scale: 1024.00 | time: 26.541 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1604/  5000| tot_loss: 3.1873 | rl_loss: 1.1986 | pt_loss: 1.9888 | pg_loss: 0.3017 | reg_loss: 0.8968 | reward: -0.1353 | rev_kl: 1.3902 | stu_lens: 91.5000 | mixed_lens: 93.0000 | lr: 3.9316e-06 | scale: 1024.00 | time: 26.568 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1605/  5000| tot_loss: 3.6532 | rl_loss: 1.6320 | pt_loss: 2.0212 | pg_loss: 0.3008 | reg_loss: 1.3312 | reward: -0.2819 | rev_kl: 2.2846 | stu_lens: 128.0000 | mixed_lens: 88.5000 | lr: 3.9303e-06 | scale: 1024.00 | time: 26.592 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1606/  5000| tot_loss: 2.7537 | rl_loss: 1.2795 | pt_loss: 1.4742 | pg_loss: 0.4665 | reg_loss: 0.8130 | reward: -0.2786 | rev_kl: 0.5383 | stu_lens: 42.5000 | mixed_lens: 77.5000 | lr: 3.9290e-06 | scale: 1024.00 | time: 26.608 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1607/  5000| tot_loss: 3.2334 | rl_loss: 0.8723 | pt_loss: 2.3610 | pg_loss: 0.0593 | reg_loss: 0.8130 | reward: -0.1276 | rev_kl: 0.7804 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.9277e-06 | scale: 1024.00 | time: 26.559 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1608/  5000| tot_loss: 3.0368 | rl_loss: 1.1469 | pt_loss: 1.8899 | pg_loss: 0.2494 | reg_loss: 0.8975 | reward: 0.1991 | rev_kl: 1.1738 | stu_lens: 128.0000 | mixed_lens: 74.5000 | lr: 3.9263e-06 | scale: 1024.00 | time: 26.601 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1609/  5000| tot_loss: 3.0061 | rl_loss: 1.3023 | pt_loss: 1.7038 | pg_loss: 0.4924 | reg_loss: 0.8099 | reward: -0.0532 | rev_kl: 0.9244 | stu_lens: 128.0000 | mixed_lens: 75.5000 | lr: 3.9250e-06 | scale: 1024.00 | time: 26.586 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1610/  5000| tot_loss: 3.3489 | rl_loss: 1.3763 | pt_loss: 1.9726 | pg_loss: 0.3835 | reg_loss: 0.9928 | reward: -0.3471 | rev_kl: 1.1828 | stu_lens: 72.0000 | mixed_lens: 93.5000 | lr: 3.9237e-06 | scale: 1024.00 | time: 26.590 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1611/  5000| tot_loss: 2.3243 | rl_loss: 1.0709 | pt_loss: 1.2534 | pg_loss: 0.0773 | reg_loss: 0.9936 | reward: -0.1606 | rev_kl: 0.8258 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.9224e-06 | scale: 1024.00 | time: 26.608 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1612/  5000| tot_loss: 1.6043 | rl_loss: -0.1425 | pt_loss: 1.7468 | pg_loss: -0.3811 | reg_loss: 0.2386 | reward: 0.1073 | rev_kl: 0.8386 | stu_lens: 71.0000 | mixed_lens: 34.5000 | lr: 3.9211e-06 | scale: 1024.00 | time: 26.590 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1613/  5000| tot_loss: 2.8085 | rl_loss: 1.2735 | pt_loss: 1.5351 | pg_loss: 0.1522 | reg_loss: 1.1213 | reward: -0.1069 | rev_kl: 1.0366 | stu_lens: 122.5000 | mixed_lens: 110.5000 | lr: 3.9198e-06 | scale: 1024.00 | time: 26.575 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1614/  5000| tot_loss: 2.4352 | rl_loss: 1.0225 | pt_loss: 1.4127 | pg_loss: 0.1690 | reg_loss: 0.8535 | reward: -0.1334 | rev_kl: 0.9812 | stu_lens: 107.0000 | mixed_lens: 106.0000 | lr: 3.9184e-06 | scale: 1024.00 | time: 26.595 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1615/  5000| tot_loss: 3.4133 | rl_loss: 1.2322 | pt_loss: 2.1811 | pg_loss: 0.0811 | reg_loss: 1.1511 | reward: -0.2908 | rev_kl: 1.0333 | stu_lens: 121.0000 | mixed_lens: 128.0000 | lr: 3.9171e-06 | scale: 1024.00 | time: 26.566 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1616/  5000| tot_loss: 2.9113 | rl_loss: 1.2449 | pt_loss: 1.6663 | pg_loss: 0.1105 | reg_loss: 1.1344 | reward: -0.1886 | rev_kl: 1.3437 | stu_lens: 128.0000 | mixed_lens: 121.0000 | lr: 3.9158e-06 | scale: 1024.00 | time: 26.629 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1616/  5000| tot_loss: 2.8623 | rl_loss: 1.1222 | pt_loss: 1.7400 | pg_loss: 0.2184 | reg_loss: 0.9038 | reward: -0.2504 | rev_kl: 0.9266 | stu_lens: 100.1875 | mixed_lens: 99.1094 | lr: 3.9158e-06 | scale: 1024.00 | time: 26.629 | step time: 27.874
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1617/  5000| tot_loss: 2.2301 | rl_loss: 0.9886 | pt_loss: 1.2415 | pg_loss: 0.0631 | reg_loss: 0.9255 | reward: -0.1247 | rev_kl: 0.6726 | stu_lens: 110.5000 | mixed_lens: 128.0000 | lr: 3.9145e-06 | scale: 1024.00 | time: 26.575 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1618/  5000| tot_loss: 2.5544 | rl_loss: 0.8296 | pt_loss: 1.7248 | pg_loss: 0.3346 | reg_loss: 0.4950 | reward: -0.3787 | rev_kl: 0.5136 | stu_lens: 128.0000 | mixed_lens: 75.5000 | lr: 3.9132e-06 | scale: 1024.00 | time: 26.590 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1619/  5000| tot_loss: 2.3255 | rl_loss: 1.0450 | pt_loss: 1.2805 | pg_loss: 0.0781 | reg_loss: 0.9670 | reward: -0.3116 | rev_kl: 1.2686 | stu_lens: 91.0000 | mixed_lens: 113.5000 | lr: 3.9118e-06 | scale: 1024.00 | time: 26.596 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1620/  5000| tot_loss: 2.2164 | rl_loss: 0.5534 | pt_loss: 1.6629 | pg_loss: -0.0054 | reg_loss: 0.5588 | reward: -0.2054 | rev_kl: 0.9312 | stu_lens: 95.5000 | mixed_lens: 128.0000 | lr: 3.9105e-06 | scale: 1024.00 | time: 26.592 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1621/  5000| tot_loss: 2.6826 | rl_loss: 0.8769 | pt_loss: 1.8057 | pg_loss: 0.3113 | reg_loss: 0.5655 | reward: -0.7044 | rev_kl: 0.6921 | stu_lens: 71.0000 | mixed_lens: 79.0000 | lr: 3.9092e-06 | scale: 1024.00 | time: 26.571 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1622/  5000| tot_loss: 2.0255 | rl_loss: 0.6841 | pt_loss: 1.3414 | pg_loss: 0.0064 | reg_loss: 0.6777 | reward: -0.1326 | rev_kl: 0.7527 | stu_lens: 128.0000 | mixed_lens: 125.0000 | lr: 3.9079e-06 | scale: 1024.00 | time: 26.589 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1623/  5000| tot_loss: 2.4283 | rl_loss: 0.7143 | pt_loss: 1.7139 | pg_loss: 0.0757 | reg_loss: 0.6386 | reward: -0.2367 | rev_kl: 1.1551 | stu_lens: 99.5000 | mixed_lens: 125.5000 | lr: 3.9065e-06 | scale: 1024.00 | time: 26.567 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1624/  5000| tot_loss: 2.0614 | rl_loss: 0.6253 | pt_loss: 1.4362 | pg_loss: 0.0051 | reg_loss: 0.6202 | reward: 0.0248 | rev_kl: 1.2805 | stu_lens: 119.5000 | mixed_lens: 128.0000 | lr: 3.9052e-06 | scale: 1024.00 | time: 26.593 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1625/  5000| tot_loss: 2.0884 | rl_loss: 0.5877 | pt_loss: 1.5007 | pg_loss: 0.0142 | reg_loss: 0.5736 | reward: -0.2426 | rev_kl: 0.9315 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.9039e-06 | scale: 1024.00 | time: 26.564 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1626/  5000| tot_loss: 2.4127 | rl_loss: 0.5537 | pt_loss: 1.8591 | pg_loss: 0.0019 | reg_loss: 0.5517 | reward: -0.1922 | rev_kl: 0.6915 | stu_lens: 97.0000 | mixed_lens: 128.0000 | lr: 3.9026e-06 | scale: 1024.00 | time: 26.580 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1627/  5000| tot_loss: 1.9911 | rl_loss: 0.5401 | pt_loss: 1.4510 | pg_loss: -0.0031 | reg_loss: 0.5432 | reward: -0.1999 | rev_kl: 0.7227 | stu_lens: 119.5000 | mixed_lens: 128.0000 | lr: 3.9012e-06 | scale: 1024.00 | time: 26.569 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1628/  5000| tot_loss: 2.5221 | rl_loss: 0.9237 | pt_loss: 1.5984 | pg_loss: 0.3198 | reg_loss: 0.6039 | reward: -0.2804 | rev_kl: 0.9792 | stu_lens: 62.0000 | mixed_lens: 87.5000 | lr: 3.8999e-06 | scale: 1024.00 | time: 26.595 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1629/  5000| tot_loss: 2.1447 | rl_loss: 0.5432 | pt_loss: 1.6015 | pg_loss: 0.0090 | reg_loss: 0.5343 | reward: -0.2922 | rev_kl: 0.8353 | stu_lens: 128.0000 | mixed_lens: 123.0000 | lr: 3.8986e-06 | scale: 1024.00 | time: 26.598 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1630/  5000| tot_loss: 2.9840 | rl_loss: 0.7356 | pt_loss: 2.2484 | pg_loss: 0.2201 | reg_loss: 0.5155 | reward: -0.3891 | rev_kl: 0.5632 | stu_lens: 88.0000 | mixed_lens: 80.0000 | lr: 3.8972e-06 | scale: 1024.00 | time: 26.600 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1631/  5000| tot_loss: 2.6247 | rl_loss: 0.9233 | pt_loss: 1.7014 | pg_loss: 0.2073 | reg_loss: 0.7160 | reward: -0.0294 | rev_kl: 0.6309 | stu_lens: 103.5000 | mixed_lens: 39.5000 | lr: 3.8959e-06 | scale: 1024.00 | time: 26.563 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1632/  5000| tot_loss: 2.3928 | rl_loss: 0.6430 | pt_loss: 1.7498 | pg_loss: 0.0251 | reg_loss: 0.6179 | reward: -0.1012 | rev_kl: 0.7110 | stu_lens: 119.0000 | mixed_lens: 128.0000 | lr: 3.8946e-06 | scale: 1024.00 | time: 26.605 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1632/  5000| tot_loss: 2.3815 | rl_loss: 0.7939 | pt_loss: 1.5876 | pg_loss: 0.1767 | reg_loss: 0.6172 | reward: -0.2321 | rev_kl: 0.8927 | stu_lens: 101.6094 | mixed_lens: 101.4375 | lr: 3.8946e-06 | scale: 1024.00 | time: 26.605 | step time: 27.869
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1633/  5000| tot_loss: 2.7835 | rl_loss: 0.5851 | pt_loss: 2.1984 | pg_loss: 0.1154 | reg_loss: 0.4697 | reward: -0.2141 | rev_kl: 1.0573 | stu_lens: 128.0000 | mixed_lens: 106.0000 | lr: 3.8933e-06 | scale: 1024.00 | time: 26.569 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1634/  5000| tot_loss: 2.4069 | rl_loss: 0.7496 | pt_loss: 1.6572 | pg_loss: 0.3009 | reg_loss: 0.4487 | reward: -0.7849 | rev_kl: 0.3812 | stu_lens: 18.0000 | mixed_lens: 79.0000 | lr: 3.8919e-06 | scale: 1024.00 | time: 26.622 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1635/  5000| tot_loss: 2.5450 | rl_loss: 0.6496 | pt_loss: 1.8953 | pg_loss: 0.1591 | reg_loss: 0.4905 | reward: -0.0310 | rev_kl: 0.8408 | stu_lens: 128.0000 | mixed_lens: 92.0000 | lr: 3.8906e-06 | scale: 1024.00 | time: 26.613 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1636/  5000| tot_loss: 3.0691 | rl_loss: 0.8496 | pt_loss: 2.2195 | pg_loss: 0.4538 | reg_loss: 0.3958 | reward: -0.1911 | rev_kl: 0.8977 | stu_lens: 128.0000 | mixed_lens: 75.5000 | lr: 3.8893e-06 | scale: 1024.00 | time: 26.612 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1637/  5000| tot_loss: 2.4357 | rl_loss: 0.6994 | pt_loss: 1.7363 | pg_loss: 0.1853 | reg_loss: 0.5141 | reward: -0.3868 | rev_kl: 2.2440 | stu_lens: 71.5000 | mixed_lens: 88.0000 | lr: 3.8879e-06 | scale: 1024.00 | time: 26.605 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1638/  5000| tot_loss: 2.7454 | rl_loss: 0.7301 | pt_loss: 2.0152 | pg_loss: 0.3076 | reg_loss: 0.4226 | reward: -0.2062 | rev_kl: 1.0318 | stu_lens: 77.5000 | mixed_lens: 76.0000 | lr: 3.8866e-06 | scale: 1024.00 | time: 26.616 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1639/  5000| tot_loss: 1.7580 | rl_loss: 0.3911 | pt_loss: 1.3669 | pg_loss: 0.0100 | reg_loss: 0.3812 | reward: -0.1774 | rev_kl: 1.0262 | stu_lens: 128.0000 | mixed_lens: 123.5000 | lr: 3.8853e-06 | scale: 1024.00 | time: 26.538 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1640/  5000| tot_loss: 2.0999 | rl_loss: 0.4159 | pt_loss: 1.6840 | pg_loss: -0.0194 | reg_loss: 0.4354 | reward: 0.0760 | rev_kl: 1.4956 | stu_lens: 107.0000 | mixed_lens: 128.0000 | lr: 3.8839e-06 | scale: 1024.00 | time: 26.580 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1641/  5000| tot_loss: 2.7223 | rl_loss: 0.6231 | pt_loss: 2.0992 | pg_loss: 0.3159 | reg_loss: 0.3072 | reward: -0.2429 | rev_kl: 0.4104 | stu_lens: 97.0000 | mixed_lens: 88.0000 | lr: 3.8826e-06 | scale: 1024.00 | time: 26.568 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1642/  5000| tot_loss: 2.8008 | rl_loss: 0.9700 | pt_loss: 1.8307 | pg_loss: 0.5656 | reg_loss: 0.4044 | reward: -0.4090 | rev_kl: 0.7997 | stu_lens: 83.0000 | mixed_lens: 65.5000 | lr: 3.8813e-06 | scale: 1024.00 | time: 26.649 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1643/  5000| tot_loss: 2.6106 | rl_loss: 0.6498 | pt_loss: 1.9608 | pg_loss: 0.1622 | reg_loss: 0.4876 | reward: -0.2087 | rev_kl: 0.7260 | stu_lens: 119.5000 | mixed_lens: 105.0000 | lr: 3.8799e-06 | scale: 1024.00 | time: 26.598 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1644/  5000| tot_loss: 2.3504 | rl_loss: 0.5491 | pt_loss: 1.8013 | pg_loss: 0.2151 | reg_loss: 0.3340 | reward: 0.1119 | rev_kl: 0.7909 | stu_lens: 119.5000 | mixed_lens: 74.5000 | lr: 3.8786e-06 | scale: 1024.00 | time: 26.598 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1645/  5000| tot_loss: 2.1107 | rl_loss: 0.9499 | pt_loss: 1.1607 | pg_loss: 0.4555 | reg_loss: 0.4944 | reward: -0.2615 | rev_kl: 0.8410 | stu_lens: 90.0000 | mixed_lens: 77.5000 | lr: 3.8772e-06 | scale: 1024.00 | time: 26.607 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1646/  5000| tot_loss: 2.3231 | rl_loss: 0.6237 | pt_loss: 1.6994 | pg_loss: 0.2086 | reg_loss: 0.4151 | reward: -0.4519 | rev_kl: 1.1790 | stu_lens: 81.5000 | mixed_lens: 89.5000 | lr: 3.8759e-06 | scale: 1024.00 | time: 26.621 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1647/  5000| tot_loss: 1.8054 | rl_loss: 0.4253 | pt_loss: 1.3801 | pg_loss: 0.0265 | reg_loss: 0.3987 | reward: -0.3352 | rev_kl: 0.9231 | stu_lens: 99.5000 | mixed_lens: 128.0000 | lr: 3.8746e-06 | scale: 1024.00 | time: 26.603 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1648/  5000| tot_loss: 2.3486 | rl_loss: 0.3733 | pt_loss: 1.9753 | pg_loss: -0.0078 | reg_loss: 0.3811 | reward: -0.1315 | rev_kl: 0.7238 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8732e-06 | scale: 1024.00 | time: 26.627 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1648/  5000| tot_loss: 2.3176 | rl_loss: 0.5796 | pt_loss: 1.7381 | pg_loss: 0.1414 | reg_loss: 0.4381 | reward: -0.2328 | rev_kl: 0.8995 | stu_lens: 101.4688 | mixed_lens: 100.8438 | lr: 3.8732e-06 | scale: 1024.00 | time: 26.627 | step time: 27.887
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1649/  5000| tot_loss: 2.1910 | rl_loss: 0.6133 | pt_loss: 1.5777 | pg_loss: 0.0463 | reg_loss: 0.5670 | reward: -0.3483 | rev_kl: 0.8324 | stu_lens: 128.0000 | mixed_lens: 115.5000 | lr: 3.8719e-06 | scale: 1024.00 | time: 26.629 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1650/  5000| tot_loss: 2.4216 | rl_loss: 0.5896 | pt_loss: 1.8319 | pg_loss: 0.2076 | reg_loss: 0.3820 | reward: 0.1821 | rev_kl: 0.6821 | stu_lens: 75.0000 | mixed_lens: 74.5000 | lr: 3.8705e-06 | scale: 1024.00 | time: 26.624 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1651/  5000| tot_loss: 2.0144 | rl_loss: 0.3564 | pt_loss: 1.6580 | pg_loss: -0.0073 | reg_loss: 0.3637 | reward: -0.1266 | rev_kl: 0.5666 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8692e-06 | scale: 1024.00 | time: 26.601 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1652/  5000| tot_loss: 1.7904 | rl_loss: 0.2997 | pt_loss: 1.4907 | pg_loss: -0.0260 | reg_loss: 0.3257 | reward: -0.1070 | rev_kl: 0.7140 | stu_lens: 122.5000 | mixed_lens: 128.0000 | lr: 3.8679e-06 | scale: 1024.00 | time: 26.633 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1653/  5000| tot_loss: 2.1541 | rl_loss: 0.2853 | pt_loss: 1.8688 | pg_loss: -0.0142 | reg_loss: 0.2994 | reward: -0.2532 | rev_kl: 0.5000 | stu_lens: 95.0000 | mixed_lens: 128.0000 | lr: 3.8665e-06 | scale: 1024.00 | time: 26.616 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1654/  5000| tot_loss: 3.1227 | rl_loss: 0.8997 | pt_loss: 2.2230 | pg_loss: 0.6333 | reg_loss: 0.2664 | reward: -0.0296 | rev_kl: 0.6690 | stu_lens: 15.0000 | mixed_lens: 24.0000 | lr: 3.8652e-06 | scale: 1024.00 | time: 26.629 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1655/  5000| tot_loss: 3.1212 | rl_loss: 0.7490 | pt_loss: 2.3722 | pg_loss: 0.3679 | reg_loss: 0.3811 | reward: -0.4997 | rev_kl: 0.9234 | stu_lens: 81.5000 | mixed_lens: 67.5000 | lr: 3.8638e-06 | scale: 1024.00 | time: 26.606 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1656/  5000| tot_loss: 2.6436 | rl_loss: 0.9867 | pt_loss: 1.6570 | pg_loss: 0.6232 | reg_loss: 0.3635 | reward: -0.4244 | rev_kl: 0.6732 | stu_lens: 15.5000 | mixed_lens: 32.0000 | lr: 3.8625e-06 | scale: 1024.00 | time: 26.617 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1657/  5000| tot_loss: 2.1268 | rl_loss: 0.2756 | pt_loss: 1.8512 | pg_loss: -0.0036 | reg_loss: 0.2792 | reward: -0.2557 | rev_kl: 1.0899 | stu_lens: 96.0000 | mixed_lens: 128.0000 | lr: 3.8611e-06 | scale: 1024.00 | time: 26.564 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1658/  5000| tot_loss: 2.5597 | rl_loss: 0.4900 | pt_loss: 2.0697 | pg_loss: 0.1869 | reg_loss: 0.3032 | reward: -0.3138 | rev_kl: 0.9098 | stu_lens: 128.0000 | mixed_lens: 105.0000 | lr: 3.8598e-06 | scale: 1024.00 | time: 26.602 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1659/  5000| tot_loss: 2.2083 | rl_loss: 0.5022 | pt_loss: 1.7061 | pg_loss: 0.2493 | reg_loss: 0.2529 | reward: -0.3394 | rev_kl: 1.0341 | stu_lens: 77.5000 | mixed_lens: 91.0000 | lr: 3.8585e-06 | scale: 1024.00 | time: 26.600 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1660/  5000| tot_loss: 1.7495 | rl_loss: 0.4167 | pt_loss: 1.3328 | pg_loss: -0.0035 | reg_loss: 0.4201 | reward: -0.2636 | rev_kl: 0.8423 | stu_lens: 119.5000 | mixed_lens: 128.0000 | lr: 3.8571e-06 | scale: 1024.00 | time: 26.637 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1661/  5000| tot_loss: 2.5662 | rl_loss: 0.2200 | pt_loss: 2.3461 | pg_loss: -0.0044 | reg_loss: 0.2244 | reward: -0.2474 | rev_kl: 0.5009 | stu_lens: 119.5000 | mixed_lens: 128.0000 | lr: 3.8558e-06 | scale: 1024.00 | time: 26.631 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1662/  5000| tot_loss: 2.5886 | rl_loss: 0.7870 | pt_loss: 1.8016 | pg_loss: 0.3426 | reg_loss: 0.4444 | reward: -0.7290 | rev_kl: 0.6238 | stu_lens: 71.0000 | mixed_lens: 79.0000 | lr: 3.8544e-06 | scale: 1024.00 | time: 26.686 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1663/  5000| tot_loss: 2.1476 | rl_loss: 0.3958 | pt_loss: 1.7518 | pg_loss: 0.1106 | reg_loss: 0.2852 | reward: -0.1799 | rev_kl: 1.1629 | stu_lens: 128.0000 | mixed_lens: 84.0000 | lr: 3.8531e-06 | scale: 1024.00 | time: 26.616 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1664/  5000| tot_loss: 2.1300 | rl_loss: 0.8035 | pt_loss: 1.3265 | pg_loss: 0.2626 | reg_loss: 0.5409 | reward: -0.4907 | rev_kl: 1.8698 | stu_lens: 103.5000 | mixed_lens: 93.0000 | lr: 3.8517e-06 | scale: 1024.00 | time: 26.642 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1664/  5000| tot_loss: 2.3185 | rl_loss: 0.5230 | pt_loss: 1.7956 | pg_loss: 0.1561 | reg_loss: 0.3669 | reward: -0.2392 | rev_kl: 0.9357 | stu_lens: 102.9688 | mixed_lens: 101.4531 | lr: 3.8517e-06 | scale: 1024.00 | time: 26.642 | step time: 27.906
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1665/  5000| tot_loss: 1.8637 | rl_loss: 0.3326 | pt_loss: 1.5311 | pg_loss: -0.0085 | reg_loss: 0.3410 | reward: -0.1136 | rev_kl: 1.3590 | stu_lens: 128.0000 | mixed_lens: 123.0000 | lr: 3.8504e-06 | scale: 1024.00 | time: 26.616 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1666/  5000| tot_loss: 2.1960 | rl_loss: 0.6572 | pt_loss: 1.5388 | pg_loss: 0.1055 | reg_loss: 0.5517 | reward: -0.1083 | rev_kl: 1.0589 | stu_lens: 128.0000 | mixed_lens: 104.0000 | lr: 3.8490e-06 | scale: 1024.00 | time: 26.648 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1667/  5000| tot_loss: 3.4338 | rl_loss: 1.7792 | pt_loss: 1.6546 | pg_loss: 0.6190 | reg_loss: 1.1602 | reward: -0.4893 | rev_kl: 1.1800 | stu_lens: 71.5000 | mixed_lens: 68.0000 | lr: 3.8477e-06 | scale: 1024.00 | time: 26.625 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1668/  5000| tot_loss: 2.5227 | rl_loss: 0.7634 | pt_loss: 1.7593 | pg_loss: 0.1793 | reg_loss: 0.5842 | reward: -0.2771 | rev_kl: 1.1093 | stu_lens: 84.0000 | mixed_lens: 107.5000 | lr: 3.8463e-06 | scale: 1024.00 | time: 26.603 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1669/  5000| tot_loss: 3.3769 | rl_loss: 1.4208 | pt_loss: 1.9561 | pg_loss: 0.6824 | reg_loss: 0.7384 | reward: -0.6628 | rev_kl: 0.8680 | stu_lens: 72.5000 | mixed_lens: 65.5000 | lr: 3.8450e-06 | scale: 1024.00 | time: 26.633 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1670/  5000| tot_loss: 3.7764 | rl_loss: 1.6738 | pt_loss: 2.1026 | pg_loss: 0.4981 | reg_loss: 1.1757 | reward: -0.0782 | rev_kl: 0.8423 | stu_lens: 128.0000 | mixed_lens: 80.0000 | lr: 3.8436e-06 | scale: 1024.00 | time: 26.613 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1671/  5000| tot_loss: 3.1770 | rl_loss: 1.4678 | pt_loss: 1.7092 | pg_loss: 0.1858 | reg_loss: 1.2820 | reward: -0.2957 | rev_kl: 0.9116 | stu_lens: 104.5000 | mixed_lens: 112.5000 | lr: 3.8423e-06 | scale: 1024.00 | time: 26.629 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1672/  5000| tot_loss: 2.5494 | rl_loss: 1.0078 | pt_loss: 1.5416 | pg_loss: 0.3324 | reg_loss: 0.6754 | reward: -0.3138 | rev_kl: 0.2822 | stu_lens: 80.5000 | mixed_lens: 80.0000 | lr: 3.8409e-06 | scale: 1024.00 | time: 26.637 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1673/  5000| tot_loss: 3.5838 | rl_loss: 1.5355 | pt_loss: 2.0483 | pg_loss: 0.0851 | reg_loss: 1.4503 | reward: -0.5450 | rev_kl: 0.7851 | stu_lens: 108.5000 | mixed_lens: 125.5000 | lr: 3.8396e-06 | scale: 1024.00 | time: 26.631 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1674/  5000| tot_loss: 2.6980 | rl_loss: 0.8477 | pt_loss: 1.8502 | pg_loss: 0.0689 | reg_loss: 0.7789 | reward: -0.0857 | rev_kl: 0.8632 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8382e-06 | scale: 1024.00 | time: 26.614 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1675/  5000| tot_loss: 3.2159 | rl_loss: 1.1131 | pt_loss: 2.1027 | pg_loss: 0.0600 | reg_loss: 1.0531 | reward: -0.3132 | rev_kl: 1.4098 | stu_lens: 93.0000 | mixed_lens: 128.0000 | lr: 3.8369e-06 | scale: 1024.00 | time: 26.644 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1676/  5000| tot_loss: 2.6831 | rl_loss: 1.0689 | pt_loss: 1.6143 | pg_loss: 0.1798 | reg_loss: 0.8891 | reward: -0.3541 | rev_kl: 1.1107 | stu_lens: 128.0000 | mixed_lens: 79.0000 | lr: 3.8355e-06 | scale: 1024.00 | time: 26.593 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1677/  5000| tot_loss: 2.5967 | rl_loss: 0.8438 | pt_loss: 1.7528 | pg_loss: 0.0700 | reg_loss: 0.7739 | reward: -0.1444 | rev_kl: 0.6754 | stu_lens: 103.0000 | mixed_lens: 127.0000 | lr: 3.8341e-06 | scale: 1024.00 | time: 26.631 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1678/  5000| tot_loss: 3.0261 | rl_loss: 1.3670 | pt_loss: 1.6591 | pg_loss: 0.0570 | reg_loss: 1.3100 | reward: -0.2419 | rev_kl: 0.9635 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8328e-06 | scale: 1024.00 | time: 26.611 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1679/  5000| tot_loss: 2.5189 | rl_loss: 1.1052 | pt_loss: 1.4137 | pg_loss: 0.0729 | reg_loss: 1.0324 | reward: -0.1609 | rev_kl: 0.6582 | stu_lens: 78.0000 | mixed_lens: 128.0000 | lr: 3.8314e-06 | scale: 1024.00 | time: 26.636 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1680/  5000| tot_loss: 4.1717 | rl_loss: 2.3063 | pt_loss: 1.8654 | pg_loss: 1.8208 | reg_loss: 0.4855 | reward: -0.9329 | rev_kl: 0.7534 | stu_lens: 14.0000 | mixed_lens: 17.5000 | lr: 3.8301e-06 | scale: 1024.00 | time: 26.573 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1680/  5000| tot_loss: 2.8533 | rl_loss: 1.1700 | pt_loss: 1.6832 | pg_loss: 0.2770 | reg_loss: 0.8930 | reward: -0.2897 | rev_kl: 0.8990 | stu_lens: 100.0469 | mixed_lens: 99.2812 | lr: 3.8301e-06 | scale: 1024.00 | time: 26.573 | step time: 27.908
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1681/  5000| tot_loss: 3.0514 | rl_loss: 1.1513 | pt_loss: 1.9001 | pg_loss: 0.1109 | reg_loss: 1.0404 | reward: -0.1096 | rev_kl: 0.8273 | stu_lens: 94.0000 | mixed_lens: 120.0000 | lr: 3.8287e-06 | scale: 1024.00 | time: 26.597 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1682/  5000| tot_loss: 2.7152 | rl_loss: 0.9474 | pt_loss: 1.7678 | pg_loss: -0.0125 | reg_loss: 0.9599 | reward: -0.2190 | rev_kl: 0.5238 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8274e-06 | scale: 1024.00 | time: 26.606 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1683/  5000| tot_loss: 1.8668 | rl_loss: 0.4492 | pt_loss: 1.4176 | pg_loss: 0.0164 | reg_loss: 0.4328 | reward: -0.0763 | rev_kl: 0.7598 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8260e-06 | scale: 1024.00 | time: 26.647 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1684/  5000| tot_loss: 3.3156 | rl_loss: 1.2740 | pt_loss: 2.0417 | pg_loss: 0.4253 | reg_loss: 0.8487 | reward: -0.4262 | rev_kl: 0.8093 | stu_lens: 77.0000 | mixed_lens: 65.0000 | lr: 3.8246e-06 | scale: 1024.00 | time: 26.575 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1685/  5000| tot_loss: 1.9773 | rl_loss: 0.3034 | pt_loss: 1.6739 | pg_loss: -0.0167 | reg_loss: 0.3201 | reward: -0.1204 | rev_kl: 0.5696 | stu_lens: 99.5000 | mixed_lens: 128.0000 | lr: 3.8233e-06 | scale: 1024.00 | time: 26.627 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1686/  5000| tot_loss: 2.8459 | rl_loss: 0.8299 | pt_loss: 2.0160 | pg_loss: 0.2557 | reg_loss: 0.5742 | reward: -0.3254 | rev_kl: 1.0949 | stu_lens: 81.5000 | mixed_lens: 92.0000 | lr: 3.8219e-06 | scale: 1024.00 | time: 26.573 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1687/  5000| tot_loss: 2.0739 | rl_loss: 0.4207 | pt_loss: 1.6533 | pg_loss: 0.3503 | reg_loss: 0.0704 | reward: -0.2308 | rev_kl: 1.1170 | stu_lens: 74.0000 | mixed_lens: 53.0000 | lr: 3.8206e-06 | scale: 1024.00 | time: 26.598 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1688/  5000| tot_loss: 2.0620 | rl_loss: 0.5279 | pt_loss: 1.5341 | pg_loss: -0.0145 | reg_loss: 0.5424 | reward: -0.1038 | rev_kl: 0.8828 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8192e-06 | scale: 1024.00 | time: 26.568 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1689/  5000| tot_loss: 2.3874 | rl_loss: 0.6368 | pt_loss: 1.7506 | pg_loss: 0.2838 | reg_loss: 0.3531 | reward: -0.2127 | rev_kl: 0.2943 | stu_lens: 77.5000 | mixed_lens: 80.5000 | lr: 3.8178e-06 | scale: 1024.00 | time: 26.588 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1690/  5000| tot_loss: 2.6837 | rl_loss: 0.9326 | pt_loss: 1.7512 | pg_loss: 0.3122 | reg_loss: 0.6204 | reward: -0.0879 | rev_kl: 0.8584 | stu_lens: 128.0000 | mixed_lens: 83.5000 | lr: 3.8165e-06 | scale: 1024.00 | time: 26.600 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1691/  5000| tot_loss: 2.2672 | rl_loss: 0.4840 | pt_loss: 1.7832 | pg_loss: 0.0022 | reg_loss: 0.4818 | reward: -0.2132 | rev_kl: 0.9104 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8151e-06 | scale: 1024.00 | time: 26.645 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1692/  5000| tot_loss: 3.1707 | rl_loss: 1.4219 | pt_loss: 1.7487 | pg_loss: 0.4534 | reg_loss: 0.9685 | reward: -0.8877 | rev_kl: 0.6523 | stu_lens: 68.0000 | mixed_lens: 68.5000 | lr: 3.8138e-06 | scale: 1024.00 | time: 26.569 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1693/  5000| tot_loss: 2.0485 | rl_loss: 0.5959 | pt_loss: 1.4526 | pg_loss: -0.0000 | reg_loss: 0.5959 | reward: -0.1860 | rev_kl: 0.9760 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8124e-06 | scale: 1024.00 | time: 26.622 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1694/  5000| tot_loss: 2.7967 | rl_loss: 0.8013 | pt_loss: 1.9954 | pg_loss: 0.2714 | reg_loss: 0.5299 | reward: -0.4484 | rev_kl: 0.5732 | stu_lens: 68.5000 | mixed_lens: 88.0000 | lr: 3.8110e-06 | scale: 1024.00 | time: 26.613 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1695/  5000| tot_loss: 2.1965 | rl_loss: 0.6867 | pt_loss: 1.5098 | pg_loss: 0.1501 | reg_loss: 0.5367 | reward: -0.2161 | rev_kl: 0.5639 | stu_lens: 128.0000 | mixed_lens: 108.5000 | lr: 3.8097e-06 | scale: 1024.00 | time: 26.625 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1696/  5000| tot_loss: 2.5705 | rl_loss: 0.5356 | pt_loss: 2.0349 | pg_loss: 0.0022 | reg_loss: 0.5334 | reward: -0.1569 | rev_kl: 0.9051 | stu_lens: 102.5000 | mixed_lens: 128.0000 | lr: 3.8083e-06 | scale: 1024.00 | time: 26.580 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1696/  5000| tot_loss: 2.5861 | rl_loss: 0.8431 | pt_loss: 1.7430 | pg_loss: 0.1957 | reg_loss: 0.6474 | reward: -0.2799 | rev_kl: 0.8869 | stu_lens: 99.8281 | mixed_lens: 98.6094 | lr: 3.8083e-06 | scale: 1024.00 | time: 26.580 | step time: 27.882
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1697/  5000| tot_loss: 2.7011 | rl_loss: 0.6545 | pt_loss: 2.0466 | pg_loss: 0.0796 | reg_loss: 0.5749 | reward: -0.3177 | rev_kl: 1.2728 | stu_lens: 126.0000 | mixed_lens: 106.0000 | lr: 3.8069e-06 | scale: 1024.00 | time: 26.671 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1698/  5000| tot_loss: 1.9864 | rl_loss: 0.8575 | pt_loss: 1.1288 | pg_loss: 0.1377 | reg_loss: 0.7198 | reward: -0.2049 | rev_kl: 1.0243 | stu_lens: 104.5000 | mixed_lens: 112.5000 | lr: 3.8056e-06 | scale: 1024.00 | time: 26.651 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1699/  5000| tot_loss: 2.6394 | rl_loss: 0.5804 | pt_loss: 2.0590 | pg_loss: 0.1245 | reg_loss: 0.4559 | reward: -0.3938 | rev_kl: 1.2377 | stu_lens: 95.5000 | mixed_lens: 92.5000 | lr: 3.8042e-06 | scale: 1024.00 | time: 26.651 | step time: 0.000
                                 Evaluation #17                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son las partículas        │
│                                       │ elementales que forman la            │
│                                       │ composición del núcleo de los        │
│                                       │ átomos. Existe una pareja de cuarks  │
│                                       │ de eacher y de anti-eacher, que se   │
│                                       │ encuentran en el núcleo de cada      │
│                                       │ átomo.                               │
│                                       │                                      │
│                                       │ Los cuarks son categorizados en tres │
│                                       │ diferentes tipos por su masa:        │
│                                       │                                      │
│                                       │ - Cuarks ligeros o leptons: Son los  │
│                                       │ cuarks más lighets, su masa es       │
│                                       │ aproximadamente de 100 MeV.          │
│                                       │ - Cuarks medio o mesons: Son los     │
│                                       │ cuarks                               │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es un acrónimo de "imagen de  │
│                                       │ mínima complejidad" y se refiere a   │
│                                       │ la minimización de la complejidad de │
│                                       │ una imagen o modelo matemático.      │
│                                       │                                      │
│                                       │ La complejidad de una imagen se      │
│                                       │ reduce al máximo cuando se emplean   │
│                                       │ los mejores algoritmos de            │
│                                       │ minimización de la complejidad y se  │
│                                       │ utilizan los mejores modelos         │
│                                       │ matemáticos disponibles.             │
│                                       │                                      │
│                                       │ La utilidad del IMC es reducir la    │
│                                       │ complejidad de la imagen o modelo    │
│                                       │ matemático sin perder la información │
│                                       │ importanta de                        │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ 1. Cápsula del tiempo de Jules       │
│                                       │ Verne, 1867                          │
│                                       │ 2. Cápsula del tiempo de Georges     │
│                                       │ Méliès, 1899                         │
│                                       │ 3. Cápsula del tiempo de Abraham     │
│                                       │ Lincoln, 1901                        │
│                                       │ 4. Cápsula del tiempo de Albert      │
│                                       │ Einstein, 1905                       │
│                                       │ 5. Cápsula del tiempo de Henry Ford, │
│                                       │ 1910                                 │
│                                       │ 6. Cápsula del tiempo de Edison,     │
│                                       │ 1910                                 │
│                                       │ 7. Cápsula del tiempo de Houdini, 19 │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.672 | exact_match: 0.000 | rev_kl: 0.858 | lens: 99.741 | pt_loss: 1.741 | lm_loss: 1.873 | kd_loss: 1.609 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1700/  5000| tot_loss: 2.4530 | rl_loss: 0.6937 | pt_loss: 1.7593 | pg_loss: 0.3347 | reg_loss: 0.3590 | reward: -0.2742 | rev_kl: 0.9123 | stu_lens: 74.0000 | mixed_lens: 77.0000 | lr: 3.8028e-06 | scale: 1024.00 | time: 26.595 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1701/  5000| tot_loss: 2.3600 | rl_loss: 0.4661 | pt_loss: 1.8938 | pg_loss: 0.0303 | reg_loss: 0.4358 | reward: -0.0890 | rev_kl: 0.7364 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.8015e-06 | scale: 1024.00 | time: 26.638 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1702/  5000| tot_loss: 2.5028 | rl_loss: 0.6232 | pt_loss: 1.8796 | pg_loss: 0.2185 | reg_loss: 0.4047 | reward: -0.0837 | rev_kl: 1.1208 | stu_lens: 128.0000 | mixed_lens: 83.5000 | lr: 3.8001e-06 | scale: 1024.00 | time: 26.673 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1703/  5000| tot_loss: 2.0477 | rl_loss: 0.5259 | pt_loss: 1.5217 | pg_loss: 0.1677 | reg_loss: 0.3582 | reward: -0.1393 | rev_kl: 0.8339 | stu_lens: 128.0000 | mixed_lens: 103.0000 | lr: 3.7987e-06 | scale: 1024.00 | time: 26.628 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1704/  5000| tot_loss: 2.3141 | rl_loss: 0.6279 | pt_loss: 1.6862 | pg_loss: 0.2669 | reg_loss: 0.3610 | reward: -0.2854 | rev_kl: 0.5551 | stu_lens: 56.0000 | mixed_lens: 81.0000 | lr: 3.7974e-06 | scale: 1024.00 | time: 26.644 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1705/  5000| tot_loss: 2.1541 | rl_loss: 0.4559 | pt_loss: 1.6983 | pg_loss: 0.3174 | reg_loss: 0.1385 | reward: -0.0896 | rev_kl: 0.5867 | stu_lens: 92.5000 | mixed_lens: 86.5000 | lr: 3.7960e-06 | scale: 1024.00 | time: 26.633 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1706/  5000| tot_loss: 2.3543 | rl_loss: 0.4023 | pt_loss: 1.9520 | pg_loss: 0.0851 | reg_loss: 0.3172 | reward: -0.5846 | rev_kl: 1.3302 | stu_lens: 101.0000 | mixed_lens: 81.0000 | lr: 3.7946e-06 | scale: 1024.00 | time: 26.650 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1707/  5000| tot_loss: 2.4200 | rl_loss: 0.3867 | pt_loss: 2.0333 | pg_loss: -0.0027 | reg_loss: 0.3894 | reward: -0.1112 | rev_kl: 1.1131 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7932e-06 | scale: 1024.00 | time: 26.627 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1708/  5000| tot_loss: 2.5041 | rl_loss: 0.5857 | pt_loss: 1.9184 | pg_loss: 0.1649 | reg_loss: 0.4209 | reward: -0.2754 | rev_kl: 0.7728 | stu_lens: 128.0000 | mixed_lens: 108.5000 | lr: 3.7919e-06 | scale: 1024.00 | time: 26.638 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1709/  5000| tot_loss: 2.8524 | rl_loss: 1.0632 | pt_loss: 1.7891 | pg_loss: 0.5253 | reg_loss: 0.5380 | reward: -0.2932 | rev_kl: 1.2114 | stu_lens: 98.5000 | mixed_lens: 77.0000 | lr: 3.7905e-06 | scale: 1024.00 | time: 26.637 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1710/  5000| tot_loss: 2.5731 | rl_loss: 1.3335 | pt_loss: 1.2396 | pg_loss: 0.9622 | reg_loss: 0.3713 | reward: -0.7780 | rev_kl: 0.8401 | stu_lens: 74.5000 | mixed_lens: 35.5000 | lr: 3.7891e-06 | scale: 1024.00 | time: 26.647 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1711/  5000| tot_loss: 2.4758 | rl_loss: 0.6044 | pt_loss: 1.8714 | pg_loss: 0.0790 | reg_loss: 0.5254 | reward: -0.4151 | rev_kl: 0.9691 | stu_lens: 108.5000 | mixed_lens: 125.5000 | lr: 3.7877e-06 | scale: 1024.00 | time: 26.649 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1712/  5000| tot_loss: 2.3262 | rl_loss: 0.3793 | pt_loss: 1.9469 | pg_loss: -0.0008 | reg_loss: 0.3801 | reward: -0.0987 | rev_kl: 0.8891 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7864e-06 | scale: 1024.00 | time: 26.663 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1712/  5000| tot_loss: 2.4627 | rl_loss: 0.6742 | pt_loss: 1.7885 | pg_loss: 0.2168 | reg_loss: 0.4575 | reward: -0.2969 | rev_kl: 0.8762 | stu_lens: 98.0781 | mixed_lens: 97.2344 | lr: 3.7864e-06 | scale: 1024.00 | time: 26.663 | step time: 27.922
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1713/  5000| tot_loss: 2.3899 | rl_loss: 0.5248 | pt_loss: 1.8651 | pg_loss: 0.0360 | reg_loss: 0.4888 | reward: -0.1494 | rev_kl: 0.8604 | stu_lens: 123.5000 | mixed_lens: 128.0000 | lr: 3.7850e-06 | scale: 1024.00 | time: 26.648 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1714/  5000| tot_loss: 2.3323 | rl_loss: 0.5253 | pt_loss: 1.8070 | pg_loss: 0.2625 | reg_loss: 0.2628 | reward: -0.1205 | rev_kl: 0.6160 | stu_lens: 92.5000 | mixed_lens: 86.5000 | lr: 3.7836e-06 | scale: 1024.00 | time: 26.654 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1715/  5000| tot_loss: 2.6614 | rl_loss: 0.7449 | pt_loss: 1.9165 | pg_loss: 0.2387 | reg_loss: 0.5062 | reward: -0.2010 | rev_kl: 1.1036 | stu_lens: 118.5000 | mixed_lens: 90.0000 | lr: 3.7822e-06 | scale: 1024.00 | time: 26.600 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1716/  5000| tot_loss: 2.6328 | rl_loss: 0.5700 | pt_loss: 2.0628 | pg_loss: 0.1627 | reg_loss: 0.4074 | reward: -0.3716 | rev_kl: 1.1053 | stu_lens: 93.0000 | mixed_lens: 108.5000 | lr: 3.7809e-06 | scale: 1024.00 | time: 26.659 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1717/  5000| tot_loss: 2.1494 | rl_loss: 0.5008 | pt_loss: 1.6487 | pg_loss: 0.1370 | reg_loss: 0.3638 | reward: -0.0608 | rev_kl: 0.9477 | stu_lens: 110.5000 | mixed_lens: 115.5000 | lr: 3.7795e-06 | scale: 1024.00 | time: 26.597 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1718/  5000| tot_loss: 2.5961 | rl_loss: 0.6940 | pt_loss: 1.9022 | pg_loss: 0.2151 | reg_loss: 0.4789 | reward: -0.2722 | rev_kl: 0.5553 | stu_lens: 72.0000 | mixed_lens: 89.0000 | lr: 3.7781e-06 | scale: 1024.00 | time: 26.623 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1719/  5000| tot_loss: 2.7225 | rl_loss: 0.8226 | pt_loss: 1.8999 | pg_loss: 0.4693 | reg_loss: 0.3533 | reward: -0.7174 | rev_kl: 0.9547 | stu_lens: 90.0000 | mixed_lens: 77.0000 | lr: 3.7767e-06 | scale: 1024.00 | time: 26.597 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1720/  5000| tot_loss: 2.3874 | rl_loss: 0.5312 | pt_loss: 1.8562 | pg_loss: 0.0760 | reg_loss: 0.4553 | reward: -0.4661 | rev_kl: 1.1983 | stu_lens: 108.5000 | mixed_lens: 125.5000 | lr: 3.7754e-06 | scale: 1024.00 | time: 26.693 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1721/  5000| tot_loss: 2.3181 | rl_loss: 0.6982 | pt_loss: 1.6199 | pg_loss: 0.2268 | reg_loss: 0.4714 | reward: -0.2942 | rev_kl: 0.7314 | stu_lens: 118.5000 | mixed_lens: 97.0000 | lr: 3.7740e-06 | scale: 1024.00 | time: 26.603 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1722/  5000| tot_loss: 2.8352 | rl_loss: 0.4823 | pt_loss: 2.3529 | pg_loss: 0.1558 | reg_loss: 0.3265 | reward: -0.0945 | rev_kl: 1.0101 | stu_lens: 128.0000 | mixed_lens: 108.5000 | lr: 3.7726e-06 | scale: 1024.00 | time: 26.624 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1723/  5000| tot_loss: 2.0868 | rl_loss: 0.4716 | pt_loss: 1.6152 | pg_loss: 0.1495 | reg_loss: 0.3221 | reward: -0.1226 | rev_kl: 1.3074 | stu_lens: 106.0000 | mixed_lens: 108.0000 | lr: 3.7712e-06 | scale: 1024.00 | time: 26.608 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1724/  5000| tot_loss: 1.9069 | rl_loss: 0.2948 | pt_loss: 1.6121 | pg_loss: 0.0037 | reg_loss: 0.2911 | reward: -0.1612 | rev_kl: 0.5063 | stu_lens: 117.5000 | mixed_lens: 128.0000 | lr: 3.7698e-06 | scale: 1024.00 | time: 26.622 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1725/  5000| tot_loss: 2.0250 | rl_loss: 0.2641 | pt_loss: 1.7609 | pg_loss: 0.0331 | reg_loss: 0.2310 | reward: -0.1842 | rev_kl: 1.1963 | stu_lens: 128.0000 | mixed_lens: 104.0000 | lr: 3.7685e-06 | scale: 1024.00 | time: 26.600 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1726/  5000| tot_loss: 1.9815 | rl_loss: 0.3785 | pt_loss: 1.6030 | pg_loss: -0.0105 | reg_loss: 0.3890 | reward: -0.1782 | rev_kl: 1.4278 | stu_lens: 103.0000 | mixed_lens: 128.0000 | lr: 3.7671e-06 | scale: 1024.00 | time: 26.618 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1727/  5000| tot_loss: 1.9927 | rl_loss: 0.3379 | pt_loss: 1.6548 | pg_loss: 0.0080 | reg_loss: 0.3299 | reward: -0.0599 | rev_kl: 0.9710 | stu_lens: 117.5000 | mixed_lens: 128.0000 | lr: 3.7657e-06 | scale: 1024.00 | time: 26.604 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1728/  5000| tot_loss: 2.3512 | rl_loss: 0.5303 | pt_loss: 1.8209 | pg_loss: 0.1120 | reg_loss: 0.4183 | reward: -0.4287 | rev_kl: 0.7419 | stu_lens: 21.5000 | mixed_lens: 92.0000 | lr: 3.7643e-06 | scale: 1024.00 | time: 26.662 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1728/  5000| tot_loss: 2.2984 | rl_loss: 0.5201 | pt_loss: 1.7783 | pg_loss: 0.1531 | reg_loss: 0.3670 | reward: -0.2917 | rev_kl: 0.8806 | stu_lens: 101.2031 | mixed_lens: 99.3906 | lr: 3.7643e-06 | scale: 1024.00 | time: 26.662 | step time: 27.905
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1729/  5000| tot_loss: 2.6167 | rl_loss: 0.7132 | pt_loss: 1.9035 | pg_loss: 0.3687 | reg_loss: 0.3445 | reward: -0.2487 | rev_kl: 1.3548 | stu_lens: 74.0000 | mixed_lens: 77.0000 | lr: 3.7629e-06 | scale: 1024.00 | time: 26.588 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1730/  5000| tot_loss: 2.6815 | rl_loss: 0.9487 | pt_loss: 1.7328 | pg_loss: 0.0645 | reg_loss: 0.8842 | reward: -0.0986 | rev_kl: 0.3266 | stu_lens: 85.0000 | mixed_lens: 128.0000 | lr: 3.7615e-06 | scale: 1024.00 | time: 26.630 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1731/  5000| tot_loss: 2.7034 | rl_loss: 1.0779 | pt_loss: 1.6254 | pg_loss: 0.0446 | reg_loss: 1.0333 | reward: -0.1723 | rev_kl: 0.7619 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7602e-06 | scale: 1024.00 | time: 26.631 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1732/  5000| tot_loss: 2.8354 | rl_loss: 1.1199 | pt_loss: 1.7154 | pg_loss: 0.3359 | reg_loss: 0.7841 | reward: -0.1156 | rev_kl: 1.0101 | stu_lens: 112.5000 | mixed_lens: 93.5000 | lr: 3.7588e-06 | scale: 1024.00 | time: 26.635 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1733/  5000| tot_loss: 3.4531 | rl_loss: 1.6246 | pt_loss: 1.8286 | pg_loss: 0.4916 | reg_loss: 1.1329 | reward: -0.4020 | rev_kl: 0.8129 | stu_lens: 98.0000 | mixed_lens: 79.0000 | lr: 3.7574e-06 | scale: 1024.00 | time: 26.620 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1734/  5000| tot_loss: 2.9895 | rl_loss: 1.4327 | pt_loss: 1.5568 | pg_loss: 0.3148 | reg_loss: 1.1179 | reward: -0.1753 | rev_kl: 0.8182 | stu_lens: 86.5000 | mixed_lens: 86.5000 | lr: 3.7560e-06 | scale: 1024.00 | time: 26.606 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1735/  5000| tot_loss: 2.7609 | rl_loss: 0.9822 | pt_loss: 1.7786 | pg_loss: 0.0806 | reg_loss: 0.9016 | reward: -0.2138 | rev_kl: 0.8020 | stu_lens: 128.0000 | mixed_lens: 112.0000 | lr: 3.7546e-06 | scale: 1024.00 | time: 26.582 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1736/  5000| tot_loss: 3.3748 | rl_loss: 1.7032 | pt_loss: 1.6716 | pg_loss: 0.1639 | reg_loss: 1.5393 | reward: -0.1147 | rev_kl: 0.8094 | stu_lens: 125.0000 | mixed_lens: 114.5000 | lr: 3.7532e-06 | scale: 1024.00 | time: 26.604 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1737/  5000| tot_loss: 2.3463 | rl_loss: 0.9079 | pt_loss: 1.4384 | pg_loss: 0.3140 | reg_loss: 0.5939 | reward: -0.2142 | rev_kl: 0.6159 | stu_lens: 75.5000 | mixed_lens: 85.5000 | lr: 3.7519e-06 | scale: 1024.00 | time: 26.619 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1738/  5000| tot_loss: 2.7408 | rl_loss: 1.2114 | pt_loss: 1.5293 | pg_loss: 0.2050 | reg_loss: 1.0064 | reward: -0.2930 | rev_kl: 0.7061 | stu_lens: 101.0000 | mixed_lens: 74.0000 | lr: 3.7505e-06 | scale: 1024.00 | time: 26.601 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1739/  5000| tot_loss: 2.5547 | rl_loss: 1.0246 | pt_loss: 1.5301 | pg_loss: 0.0938 | reg_loss: 0.9308 | reward: -0.1594 | rev_kl: 1.1450 | stu_lens: 81.5000 | mixed_lens: 119.5000 | lr: 3.7491e-06 | scale: 1024.00 | time: 26.613 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1740/  5000| tot_loss: 2.8825 | rl_loss: 1.1843 | pt_loss: 1.6982 | pg_loss: 0.4395 | reg_loss: 0.7448 | reward: -0.4465 | rev_kl: 0.9609 | stu_lens: 77.0000 | mixed_lens: 75.5000 | lr: 3.7477e-06 | scale: 1024.00 | time: 26.623 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1741/  5000| tot_loss: 3.0281 | rl_loss: 1.3146 | pt_loss: 1.7135 | pg_loss: 0.3139 | reg_loss: 1.0007 | reward: -0.3292 | rev_kl: 0.8215 | stu_lens: 128.0000 | mixed_lens: 85.0000 | lr: 3.7463e-06 | scale: 1024.00 | time: 26.600 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1742/  5000| tot_loss: 3.2363 | rl_loss: 1.4926 | pt_loss: 1.7437 | pg_loss: 0.4014 | reg_loss: 1.0912 | reward: 0.0588 | rev_kl: 1.1236 | stu_lens: 128.0000 | mixed_lens: 74.5000 | lr: 3.7449e-06 | scale: 1024.00 | time: 26.626 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1743/  5000| tot_loss: 3.1633 | rl_loss: 1.2432 | pt_loss: 1.9202 | pg_loss: 0.4148 | reg_loss: 0.8284 | reward: -0.2599 | rev_kl: 0.4792 | stu_lens: 75.5000 | mixed_lens: 75.5000 | lr: 3.7435e-06 | scale: 1024.00 | time: 26.595 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1744/  5000| tot_loss: 2.4980 | rl_loss: 0.7206 | pt_loss: 1.7774 | pg_loss: 0.0198 | reg_loss: 0.7008 | reward: -0.1993 | rev_kl: 0.5389 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7421e-06 | scale: 1024.00 | time: 26.640 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1744/  5000| tot_loss: 2.8292 | rl_loss: 1.0941 | pt_loss: 1.7351 | pg_loss: 0.2210 | reg_loss: 0.8731 | reward: -0.2223 | rev_kl: 0.8461 | stu_lens: 104.8125 | mixed_lens: 100.1094 | lr: 3.7421e-06 | scale: 1024.00 | time: 26.640 | step time: 27.905
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1745/  5000| tot_loss: 2.5817 | rl_loss: 0.6360 | pt_loss: 1.9457 | pg_loss: 0.3377 | reg_loss: 0.2984 | reward: -0.1728 | rev_kl: 0.3644 | stu_lens: 77.5000 | mixed_lens: 76.0000 | lr: 3.7407e-06 | scale: 1024.00 | time: 26.584 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1746/  5000| tot_loss: 2.7620 | rl_loss: 0.9052 | pt_loss: 1.8568 | pg_loss: 0.2851 | reg_loss: 0.6202 | reward: -0.3055 | rev_kl: 0.9762 | stu_lens: 128.0000 | mixed_lens: 84.5000 | lr: 3.7393e-06 | scale: 1024.00 | time: 26.651 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1747/  5000| tot_loss: 2.5422 | rl_loss: 1.2086 | pt_loss: 1.3336 | pg_loss: 0.6238 | reg_loss: 0.5849 | reward: -0.2006 | rev_kl: 0.9241 | stu_lens: 96.5000 | mixed_lens: 72.5000 | lr: 3.7380e-06 | scale: 1024.00 | time: 26.625 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1748/  5000| tot_loss: 1.3967 | rl_loss: 0.3913 | pt_loss: 1.0054 | pg_loss: -0.0234 | reg_loss: 0.4147 | reward: -0.1407 | rev_kl: 0.5068 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7366e-06 | scale: 1024.00 | time: 26.650 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1749/  5000| tot_loss: 1.9918 | rl_loss: 0.3290 | pt_loss: 1.6628 | pg_loss: -0.0634 | reg_loss: 0.3924 | reward: -0.3801 | rev_kl: 0.8533 | stu_lens: 60.0000 | mixed_lens: 36.0000 | lr: 3.7352e-06 | scale: 1024.00 | time: 26.629 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/1750
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1750/  5000| tot_loss: 2.6514 | rl_loss: 0.7505 | pt_loss: 1.9009 | pg_loss: 0.0047 | reg_loss: 0.7458 | reward: -0.1417 | rev_kl: 0.8372 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7338e-06 | scale: 1024.00 | time: 26.662 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1751/  5000| tot_loss: 2.4702 | rl_loss: 0.9561 | pt_loss: 1.5141 | pg_loss: 0.3419 | reg_loss: 0.6142 | reward: 0.0221 | rev_kl: 0.6928 | stu_lens: 128.0000 | mixed_lens: 84.5000 | lr: 3.7324e-06 | scale: 1024.00 | time: 26.608 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1752/  5000| tot_loss: 2.0366 | rl_loss: 0.4762 | pt_loss: 1.5604 | pg_loss: 0.0191 | reg_loss: 0.4571 | reward: -0.1875 | rev_kl: 0.6226 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7310e-06 | scale: 1024.00 | time: 26.647 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1753/  5000| tot_loss: 2.6035 | rl_loss: 0.7144 | pt_loss: 1.8891 | pg_loss: 0.1631 | reg_loss: 0.5514 | reward: -0.2516 | rev_kl: 0.7071 | stu_lens: 128.0000 | mixed_lens: 83.0000 | lr: 3.7296e-06 | scale: 1024.00 | time: 26.621 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1754/  5000| tot_loss: 2.1921 | rl_loss: 0.4642 | pt_loss: 1.7279 | pg_loss: -0.0017 | reg_loss: 0.4658 | reward: -0.0415 | rev_kl: 0.5062 | stu_lens: 80.0000 | mixed_lens: 128.0000 | lr: 3.7282e-06 | scale: 1024.00 | time: 26.652 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1755/  5000| tot_loss: 1.9952 | rl_loss: 0.4446 | pt_loss: 1.5507 | pg_loss: 0.0740 | reg_loss: 0.3706 | reward: 0.0388 | rev_kl: 0.9931 | stu_lens: 128.0000 | mixed_lens: 89.0000 | lr: 3.7268e-06 | scale: 1024.00 | time: 26.608 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1756/  5000| tot_loss: 2.5270 | rl_loss: 0.9321 | pt_loss: 1.5948 | pg_loss: 0.3158 | reg_loss: 0.6164 | reward: -0.2869 | rev_kl: 0.6741 | stu_lens: 75.5000 | mixed_lens: 85.5000 | lr: 3.7254e-06 | scale: 1024.00 | time: 26.647 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1757/  5000| tot_loss: 3.2696 | rl_loss: 1.8522 | pt_loss: 1.4174 | pg_loss: 0.9374 | reg_loss: 0.9148 | reward: -0.1786 | rev_kl: 0.8731 | stu_lens: 94.0000 | mixed_lens: 40.0000 | lr: 3.7240e-06 | scale: 1024.00 | time: 26.617 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1758/  5000| tot_loss: 2.4703 | rl_loss: 0.7719 | pt_loss: 1.6984 | pg_loss: 0.1827 | reg_loss: 0.5893 | reward: -0.1911 | rev_kl: 0.8799 | stu_lens: 101.0000 | mixed_lens: 94.0000 | lr: 3.7226e-06 | scale: 1024.00 | time: 26.651 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1759/  5000| tot_loss: 2.8146 | rl_loss: 1.0591 | pt_loss: 1.7555 | pg_loss: 0.4087 | reg_loss: 0.6504 | reward: -0.2058 | rev_kl: 0.6293 | stu_lens: 74.5000 | mixed_lens: 62.5000 | lr: 3.7212e-06 | scale: 1024.00 | time: 26.584 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1760/  5000| tot_loss: 2.8481 | rl_loss: 1.0223 | pt_loss: 1.8257 | pg_loss: 0.2391 | reg_loss: 0.7832 | reward: -0.4720 | rev_kl: 0.7516 | stu_lens: 128.0000 | mixed_lens: 71.5000 | lr: 3.7198e-06 | scale: 1024.00 | time: 26.639 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1760/  5000| tot_loss: 2.4549 | rl_loss: 0.7674 | pt_loss: 1.6875 | pg_loss: 0.1842 | reg_loss: 0.5831 | reward: -0.2083 | rev_kl: 0.8034 | stu_lens: 102.5781 | mixed_lens: 97.2188 | lr: 3.7198e-06 | scale: 1024.00 | time: 26.639 | step time: 27.912
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1761/  5000| tot_loss: 2.3175 | rl_loss: 0.7825 | pt_loss: 1.5350 | pg_loss: 0.0564 | reg_loss: 0.7261 | reward: -0.0998 | rev_kl: 1.1460 | stu_lens: 81.5000 | mixed_lens: 119.5000 | lr: 3.7184e-06 | scale: 1024.00 | time: 26.620 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1762/  5000| tot_loss: 2.8579 | rl_loss: 0.6011 | pt_loss: 2.2567 | pg_loss: 0.0637 | reg_loss: 0.5374 | reward: -0.2527 | rev_kl: 0.8390 | stu_lens: 128.0000 | mixed_lens: 116.0000 | lr: 3.7170e-06 | scale: 1024.00 | time: 26.650 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1763/  5000| tot_loss: 2.3259 | rl_loss: 0.7382 | pt_loss: 1.5877 | pg_loss: 0.2149 | reg_loss: 0.5233 | reward: -0.1103 | rev_kl: 0.9134 | stu_lens: 112.5000 | mixed_lens: 93.5000 | lr: 3.7156e-06 | scale: 1024.00 | time: 26.629 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1764/  5000| tot_loss: 2.2915 | rl_loss: 0.5496 | pt_loss: 1.7420 | pg_loss: 0.0607 | reg_loss: 0.4889 | reward: -0.2285 | rev_kl: 1.3124 | stu_lens: 88.0000 | mixed_lens: 128.0000 | lr: 3.7142e-06 | scale: 1024.00 | time: 26.642 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1765/  5000| tot_loss: 1.9399 | rl_loss: 0.3578 | pt_loss: 1.5821 | pg_loss: -0.0034 | reg_loss: 0.3612 | reward: -0.1834 | rev_kl: 0.8772 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7128e-06 | scale: 1024.00 | time: 26.623 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1766/  5000| tot_loss: 1.5481 | rl_loss: 0.6317 | pt_loss: 0.9164 | pg_loss: 0.1721 | reg_loss: 0.4595 | reward: -0.2630 | rev_kl: 0.9373 | stu_lens: 128.0000 | mixed_lens: 99.5000 | lr: 3.7114e-06 | scale: 1024.00 | time: 26.657 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1767/  5000| tot_loss: 2.6545 | rl_loss: 0.5978 | pt_loss: 2.0567 | pg_loss: 0.1111 | reg_loss: 0.4867 | reward: -0.3498 | rev_kl: 1.4390 | stu_lens: 128.0000 | mixed_lens: 91.5000 | lr: 3.7100e-06 | scale: 1024.00 | time: 26.614 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1768/  5000| tot_loss: 2.6000 | rl_loss: 0.6812 | pt_loss: 1.9188 | pg_loss: 0.2340 | reg_loss: 0.4472 | reward: -0.2735 | rev_kl: 0.9650 | stu_lens: 128.0000 | mixed_lens: 97.0000 | lr: 3.7086e-06 | scale: 1024.00 | time: 26.698 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1769/  5000| tot_loss: 2.5172 | rl_loss: 0.4779 | pt_loss: 2.0394 | pg_loss: 0.1862 | reg_loss: 0.2916 | reward: -0.3985 | rev_kl: 0.5048 | stu_lens: 74.0000 | mixed_lens: 93.5000 | lr: 3.7072e-06 | scale: 1024.00 | time: 26.622 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1770/  5000| tot_loss: 2.3706 | rl_loss: 1.0598 | pt_loss: 1.3108 | pg_loss: 0.3929 | reg_loss: 0.6669 | reward: -0.0161 | rev_kl: 0.9404 | stu_lens: 128.0000 | mixed_lens: 30.5000 | lr: 3.7058e-06 | scale: 1024.00 | time: 26.704 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1771/  5000| tot_loss: 2.3761 | rl_loss: 0.6644 | pt_loss: 1.7117 | pg_loss: 0.1901 | reg_loss: 0.4743 | reward: -0.4450 | rev_kl: 0.8197 | stu_lens: 128.0000 | mixed_lens: 93.5000 | lr: 3.7044e-06 | scale: 1024.00 | time: 26.608 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1772/  5000| tot_loss: 2.4829 | rl_loss: 0.6072 | pt_loss: 1.8757 | pg_loss: 0.0922 | reg_loss: 0.5149 | reward: -0.0962 | rev_kl: 0.7277 | stu_lens: 125.0000 | mixed_lens: 114.5000 | lr: 3.7030e-06 | scale: 1024.00 | time: 26.654 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1773/  5000| tot_loss: 1.7794 | rl_loss: 0.2583 | pt_loss: 1.5211 | pg_loss: -0.0192 | reg_loss: 0.2775 | reward: -0.0899 | rev_kl: 0.7765 | stu_lens: 80.0000 | mixed_lens: 128.0000 | lr: 3.7016e-06 | scale: 1024.00 | time: 26.627 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1774/  5000| tot_loss: 2.3748 | rl_loss: 0.3251 | pt_loss: 2.0497 | pg_loss: -0.0035 | reg_loss: 0.3286 | reward: -0.1717 | rev_kl: 0.7179 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7002e-06 | scale: 1024.00 | time: 26.661 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1775/  5000| tot_loss: 2.1640 | rl_loss: 0.5695 | pt_loss: 1.5945 | pg_loss: 0.0043 | reg_loss: 0.5652 | reward: -0.2538 | rev_kl: 0.8859 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6988e-06 | scale: 1024.00 | time: 26.615 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1776/  5000| tot_loss: 2.0477 | rl_loss: 0.3909 | pt_loss: 1.6568 | pg_loss: -0.0047 | reg_loss: 0.3956 | reward: -0.1537 | rev_kl: 1.1055 | stu_lens: 109.5000 | mixed_lens: 128.0000 | lr: 3.6974e-06 | scale: 1024.00 | time: 26.653 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1776/  5000| tot_loss: 2.3503 | rl_loss: 0.5933 | pt_loss: 1.7570 | pg_loss: 0.1389 | reg_loss: 0.4544 | reward: -0.2129 | rev_kl: 0.8314 | stu_lens: 102.7969 | mixed_lens: 98.4844 | lr: 3.6974e-06 | scale: 1024.00 | time: 26.653 | step time: 27.922
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1777/  5000| tot_loss: 2.1088 | rl_loss: 0.5339 | pt_loss: 1.5749 | pg_loss: 0.0096 | reg_loss: 0.5243 | reward: -0.1382 | rev_kl: 0.8995 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6959e-06 | scale: 1024.00 | time: 26.619 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1778/  5000| tot_loss: 2.0864 | rl_loss: 0.4055 | pt_loss: 1.6809 | pg_loss: 0.1870 | reg_loss: 0.2185 | reward: -0.4554 | rev_kl: 0.7100 | stu_lens: 94.0000 | mixed_lens: 72.5000 | lr: 3.6945e-06 | scale: 1024.00 | time: 26.648 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1779/  5000| tot_loss: 2.6985 | rl_loss: 0.6141 | pt_loss: 2.0844 | pg_loss: 0.3326 | reg_loss: 0.2815 | reward: -0.1378 | rev_kl: 0.8357 | stu_lens: 112.5000 | mixed_lens: 93.5000 | lr: 3.6931e-06 | scale: 1024.00 | time: 26.618 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1780/  5000| tot_loss: 2.3388 | rl_loss: 0.6636 | pt_loss: 1.6752 | pg_loss: 0.2679 | reg_loss: 0.3956 | reward: -0.2450 | rev_kl: 0.3067 | stu_lens: 27.5000 | mixed_lens: 75.5000 | lr: 3.6917e-06 | scale: 1024.00 | time: 26.615 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1781/  5000| tot_loss: 2.2940 | rl_loss: 0.6736 | pt_loss: 1.6204 | pg_loss: 0.2953 | reg_loss: 0.3783 | reward: -0.2701 | rev_kl: 1.0273 | stu_lens: 128.0000 | mixed_lens: 97.0000 | lr: 3.6903e-06 | scale: 1024.00 | time: 26.667 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1782/  5000| tot_loss: 2.4112 | rl_loss: 0.3865 | pt_loss: 2.0247 | pg_loss: 0.0493 | reg_loss: 0.3372 | reward: -0.2416 | rev_kl: 0.9584 | stu_lens: 32.0000 | mixed_lens: 119.5000 | lr: 3.6889e-06 | scale: 1024.00 | time: 26.659 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1783/  5000| tot_loss: 2.7795 | rl_loss: 0.7567 | pt_loss: 2.0228 | pg_loss: 0.3304 | reg_loss: 0.4263 | reward: -0.4551 | rev_kl: 0.6346 | stu_lens: 94.0000 | mixed_lens: 83.5000 | lr: 3.6875e-06 | scale: 1024.00 | time: 26.635 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1784/  5000| tot_loss: 2.3691 | rl_loss: 0.5571 | pt_loss: 1.8120 | pg_loss: 0.3082 | reg_loss: 0.2489 | reward: 0.0808 | rev_kl: 0.6608 | stu_lens: 128.0000 | mixed_lens: 84.5000 | lr: 3.6861e-06 | scale: 1024.00 | time: 26.656 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1785/  5000| tot_loss: 2.4821 | rl_loss: 0.7357 | pt_loss: 1.7464 | pg_loss: 0.2347 | reg_loss: 0.5010 | reward: -0.0724 | rev_kl: 0.4009 | stu_lens: 43.5000 | mixed_lens: 86.5000 | lr: 3.6847e-06 | scale: 1024.00 | time: 26.634 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1786/  5000| tot_loss: 2.5337 | rl_loss: 0.6200 | pt_loss: 1.9138 | pg_loss: 0.2103 | reg_loss: 0.4096 | reward: -0.3773 | rev_kl: 0.7981 | stu_lens: 114.0000 | mixed_lens: 85.0000 | lr: 3.6833e-06 | scale: 1024.00 | time: 26.663 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1787/  5000| tot_loss: 1.9102 | rl_loss: 0.3590 | pt_loss: 1.5512 | pg_loss: 0.0021 | reg_loss: 0.3569 | reward: -0.1659 | rev_kl: 1.1258 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6818e-06 | scale: 1024.00 | time: 26.632 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1788/  5000| tot_loss: 2.6677 | rl_loss: 0.4128 | pt_loss: 2.2549 | pg_loss: 0.0189 | reg_loss: 0.3939 | reward: -0.1809 | rev_kl: 0.9206 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6804e-06 | scale: 1024.00 | time: 26.657 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1789/  5000| tot_loss: 2.3389 | rl_loss: 0.5413 | pt_loss: 1.7976 | pg_loss: 0.2375 | reg_loss: 0.3038 | reward: -0.2537 | rev_kl: 0.7522 | stu_lens: 128.0000 | mixed_lens: 84.0000 | lr: 3.6790e-06 | scale: 1024.00 | time: 26.634 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1790/  5000| tot_loss: 2.4145 | rl_loss: 0.3807 | pt_loss: 2.0338 | pg_loss: 0.0372 | reg_loss: 0.3436 | reward: 0.0156 | rev_kl: 1.5605 | stu_lens: 128.0000 | mixed_lens: 89.0000 | lr: 3.6776e-06 | scale: 1024.00 | time: 26.655 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1791/  5000| tot_loss: 2.0682 | rl_loss: 0.2727 | pt_loss: 1.7954 | pg_loss: -0.0144 | reg_loss: 0.2871 | reward: -0.1700 | rev_kl: 0.8282 | stu_lens: 76.0000 | mixed_lens: 128.0000 | lr: 3.6762e-06 | scale: 1024.00 | time: 26.635 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1792/  5000| tot_loss: 1.9322 | rl_loss: 0.1974 | pt_loss: 1.7347 | pg_loss: -0.0055 | reg_loss: 0.2029 | reward: -0.2092 | rev_kl: 0.6087 | stu_lens: 108.0000 | mixed_lens: 128.0000 | lr: 3.6748e-06 | scale: 1024.00 | time: 26.700 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1792/  5000| tot_loss: 2.2961 | rl_loss: 0.4959 | pt_loss: 1.8002 | pg_loss: 0.1357 | reg_loss: 0.3602 | reward: -0.2175 | rev_kl: 0.8160 | stu_lens: 103.8750 | mixed_lens: 98.6250 | lr: 3.6748e-06 | scale: 1024.00 | time: 26.700 | step time: 27.925
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1793/  5000| tot_loss: 1.8335 | rl_loss: 0.4613 | pt_loss: 1.3722 | pg_loss: 0.0008 | reg_loss: 0.4605 | reward: -0.1310 | rev_kl: 0.6692 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6734e-06 | scale: 1024.00 | time: 26.637 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1794/  5000| tot_loss: 2.9018 | rl_loss: 0.8981 | pt_loss: 2.0037 | pg_loss: 0.3030 | reg_loss: 0.5951 | reward: -0.2270 | rev_kl: 0.5342 | stu_lens: 91.0000 | mixed_lens: 98.0000 | lr: 3.6719e-06 | scale: 1024.00 | time: 26.651 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1795/  5000| tot_loss: 3.1486 | rl_loss: 1.0006 | pt_loss: 2.1480 | pg_loss: 0.0395 | reg_loss: 0.9611 | reward: -0.1533 | rev_kl: 0.9698 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6705e-06 | scale: 1024.00 | time: 26.649 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1796/  5000| tot_loss: 2.9292 | rl_loss: 0.7903 | pt_loss: 2.1388 | pg_loss: 0.0715 | reg_loss: 0.7189 | reward: -0.0094 | rev_kl: 0.8087 | stu_lens: 128.0000 | mixed_lens: 119.0000 | lr: 3.6691e-06 | scale: 1024.00 | time: 26.597 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1797/  5000| tot_loss: 2.7381 | rl_loss: 1.1957 | pt_loss: 1.5423 | pg_loss: 0.1934 | reg_loss: 1.0023 | reward: -0.1856 | rev_kl: 0.8558 | stu_lens: 128.0000 | mixed_lens: 109.5000 | lr: 3.6677e-06 | scale: 1024.00 | time: 26.617 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1798/  5000| tot_loss: 2.7621 | rl_loss: 1.0889 | pt_loss: 1.6732 | pg_loss: 0.1095 | reg_loss: 0.9793 | reward: -0.0112 | rev_kl: 0.7446 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6663e-06 | scale: 1024.00 | time: 26.596 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1799/  5000| tot_loss: 2.7014 | rl_loss: 1.0612 | pt_loss: 1.6403 | pg_loss: 0.0788 | reg_loss: 0.9824 | reward: -0.0577 | rev_kl: 0.7893 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6649e-06 | scale: 1024.00 | time: 26.620 | step time: 0.000
                                 Evaluation #18                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los diferentes tipos de cuarks son:  │
│                                       │                                      │
│                                       │ - Cuark up                           │
│                                       │ - Cuark down                         │
│                                       │ - Cuark strange                      │
│                                       │ - Cuark charm                        │
│                                       │ - Cuark beauty                       │
│                                       │ - Cuark top                          │
│                                       │ - Cuark bottom                       │
│                                       │ - Cuark anti-down                    │
│                                       │ - Cuark anti-strange                 │
│                                       │ - Cuark anti-charm                   │
│                                       │ - Cuark anti-beauty                  │
│                                       │ - Cuark anti-top                     │
│                                       │ - Cuark anti-bottom                  │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ IMC es un acrónimo de Interactivo    │
│                                       │ Multimedia Contenido, un método para │
│                                       │ compartir contenido entre diferentes │
│                                       │ plataformas que involucran la        │
│                                       │ interacción de los usuarios. Los     │
│                                       │ contenidos interactivos pueden ser   │
│                                       │ videos, imágenes, texto, audio o     │
│                                       │ otra forma de contenido multimedia.  │
│                                       │                                      │
│                                       │ IMC se utiliza comúnmente para       │
│                                       │ publicar contenido multimedia de     │
│                                       │ forma interactiva en internet. Los   │
│                                       │ contenidos interactivos pueden ser   │
│                                       │ desplazados de una plataforma a otra │
│                                       │ en forma de juego o aplicación.      │
│                                       │                                      │
│                                       │ La utilidad del IMC se               │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ 1. Cápsula del tiempo de Nápoles,    │
│                                       │ 1624                                 │
│                                       │ 2. Cápsula del tiempo de Augusta,    │
│                                       │ 1792                                 │
│                                       │ 3. Cápsula del tiempo de Boston,     │
│                                       │ 1846                                 │
│                                       │ 4. Cápsula del tiempo de Burlington, │
│                                       │ 1859                                 │
│                                       │ 5. Cápsula del tiempo de Cleveland,  │
│                                       │ 1892                                 │
│                                       │ 6. Cápsula del tiempo de Lyon, 1907  │
│                                       │ 7. Cápsula del tiempo de Londres,    │
│                                       │ 1920                                 │
│                                       │ 8. C                                 │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.829 | exact_match: 0.000 | rev_kl: 0.873 | lens: 104.686 | pt_loss: 1.740 | lm_loss: 1.867 | kd_loss: 1.612 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1800/  5000| tot_loss: 2.6027 | rl_loss: 1.1601 | pt_loss: 1.4425 | pg_loss: 0.3833 | reg_loss: 0.7769 | reward: 0.0564 | rev_kl: 0.2214 | stu_lens: 20.5000 | mixed_lens: 68.5000 | lr: 3.6634e-06 | scale: 1024.00 | time: 26.592 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1801/  5000| tot_loss: 3.6516 | rl_loss: 1.6574 | pt_loss: 1.9941 | pg_loss: 0.4850 | reg_loss: 1.1724 | reward: -0.6503 | rev_kl: 0.7808 | stu_lens: 92.0000 | mixed_lens: 88.5000 | lr: 3.6620e-06 | scale: 1024.00 | time: 26.707 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1802/  5000| tot_loss: 2.6227 | rl_loss: 1.0464 | pt_loss: 1.5763 | pg_loss: 0.0651 | reg_loss: 0.9813 | reward: -0.2298 | rev_kl: 0.5899 | stu_lens: 124.0000 | mixed_lens: 128.0000 | lr: 3.6606e-06 | scale: 1024.00 | time: 26.641 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1803/  5000| tot_loss: 2.4838 | rl_loss: 0.9336 | pt_loss: 1.5501 | pg_loss: 0.0515 | reg_loss: 0.8821 | reward: -0.1429 | rev_kl: 0.7257 | stu_lens: 94.0000 | mixed_lens: 128.0000 | lr: 3.6592e-06 | scale: 1024.00 | time: 26.672 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1804/  5000| tot_loss: 3.0241 | rl_loss: 1.4224 | pt_loss: 1.6017 | pg_loss: 0.4767 | reg_loss: 0.9457 | reward: -0.8246 | rev_kl: 1.2392 | stu_lens: 72.0000 | mixed_lens: 70.0000 | lr: 3.6578e-06 | scale: 1024.00 | time: 26.638 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1805/  5000| tot_loss: 3.2578 | rl_loss: 1.0608 | pt_loss: 2.1970 | pg_loss: 0.0907 | reg_loss: 0.9701 | reward: -0.0583 | rev_kl: 0.7951 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6563e-06 | scale: 1024.00 | time: 26.660 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1806/  5000| tot_loss: 2.8539 | rl_loss: 0.9204 | pt_loss: 1.9335 | pg_loss: 0.1621 | reg_loss: 0.7583 | reward: -0.5283 | rev_kl: 0.7425 | stu_lens: 96.0000 | mixed_lens: 76.5000 | lr: 3.6549e-06 | scale: 1024.00 | time: 26.645 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1807/  5000| tot_loss: 3.1934 | rl_loss: 1.5189 | pt_loss: 1.6745 | pg_loss: 0.3940 | reg_loss: 1.1248 | reward: -0.1367 | rev_kl: 0.4393 | stu_lens: 74.5000 | mixed_lens: 74.5000 | lr: 3.6535e-06 | scale: 1024.00 | time: 26.671 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1808/  5000| tot_loss: 2.3953 | rl_loss: 1.1735 | pt_loss: 1.2218 | pg_loss: 0.0979 | reg_loss: 1.0756 | reward: -0.0074 | rev_kl: 1.3088 | stu_lens: 111.5000 | mixed_lens: 128.0000 | lr: 3.6521e-06 | scale: 1024.00 | time: 26.644 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1808/  5000| tot_loss: 2.7857 | rl_loss: 1.0604 | pt_loss: 1.7253 | pg_loss: 0.1833 | reg_loss: 0.8771 | reward: -0.1980 | rev_kl: 0.7819 | stu_lens: 108.5938 | mixed_lens: 105.5000 | lr: 3.6521e-06 | scale: 1024.00 | time: 26.644 | step time: 27.936
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1809/  5000| tot_loss: 2.5394 | rl_loss: 1.0329 | pt_loss: 1.5065 | pg_loss: 0.0511 | reg_loss: 0.9819 | reward: -0.2066 | rev_kl: 7.2059 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6507e-06 | scale: 1024.00 | time: 26.662 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1810/  5000| tot_loss: 1.8653 | rl_loss: 0.5422 | pt_loss: 1.3232 | pg_loss: -0.0094 | reg_loss: 0.5516 | reward: -0.1039 | rev_kl: 0.7771 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6492e-06 | scale: 1024.00 | time: 26.645 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1811/  5000| tot_loss: 2.2949 | rl_loss: 0.7547 | pt_loss: 1.5402 | pg_loss: 0.1610 | reg_loss: 0.5937 | reward: -0.0906 | rev_kl: 0.8785 | stu_lens: 104.0000 | mixed_lens: 91.5000 | lr: 3.6478e-06 | scale: 1024.00 | time: 26.675 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1812/  5000| tot_loss: 3.7939 | rl_loss: 1.8805 | pt_loss: 1.9134 | pg_loss: 1.4270 | reg_loss: 0.4535 | reward: -0.7768 | rev_kl: 0.6654 | stu_lens: 18.5000 | mixed_lens: 16.5000 | lr: 3.6464e-06 | scale: 1024.00 | time: 26.644 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1813/  5000| tot_loss: 2.5610 | rl_loss: 0.8062 | pt_loss: 1.7548 | pg_loss: 0.2080 | reg_loss: 0.5982 | reward: 0.0170 | rev_kl: 0.6712 | stu_lens: 110.0000 | mixed_lens: 101.5000 | lr: 3.6450e-06 | scale: 1024.00 | time: 26.660 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1814/  5000| tot_loss: 2.4106 | rl_loss: 0.4519 | pt_loss: 1.9588 | pg_loss: 0.0070 | reg_loss: 0.4449 | reward: 0.0734 | rev_kl: 0.7714 | stu_lens: 128.0000 | mixed_lens: 119.0000 | lr: 3.6435e-06 | scale: 1024.00 | time: 26.647 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1815/  5000| tot_loss: 2.7522 | rl_loss: 0.9170 | pt_loss: 1.8351 | pg_loss: 0.3685 | reg_loss: 0.5485 | reward: 0.0153 | rev_kl: 0.6872 | stu_lens: 65.5000 | mixed_lens: 68.5000 | lr: 3.6421e-06 | scale: 1024.00 | time: 26.659 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1816/  5000| tot_loss: 1.9401 | rl_loss: 0.6154 | pt_loss: 1.3247 | pg_loss: -0.0203 | reg_loss: 0.6357 | reward: -0.1646 | rev_kl: 0.8504 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6407e-06 | scale: 1024.00 | time: 26.667 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1817/  5000| tot_loss: 2.5160 | rl_loss: 0.7666 | pt_loss: 1.7494 | pg_loss: 0.0185 | reg_loss: 0.7481 | reward: -0.1775 | rev_kl: 0.8327 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6393e-06 | scale: 1024.00 | time: 26.645 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1818/  5000| tot_loss: 2.3824 | rl_loss: 0.6348 | pt_loss: 1.7476 | pg_loss: -0.0010 | reg_loss: 0.6358 | reward: -0.1411 | rev_kl: 0.8324 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6378e-06 | scale: 1024.00 | time: 26.638 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1819/  5000| tot_loss: 2.2840 | rl_loss: 0.6578 | pt_loss: 1.6262 | pg_loss: 0.1788 | reg_loss: 0.4791 | reward: -0.2045 | rev_kl: 0.7461 | stu_lens: 91.0000 | mixed_lens: 96.0000 | lr: 3.6364e-06 | scale: 1024.00 | time: 26.678 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1820/  5000| tot_loss: 2.8726 | rl_loss: 0.7288 | pt_loss: 2.1439 | pg_loss: 0.0052 | reg_loss: 0.7236 | reward: -0.1288 | rev_kl: 1.9654 | stu_lens: 111.5000 | mixed_lens: 128.0000 | lr: 3.6350e-06 | scale: 1024.00 | time: 26.646 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1821/  5000| tot_loss: 2.4434 | rl_loss: 0.6122 | pt_loss: 1.8312 | pg_loss: 0.0355 | reg_loss: 0.5767 | reward: 0.0214 | rev_kl: 0.8917 | stu_lens: 128.0000 | mixed_lens: 125.5000 | lr: 3.6335e-06 | scale: 1024.00 | time: 26.667 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1822/  5000| tot_loss: 2.9318 | rl_loss: 0.9956 | pt_loss: 1.9362 | pg_loss: 0.3283 | reg_loss: 0.6673 | reward: -0.1195 | rev_kl: 0.7665 | stu_lens: 75.0000 | mixed_lens: 71.5000 | lr: 3.6321e-06 | scale: 1024.00 | time: 26.643 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1823/  5000| tot_loss: 2.3002 | rl_loss: 0.5119 | pt_loss: 1.7884 | pg_loss: -0.0119 | reg_loss: 0.5237 | reward: -0.1423 | rev_kl: 0.9166 | stu_lens: 83.0000 | mixed_lens: 128.0000 | lr: 3.6307e-06 | scale: 1024.00 | time: 26.629 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1824/  5000| tot_loss: 2.2252 | rl_loss: 0.6466 | pt_loss: 1.5787 | pg_loss: -0.0093 | reg_loss: 0.6559 | reward: -0.2288 | rev_kl: 0.5851 | stu_lens: 124.0000 | mixed_lens: 128.0000 | lr: 3.6293e-06 | scale: 1024.00 | time: 26.639 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1824/  5000| tot_loss: 2.4256 | rl_loss: 0.7518 | pt_loss: 1.6737 | pg_loss: 0.1435 | reg_loss: 0.6084 | reward: -0.1789 | rev_kl: 1.1704 | stu_lens: 108.9688 | mixed_lens: 105.9531 | lr: 3.6293e-06 | scale: 1024.00 | time: 26.639 | step time: 27.938
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1825/  5000| tot_loss: 2.3769 | rl_loss: 0.6367 | pt_loss: 1.7402 | pg_loss: 0.0361 | reg_loss: 0.6006 | reward: -0.1541 | rev_kl: 0.7524 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 3.6278e-06 | scale: 1024.00 | time: 26.687 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1826/  5000| tot_loss: 1.7932 | rl_loss: 0.4648 | pt_loss: 1.3284 | pg_loss: 0.0901 | reg_loss: 0.3747 | reward: -0.1783 | rev_kl: 0.3792 | stu_lens: 128.0000 | mixed_lens: 103.5000 | lr: 3.6264e-06 | scale: 1024.00 | time: 26.608 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1827/  5000| tot_loss: 1.9824 | rl_loss: 0.3616 | pt_loss: 1.6207 | pg_loss: 0.0372 | reg_loss: 0.3245 | reward: -0.1854 | rev_kl: 0.6025 | stu_lens: 97.5000 | mixed_lens: 117.5000 | lr: 3.6250e-06 | scale: 1024.00 | time: 26.641 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1828/  5000| tot_loss: 2.6335 | rl_loss: 0.7392 | pt_loss: 1.8943 | pg_loss: 0.1280 | reg_loss: 0.6112 | reward: -0.0893 | rev_kl: 0.9911 | stu_lens: 128.0000 | mixed_lens: 109.5000 | lr: 3.6235e-06 | scale: 1024.00 | time: 26.633 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1829/  5000| tot_loss: 2.0639 | rl_loss: 0.3238 | pt_loss: 1.7401 | pg_loss: -0.0023 | reg_loss: 0.3261 | reward: -0.1588 | rev_kl: 1.6385 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6221e-06 | scale: 1024.00 | time: 26.665 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1830/  5000| tot_loss: 2.4982 | rl_loss: 0.3931 | pt_loss: 2.1051 | pg_loss: -0.0220 | reg_loss: 0.4152 | reward: -0.2464 | rev_kl: 0.7223 | stu_lens: 124.0000 | mixed_lens: 128.0000 | lr: 3.6207e-06 | scale: 1024.00 | time: 26.625 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1831/  5000| tot_loss: 2.5856 | rl_loss: 0.6133 | pt_loss: 1.9723 | pg_loss: 0.3044 | reg_loss: 0.3089 | reward: -0.0523 | rev_kl: 0.5369 | stu_lens: 71.0000 | mixed_lens: 71.0000 | lr: 3.6192e-06 | scale: 1024.00 | time: 26.644 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1832/  5000| tot_loss: 2.2308 | rl_loss: 0.4625 | pt_loss: 1.7683 | pg_loss: -0.0048 | reg_loss: 0.4673 | reward: -0.1828 | rev_kl: 0.7236 | stu_lens: 94.0000 | mixed_lens: 128.0000 | lr: 3.6178e-06 | scale: 1024.00 | time: 26.630 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1833/  5000| tot_loss: 2.2009 | rl_loss: 0.4041 | pt_loss: 1.7968 | pg_loss: -0.0046 | reg_loss: 0.4086 | reward: -0.0937 | rev_kl: 0.7583 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6164e-06 | scale: 1024.00 | time: 26.678 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1834/  5000| tot_loss: 1.8071 | rl_loss: 0.3934 | pt_loss: 1.4138 | pg_loss: 0.0027 | reg_loss: 0.3907 | reward: -0.0975 | rev_kl: 0.8358 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6149e-06 | scale: 1024.00 | time: 26.618 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1835/  5000| tot_loss: 2.4535 | rl_loss: 0.5254 | pt_loss: 1.9281 | pg_loss: 0.0043 | reg_loss: 0.5210 | reward: -0.1721 | rev_kl: 0.8520 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6135e-06 | scale: 1024.00 | time: 26.673 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1836/  5000| tot_loss: 2.1974 | rl_loss: 0.4350 | pt_loss: 1.7624 | pg_loss: -0.0189 | reg_loss: 0.4539 | reward: -0.1321 | rev_kl: 0.7743 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6121e-06 | scale: 1024.00 | time: 26.618 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1837/  5000| tot_loss: 2.4345 | rl_loss: 0.5696 | pt_loss: 1.8650 | pg_loss: 0.1228 | reg_loss: 0.4468 | reward: -0.1235 | rev_kl: 0.7817 | stu_lens: 110.0000 | mixed_lens: 101.5000 | lr: 3.6106e-06 | scale: 1024.00 | time: 26.646 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1838/  5000| tot_loss: 2.2558 | rl_loss: 0.4709 | pt_loss: 1.7848 | pg_loss: -0.0203 | reg_loss: 0.4913 | reward: -0.2334 | rev_kl: 0.8259 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6092e-06 | scale: 1024.00 | time: 26.673 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1839/  5000| tot_loss: 2.1970 | rl_loss: 0.4264 | pt_loss: 1.7706 | pg_loss: 0.0738 | reg_loss: 0.3526 | reward: -0.1566 | rev_kl: 1.0855 | stu_lens: 117.0000 | mixed_lens: 120.0000 | lr: 3.6078e-06 | scale: 1024.00 | time: 26.683 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1840/  5000| tot_loss: 2.3459 | rl_loss: 0.6028 | pt_loss: 1.7431 | pg_loss: 0.1748 | reg_loss: 0.4280 | reward: -0.2609 | rev_kl: 0.6753 | stu_lens: 91.0000 | mixed_lens: 109.0000 | lr: 3.6063e-06 | scale: 1024.00 | time: 26.657 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1840/  5000| tot_loss: 2.2948 | rl_loss: 0.5638 | pt_loss: 1.7310 | pg_loss: 0.1281 | reg_loss: 0.4357 | reward: -0.2066 | rev_kl: 0.9756 | stu_lens: 108.2812 | mixed_lens: 105.1250 | lr: 3.6063e-06 | scale: 1024.00 | time: 26.657 | step time: 27.934
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1841/  5000| tot_loss: 1.9788 | rl_loss: 0.4624 | pt_loss: 1.5164 | pg_loss: -0.0113 | reg_loss: 0.4737 | reward: -0.1122 | rev_kl: 0.9650 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6049e-06 | scale: 1024.00 | time: 26.652 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1842/  5000| tot_loss: 2.2494 | rl_loss: 0.2626 | pt_loss: 1.9868 | pg_loss: -0.0072 | reg_loss: 0.2698 | reward: -0.0193 | rev_kl: 0.7111 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6034e-06 | scale: 1024.00 | time: 26.647 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1843/  5000| tot_loss: 2.5260 | rl_loss: 0.5542 | pt_loss: 1.9717 | pg_loss: 0.1351 | reg_loss: 0.4191 | reward: -0.1641 | rev_kl: 0.6326 | stu_lens: 128.0000 | mixed_lens: 95.0000 | lr: 3.6020e-06 | scale: 1024.00 | time: 26.687 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1844/  5000| tot_loss: 2.2032 | rl_loss: 0.3861 | pt_loss: 1.8171 | pg_loss: 0.0045 | reg_loss: 0.3816 | reward: -0.1254 | rev_kl: 0.6954 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.6006e-06 | scale: 1024.00 | time: 26.633 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1845/  5000| tot_loss: 2.3622 | rl_loss: 0.2696 | pt_loss: 2.0926 | pg_loss: 0.0805 | reg_loss: 0.1891 | reward: -0.3133 | rev_kl: 0.8478 | stu_lens: 128.0000 | mixed_lens: 92.5000 | lr: 3.5991e-06 | scale: 1024.00 | time: 26.673 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1846/  5000| tot_loss: 1.5340 | rl_loss: 0.2630 | pt_loss: 1.2709 | pg_loss: -0.0326 | reg_loss: 0.2956 | reward: -0.0026 | rev_kl: 0.9853 | stu_lens: 117.0000 | mixed_lens: 128.0000 | lr: 3.5977e-06 | scale: 1024.00 | time: 26.674 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1847/  5000| tot_loss: 2.0500 | rl_loss: 0.4379 | pt_loss: 1.6121 | pg_loss: -0.0088 | reg_loss: 0.4468 | reward: -0.2222 | rev_kl: 0.8798 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5962e-06 | scale: 1024.00 | time: 26.719 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1848/  5000| tot_loss: 3.0845 | rl_loss: 1.1557 | pt_loss: 1.9288 | pg_loss: 0.8231 | reg_loss: 0.3326 | reward: -0.4629 | rev_kl: 0.4428 | stu_lens: 29.5000 | mixed_lens: 37.0000 | lr: 3.5948e-06 | scale: 1024.00 | time: 26.699 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1849/  5000| tot_loss: 2.1239 | rl_loss: 0.3845 | pt_loss: 1.7395 | pg_loss: -0.0092 | reg_loss: 0.3937 | reward: -0.0697 | rev_kl: 0.7597 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5934e-06 | scale: 1024.00 | time: 26.675 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1850/  5000| tot_loss: 1.8604 | rl_loss: 0.2712 | pt_loss: 1.5892 | pg_loss: 0.0040 | reg_loss: 0.2672 | reward: -0.0486 | rev_kl: 0.7524 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5919e-06 | scale: 1024.00 | time: 26.645 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1851/  5000| tot_loss: 2.5388 | rl_loss: 0.8966 | pt_loss: 1.6422 | pg_loss: 0.5989 | reg_loss: 0.2978 | reward: -0.0657 | rev_kl: 0.3345 | stu_lens: 57.0000 | mixed_lens: 48.5000 | lr: 3.5905e-06 | scale: 1024.00 | time: 26.692 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1852/  5000| tot_loss: 2.2787 | rl_loss: 0.4921 | pt_loss: 1.7866 | pg_loss: 0.1386 | reg_loss: 0.3535 | reward: -0.1057 | rev_kl: 0.8610 | stu_lens: 128.0000 | mixed_lens: 89.0000 | lr: 3.5890e-06 | scale: 1024.00 | time: 26.646 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1853/  5000| tot_loss: 1.7675 | rl_loss: 0.3017 | pt_loss: 1.4658 | pg_loss: -0.0178 | reg_loss: 0.3195 | reward: -0.1359 | rev_kl: 0.8700 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5876e-06 | scale: 1024.00 | time: 26.671 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1854/  5000| tot_loss: 2.3675 | rl_loss: 0.5188 | pt_loss: 1.8486 | pg_loss: 0.1404 | reg_loss: 0.3785 | reward: -0.5205 | rev_kl: 0.8489 | stu_lens: 72.0000 | mixed_lens: 53.0000 | lr: 3.5862e-06 | scale: 1024.00 | time: 26.646 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1855/  5000| tot_loss: 1.9754 | rl_loss: 0.3792 | pt_loss: 1.5962 | pg_loss: 0.0063 | reg_loss: 0.3730 | reward: -0.2420 | rev_kl: 1.5398 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5847e-06 | scale: 1024.00 | time: 26.692 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1856/  5000| tot_loss: 3.1932 | rl_loss: 1.2007 | pt_loss: 1.9926 | pg_loss: 0.6600 | reg_loss: 0.5407 | reward: -0.8595 | rev_kl: 1.0710 | stu_lens: 72.0000 | mixed_lens: 51.5000 | lr: 3.5833e-06 | scale: 1024.00 | time: 26.651 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1856/  5000| tot_loss: 2.2050 | rl_loss: 0.4750 | pt_loss: 1.7300 | pg_loss: 0.1231 | reg_loss: 0.3519 | reward: -0.1933 | rev_kl: 0.9867 | stu_lens: 107.7812 | mixed_lens: 104.5312 | lr: 3.5833e-06 | scale: 1024.00 | time: 26.651 | step time: 27.955
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1857/  5000| tot_loss: 1.8864 | rl_loss: 0.2817 | pt_loss: 1.6047 | pg_loss: -0.0081 | reg_loss: 0.2898 | reward: -0.1891 | rev_kl: 0.8204 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5818e-06 | scale: 1024.00 | time: 26.673 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1858/  5000| tot_loss: 2.5897 | rl_loss: 1.0436 | pt_loss: 1.5460 | pg_loss: 0.2521 | reg_loss: 0.7915 | reward: -0.3354 | rev_kl: 0.3808 | stu_lens: 69.0000 | mixed_lens: 76.0000 | lr: 3.5804e-06 | scale: 1024.00 | time: 26.794 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1859/  5000| tot_loss: 2.7446 | rl_loss: 1.3618 | pt_loss: 1.3828 | pg_loss: 0.1546 | reg_loss: 1.2072 | reward: -0.1978 | rev_kl: 0.8662 | stu_lens: 115.5000 | mixed_lens: 102.5000 | lr: 3.5789e-06 | scale: 1024.00 | time: 26.764 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1860/  5000| tot_loss: 2.6617 | rl_loss: 1.0924 | pt_loss: 1.5693 | pg_loss: 0.0624 | reg_loss: 1.0299 | reward: -0.2313 | rev_kl: 1.0811 | stu_lens: 117.5000 | mixed_lens: 128.0000 | lr: 3.5775e-06 | scale: 1024.00 | time: 26.747 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1861/  5000| tot_loss: 2.5441 | rl_loss: 1.2716 | pt_loss: 1.2725 | pg_loss: 0.0638 | reg_loss: 1.2078 | reward: -0.3062 | rev_kl: 0.6518 | stu_lens: 87.5000 | mixed_lens: 128.0000 | lr: 3.5760e-06 | scale: 1024.00 | time: 26.735 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1862/  5000| tot_loss: 2.7291 | rl_loss: 1.0759 | pt_loss: 1.6532 | pg_loss: 0.1171 | reg_loss: 0.9587 | reward: -0.2393 | rev_kl: 0.5421 | stu_lens: 88.0000 | mixed_lens: 95.0000 | lr: 3.5746e-06 | scale: 1024.00 | time: 26.746 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1863/  5000| tot_loss: 2.7147 | rl_loss: 1.0161 | pt_loss: 1.6986 | pg_loss: 0.0376 | reg_loss: 0.9785 | reward: -0.1348 | rev_kl: 0.7981 | stu_lens: 116.5000 | mixed_lens: 128.0000 | lr: 3.5731e-06 | scale: 1024.00 | time: 26.732 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1864/  5000| tot_loss: 2.4708 | rl_loss: 0.9117 | pt_loss: 1.5591 | pg_loss: 0.4093 | reg_loss: 0.5024 | reward: -0.7498 | rev_kl: 0.6148 | stu_lens: 69.5000 | mixed_lens: 35.5000 | lr: 3.5717e-06 | scale: 1024.00 | time: 26.715 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1865/  5000| tot_loss: 2.5841 | rl_loss: 1.3348 | pt_loss: 1.2493 | pg_loss: 0.4856 | reg_loss: 0.8492 | reward: -0.4063 | rev_kl: 1.3225 | stu_lens: 69.5000 | mixed_lens: 71.5000 | lr: 3.5702e-06 | scale: 1024.00 | time: 26.724 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1866/  5000| tot_loss: 2.5544 | rl_loss: 1.3003 | pt_loss: 1.2542 | pg_loss: 0.2487 | reg_loss: 1.0515 | reward: -0.2535 | rev_kl: 0.9773 | stu_lens: 123.0000 | mixed_lens: 104.0000 | lr: 3.5688e-06 | scale: 1024.00 | time: 26.675 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1867/  5000| tot_loss: 2.9053 | rl_loss: 1.3380 | pt_loss: 1.5674 | pg_loss: 0.5386 | reg_loss: 0.7994 | reward: -0.3858 | rev_kl: 0.6049 | stu_lens: 72.0000 | mixed_lens: 72.0000 | lr: 3.5673e-06 | scale: 1024.00 | time: 26.754 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1868/  5000| tot_loss: 3.2345 | rl_loss: 1.6189 | pt_loss: 1.6156 | pg_loss: 0.4381 | reg_loss: 1.1808 | reward: -0.2046 | rev_kl: 1.0753 | stu_lens: 104.5000 | mixed_lens: 76.5000 | lr: 3.5659e-06 | scale: 1024.00 | time: 26.730 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1869/  5000| tot_loss: 3.4934 | rl_loss: 1.2536 | pt_loss: 2.2397 | pg_loss: 0.2768 | reg_loss: 0.9768 | reward: -0.2636 | rev_kl: 0.6685 | stu_lens: 127.5000 | mixed_lens: 104.5000 | lr: 3.5644e-06 | scale: 1024.00 | time: 26.744 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1870/  5000| tot_loss: 2.9775 | rl_loss: 1.4299 | pt_loss: 1.5476 | pg_loss: 0.2574 | reg_loss: 1.1726 | reward: 0.1560 | rev_kl: 0.7822 | stu_lens: 128.0000 | mixed_lens: 90.0000 | lr: 3.5630e-06 | scale: 1024.00 | time: 26.722 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1871/  5000| tot_loss: 2.7657 | rl_loss: 0.7977 | pt_loss: 1.9680 | pg_loss: 0.0409 | reg_loss: 0.7568 | reward: -0.1949 | rev_kl: 2.0910 | stu_lens: 106.0000 | mixed_lens: 128.0000 | lr: 3.5615e-06 | scale: 1024.00 | time: 26.748 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1872/  5000| tot_loss: 2.3284 | rl_loss: 0.9518 | pt_loss: 1.3766 | pg_loss: 0.1108 | reg_loss: 0.8411 | reward: -0.3134 | rev_kl: 0.8024 | stu_lens: 100.0000 | mixed_lens: 122.5000 | lr: 3.5601e-06 | scale: 1024.00 | time: 26.705 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1872/  5000| tot_loss: 2.7468 | rl_loss: 1.0997 | pt_loss: 1.6471 | pg_loss: 0.2117 | reg_loss: 0.8879 | reward: -0.2480 | rev_kl: 0.7925 | stu_lens: 103.7969 | mixed_lens: 102.4375 | lr: 3.5601e-06 | scale: 1024.00 | time: 26.705 | step time: 28.013
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1873/  5000| tot_loss: 3.1067 | rl_loss: 1.8208 | pt_loss: 1.2859 | pg_loss: 0.5538 | reg_loss: 1.2670 | reward: -0.2273 | rev_kl: 0.7048 | stu_lens: 34.5000 | mixed_lens: 47.0000 | lr: 3.5586e-06 | scale: 1024.00 | time: 26.724 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1874/  5000| tot_loss: 2.5258 | rl_loss: 0.8134 | pt_loss: 1.7124 | pg_loss: 0.0665 | reg_loss: 0.7469 | reward: -0.2961 | rev_kl: 1.0936 | stu_lens: 128.0000 | mixed_lens: 121.0000 | lr: 3.5572e-06 | scale: 1024.00 | time: 26.691 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1875/  5000| tot_loss: 2.6707 | rl_loss: 1.0577 | pt_loss: 1.6130 | pg_loss: 0.6768 | reg_loss: 0.3809 | reward: -0.5202 | rev_kl: 1.1664 | stu_lens: 55.0000 | mixed_lens: 43.0000 | lr: 3.5557e-06 | scale: 1024.00 | time: 26.722 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1876/  5000| tot_loss: 2.8859 | rl_loss: 0.9409 | pt_loss: 1.9450 | pg_loss: 0.1747 | reg_loss: 0.7662 | reward: -0.1740 | rev_kl: 0.5391 | stu_lens: 88.0000 | mixed_lens: 95.0000 | lr: 3.5543e-06 | scale: 1024.00 | time: 26.699 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1877/  5000| tot_loss: 2.9394 | rl_loss: 0.6292 | pt_loss: 2.3102 | pg_loss: 0.2231 | reg_loss: 0.4061 | reward: -0.2751 | rev_kl: 0.3357 | stu_lens: 69.0000 | mixed_lens: 76.0000 | lr: 3.5528e-06 | scale: 1024.00 | time: 26.727 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1878/  5000| tot_loss: 2.9051 | rl_loss: 0.8860 | pt_loss: 2.0191 | pg_loss: 0.2530 | reg_loss: 0.6329 | reward: -0.2473 | rev_kl: 0.8001 | stu_lens: 100.0000 | mixed_lens: 96.5000 | lr: 3.5514e-06 | scale: 1024.00 | time: 26.690 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1879/  5000| tot_loss: 2.0239 | rl_loss: 0.5929 | pt_loss: 1.4310 | pg_loss: 0.0181 | reg_loss: 0.5748 | reward: -0.1629 | rev_kl: 0.9304 | stu_lens: 120.5000 | mixed_lens: 128.0000 | lr: 3.5499e-06 | scale: 1024.00 | time: 26.708 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1880/  5000| tot_loss: 2.9305 | rl_loss: 0.9170 | pt_loss: 2.0135 | pg_loss: 0.0176 | reg_loss: 0.8994 | reward: -0.2344 | rev_kl: 0.7089 | stu_lens: 128.0000 | mixed_lens: 124.5000 | lr: 3.5485e-06 | scale: 1024.00 | time: 26.689 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1881/  5000| tot_loss: 2.4578 | rl_loss: 0.7607 | pt_loss: 1.6971 | pg_loss: 0.1828 | reg_loss: 0.5779 | reward: -0.1298 | rev_kl: 0.4597 | stu_lens: 127.5000 | mixed_lens: 104.5000 | lr: 3.5470e-06 | scale: 1024.00 | time: 26.687 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1882/  5000| tot_loss: 2.6379 | rl_loss: 0.6472 | pt_loss: 1.9907 | pg_loss: 0.0086 | reg_loss: 0.6385 | reward: -0.2265 | rev_kl: 0.9459 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5456e-06 | scale: 1024.00 | time: 26.714 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1883/  5000| tot_loss: 2.6061 | rl_loss: 1.0615 | pt_loss: 1.5446 | pg_loss: 0.5792 | reg_loss: 0.4823 | reward: -0.2359 | rev_kl: 0.4154 | stu_lens: 49.5000 | mixed_lens: 73.0000 | lr: 3.5441e-06 | scale: 1024.00 | time: 26.736 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1884/  5000| tot_loss: 2.2878 | rl_loss: 0.3565 | pt_loss: 1.9313 | pg_loss: 0.0210 | reg_loss: 0.3355 | reward: -0.0486 | rev_kl: 0.7081 | stu_lens: 123.0000 | mixed_lens: 128.0000 | lr: 3.5426e-06 | scale: 1024.00 | time: 26.717 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1885/  5000| tot_loss: 2.5978 | rl_loss: 0.7405 | pt_loss: 1.8573 | pg_loss: 0.1959 | reg_loss: 0.5447 | reward: -0.0709 | rev_kl: 0.8936 | stu_lens: 104.5000 | mixed_lens: 76.5000 | lr: 3.5412e-06 | scale: 1024.00 | time: 26.738 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1886/  5000| tot_loss: 2.8656 | rl_loss: 0.9022 | pt_loss: 1.9634 | pg_loss: 0.2021 | reg_loss: 0.7001 | reward: -0.0300 | rev_kl: 0.6198 | stu_lens: 72.0000 | mixed_lens: 81.5000 | lr: 3.5397e-06 | scale: 1024.00 | time: 26.730 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1887/  5000| tot_loss: 2.0626 | rl_loss: 0.8411 | pt_loss: 1.2215 | pg_loss: 0.1655 | reg_loss: 0.6755 | reward: -0.3095 | rev_kl: 0.8420 | stu_lens: 96.0000 | mixed_lens: 102.5000 | lr: 3.5383e-06 | scale: 1024.00 | time: 26.767 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1888/  5000| tot_loss: 2.6924 | rl_loss: 1.1656 | pt_loss: 1.5268 | pg_loss: 0.5271 | reg_loss: 0.6384 | reward: -0.3789 | rev_kl: 0.6671 | stu_lens: 72.0000 | mixed_lens: 72.0000 | lr: 3.5368e-06 | scale: 1024.00 | time: 26.732 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1888/  5000| tot_loss: 2.6434 | rl_loss: 0.8633 | pt_loss: 1.7800 | pg_loss: 0.1998 | reg_loss: 0.6635 | reward: -0.2616 | rev_kl: 0.8003 | stu_lens: 97.0000 | mixed_lens: 97.3125 | lr: 3.5368e-06 | scale: 1024.00 | time: 26.732 | step time: 27.998
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1889/  5000| tot_loss: 2.4696 | rl_loss: 0.7823 | pt_loss: 1.6873 | pg_loss: -0.0071 | reg_loss: 0.7894 | reward: -0.0704 | rev_kl: 0.5760 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5354e-06 | scale: 1024.00 | time: 26.761 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1890/  5000| tot_loss: 2.4826 | rl_loss: 0.8661 | pt_loss: 1.6164 | pg_loss: 0.4014 | reg_loss: 0.4647 | reward: -0.6661 | rev_kl: 1.5216 | stu_lens: 69.5000 | mixed_lens: 71.5000 | lr: 3.5339e-06 | scale: 1024.00 | time: 26.744 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1891/  5000| tot_loss: 2.4921 | rl_loss: 0.7953 | pt_loss: 1.6969 | pg_loss: 0.4298 | reg_loss: 0.3655 | reward: -0.1103 | rev_kl: 0.3464 | stu_lens: 82.5000 | mixed_lens: 80.5000 | lr: 3.5324e-06 | scale: 1024.00 | time: 26.762 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1892/  5000| tot_loss: 2.4146 | rl_loss: 0.5358 | pt_loss: 1.8788 | pg_loss: -0.0117 | reg_loss: 0.5475 | reward: -0.2404 | rev_kl: 1.0354 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5310e-06 | scale: 1024.00 | time: 26.747 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1893/  5000| tot_loss: 2.4866 | rl_loss: 0.8002 | pt_loss: 1.6864 | pg_loss: 0.2809 | reg_loss: 0.5193 | reward: -0.1536 | rev_kl: 0.6678 | stu_lens: 110.5000 | mixed_lens: 102.0000 | lr: 3.5295e-06 | scale: 1024.00 | time: 26.777 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1894/  5000| tot_loss: 2.7783 | rl_loss: 1.0228 | pt_loss: 1.7555 | pg_loss: 0.5203 | reg_loss: 0.5025 | reward: -0.3444 | rev_kl: 0.5619 | stu_lens: 72.0000 | mixed_lens: 72.0000 | lr: 3.5281e-06 | scale: 1024.00 | time: 26.763 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1895/  5000| tot_loss: 2.0086 | rl_loss: 0.6946 | pt_loss: 1.3139 | pg_loss: 0.1669 | reg_loss: 0.5278 | reward: -0.1777 | rev_kl: 1.0349 | stu_lens: 103.0000 | mixed_lens: 76.5000 | lr: 3.5266e-06 | scale: 1024.00 | time: 26.793 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1896/  5000| tot_loss: 2.0300 | rl_loss: 0.4718 | pt_loss: 1.5583 | pg_loss: -0.0101 | reg_loss: 0.4819 | reward: -0.2002 | rev_kl: 0.6898 | stu_lens: 109.0000 | mixed_lens: 128.0000 | lr: 3.5251e-06 | scale: 1024.00 | time: 26.762 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1897/  5000| tot_loss: 2.3972 | rl_loss: 0.5619 | pt_loss: 1.8353 | pg_loss: 0.2309 | reg_loss: 0.3309 | reward: -0.1302 | rev_kl: 0.5173 | stu_lens: 60.0000 | mixed_lens: 89.5000 | lr: 3.5237e-06 | scale: 1024.00 | time: 26.745 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1898/  5000| tot_loss: 2.1838 | rl_loss: 0.6048 | pt_loss: 1.5789 | pg_loss: 0.0131 | reg_loss: 0.5917 | reward: -0.2753 | rev_kl: 1.0407 | stu_lens: 128.0000 | mixed_lens: 114.5000 | lr: 3.5222e-06 | scale: 1024.00 | time: 26.785 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1899/  5000| tot_loss: 2.0735 | rl_loss: 0.6494 | pt_loss: 1.4241 | pg_loss: 0.2089 | reg_loss: 0.4405 | reward: 0.1608 | rev_kl: 0.8943 | stu_lens: 128.0000 | mixed_lens: 90.0000 | lr: 3.5207e-06 | scale: 1024.00 | time: 26.778 | step time: 0.000
                                 Evaluation #19                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Existen 6 tipos de cuarks, que se    │
│                                       │ diferencian por la cantidad de carga │
│                                       │ del hadron y la naturaleza del bozon │
│                                       │ de Goldstone, que se debe a la       │
│                                       │ transformación de gauge de la fuerza │
│                                       │ de la interacción fuerte. Los 6      │
│                                       │ tipos de cuarks son:                 │
│                                       │                                      │
│                                       │ - Cuark de Primera Generación: carga │
│                                       │ = 1/3, bozon de Goldstone = gluón    │
│                                       │ - Cuark de Segunda Generación: carga │
│                                       │ = 2/3, bozon de Goldstone = fotón    │
│                                       │ - Cuark de Tercera Generación        │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es un acrónimo que significa  │
│                                       │ "Imagen de Mediación Cósmica", y se  │
│                                       │ refiere a la imagen de un cosmos no  │
│                                       │ homogéneo, es decir, que difiera     │
│                                       │ notablemente de la visión de un      │
│                                       │ universo homogéneo consensuado por   │
│                                       │ la comunidad científica.             │
│                                       │                                      │
│                                       │ El IMC tiene una utilidad práctica   │
│                                       │ inmediata para los astrónomos        │
│                                       │ profesionales, ya que ayuda a        │
│                                       │ eliminar las contrincaciones y las   │
│                                       │ debilidades de la visión homogénea   │
│                                       │ del universo, que han                │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ - Cápsula del tiempo de 1870,        │
│                                       │ contenía un periódico de la época, y │
│                                       │ fue abierta el 20 de enero de 1870.  │
│                                       │ - Cápsula del tiempo de 1900,        │
│                                       │ contenía un periódico de la época, y │
│                                       │ fue abierta el 20 de enero de 1900.  │
│                                       │ - Cápsula del tiempo de 1950,        │
│                                       │ contenía un periódico de la época, y │
│                                       │ fue abierta el 20 de enero de 19     │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.212 | exact_match: 0.000 | rev_kl: 0.864 | lens: 99.555 | pt_loss: 1.739 | lm_loss: 1.869 | kd_loss: 1.609 
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1900/  5000| tot_loss: 1.8312 | rl_loss: 0.3312 | pt_loss: 1.5000 | pg_loss: 0.0875 | reg_loss: 0.2437 | reward: -0.7953 | rev_kl: 0.8704 | stu_lens: 62.0000 | mixed_lens: 69.5000 | lr: 3.5193e-06 | scale: 1024.00 | time: 26.782 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1901/  5000| tot_loss: 2.2829 | rl_loss: 0.5262 | pt_loss: 1.7567 | pg_loss: 0.0162 | reg_loss: 0.5101 | reward: -0.2533 | rev_kl: 0.9865 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5178e-06 | scale: 1024.00 | time: 26.797 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1902/  5000| tot_loss: 2.2885 | rl_loss: 0.5333 | pt_loss: 1.7552 | pg_loss: 0.1507 | reg_loss: 0.3826 | reward: -0.2141 | rev_kl: 0.7028 | stu_lens: 113.5000 | mixed_lens: 99.5000 | lr: 3.5164e-06 | scale: 1024.00 | time: 26.723 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1903/  5000| tot_loss: 2.8358 | rl_loss: 1.0460 | pt_loss: 1.7898 | pg_loss: 0.5113 | reg_loss: 0.5347 | reward: -0.1930 | rev_kl: 0.7864 | stu_lens: 71.0000 | mixed_lens: 56.0000 | lr: 3.5149e-06 | scale: 1024.00 | time: 26.727 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1904/  5000| tot_loss: 2.0092 | rl_loss: 0.4798 | pt_loss: 1.5294 | pg_loss: 0.0682 | reg_loss: 0.4116 | reward: -0.1973 | rev_kl: 0.5674 | stu_lens: 116.5000 | mixed_lens: 128.0000 | lr: 3.5134e-06 | scale: 1024.00 | time: 26.723 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1904/  5000| tot_loss: 2.3641 | rl_loss: 0.6636 | pt_loss: 1.7005 | pg_loss: 0.1977 | reg_loss: 0.4659 | reward: -0.2589 | rev_kl: 0.7735 | stu_lens: 99.1406 | mixed_lens: 99.0781 | lr: 3.5134e-06 | scale: 1024.00 | time: 26.723 | step time: 28.045
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1905/  5000| tot_loss: 2.7015 | rl_loss: 0.5685 | pt_loss: 2.1330 | pg_loss: 0.0123 | reg_loss: 0.5561 | reward: -0.1751 | rev_kl: 0.9890 | stu_lens: 128.0000 | mixed_lens: 124.5000 | lr: 3.5120e-06 | scale: 1024.00 | time: 26.739 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1906/  5000| tot_loss: 2.4047 | rl_loss: 0.6555 | pt_loss: 1.7492 | pg_loss: 0.2853 | reg_loss: 0.3702 | reward: -0.4071 | rev_kl: 1.6078 | stu_lens: 64.5000 | mixed_lens: 71.5000 | lr: 3.5105e-06 | scale: 1024.00 | time: 26.736 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1907/  5000| tot_loss: 2.2985 | rl_loss: 0.4548 | pt_loss: 1.8438 | pg_loss: -0.0008 | reg_loss: 0.4555 | reward: -0.2555 | rev_kl: 0.8588 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5090e-06 | scale: 1024.00 | time: 26.779 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1908/  5000| tot_loss: 2.4321 | rl_loss: 0.9084 | pt_loss: 1.5237 | pg_loss: 0.6169 | reg_loss: 0.2915 | reward: -0.7468 | rev_kl: 1.0641 | stu_lens: 46.0000 | mixed_lens: 18.0000 | lr: 3.5076e-06 | scale: 1024.00 | time: 26.745 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1909/  5000| tot_loss: 2.1784 | rl_loss: 0.4000 | pt_loss: 1.7784 | pg_loss: -0.0085 | reg_loss: 0.4085 | reward: -0.2876 | rev_kl: 0.9941 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.5061e-06 | scale: 1024.00 | time: 26.759 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1910/  5000| tot_loss: 2.9280 | rl_loss: 0.8060 | pt_loss: 2.1220 | pg_loss: 0.3059 | reg_loss: 0.5001 | reward: 0.0235 | rev_kl: 0.7501 | stu_lens: 79.0000 | mixed_lens: 55.5000 | lr: 3.5046e-06 | scale: 1024.00 | time: 26.740 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1911/  5000| tot_loss: 1.8877 | rl_loss: 0.4257 | pt_loss: 1.4621 | pg_loss: 0.0623 | reg_loss: 0.3633 | reward: -0.2749 | rev_kl: 0.4059 | stu_lens: 82.5000 | mixed_lens: 80.5000 | lr: 3.5032e-06 | scale: 1024.00 | time: 26.770 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1912/  5000| tot_loss: 2.0815 | rl_loss: 0.7861 | pt_loss: 1.2954 | pg_loss: 0.4131 | reg_loss: 0.3730 | reward: -0.7162 | rev_kl: 0.8742 | stu_lens: 128.0000 | mixed_lens: 80.5000 | lr: 3.5017e-06 | scale: 1024.00 | time: 26.752 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1913/  5000| tot_loss: 2.3856 | rl_loss: 0.4396 | pt_loss: 1.9460 | pg_loss: 0.1379 | reg_loss: 0.3017 | reward: -0.1187 | rev_kl: 0.5419 | stu_lens: 127.5000 | mixed_lens: 104.5000 | lr: 3.5002e-06 | scale: 1024.00 | time: 26.780 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1914/  5000| tot_loss: 2.0285 | rl_loss: 0.5345 | pt_loss: 1.4940 | pg_loss: 0.1660 | reg_loss: 0.3685 | reward: -0.2607 | rev_kl: 0.7042 | stu_lens: 88.0000 | mixed_lens: 95.0000 | lr: 3.4988e-06 | scale: 1024.00 | time: 26.767 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1915/  5000| tot_loss: 2.1281 | rl_loss: 0.6447 | pt_loss: 1.4834 | pg_loss: 0.3596 | reg_loss: 0.2851 | reward: -0.2665 | rev_kl: 0.5716 | stu_lens: 62.0000 | mixed_lens: 61.0000 | lr: 3.4973e-06 | scale: 1024.00 | time: 26.763 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1916/  5000| tot_loss: 2.0888 | rl_loss: 0.5090 | pt_loss: 1.5797 | pg_loss: 0.1601 | reg_loss: 0.3490 | reward: -0.0249 | rev_kl: 0.4807 | stu_lens: 128.0000 | mixed_lens: 94.0000 | lr: 3.4958e-06 | scale: 1024.00 | time: 26.800 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1917/  5000| tot_loss: 2.2858 | rl_loss: 0.5154 | pt_loss: 1.7704 | pg_loss: 0.0565 | reg_loss: 0.4589 | reward: -0.2565 | rev_kl: 0.8345 | stu_lens: 126.5000 | mixed_lens: 128.0000 | lr: 3.4943e-06 | scale: 1024.00 | time: 26.810 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1918/  5000| tot_loss: 2.6296 | rl_loss: 0.7483 | pt_loss: 1.8813 | pg_loss: 0.2018 | reg_loss: 0.5466 | reward: -0.0950 | rev_kl: 2.0188 | stu_lens: 61.5000 | mixed_lens: 81.5000 | lr: 3.4929e-06 | scale: 1024.00 | time: 26.776 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1919/  5000| tot_loss: 2.0790 | rl_loss: 0.4153 | pt_loss: 1.6637 | pg_loss: 0.0258 | reg_loss: 0.3894 | reward: -0.1216 | rev_kl: 0.7694 | stu_lens: 71.0000 | mixed_lens: 121.5000 | lr: 3.4914e-06 | scale: 1024.00 | time: 26.821 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1920/  5000| tot_loss: 2.2446 | rl_loss: 0.4720 | pt_loss: 1.7725 | pg_loss: 0.1898 | reg_loss: 0.2823 | reward: -0.2156 | rev_kl: 0.9956 | stu_lens: 89.5000 | mixed_lens: 104.5000 | lr: 3.4899e-06 | scale: 1024.00 | time: 26.723 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1920/  5000| tot_loss: 2.2116 | rl_loss: 0.5576 | pt_loss: 1.6540 | pg_loss: 0.1721 | reg_loss: 0.3855 | reward: -0.2482 | rev_kl: 0.7985 | stu_lens: 98.8125 | mixed_lens: 98.6875 | lr: 3.4899e-06 | scale: 1024.00 | time: 26.723 | step time: 28.049
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1921/  5000| tot_loss: 2.0969 | rl_loss: 0.4104 | pt_loss: 1.6865 | pg_loss: 0.0000 | reg_loss: 0.4104 | reward: -0.4085 | rev_kl: 0.6816 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4885e-06 | scale: 1024.00 | time: 26.767 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1922/  5000| tot_loss: 2.7108 | rl_loss: 0.9837 | pt_loss: 1.7271 | pg_loss: 0.0529 | reg_loss: 0.9308 | reward: -0.2524 | rev_kl: 0.8187 | stu_lens: 102.5000 | mixed_lens: 128.0000 | lr: 3.4870e-06 | scale: 1024.00 | time: 26.748 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1923/  5000| tot_loss: 2.9330 | rl_loss: 1.0897 | pt_loss: 1.8433 | pg_loss: 0.1613 | reg_loss: 0.9284 | reward: -0.0993 | rev_kl: 0.7698 | stu_lens: 128.0000 | mixed_lens: 108.5000 | lr: 3.4855e-06 | scale: 1024.00 | time: 26.769 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1924/  5000| tot_loss: 2.8287 | rl_loss: 1.1684 | pt_loss: 1.6603 | pg_loss: 0.3670 | reg_loss: 0.8014 | reward: -0.3424 | rev_kl: 1.5267 | stu_lens: 104.0000 | mixed_lens: 81.5000 | lr: 3.4840e-06 | scale: 1024.00 | time: 26.752 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1925/  5000| tot_loss: 2.9942 | rl_loss: 1.1591 | pt_loss: 1.8350 | pg_loss: 0.3428 | reg_loss: 0.8164 | reward: 2.4562 | rev_kl: 1.2099 | stu_lens: 54.5000 | mixed_lens: 32.5000 | lr: 3.4826e-06 | scale: 1024.00 | time: 26.793 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1926/  5000| tot_loss: 2.0247 | rl_loss: 0.8588 | pt_loss: 1.1659 | pg_loss: 0.5381 | reg_loss: 0.3208 | reward: 0.0754 | rev_kl: 0.6772 | stu_lens: 80.0000 | mixed_lens: 73.0000 | lr: 3.4811e-06 | scale: 1024.00 | time: 26.776 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1927/  5000| tot_loss: 2.6072 | rl_loss: 1.0073 | pt_loss: 1.5999 | pg_loss: 0.1311 | reg_loss: 0.8762 | reward: -0.2286 | rev_kl: 0.7609 | stu_lens: 128.0000 | mixed_lens: 99.5000 | lr: 3.4796e-06 | scale: 1024.00 | time: 26.782 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1928/  5000| tot_loss: 2.1251 | rl_loss: 0.7337 | pt_loss: 1.3914 | pg_loss: 0.0524 | reg_loss: 0.6813 | reward: -0.2382 | rev_kl: 0.5020 | stu_lens: 114.0000 | mixed_lens: 128.0000 | lr: 3.4781e-06 | scale: 1024.00 | time: 26.782 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1929/  5000| tot_loss: 2.6885 | rl_loss: 1.0050 | pt_loss: 1.6835 | pg_loss: 0.1366 | reg_loss: 0.8684 | reward: -0.2343 | rev_kl: 0.6584 | stu_lens: 60.5000 | mixed_lens: 115.0000 | lr: 3.4767e-06 | scale: 1024.00 | time: 26.804 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1930/  5000| tot_loss: 2.5891 | rl_loss: 1.1843 | pt_loss: 1.4048 | pg_loss: 0.0647 | reg_loss: 1.1196 | reward: -0.0878 | rev_kl: 0.5383 | stu_lens: 71.5000 | mixed_lens: 125.5000 | lr: 3.4752e-06 | scale: 1024.00 | time: 26.794 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1931/  5000| tot_loss: 2.9947 | rl_loss: 1.2316 | pt_loss: 1.7630 | pg_loss: 0.1335 | reg_loss: 1.0982 | reward: -0.3208 | rev_kl: 0.5681 | stu_lens: 95.5000 | mixed_lens: 118.5000 | lr: 3.4737e-06 | scale: 1024.00 | time: 26.773 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1932/  5000| tot_loss: 2.5463 | rl_loss: 0.9395 | pt_loss: 1.6068 | pg_loss: 0.0753 | reg_loss: 0.8642 | reward: -0.0800 | rev_kl: 0.6442 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4722e-06 | scale: 1024.00 | time: 26.766 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1933/  5000| tot_loss: 2.6408 | rl_loss: 0.8548 | pt_loss: 1.7860 | pg_loss: 0.0339 | reg_loss: 0.8210 | reward: -0.1788 | rev_kl: 1.6585 | stu_lens: 128.0000 | mixed_lens: 125.0000 | lr: 3.4708e-06 | scale: 1024.00 | time: 26.778 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1934/  5000| tot_loss: 2.7370 | rl_loss: 0.7976 | pt_loss: 1.9394 | pg_loss: 0.1589 | reg_loss: 0.6386 | reward: -0.0479 | rev_kl: 0.7844 | stu_lens: 108.5000 | mixed_lens: 93.5000 | lr: 3.4693e-06 | scale: 1024.00 | time: 26.780 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1935/  5000| tot_loss: 2.7076 | rl_loss: 0.8701 | pt_loss: 1.8376 | pg_loss: 0.0353 | reg_loss: 0.8348 | reward: -0.1750 | rev_kl: 1.2485 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4678e-06 | scale: 1024.00 | time: 26.765 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1936/  5000| tot_loss: 2.9638 | rl_loss: 1.2340 | pt_loss: 1.7298 | pg_loss: 0.2791 | reg_loss: 0.9549 | reward: -0.3477 | rev_kl: 0.5305 | stu_lens: 80.0000 | mixed_lens: 70.5000 | lr: 3.4663e-06 | scale: 1024.00 | time: 26.787 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   1936/  5000| tot_loss: 2.6674 | rl_loss: 0.9991 | pt_loss: 1.6683 | pg_loss: 0.1655 | reg_loss: 0.8336 | reward: -0.1435 | rev_kl: 0.7940 | stu_lens: 103.4219 | mixed_lens: 106.4688 | lr: 3.4663e-06 | scale: 1024.00 | time: 26.787 | step time: 28.057
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   1937/  5000| tot_loss: 3.0509 | rl_loss: 0.9384 | pt_loss: 2.1125 | pg_loss: 0.2766 | reg_loss: 0.6618 | reward: -0.1960 | rev_kl: 1.0861 | stu_lens: 128.0000 | mixed_lens: 95.0000 | lr: 3.4648e-06 | scale: 1024.00 | time: 26.738 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   1938/  5000| tot_loss: 2.7540 | rl_loss: 0.8217 | pt_loss: 1.9323 | pg_loss: 0.1825 | reg_loss: 0.6392 | reward: -0.1333 | rev_kl: 1.0037 | stu_lens: 79.5000 | mixed_lens: 102.0000 | lr: 3.4634e-06 | scale: 1024.00 | time: 26.711 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   1939/  5000| tot_loss: 2.7331 | rl_loss: 0.8778 | pt_loss: 1.8554 | pg_loss: 0.0299 | reg_loss: 0.8478 | reward: -0.1950 | rev_kl: 0.8098 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4619e-06 | scale: 1024.00 | time: 26.757 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   1940/  5000| tot_loss: 2.0947 | rl_loss: 0.6258 | pt_loss: 1.4689 | pg_loss: 0.0946 | reg_loss: 0.5312 | reward: -0.1898 | rev_kl: 0.7201 | stu_lens: 128.0000 | mixed_lens: 108.5000 | lr: 3.4604e-06 | scale: 1024.00 | time: 26.728 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   1941/  5000| tot_loss: 2.3502 | rl_loss: 0.6502 | pt_loss: 1.7000 | pg_loss: 0.1641 | reg_loss: 0.4861 | reward: -0.1818 | rev_kl: 0.9123 | stu_lens: 92.0000 | mixed_lens: 94.0000 | lr: 3.4589e-06 | scale: 1024.00 | time: 26.752 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   1942/  5000| tot_loss: 2.6628 | rl_loss: 1.0195 | pt_loss: 1.6433 | pg_loss: 0.3328 | reg_loss: 0.6867 | reward: -0.3118 | rev_kl: 1.0339 | stu_lens: 93.0000 | mixed_lens: 93.0000 | lr: 3.4574e-06 | scale: 1024.00 | time: 26.712 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   1943/  5000| tot_loss: 2.6094 | rl_loss: 0.8518 | pt_loss: 1.7575 | pg_loss: 0.2246 | reg_loss: 0.6272 | reward: -0.0977 | rev_kl: 0.9267 | stu_lens: 108.5000 | mixed_lens: 93.5000 | lr: 3.4560e-06 | scale: 1024.00 | time: 26.718 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   1944/  5000| tot_loss: 2.5708 | rl_loss: 0.5000 | pt_loss: 2.0708 | pg_loss: -0.0065 | reg_loss: 0.5065 | reward: -0.2013 | rev_kl: 1.1506 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4545e-06 | scale: 1024.00 | time: 26.697 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   1945/  5000| tot_loss: 2.2190 | rl_loss: 0.6221 | pt_loss: 1.5969 | pg_loss: -0.0166 | reg_loss: 0.6387 | reward: -0.3269 | rev_kl: 0.7819 | stu_lens: 102.5000 | mixed_lens: 128.0000 | lr: 3.4530e-06 | scale: 1024.00 | time: 26.719 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   1946/  5000| tot_loss: 2.6103 | rl_loss: 0.6666 | pt_loss: 1.9437 | pg_loss: 0.1410 | reg_loss: 0.5256 | reward: -0.0956 | rev_kl: 0.6450 | stu_lens: 117.5000 | mixed_lens: 114.5000 | lr: 3.4515e-06 | scale: 1024.00 | time: 26.701 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   1947/  5000| tot_loss: 2.6346 | rl_loss: 0.8923 | pt_loss: 1.7423 | pg_loss: 0.2006 | reg_loss: 0.6917 | reward: 2.4981 | rev_kl: 0.8959 | stu_lens: 90.5000 | mixed_lens: 66.5000 | lr: 3.4500e-06 | scale: 1024.00 | time: 26.738 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   1948/  5000| tot_loss: 2.1271 | rl_loss: 0.4604 | pt_loss: 1.6667 | pg_loss: 0.0111 | reg_loss: 0.4493 | reward: -0.2121 | rev_kl: 0.7075 | stu_lens: 92.5000 | mixed_lens: 122.5000 | lr: 3.4486e-06 | scale: 1024.00 | time: 26.699 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   1949/  5000| tot_loss: 1.9763 | rl_loss: 0.6471 | pt_loss: 1.3292 | pg_loss: 0.1774 | reg_loss: 0.4697 | reward: -0.2216 | rev_kl: 0.4566 | stu_lens: 128.0000 | mixed_lens: 97.5000 | lr: 3.4471e-06 | scale: 1024.00 | time: 26.760 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   1950/  5000| tot_loss: 3.1876 | rl_loss: 1.0417 | pt_loss: 2.1459 | pg_loss: 0.5857 | reg_loss: 0.4561 | reward: -0.3444 | rev_kl: 0.4942 | stu_lens: 80.0000 | mixed_lens: 70.5000 | lr: 3.4456e-06 | scale: 1024.00 | time: 26.735 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   1951/  5000| tot_loss: 2.4817 | rl_loss: 0.5940 | pt_loss: 1.8877 | pg_loss: -0.0100 | reg_loss: 0.6040 | reward: -0.1974 | rev_kl: 1.5931 | stu_lens: 87.0000 | mixed_lens: 125.0000 | lr: 3.4441e-06 | scale: 1024.00 | time: 26.732 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1952/  5000| tot_loss: 3.8098 | rl_loss: 1.7850 | pt_loss: 2.0248 | pg_loss: 1.0070 | reg_loss: 0.7779 | reward: -0.6731 | rev_kl: 0.7957 | stu_lens: 48.5000 | mixed_lens: 26.0000 | lr: 3.4426e-06 | scale: 1024.00 | time: 26.738 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   1952/  5000| tot_loss: 2.5491 | rl_loss: 0.7959 | pt_loss: 1.7533 | pg_loss: 0.1943 | reg_loss: 0.6016 | reward: -0.1378 | rev_kl: 0.8102 | stu_lens: 99.2188 | mixed_lens: 100.0000 | lr: 3.4426e-06 | scale: 1024.00 | time: 26.738 | step time: 28.007
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   1953/  5000| tot_loss: 2.1242 | rl_loss: 0.2620 | pt_loss: 1.8622 | pg_loss: -0.0005 | reg_loss: 0.2625 | reward: -0.0291 | rev_kl: 0.6659 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4411e-06 | scale: 1024.00 | time: 26.771 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   1954/  5000| tot_loss: 2.0348 | rl_loss: 0.3764 | pt_loss: 1.6584 | pg_loss: 0.0811 | reg_loss: 0.2954 | reward: -0.2101 | rev_kl: 0.3035 | stu_lens: 94.5000 | mixed_lens: 115.0000 | lr: 3.4397e-06 | scale: 1024.00 | time: 26.755 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   1955/  5000| tot_loss: 2.5896 | rl_loss: 0.4730 | pt_loss: 2.1165 | pg_loss: -0.0131 | reg_loss: 0.4861 | reward: -0.2119 | rev_kl: 0.6824 | stu_lens: 114.0000 | mixed_lens: 128.0000 | lr: 3.4382e-06 | scale: 1024.00 | time: 26.766 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   1956/  5000| tot_loss: 2.3678 | rl_loss: 0.8217 | pt_loss: 1.5461 | pg_loss: 0.3554 | reg_loss: 0.4663 | reward: -0.0456 | rev_kl: 0.5545 | stu_lens: 39.0000 | mixed_lens: 73.0000 | lr: 3.4367e-06 | scale: 1024.00 | time: 26.783 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   1957/  5000| tot_loss: 2.6957 | rl_loss: 0.7934 | pt_loss: 1.9023 | pg_loss: 0.2905 | reg_loss: 0.5029 | reward: -0.0865 | rev_kl: 0.7043 | stu_lens: 108.5000 | mixed_lens: 80.0000 | lr: 3.4352e-06 | scale: 1024.00 | time: 26.782 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   1958/  5000| tot_loss: 2.4707 | rl_loss: 0.4195 | pt_loss: 2.0512 | pg_loss: 0.0565 | reg_loss: 0.3630 | reward: -0.0958 | rev_kl: 0.4769 | stu_lens: 71.5000 | mixed_lens: 125.5000 | lr: 3.4337e-06 | scale: 1024.00 | time: 26.775 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   1959/  5000| tot_loss: 2.3395 | rl_loss: 0.8415 | pt_loss: 1.4981 | pg_loss: 0.2264 | reg_loss: 0.6151 | reward: -0.9593 | rev_kl: 0.9701 | stu_lens: 96.5000 | mixed_lens: 81.0000 | lr: 3.4322e-06 | scale: 1024.00 | time: 26.805 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1960/  5000| tot_loss: 2.1856 | rl_loss: 0.3275 | pt_loss: 1.8581 | pg_loss: -0.0069 | reg_loss: 0.3344 | reward: -0.0788 | rev_kl: 1.6837 | stu_lens: 128.0000 | mixed_lens: 125.0000 | lr: 3.4307e-06 | scale: 1024.00 | time: 26.776 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   1961/  5000| tot_loss: 2.3587 | rl_loss: 0.5792 | pt_loss: 1.7795 | pg_loss: 0.2682 | reg_loss: 0.3110 | reward: -0.4476 | rev_kl: 0.7431 | stu_lens: 77.5000 | mixed_lens: 78.0000 | lr: 3.4292e-06 | scale: 1024.00 | time: 26.790 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   1962/  5000| tot_loss: 2.0100 | rl_loss: 0.2009 | pt_loss: 1.8091 | pg_loss: -0.1080 | reg_loss: 0.3089 | reward: -0.2081 | rev_kl: 0.6401 | stu_lens: 91.0000 | mixed_lens: 43.0000 | lr: 3.4278e-06 | scale: 1024.00 | time: 26.804 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   1963/  5000| tot_loss: 2.6360 | rl_loss: 0.7353 | pt_loss: 1.9006 | pg_loss: 0.2523 | reg_loss: 0.4831 | reward: -0.2868 | rev_kl: 1.3100 | stu_lens: 104.0000 | mixed_lens: 81.5000 | lr: 3.4263e-06 | scale: 1024.00 | time: 26.835 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   1964/  5000| tot_loss: 2.5000 | rl_loss: 0.5155 | pt_loss: 1.9845 | pg_loss: -0.0069 | reg_loss: 0.5224 | reward: -0.1587 | rev_kl: 0.7741 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4248e-06 | scale: 1024.00 | time: 26.749 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   1965/  5000| tot_loss: 2.4650 | rl_loss: 0.7258 | pt_loss: 1.7392 | pg_loss: 0.0554 | reg_loss: 0.6704 | reward: -0.1057 | rev_kl: 0.8743 | stu_lens: 128.0000 | mixed_lens: 108.5000 | lr: 3.4233e-06 | scale: 1024.00 | time: 26.745 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   1966/  5000| tot_loss: 3.4429 | rl_loss: 1.2750 | pt_loss: 2.1679 | pg_loss: 0.6816 | reg_loss: 0.5934 | reward: -0.3177 | rev_kl: 0.8789 | stu_lens: 93.0000 | mixed_lens: 62.5000 | lr: 3.4218e-06 | scale: 1024.00 | time: 26.752 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   1967/  5000| tot_loss: 2.1192 | rl_loss: 0.4332 | pt_loss: 1.6860 | pg_loss: -0.0178 | reg_loss: 0.4510 | reward: -0.0583 | rev_kl: 0.8489 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4203e-06 | scale: 1024.00 | time: 26.797 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1968/  5000| tot_loss: 2.3525 | rl_loss: 0.5462 | pt_loss: 1.8063 | pg_loss: 0.1693 | reg_loss: 0.3769 | reward: -0.1865 | rev_kl: 0.6348 | stu_lens: 111.0000 | mixed_lens: 106.0000 | lr: 3.4188e-06 | scale: 1024.00 | time: 26.775 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   1968/  5000| tot_loss: 2.3730 | rl_loss: 0.5556 | pt_loss: 1.8174 | pg_loss: 0.1214 | reg_loss: 0.4342 | reward: -0.1337 | rev_kl: 0.7897 | stu_lens: 100.7812 | mixed_lens: 103.3438 | lr: 3.4188e-06 | scale: 1024.00 | time: 26.775 | step time: 28.060
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   1969/  5000| tot_loss: 2.5696 | rl_loss: 0.5084 | pt_loss: 2.0612 | pg_loss: 0.0487 | reg_loss: 0.4597 | reward: -0.1037 | rev_kl: 0.9494 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4173e-06 | scale: 1024.00 | time: 26.778 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   1970/  5000| tot_loss: 2.2376 | rl_loss: 0.7029 | pt_loss: 1.5347 | pg_loss: 0.3594 | reg_loss: 0.3435 | reward: -0.0456 | rev_kl: 0.5545 | stu_lens: 39.0000 | mixed_lens: 73.0000 | lr: 3.4158e-06 | scale: 1024.00 | time: 26.755 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   1971/  5000| tot_loss: 1.8982 | rl_loss: 0.2952 | pt_loss: 1.6030 | pg_loss: -0.0003 | reg_loss: 0.2955 | reward: -0.2254 | rev_kl: 0.7708 | stu_lens: 67.0000 | mixed_lens: 128.0000 | lr: 3.4143e-06 | scale: 1024.00 | time: 26.806 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   1972/  5000| tot_loss: 1.6322 | rl_loss: 0.2668 | pt_loss: 1.3654 | pg_loss: -0.0150 | reg_loss: 0.2818 | reward: -0.0243 | rev_kl: 0.5831 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4129e-06 | scale: 1024.00 | time: 26.757 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   1973/  5000| tot_loss: 2.0430 | rl_loss: 0.6064 | pt_loss: 1.4366 | pg_loss: 0.2183 | reg_loss: 0.3881 | reward: -0.2815 | rev_kl: 1.0944 | stu_lens: 116.5000 | mixed_lens: 95.0000 | lr: 3.4114e-06 | scale: 1024.00 | time: 26.774 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   1974/  5000| tot_loss: 2.1851 | rl_loss: 0.3396 | pt_loss: 1.8455 | pg_loss: 0.0055 | reg_loss: 0.3341 | reward: -0.1622 | rev_kl: 0.4005 | stu_lens: 71.5000 | mixed_lens: 125.5000 | lr: 3.4099e-06 | scale: 1024.00 | time: 26.756 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   1975/  5000| tot_loss: 1.8126 | rl_loss: 0.4304 | pt_loss: 1.3822 | pg_loss: -0.0178 | reg_loss: 0.4482 | reward: -0.2442 | rev_kl: 0.9129 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4084e-06 | scale: 1024.00 | time: 26.776 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   1976/  5000| tot_loss: 1.9810 | rl_loss: 0.2747 | pt_loss: 1.7063 | pg_loss: -0.0094 | reg_loss: 0.2841 | reward: -0.1778 | rev_kl: 1.2702 | stu_lens: 86.0000 | mixed_lens: 128.0000 | lr: 3.4069e-06 | scale: 1024.00 | time: 26.758 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   1977/  5000| tot_loss: 1.6743 | rl_loss: 0.2951 | pt_loss: 1.3792 | pg_loss: -0.0137 | reg_loss: 0.3088 | reward: -0.0977 | rev_kl: 0.6970 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4054e-06 | scale: 1024.00 | time: 26.770 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   1978/  5000| tot_loss: 1.8960 | rl_loss: 0.2962 | pt_loss: 1.5999 | pg_loss: 0.0278 | reg_loss: 0.2684 | reward: -0.1715 | rev_kl: 0.7000 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4039e-06 | scale: 1024.00 | time: 26.735 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   1979/  5000| tot_loss: 2.1317 | rl_loss: 0.1840 | pt_loss: 1.9477 | pg_loss: 0.0104 | reg_loss: 0.1736 | reward: -0.0291 | rev_kl: 0.6659 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4024e-06 | scale: 1024.00 | time: 26.785 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   1980/  5000| tot_loss: 2.3261 | rl_loss: 0.4620 | pt_loss: 1.8641 | pg_loss: -0.0277 | reg_loss: 0.4896 | reward: -0.3522 | rev_kl: 0.8104 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.4009e-06 | scale: 1024.00 | time: 26.759 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   1981/  5000| tot_loss: 2.0903 | rl_loss: 0.2844 | pt_loss: 1.8059 | pg_loss: -0.0091 | reg_loss: 0.2935 | reward: -0.1867 | rev_kl: 0.4146 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.3994e-06 | scale: 1024.00 | time: 26.811 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   1982/  5000| tot_loss: 2.4876 | rl_loss: 0.7098 | pt_loss: 1.7778 | pg_loss: 0.3142 | reg_loss: 0.3956 | reward: -0.1521 | rev_kl: 0.2702 | stu_lens: 57.5000 | mixed_lens: 85.0000 | lr: 3.3979e-06 | scale: 1024.00 | time: 26.785 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   1983/  5000| tot_loss: 2.5590 | rl_loss: 0.7151 | pt_loss: 1.8439 | pg_loss: 0.2224 | reg_loss: 0.4927 | reward: -0.1169 | rev_kl: 0.6062 | stu_lens: 91.0000 | mixed_lens: 71.5000 | lr: 3.3964e-06 | scale: 1024.00 | time: 26.819 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1984/  5000| tot_loss: 2.4196 | rl_loss: 0.7478 | pt_loss: 1.6718 | pg_loss: 0.2774 | reg_loss: 0.4704 | reward: -0.3126 | rev_kl: 1.0427 | stu_lens: 59.0000 | mixed_lens: 93.0000 | lr: 3.3949e-06 | scale: 1024.00 | time: 26.800 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   1984/  5000| tot_loss: 2.1922 | rl_loss: 0.5060 | pt_loss: 1.6862 | pg_loss: 0.1462 | reg_loss: 0.3599 | reward: -0.1328 | rev_kl: 0.8131 | stu_lens: 102.1875 | mixed_lens: 103.7500 | lr: 3.3949e-06 | scale: 1024.00 | time: 26.800 | step time: 28.056
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   1985/  5000| tot_loss: 2.0930 | rl_loss: 0.2189 | pt_loss: 1.8741 | pg_loss: -0.0075 | reg_loss: 0.2264 | reward: -0.1292 | rev_kl: 0.5209 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.3934e-06 | scale: 1024.00 | time: 26.813 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   1986/  5000| tot_loss: 2.9686 | rl_loss: 1.1748 | pt_loss: 1.7938 | pg_loss: 0.3461 | reg_loss: 0.8287 | reward: -0.4647 | rev_kl: 0.4515 | stu_lens: 100.0000 | mixed_lens: 72.0000 | lr: 3.3919e-06 | scale: 1024.00 | time: 26.787 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   1987/  5000| tot_loss: 2.5971 | rl_loss: 1.0909 | pt_loss: 1.5062 | pg_loss: 0.2912 | reg_loss: 0.7997 | reward: -1.3808 | rev_kl: 1.1022 | stu_lens: 66.5000 | mixed_lens: 66.5000 | lr: 3.3904e-06 | scale: 1024.00 | time: 26.795 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   1988/  5000| tot_loss: 3.0509 | rl_loss: 1.4578 | pt_loss: 1.5931 | pg_loss: 0.6493 | reg_loss: 0.8085 | reward: -0.4504 | rev_kl: 0.6216 | stu_lens: 57.0000 | mixed_lens: 63.0000 | lr: 3.3889e-06 | scale: 1024.00 | time: 26.800 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   1989/  5000| tot_loss: 2.5553 | rl_loss: 0.8321 | pt_loss: 1.7232 | pg_loss: 0.0394 | reg_loss: 0.7926 | reward: -0.1606 | rev_kl: 0.6269 | stu_lens: 108.5000 | mixed_lens: 128.0000 | lr: 3.3874e-06 | scale: 1024.00 | time: 26.830 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   1990/  5000| tot_loss: 3.3250 | rl_loss: 1.5811 | pt_loss: 1.7440 | pg_loss: 0.4039 | reg_loss: 1.1772 | reward: -0.5326 | rev_kl: 1.0203 | stu_lens: 75.5000 | mixed_lens: 90.0000 | lr: 3.3859e-06 | scale: 1024.00 | time: 26.805 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   1991/  5000| tot_loss: 2.7444 | rl_loss: 1.0535 | pt_loss: 1.6908 | pg_loss: 0.2690 | reg_loss: 0.7845 | reward: -0.0175 | rev_kl: 0.6831 | stu_lens: 128.0000 | mixed_lens: 74.5000 | lr: 3.3844e-06 | scale: 1024.00 | time: 26.847 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   1992/  5000| tot_loss: 2.8019 | rl_loss: 0.9808 | pt_loss: 1.8211 | pg_loss: 0.0420 | reg_loss: 0.9387 | reward: -0.3955 | rev_kl: 0.6021 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.3829e-06 | scale: 1024.00 | time: 26.790 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   1993/  5000| tot_loss: 3.0775 | rl_loss: 1.1040 | pt_loss: 1.9735 | pg_loss: 0.3570 | reg_loss: 0.7469 | reward: -0.1583 | rev_kl: 1.0061 | stu_lens: 75.0000 | mixed_lens: 78.0000 | lr: 3.3814e-06 | scale: 1024.00 | time: 26.799 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   1994/  5000| tot_loss: 3.2638 | rl_loss: 1.4150 | pt_loss: 1.8489 | pg_loss: 0.4415 | reg_loss: 0.9735 | reward: -0.2715 | rev_kl: 1.0895 | stu_lens: 40.5000 | mixed_lens: 87.5000 | lr: 3.3799e-06 | scale: 1024.00 | time: 26.837 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   1995/  5000| tot_loss: 3.3742 | rl_loss: 1.2483 | pt_loss: 2.1260 | pg_loss: 0.3608 | reg_loss: 0.8875 | reward: -0.0514 | rev_kl: 0.8135 | stu_lens: 98.0000 | mixed_lens: 73.0000 | lr: 3.3784e-06 | scale: 1024.00 | time: 26.869 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   1996/  5000| tot_loss: 2.9911 | rl_loss: 1.0925 | pt_loss: 1.8986 | pg_loss: 0.0529 | reg_loss: 1.0395 | reward: -0.1260 | rev_kl: 0.9171 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.3769e-06 | scale: 1024.00 | time: 26.782 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   1997/  5000| tot_loss: 2.3447 | rl_loss: 0.5543 | pt_loss: 1.7904 | pg_loss: 0.2048 | reg_loss: 0.3496 | reward: -1.9481 | rev_kl: 1.3554 | stu_lens: 66.0000 | mixed_lens: 66.0000 | lr: 3.3754e-06 | scale: 1024.00 | time: 26.796 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   1998/  5000| tot_loss: 2.8682 | rl_loss: 0.9997 | pt_loss: 1.8685 | pg_loss: 0.2902 | reg_loss: 0.7095 | reward: -0.1271 | rev_kl: 0.7024 | stu_lens: 60.0000 | mixed_lens: 92.0000 | lr: 3.3739e-06 | scale: 1024.00 | time: 26.793 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   1999/  5000| tot_loss: 2.6396 | rl_loss: 1.0382 | pt_loss: 1.6014 | pg_loss: 0.3264 | reg_loss: 0.7118 | reward: -0.2688 | rev_kl: 1.1511 | stu_lens: 55.5000 | mixed_lens: 91.0000 | lr: 3.3724e-06 | scale: 1024.00 | time: 26.804 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/2000
                                 Evaluation #20                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son las partículas que se │
│                                       │ encuentran en el bosón de Higgs, que │
│                                       │ tiene la autoridad de convertir los  │
│                                       │ electrones en positrones. Los cuarks │
│                                       │ tienen dos tipos: el cuarkUp y el    │
│                                       │ cuarkDown. Cuantos los ayuda a       │
│                                       │ convertir los electrones en          │
│                                       │ positrones, los cuarksDown.          │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es el acrónimo de "Instituto  │
│                                       │ de Medición de Calidad". Se trata de │
│                                       │ un organismo autónomo dependiente de │
│                                       │ la Secretaría de Estado para la      │
│                                       │ Investigación, Desarrollo e          │
│                                       │ Innovación. La misión del IMC es     │
│                                       │ garantizar la calidad de los         │
│                                       │ productos y servicios médicos en     │
│                                       │ España mediante la creación de un    │
│                                       │ registro nacional de las             │
│                                       │ calificaciones de los profesionales  │
│                                       │ de la atención sanitaria.            │
│                                       │                                      │
│                                       │ El IMC fue creado en 2003 con el     │
│                                       │ objetivo de garantizar la calidad de │
│                                       │ los product                          │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ * Cápsulas del tiempo de los años    │
│                                       │ 1960:                                │
│                                       │   * Cápsula del tiempo de los años   │
│                                       │ 1960: 1960, 1961, 1962, 1963, 1964,  │
│                                       │ 1965, 1966, 1967, 1968, 1969         │
│                                       │ * Cápsulas del tiempo de los años    │
│                                       │ 1970:                                │
│                                       │   * Cápsula del tiempo de los años   │
│                                       │ 1970:                                │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.296 | exact_match: 0.000 | rev_kl: 0.883 | lens: 99.208 | pt_loss: 1.737 | lm_loss: 1.866 | kd_loss: 1.608 
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2000/  5000| tot_loss: 2.0042 | rl_loss: 1.0619 | pt_loss: 0.9423 | pg_loss: 0.1949 | reg_loss: 0.8670 | reward: -0.1804 | rev_kl: 1.5563 | stu_lens: 128.0000 | mixed_lens: 108.0000 | lr: 3.3709e-06 | scale: 1024.00 | time: 26.782 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2000/  5000| tot_loss: 2.8735 | rl_loss: 1.1395 | pt_loss: 1.7340 | pg_loss: 0.2859 | reg_loss: 0.8535 | reward: -0.3943 | rev_kl: 0.9111 | stu_lens: 92.7344 | mixed_lens: 92.0000 | lr: 3.3709e-06 | scale: 1024.00 | time: 26.782 | step time: 28.086
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2001/  5000| tot_loss: 2.7875 | rl_loss: 0.9350 | pt_loss: 1.8525 | pg_loss: 0.2727 | reg_loss: 0.6623 | reward: -0.3509 | rev_kl: 0.8651 | stu_lens: 128.0000 | mixed_lens: 98.5000 | lr: 3.3694e-06 | scale: 1024.00 | time: 26.846 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2002/  5000| tot_loss: 2.1879 | rl_loss: 0.6502 | pt_loss: 1.5377 | pg_loss: 0.0670 | reg_loss: 0.5832 | reward: -0.1799 | rev_kl: 0.7200 | stu_lens: 112.0000 | mixed_lens: 97.5000 | lr: 3.3679e-06 | scale: 1024.00 | time: 26.762 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2003/  5000| tot_loss: 2.7140 | rl_loss: 0.7753 | pt_loss: 1.9387 | pg_loss: -0.0097 | reg_loss: 0.7850 | reward: -0.3262 | rev_kl: 0.8406 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.3664e-06 | scale: 1024.00 | time: 26.786 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2004/  5000| tot_loss: 2.4740 | rl_loss: 0.8319 | pt_loss: 1.6421 | pg_loss: 0.1113 | reg_loss: 0.7205 | reward: -0.3225 | rev_kl: 1.1585 | stu_lens: 128.0000 | mixed_lens: 80.5000 | lr: 3.3649e-06 | scale: 1024.00 | time: 26.820 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2005/  5000| tot_loss: 2.3213 | rl_loss: 0.7600 | pt_loss: 1.5613 | pg_loss: 0.2313 | reg_loss: 0.5287 | reward: -0.3606 | rev_kl: 1.0509 | stu_lens: 77.5000 | mixed_lens: 99.0000 | lr: 3.3634e-06 | scale: 1024.00 | time: 26.776 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2006/  5000| tot_loss: 2.5165 | rl_loss: 0.9567 | pt_loss: 1.5598 | pg_loss: 0.3533 | reg_loss: 0.6034 | reward: -1.3329 | rev_kl: 1.1675 | stu_lens: 66.5000 | mixed_lens: 66.5000 | lr: 3.3619e-06 | scale: 1024.00 | time: 26.792 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2007/  5000| tot_loss: 2.2734 | rl_loss: 0.6373 | pt_loss: 1.6360 | pg_loss: 0.0821 | reg_loss: 0.5552 | reward: -0.4277 | rev_kl: 0.3102 | stu_lens: 128.0000 | mixed_lens: 102.5000 | lr: 3.3604e-06 | scale: 1024.00 | time: 26.770 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2008/  5000| tot_loss: 2.3255 | rl_loss: 0.7814 | pt_loss: 1.5441 | pg_loss: 0.1151 | reg_loss: 0.6662 | reward: -0.1310 | rev_kl: 1.4673 | stu_lens: 89.5000 | mixed_lens: 112.5000 | lr: 3.3589e-06 | scale: 1024.00 | time: 26.799 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2009/  5000| tot_loss: 2.9029 | rl_loss: 0.9005 | pt_loss: 2.0024 | pg_loss: 0.3100 | reg_loss: 0.5905 | reward: -0.1774 | rev_kl: 0.6952 | stu_lens: 74.5000 | mixed_lens: 81.5000 | lr: 3.3574e-06 | scale: 1024.00 | time: 26.762 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2010/  5000| tot_loss: 3.0680 | rl_loss: 1.1703 | pt_loss: 1.8976 | pg_loss: 0.4485 | reg_loss: 0.7218 | reward: -0.3771 | rev_kl: 0.9383 | stu_lens: 115.0000 | mixed_lens: 80.5000 | lr: 3.3559e-06 | scale: 1024.00 | time: 26.806 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2011/  5000| tot_loss: 2.0916 | rl_loss: 0.4329 | pt_loss: 1.6587 | pg_loss: -0.0124 | reg_loss: 0.4453 | reward: -0.1403 | rev_kl: 0.8883 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.3544e-06 | scale: 1024.00 | time: 26.780 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2012/  5000| tot_loss: 2.0892 | rl_loss: 0.4869 | pt_loss: 1.6023 | pg_loss: 0.0678 | reg_loss: 0.4190 | reward: -0.0179 | rev_kl: 0.7592 | stu_lens: 78.0000 | mixed_lens: 112.0000 | lr: 3.3529e-06 | scale: 1024.00 | time: 26.788 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2013/  5000| tot_loss: 2.8278 | rl_loss: 1.2798 | pt_loss: 1.5480 | pg_loss: 0.5935 | reg_loss: 0.6863 | reward: -0.6438 | rev_kl: 0.7165 | stu_lens: 33.0000 | mixed_lens: 55.5000 | lr: 3.3514e-06 | scale: 1024.00 | time: 26.799 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2014/  5000| tot_loss: 2.7063 | rl_loss: 0.8486 | pt_loss: 1.8578 | pg_loss: 0.1625 | reg_loss: 0.6861 | reward: -0.4896 | rev_kl: 0.8968 | stu_lens: 109.5000 | mixed_lens: 85.5000 | lr: 3.3499e-06 | scale: 1024.00 | time: 26.814 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2015/  5000| tot_loss: 1.8829 | rl_loss: 0.2682 | pt_loss: 1.6148 | pg_loss: 0.0267 | reg_loss: 0.2415 | reward: -0.2243 | rev_kl: 1.0084 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.3484e-06 | scale: 1024.00 | time: 26.805 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2016/  5000| tot_loss: 2.4368 | rl_loss: 0.7045 | pt_loss: 1.7323 | pg_loss: 0.0130 | reg_loss: 0.6915 | reward: -0.1213 | rev_kl: 1.1805 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.3468e-06 | scale: 1024.00 | time: 26.825 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2016/  5000| tot_loss: 2.5479 | rl_loss: 0.8130 | pt_loss: 1.7349 | pg_loss: 0.2237 | reg_loss: 0.5893 | reward: -0.4334 | rev_kl: 0.9137 | stu_lens: 92.6250 | mixed_lens: 88.7969 | lr: 3.3468e-06 | scale: 1024.00 | time: 26.825 | step time: 28.082
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2017/  5000| tot_loss: 2.1682 | rl_loss: 0.5957 | pt_loss: 1.5725 | pg_loss: 0.0130 | reg_loss: 0.5827 | reward: -0.2282 | rev_kl: 1.0688 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.3453e-06 | scale: 1024.00 | time: 26.772 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2018/  5000| tot_loss: 2.3110 | rl_loss: 0.4084 | pt_loss: 1.9026 | pg_loss: 0.2015 | reg_loss: 0.2069 | reward: -0.2123 | rev_kl: 0.7248 | stu_lens: 74.5000 | mixed_lens: 81.5000 | lr: 3.3438e-06 | scale: 1024.00 | time: 26.813 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2019/  5000| tot_loss: 2.1193 | rl_loss: 0.4966 | pt_loss: 1.6227 | pg_loss: 0.1471 | reg_loss: 0.3495 | reward: -0.0821 | rev_kl: 0.9679 | stu_lens: 98.0000 | mixed_lens: 89.5000 | lr: 3.3423e-06 | scale: 1024.00 | time: 26.805 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2020/  5000| tot_loss: 1.9147 | rl_loss: 0.3799 | pt_loss: 1.5347 | pg_loss: -0.0023 | reg_loss: 0.3822 | reward: -0.1779 | rev_kl: 1.1185 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.3408e-06 | scale: 1024.00 | time: 26.866 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2021/  5000| tot_loss: 2.1082 | rl_loss: -0.0248 | pt_loss: 2.1330 | pg_loss: -0.4388 | reg_loss: 0.4140 | reward: -0.1235 | rev_kl: 1.1245 | stu_lens: 128.0000 | mixed_lens: 28.0000 | lr: 3.3393e-06 | scale: 1024.00 | time: 26.851 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2022/  5000| tot_loss: 2.1574 | rl_loss: 0.6541 | pt_loss: 1.5032 | pg_loss: -0.0050 | reg_loss: 0.6592 | reward: -0.3073 | rev_kl: 0.9003 | stu_lens: 108.5000 | mixed_lens: 128.0000 | lr: 3.3378e-06 | scale: 1024.00 | time: 26.848 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2023/  5000| tot_loss: 2.5771 | rl_loss: 0.7243 | pt_loss: 1.8528 | pg_loss: 0.1900 | reg_loss: 0.5343 | reward: -0.3601 | rev_kl: 0.7488 | stu_lens: 76.0000 | mixed_lens: 91.0000 | lr: 3.3363e-06 | scale: 1024.00 | time: 26.801 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2024/  5000| tot_loss: 2.2173 | rl_loss: 0.5801 | pt_loss: 1.6372 | pg_loss: 0.1114 | reg_loss: 0.4687 | reward: -0.1310 | rev_kl: 1.4673 | stu_lens: 89.5000 | mixed_lens: 112.5000 | lr: 3.3348e-06 | scale: 1024.00 | time: 26.813 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2025/  5000| tot_loss: 2.5176 | rl_loss: 0.5873 | pt_loss: 1.9304 | pg_loss: 0.1167 | reg_loss: 0.4706 | reward: -0.1074 | rev_kl: 0.9737 | stu_lens: 56.0000 | mixed_lens: 112.0000 | lr: 3.3333e-06 | scale: 1024.00 | time: 26.804 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2026/  5000| tot_loss: 2.2209 | rl_loss: 0.6655 | pt_loss: 1.5554 | pg_loss: 0.0826 | reg_loss: 0.5829 | reward: -0.2651 | rev_kl: 1.8048 | stu_lens: 128.0000 | mixed_lens: 108.0000 | lr: 3.3317e-06 | scale: 1024.00 | time: 26.827 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2027/  5000| tot_loss: 2.6667 | rl_loss: 0.8968 | pt_loss: 1.7699 | pg_loss: 0.3601 | reg_loss: 0.5367 | reward: -0.5911 | rev_kl: 0.6305 | stu_lens: 75.5000 | mixed_lens: 90.0000 | lr: 3.3302e-06 | scale: 1024.00 | time: 26.772 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2028/  5000| tot_loss: 2.0633 | rl_loss: 0.5209 | pt_loss: 1.5423 | pg_loss: 0.1809 | reg_loss: 0.3400 | reward: -0.2483 | rev_kl: 0.4321 | stu_lens: 128.0000 | mixed_lens: 84.5000 | lr: 3.3287e-06 | scale: 1024.00 | time: 26.796 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2029/  5000| tot_loss: 2.4243 | rl_loss: 0.7079 | pt_loss: 1.7164 | pg_loss: 0.2982 | reg_loss: 0.4097 | reward: -0.6250 | rev_kl: 0.7791 | stu_lens: 73.5000 | mixed_lens: 59.0000 | lr: 3.3272e-06 | scale: 1024.00 | time: 26.775 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2030/  5000| tot_loss: 2.0543 | rl_loss: 0.7392 | pt_loss: 1.3151 | pg_loss: 0.3905 | reg_loss: 0.3487 | reward: -1.3632 | rev_kl: 1.3418 | stu_lens: 44.0000 | mixed_lens: 66.5000 | lr: 3.3257e-06 | scale: 1024.00 | time: 26.804 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2031/  5000| tot_loss: 1.5654 | rl_loss: 0.5175 | pt_loss: 1.0479 | pg_loss: 0.1970 | reg_loss: 0.3205 | reward: -0.1441 | rev_kl: 0.6587 | stu_lens: 112.0000 | mixed_lens: 77.0000 | lr: 3.3242e-06 | scale: 1024.00 | time: 26.777 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2032/  5000| tot_loss: 2.2979 | rl_loss: 0.6850 | pt_loss: 1.6129 | pg_loss: 0.1468 | reg_loss: 0.5382 | reward: -0.3916 | rev_kl: 0.6449 | stu_lens: 128.0000 | mixed_lens: 102.5000 | lr: 3.3227e-06 | scale: 1024.00 | time: 26.943 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2032/  5000| tot_loss: 2.3019 | rl_loss: 0.6148 | pt_loss: 1.6871 | pg_loss: 0.1804 | reg_loss: 0.4344 | reward: -0.3893 | rev_kl: 0.9378 | stu_lens: 97.1562 | mixed_lens: 94.1719 | lr: 3.3227e-06 | scale: 1024.00 | time: 26.943 | step time: 28.101
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2033/  5000| tot_loss: 2.8039 | rl_loss: 1.0738 | pt_loss: 1.7301 | pg_loss: 0.5477 | reg_loss: 0.5261 | reward: -0.3985 | rev_kl: 0.9278 | stu_lens: 42.0000 | mixed_lens: 50.5000 | lr: 3.3212e-06 | scale: 1024.00 | time: 26.793 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2034/  5000| tot_loss: 1.7898 | rl_loss: 0.2840 | pt_loss: 1.5059 | pg_loss: 0.1335 | reg_loss: 0.1504 | reward: -0.1607 | rev_kl: 0.4182 | stu_lens: 89.5000 | mixed_lens: 92.0000 | lr: 3.3196e-06 | scale: 1024.00 | time: 26.839 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2035/  5000| tot_loss: 2.7048 | rl_loss: 0.9936 | pt_loss: 1.7112 | pg_loss: 0.7021 | reg_loss: 0.2915 | reward: -0.3713 | rev_kl: 0.9997 | stu_lens: 49.5000 | mixed_lens: 53.0000 | lr: 3.3181e-06 | scale: 1024.00 | time: 26.787 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2036/  5000| tot_loss: 1.9452 | rl_loss: 0.5420 | pt_loss: 1.4032 | pg_loss: 0.3509 | reg_loss: 0.1911 | reward: -0.4079 | rev_kl: 0.8125 | stu_lens: 26.0000 | mixed_lens: 37.5000 | lr: 3.3166e-06 | scale: 1024.00 | time: 26.865 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2037/  5000| tot_loss: 2.0227 | rl_loss: 0.4460 | pt_loss: 1.5767 | pg_loss: 0.0211 | reg_loss: 0.4249 | reward: 0.0001 | rev_kl: 1.0057 | stu_lens: 128.0000 | mixed_lens: 74.5000 | lr: 3.3151e-06 | scale: 1024.00 | time: 26.776 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2038/  5000| tot_loss: 2.1184 | rl_loss: 0.5305 | pt_loss: 1.5879 | pg_loss: 0.1900 | reg_loss: 0.3405 | reward: -0.4185 | rev_kl: 0.8729 | stu_lens: 73.5000 | mixed_lens: 95.0000 | lr: 3.3136e-06 | scale: 1024.00 | time: 26.853 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2039/  5000| tot_loss: 2.0526 | rl_loss: 0.7578 | pt_loss: 1.2948 | pg_loss: 0.5188 | reg_loss: 0.2390 | reward: -0.6418 | rev_kl: 0.3742 | stu_lens: 49.5000 | mixed_lens: 78.5000 | lr: 3.3121e-06 | scale: 1024.00 | time: 26.831 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2040/  5000| tot_loss: 2.0625 | rl_loss: 0.4407 | pt_loss: 1.6218 | pg_loss: 0.0871 | reg_loss: 0.3536 | reward: -0.2419 | rev_kl: 0.7092 | stu_lens: 128.0000 | mixed_lens: 101.0000 | lr: 3.3106e-06 | scale: 1024.00 | time: 26.862 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2041/  5000| tot_loss: 2.1240 | rl_loss: 0.2820 | pt_loss: 1.8421 | pg_loss: -0.0959 | reg_loss: 0.3779 | reward: -0.2841 | rev_kl: 0.8262 | stu_lens: 74.5000 | mixed_lens: 35.0000 | lr: 3.3090e-06 | scale: 1024.00 | time: 26.832 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2042/  5000| tot_loss: 2.5503 | rl_loss: 0.5184 | pt_loss: 2.0319 | pg_loss: 0.1521 | reg_loss: 0.3663 | reward: -0.8540 | rev_kl: 2.1411 | stu_lens: 66.0000 | mixed_lens: 72.0000 | lr: 3.3075e-06 | scale: 1024.00 | time: 26.850 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2043/  5000| tot_loss: 1.7920 | rl_loss: 0.4006 | pt_loss: 1.3914 | pg_loss: -0.0063 | reg_loss: 0.4069 | reward: -0.1260 | rev_kl: 0.9171 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.3060e-06 | scale: 1024.00 | time: 26.775 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2044/  5000| tot_loss: 2.3595 | rl_loss: 0.4630 | pt_loss: 1.8965 | pg_loss: 0.0392 | reg_loss: 0.4239 | reward: -0.0974 | rev_kl: 0.9751 | stu_lens: 128.0000 | mixed_lens: 119.5000 | lr: 3.3045e-06 | scale: 1024.00 | time: 27.100 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2045/  5000| tot_loss: 1.9101 | rl_loss: 0.3500 | pt_loss: 1.5601 | pg_loss: 0.1022 | reg_loss: 0.2478 | reward: -0.1835 | rev_kl: 0.5762 | stu_lens: 107.5000 | mixed_lens: 112.0000 | lr: 3.3030e-06 | scale: 1024.00 | time: 26.801 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2046/  5000| tot_loss: 2.4585 | rl_loss: 0.5364 | pt_loss: 1.9221 | pg_loss: 0.1698 | reg_loss: 0.3666 | reward: -0.1201 | rev_kl: 1.4434 | stu_lens: 89.5000 | mixed_lens: 96.0000 | lr: 3.3014e-06 | scale: 1024.00 | time: 26.818 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2047/  5000| tot_loss: 2.6470 | rl_loss: 0.7583 | pt_loss: 1.8886 | pg_loss: 0.3576 | reg_loss: 0.4007 | reward: -0.5593 | rev_kl: 0.5765 | stu_lens: 75.5000 | mixed_lens: 80.0000 | lr: 3.2999e-06 | scale: 1024.00 | time: 26.941 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2048/  5000| tot_loss: 2.3735 | rl_loss: 0.7098 | pt_loss: 1.6637 | pg_loss: 0.4822 | reg_loss: 0.2276 | reward: -0.7312 | rev_kl: 0.7773 | stu_lens: 52.5000 | mixed_lens: 42.0000 | lr: 3.2984e-06 | scale: 1024.00 | time: 26.811 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2048/  5000| tot_loss: 2.2467 | rl_loss: 0.5434 | pt_loss: 1.7033 | pg_loss: 0.1943 | reg_loss: 0.3491 | reward: -0.4277 | rev_kl: 0.9067 | stu_lens: 90.5312 | mixed_lens: 87.9688 | lr: 3.2984e-06 | scale: 1024.00 | time: 26.811 | step time: 28.128
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2049/  5000| tot_loss: 2.4907 | rl_loss: 0.5187 | pt_loss: 1.9720 | pg_loss: 0.1382 | reg_loss: 0.3805 | reward: -0.2274 | rev_kl: 1.2015 | stu_lens: 115.0000 | mixed_lens: 110.0000 | lr: 3.2969e-06 | scale: 1024.00 | time: 26.761 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2050/  5000| tot_loss: 2.3897 | rl_loss: 0.8504 | pt_loss: 1.5393 | pg_loss: 0.0818 | reg_loss: 0.7686 | reward: -0.1148 | rev_kl: 0.7043 | stu_lens: 102.5000 | mixed_lens: 128.0000 | lr: 3.2954e-06 | scale: 1024.00 | time: 26.808 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2051/  5000| tot_loss: 3.5895 | rl_loss: 1.9407 | pt_loss: 1.6488 | pg_loss: 0.8206 | reg_loss: 1.1201 | reward: -0.7257 | rev_kl: 0.7389 | stu_lens: 31.5000 | mixed_lens: 48.5000 | lr: 3.2939e-06 | scale: 1024.00 | time: 26.810 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2052/  5000| tot_loss: 2.8229 | rl_loss: 1.1637 | pt_loss: 1.6593 | pg_loss: 0.1265 | reg_loss: 1.0372 | reward: -0.1147 | rev_kl: 1.2344 | stu_lens: 81.0000 | mixed_lens: 119.0000 | lr: 3.2923e-06 | scale: 1024.00 | time: 26.742 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2053/  5000| tot_loss: 2.9180 | rl_loss: 1.1125 | pt_loss: 1.8055 | pg_loss: 0.1707 | reg_loss: 0.9418 | reward: -0.0624 | rev_kl: 0.5458 | stu_lens: 87.0000 | mixed_lens: 84.0000 | lr: 3.2908e-06 | scale: 1024.00 | time: 26.756 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2054/  5000| tot_loss: 2.5962 | rl_loss: 0.6458 | pt_loss: 1.9505 | pg_loss: 0.0226 | reg_loss: 0.6231 | reward: -0.3150 | rev_kl: 1.0318 | stu_lens: 40.5000 | mixed_lens: 128.0000 | lr: 3.2893e-06 | scale: 1024.00 | time: 26.759 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2055/  5000| tot_loss: 2.7236 | rl_loss: 1.2953 | pt_loss: 1.4283 | pg_loss: 0.5297 | reg_loss: 0.7656 | reward: -0.7055 | rev_kl: 0.9215 | stu_lens: 75.0000 | mixed_lens: 72.0000 | lr: 3.2878e-06 | scale: 1024.00 | time: 26.788 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2056/  5000| tot_loss: 3.2808 | rl_loss: 1.3190 | pt_loss: 1.9618 | pg_loss: 0.2358 | reg_loss: 1.0832 | reward: -0.3891 | rev_kl: 0.8965 | stu_lens: 88.0000 | mixed_lens: 101.0000 | lr: 3.2862e-06 | scale: 1024.00 | time: 26.786 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2057/  5000| tot_loss: 3.5135 | rl_loss: 1.6938 | pt_loss: 1.8197 | pg_loss: 0.8270 | reg_loss: 0.8669 | reward: -0.4874 | rev_kl: 0.5479 | stu_lens: 128.0000 | mixed_lens: 63.0000 | lr: 3.2847e-06 | scale: 1024.00 | time: 26.966 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2058/  5000| tot_loss: 3.8329 | rl_loss: 1.8374 | pt_loss: 1.9955 | pg_loss: 0.7894 | reg_loss: 1.0480 | reward: -0.7957 | rev_kl: 0.9243 | stu_lens: 69.5000 | mixed_lens: 43.0000 | lr: 3.2832e-06 | scale: 1024.00 | time: 26.787 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2059/  5000| tot_loss: 3.4196 | rl_loss: 1.6727 | pt_loss: 1.7469 | pg_loss: 1.3215 | reg_loss: 0.3512 | reward: -0.3921 | rev_kl: 3.0516 | stu_lens: 30.0000 | mixed_lens: 24.5000 | lr: 3.2817e-06 | scale: 1024.00 | time: 26.816 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2060/  5000| tot_loss: 2.5000 | rl_loss: 0.9667 | pt_loss: 1.5333 | pg_loss: 0.0621 | reg_loss: 0.9046 | reward: -0.2580 | rev_kl: 0.4459 | stu_lens: 128.0000 | mixed_lens: 126.5000 | lr: 3.2802e-06 | scale: 1024.00 | time: 26.760 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2061/  5000| tot_loss: 2.9036 | rl_loss: 1.3399 | pt_loss: 1.5637 | pg_loss: 0.4759 | reg_loss: 0.8640 | reward: -0.2766 | rev_kl: 0.7999 | stu_lens: 90.5000 | mixed_lens: 82.5000 | lr: 3.2786e-06 | scale: 1024.00 | time: 26.793 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2062/  5000| tot_loss: 2.4978 | rl_loss: 0.9328 | pt_loss: 1.5650 | pg_loss: 0.1858 | reg_loss: 0.7471 | reward: -0.1401 | rev_kl: 0.9164 | stu_lens: 90.0000 | mixed_lens: 98.5000 | lr: 3.2771e-06 | scale: 1024.00 | time: 26.792 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2063/  5000| tot_loss: 4.2793 | rl_loss: 1.7736 | pt_loss: 2.5057 | pg_loss: 0.6438 | reg_loss: 1.1298 | reward: -0.0396 | rev_kl: 0.6205 | stu_lens: 79.5000 | mixed_lens: 67.0000 | lr: 3.2756e-06 | scale: 1024.00 | time: 26.838 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2064/  5000| tot_loss: 3.5536 | rl_loss: 1.4373 | pt_loss: 2.1163 | pg_loss: 0.4399 | reg_loss: 0.9974 | reward: -1.3674 | rev_kl: 0.8438 | stu_lens: 75.5000 | mixed_lens: 68.0000 | lr: 3.2741e-06 | scale: 1024.00 | time: 26.821 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2064/  5000| tot_loss: 2.9797 | rl_loss: 1.2036 | pt_loss: 1.7761 | pg_loss: 0.3797 | reg_loss: 0.8239 | reward: -0.3218 | rev_kl: 0.9012 | stu_lens: 86.8750 | mixed_lens: 84.9844 | lr: 3.2741e-06 | scale: 1024.00 | time: 26.821 | step time: 28.080
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2065/  5000| tot_loss: 2.8834 | rl_loss: 1.0717 | pt_loss: 1.8117 | pg_loss: 0.2176 | reg_loss: 0.8541 | reward: -0.5142 | rev_kl: 1.0409 | stu_lens: 74.5000 | mixed_lens: 88.5000 | lr: 3.2725e-06 | scale: 1024.00 | time: 26.829 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2066/  5000| tot_loss: 2.6162 | rl_loss: 1.0739 | pt_loss: 1.5423 | pg_loss: 0.3821 | reg_loss: 0.6918 | reward: -0.3649 | rev_kl: 0.9073 | stu_lens: 128.0000 | mixed_lens: 85.5000 | lr: 3.2710e-06 | scale: 1024.00 | time: 26.798 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2067/  5000| tot_loss: 2.9824 | rl_loss: 1.2435 | pt_loss: 1.7389 | pg_loss: 0.5806 | reg_loss: 0.6629 | reward: -0.3273 | rev_kl: 0.9814 | stu_lens: 61.5000 | mixed_lens: 73.5000 | lr: 3.2695e-06 | scale: 1024.00 | time: 26.829 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2068/  5000| tot_loss: 3.2076 | rl_loss: 0.9043 | pt_loss: 2.3033 | pg_loss: 0.4539 | reg_loss: 0.4504 | reward: -0.1591 | rev_kl: 0.6264 | stu_lens: 36.5000 | mixed_lens: 73.5000 | lr: 3.2680e-06 | scale: 1024.00 | time: 26.794 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2069/  5000| tot_loss: 2.6286 | rl_loss: 1.1028 | pt_loss: 1.5258 | pg_loss: 0.5262 | reg_loss: 0.5766 | reward: -1.3665 | rev_kl: 0.9140 | stu_lens: 55.0000 | mixed_lens: 47.0000 | lr: 3.2664e-06 | scale: 1024.00 | time: 26.842 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2070/  5000| tot_loss: 2.2796 | rl_loss: 0.6588 | pt_loss: 1.6208 | pg_loss: -0.0076 | reg_loss: 0.6664 | reward: -0.1431 | rev_kl: 0.6639 | stu_lens: 128.0000 | mixed_lens: 125.5000 | lr: 3.2649e-06 | scale: 1024.00 | time: 26.797 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2071/  5000| tot_loss: 2.6179 | rl_loss: 1.1788 | pt_loss: 1.4391 | pg_loss: 0.5224 | reg_loss: 0.6564 | reward: -0.5679 | rev_kl: 0.9711 | stu_lens: 74.5000 | mixed_lens: 77.5000 | lr: 3.2634e-06 | scale: 1024.00 | time: 26.785 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2072/  5000| tot_loss: 2.1357 | rl_loss: 0.6753 | pt_loss: 1.4603 | pg_loss: 0.2365 | reg_loss: 0.4389 | reward: -0.1006 | rev_kl: 0.7399 | stu_lens: 71.5000 | mixed_lens: 39.0000 | lr: 3.2619e-06 | scale: 1024.00 | time: 26.785 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2073/  5000| tot_loss: 2.3760 | rl_loss: 0.7738 | pt_loss: 1.6022 | pg_loss: 0.0080 | reg_loss: 0.7658 | reward: -0.1920 | rev_kl: 1.4727 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.2603e-06 | scale: 1024.00 | time: 26.789 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2074/  5000| tot_loss: 2.4318 | rl_loss: 0.6573 | pt_loss: 1.7745 | pg_loss: 0.2608 | reg_loss: 0.3965 | reward: -0.0095 | rev_kl: 0.4098 | stu_lens: 79.5000 | mixed_lens: 67.0000 | lr: 3.2588e-06 | scale: 1024.00 | time: 26.776 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2075/  5000| tot_loss: 2.1377 | rl_loss: 0.5849 | pt_loss: 1.5528 | pg_loss: 0.2559 | reg_loss: 0.3290 | reward: -0.4579 | rev_kl: 0.8551 | stu_lens: 128.0000 | mixed_lens: 76.0000 | lr: 3.2573e-06 | scale: 1024.00 | time: 26.815 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2076/  5000| tot_loss: 2.2908 | rl_loss: 0.6106 | pt_loss: 1.6803 | pg_loss: 0.1509 | reg_loss: 0.4597 | reward: -0.2618 | rev_kl: 0.6067 | stu_lens: 113.0000 | mixed_lens: 102.0000 | lr: 3.2558e-06 | scale: 1024.00 | time: 26.789 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2077/  5000| tot_loss: 2.0785 | rl_loss: 0.7921 | pt_loss: 1.2864 | pg_loss: 0.1784 | reg_loss: 0.6137 | reward: -0.1504 | rev_kl: 0.8326 | stu_lens: 54.5000 | mixed_lens: 74.5000 | lr: 3.2542e-06 | scale: 1024.00 | time: 26.841 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2078/  5000| tot_loss: 3.0842 | rl_loss: 0.9851 | pt_loss: 2.0992 | pg_loss: 0.2307 | reg_loss: 0.7544 | reward: -0.5109 | rev_kl: 0.6911 | stu_lens: 44.5000 | mixed_lens: 79.5000 | lr: 3.2527e-06 | scale: 1024.00 | time: 26.954 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2079/  5000| tot_loss: 2.1726 | rl_loss: 0.3109 | pt_loss: 1.8617 | pg_loss: -0.0092 | reg_loss: 0.3201 | reward: -0.1847 | rev_kl: 1.3040 | stu_lens: 70.0000 | mixed_lens: 128.0000 | lr: 3.2512e-06 | scale: 1024.00 | time: 26.825 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2080/  5000| tot_loss: 2.9307 | rl_loss: 1.1320 | pt_loss: 1.7986 | pg_loss: 0.4383 | reg_loss: 0.6937 | reward: -0.0590 | rev_kl: 0.3293 | stu_lens: 26.0000 | mixed_lens: 57.5000 | lr: 3.2496e-06 | scale: 1024.00 | time: 26.766 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2080/  5000| tot_loss: 2.5609 | rl_loss: 0.8675 | pt_loss: 1.6934 | pg_loss: 0.2456 | reg_loss: 0.6219 | reward: -0.3348 | rev_kl: 0.8390 | stu_lens: 84.7812 | mixed_lens: 85.6094 | lr: 3.2496e-06 | scale: 1024.00 | time: 26.766 | step time: 28.087
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2081/  5000| tot_loss: 3.0526 | rl_loss: 1.0880 | pt_loss: 1.9646 | pg_loss: 0.3729 | reg_loss: 0.7151 | reward: -0.1726 | rev_kl: 3.3575 | stu_lens: 90.0000 | mixed_lens: 79.0000 | lr: 3.2481e-06 | scale: 1024.00 | time: 26.825 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2082/  5000| tot_loss: 2.6257 | rl_loss: 0.6852 | pt_loss: 1.9405 | pg_loss: 0.1436 | reg_loss: 0.5416 | reward: -0.2338 | rev_kl: 0.8818 | stu_lens: 90.0000 | mixed_lens: 98.5000 | lr: 3.2466e-06 | scale: 1024.00 | time: 26.808 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2083/  5000| tot_loss: 1.9545 | rl_loss: 0.5897 | pt_loss: 1.3648 | pg_loss: 0.3502 | reg_loss: 0.2395 | reward: -0.2817 | rev_kl: 0.5951 | stu_lens: 78.5000 | mixed_lens: 74.0000 | lr: 3.2451e-06 | scale: 1024.00 | time: 26.796 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2084/  5000| tot_loss: 2.6143 | rl_loss: 0.7694 | pt_loss: 1.8449 | pg_loss: 0.2295 | reg_loss: 0.5399 | reward: -0.1716 | rev_kl: 1.4938 | stu_lens: 86.0000 | mixed_lens: 95.0000 | lr: 3.2435e-06 | scale: 1024.00 | time: 26.830 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2085/  5000| tot_loss: 3.3050 | rl_loss: 1.3363 | pt_loss: 1.9686 | pg_loss: 0.9468 | reg_loss: 0.3896 | reward: -0.3875 | rev_kl: 0.2859 | stu_lens: 53.0000 | mixed_lens: 47.5000 | lr: 3.2420e-06 | scale: 1024.00 | time: 26.854 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2086/  5000| tot_loss: 2.2958 | rl_loss: 0.5474 | pt_loss: 1.7483 | pg_loss: 0.2087 | reg_loss: 0.3388 | reward: -0.1682 | rev_kl: 0.7145 | stu_lens: 105.0000 | mixed_lens: 91.0000 | lr: 3.2405e-06 | scale: 1024.00 | time: 26.915 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2087/  5000| tot_loss: 2.3104 | rl_loss: 0.9469 | pt_loss: 1.3635 | pg_loss: 0.4574 | reg_loss: 0.4895 | reward: -0.3535 | rev_kl: 0.5546 | stu_lens: 128.0000 | mixed_lens: 76.0000 | lr: 3.2389e-06 | scale: 1024.00 | time: 26.855 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2088/  5000| tot_loss: 2.1869 | rl_loss: 0.6238 | pt_loss: 1.5631 | pg_loss: 0.2027 | reg_loss: 0.4211 | reward: -0.5246 | rev_kl: 1.6223 | stu_lens: 68.0000 | mixed_lens: 95.0000 | lr: 3.2374e-06 | scale: 1024.00 | time: 26.871 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2089/  5000| tot_loss: 1.4286 | rl_loss: 0.1593 | pt_loss: 1.2692 | pg_loss: 0.0340 | reg_loss: 0.1253 | reward: -0.1293 | rev_kl: 0.8314 | stu_lens: 29.0000 | mixed_lens: 86.5000 | lr: 3.2359e-06 | scale: 1024.00 | time: 26.878 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2090/  5000| tot_loss: 2.0020 | rl_loss: 0.4569 | pt_loss: 1.5451 | pg_loss: -0.0169 | reg_loss: 0.4738 | reward: -0.2010 | rev_kl: 0.6022 | stu_lens: 88.0000 | mixed_lens: 128.0000 | lr: 3.2343e-06 | scale: 1024.00 | time: 26.879 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2091/  5000| tot_loss: 2.7143 | rl_loss: 1.0831 | pt_loss: 1.6312 | pg_loss: 0.9754 | reg_loss: 0.1077 | reward: -1.3690 | rev_kl: 3.4440 | stu_lens: 37.5000 | mixed_lens: 19.0000 | lr: 3.2328e-06 | scale: 1024.00 | time: 26.847 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2092/  5000| tot_loss: 2.1252 | rl_loss: 0.5943 | pt_loss: 1.5308 | pg_loss: 0.1839 | reg_loss: 0.4104 | reward: -0.0528 | rev_kl: 0.9708 | stu_lens: 57.0000 | mixed_lens: 93.5000 | lr: 3.2313e-06 | scale: 1024.00 | time: 26.818 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2093/  5000| tot_loss: 2.3806 | rl_loss: 0.3825 | pt_loss: 1.9982 | pg_loss: 0.0032 | reg_loss: 0.3793 | reward: -0.2115 | rev_kl: 0.6182 | stu_lens: 98.5000 | mixed_lens: 128.0000 | lr: 3.2297e-06 | scale: 1024.00 | time: 26.856 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2094/  5000| tot_loss: 2.3112 | rl_loss: 0.2263 | pt_loss: 2.0848 | pg_loss: -0.3970 | reg_loss: 0.6233 | reward: 0.3585 | rev_kl: 0.3467 | stu_lens: 62.0000 | mixed_lens: 15.5000 | lr: 3.2282e-06 | scale: 1024.00 | time: 26.883 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2095/  5000| tot_loss: 2.8643 | rl_loss: 0.6777 | pt_loss: 2.1866 | pg_loss: 0.3479 | reg_loss: 0.3299 | reward: -0.0621 | rev_kl: 0.3648 | stu_lens: 66.5000 | mixed_lens: 66.5000 | lr: 3.2267e-06 | scale: 1024.00 | time: 26.836 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2096/  5000| tot_loss: 2.0977 | rl_loss: 0.3547 | pt_loss: 1.7430 | pg_loss: 0.0041 | reg_loss: 0.3506 | reward: -0.2051 | rev_kl: 1.1159 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.2251e-06 | scale: 1024.00 | time: 26.825 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2096/  5000| tot_loss: 2.4215 | rl_loss: 0.7048 | pt_loss: 1.7166 | pg_loss: 0.2692 | reg_loss: 0.4356 | reward: -0.3080 | rev_kl: 0.9871 | stu_lens: 86.5156 | mixed_lens: 85.7344 | lr: 3.2251e-06 | scale: 1024.00 | time: 26.825 | step time: 28.119
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2097/  5000| tot_loss: 1.9257 | rl_loss: 0.2807 | pt_loss: 1.6450 | pg_loss: 0.0217 | reg_loss: 0.2590 | reward: -0.1508 | rev_kl: 0.4604 | stu_lens: 128.0000 | mixed_lens: 125.0000 | lr: 3.2236e-06 | scale: 1024.00 | time: 26.838 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2098/  5000| tot_loss: 1.8981 | rl_loss: 0.2790 | pt_loss: 1.6191 | pg_loss: 0.0025 | reg_loss: 0.2766 | reward: -0.0861 | rev_kl: 1.2449 | stu_lens: 96.0000 | mixed_lens: 128.0000 | lr: 3.2221e-06 | scale: 1024.00 | time: 26.801 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2099/  5000| tot_loss: 2.7748 | rl_loss: 1.1247 | pt_loss: 1.6500 | pg_loss: 0.8143 | reg_loss: 0.3104 | reward: -0.1031 | rev_kl: 0.7136 | stu_lens: 39.5000 | mixed_lens: 34.5000 | lr: 3.2205e-06 | scale: 1024.00 | time: 26.982 | step time: 0.000
                                 Evaluation #21                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son categorizados por sus │
│                                       │ cualidades fundamentales, las cuales │
│                                       │ son las siguientes:                  │
│                                       │                                      │
│                                       │ - Cuark b: es el cuark de color.     │
│                                       │ - Cuark t: es el cuark de fuerza.    │
│                                       │ - Cuark c: es el cuark de masa.      │
│                                       │ - Cuark u: es el cuark up.           │
│                                       │ - Cuark d: es el cuark down.         │
│                                       │ - Cuark s: es el cuark strange.      │
│                                       │ - Cuark b': es el cuark beauty.      │
│                                       │ - Cuark t': es el cuark top.         │
│                                       │ - Cuark c                            │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es una herramienta para la    │
│                                       │ comunicación de información de la    │
│                                       │ empresa con sus clientes. El IMC     │
│                                       │ está compuesto por los siguientes    │
│                                       │ elementos:                           │
│                                       │                                      │
│                                       │ - Media: son los canales por los que │
│                                       │ se comunica la empresa con sus       │
│                                       │ clientes. En el IMC se utilizan      │
│                                       │ principalmente el email, el          │
│                                       │ telefono, la web, los social         │
│                                       │ networks y la publicidad.            │
│                                       │ - Message: es el contenido de la     │
│                                       │ comunicación, es decir, el mensaje   │
│                                       │ que se quiere transmitir. En el IMC  │
│                                       │ se utilizan principalmente los       │
│                                       │ anuncios, las promociones, el        │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ 1. Cápsula del tiempo de Lyon, 1630  │
│                                       │ 2. Cápsula del tiempo de Woodstock,  │
│                                       │ 1637                                 │
│                                       │ 3. Cápsula del tiempo de Nueva York, │
│                                       │ 1789                                 │
│                                       │ 4. Cápsula del tiempo de Filadelfia, │
│                                       │ 1848                                 │
│                                       │ 5. Cápsula del tiempo de Paris, 1867 │
│                                       │ 6. Cápsula del tiempo de Londres,    │
│                                       │ 1889                                 │
│                                       │ 7. Cápsula del tiempo de la          │
│                                       │ Universidad de Pensilvania, 19       │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.041 | exact_match: 0.000 | rev_kl: 0.856 | lens: 97.139 | pt_loss: 1.736 | lm_loss: 1.865 | kd_loss: 1.606 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2100/  5000| tot_loss: 2.4286 | rl_loss: 0.7114 | pt_loss: 1.7172 | pg_loss: 0.2454 | reg_loss: 0.4660 | reward: -0.1601 | rev_kl: 0.8528 | stu_lens: 90.0000 | mixed_lens: 98.5000 | lr: 3.2190e-06 | scale: 1024.00 | time: 26.815 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2101/  5000| tot_loss: 2.2906 | rl_loss: 0.2736 | pt_loss: 2.0170 | pg_loss: 0.0117 | reg_loss: 0.2619 | reward: -0.1912 | rev_kl: 0.7207 | stu_lens: 128.0000 | mixed_lens: 121.5000 | lr: 3.2175e-06 | scale: 1024.00 | time: 27.036 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2102/  5000| tot_loss: 2.3536 | rl_loss: 0.4653 | pt_loss: 1.8884 | pg_loss: 0.1616 | reg_loss: 0.3036 | reward: -0.2897 | rev_kl: 0.9139 | stu_lens: 128.0000 | mixed_lens: 91.0000 | lr: 3.2159e-06 | scale: 1024.00 | time: 26.836 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2103/  5000| tot_loss: 2.0760 | rl_loss: 0.6047 | pt_loss: 1.4713 | pg_loss: 0.2197 | reg_loss: 0.3849 | reward: -0.3719 | rev_kl: 0.9881 | stu_lens: 87.5000 | mixed_lens: 92.0000 | lr: 3.2144e-06 | scale: 1024.00 | time: 26.857 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2104/  5000| tot_loss: 2.9908 | rl_loss: 1.2231 | pt_loss: 1.7677 | pg_loss: 0.9710 | reg_loss: 0.2521 | reward: -1.3937 | rev_kl: 0.8592 | stu_lens: 52.5000 | mixed_lens: 37.5000 | lr: 3.2129e-06 | scale: 1024.00 | time: 26.891 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2105/  5000| tot_loss: 3.4201 | rl_loss: 1.7034 | pt_loss: 1.7167 | pg_loss: 0.6704 | reg_loss: 1.0330 | reward: -0.2194 | rev_kl: 0.7677 | stu_lens: 62.5000 | mixed_lens: 13.0000 | lr: 3.2113e-06 | scale: 1024.00 | time: 26.993 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2106/  5000| tot_loss: 2.1916 | rl_loss: 0.4217 | pt_loss: 1.7698 | pg_loss: 0.0502 | reg_loss: 0.3716 | reward: -0.2605 | rev_kl: 0.8555 | stu_lens: 128.0000 | mixed_lens: 122.5000 | lr: 3.2098e-06 | scale: 1024.00 | time: 26.801 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2107/  5000| tot_loss: 2.3913 | rl_loss: 0.4403 | pt_loss: 1.9510 | pg_loss: 0.0178 | reg_loss: 0.4226 | reward: -0.2677 | rev_kl: 0.4838 | stu_lens: 88.0000 | mixed_lens: 126.5000 | lr: 3.2082e-06 | scale: 1024.00 | time: 26.818 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2108/  5000| tot_loss: 2.4509 | rl_loss: 0.5949 | pt_loss: 1.8560 | pg_loss: 0.1380 | reg_loss: 0.4569 | reward: -1.0297 | rev_kl: 1.8349 | stu_lens: 67.0000 | mixed_lens: 77.0000 | lr: 3.2067e-06 | scale: 1024.00 | time: 26.806 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2109/  5000| tot_loss: 2.6107 | rl_loss: 0.8874 | pt_loss: 1.7233 | pg_loss: 0.7211 | reg_loss: 0.1663 | reward: -0.1966 | rev_kl: 3.3718 | stu_lens: 48.0000 | mixed_lens: 46.0000 | lr: 3.2052e-06 | scale: 1024.00 | time: 26.907 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2110/  5000| tot_loss: 2.2446 | rl_loss: 0.1691 | pt_loss: 2.0755 | pg_loss: -0.0121 | reg_loss: 0.1812 | reward: -0.2198 | rev_kl: 1.0568 | stu_lens: 70.0000 | mixed_lens: 128.0000 | lr: 3.2036e-06 | scale: 1024.00 | time: 26.793 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2111/  5000| tot_loss: 1.9997 | rl_loss: 0.0554 | pt_loss: 1.9443 | pg_loss: -0.1758 | reg_loss: 0.2312 | reward: -0.1204 | rev_kl: 0.3751 | stu_lens: 39.0000 | mixed_lens: 50.5000 | lr: 3.2021e-06 | scale: 1024.00 | time: 26.775 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2112/  5000| tot_loss: 2.7779 | rl_loss: 0.9415 | pt_loss: 1.8364 | pg_loss: 0.4480 | reg_loss: 0.4935 | reward: -0.0731 | rev_kl: 1.0976 | stu_lens: 66.5000 | mixed_lens: 66.5000 | lr: 3.2006e-06 | scale: 1024.00 | time: 26.797 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2112/  5000| tot_loss: 2.3827 | rl_loss: 0.6125 | pt_loss: 1.7702 | pg_loss: 0.2608 | reg_loss: 0.3517 | reward: -0.3160 | rev_kl: 0.8897 | stu_lens: 86.7969 | mixed_lens: 84.9844 | lr: 3.2006e-06 | scale: 1024.00 | time: 26.797 | step time: 28.123
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2113/  5000| tot_loss: 2.5457 | rl_loss: 0.9763 | pt_loss: 1.5695 | pg_loss: 0.4436 | reg_loss: 0.5327 | reward: -0.7908 | rev_kl: 0.5680 | stu_lens: 69.5000 | mixed_lens: 67.0000 | lr: 3.1990e-06 | scale: 1024.00 | time: 26.826 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2114/  5000| tot_loss: 2.1877 | rl_loss: 1.1733 | pt_loss: 1.0144 | pg_loss: 0.2035 | reg_loss: 0.9698 | reward: -0.3335 | rev_kl: 1.0678 | stu_lens: 128.0000 | mixed_lens: 103.0000 | lr: 3.1975e-06 | scale: 1024.00 | time: 26.955 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2115/  5000| tot_loss: 2.6725 | rl_loss: 1.2666 | pt_loss: 1.4059 | pg_loss: 0.5653 | reg_loss: 0.7013 | reward: -0.3509 | rev_kl: 0.5048 | stu_lens: 128.0000 | mixed_lens: 64.5000 | lr: 3.1959e-06 | scale: 1024.00 | time: 26.856 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2116/  5000| tot_loss: 3.6361 | rl_loss: 1.9040 | pt_loss: 1.7320 | pg_loss: 0.6489 | reg_loss: 1.2551 | reward: -1.4520 | rev_kl: 1.1709 | stu_lens: 67.5000 | mixed_lens: 65.0000 | lr: 3.1944e-06 | scale: 1024.00 | time: 26.838 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2117/  5000| tot_loss: 2.7974 | rl_loss: 1.0527 | pt_loss: 1.7447 | pg_loss: 0.0545 | reg_loss: 0.9982 | reward: 0.0213 | rev_kl: 0.6290 | stu_lens: 112.0000 | mixed_lens: 128.0000 | lr: 3.1929e-06 | scale: 1024.00 | time: 26.863 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2118/  5000| tot_loss: 3.3032 | rl_loss: 1.3888 | pt_loss: 1.9144 | pg_loss: 0.4503 | reg_loss: 0.9385 | reward: -0.4060 | rev_kl: 0.7959 | stu_lens: 100.0000 | mixed_lens: 79.5000 | lr: 3.1913e-06 | scale: 1024.00 | time: 26.852 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2119/  5000| tot_loss: 3.0714 | rl_loss: 1.1833 | pt_loss: 1.8881 | pg_loss: 0.4985 | reg_loss: 0.6848 | reward: -0.3362 | rev_kl: 0.6160 | stu_lens: 87.0000 | mixed_lens: 82.0000 | lr: 3.1898e-06 | scale: 1024.00 | time: 26.885 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2120/  5000| tot_loss: 3.1290 | rl_loss: 1.1773 | pt_loss: 1.9517 | pg_loss: 0.1732 | reg_loss: 1.0041 | reward: -0.1269 | rev_kl: 0.9084 | stu_lens: 101.0000 | mixed_lens: 106.0000 | lr: 3.1882e-06 | scale: 1024.00 | time: 26.876 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2121/  5000| tot_loss: 3.1430 | rl_loss: 1.6205 | pt_loss: 1.5225 | pg_loss: 0.3353 | reg_loss: 1.2852 | reward: -0.1053 | rev_kl: 0.9395 | stu_lens: 128.0000 | mixed_lens: 57.0000 | lr: 3.1867e-06 | scale: 1024.00 | time: 26.892 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2122/  5000| tot_loss: 2.8773 | rl_loss: 0.8786 | pt_loss: 1.9988 | pg_loss: 0.0353 | reg_loss: 0.8433 | reward: -0.0740 | rev_kl: 0.6767 | stu_lens: 101.0000 | mixed_lens: 128.0000 | lr: 3.1852e-06 | scale: 1024.00 | time: 26.860 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2123/  5000| tot_loss: 2.9455 | rl_loss: 1.2934 | pt_loss: 1.6521 | pg_loss: 0.1768 | reg_loss: 1.1166 | reward: -0.3519 | rev_kl: 0.6214 | stu_lens: 122.0000 | mixed_lens: 119.0000 | lr: 3.1836e-06 | scale: 1024.00 | time: 27.143 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2124/  5000| tot_loss: 2.6678 | rl_loss: 1.0099 | pt_loss: 1.6579 | pg_loss: 0.4019 | reg_loss: 0.6080 | reward: -0.4837 | rev_kl: 0.8730 | stu_lens: 80.0000 | mixed_lens: 76.5000 | lr: 3.1821e-06 | scale: 1024.00 | time: 26.825 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2125/  5000| tot_loss: 2.8688 | rl_loss: 1.0969 | pt_loss: 1.7718 | pg_loss: 0.2824 | reg_loss: 0.8145 | reward: -0.1182 | rev_kl: 0.9030 | stu_lens: 106.0000 | mixed_lens: 98.5000 | lr: 3.1805e-06 | scale: 1024.00 | time: 26.874 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2126/  5000| tot_loss: 2.6316 | rl_loss: 1.4109 | pt_loss: 1.2206 | pg_loss: 0.1806 | reg_loss: 1.2303 | reward: -0.4029 | rev_kl: 0.8018 | stu_lens: 110.0000 | mixed_lens: 107.5000 | lr: 3.1790e-06 | scale: 1024.00 | time: 26.831 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2127/  5000| tot_loss: 2.8000 | rl_loss: 0.9439 | pt_loss: 1.8561 | pg_loss: 0.1534 | reg_loss: 0.7905 | reward: 0.0773 | rev_kl: 0.6783 | stu_lens: 121.5000 | mixed_lens: 74.5000 | lr: 3.1774e-06 | scale: 1024.00 | time: 26.851 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2128/  5000| tot_loss: 2.6430 | rl_loss: 1.0131 | pt_loss: 1.6300 | pg_loss: 0.2112 | reg_loss: 0.8019 | reward: -0.1755 | rev_kl: 0.7386 | stu_lens: 128.0000 | mixed_lens: 95.0000 | lr: 3.1759e-06 | scale: 1024.00 | time: 26.822 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2128/  5000| tot_loss: 2.8606 | rl_loss: 1.1651 | pt_loss: 1.6955 | pg_loss: 0.3023 | reg_loss: 0.8628 | reward: -0.2967 | rev_kl: 0.8158 | stu_lens: 100.4219 | mixed_lens: 94.4688 | lr: 3.1759e-06 | scale: 1024.00 | time: 26.822 | step time: 28.134
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2129/  5000| tot_loss: 2.5156 | rl_loss: 0.6868 | pt_loss: 1.8288 | pg_loss: 0.2513 | reg_loss: 0.4355 | reward: -0.1914 | rev_kl: 0.3261 | stu_lens: 53.0000 | mixed_lens: 73.5000 | lr: 3.1744e-06 | scale: 1024.00 | time: 26.831 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2130/  5000| tot_loss: 2.7748 | rl_loss: 0.9723 | pt_loss: 1.8024 | pg_loss: 0.3283 | reg_loss: 0.6440 | reward: -0.5131 | rev_kl: 0.8458 | stu_lens: 80.0000 | mixed_lens: 76.5000 | lr: 3.1728e-06 | scale: 1024.00 | time: 26.831 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2131/  5000| tot_loss: 2.4687 | rl_loss: 0.5932 | pt_loss: 1.8755 | pg_loss: -0.0189 | reg_loss: 0.6121 | reward: -0.0983 | rev_kl: 0.9481 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.1713e-06 | scale: 1024.00 | time: 26.897 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2132/  5000| tot_loss: 2.7708 | rl_loss: 0.7848 | pt_loss: 1.9860 | pg_loss: 0.2524 | reg_loss: 0.5324 | reward: -0.1883 | rev_kl: 0.9721 | stu_lens: 127.0000 | mixed_lens: 86.0000 | lr: 3.1697e-06 | scale: 1024.00 | time: 26.838 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2133/  5000| tot_loss: 2.6441 | rl_loss: 0.8790 | pt_loss: 1.7652 | pg_loss: 0.1307 | reg_loss: 0.7483 | reward: 0.0168 | rev_kl: 0.4548 | stu_lens: 128.0000 | mixed_lens: 42.0000 | lr: 3.1682e-06 | scale: 1024.00 | time: 26.856 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2134/  5000| tot_loss: 2.6378 | rl_loss: 0.8038 | pt_loss: 1.8340 | pg_loss: -0.0067 | reg_loss: 0.8105 | reward: -0.0417 | rev_kl: 0.8278 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.1666e-06 | scale: 1024.00 | time: 26.838 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2135/  5000| tot_loss: 2.8222 | rl_loss: 0.7636 | pt_loss: 2.0586 | pg_loss: 0.1080 | reg_loss: 0.6557 | reward: -0.1375 | rev_kl: 0.9885 | stu_lens: 101.0000 | mixed_lens: 106.0000 | lr: 3.1651e-06 | scale: 1024.00 | time: 26.926 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2136/  5000| tot_loss: 2.5413 | rl_loss: 0.5331 | pt_loss: 2.0082 | pg_loss: -0.0110 | reg_loss: 0.5441 | reward: -0.0868 | rev_kl: 0.7214 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.1635e-06 | scale: 1024.00 | time: 26.852 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2137/  5000| tot_loss: 3.5149 | rl_loss: 1.6241 | pt_loss: 1.8909 | pg_loss: 1.0864 | reg_loss: 0.5377 | reward: -0.4906 | rev_kl: 0.6217 | stu_lens: 79.0000 | mixed_lens: 41.0000 | lr: 3.1620e-06 | scale: 1024.00 | time: 26.897 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2138/  5000| tot_loss: 2.9060 | rl_loss: 0.9661 | pt_loss: 1.9399 | pg_loss: 0.1973 | reg_loss: 0.7688 | reward: -0.4167 | rev_kl: 0.9409 | stu_lens: 83.0000 | mixed_lens: 86.5000 | lr: 3.1605e-06 | scale: 1024.00 | time: 26.873 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2139/  5000| tot_loss: 2.1140 | rl_loss: 0.6266 | pt_loss: 1.4874 | pg_loss: 0.1138 | reg_loss: 0.5128 | reward: -0.2018 | rev_kl: 0.8056 | stu_lens: 86.5000 | mixed_lens: 107.5000 | lr: 3.1589e-06 | scale: 1024.00 | time: 27.062 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2140/  5000| tot_loss: 2.5614 | rl_loss: 1.0816 | pt_loss: 1.4798 | pg_loss: 0.4229 | reg_loss: 0.6587 | reward: -0.4740 | rev_kl: 0.6473 | stu_lens: 94.5000 | mixed_lens: 84.5000 | lr: 3.1574e-06 | scale: 1024.00 | time: 26.863 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2141/  5000| tot_loss: 2.7842 | rl_loss: 1.2202 | pt_loss: 1.5640 | pg_loss: 0.3864 | reg_loss: 0.8338 | reward: -0.4710 | rev_kl: 0.7378 | stu_lens: 102.0000 | mixed_lens: 73.5000 | lr: 3.1558e-06 | scale: 1024.00 | time: 26.826 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2142/  5000| tot_loss: 2.4466 | rl_loss: 0.7770 | pt_loss: 1.6696 | pg_loss: 0.1318 | reg_loss: 0.6451 | reward: -0.3591 | rev_kl: 0.7803 | stu_lens: 96.5000 | mixed_lens: 101.0000 | lr: 3.1543e-06 | scale: 1024.00 | time: 26.991 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2143/  5000| tot_loss: 2.1249 | rl_loss: 0.6214 | pt_loss: 1.5035 | pg_loss: 0.0067 | reg_loss: 0.6147 | reward: -0.0715 | rev_kl: 1.0108 | stu_lens: 72.0000 | mixed_lens: 125.5000 | lr: 3.1527e-06 | scale: 1024.00 | time: 26.878 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2144/  5000| tot_loss: 2.6176 | rl_loss: 0.5893 | pt_loss: 2.0284 | pg_loss: 0.2034 | reg_loss: 0.3858 | reward: -0.2804 | rev_kl: 0.6981 | stu_lens: 113.0000 | mixed_lens: 69.0000 | lr: 3.1512e-06 | scale: 1024.00 | time: 26.850 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2144/  5000| tot_loss: 2.6425 | rl_loss: 0.8607 | pt_loss: 1.7818 | pg_loss: 0.2631 | reg_loss: 0.5976 | reward: -0.3060 | rev_kl: 0.7934 | stu_lens: 95.5000 | mixed_lens: 89.7656 | lr: 3.1512e-06 | scale: 1024.00 | time: 26.850 | step time: 28.131
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2145/  5000| tot_loss: 2.4849 | rl_loss: 0.7042 | pt_loss: 1.7806 | pg_loss: 0.0596 | reg_loss: 0.6446 | reward: -0.1954 | rev_kl: 0.6090 | stu_lens: 112.0000 | mixed_lens: 119.0000 | lr: 3.1496e-06 | scale: 1024.00 | time: 26.857 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2146/  5000| tot_loss: 2.6495 | rl_loss: 0.8765 | pt_loss: 1.7731 | pg_loss: 0.3322 | reg_loss: 0.5442 | reward: -0.3972 | rev_kl: 0.6383 | stu_lens: 105.5000 | mixed_lens: 71.0000 | lr: 3.1481e-06 | scale: 1024.00 | time: 26.849 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2147/  5000| tot_loss: 2.5402 | rl_loss: 0.6615 | pt_loss: 1.8787 | pg_loss: 0.2988 | reg_loss: 0.3627 | reward: -0.3617 | rev_kl: 1.0099 | stu_lens: 33.5000 | mixed_lens: 79.0000 | lr: 3.1465e-06 | scale: 1024.00 | time: 26.877 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2148/  5000| tot_loss: 2.6231 | rl_loss: 0.7026 | pt_loss: 1.9205 | pg_loss: 0.2204 | reg_loss: 0.4821 | reward: 0.2061 | rev_kl: 0.4343 | stu_lens: 128.0000 | mixed_lens: 74.5000 | lr: 3.1450e-06 | scale: 1024.00 | time: 26.839 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2149/  5000| tot_loss: 2.9182 | rl_loss: 0.7849 | pt_loss: 2.1333 | pg_loss: 0.3454 | reg_loss: 0.4395 | reward: -0.2413 | rev_kl: 0.4698 | stu_lens: 42.5000 | mixed_lens: 76.0000 | lr: 3.1434e-06 | scale: 1024.00 | time: 26.864 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2150/  5000| tot_loss: 2.2495 | rl_loss: 0.2797 | pt_loss: 1.9698 | pg_loss: 0.1431 | reg_loss: 0.1366 | reward: -0.4769 | rev_kl: 0.7490 | stu_lens: 80.0000 | mixed_lens: 76.5000 | lr: 3.1419e-06 | scale: 1024.00 | time: 26.852 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2151/  5000| tot_loss: 2.8508 | rl_loss: 0.8658 | pt_loss: 1.9850 | pg_loss: 0.6223 | reg_loss: 0.2435 | reward: -0.3069 | rev_kl: 0.8646 | stu_lens: 79.0000 | mixed_lens: 47.0000 | lr: 3.1403e-06 | scale: 1024.00 | time: 26.868 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2152/  5000| tot_loss: 2.5592 | rl_loss: 1.2309 | pt_loss: 1.3283 | pg_loss: 0.7076 | reg_loss: 0.5233 | reward: -0.4212 | rev_kl: 0.8379 | stu_lens: 72.0000 | mixed_lens: 49.0000 | lr: 3.1388e-06 | scale: 1024.00 | time: 26.850 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2153/  5000| tot_loss: 2.3037 | rl_loss: 0.5582 | pt_loss: 1.7455 | pg_loss: 0.1022 | reg_loss: 0.4560 | reward: -0.0936 | rev_kl: 0.9821 | stu_lens: 127.0000 | mixed_lens: 101.5000 | lr: 3.1372e-06 | scale: 1024.00 | time: 26.886 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2154/  5000| tot_loss: 2.0861 | rl_loss: 0.5412 | pt_loss: 1.5449 | pg_loss: 0.1452 | reg_loss: 0.3960 | reward: -0.3308 | rev_kl: 0.8470 | stu_lens: 86.5000 | mixed_lens: 95.5000 | lr: 3.1357e-06 | scale: 1024.00 | time: 26.880 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2155/  5000| tot_loss: 2.8879 | rl_loss: 0.7825 | pt_loss: 2.1054 | pg_loss: 0.1106 | reg_loss: 0.6720 | reward: -0.2852 | rev_kl: 1.0106 | stu_lens: 128.0000 | mixed_lens: 103.0000 | lr: 3.1341e-06 | scale: 1024.00 | time: 26.900 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2156/  5000| tot_loss: 2.4329 | rl_loss: 0.4794 | pt_loss: 1.9535 | pg_loss: -0.0119 | reg_loss: 0.4914 | reward: -0.2346 | rev_kl: 0.8112 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.1326e-06 | scale: 1024.00 | time: 26.955 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2157/  5000| tot_loss: 2.4160 | rl_loss: 0.6131 | pt_loss: 1.8029 | pg_loss: 0.1521 | reg_loss: 0.4610 | reward: -0.1876 | rev_kl: 0.7886 | stu_lens: 110.0000 | mixed_lens: 112.5000 | lr: 3.1310e-06 | scale: 1024.00 | time: 26.896 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2158/  5000| tot_loss: 1.8576 | rl_loss: 0.4896 | pt_loss: 1.3680 | pg_loss: -0.0029 | reg_loss: 0.4926 | reward: -0.1452 | rev_kl: 1.1102 | stu_lens: 68.5000 | mixed_lens: 128.0000 | lr: 3.1295e-06 | scale: 1024.00 | time: 26.891 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2159/  5000| tot_loss: 2.0822 | rl_loss: 0.5290 | pt_loss: 1.5532 | pg_loss: 0.1489 | reg_loss: 0.3801 | reward: -0.0023 | rev_kl: 0.8743 | stu_lens: 128.0000 | mixed_lens: 51.5000 | lr: 3.1279e-06 | scale: 1024.00 | time: 26.882 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2160/  5000| tot_loss: 2.4739 | rl_loss: 0.6029 | pt_loss: 1.8710 | pg_loss: 0.2042 | reg_loss: 0.3986 | reward: -0.4763 | rev_kl: 0.8221 | stu_lens: 96.5000 | mixed_lens: 107.5000 | lr: 3.1264e-06 | scale: 1024.00 | time: 26.819 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2160/  5000| tot_loss: 2.3943 | rl_loss: 0.6659 | pt_loss: 1.7284 | pg_loss: 0.2227 | reg_loss: 0.4432 | reward: -0.2889 | rev_kl: 0.8058 | stu_lens: 96.6406 | mixed_lens: 93.3594 | lr: 3.1264e-06 | scale: 1024.00 | time: 26.819 | step time: 28.119
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2161/  5000| tot_loss: 2.3297 | rl_loss: 0.5403 | pt_loss: 1.7894 | pg_loss: 0.1258 | reg_loss: 0.4145 | reward: -0.2357 | rev_kl: 0.5563 | stu_lens: 128.0000 | mixed_lens: 91.5000 | lr: 3.1248e-06 | scale: 1024.00 | time: 26.842 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2162/  5000| tot_loss: 3.4831 | rl_loss: 1.1470 | pt_loss: 2.3361 | pg_loss: 0.8240 | reg_loss: 0.3229 | reward: -0.8335 | rev_kl: 1.2250 | stu_lens: 31.5000 | mixed_lens: 50.5000 | lr: 3.1233e-06 | scale: 1024.00 | time: 26.859 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2163/  5000| tot_loss: 2.2226 | rl_loss: 0.2875 | pt_loss: 1.9351 | pg_loss: -0.0369 | reg_loss: 0.3244 | reward: -0.0911 | rev_kl: 0.8771 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.1217e-06 | scale: 1024.00 | time: 26.876 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2164/  5000| tot_loss: 2.3712 | rl_loss: 0.5413 | pt_loss: 1.8298 | pg_loss: 0.0176 | reg_loss: 0.5238 | reward: -0.1059 | rev_kl: 0.7518 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.1202e-06 | scale: 1024.00 | time: 26.813 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2165/  5000| tot_loss: 1.7065 | rl_loss: -0.1883 | pt_loss: 1.8947 | pg_loss: -0.3511 | reg_loss: 0.1628 | reward: 0.1197 | rev_kl: 0.3896 | stu_lens: 128.0000 | mixed_lens: 36.5000 | lr: 3.1186e-06 | scale: 1024.00 | time: 26.828 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2166/  5000| tot_loss: 2.7244 | rl_loss: 0.7855 | pt_loss: 1.9389 | pg_loss: 0.2975 | reg_loss: 0.4880 | reward: -0.5248 | rev_kl: 0.9117 | stu_lens: 128.0000 | mixed_lens: 68.0000 | lr: 3.1171e-06 | scale: 1024.00 | time: 26.818 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2167/  5000| tot_loss: 2.6552 | rl_loss: 0.6124 | pt_loss: 2.0429 | pg_loss: 0.2973 | reg_loss: 0.3151 | reward: -0.1453 | rev_kl: 0.9751 | stu_lens: 101.0000 | mixed_lens: 38.0000 | lr: 3.1155e-06 | scale: 1024.00 | time: 26.838 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2168/  5000| tot_loss: 2.4192 | rl_loss: 0.6136 | pt_loss: 1.8055 | pg_loss: 0.3089 | reg_loss: 0.3047 | reward: -1.4911 | rev_kl: 1.0074 | stu_lens: 40.5000 | mixed_lens: 67.5000 | lr: 3.1140e-06 | scale: 1024.00 | time: 26.897 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2169/  5000| tot_loss: 1.8194 | rl_loss: 0.2439 | pt_loss: 1.5754 | pg_loss: -0.0151 | reg_loss: 0.2590 | reward: -0.0885 | rev_kl: 1.1066 | stu_lens: 72.0000 | mixed_lens: 128.0000 | lr: 3.1124e-06 | scale: 1024.00 | time: 26.840 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2170/  5000| tot_loss: 1.9275 | rl_loss: 0.3577 | pt_loss: 1.5698 | pg_loss: -0.0022 | reg_loss: 0.3600 | reward: -0.1280 | rev_kl: 0.7667 | stu_lens: 110.0000 | mixed_lens: 128.0000 | lr: 3.1109e-06 | scale: 1024.00 | time: 26.819 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2171/  5000| tot_loss: 2.1138 | rl_loss: 0.2840 | pt_loss: 1.8298 | pg_loss: -0.0048 | reg_loss: 0.2888 | reward: -0.2412 | rev_kl: 0.8069 | stu_lens: 96.5000 | mixed_lens: 128.0000 | lr: 3.1093e-06 | scale: 1024.00 | time: 26.874 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2172/  5000| tot_loss: 2.0384 | rl_loss: 0.4851 | pt_loss: 1.5532 | pg_loss: 0.1029 | reg_loss: 0.3823 | reward: -0.1543 | rev_kl: 0.8887 | stu_lens: 128.0000 | mixed_lens: 112.5000 | lr: 3.1077e-06 | scale: 1024.00 | time: 26.848 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2173/  5000| tot_loss: 1.9408 | rl_loss: 0.3944 | pt_loss: 1.5464 | pg_loss: -0.0181 | reg_loss: 0.4124 | reward: -0.1322 | rev_kl: 0.6923 | stu_lens: 88.0000 | mixed_lens: 128.0000 | lr: 3.1062e-06 | scale: 1024.00 | time: 26.890 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2174/  5000| tot_loss: 2.3055 | rl_loss: 0.5706 | pt_loss: 1.7349 | pg_loss: 0.1599 | reg_loss: 0.4107 | reward: -0.2236 | rev_kl: 0.7038 | stu_lens: 69.0000 | mixed_lens: 86.5000 | lr: 3.1046e-06 | scale: 1024.00 | time: 26.852 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2175/  5000| tot_loss: 2.1951 | rl_loss: 0.4363 | pt_loss: 1.7589 | pg_loss: 0.0139 | reg_loss: 0.4223 | reward: -0.1881 | rev_kl: 0.7425 | stu_lens: 128.0000 | mixed_lens: 125.5000 | lr: 3.1031e-06 | scale: 1024.00 | time: 26.895 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2176/  5000| tot_loss: 2.4025 | rl_loss: 0.7438 | pt_loss: 1.6587 | pg_loss: 0.4424 | reg_loss: 0.3014 | reward: -0.3080 | rev_kl: 0.9790 | stu_lens: 72.0000 | mixed_lens: 76.0000 | lr: 3.1015e-06 | scale: 1024.00 | time: 27.279 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2176/  5000| tot_loss: 2.2807 | rl_loss: 0.5607 | pt_loss: 1.7200 | pg_loss: 0.2079 | reg_loss: 0.3528 | reward: -0.3029 | rev_kl: 0.8018 | stu_lens: 99.4844 | mixed_lens: 90.9062 | lr: 3.1015e-06 | scale: 1024.00 | time: 27.279 | step time: 28.122
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2177/  5000| tot_loss: 2.0807 | rl_loss: 0.3993 | pt_loss: 1.6814 | pg_loss: -0.0063 | reg_loss: 0.4057 | reward: -0.0415 | rev_kl: 0.9535 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.1000e-06 | scale: 1024.00 | time: 26.938 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2178/  5000| tot_loss: 2.9582 | rl_loss: 1.3604 | pt_loss: 1.5978 | pg_loss: 0.3069 | reg_loss: 1.0535 | reward: -0.1769 | rev_kl: 0.9138 | stu_lens: 95.5000 | mixed_lens: 95.5000 | lr: 3.0984e-06 | scale: 1024.00 | time: 26.863 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2179/  5000| tot_loss: 2.5000 | rl_loss: 1.1560 | pt_loss: 1.3440 | pg_loss: 0.0958 | reg_loss: 1.0602 | reward: -0.2173 | rev_kl: 0.9412 | stu_lens: 128.0000 | mixed_lens: 119.5000 | lr: 3.0969e-06 | scale: 1024.00 | time: 26.814 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2180/  5000| tot_loss: 4.2815 | rl_loss: 2.4522 | pt_loss: 1.8294 | pg_loss: 1.8917 | reg_loss: 0.5605 | reward: -0.9216 | rev_kl: 0.1105 | stu_lens: 19.0000 | mixed_lens: 22.5000 | lr: 3.0953e-06 | scale: 1024.00 | time: 26.839 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2181/  5000| tot_loss: 2.1005 | rl_loss: 1.2153 | pt_loss: 0.8852 | pg_loss: 0.3104 | reg_loss: 0.9049 | reward: -0.3686 | rev_kl: 0.7572 | stu_lens: 77.5000 | mixed_lens: 103.0000 | lr: 3.0937e-06 | scale: 1024.00 | time: 26.815 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2182/  5000| tot_loss: 2.7707 | rl_loss: 0.9179 | pt_loss: 1.8528 | pg_loss: 0.0665 | reg_loss: 0.8514 | reward: -0.1436 | rev_kl: 0.7428 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.0922e-06 | scale: 1024.00 | time: 27.340 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2183/  5000| tot_loss: 3.0300 | rl_loss: 1.4559 | pt_loss: 1.5740 | pg_loss: 0.6266 | reg_loss: 0.8293 | reward: -0.3830 | rev_kl: 0.6701 | stu_lens: 85.0000 | mixed_lens: 70.0000 | lr: 3.0906e-06 | scale: 1024.00 | time: 26.858 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2184/  5000| tot_loss: 2.6504 | rl_loss: 0.9118 | pt_loss: 1.7386 | pg_loss: 0.1047 | reg_loss: 0.8071 | reward: -0.1717 | rev_kl: 0.8558 | stu_lens: 106.0000 | mixed_lens: 117.5000 | lr: 3.0891e-06 | scale: 1024.00 | time: 26.897 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2185/  5000| tot_loss: 3.4306 | rl_loss: 1.2897 | pt_loss: 2.1409 | pg_loss: 0.3811 | reg_loss: 0.9086 | reward: -0.1974 | rev_kl: 1.2983 | stu_lens: 71.0000 | mixed_lens: 100.5000 | lr: 3.0875e-06 | scale: 1024.00 | time: 26.881 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2186/  5000| tot_loss: 2.1892 | rl_loss: 0.7124 | pt_loss: 1.4768 | pg_loss: 0.0451 | reg_loss: 0.6673 | reward: -0.2274 | rev_kl: 0.6652 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.0860e-06 | scale: 1024.00 | time: 26.881 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2187/  5000| tot_loss: 2.3996 | rl_loss: 1.0369 | pt_loss: 1.3627 | pg_loss: 0.1864 | reg_loss: 0.8505 | reward: -0.2289 | rev_kl: 0.7812 | stu_lens: 91.5000 | mixed_lens: 100.0000 | lr: 3.0844e-06 | scale: 1024.00 | time: 26.857 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2188/  5000| tot_loss: 2.9216 | rl_loss: 1.2811 | pt_loss: 1.6405 | pg_loss: 0.3641 | reg_loss: 0.9170 | reward: -0.3145 | rev_kl: 0.7936 | stu_lens: 128.0000 | mixed_lens: 91.5000 | lr: 3.0828e-06 | scale: 1024.00 | time: 26.911 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2189/  5000| tot_loss: 3.1696 | rl_loss: 1.2579 | pt_loss: 1.9117 | pg_loss: 0.1738 | reg_loss: 1.0840 | reward: -0.1205 | rev_kl: 0.7816 | stu_lens: 72.5000 | mixed_lens: 111.0000 | lr: 3.0813e-06 | scale: 1024.00 | time: 26.927 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2190/  5000| tot_loss: 2.6294 | rl_loss: 1.0107 | pt_loss: 1.6187 | pg_loss: 0.0315 | reg_loss: 0.9792 | reward: -0.1499 | rev_kl: 0.7399 | stu_lens: 101.0000 | mixed_lens: 128.0000 | lr: 3.0797e-06 | scale: 1024.00 | time: 26.970 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2191/  5000| tot_loss: 2.9606 | rl_loss: 0.8428 | pt_loss: 2.1178 | pg_loss: 0.1270 | reg_loss: 0.7158 | reward: -0.1821 | rev_kl: 0.8479 | stu_lens: 67.0000 | mixed_lens: 100.0000 | lr: 3.0782e-06 | scale: 1024.00 | time: 26.891 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2192/  5000| tot_loss: 2.9722 | rl_loss: 1.1256 | pt_loss: 1.8466 | pg_loss: 0.2840 | reg_loss: 0.8416 | reward: -0.3611 | rev_kl: 1.0522 | stu_lens: 100.0000 | mixed_lens: 94.0000 | lr: 3.0766e-06 | scale: 1024.00 | time: 26.904 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2192/  5000| tot_loss: 2.8035 | rl_loss: 1.0969 | pt_loss: 1.7066 | pg_loss: 0.2927 | reg_loss: 0.8041 | reward: -0.2720 | rev_kl: 0.7783 | stu_lens: 88.9688 | mixed_lens: 95.3125 | lr: 3.0766e-06 | scale: 1024.00 | time: 26.904 | step time: 28.146
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2193/  5000| tot_loss: 2.2101 | rl_loss: 0.8173 | pt_loss: 1.3928 | pg_loss: 0.0723 | reg_loss: 0.7450 | reward: -0.0882 | rev_kl: 1.1543 | stu_lens: 128.0000 | mixed_lens: 125.0000 | lr: 3.0750e-06 | scale: 1024.00 | time: 26.886 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2194/  5000| tot_loss: 2.6913 | rl_loss: 0.8158 | pt_loss: 1.8755 | pg_loss: 0.1837 | reg_loss: 0.6320 | reward: -0.1774 | rev_kl: 0.9293 | stu_lens: 99.0000 | mixed_lens: 106.0000 | lr: 3.0735e-06 | scale: 1024.00 | time: 26.897 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2195/  5000| tot_loss: 2.5097 | rl_loss: 0.7784 | pt_loss: 1.7313 | pg_loss: 0.1432 | reg_loss: 0.6352 | reward: -0.1966 | rev_kl: 1.0493 | stu_lens: 110.5000 | mixed_lens: 108.5000 | lr: 3.0719e-06 | scale: 1024.00 | time: 26.885 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2196/  5000| tot_loss: 2.5363 | rl_loss: 0.9085 | pt_loss: 1.6277 | pg_loss: 0.2134 | reg_loss: 0.6951 | reward: -0.3101 | rev_kl: 0.8852 | stu_lens: 128.0000 | mixed_lens: 96.5000 | lr: 3.0704e-06 | scale: 1024.00 | time: 26.885 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2197/  5000| tot_loss: 2.9308 | rl_loss: 1.0421 | pt_loss: 1.8887 | pg_loss: 0.5751 | reg_loss: 0.4670 | reward: -0.3937 | rev_kl: 1.3516 | stu_lens: 54.5000 | mixed_lens: 48.0000 | lr: 3.0688e-06 | scale: 1024.00 | time: 26.861 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2198/  5000| tot_loss: 2.3797 | rl_loss: 0.8076 | pt_loss: 1.5721 | pg_loss: 0.0880 | reg_loss: 0.7196 | reward: -0.4115 | rev_kl: 0.8620 | stu_lens: 128.0000 | mixed_lens: 111.0000 | lr: 3.0672e-06 | scale: 1024.00 | time: 26.884 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2199/  5000| tot_loss: 2.3025 | rl_loss: 0.6474 | pt_loss: 1.6552 | pg_loss: 0.0384 | reg_loss: 0.6090 | reward: -0.2953 | rev_kl: 0.8118 | stu_lens: 128.0000 | mixed_lens: 119.5000 | lr: 3.0657e-06 | scale: 1024.00 | time: 26.879 | step time: 0.000
                                 Evaluation #22                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son categorizados según   │
│                                       │ su masa. Los cuarks pesados son      │
│                                       │ aquellos que tienen una masa         │
│                                       │ superior a 1.75 GeV/c² y son         │
│                                       │ identificados por la letra b. Los    │
│                                       │ cuarks ligeros son aquellos que      │
│                                       │ tienen una masa inferior a 1.75      │
│                                       │ GeV/c² y son identificados por la    │
│                                       │ letra u.                             │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC, o Intermediario de Medios de │
│                                       │ Comunicación, es una asociación que  │
│                                       │ agrupa a los intermediarios de       │
│                                       │ medios de comunicación de España,    │
│                                       │ entre los que encontramos a los      │
│                                       │ publicistas, los agentes de prensa,  │
│                                       │ los consultores de comunicación, los │
│                                       │ productores de contenido, los        │
│                                       │ editores, los responsables de la     │
│                                       │ información, los directivos de       │
│                                       │ comunicación, los abogados y los     │
│                                       │ expertos en comunicación.            │
│                                       │                                      │
│                                       │ El IMC tiene más de 500 miembros,    │
│                                       │ entre empresas, entidades y autores, │
│                                       │ y cuenta con la colab                │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ 1. Cápsula del tiempo de Louis XIV,  │
│                                       │ 1665                                 │
│                                       │ 2. Cápsula del tiempo de Napoleón,   │
│                                       │ 1799                                 │
│                                       │ 3. Cápsula del tiempo de Carlota,    │
│                                       │ 1901                                 │
│                                       │ 4. Cápsula del tiempo de Charles     │
│                                       │ Dickens, 1870                        │
│                                       │ 5. Cápsula del tiempo de William     │
│                                       │ Shakespeare, 1596                    │
│                                       │ 6. Cápsula del tiempo de Walt        │
│                                       │ Disney, 1964                         │
│                                       │ 7. Cápsula del tiempo de Michael     │
│                                       │ Jackson, 1984                        │
│                                       │                                      │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.102 | exact_match: 0.000 | rev_kl: 0.839 | lens: 99.102 | pt_loss: 1.735 | lm_loss: 1.865 | kd_loss: 1.605 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2200/  5000| tot_loss: 2.5470 | rl_loss: 0.7660 | pt_loss: 1.7810 | pg_loss: 0.1803 | reg_loss: 0.5857 | reward: -0.2653 | rev_kl: 1.1752 | stu_lens: 40.0000 | mixed_lens: 100.5000 | lr: 3.0641e-06 | scale: 1024.00 | time: 26.896 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2201/  5000| tot_loss: 2.6429 | rl_loss: 0.7083 | pt_loss: 1.9346 | pg_loss: 0.1685 | reg_loss: 0.5398 | reward: -0.2096 | rev_kl: 0.9041 | stu_lens: 85.0000 | mixed_lens: 108.5000 | lr: 3.0626e-06 | scale: 1024.00 | time: 26.904 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2202/  5000| tot_loss: 2.3742 | rl_loss: 0.5403 | pt_loss: 1.8339 | pg_loss: 0.0210 | reg_loss: 0.5193 | reward: -0.1216 | rev_kl: 0.7151 | stu_lens: 96.0000 | mixed_lens: 128.0000 | lr: 3.0610e-06 | scale: 1024.00 | time: 26.866 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2203/  5000| tot_loss: 2.0116 | rl_loss: 0.6159 | pt_loss: 1.3957 | pg_loss: 0.0863 | reg_loss: 0.5295 | reward: -0.3082 | rev_kl: 0.9471 | stu_lens: 122.5000 | mixed_lens: 118.5000 | lr: 3.0594e-06 | scale: 1024.00 | time: 26.856 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2204/  5000| tot_loss: 2.6480 | rl_loss: 0.6347 | pt_loss: 2.0132 | pg_loss: 0.2526 | reg_loss: 0.3821 | reward: -0.2413 | rev_kl: 0.3115 | stu_lens: 37.0000 | mixed_lens: 54.0000 | lr: 3.0579e-06 | scale: 1024.00 | time: 26.889 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2205/  5000| tot_loss: 2.8179 | rl_loss: 1.0505 | pt_loss: 1.7674 | pg_loss: 0.4060 | reg_loss: 0.6445 | reward: -0.4152 | rev_kl: 1.0495 | stu_lens: 77.5000 | mixed_lens: 78.5000 | lr: 3.0563e-06 | scale: 1024.00 | time: 26.918 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2206/  5000| tot_loss: 2.5164 | rl_loss: 0.4450 | pt_loss: 2.0714 | pg_loss: -0.0171 | reg_loss: 0.4621 | reward: -0.1171 | rev_kl: 1.0143 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.0547e-06 | scale: 1024.00 | time: 26.967 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2207/  5000| tot_loss: 2.3301 | rl_loss: 0.4544 | pt_loss: 1.8757 | pg_loss: -0.0107 | reg_loss: 0.4652 | reward: -0.2217 | rev_kl: 0.6773 | stu_lens: 83.0000 | mixed_lens: 128.0000 | lr: 3.0532e-06 | scale: 1024.00 | time: 26.871 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2208/  5000| tot_loss: 2.1764 | rl_loss: 0.5170 | pt_loss: 1.6594 | pg_loss: 0.0291 | reg_loss: 0.4878 | reward: -0.2620 | rev_kl: 0.9233 | stu_lens: 73.5000 | mixed_lens: 128.0000 | lr: 3.0516e-06 | scale: 1024.00 | time: 26.896 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2208/  5000| tot_loss: 2.5445 | rl_loss: 0.7800 | pt_loss: 1.7645 | pg_loss: 0.2052 | reg_loss: 0.5749 | reward: -0.2600 | rev_kl: 0.8076 | stu_lens: 90.7656 | mixed_lens: 98.3281 | lr: 3.0516e-06 | scale: 1024.00 | time: 26.896 | step time: 28.121
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2209/  5000| tot_loss: 2.2928 | rl_loss: 0.8055 | pt_loss: 1.4874 | pg_loss: 0.1628 | reg_loss: 0.6427 | reward: -0.0172 | rev_kl: 0.5469 | stu_lens: 127.5000 | mixed_lens: 99.5000 | lr: 3.0500e-06 | scale: 1024.00 | time: 26.878 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2210/  5000| tot_loss: 2.2612 | rl_loss: 0.4399 | pt_loss: 1.8214 | pg_loss: 0.0511 | reg_loss: 0.3887 | reward: -0.0922 | rev_kl: 0.5498 | stu_lens: 77.5000 | mixed_lens: 120.0000 | lr: 3.0485e-06 | scale: 1024.00 | time: 26.863 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2211/  5000| tot_loss: 2.4287 | rl_loss: 0.6588 | pt_loss: 1.7698 | pg_loss: 0.3545 | reg_loss: 0.3043 | reward: -0.2513 | rev_kl: 0.5101 | stu_lens: 73.5000 | mixed_lens: 72.5000 | lr: 3.0469e-06 | scale: 1024.00 | time: 26.821 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2212/  5000| tot_loss: 2.1482 | rl_loss: 0.4158 | pt_loss: 1.7324 | pg_loss: 0.0418 | reg_loss: 0.3740 | reward: -0.1641 | rev_kl: 1.2127 | stu_lens: 122.5000 | mixed_lens: 117.5000 | lr: 3.0454e-06 | scale: 1024.00 | time: 26.886 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2213/  5000| tot_loss: 1.9317 | rl_loss: 0.3854 | pt_loss: 1.5463 | pg_loss: 0.0621 | reg_loss: 0.3234 | reward: -0.1669 | rev_kl: 0.4353 | stu_lens: 110.5000 | mixed_lens: 108.5000 | lr: 3.0438e-06 | scale: 1024.00 | time: 26.862 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2214/  5000| tot_loss: 2.3760 | rl_loss: 0.5968 | pt_loss: 1.7792 | pg_loss: 0.1620 | reg_loss: 0.4348 | reward: -0.1774 | rev_kl: 0.9293 | stu_lens: 99.0000 | mixed_lens: 106.0000 | lr: 3.0422e-06 | scale: 1024.00 | time: 26.854 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2215/  5000| tot_loss: 1.8338 | rl_loss: 0.3540 | pt_loss: 1.4799 | pg_loss: 0.1548 | reg_loss: 0.1991 | reward: -0.3632 | rev_kl: 1.3570 | stu_lens: 84.0000 | mixed_lens: 74.0000 | lr: 3.0407e-06 | scale: 1024.00 | time: 26.831 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2216/  5000| tot_loss: 2.2935 | rl_loss: 0.6340 | pt_loss: 1.6594 | pg_loss: 0.1855 | reg_loss: 0.4485 | reward: -0.4446 | rev_kl: 0.6550 | stu_lens: 71.5000 | mixed_lens: 63.0000 | lr: 3.0391e-06 | scale: 1024.00 | time: 26.849 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2217/  5000| tot_loss: 2.4959 | rl_loss: 0.9318 | pt_loss: 1.5641 | pg_loss: 0.5940 | reg_loss: 0.3378 | reward: -0.6287 | rev_kl: 0.7379 | stu_lens: 105.5000 | mixed_lens: 50.5000 | lr: 3.0375e-06 | scale: 1024.00 | time: 26.835 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2218/  5000| tot_loss: 3.9684 | rl_loss: 1.7625 | pt_loss: 2.2059 | pg_loss: 1.0664 | reg_loss: 0.6961 | reward: -1.0202 | rev_kl: 0.3584 | stu_lens: 47.5000 | mixed_lens: 44.5000 | lr: 3.0360e-06 | scale: 1024.00 | time: 26.857 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2219/  5000| tot_loss: 2.3739 | rl_loss: 0.8776 | pt_loss: 1.4963 | pg_loss: 0.4858 | reg_loss: 0.3918 | reward: -0.2918 | rev_kl: 0.3515 | stu_lens: 61.0000 | mixed_lens: 69.5000 | lr: 3.0344e-06 | scale: 1024.00 | time: 26.842 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2220/  5000| tot_loss: 1.8017 | rl_loss: 0.4469 | pt_loss: 1.3548 | pg_loss: -0.0089 | reg_loss: 0.4558 | reward: -0.3013 | rev_kl: 0.8678 | stu_lens: 85.5000 | mixed_lens: 128.0000 | lr: 3.0328e-06 | scale: 1024.00 | time: 26.869 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2221/  5000| tot_loss: 2.5204 | rl_loss: 0.3901 | pt_loss: 2.1303 | pg_loss: 0.0381 | reg_loss: 0.3520 | reward: -0.2301 | rev_kl: 0.9511 | stu_lens: 122.5000 | mixed_lens: 122.5000 | lr: 3.0313e-06 | scale: 1024.00 | time: 26.857 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2222/  5000| tot_loss: 2.5925 | rl_loss: 1.0081 | pt_loss: 1.5845 | pg_loss: 0.3997 | reg_loss: 0.6083 | reward: -0.3485 | rev_kl: 0.7001 | stu_lens: 112.0000 | mixed_lens: 70.5000 | lr: 3.0297e-06 | scale: 1024.00 | time: 26.881 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2223/  5000| tot_loss: 2.2459 | rl_loss: 0.4649 | pt_loss: 1.7809 | pg_loss: 0.0555 | reg_loss: 0.4094 | reward: -0.2241 | rev_kl: 0.8844 | stu_lens: 106.0000 | mixed_lens: 118.5000 | lr: 3.0281e-06 | scale: 1024.00 | time: 26.906 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2224/  5000| tot_loss: 1.7938 | rl_loss: 0.3779 | pt_loss: 1.4160 | pg_loss: -0.0128 | reg_loss: 0.3907 | reward: -0.0960 | rev_kl: 0.6455 | stu_lens: 101.0000 | mixed_lens: 128.0000 | lr: 3.0266e-06 | scale: 1024.00 | time: 26.899 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2224/  5000| tot_loss: 2.3415 | rl_loss: 0.6553 | pt_loss: 1.6862 | pg_loss: 0.2148 | reg_loss: 0.4405 | reward: -0.2778 | rev_kl: 0.7606 | stu_lens: 90.1562 | mixed_lens: 94.5781 | lr: 3.0266e-06 | scale: 1024.00 | time: 26.899 | step time: 28.092
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2225/  5000| tot_loss: 2.6290 | rl_loss: 0.5439 | pt_loss: 2.0851 | pg_loss: 0.2645 | reg_loss: 0.2795 | reward: -0.1730 | rev_kl: 0.3532 | stu_lens: 96.5000 | mixed_lens: 73.5000 | lr: 3.0250e-06 | scale: 1024.00 | time: 26.921 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2226/  5000| tot_loss: 1.9946 | rl_loss: 0.3511 | pt_loss: 1.6434 | pg_loss: 0.0330 | reg_loss: 0.3181 | reward: -0.1368 | rev_kl: 0.7448 | stu_lens: 85.0000 | mixed_lens: 108.5000 | lr: 3.0234e-06 | scale: 1024.00 | time: 26.961 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2227/  5000| tot_loss: 1.9705 | rl_loss: 0.2648 | pt_loss: 1.7057 | pg_loss: -0.0122 | reg_loss: 0.2771 | reward: -0.2626 | rev_kl: 0.5301 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.0219e-06 | scale: 1024.00 | time: 26.925 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2228/  5000| tot_loss: 2.5897 | rl_loss: 0.8052 | pt_loss: 1.7845 | pg_loss: 0.5747 | reg_loss: 0.2305 | reward: -0.4246 | rev_kl: 0.9226 | stu_lens: 51.5000 | mixed_lens: 58.5000 | lr: 3.0203e-06 | scale: 1024.00 | time: 26.913 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2229/  5000| tot_loss: 2.1492 | rl_loss: 0.3191 | pt_loss: 1.8301 | pg_loss: 0.0284 | reg_loss: 0.2907 | reward: -0.2389 | rev_kl: 0.9798 | stu_lens: 128.0000 | mixed_lens: 118.5000 | lr: 3.0187e-06 | scale: 1024.00 | time: 26.866 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2230/  5000| tot_loss: 2.3123 | rl_loss: 0.5789 | pt_loss: 1.7334 | pg_loss: 0.3050 | reg_loss: 0.2739 | reward: -0.3724 | rev_kl: 0.4987 | stu_lens: 71.5000 | mixed_lens: 82.5000 | lr: 3.0172e-06 | scale: 1024.00 | time: 26.923 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2231/  5000| tot_loss: 2.1129 | rl_loss: 0.4150 | pt_loss: 1.6979 | pg_loss: 0.0247 | reg_loss: 0.3902 | reward: -0.2123 | rev_kl: 0.8689 | stu_lens: 112.5000 | mixed_lens: 120.5000 | lr: 3.0156e-06 | scale: 1024.00 | time: 26.864 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2232/  5000| tot_loss: 2.0015 | rl_loss: 0.2496 | pt_loss: 1.7520 | pg_loss: 0.0721 | reg_loss: 0.1775 | reward: -0.0782 | rev_kl: 0.9557 | stu_lens: 91.5000 | mixed_lens: 106.5000 | lr: 3.0140e-06 | scale: 1024.00 | time: 26.904 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2233/  5000| tot_loss: 1.8524 | rl_loss: 0.2802 | pt_loss: 1.5722 | pg_loss: 0.0121 | reg_loss: 0.2681 | reward: -0.1828 | rev_kl: 0.7615 | stu_lens: 128.0000 | mixed_lens: 122.5000 | lr: 3.0125e-06 | scale: 1024.00 | time: 26.872 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2234/  5000| tot_loss: 2.3984 | rl_loss: 0.4685 | pt_loss: 1.9300 | pg_loss: 0.1740 | reg_loss: 0.2945 | reward: 0.0190 | rev_kl: 0.5637 | stu_lens: 98.5000 | mixed_lens: 88.0000 | lr: 3.0109e-06 | scale: 1024.00 | time: 26.924 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2235/  5000| tot_loss: 2.0977 | rl_loss: 0.4376 | pt_loss: 1.6601 | pg_loss: 0.1685 | reg_loss: 0.2690 | reward: -0.2774 | rev_kl: 1.1341 | stu_lens: 128.0000 | mixed_lens: 96.5000 | lr: 3.0093e-06 | scale: 1024.00 | time: 26.887 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2236/  5000| tot_loss: 2.3795 | rl_loss: 0.3833 | pt_loss: 1.9962 | pg_loss: -0.0375 | reg_loss: 0.4207 | reward: -0.1812 | rev_kl: 0.8584 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.0078e-06 | scale: 1024.00 | time: 26.916 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2237/  5000| tot_loss: 1.6640 | rl_loss: 0.5014 | pt_loss: 1.1626 | pg_loss: 0.1992 | reg_loss: 0.3021 | reward: -0.3006 | rev_kl: 0.7078 | stu_lens: 106.0000 | mixed_lens: 97.0000 | lr: 3.0062e-06 | scale: 1024.00 | time: 26.894 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2238/  5000| tot_loss: 1.9535 | rl_loss: 0.3208 | pt_loss: 1.6327 | pg_loss: 0.0061 | reg_loss: 0.3147 | reward: -0.2344 | rev_kl: 0.8192 | stu_lens: 101.0000 | mixed_lens: 119.5000 | lr: 3.0046e-06 | scale: 1024.00 | time: 26.910 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2239/  5000| tot_loss: 2.5975 | rl_loss: 0.6117 | pt_loss: 1.9858 | pg_loss: 0.2403 | reg_loss: 0.3714 | reward: -0.3465 | rev_kl: 1.0799 | stu_lens: 78.5000 | mixed_lens: 89.0000 | lr: 3.0030e-06 | scale: 1024.00 | time: 26.866 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2240/  5000| tot_loss: 2.8722 | rl_loss: 1.4178 | pt_loss: 1.4544 | pg_loss: 0.8675 | reg_loss: 0.5503 | reward: -0.4554 | rev_kl: 1.0188 | stu_lens: 104.0000 | mixed_lens: 48.5000 | lr: 3.0015e-06 | scale: 1024.00 | time: 26.893 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2240/  5000| tot_loss: 2.2322 | rl_loss: 0.5414 | pt_loss: 1.6908 | pg_loss: 0.2164 | reg_loss: 0.3250 | reward: -0.2713 | rev_kl: 0.7887 | stu_lens: 87.7500 | mixed_lens: 96.0000 | lr: 3.0015e-06 | scale: 1024.00 | time: 26.893 | step time: 28.133
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2241/  5000| tot_loss: 1.3867 | rl_loss: -0.1476 | pt_loss: 1.5343 | pg_loss: -0.5777 | reg_loss: 0.4301 | reward: -0.2407 | rev_kl: 0.7400 | stu_lens: 70.0000 | mixed_lens: 31.0000 | lr: 2.9999e-06 | scale: 1024.00 | time: 26.906 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2242/  5000| tot_loss: 3.4500 | rl_loss: 1.6837 | pt_loss: 1.7663 | pg_loss: 0.4415 | reg_loss: 1.2422 | reward: -0.4621 | rev_kl: 1.1297 | stu_lens: 41.5000 | mixed_lens: 74.0000 | lr: 2.9983e-06 | scale: 1024.00 | time: 26.920 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2243/  5000| tot_loss: 2.4713 | rl_loss: 0.8498 | pt_loss: 1.6215 | pg_loss: 0.1177 | reg_loss: 0.7321 | reward: -0.1308 | rev_kl: 1.1565 | stu_lens: 118.0000 | mixed_lens: 118.5000 | lr: 2.9968e-06 | scale: 1024.00 | time: 26.881 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2244/  5000| tot_loss: 2.6245 | rl_loss: 0.7183 | pt_loss: 1.9062 | pg_loss: 0.1231 | reg_loss: 0.5952 | reward: -0.2749 | rev_kl: 0.6012 | stu_lens: 83.0000 | mixed_lens: 114.0000 | lr: 2.9952e-06 | scale: 1024.00 | time: 26.907 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2245/  5000| tot_loss: 2.8548 | rl_loss: 1.1402 | pt_loss: 1.7146 | pg_loss: 0.5621 | reg_loss: 0.5781 | reward: -0.3564 | rev_kl: 0.4548 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 2.9936e-06 | scale: 1024.00 | time: 26.859 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2246/  5000| tot_loss: 2.9436 | rl_loss: 1.1876 | pt_loss: 1.7560 | pg_loss: 0.1476 | reg_loss: 1.0400 | reward: -0.0684 | rev_kl: 1.2716 | stu_lens: 53.5000 | mixed_lens: 94.5000 | lr: 2.9920e-06 | scale: 1024.00 | time: 26.881 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2247/  5000| tot_loss: 3.9419 | rl_loss: 2.5532 | pt_loss: 1.3887 | pg_loss: 1.1203 | reg_loss: 1.4330 | reward: -3.6755 | rev_kl: 1.5523 | stu_lens: 48.0000 | mixed_lens: 28.5000 | lr: 2.9905e-06 | scale: 1024.00 | time: 26.913 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2248/  5000| tot_loss: 2.5657 | rl_loss: 0.9894 | pt_loss: 1.5763 | pg_loss: 0.0506 | reg_loss: 0.9388 | reward: -0.0580 | rev_kl: 0.7290 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.9889e-06 | scale: 1024.00 | time: 26.943 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2249/  5000| tot_loss: 2.3916 | rl_loss: 0.8714 | pt_loss: 1.5201 | pg_loss: 0.0630 | reg_loss: 0.8084 | reward: -0.2636 | rev_kl: 0.8066 | stu_lens: 73.5000 | mixed_lens: 121.5000 | lr: 2.9873e-06 | scale: 1024.00 | time: 26.918 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/2250
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2250/  5000| tot_loss: 3.2939 | rl_loss: 1.3609 | pt_loss: 1.9329 | pg_loss: 0.3047 | reg_loss: 1.0562 | reward: -0.3179 | rev_kl: 1.1044 | stu_lens: 128.0000 | mixed_lens: 98.5000 | lr: 2.9858e-06 | scale: 1024.00 | time: 26.961 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2251/  5000| tot_loss: 2.9396 | rl_loss: 1.0858 | pt_loss: 1.8538 | pg_loss: 0.3789 | reg_loss: 0.7069 | reward: -0.2510 | rev_kl: 0.3596 | stu_lens: 84.0000 | mixed_lens: 87.0000 | lr: 2.9842e-06 | scale: 1024.00 | time: 26.891 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2252/  5000| tot_loss: 2.3871 | rl_loss: 1.0553 | pt_loss: 1.3317 | pg_loss: 0.1387 | reg_loss: 0.9166 | reward: -0.1957 | rev_kl: 0.7808 | stu_lens: 83.0000 | mixed_lens: 117.5000 | lr: 2.9826e-06 | scale: 1024.00 | time: 26.917 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2253/  5000| tot_loss: 2.8096 | rl_loss: 1.2609 | pt_loss: 1.5487 | pg_loss: 0.0918 | reg_loss: 1.1691 | reward: -0.2731 | rev_kl: 0.6333 | stu_lens: 128.0000 | mixed_lens: 119.5000 | lr: 2.9810e-06 | scale: 1024.00 | time: 26.886 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2254/  5000| tot_loss: 2.9005 | rl_loss: 1.1647 | pt_loss: 1.7359 | pg_loss: 0.2387 | reg_loss: 0.9259 | reward: -0.1687 | rev_kl: 0.7633 | stu_lens: 35.5000 | mixed_lens: 106.0000 | lr: 2.9795e-06 | scale: 1024.00 | time: 26.930 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2255/  5000| tot_loss: 2.1849 | rl_loss: 1.2543 | pt_loss: 0.9306 | pg_loss: 0.3508 | reg_loss: 0.9035 | reward: -0.2197 | rev_kl: 0.6025 | stu_lens: 128.0000 | mixed_lens: 92.0000 | lr: 2.9779e-06 | scale: 1024.00 | time: 26.884 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2256/  5000| tot_loss: 3.4637 | rl_loss: 1.6652 | pt_loss: 1.7985 | pg_loss: 0.7259 | reg_loss: 0.9392 | reward: -0.5413 | rev_kl: 0.9098 | stu_lens: 81.5000 | mixed_lens: 31.5000 | lr: 2.9763e-06 | scale: 1024.00 | time: 26.908 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2256/  5000| tot_loss: 2.8287 | rl_loss: 1.2006 | pt_loss: 1.6280 | pg_loss: 0.2914 | reg_loss: 0.9093 | reward: -0.4088 | rev_kl: 0.9281 | stu_lens: 92.8281 | mixed_lens: 90.5625 | lr: 2.9763e-06 | scale: 1024.00 | time: 26.908 | step time: 28.141
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2257/  5000| tot_loss: 2.8331 | rl_loss: 1.1041 | pt_loss: 1.7291 | pg_loss: 0.3393 | reg_loss: 0.7647 | reward: -0.2822 | rev_kl: 0.5089 | stu_lens: 82.0000 | mixed_lens: 100.0000 | lr: 2.9747e-06 | scale: 1024.00 | time: 26.879 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2258/  5000| tot_loss: 2.5548 | rl_loss: 1.1682 | pt_loss: 1.3866 | pg_loss: 0.2859 | reg_loss: 0.8823 | reward: -0.3479 | rev_kl: 0.8245 | stu_lens: 41.5000 | mixed_lens: 74.0000 | lr: 2.9732e-06 | scale: 1024.00 | time: 26.892 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2259/  5000| tot_loss: 2.3208 | rl_loss: 0.9041 | pt_loss: 1.4167 | pg_loss: 0.1554 | reg_loss: 0.7487 | reward: -0.0906 | rev_kl: 1.0627 | stu_lens: 128.0000 | mixed_lens: 98.5000 | lr: 2.9716e-06 | scale: 1024.00 | time: 26.884 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2260/  5000| tot_loss: 2.3015 | rl_loss: 0.4694 | pt_loss: 1.8322 | pg_loss: -0.0192 | reg_loss: 0.4886 | reward: -0.0530 | rev_kl: 0.7257 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.9700e-06 | scale: 1024.00 | time: 26.905 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2261/  5000| tot_loss: 2.6643 | rl_loss: 0.9037 | pt_loss: 1.7607 | pg_loss: 0.1550 | reg_loss: 0.7487 | reward: -0.3335 | rev_kl: 0.8458 | stu_lens: 122.0000 | mixed_lens: 97.5000 | lr: 2.9685e-06 | scale: 1024.00 | time: 26.896 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2262/  5000| tot_loss: 3.4581 | rl_loss: 1.9344 | pt_loss: 1.5237 | pg_loss: 1.1217 | reg_loss: 0.8128 | reward: -1.6592 | rev_kl: 0.7878 | stu_lens: 72.0000 | mixed_lens: 30.5000 | lr: 2.9669e-06 | scale: 1024.00 | time: 26.885 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2263/  5000| tot_loss: 2.8939 | rl_loss: 0.7308 | pt_loss: 2.1631 | pg_loss: 0.0450 | reg_loss: 0.6859 | reward: -0.2807 | rev_kl: 0.8772 | stu_lens: 72.0000 | mixed_lens: 121.5000 | lr: 2.9653e-06 | scale: 1024.00 | time: 26.931 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2264/  5000| tot_loss: 3.0552 | rl_loss: 0.7578 | pt_loss: 2.2974 | pg_loss: 0.1223 | reg_loss: 0.6356 | reward: -0.1186 | rev_kl: 0.9294 | stu_lens: 91.5000 | mixed_lens: 106.0000 | lr: 2.9637e-06 | scale: 1024.00 | time: 26.949 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2265/  5000| tot_loss: 3.2125 | rl_loss: 1.7387 | pt_loss: 1.4737 | pg_loss: 0.8931 | reg_loss: 0.8456 | reward: -0.3315 | rev_kl: 0.6811 | stu_lens: 120.0000 | mixed_lens: 48.5000 | lr: 2.9622e-06 | scale: 1024.00 | time: 26.911 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2266/  5000| tot_loss: 1.9921 | rl_loss: 0.5690 | pt_loss: 1.4231 | pg_loss: 0.0480 | reg_loss: 0.5210 | reward: -0.1345 | rev_kl: 0.7225 | stu_lens: 83.0000 | mixed_lens: 117.5000 | lr: 2.9606e-06 | scale: 1024.00 | time: 26.962 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2267/  5000| tot_loss: 2.8981 | rl_loss: 0.7879 | pt_loss: 2.1102 | pg_loss: 0.1351 | reg_loss: 0.6528 | reward: -0.2017 | rev_kl: 1.1050 | stu_lens: 111.5000 | mixed_lens: 90.5000 | lr: 2.9590e-06 | scale: 1024.00 | time: 26.948 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2268/  5000| tot_loss: 2.3984 | rl_loss: 0.6356 | pt_loss: 1.7628 | pg_loss: 0.1363 | reg_loss: 0.4993 | reward: -0.4154 | rev_kl: 1.6300 | stu_lens: 65.5000 | mixed_lens: 67.0000 | lr: 2.9574e-06 | scale: 1024.00 | time: 26.877 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2269/  5000| tot_loss: 2.9154 | rl_loss: 0.8449 | pt_loss: 2.0705 | pg_loss: 0.3875 | reg_loss: 0.4574 | reward: -0.2107 | rev_kl: 0.9449 | stu_lens: 128.0000 | mixed_lens: 63.0000 | lr: 2.9559e-06 | scale: 1024.00 | time: 26.862 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2270/  5000| tot_loss: 2.8249 | rl_loss: 0.7276 | pt_loss: 2.0972 | pg_loss: 0.0804 | reg_loss: 0.6472 | reward: -0.1710 | rev_kl: 0.7831 | stu_lens: 21.0000 | mixed_lens: 94.5000 | lr: 2.9543e-06 | scale: 1024.00 | time: 26.885 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2271/  5000| tot_loss: 2.3091 | rl_loss: 0.6876 | pt_loss: 1.6215 | pg_loss: 0.1124 | reg_loss: 0.5752 | reward: -0.2548 | rev_kl: 0.6435 | stu_lens: 83.0000 | mixed_lens: 114.0000 | lr: 2.9527e-06 | scale: 1024.00 | time: 26.872 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2272/  5000| tot_loss: 1.8344 | rl_loss: 0.7038 | pt_loss: 1.1306 | pg_loss: 0.0023 | reg_loss: 0.7015 | reward: -0.2105 | rev_kl: 1.1608 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.9511e-06 | scale: 1024.00 | time: 26.904 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2272/  5000| tot_loss: 2.6657 | rl_loss: 0.9706 | pt_loss: 1.6951 | pg_loss: 0.2692 | reg_loss: 0.7014 | reward: -0.4831 | rev_kl: 0.8948 | stu_lens: 90.1719 | mixed_lens: 89.2031 | lr: 2.9511e-06 | scale: 1024.00 | time: 26.904 | step time: 28.132
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2273/  5000| tot_loss: 2.3133 | rl_loss: 0.7342 | pt_loss: 1.5791 | pg_loss: 0.0400 | reg_loss: 0.6941 | reward: -0.0940 | rev_kl: 0.6607 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.9495e-06 | scale: 1024.00 | time: 26.889 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2274/  5000| tot_loss: 2.9199 | rl_loss: 0.7828 | pt_loss: 2.1370 | pg_loss: 0.3049 | reg_loss: 0.4779 | reward: -0.1989 | rev_kl: 0.7620 | stu_lens: 120.0000 | mixed_lens: 84.5000 | lr: 2.9480e-06 | scale: 1024.00 | time: 26.905 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2275/  5000| tot_loss: 2.0032 | rl_loss: 0.3017 | pt_loss: 1.7014 | pg_loss: -0.0038 | reg_loss: 0.3055 | reward: -0.2100 | rev_kl: 0.5491 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.9464e-06 | scale: 1024.00 | time: 26.894 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2276/  5000| tot_loss: 2.5480 | rl_loss: 0.4583 | pt_loss: 2.0898 | pg_loss: -0.0084 | reg_loss: 0.4667 | reward: -0.0925 | rev_kl: 0.9283 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.9448e-06 | scale: 1024.00 | time: 26.919 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2277/  5000| tot_loss: 2.3275 | rl_loss: 0.6895 | pt_loss: 1.6380 | pg_loss: 0.1952 | reg_loss: 0.4944 | reward: -0.3568 | rev_kl: 0.7931 | stu_lens: 73.5000 | mixed_lens: 92.0000 | lr: 2.9432e-06 | scale: 1024.00 | time: 26.901 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2278/  5000| tot_loss: 1.9349 | rl_loss: 0.4743 | pt_loss: 1.4606 | pg_loss: 0.0191 | reg_loss: 0.4553 | reward: -0.2603 | rev_kl: 0.8928 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.9417e-06 | scale: 1024.00 | time: 26.956 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2279/  5000| tot_loss: 2.7548 | rl_loss: 0.8803 | pt_loss: 1.8746 | pg_loss: 0.4239 | reg_loss: 0.4564 | reward: -0.2139 | rev_kl: 0.6312 | stu_lens: 28.5000 | mixed_lens: 59.0000 | lr: 2.9401e-06 | scale: 1024.00 | time: 26.877 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2280/  5000| tot_loss: 2.8314 | rl_loss: 1.2054 | pt_loss: 1.6261 | pg_loss: 0.6073 | reg_loss: 0.5980 | reward: 0.0547 | rev_kl: 0.8729 | stu_lens: 57.0000 | mixed_lens: 40.0000 | lr: 2.9385e-06 | scale: 1024.00 | time: 26.907 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2281/  5000| tot_loss: 2.2227 | rl_loss: 0.8437 | pt_loss: 1.3789 | pg_loss: 0.2532 | reg_loss: 0.5905 | reward: -0.3002 | rev_kl: 0.9822 | stu_lens: 91.5000 | mixed_lens: 78.0000 | lr: 2.9369e-06 | scale: 1024.00 | time: 26.895 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2282/  5000| tot_loss: 2.4404 | rl_loss: 0.9431 | pt_loss: 1.4973 | pg_loss: 0.5697 | reg_loss: 0.3734 | reward: -0.2489 | rev_kl: 0.7910 | stu_lens: 107.5000 | mixed_lens: 39.0000 | lr: 2.9353e-06 | scale: 1024.00 | time: 26.916 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2283/  5000| tot_loss: 2.3774 | rl_loss: 0.6706 | pt_loss: 1.7068 | pg_loss: 0.1219 | reg_loss: 0.5487 | reward: -0.3335 | rev_kl: 0.8458 | stu_lens: 122.0000 | mixed_lens: 97.5000 | lr: 2.9338e-06 | scale: 1024.00 | time: 26.910 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2284/  5000| tot_loss: 2.7318 | rl_loss: 1.1056 | pt_loss: 1.6261 | pg_loss: 0.5970 | reg_loss: 0.5086 | reward: -0.6174 | rev_kl: 0.9793 | stu_lens: 97.5000 | mixed_lens: 35.5000 | lr: 2.9322e-06 | scale: 1024.00 | time: 26.933 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2285/  5000| tot_loss: 2.6271 | rl_loss: 0.4944 | pt_loss: 2.1327 | pg_loss: 0.1498 | reg_loss: 0.3447 | reward: -0.1109 | rev_kl: 0.4308 | stu_lens: 78.0000 | mixed_lens: 96.0000 | lr: 2.9306e-06 | scale: 1024.00 | time: 26.929 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2286/  5000| tot_loss: 2.4949 | rl_loss: 0.7193 | pt_loss: 1.7755 | pg_loss: 0.2156 | reg_loss: 0.5038 | reward: -0.3402 | rev_kl: 1.3235 | stu_lens: 100.5000 | mixed_lens: 74.5000 | lr: 2.9290e-06 | scale: 1024.00 | time: 26.957 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2287/  5000| tot_loss: 2.1513 | rl_loss: 0.4761 | pt_loss: 1.6753 | pg_loss: 0.0250 | reg_loss: 0.4511 | reward: -0.1319 | rev_kl: 0.7747 | stu_lens: 128.0000 | mixed_lens: 121.5000 | lr: 2.9275e-06 | scale: 1024.00 | time: 26.883 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2288/  5000| tot_loss: 2.8063 | rl_loss: 0.8927 | pt_loss: 1.9136 | pg_loss: 0.4331 | reg_loss: 0.4596 | reward: -0.4479 | rev_kl: 0.4515 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 2.9259e-06 | scale: 1024.00 | time: 26.921 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2288/  5000| tot_loss: 2.4820 | rl_loss: 0.7376 | pt_loss: 1.7444 | pg_loss: 0.2452 | reg_loss: 0.4924 | reward: -0.4418 | rev_kl: 0.9166 | stu_lens: 90.9531 | mixed_lens: 91.0625 | lr: 2.9259e-06 | scale: 1024.00 | time: 26.921 | step time: 28.142
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2289/  5000| tot_loss: 2.1934 | rl_loss: 0.5182 | pt_loss: 1.6752 | pg_loss: -0.0235 | reg_loss: 0.5417 | reward: -0.1734 | rev_kl: 1.6633 | stu_lens: 107.5000 | mixed_lens: 128.0000 | lr: 2.9243e-06 | scale: 1024.00 | time: 26.922 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2290/  5000| tot_loss: 2.1938 | rl_loss: 0.6251 | pt_loss: 1.5687 | pg_loss: 0.2739 | reg_loss: 0.3512 | reward: -0.1027 | rev_kl: 0.8109 | stu_lens: 73.5000 | mixed_lens: 73.0000 | lr: 2.9227e-06 | scale: 1024.00 | time: 26.879 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2291/  5000| tot_loss: 1.9535 | rl_loss: 0.5378 | pt_loss: 1.4157 | pg_loss: 0.0861 | reg_loss: 0.4517 | reward: -0.2759 | rev_kl: 0.9524 | stu_lens: 111.5000 | mixed_lens: 90.5000 | lr: 2.9211e-06 | scale: 1024.00 | time: 26.860 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2292/  5000| tot_loss: 2.7128 | rl_loss: 0.7079 | pt_loss: 2.0049 | pg_loss: 0.2783 | reg_loss: 0.4296 | reward: -0.3505 | rev_kl: 0.4615 | stu_lens: 84.0000 | mixed_lens: 78.5000 | lr: 2.9196e-06 | scale: 1024.00 | time: 26.891 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2293/  5000| tot_loss: 2.1044 | rl_loss: 0.5471 | pt_loss: 1.5574 | pg_loss: 0.2398 | reg_loss: 0.3072 | reward: -0.3342 | rev_kl: 0.6476 | stu_lens: 51.5000 | mixed_lens: 74.0000 | lr: 2.9180e-06 | scale: 1024.00 | time: 26.862 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2294/  5000| tot_loss: 2.5320 | rl_loss: 0.9005 | pt_loss: 1.6315 | pg_loss: 0.3556 | reg_loss: 0.5450 | reward: -0.5680 | rev_kl: 0.6294 | stu_lens: 109.0000 | mixed_lens: 54.5000 | lr: 2.9164e-06 | scale: 1024.00 | time: 26.881 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2295/  5000| tot_loss: 2.7065 | rl_loss: 1.1500 | pt_loss: 1.5565 | pg_loss: 0.6730 | reg_loss: 0.4770 | reward: -0.4990 | rev_kl: 0.3231 | stu_lens: 9.5000 | mixed_lens: 65.5000 | lr: 2.9148e-06 | scale: 1024.00 | time: 26.893 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2296/  5000| tot_loss: 2.5690 | rl_loss: 0.5367 | pt_loss: 2.0322 | pg_loss: 0.1195 | reg_loss: 0.4173 | reward: -0.2675 | rev_kl: 1.4227 | stu_lens: 109.0000 | mixed_lens: 100.0000 | lr: 2.9132e-06 | scale: 1024.00 | time: 26.905 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2297/  5000| tot_loss: 2.1992 | rl_loss: 0.9949 | pt_loss: 1.2043 | pg_loss: 0.4765 | reg_loss: 0.5184 | reward: -0.5955 | rev_kl: 1.9577 | stu_lens: 64.0000 | mixed_lens: 67.0000 | lr: 2.9117e-06 | scale: 1024.00 | time: 26.920 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2298/  5000| tot_loss: 1.9259 | rl_loss: 0.3631 | pt_loss: 1.5627 | pg_loss: 0.0185 | reg_loss: 0.3447 | reward: -0.0788 | rev_kl: 0.7980 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.9101e-06 | scale: 1024.00 | time: 26.955 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2299/  5000| tot_loss: 1.7751 | rl_loss: 0.3679 | pt_loss: 1.4072 | pg_loss: -0.0214 | reg_loss: 0.3893 | reward: -0.1216 | rev_kl: 1.3627 | stu_lens: 106.0000 | mixed_lens: 128.0000 | lr: 2.9085e-06 | scale: 1024.00 | time: 26.904 | step time: 0.000
                                 Evaluation #23                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Existen cuatro tipos de cuarks:      │
│                                       │                                      │
│                                       │ - Cuark leptónico                    │
│                                       │ - Cuark hadrónico                    │
│                                       │ - Cuark de carga                     │
│                                       │ - Cuark extra                        │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC o Índice de Misión Crucial es │
│                                       │ un índice que mide la tasa de éxito  │
│                                       │ de una organización en conseguir     │
│                                       │ responder a la misión crucial de la  │
│                                       │ misma. La misión crucial es el único │
│                                       │ objetivo de la organización que      │
│                                       │ tiene el carácter de ser esencial    │
│                                       │ para la existencia de la misma.      │
│                                       │                                      │
│                                       │ El IMC se mide mediante un conjunto  │
│                                       │ de artefactos que incluyen entre     │
│                                       │ otros:                               │
│                                       │                                      │
│                                       │ - La tasa de ejecución, que mide la  │
│                                       │ capacidad de la organización de      │
│                                       │ llevar a cabo su misión              │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ 1. Cápsula del tiempo de Carter,     │
│                                       │ creada el 26 de febrero de 1974,     │
│                                       │ contenía una lista de preguntas de   │
│                                       │ app, una cámara de vídeo, y un       │
│                                       │ parche para el ojo. Se abrió el 21   │
│                                       │ de abril de 2023.                    │
│                                       │ 2. Cápsula del tiempo de DeLorean,   │
│                                       │ creada el 26 de febrero de 1974,     │
│                                       │ contenía un cristal de Hérminio, una │
│                                       │ cámara de vídeo, un disco compacto,  │
│                                       │ y un                                 │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.097 | exact_match: 0.000 | rev_kl: 0.902 | lens: 94.877 | pt_loss: 1.733 | lm_loss: 1.862 | kd_loss: 1.604 
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2300/  5000| tot_loss: 2.4064 | rl_loss: 0.6309 | pt_loss: 1.7755 | pg_loss: 0.2517 | reg_loss: 0.3793 | reward: -1.2651 | rev_kl: 0.9013 | stu_lens: 72.5000 | mixed_lens: 69.5000 | lr: 2.9069e-06 | scale: 1024.00 | time: 26.938 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2301/  5000| tot_loss: 2.1388 | rl_loss: 0.2958 | pt_loss: 1.8429 | pg_loss: -0.0351 | reg_loss: 0.3309 | reward: -0.0664 | rev_kl: 0.7370 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.9053e-06 | scale: 1024.00 | time: 26.977 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2302/  5000| tot_loss: 2.4471 | rl_loss: 0.6736 | pt_loss: 1.7734 | pg_loss: 0.2273 | reg_loss: 0.4463 | reward: -0.0518 | rev_kl: 0.7944 | stu_lens: 128.0000 | mixed_lens: 77.0000 | lr: 2.9037e-06 | scale: 1024.00 | time: 26.912 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2303/  5000| tot_loss: 2.3439 | rl_loss: 0.8648 | pt_loss: 1.4791 | pg_loss: 0.4825 | reg_loss: 0.3823 | reward: -0.5210 | rev_kl: 0.8316 | stu_lens: 128.0000 | mixed_lens: 75.5000 | lr: 2.9022e-06 | scale: 1024.00 | time: 26.949 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2304/  5000| tot_loss: 2.1366 | rl_loss: 0.3480 | pt_loss: 1.7886 | pg_loss: -0.0087 | reg_loss: 0.3568 | reward: -0.1978 | rev_kl: 1.7276 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.9006e-06 | scale: 1024.00 | time: 26.924 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2304/  5000| tot_loss: 2.1767 | rl_loss: 0.5582 | pt_loss: 1.6185 | pg_loss: 0.1560 | reg_loss: 0.4022 | reward: -0.3423 | rev_kl: 0.9280 | stu_lens: 95.0469 | mixed_lens: 94.7500 | lr: 2.9006e-06 | scale: 1024.00 | time: 26.924 | step time: 28.143
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2305/  5000| tot_loss: 2.1019 | rl_loss: 0.4141 | pt_loss: 1.6878 | pg_loss: 0.2018 | reg_loss: 0.2122 | reward: -3.6105 | rev_kl: 1.4324 | stu_lens: 68.5000 | mixed_lens: 66.5000 | lr: 2.8990e-06 | scale: 1024.00 | time: 26.934 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2306/  5000| tot_loss: 2.7520 | rl_loss: 0.9323 | pt_loss: 1.8197 | pg_loss: 0.0414 | reg_loss: 0.8908 | reward: -0.2323 | rev_kl: 0.7500 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8974e-06 | scale: 1024.00 | time: 26.925 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2307/  5000| tot_loss: 3.5533 | rl_loss: 1.3736 | pt_loss: 2.1797 | pg_loss: 0.4940 | reg_loss: 0.8795 | reward: -0.2251 | rev_kl: 0.4922 | stu_lens: 74.0000 | mixed_lens: 57.5000 | lr: 2.8958e-06 | scale: 1024.00 | time: 26.890 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2308/  5000| tot_loss: 3.4569 | rl_loss: 1.4602 | pt_loss: 1.9966 | pg_loss: 0.0780 | reg_loss: 1.3822 | reward: -0.1747 | rev_kl: 0.8440 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8943e-06 | scale: 1024.00 | time: 26.869 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2309/  5000| tot_loss: 2.7046 | rl_loss: 1.1003 | pt_loss: 1.6043 | pg_loss: 0.2303 | reg_loss: 0.8699 | reward: -0.4171 | rev_kl: 0.8101 | stu_lens: 108.0000 | mixed_lens: 102.0000 | lr: 2.8927e-06 | scale: 1024.00 | time: 26.857 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2310/  5000| tot_loss: 3.4138 | rl_loss: 1.7193 | pt_loss: 1.6945 | pg_loss: 0.5620 | reg_loss: 1.1573 | reward: 0.0640 | rev_kl: 0.4860 | stu_lens: 66.5000 | mixed_lens: 68.5000 | lr: 2.8911e-06 | scale: 1024.00 | time: 26.871 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2311/  5000| tot_loss: 2.4451 | rl_loss: 1.3504 | pt_loss: 1.0947 | pg_loss: 0.3664 | reg_loss: 0.9839 | reward: -0.2042 | rev_kl: 0.7090 | stu_lens: 116.5000 | mixed_lens: 72.5000 | lr: 2.8895e-06 | scale: 1024.00 | time: 26.857 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2312/  5000| tot_loss: 2.4457 | rl_loss: 0.9963 | pt_loss: 1.4494 | pg_loss: 0.0746 | reg_loss: 0.9217 | reward: -0.0606 | rev_kl: 0.9509 | stu_lens: 68.0000 | mixed_lens: 128.0000 | lr: 2.8879e-06 | scale: 1024.00 | time: 26.857 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2313/  5000| tot_loss: 2.6924 | rl_loss: 0.9227 | pt_loss: 1.7698 | pg_loss: 0.0611 | reg_loss: 0.8616 | reward: -0.1197 | rev_kl: 1.0307 | stu_lens: 102.0000 | mixed_lens: 128.0000 | lr: 2.8863e-06 | scale: 1024.00 | time: 26.866 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2314/  5000| tot_loss: 2.9736 | rl_loss: 1.1646 | pt_loss: 1.8090 | pg_loss: 0.0771 | reg_loss: 1.0875 | reward: -0.1543 | rev_kl: 1.1809 | stu_lens: 128.0000 | mixed_lens: 116.0000 | lr: 2.8848e-06 | scale: 1024.00 | time: 26.865 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2315/  5000| tot_loss: 2.8381 | rl_loss: 1.1103 | pt_loss: 1.7278 | pg_loss: 0.2781 | reg_loss: 0.8321 | reward: -0.3178 | rev_kl: 0.8206 | stu_lens: 99.5000 | mixed_lens: 94.5000 | lr: 2.8832e-06 | scale: 1024.00 | time: 26.917 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2316/  5000| tot_loss: 2.5180 | rl_loss: 0.9311 | pt_loss: 1.5868 | pg_loss: 0.0603 | reg_loss: 0.8709 | reward: -0.0913 | rev_kl: 0.6982 | stu_lens: 92.5000 | mixed_lens: 128.0000 | lr: 2.8816e-06 | scale: 1024.00 | time: 26.871 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2317/  5000| tot_loss: 2.8038 | rl_loss: 1.2077 | pt_loss: 1.5961 | pg_loss: 0.0756 | reg_loss: 1.1321 | reward: -0.1280 | rev_kl: 0.7818 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8800e-06 | scale: 1024.00 | time: 26.904 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2318/  5000| tot_loss: 3.7940 | rl_loss: 1.9694 | pt_loss: 1.8246 | pg_loss: 0.5888 | reg_loss: 1.3805 | reward: -0.7011 | rev_kl: 1.2491 | stu_lens: 93.5000 | mixed_lens: 54.5000 | lr: 2.8784e-06 | scale: 1024.00 | time: 26.885 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2319/  5000| tot_loss: 2.5422 | rl_loss: 0.5887 | pt_loss: 1.9535 | pg_loss: 0.0510 | reg_loss: 0.5377 | reward: -0.1190 | rev_kl: 0.7301 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8768e-06 | scale: 1024.00 | time: 26.910 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2320/  5000| tot_loss: 2.9986 | rl_loss: 1.4947 | pt_loss: 1.5039 | pg_loss: 0.3448 | reg_loss: 1.1499 | reward: -0.3792 | rev_kl: 0.4084 | stu_lens: 23.0000 | mixed_lens: 91.0000 | lr: 2.8752e-06 | scale: 1024.00 | time: 26.901 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2320/  5000| tot_loss: 3.0884 | rl_loss: 1.3134 | pt_loss: 1.7751 | pg_loss: 0.3567 | reg_loss: 0.9567 | reward: -0.4318 | rev_kl: 0.9011 | stu_lens: 91.3750 | mixed_lens: 89.8594 | lr: 2.8752e-06 | scale: 1024.00 | time: 26.901 | step time: 28.117
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2321/  5000| tot_loss: 3.3655 | rl_loss: 1.6642 | pt_loss: 1.7013 | pg_loss: 0.7070 | reg_loss: 0.9572 | reward: -0.3091 | rev_kl: 0.6506 | stu_lens: 94.5000 | mixed_lens: 43.5000 | lr: 2.8737e-06 | scale: 1024.00 | time: 26.939 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2322/  5000| tot_loss: 2.8591 | rl_loss: 0.7456 | pt_loss: 2.1135 | pg_loss: 0.0023 | reg_loss: 0.7433 | reward: -0.1291 | rev_kl: 0.7354 | stu_lens: 80.0000 | mixed_lens: 128.0000 | lr: 2.8721e-06 | scale: 1024.00 | time: 26.924 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2323/  5000| tot_loss: 2.6406 | rl_loss: 0.7559 | pt_loss: 1.8847 | pg_loss: 0.0992 | reg_loss: 0.6567 | reward: -0.1685 | rev_kl: 0.8052 | stu_lens: 128.0000 | mixed_lens: 112.0000 | lr: 2.8705e-06 | scale: 1024.00 | time: 26.905 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2324/  5000| tot_loss: 2.4920 | rl_loss: 0.6249 | pt_loss: 1.8671 | pg_loss: 0.0770 | reg_loss: 0.5478 | reward: -0.3799 | rev_kl: 1.2407 | stu_lens: 99.5000 | mixed_lens: 110.0000 | lr: 2.8689e-06 | scale: 1024.00 | time: 26.906 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2325/  5000| tot_loss: 2.6920 | rl_loss: 0.8051 | pt_loss: 1.8869 | pg_loss: 0.1633 | reg_loss: 0.6418 | reward: -0.3671 | rev_kl: 0.9257 | stu_lens: 122.0000 | mixed_lens: 102.0000 | lr: 2.8673e-06 | scale: 1024.00 | time: 26.897 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2326/  5000| tot_loss: 2.6535 | rl_loss: 1.0976 | pt_loss: 1.5559 | pg_loss: 0.2028 | reg_loss: 0.8948 | reward: -0.0354 | rev_kl: 0.9534 | stu_lens: 117.5000 | mixed_lens: 76.0000 | lr: 2.8657e-06 | scale: 1024.00 | time: 26.874 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2327/  5000| tot_loss: 2.5804 | rl_loss: 0.6978 | pt_loss: 1.8826 | pg_loss: 0.1643 | reg_loss: 0.5335 | reward: -0.1047 | rev_kl: 0.6681 | stu_lens: 101.0000 | mixed_lens: 99.5000 | lr: 2.8642e-06 | scale: 1024.00 | time: 26.882 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2328/  5000| tot_loss: 2.1425 | rl_loss: 0.6990 | pt_loss: 1.4434 | pg_loss: 0.0175 | reg_loss: 0.6815 | reward: -0.0989 | rev_kl: 0.8648 | stu_lens: 110.5000 | mixed_lens: 128.0000 | lr: 2.8626e-06 | scale: 1024.00 | time: 26.857 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2329/  5000| tot_loss: 2.3350 | rl_loss: 0.3569 | pt_loss: 1.9781 | pg_loss: -0.0032 | reg_loss: 0.3601 | reward: -0.0413 | rev_kl: 0.6198 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8610e-06 | scale: 1024.00 | time: 26.904 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2330/  5000| tot_loss: 3.5658 | rl_loss: 1.4160 | pt_loss: 2.1498 | pg_loss: 0.4210 | reg_loss: 0.9950 | reward: -1.1572 | rev_kl: 1.1535 | stu_lens: 67.0000 | mixed_lens: 40.0000 | lr: 2.8594e-06 | scale: 1024.00 | time: 26.897 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2331/  5000| tot_loss: 2.5728 | rl_loss: 0.9925 | pt_loss: 1.5803 | pg_loss: 0.0473 | reg_loss: 0.9452 | reward: -0.1183 | rev_kl: 1.2036 | stu_lens: 128.0000 | mixed_lens: 116.0000 | lr: 2.8578e-06 | scale: 1024.00 | time: 26.915 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2332/  5000| tot_loss: 3.2802 | rl_loss: 1.3952 | pt_loss: 1.8850 | pg_loss: 0.2758 | reg_loss: 1.1194 | reward: -0.4115 | rev_kl: 1.4708 | stu_lens: 87.5000 | mixed_lens: 90.5000 | lr: 2.8562e-06 | scale: 1024.00 | time: 26.918 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2333/  5000| tot_loss: 2.6225 | rl_loss: 0.7282 | pt_loss: 1.8943 | pg_loss: 0.1931 | reg_loss: 0.5351 | reward: -0.1609 | rev_kl: 0.8330 | stu_lens: 110.0000 | mixed_lens: 69.5000 | lr: 2.8546e-06 | scale: 1024.00 | time: 26.952 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2334/  5000| tot_loss: 2.3886 | rl_loss: 0.5065 | pt_loss: 1.8821 | pg_loss: 0.0008 | reg_loss: 0.5057 | reward: -0.0654 | rev_kl: 0.6666 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8530e-06 | scale: 1024.00 | time: 26.923 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2335/  5000| tot_loss: 2.8584 | rl_loss: 0.7536 | pt_loss: 2.1048 | pg_loss: 0.0876 | reg_loss: 0.6660 | reward: -0.2145 | rev_kl: 0.6721 | stu_lens: 68.0000 | mixed_lens: 102.0000 | lr: 2.8515e-06 | scale: 1024.00 | time: 26.958 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2336/  5000| tot_loss: 2.4311 | rl_loss: 0.5292 | pt_loss: 1.9020 | pg_loss: -0.0072 | reg_loss: 0.5363 | reward: -0.1232 | rev_kl: 0.5351 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8499e-06 | scale: 1024.00 | time: 26.944 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2336/  5000| tot_loss: 2.6795 | rl_loss: 0.9346 | pt_loss: 1.7448 | pg_loss: 0.2468 | reg_loss: 0.6879 | reward: -0.2467 | rev_kl: 0.8117 | stu_lens: 94.4844 | mixed_lens: 89.5156 | lr: 2.8499e-06 | scale: 1024.00 | time: 26.944 | step time: 28.142
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2337/  5000| tot_loss: 3.1992 | rl_loss: 1.1727 | pt_loss: 2.0265 | pg_loss: 0.2264 | reg_loss: 0.9463 | reward: -0.6610 | rev_kl: 1.3655 | stu_lens: 86.0000 | mixed_lens: 86.0000 | lr: 2.8483e-06 | scale: 1024.00 | time: 26.976 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2338/  5000| tot_loss: 2.6901 | rl_loss: 0.5503 | pt_loss: 2.1398 | pg_loss: -0.0134 | reg_loss: 0.5637 | reward: -0.1216 | rev_kl: 0.4871 | stu_lens: 80.0000 | mixed_lens: 128.0000 | lr: 2.8467e-06 | scale: 1024.00 | time: 26.969 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2339/  5000| tot_loss: 2.3691 | rl_loss: 0.7742 | pt_loss: 1.5949 | pg_loss: 0.1458 | reg_loss: 0.6284 | reward: -0.4864 | rev_kl: 0.6041 | stu_lens: 71.0000 | mixed_lens: 65.0000 | lr: 2.8451e-06 | scale: 1024.00 | time: 27.006 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2340/  5000| tot_loss: 2.2245 | rl_loss: 0.8239 | pt_loss: 1.4006 | pg_loss: 0.4420 | reg_loss: 0.3819 | reward: -0.1425 | rev_kl: 0.4289 | stu_lens: 74.0000 | mixed_lens: 73.5000 | lr: 2.8435e-06 | scale: 1024.00 | time: 26.915 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2341/  5000| tot_loss: 1.6929 | rl_loss: 0.4492 | pt_loss: 1.2438 | pg_loss: -0.0088 | reg_loss: 0.4580 | reward: -0.1645 | rev_kl: 0.9051 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8419e-06 | scale: 1024.00 | time: 26.944 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2342/  5000| tot_loss: 2.5481 | rl_loss: 0.5895 | pt_loss: 1.9586 | pg_loss: 0.1336 | reg_loss: 0.4559 | reward: -0.5112 | rev_kl: 1.3211 | stu_lens: 128.0000 | mixed_lens: 85.0000 | lr: 2.8403e-06 | scale: 1024.00 | time: 26.914 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2343/  5000| tot_loss: 2.7458 | rl_loss: 1.0459 | pt_loss: 1.6999 | pg_loss: 0.4829 | reg_loss: 0.5629 | reward: -0.0893 | rev_kl: 0.4621 | stu_lens: 67.0000 | mixed_lens: 67.0000 | lr: 2.8388e-06 | scale: 1024.00 | time: 26.951 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2344/  5000| tot_loss: 2.7015 | rl_loss: 0.4355 | pt_loss: 2.2661 | pg_loss: 0.0045 | reg_loss: 0.4309 | reward: -0.1019 | rev_kl: 0.8737 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8372e-06 | scale: 1024.00 | time: 26.896 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2345/  5000| tot_loss: 2.6116 | rl_loss: 1.1242 | pt_loss: 1.4873 | pg_loss: 0.7455 | reg_loss: 0.3787 | reward: -0.3347 | rev_kl: 0.4786 | stu_lens: 55.0000 | mixed_lens: 42.5000 | lr: 2.8356e-06 | scale: 1024.00 | time: 26.930 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2346/  5000| tot_loss: 2.1450 | rl_loss: 0.4043 | pt_loss: 1.7407 | pg_loss: 0.0115 | reg_loss: 0.3928 | reward: -0.0891 | rev_kl: 0.6338 | stu_lens: 51.0000 | mixed_lens: 128.0000 | lr: 2.8340e-06 | scale: 1024.00 | time: 26.915 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2347/  5000| tot_loss: 2.8481 | rl_loss: 1.2640 | pt_loss: 1.5840 | pg_loss: 0.4958 | reg_loss: 0.7682 | reward: -2.0132 | rev_kl: 1.5219 | stu_lens: 72.0000 | mixed_lens: 70.0000 | lr: 2.8324e-06 | scale: 1024.00 | time: 26.942 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2348/  5000| tot_loss: 2.2253 | rl_loss: 0.6335 | pt_loss: 1.5918 | pg_loss: 0.0302 | reg_loss: 0.6033 | reward: -0.2162 | rev_kl: 1.0492 | stu_lens: 111.5000 | mixed_lens: 128.0000 | lr: 2.8308e-06 | scale: 1024.00 | time: 26.933 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2349/  5000| tot_loss: 2.3309 | rl_loss: 0.5516 | pt_loss: 1.7793 | pg_loss: 0.1433 | reg_loss: 0.4084 | reward: -0.1351 | rev_kl: 1.0643 | stu_lens: 128.0000 | mixed_lens: 111.5000 | lr: 2.8292e-06 | scale: 1024.00 | time: 26.927 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2350/  5000| tot_loss: 2.2269 | rl_loss: 0.4424 | pt_loss: 1.7845 | pg_loss: -0.0043 | reg_loss: 0.4467 | reward: -0.0488 | rev_kl: 0.8029 | stu_lens: 92.5000 | mixed_lens: 128.0000 | lr: 2.8276e-06 | scale: 1024.00 | time: 26.913 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2351/  5000| tot_loss: 2.4185 | rl_loss: 0.4926 | pt_loss: 1.9259 | pg_loss: 0.1885 | reg_loss: 0.3042 | reward: -0.1760 | rev_kl: 0.4730 | stu_lens: 101.0000 | mixed_lens: 99.5000 | lr: 2.8261e-06 | scale: 1024.00 | time: 26.978 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2352/  5000| tot_loss: 2.1629 | rl_loss: 0.2933 | pt_loss: 1.8696 | pg_loss: 0.0045 | reg_loss: 0.2888 | reward: -0.0317 | rev_kl: 0.7503 | stu_lens: 118.5000 | mixed_lens: 128.0000 | lr: 2.8245e-06 | scale: 1024.00 | time: 26.968 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2352/  5000| tot_loss: 2.5063 | rl_loss: 0.7994 | pt_loss: 1.7069 | pg_loss: 0.2768 | reg_loss: 0.5227 | reward: -0.4059 | rev_kl: 0.8868 | stu_lens: 88.9062 | mixed_lens: 85.0625 | lr: 2.8245e-06 | scale: 1024.00 | time: 26.968 | step time: 28.171
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2353/  5000| tot_loss: 2.8647 | rl_loss: 0.4875 | pt_loss: 2.3771 | pg_loss: 0.0095 | reg_loss: 0.4780 | reward: -0.0731 | rev_kl: 1.0944 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8229e-06 | scale: 1024.00 | time: 26.991 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2354/  5000| tot_loss: 2.2111 | rl_loss: 0.2821 | pt_loss: 1.9290 | pg_loss: 0.0248 | reg_loss: 0.2573 | reward: -0.1505 | rev_kl: 1.0746 | stu_lens: 94.5000 | mixed_lens: 128.0000 | lr: 2.8213e-06 | scale: 1024.00 | time: 26.945 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2355/  5000| tot_loss: 2.7275 | rl_loss: 0.8213 | pt_loss: 1.9062 | pg_loss: 0.1720 | reg_loss: 0.6494 | reward: -0.6039 | rev_kl: 1.1432 | stu_lens: 100.0000 | mixed_lens: 68.5000 | lr: 2.8197e-06 | scale: 1024.00 | time: 26.974 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2356/  5000| tot_loss: 1.7865 | rl_loss: 0.3461 | pt_loss: 1.4404 | pg_loss: 0.0055 | reg_loss: 0.3406 | reward: -0.2495 | rev_kl: 0.9455 | stu_lens: 99.5000 | mixed_lens: 128.0000 | lr: 2.8181e-06 | scale: 1024.00 | time: 26.939 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2357/  5000| tot_loss: 2.3868 | rl_loss: 0.4946 | pt_loss: 1.8922 | pg_loss: 0.1212 | reg_loss: 0.3735 | reward: -0.0584 | rev_kl: 0.6420 | stu_lens: 87.0000 | mixed_lens: 88.0000 | lr: 2.8165e-06 | scale: 1024.00 | time: 26.966 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2358/  5000| tot_loss: 1.4225 | rl_loss: 0.3288 | pt_loss: 1.0938 | pg_loss: -0.0338 | reg_loss: 0.3626 | reward: -0.0800 | rev_kl: 0.8488 | stu_lens: 118.5000 | mixed_lens: 128.0000 | lr: 2.8149e-06 | scale: 1024.00 | time: 26.912 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2359/  5000| tot_loss: 2.1352 | rl_loss: 0.4031 | pt_loss: 1.7321 | pg_loss: -0.0345 | reg_loss: 0.4376 | reward: -0.0563 | rev_kl: 1.0595 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8133e-06 | scale: 1024.00 | time: 26.917 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2360/  5000| tot_loss: 2.4312 | rl_loss: 0.6899 | pt_loss: 1.7413 | pg_loss: 0.2350 | reg_loss: 0.4548 | reward: -0.2286 | rev_kl: 0.5022 | stu_lens: 73.5000 | mixed_lens: 72.0000 | lr: 2.8117e-06 | scale: 1024.00 | time: 26.881 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2361/  5000| tot_loss: 1.9820 | rl_loss: 0.3553 | pt_loss: 1.6267 | pg_loss: 0.0041 | reg_loss: 0.3513 | reward: -0.1781 | rev_kl: 0.6917 | stu_lens: 80.0000 | mixed_lens: 128.0000 | lr: 2.8102e-06 | scale: 1024.00 | time: 26.898 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2362/  5000| tot_loss: 3.3607 | rl_loss: 1.5296 | pt_loss: 1.8311 | pg_loss: 0.4788 | reg_loss: 1.0508 | reward: -0.7163 | rev_kl: 0.9469 | stu_lens: 86.0000 | mixed_lens: 36.0000 | lr: 2.8086e-06 | scale: 1024.00 | time: 26.912 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2363/  5000| tot_loss: 1.8317 | rl_loss: 0.5130 | pt_loss: 1.3187 | pg_loss: 0.2066 | reg_loss: 0.3064 | reward: -0.5790 | rev_kl: 0.9956 | stu_lens: 107.5000 | mixed_lens: 89.0000 | lr: 2.8070e-06 | scale: 1024.00 | time: 26.948 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2364/  5000| tot_loss: 2.3905 | rl_loss: 0.4361 | pt_loss: 1.9543 | pg_loss: -0.0028 | reg_loss: 0.4389 | reward: -0.1634 | rev_kl: 0.8705 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8054e-06 | scale: 1024.00 | time: 26.919 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2365/  5000| tot_loss: 1.9819 | rl_loss: 0.4469 | pt_loss: 1.5349 | pg_loss: 0.0797 | reg_loss: 0.3672 | reward: -0.2387 | rev_kl: 0.6267 | stu_lens: 128.0000 | mixed_lens: 102.0000 | lr: 2.8038e-06 | scale: 1024.00 | time: 26.995 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2366/  5000| tot_loss: 2.5631 | rl_loss: 0.7294 | pt_loss: 1.8337 | pg_loss: 0.4835 | reg_loss: 0.2459 | reward: -0.0665 | rev_kl: 0.2726 | stu_lens: 67.0000 | mixed_lens: 67.0000 | lr: 2.8022e-06 | scale: 1024.00 | time: 26.958 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2367/  5000| tot_loss: 2.7825 | rl_loss: 0.8459 | pt_loss: 1.9367 | pg_loss: 0.3783 | reg_loss: 0.4676 | reward: 0.1327 | rev_kl: 0.2933 | stu_lens: 31.0000 | mixed_lens: 68.5000 | lr: 2.8006e-06 | scale: 1024.00 | time: 26.972 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2368/  5000| tot_loss: 2.2965 | rl_loss: 0.3811 | pt_loss: 1.9153 | pg_loss: 0.0975 | reg_loss: 0.2837 | reward: -0.4318 | rev_kl: 1.0273 | stu_lens: 81.0000 | mixed_lens: 79.5000 | lr: 2.7990e-06 | scale: 1024.00 | time: 26.987 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2368/  5000| tot_loss: 2.3991 | rl_loss: 0.6082 | pt_loss: 1.7909 | pg_loss: 0.2018 | reg_loss: 0.4064 | reward: -0.3162 | rev_kl: 0.8771 | stu_lens: 95.2344 | mixed_lens: 92.0781 | lr: 2.7990e-06 | scale: 1024.00 | time: 26.987 | step time: 28.174
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2369/  5000| tot_loss: 1.9955 | rl_loss: 0.6873 | pt_loss: 1.3081 | pg_loss: 0.1706 | reg_loss: 0.5167 | reward: -0.2149 | rev_kl: 0.6128 | stu_lens: 109.5000 | mixed_lens: 98.5000 | lr: 2.7974e-06 | scale: 1024.00 | time: 26.968 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2370/  5000| tot_loss: 2.7156 | rl_loss: 1.2210 | pt_loss: 1.4946 | pg_loss: 0.0516 | reg_loss: 1.1694 | reward: -0.1384 | rev_kl: 0.9496 | stu_lens: 97.5000 | mixed_lens: 128.0000 | lr: 2.7958e-06 | scale: 1024.00 | time: 26.972 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2371/  5000| tot_loss: 3.6124 | rl_loss: 1.7476 | pt_loss: 1.8648 | pg_loss: 0.4974 | reg_loss: 1.2502 | reward: -0.3203 | rev_kl: 1.2755 | stu_lens: 67.0000 | mixed_lens: 73.0000 | lr: 2.7942e-06 | scale: 1024.00 | time: 26.940 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2372/  5000| tot_loss: 3.1846 | rl_loss: 1.3668 | pt_loss: 1.8178 | pg_loss: 0.3439 | reg_loss: 1.0229 | reward: -0.5411 | rev_kl: 1.3969 | stu_lens: 61.5000 | mixed_lens: 85.5000 | lr: 2.7926e-06 | scale: 1024.00 | time: 26.947 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2373/  5000| tot_loss: 2.6139 | rl_loss: 0.9774 | pt_loss: 1.6364 | pg_loss: 0.0377 | reg_loss: 0.9398 | reward: -0.2953 | rev_kl: 0.7613 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.7911e-06 | scale: 1024.00 | time: 26.946 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2374/  5000| tot_loss: 2.6520 | rl_loss: 0.9794 | pt_loss: 1.6726 | pg_loss: 0.1532 | reg_loss: 0.8262 | reward: -0.2008 | rev_kl: 0.8989 | stu_lens: 81.5000 | mixed_lens: 105.5000 | lr: 2.7895e-06 | scale: 1024.00 | time: 26.960 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2375/  5000| tot_loss: 2.4291 | rl_loss: 0.5995 | pt_loss: 1.8296 | pg_loss: 0.0530 | reg_loss: 0.5465 | reward: -0.5360 | rev_kl: 1.7424 | stu_lens: 29.5000 | mixed_lens: 30.5000 | lr: 2.7879e-06 | scale: 1024.00 | time: 26.910 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2376/  5000| tot_loss: 2.6640 | rl_loss: 1.1433 | pt_loss: 1.5207 | pg_loss: 0.0559 | reg_loss: 1.0873 | reward: -0.3227 | rev_kl: 1.4422 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.7863e-06 | scale: 1024.00 | time: 26.912 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2377/  5000| tot_loss: 2.4892 | rl_loss: 1.1268 | pt_loss: 1.3624 | pg_loss: 0.0475 | reg_loss: 1.0793 | reward: -0.2027 | rev_kl: 0.8808 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.7847e-06 | scale: 1024.00 | time: 26.889 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2378/  5000| tot_loss: 2.7743 | rl_loss: 1.1961 | pt_loss: 1.5782 | pg_loss: 0.4520 | reg_loss: 0.7442 | reward: -0.3273 | rev_kl: 1.0329 | stu_lens: 53.5000 | mixed_lens: 71.5000 | lr: 2.7831e-06 | scale: 1024.00 | time: 26.933 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2379/  5000| tot_loss: 2.4228 | rl_loss: 1.2389 | pt_loss: 1.1838 | pg_loss: 0.2541 | reg_loss: 0.9849 | reward: -0.2746 | rev_kl: 0.6935 | stu_lens: 73.5000 | mixed_lens: 102.0000 | lr: 2.7815e-06 | scale: 1024.00 | time: 26.936 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2380/  5000| tot_loss: 2.7420 | rl_loss: 1.3494 | pt_loss: 1.3926 | pg_loss: 0.4224 | reg_loss: 0.9270 | reward: -0.1428 | rev_kl: 0.7859 | stu_lens: 73.0000 | mixed_lens: 69.0000 | lr: 2.7799e-06 | scale: 1024.00 | time: 26.955 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2381/  5000| tot_loss: 3.8753 | rl_loss: 2.0575 | pt_loss: 1.8178 | pg_loss: 1.1409 | reg_loss: 0.9166 | reward: -0.3738 | rev_kl: 0.9423 | stu_lens: 28.0000 | mixed_lens: 41.5000 | lr: 2.7783e-06 | scale: 1024.00 | time: 26.914 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2382/  5000| tot_loss: 3.0595 | rl_loss: 1.2724 | pt_loss: 1.7871 | pg_loss: 0.1330 | reg_loss: 1.1394 | reward: -0.3600 | rev_kl: 1.2943 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 2.7767e-06 | scale: 1024.00 | time: 26.984 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2383/  5000| tot_loss: 3.5730 | rl_loss: 1.9375 | pt_loss: 1.6356 | pg_loss: 0.5950 | reg_loss: 1.3425 | reward: -0.8537 | rev_kl: 1.4736 | stu_lens: 75.0000 | mixed_lens: 73.0000 | lr: 2.7751e-06 | scale: 1024.00 | time: 26.970 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2384/  5000| tot_loss: 2.4889 | rl_loss: 0.4860 | pt_loss: 2.0029 | pg_loss: 0.0762 | reg_loss: 0.4098 | reward: -0.1840 | rev_kl: 0.3047 | stu_lens: 111.5000 | mixed_lens: 111.5000 | lr: 2.7735e-06 | scale: 1024.00 | time: 26.977 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2384/  5000| tot_loss: 2.7854 | rl_loss: 1.1848 | pt_loss: 1.6006 | pg_loss: 0.2682 | reg_loss: 0.9166 | reward: -0.3538 | rev_kl: 0.8998 | stu_lens: 92.5781 | mixed_lens: 93.2812 | lr: 2.7735e-06 | scale: 1024.00 | time: 26.977 | step time: 28.175
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2385/  5000| tot_loss: 3.0318 | rl_loss: 1.2742 | pt_loss: 1.7576 | pg_loss: 0.1714 | reg_loss: 1.1028 | reward: -0.2235 | rev_kl: 1.1922 | stu_lens: 98.5000 | mixed_lens: 113.0000 | lr: 2.7719e-06 | scale: 1024.00 | time: 26.939 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2386/  5000| tot_loss: 2.3706 | rl_loss: 0.9021 | pt_loss: 1.4685 | pg_loss: 0.0034 | reg_loss: 0.8986 | reward: -0.2174 | rev_kl: 0.7471 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.7704e-06 | scale: 1024.00 | time: 26.966 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2387/  5000| tot_loss: 2.5311 | rl_loss: 0.7288 | pt_loss: 1.8023 | pg_loss: -0.0070 | reg_loss: 0.7359 | reward: -0.2007 | rev_kl: 0.8695 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.7688e-06 | scale: 1024.00 | time: 26.928 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2388/  5000| tot_loss: 2.6454 | rl_loss: 0.9764 | pt_loss: 1.6690 | pg_loss: 0.1458 | reg_loss: 0.8307 | reward: -0.2084 | rev_kl: 0.9381 | stu_lens: 111.0000 | mixed_lens: 111.0000 | lr: 2.7672e-06 | scale: 1024.00 | time: 26.964 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2389/  5000| tot_loss: 2.7120 | rl_loss: 1.3388 | pt_loss: 1.3732 | pg_loss: 0.3125 | reg_loss: 1.0263 | reward: -0.1398 | rev_kl: 0.4408 | stu_lens: 73.0000 | mixed_lens: 76.0000 | lr: 2.7656e-06 | scale: 1024.00 | time: 26.886 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2390/  5000| tot_loss: 2.3966 | rl_loss: 0.6773 | pt_loss: 1.7192 | pg_loss: 0.1293 | reg_loss: 0.5480 | reward: -0.2947 | rev_kl: 0.8839 | stu_lens: 71.0000 | mixed_lens: 106.5000 | lr: 2.7640e-06 | scale: 1024.00 | time: 26.909 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2391/  5000| tot_loss: 1.8085 | rl_loss: 0.5560 | pt_loss: 1.2525 | pg_loss: -0.0304 | reg_loss: 0.5864 | reward: -0.1865 | rev_kl: 1.1699 | stu_lens: 88.0000 | mixed_lens: 128.0000 | lr: 2.7624e-06 | scale: 1024.00 | time: 26.883 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2392/  5000| tot_loss: 2.4555 | rl_loss: 0.7965 | pt_loss: 1.6591 | pg_loss: 0.2463 | reg_loss: 0.5502 | reward: -0.5411 | rev_kl: 1.3969 | stu_lens: 61.5000 | mixed_lens: 85.5000 | lr: 2.7608e-06 | scale: 1024.00 | time: 26.906 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2393/  5000| tot_loss: 2.5865 | rl_loss: 0.8136 | pt_loss: 1.7729 | pg_loss: 0.1390 | reg_loss: 0.6746 | reward: -0.4346 | rev_kl: 1.0521 | stu_lens: 128.0000 | mixed_lens: 86.5000 | lr: 2.7592e-06 | scale: 1024.00 | time: 26.898 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2394/  5000| tot_loss: 2.5332 | rl_loss: 0.9374 | pt_loss: 1.5958 | pg_loss: 0.1389 | reg_loss: 0.7985 | reward: -0.2492 | rev_kl: 1.3016 | stu_lens: 94.0000 | mixed_lens: 113.0000 | lr: 2.7576e-06 | scale: 1024.00 | time: 26.915 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2395/  5000| tot_loss: 2.6853 | rl_loss: 0.7690 | pt_loss: 1.9163 | pg_loss: -0.0105 | reg_loss: 0.7796 | reward: -0.4066 | rev_kl: 0.8070 | stu_lens: 104.0000 | mixed_lens: 128.0000 | lr: 2.7560e-06 | scale: 1024.00 | time: 26.903 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2396/  5000| tot_loss: 2.5548 | rl_loss: 0.7752 | pt_loss: 1.7796 | pg_loss: 0.0893 | reg_loss: 0.6858 | reward: -0.2236 | rev_kl: 0.6875 | stu_lens: 107.5000 | mixed_lens: 120.5000 | lr: 2.7544e-06 | scale: 1024.00 | time: 26.932 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2397/  5000| tot_loss: 1.9848 | rl_loss: 0.4645 | pt_loss: 1.5204 | pg_loss: 0.0005 | reg_loss: 0.4640 | reward: -0.0060 | rev_kl: 0.4799 | stu_lens: 87.5000 | mixed_lens: 87.0000 | lr: 2.7528e-06 | scale: 1024.00 | time: 26.935 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2398/  5000| tot_loss: 2.4138 | rl_loss: 0.7963 | pt_loss: 1.6176 | pg_loss: 0.2124 | reg_loss: 0.5839 | reward: -0.2732 | rev_kl: 0.8290 | stu_lens: 79.5000 | mixed_lens: 91.5000 | lr: 2.7512e-06 | scale: 1024.00 | time: 26.946 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2399/  5000| tot_loss: 2.9731 | rl_loss: 1.1508 | pt_loss: 1.8223 | pg_loss: 0.3202 | reg_loss: 0.8307 | reward: -0.2989 | rev_kl: 0.9963 | stu_lens: 97.5000 | mixed_lens: 89.0000 | lr: 2.7496e-06 | scale: 1024.00 | time: 26.975 | step time: 0.000
                                 Evaluation #24                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son una familia de        │
│                                       │ partículas elementales que incluyen  │
│                                       │ a los quarks y a los antiquarks. Los │
│                                       │ quarks tienen carga de color, que    │
│                                       │ determina la capacidad del cuark de  │
│                                       │ realizar una interacción de color, y │
│                                       │ también tienen carga de isospín, que │
│                                       │ determina si el cuark es siguiendo o │
│                                       │ antiél. Los antiquarks son iguales a │
│                                       │ los quarks en todas las respectivas  │
│                                       │ propiedades, excepto en la carga de  │
│                                       │ isospín, que es el opuesto.          │
│                                       │                                      │
│                                       │ Los cuarks de color pueden ser de    │
│                                       │ tres                                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC, o Integrated Marketing       │
│                                       │ Communications, es el nombre que se  │
│                                       │ da a la práctica de combinación de   │
│                                       │ medios de comunicación que incluye   │
│                                       │ publicidad, marketing directo,       │
│                                       │ relaciones públicas y otros. La idea │
│                                       │ es que la combinación de estos       │
│                                       │ medios de comunicación puede mejorar │
│                                       │ la efectividad de los campos         │
│                                       │ individuales, por lo general, esta   │
│                                       │ combinación se desarrolla a través   │
│                                       │ de una estrategia de comunicación.   │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ 1. Cápsula del tiempo de Pizarro,    │
│                                       │ 1492                                 │
│                                       │ 2. Cápsula del tiempo de Cristóbal   │
│                                       │ Colón, 1492                          │
│                                       │ 3. Cápsula del tiempo de Magellan,   │
│                                       │ 1522                                 │
│                                       │ 4. Cápsula del tiempo de Felipe II,  │
│                                       │ 1586                                 │
│                                       │ 5. Cápsula del tiempo de Juan de     │
│                                       │ Fuca, 1611                           │
│                                       │ 6. Cápsula del tiempo de Bermúdez,   │
│                                       │ 1620                                 │
│                                       │ 7. Cápsula del tiempo de             │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.032 | exact_match: 0.104 | rev_kl: 0.831 | lens: 101.247 | pt_loss: 1.733 | lm_loss: 1.863 | kd_loss: 1.602 
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2400/  5000| tot_loss: 2.1615 | rl_loss: 0.9145 | pt_loss: 1.2470 | pg_loss: 0.3679 | reg_loss: 0.5466 | reward: -0.6912 | rev_kl: 0.4800 | stu_lens: 82.5000 | mixed_lens: 67.0000 | lr: 2.7480e-06 | scale: 1024.00 | time: 27.009 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2400/  5000| tot_loss: 2.5287 | rl_loss: 0.8685 | pt_loss: 1.6601 | pg_loss: 0.1797 | reg_loss: 0.6889 | reward: -0.3285 | rev_kl: 0.9034 | stu_lens: 95.7188 | mixed_lens: 99.0781 | lr: 2.7480e-06 | scale: 1024.00 | time: 27.009 | step time: 28.161
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2401/  5000| tot_loss: 2.4310 | rl_loss: 1.1119 | pt_loss: 1.3191 | pg_loss: 0.3349 | reg_loss: 0.7770 | reward: -0.3528 | rev_kl: 0.6969 | stu_lens: 68.5000 | mixed_lens: 70.5000 | lr: 2.7464e-06 | scale: 1024.00 | time: 27.037 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2402/  5000| tot_loss: 2.1556 | rl_loss: 0.5649 | pt_loss: 1.5907 | pg_loss: 0.0007 | reg_loss: 0.5643 | reward: -0.2472 | rev_kl: 0.6924 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.7448e-06 | scale: 1024.00 | time: 27.009 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2403/  5000| tot_loss: 2.6173 | rl_loss: 0.8783 | pt_loss: 1.7390 | pg_loss: 0.3129 | reg_loss: 0.5655 | reward: -0.2583 | rev_kl: 0.9439 | stu_lens: 46.0000 | mixed_lens: 78.0000 | lr: 2.7432e-06 | scale: 1024.00 | time: 26.963 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2404/  5000| tot_loss: 2.9124 | rl_loss: 1.4873 | pt_loss: 1.4251 | pg_loss: 1.0068 | reg_loss: 0.4805 | reward: -0.8037 | rev_kl: 0.9456 | stu_lens: 49.0000 | mixed_lens: 24.5000 | lr: 2.7417e-06 | scale: 1024.00 | time: 26.984 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2405/  5000| tot_loss: 2.1974 | rl_loss: 0.5209 | pt_loss: 1.6765 | pg_loss: -0.0005 | reg_loss: 0.5214 | reward: -0.1831 | rev_kl: 0.8791 | stu_lens: 104.5000 | mixed_lens: 128.0000 | lr: 2.7401e-06 | scale: 1024.00 | time: 26.955 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2406/  5000| tot_loss: 1.7431 | rl_loss: 0.4219 | pt_loss: 1.3212 | pg_loss: 0.0311 | reg_loss: 0.3908 | reward: -0.2293 | rev_kl: 0.9522 | stu_lens: 72.5000 | mixed_lens: 108.5000 | lr: 2.7385e-06 | scale: 1024.00 | time: 26.954 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2407/  5000| tot_loss: 2.6249 | rl_loss: 0.7301 | pt_loss: 1.8947 | pg_loss: 0.2481 | reg_loss: 0.4820 | reward: -0.1240 | rev_kl: 1.0650 | stu_lens: 119.0000 | mixed_lens: 99.5000 | lr: 2.7369e-06 | scale: 1024.00 | time: 26.935 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2408/  5000| tot_loss: 2.4130 | rl_loss: 0.5706 | pt_loss: 1.8424 | pg_loss: 0.2356 | reg_loss: 0.3349 | reward: -0.7814 | rev_kl: 0.4627 | stu_lens: 82.5000 | mixed_lens: 67.0000 | lr: 2.7353e-06 | scale: 1024.00 | time: 26.943 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2409/  5000| tot_loss: 2.7750 | rl_loss: 0.7963 | pt_loss: 1.9787 | pg_loss: 0.2994 | reg_loss: 0.4969 | reward: -0.2286 | rev_kl: 0.9022 | stu_lens: 70.0000 | mixed_lens: 67.0000 | lr: 2.7337e-06 | scale: 1024.00 | time: 26.944 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2410/  5000| tot_loss: 2.3174 | rl_loss: 0.6205 | pt_loss: 1.6969 | pg_loss: 0.0736 | reg_loss: 0.5468 | reward: -0.2235 | rev_kl: 1.1922 | stu_lens: 98.5000 | mixed_lens: 113.0000 | lr: 2.7321e-06 | scale: 1024.00 | time: 26.934 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2411/  5000| tot_loss: 2.3992 | rl_loss: 0.4559 | pt_loss: 1.9432 | pg_loss: -0.0160 | reg_loss: 0.4719 | reward: -0.1750 | rev_kl: 0.7505 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.7305e-06 | scale: 1024.00 | time: 27.013 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2412/  5000| tot_loss: 2.0033 | rl_loss: 0.5289 | pt_loss: 1.4744 | pg_loss: 0.0114 | reg_loss: 0.5175 | reward: -0.2217 | rev_kl: 1.0807 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.7289e-06 | scale: 1024.00 | time: 26.980 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2413/  5000| tot_loss: 2.2973 | rl_loss: 0.5413 | pt_loss: 1.7560 | pg_loss: 0.0302 | reg_loss: 0.5111 | reward: -0.2327 | rev_kl: 1.0754 | stu_lens: 118.0000 | mixed_lens: 121.0000 | lr: 2.7273e-06 | scale: 1024.00 | time: 26.978 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2414/  5000| tot_loss: 2.4430 | rl_loss: 0.6149 | pt_loss: 1.8282 | pg_loss: 0.1032 | reg_loss: 0.5117 | reward: -0.2008 | rev_kl: 0.8989 | stu_lens: 81.5000 | mixed_lens: 105.5000 | lr: 2.7257e-06 | scale: 1024.00 | time: 26.957 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2415/  5000| tot_loss: 1.7690 | rl_loss: 0.2861 | pt_loss: 1.4828 | pg_loss: -0.0120 | reg_loss: 0.2981 | reward: -0.3135 | rev_kl: 0.3938 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.7241e-06 | scale: 1024.00 | time: 27.008 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2416/  5000| tot_loss: 3.6216 | rl_loss: 1.5633 | pt_loss: 2.0583 | pg_loss: 0.9170 | reg_loss: 0.6463 | reward: -0.5435 | rev_kl: 0.9214 | stu_lens: 58.5000 | mixed_lens: 55.5000 | lr: 2.7225e-06 | scale: 1024.00 | time: 26.995 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2416/  5000| tot_loss: 2.4385 | rl_loss: 0.7080 | pt_loss: 1.7304 | pg_loss: 0.2234 | reg_loss: 0.4846 | reward: -0.3469 | rev_kl: 0.9074 | stu_lens: 92.2812 | mixed_lens: 93.4688 | lr: 2.7225e-06 | scale: 1024.00 | time: 26.995 | step time: 28.205
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2417/  5000| tot_loss: 1.8498 | rl_loss: 0.6159 | pt_loss: 1.2338 | pg_loss: 0.1102 | reg_loss: 0.5058 | reward: -0.4717 | rev_kl: 1.0587 | stu_lens: 107.5000 | mixed_lens: 79.0000 | lr: 2.7209e-06 | scale: 1024.00 | time: 26.991 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2418/  5000| tot_loss: 2.0612 | rl_loss: 0.3845 | pt_loss: 1.6767 | pg_loss: -0.0096 | reg_loss: 0.3941 | reward: -0.1181 | rev_kl: 0.7900 | stu_lens: 123.5000 | mixed_lens: 128.0000 | lr: 2.7193e-06 | scale: 1024.00 | time: 26.922 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2419/  5000| tot_loss: 2.1839 | rl_loss: 0.2756 | pt_loss: 1.9083 | pg_loss: -0.0417 | reg_loss: 0.3173 | reward: -0.0488 | rev_kl: 0.7955 | stu_lens: 87.5000 | mixed_lens: 87.0000 | lr: 2.7177e-06 | scale: 1024.00 | time: 26.952 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2420/  5000| tot_loss: 2.2069 | rl_loss: 0.5346 | pt_loss: 1.6722 | pg_loss: 0.0784 | reg_loss: 0.4562 | reward: -0.9948 | rev_kl: 1.5228 | stu_lens: 75.0000 | mixed_lens: 31.5000 | lr: 2.7161e-06 | scale: 1024.00 | time: 26.935 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2421/  5000| tot_loss: 2.3396 | rl_loss: 0.6214 | pt_loss: 1.7182 | pg_loss: 0.3107 | reg_loss: 0.3107 | reward: -0.3044 | rev_kl: 0.9555 | stu_lens: 67.0000 | mixed_lens: 73.0000 | lr: 2.7145e-06 | scale: 1024.00 | time: 26.957 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2422/  5000| tot_loss: 2.6218 | rl_loss: 0.3234 | pt_loss: 2.2984 | pg_loss: -0.0140 | reg_loss: 0.3374 | reward: -0.1983 | rev_kl: 0.6170 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.7129e-06 | scale: 1024.00 | time: 26.915 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2423/  5000| tot_loss: 2.3764 | rl_loss: 0.5950 | pt_loss: 1.7813 | pg_loss: -0.0015 | reg_loss: 0.5965 | reward: -0.3082 | rev_kl: 0.6705 | stu_lens: 104.0000 | mixed_lens: 128.0000 | lr: 2.7113e-06 | scale: 1024.00 | time: 26.947 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2424/  5000| tot_loss: 3.0346 | rl_loss: 1.0588 | pt_loss: 1.9758 | pg_loss: 0.5242 | reg_loss: 0.5347 | reward: -0.4839 | rev_kl: 1.2085 | stu_lens: 39.0000 | mixed_lens: 55.5000 | lr: 2.7097e-06 | scale: 1024.00 | time: 26.969 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2425/  5000| tot_loss: 2.4191 | rl_loss: 0.5805 | pt_loss: 1.8386 | pg_loss: 0.2407 | reg_loss: 0.3398 | reward: -0.5787 | rev_kl: 0.7613 | stu_lens: 75.5000 | mixed_lens: 72.5000 | lr: 2.7081e-06 | scale: 1024.00 | time: 26.969 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2426/  5000| tot_loss: 2.2787 | rl_loss: 0.4677 | pt_loss: 1.8111 | pg_loss: 0.0986 | reg_loss: 0.3691 | reward: -0.3172 | rev_kl: 0.9787 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 2.7065e-06 | scale: 1024.00 | time: 26.971 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2427/  5000| tot_loss: 2.3333 | rl_loss: 0.4417 | pt_loss: 1.8916 | pg_loss: 0.0451 | reg_loss: 0.3967 | reward: -0.2823 | rev_kl: 0.7505 | stu_lens: 128.0000 | mixed_lens: 116.0000 | lr: 2.7049e-06 | scale: 1024.00 | time: 26.970 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2428/  5000| tot_loss: 2.7073 | rl_loss: 0.9428 | pt_loss: 1.7645 | pg_loss: 0.3615 | reg_loss: 0.5814 | reward: -0.1431 | rev_kl: 1.2356 | stu_lens: 102.0000 | mixed_lens: 82.5000 | lr: 2.7033e-06 | scale: 1024.00 | time: 26.949 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2429/  5000| tot_loss: 2.6421 | rl_loss: 0.5889 | pt_loss: 2.0532 | pg_loss: 0.1434 | reg_loss: 0.4455 | reward: -0.1960 | rev_kl: 0.7532 | stu_lens: 87.5000 | mixed_lens: 102.0000 | lr: 2.7017e-06 | scale: 1024.00 | time: 26.984 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2430/  5000| tot_loss: 2.4341 | rl_loss: 0.6087 | pt_loss: 1.8254 | pg_loss: 0.2259 | reg_loss: 0.3828 | reward: -0.5983 | rev_kl: 0.7750 | stu_lens: 110.0000 | mixed_lens: 79.5000 | lr: 2.7001e-06 | scale: 1024.00 | time: 26.976 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2431/  5000| tot_loss: 2.1528 | rl_loss: 0.4442 | pt_loss: 1.7086 | pg_loss: 0.0431 | reg_loss: 0.4010 | reward: -0.2852 | rev_kl: 0.9767 | stu_lens: 128.0000 | mixed_lens: 121.0000 | lr: 2.6985e-06 | scale: 1024.00 | time: 26.966 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2432/  5000| tot_loss: 2.5705 | rl_loss: 0.3611 | pt_loss: 2.2094 | pg_loss: 0.2540 | reg_loss: 0.1071 | reward: -0.2400 | rev_kl: 0.4529 | stu_lens: 60.0000 | mixed_lens: 61.5000 | lr: 2.6969e-06 | scale: 1024.00 | time: 26.947 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2432/  5000| tot_loss: 2.3200 | rl_loss: 0.5713 | pt_loss: 1.7487 | pg_loss: 0.1815 | reg_loss: 0.3898 | reward: -0.3712 | rev_kl: 0.9486 | stu_lens: 93.2500 | mixed_lens: 91.8281 | lr: 2.6969e-06 | scale: 1024.00 | time: 26.947 | step time: 28.187
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2433/  5000| tot_loss: 1.6417 | rl_loss: 0.3719 | pt_loss: 1.2699 | pg_loss: -0.0176 | reg_loss: 0.3894 | reward: -0.2410 | rev_kl: 0.9617 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6953e-06 | scale: 1024.00 | time: 26.975 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2434/  5000| tot_loss: 2.8325 | rl_loss: 1.2042 | pt_loss: 1.6283 | pg_loss: 0.1617 | reg_loss: 1.0425 | reward: -0.1532 | rev_kl: 1.1122 | stu_lens: 89.5000 | mixed_lens: 112.5000 | lr: 2.6938e-06 | scale: 1024.00 | time: 26.997 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2435/  5000| tot_loss: 2.8794 | rl_loss: 1.0893 | pt_loss: 1.7901 | pg_loss: 0.2959 | reg_loss: 0.7934 | reward: 0.0824 | rev_kl: 0.6637 | stu_lens: 101.5000 | mixed_lens: 78.0000 | lr: 2.6922e-06 | scale: 1024.00 | time: 26.979 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2436/  5000| tot_loss: 3.0274 | rl_loss: 0.9855 | pt_loss: 2.0419 | pg_loss: 0.1401 | reg_loss: 0.8454 | reward: -0.2488 | rev_kl: 0.3361 | stu_lens: 128.0000 | mixed_lens: 104.5000 | lr: 2.6906e-06 | scale: 1024.00 | time: 27.025 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2437/  5000| tot_loss: 3.6619 | rl_loss: 1.5709 | pt_loss: 2.0909 | pg_loss: 0.4281 | reg_loss: 1.1428 | reward: -0.8840 | rev_kl: 0.5719 | stu_lens: 128.0000 | mixed_lens: 69.0000 | lr: 2.6890e-06 | scale: 1024.00 | time: 26.941 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2438/  5000| tot_loss: 3.4177 | rl_loss: 1.6510 | pt_loss: 1.7667 | pg_loss: 0.3697 | reg_loss: 1.2813 | reward: -0.3132 | rev_kl: 1.0124 | stu_lens: 128.0000 | mixed_lens: 81.0000 | lr: 2.6874e-06 | scale: 1024.00 | time: 26.972 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2439/  5000| tot_loss: 2.9401 | rl_loss: 0.9407 | pt_loss: 1.9994 | pg_loss: 0.0962 | reg_loss: 0.8445 | reward: -0.1328 | rev_kl: 0.8746 | stu_lens: 128.0000 | mixed_lens: 118.0000 | lr: 2.6858e-06 | scale: 1024.00 | time: 26.997 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2440/  5000| tot_loss: 2.7175 | rl_loss: 0.9960 | pt_loss: 1.7214 | pg_loss: 0.0744 | reg_loss: 0.9216 | reward: -0.2214 | rev_kl: 1.0919 | stu_lens: 72.0000 | mixed_lens: 128.0000 | lr: 2.6842e-06 | scale: 1024.00 | time: 26.958 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2441/  5000| tot_loss: 2.6281 | rl_loss: 1.0014 | pt_loss: 1.6267 | pg_loss: 0.1989 | reg_loss: 0.8025 | reward: -0.3203 | rev_kl: 0.9070 | stu_lens: 106.5000 | mixed_lens: 111.0000 | lr: 2.6826e-06 | scale: 1024.00 | time: 26.996 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2442/  5000| tot_loss: 2.6245 | rl_loss: 1.0771 | pt_loss: 1.5474 | pg_loss: 0.0784 | reg_loss: 0.9988 | reward: -0.2271 | rev_kl: 0.7464 | stu_lens: 113.0000 | mixed_lens: 123.0000 | lr: 2.6810e-06 | scale: 1024.00 | time: 26.964 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2443/  5000| tot_loss: 3.1922 | rl_loss: 2.0264 | pt_loss: 1.1659 | pg_loss: 1.0086 | reg_loss: 1.0178 | reward: -0.3358 | rev_kl: 3.2257 | stu_lens: 37.5000 | mixed_lens: 30.0000 | lr: 2.6794e-06 | scale: 1024.00 | time: 27.015 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2444/  5000| tot_loss: 2.9524 | rl_loss: 1.1255 | pt_loss: 1.8269 | pg_loss: 0.0482 | reg_loss: 1.0773 | reward: -0.1556 | rev_kl: 1.0457 | stu_lens: 86.5000 | mixed_lens: 128.0000 | lr: 2.6778e-06 | scale: 1024.00 | time: 26.959 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2445/  5000| tot_loss: 2.0033 | rl_loss: 0.9751 | pt_loss: 1.0281 | pg_loss: 0.0632 | reg_loss: 0.9119 | reward: -0.1167 | rev_kl: 0.8175 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6762e-06 | scale: 1024.00 | time: 26.978 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2446/  5000| tot_loss: 3.5388 | rl_loss: 2.0363 | pt_loss: 1.5025 | pg_loss: 0.8902 | reg_loss: 1.1460 | reward: -0.2237 | rev_kl: 0.8391 | stu_lens: 121.5000 | mixed_lens: 58.0000 | lr: 2.6746e-06 | scale: 1024.00 | time: 26.955 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2447/  5000| tot_loss: 3.4526 | rl_loss: 1.4775 | pt_loss: 1.9750 | pg_loss: 0.4834 | reg_loss: 0.9941 | reward: -0.3627 | rev_kl: 0.9667 | stu_lens: 69.0000 | mixed_lens: 77.5000 | lr: 2.6730e-06 | scale: 1024.00 | time: 27.014 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2448/  5000| tot_loss: 2.9159 | rl_loss: 1.1276 | pt_loss: 1.7883 | pg_loss: 0.0642 | reg_loss: 1.0634 | reward: -0.1998 | rev_kl: 0.6707 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6714e-06 | scale: 1024.00 | time: 27.014 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2448/  5000| tot_loss: 2.8744 | rl_loss: 1.2241 | pt_loss: 1.6504 | pg_loss: 0.2927 | reg_loss: 0.9314 | reward: -0.3175 | rev_kl: 0.9137 | stu_lens: 107.1250 | mixed_lens: 96.8906 | lr: 2.6714e-06 | scale: 1024.00 | time: 27.014 | step time: 28.214
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2449/  5000| tot_loss: 2.9205 | rl_loss: 1.2209 | pt_loss: 1.6996 | pg_loss: 0.2040 | reg_loss: 1.0170 | reward: -0.3072 | rev_kl: 0.8711 | stu_lens: 128.0000 | mixed_lens: 108.0000 | lr: 2.6698e-06 | scale: 1024.00 | time: 27.062 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2450/  5000| tot_loss: 2.5965 | rl_loss: 0.7779 | pt_loss: 1.8186 | pg_loss: 0.1131 | reg_loss: 0.6648 | reward: -0.2385 | rev_kl: 0.8377 | stu_lens: 128.0000 | mixed_lens: 108.0000 | lr: 2.6682e-06 | scale: 1024.00 | time: 26.980 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2451/  5000| tot_loss: 3.1033 | rl_loss: 1.1994 | pt_loss: 1.9039 | pg_loss: 0.5056 | reg_loss: 0.6938 | reward: -0.4108 | rev_kl: 0.5359 | stu_lens: 69.0000 | mixed_lens: 77.5000 | lr: 2.6666e-06 | scale: 1024.00 | time: 27.004 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2452/  5000| tot_loss: 2.9239 | rl_loss: 0.9100 | pt_loss: 2.0140 | pg_loss: 0.0409 | reg_loss: 0.8691 | reward: -0.1461 | rev_kl: 0.8749 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6650e-06 | scale: 1024.00 | time: 26.989 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2453/  5000| tot_loss: 3.0274 | rl_loss: 0.9988 | pt_loss: 2.0286 | pg_loss: 0.2846 | reg_loss: 0.7142 | reward: -0.3309 | rev_kl: 3.0750 | stu_lens: 66.5000 | mixed_lens: 73.0000 | lr: 2.6634e-06 | scale: 1024.00 | time: 26.986 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2454/  5000| tot_loss: 2.8540 | rl_loss: 0.7360 | pt_loss: 2.1180 | pg_loss: 0.0069 | reg_loss: 0.7292 | reward: -0.2173 | rev_kl: 0.8743 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6618e-06 | scale: 1024.00 | time: 26.997 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2455/  5000| tot_loss: 2.6631 | rl_loss: 0.7668 | pt_loss: 1.8963 | pg_loss: -0.0069 | reg_loss: 0.7737 | reward: -0.2366 | rev_kl: 0.9922 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6602e-06 | scale: 1024.00 | time: 26.989 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2456/  5000| tot_loss: 2.3038 | rl_loss: 0.7841 | pt_loss: 1.5197 | pg_loss: -0.0075 | reg_loss: 0.7916 | reward: -0.2395 | rev_kl: 0.8827 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6586e-06 | scale: 1024.00 | time: 26.978 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2457/  5000| tot_loss: 2.2648 | rl_loss: 0.7103 | pt_loss: 1.5545 | pg_loss: 0.0369 | reg_loss: 0.6734 | reward: -0.1933 | rev_kl: 0.7679 | stu_lens: 118.0000 | mixed_lens: 123.0000 | lr: 2.6570e-06 | scale: 1024.00 | time: 27.014 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2458/  5000| tot_loss: 2.2388 | rl_loss: 0.6471 | pt_loss: 1.5917 | pg_loss: 0.0044 | reg_loss: 0.6427 | reward: -0.0341 | rev_kl: 0.7247 | stu_lens: 85.5000 | mixed_lens: 128.0000 | lr: 2.6554e-06 | scale: 1024.00 | time: 26.997 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2459/  5000| tot_loss: 2.0665 | rl_loss: 0.4445 | pt_loss: 1.6221 | pg_loss: -0.0235 | reg_loss: 0.4680 | reward: -0.0998 | rev_kl: 1.0742 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6538e-06 | scale: 1024.00 | time: 27.024 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2460/  5000| tot_loss: 2.4057 | rl_loss: 0.8597 | pt_loss: 1.5460 | pg_loss: 0.1304 | reg_loss: 0.7293 | reward: -0.1591 | rev_kl: 0.8551 | stu_lens: 83.0000 | mixed_lens: 112.5000 | lr: 2.6522e-06 | scale: 1024.00 | time: 27.003 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2461/  5000| tot_loss: 2.5673 | rl_loss: 0.8335 | pt_loss: 1.7337 | pg_loss: -0.0072 | reg_loss: 0.8407 | reward: -0.1195 | rev_kl: 0.9218 | stu_lens: 80.5000 | mixed_lens: 128.0000 | lr: 2.6506e-06 | scale: 1024.00 | time: 27.053 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2462/  5000| tot_loss: 2.8180 | rl_loss: 1.0299 | pt_loss: 1.7881 | pg_loss: 0.3312 | reg_loss: 0.6987 | reward: -0.3663 | rev_kl: 0.8809 | stu_lens: 128.0000 | mixed_lens: 94.0000 | lr: 2.6490e-06 | scale: 1024.00 | time: 26.992 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2463/  5000| tot_loss: 2.5502 | rl_loss: 0.5856 | pt_loss: 1.9646 | pg_loss: 0.1281 | reg_loss: 0.4575 | reward: -0.1621 | rev_kl: 0.5467 | stu_lens: 113.0000 | mixed_lens: 99.5000 | lr: 2.6474e-06 | scale: 1024.00 | time: 26.967 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2464/  5000| tot_loss: 2.6766 | rl_loss: 0.6991 | pt_loss: 1.9775 | pg_loss: 0.0922 | reg_loss: 0.6069 | reward: -0.2157 | rev_kl: 0.8823 | stu_lens: 50.0000 | mixed_lens: 86.0000 | lr: 2.6458e-06 | scale: 1024.00 | time: 26.964 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2464/  5000| tot_loss: 2.7617 | rl_loss: 0.9905 | pt_loss: 1.7712 | pg_loss: 0.2802 | reg_loss: 0.7103 | reward: -0.3107 | rev_kl: 0.8776 | stu_lens: 105.0156 | mixed_lens: 95.8438 | lr: 2.6458e-06 | scale: 1024.00 | time: 26.964 | step time: 28.230
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2465/  5000| tot_loss: 2.2001 | rl_loss: 0.8766 | pt_loss: 1.3235 | pg_loss: 0.0053 | reg_loss: 0.8713 | reward: -0.1776 | rev_kl: 0.9642 | stu_lens: 107.5000 | mixed_lens: 128.0000 | lr: 2.6442e-06 | scale: 1024.00 | time: 26.999 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2466/  5000| tot_loss: 2.7718 | rl_loss: 0.9687 | pt_loss: 1.8031 | pg_loss: 0.2801 | reg_loss: 0.6886 | reward: -0.2361 | rev_kl: 0.6845 | stu_lens: 128.0000 | mixed_lens: 88.0000 | lr: 2.6426e-06 | scale: 1024.00 | time: 26.973 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2467/  5000| tot_loss: 2.4810 | rl_loss: 0.4496 | pt_loss: 2.0315 | pg_loss: 0.1526 | reg_loss: 0.2969 | reward: 0.0343 | rev_kl: 0.5718 | stu_lens: 64.5000 | mixed_lens: 95.0000 | lr: 2.6410e-06 | scale: 1024.00 | time: 26.986 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2468/  5000| tot_loss: 2.4656 | rl_loss: 0.6126 | pt_loss: 1.8531 | pg_loss: -0.0172 | reg_loss: 0.6297 | reward: -0.1152 | rev_kl: 0.8733 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6394e-06 | scale: 1024.00 | time: 26.982 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2469/  5000| tot_loss: 2.2972 | rl_loss: 0.4380 | pt_loss: 1.8591 | pg_loss: 0.0565 | reg_loss: 0.3815 | reward: -0.1121 | rev_kl: 0.5190 | stu_lens: 72.5000 | mixed_lens: 117.0000 | lr: 2.6378e-06 | scale: 1024.00 | time: 27.014 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2470/  5000| tot_loss: 2.4633 | rl_loss: 0.4839 | pt_loss: 1.9794 | pg_loss: -0.0116 | reg_loss: 0.4955 | reward: -0.1889 | rev_kl: 0.9577 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6362e-06 | scale: 1024.00 | time: 26.985 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2471/  5000| tot_loss: 2.5309 | rl_loss: 0.8971 | pt_loss: 1.6338 | pg_loss: 0.2044 | reg_loss: 0.6926 | reward: -1.3376 | rev_kl: 1.0315 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 2.6346e-06 | scale: 1024.00 | time: 27.021 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2472/  5000| tot_loss: 2.3739 | rl_loss: 1.0081 | pt_loss: 1.3657 | pg_loss: 0.4552 | reg_loss: 0.5530 | reward: -0.7319 | rev_kl: 0.7522 | stu_lens: 126.0000 | mixed_lens: 70.0000 | lr: 2.6330e-06 | scale: 1024.00 | time: 27.017 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2473/  5000| tot_loss: 2.1163 | rl_loss: 0.4434 | pt_loss: 1.6729 | pg_loss: -0.0136 | reg_loss: 0.4570 | reward: -0.2364 | rev_kl: 0.6690 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6314e-06 | scale: 1024.00 | time: 27.054 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2474/  5000| tot_loss: 2.3663 | rl_loss: 0.5939 | pt_loss: 1.7725 | pg_loss: 0.0263 | reg_loss: 0.5676 | reward: -0.1002 | rev_kl: 0.8739 | stu_lens: 107.0000 | mixed_lens: 118.0000 | lr: 2.6298e-06 | scale: 1024.00 | time: 26.996 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2475/  5000| tot_loss: 2.1925 | rl_loss: 0.4936 | pt_loss: 1.6989 | pg_loss: 0.0235 | reg_loss: 0.4701 | reward: -0.2464 | rev_kl: 0.9055 | stu_lens: 118.5000 | mixed_lens: 109.5000 | lr: 2.6282e-06 | scale: 1024.00 | time: 27.010 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2476/  5000| tot_loss: 2.2942 | rl_loss: 0.4943 | pt_loss: 1.7999 | pg_loss: 0.1493 | reg_loss: 0.3450 | reward: -0.1306 | rev_kl: 0.7292 | stu_lens: 106.0000 | mixed_lens: 86.0000 | lr: 2.6266e-06 | scale: 1024.00 | time: 27.002 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2477/  5000| tot_loss: 3.5726 | rl_loss: 1.6286 | pt_loss: 1.9440 | pg_loss: 1.1039 | reg_loss: 0.5247 | reward: -0.4249 | rev_kl: 2.9648 | stu_lens: 66.5000 | mixed_lens: 39.0000 | lr: 2.6250e-06 | scale: 1024.00 | time: 27.043 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2478/  5000| tot_loss: 2.7471 | rl_loss: 0.6925 | pt_loss: 2.0547 | pg_loss: 0.1516 | reg_loss: 0.5409 | reward: -0.2410 | rev_kl: 0.9490 | stu_lens: 89.5000 | mixed_lens: 112.5000 | lr: 2.6234e-06 | scale: 1024.00 | time: 26.975 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2479/  5000| tot_loss: 2.3383 | rl_loss: 0.4064 | pt_loss: 1.9319 | pg_loss: -0.0165 | reg_loss: 0.4229 | reward: -0.1120 | rev_kl: 0.8034 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6218e-06 | scale: 1024.00 | time: 26.981 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2480/  5000| tot_loss: 2.1524 | rl_loss: 0.4729 | pt_loss: 1.6795 | pg_loss: 0.0078 | reg_loss: 0.4651 | reward: -0.1089 | rev_kl: 0.7801 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6202e-06 | scale: 1024.00 | time: 26.943 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2480/  5000| tot_loss: 2.3816 | rl_loss: 0.6691 | pt_loss: 1.7125 | pg_loss: 0.1445 | reg_loss: 0.5246 | reward: -0.3029 | rev_kl: 0.8983 | stu_lens: 108.5781 | mixed_lens: 97.6094 | lr: 2.6202e-06 | scale: 1024.00 | time: 26.943 | step time: 28.229
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2481/  5000| tot_loss: 2.1332 | rl_loss: 0.5155 | pt_loss: 1.6177 | pg_loss: -0.0022 | reg_loss: 0.5177 | reward: -0.1287 | rev_kl: 0.7307 | stu_lens: 121.5000 | mixed_lens: 128.0000 | lr: 2.6186e-06 | scale: 1024.00 | time: 26.971 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2482/  5000| tot_loss: 2.7768 | rl_loss: 0.5823 | pt_loss: 2.1945 | pg_loss: 0.1159 | reg_loss: 0.4664 | reward: -0.3993 | rev_kl: 1.0100 | stu_lens: 128.0000 | mixed_lens: 81.0000 | lr: 2.6170e-06 | scale: 1024.00 | time: 26.987 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2483/  5000| tot_loss: 4.7859 | rl_loss: 3.5300 | pt_loss: 1.2558 | pg_loss: 2.4935 | reg_loss: 1.0366 | reward: -1.3084 | rev_kl: 0.6879 | stu_lens: 126.0000 | mixed_lens: 11.0000 | lr: 2.6154e-06 | scale: 1024.00 | time: 27.024 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2484/  5000| tot_loss: 1.9375 | rl_loss: 0.5258 | pt_loss: 1.4117 | pg_loss: -0.0086 | reg_loss: 0.5344 | reward: -0.2340 | rev_kl: 0.5519 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6138e-06 | scale: 1024.00 | time: 27.027 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2485/  5000| tot_loss: 2.4830 | rl_loss: 0.7096 | pt_loss: 1.7733 | pg_loss: 0.4037 | reg_loss: 0.3060 | reward: -0.1413 | rev_kl: 0.7251 | stu_lens: 99.5000 | mixed_lens: 76.5000 | lr: 2.6122e-06 | scale: 1024.00 | time: 27.070 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2486/  5000| tot_loss: 2.0919 | rl_loss: 0.3216 | pt_loss: 1.7703 | pg_loss: -0.0196 | reg_loss: 0.3412 | reward: -0.1430 | rev_kl: 1.0783 | stu_lens: 101.5000 | mixed_lens: 128.0000 | lr: 2.6106e-06 | scale: 1024.00 | time: 27.058 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2487/  5000| tot_loss: 1.6866 | rl_loss: 0.2500 | pt_loss: 1.4366 | pg_loss: -0.0190 | reg_loss: 0.2690 | reward: -0.1769 | rev_kl: 0.7942 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.6090e-06 | scale: 1024.00 | time: 27.018 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2488/  5000| tot_loss: 2.0985 | rl_loss: 0.3340 | pt_loss: 1.7645 | pg_loss: 0.0945 | reg_loss: 0.2395 | reward: -0.2153 | rev_kl: 0.8343 | stu_lens: 128.0000 | mixed_lens: 103.5000 | lr: 2.6074e-06 | scale: 1024.00 | time: 26.999 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2489/  5000| tot_loss: 3.4549 | rl_loss: 1.7087 | pt_loss: 1.7462 | pg_loss: 1.0617 | reg_loss: 0.6470 | reward: -1.5381 | rev_kl: 0.8322 | stu_lens: 65.5000 | mixed_lens: 31.0000 | lr: 2.6058e-06 | scale: 1024.00 | time: 27.028 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2490/  5000| tot_loss: 2.1273 | rl_loss: 0.4606 | pt_loss: 1.6666 | pg_loss: 0.1535 | reg_loss: 0.3071 | reward: -0.8469 | rev_kl: 0.4007 | stu_lens: 87.5000 | mixed_lens: 63.0000 | lr: 2.6042e-06 | scale: 1024.00 | time: 26.963 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2491/  5000| tot_loss: 2.3237 | rl_loss: 0.4463 | pt_loss: 1.8774 | pg_loss: 0.0136 | reg_loss: 0.4327 | reward: -0.0795 | rev_kl: 0.8026 | stu_lens: 107.0000 | mixed_lens: 128.0000 | lr: 2.6026e-06 | scale: 1024.00 | time: 27.003 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2492/  5000| tot_loss: 2.1817 | rl_loss: 0.4521 | pt_loss: 1.7296 | pg_loss: 0.0122 | reg_loss: 0.4399 | reward: -0.1905 | rev_kl: 0.8618 | stu_lens: 107.5000 | mixed_lens: 128.0000 | lr: 2.6010e-06 | scale: 1024.00 | time: 26.995 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2493/  5000| tot_loss: 1.6851 | rl_loss: 0.4473 | pt_loss: 1.2379 | pg_loss: 0.1200 | reg_loss: 0.3273 | reward: 0.0170 | rev_kl: 0.7793 | stu_lens: 91.5000 | mixed_lens: 73.0000 | lr: 2.5994e-06 | scale: 1024.00 | time: 27.013 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2494/  5000| tot_loss: 2.2967 | rl_loss: 0.5472 | pt_loss: 1.7495 | pg_loss: 0.1976 | reg_loss: 0.3496 | reward: -0.3078 | rev_kl: 0.7823 | stu_lens: 121.5000 | mixed_lens: 86.0000 | lr: 2.5977e-06 | scale: 1024.00 | time: 26.965 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2495/  5000| tot_loss: 2.1305 | rl_loss: 0.6349 | pt_loss: 1.4955 | pg_loss: 0.1117 | reg_loss: 0.5232 | reward: -0.2808 | rev_kl: 0.8075 | stu_lens: 121.0000 | mixed_lens: 99.5000 | lr: 2.5961e-06 | scale: 1024.00 | time: 26.994 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2496/  5000| tot_loss: 2.6676 | rl_loss: 0.5130 | pt_loss: 2.1545 | pg_loss: 0.1212 | reg_loss: 0.3918 | reward: -0.0580 | rev_kl: 0.8211 | stu_lens: 121.5000 | mixed_lens: 100.0000 | lr: 2.5945e-06 | scale: 1024.00 | time: 26.996 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2496/  5000| tot_loss: 2.3750 | rl_loss: 0.6934 | pt_loss: 1.6815 | pg_loss: 0.2618 | reg_loss: 0.4316 | reward: -0.3201 | rev_kl: 0.8911 | stu_lens: 105.9062 | mixed_lens: 95.7656 | lr: 2.5945e-06 | scale: 1024.00 | time: 26.996 | step time: 28.237
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2497/  5000| tot_loss: 1.8700 | rl_loss: 0.3905 | pt_loss: 1.4796 | pg_loss: 0.0014 | reg_loss: 0.3891 | reward: -0.2060 | rev_kl: 0.8877 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.5929e-06 | scale: 1024.00 | time: 27.051 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2498/  5000| tot_loss: 2.6060 | rl_loss: 1.1845 | pt_loss: 1.4215 | pg_loss: 0.0922 | reg_loss: 1.0923 | reward: -0.2578 | rev_kl: 0.9097 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.5913e-06 | scale: 1024.00 | time: 26.996 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2499/  5000| tot_loss: 2.8396 | rl_loss: 1.3354 | pt_loss: 1.5042 | pg_loss: 0.4363 | reg_loss: 0.8991 | reward: -0.3620 | rev_kl: 0.9640 | stu_lens: 128.0000 | mixed_lens: 77.0000 | lr: 2.5897e-06 | scale: 1024.00 | time: 26.966 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/2500
                                 Evaluation #25                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Existen cuatro tipos de cuarks, que  │
│                                       │ se pueden identificar según su masa: │
│                                       │                                      │
│                                       │ * Cuark de la penúltima generación   │
│                                       │ (also known as a top quark)          │
│                                       │ * Cuark de la segunda generación     │
│                                       │ (also known as a charm quark)        │
│                                       │ * Cuark de la primera generación     │
│                                       │ (also known as a strange quark)      │
│                                       │ * Cuark de la cuarta generación      │
│                                       │ (also known as a bottom quark)       │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC o Incremental Marketing       │
│                                       │ Continuum es un método para          │
│                                       │ categorizar las actividades de       │
│                                       │ marketing en una escala que va desde │
│                                       │ la actividad incremental hasta la    │
│                                       │ actividad diferencial.               │
│                                       │                                      │
│                                       │ El IMC hace referencia a una serie   │
│                                       │ de actividades de marketing que van  │
│                                       │ desde las actividades incrementales  │
│                                       │ (actividades que se llevan a cabo    │
│                                       │ por primera vez) hasta las           │
│                                       │ actividades diferenciales            │
│                                       │ (actividades que se llevan a cabo    │
│                                       │ por segunda vez). La actividad       │
│                                       │ incremental es una actividad de      │
│                                       │ marketing que se lleva a cabo por    │
│                                       │ primera vez y                        │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ 1. Cápsula del tiempo de la era de   │
│                                       │ la piel, 28000 años antes del        │
│                                       │ presente                             │
│                                       │ 2. Cápsula del tiempo de Nigeria,    │
│                                       │ 1000 años antes del presente         │
│                                       │ 3. Cápsula del tiempo de Toulouse,   │
│                                       │ 200 años antes del presente          │
│                                       │ 4. Cápsula del tiempo de Frankrig,   │
│                                       │ 100 años antes del presente          │
│                                       │ 5. Cápsula del tiempo de Hiram       │
│                                       │ Bingham, 60 años antes del presente  │
│                                       │ 6. Cápsula del tiempo de Robert      │
│                                       │ Tawney,                              │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.865 | exact_match: 0.000 | rev_kl: 0.879 | lens: 102.286 | pt_loss: 1.733 | lm_loss: 1.862 | kd_loss: 1.603 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2500/  5000| tot_loss: 2.5933 | rl_loss: 0.9829 | pt_loss: 1.6103 | pg_loss: 0.0624 | reg_loss: 0.9206 | reward: -0.0838 | rev_kl: 0.7738 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.5881e-06 | scale: 1024.00 | time: 26.994 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2501/  5000| tot_loss: 4.2089 | rl_loss: 2.5133 | pt_loss: 1.6955 | pg_loss: 1.3615 | reg_loss: 1.1519 | reward: -1.6404 | rev_kl: 0.9426 | stu_lens: 48.5000 | mixed_lens: 30.5000 | lr: 2.5865e-06 | scale: 1024.00 | time: 27.041 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2502/  5000| tot_loss: 2.1968 | rl_loss: 1.0549 | pt_loss: 1.1419 | pg_loss: 0.1744 | reg_loss: 0.8806 | reward: -0.1374 | rev_kl: 0.5726 | stu_lens: 115.0000 | mixed_lens: 108.0000 | lr: 2.5849e-06 | scale: 1024.00 | time: 26.985 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2503/  5000| tot_loss: 2.7862 | rl_loss: 1.0575 | pt_loss: 1.7287 | pg_loss: 0.0458 | reg_loss: 1.0117 | reward: -0.1486 | rev_kl: 1.2404 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.5833e-06 | scale: 1024.00 | time: 26.995 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2504/  5000| tot_loss: 3.0027 | rl_loss: 1.1037 | pt_loss: 1.8991 | pg_loss: 0.2198 | reg_loss: 0.8838 | reward: -0.1702 | rev_kl: 1.0199 | stu_lens: 128.0000 | mixed_lens: 96.0000 | lr: 2.5817e-06 | scale: 1024.00 | time: 26.996 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2505/  5000| tot_loss: 2.9072 | rl_loss: 1.0360 | pt_loss: 1.8712 | pg_loss: 0.3908 | reg_loss: 0.6452 | reward: -0.3268 | rev_kl: 0.6122 | stu_lens: 104.0000 | mixed_lens: 87.0000 | lr: 2.5801e-06 | scale: 1024.00 | time: 26.999 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2506/  5000| tot_loss: 2.9788 | rl_loss: 1.1752 | pt_loss: 1.8036 | pg_loss: 0.1946 | reg_loss: 0.9806 | reward: -0.4325 | rev_kl: 0.7976 | stu_lens: 96.0000 | mixed_lens: 76.5000 | lr: 2.5785e-06 | scale: 1024.00 | time: 27.016 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2507/  5000| tot_loss: 2.9859 | rl_loss: 1.5213 | pt_loss: 1.4646 | pg_loss: 0.5401 | reg_loss: 0.9812 | reward: -0.6608 | rev_kl: 1.4384 | stu_lens: 73.0000 | mixed_lens: 74.5000 | lr: 2.5769e-06 | scale: 1024.00 | time: 27.009 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2508/  5000| tot_loss: 2.9949 | rl_loss: 1.0445 | pt_loss: 1.9504 | pg_loss: 0.1104 | reg_loss: 0.9341 | reward: -0.2007 | rev_kl: 0.8676 | stu_lens: 127.0000 | mixed_lens: 118.0000 | lr: 2.5753e-06 | scale: 1024.00 | time: 27.031 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2509/  5000| tot_loss: 2.8802 | rl_loss: 1.5839 | pt_loss: 1.2963 | pg_loss: 0.4858 | reg_loss: 1.0981 | reward: -0.1656 | rev_kl: 0.5893 | stu_lens: 73.5000 | mixed_lens: 76.0000 | lr: 2.5737e-06 | scale: 1024.00 | time: 27.022 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2510/  5000| tot_loss: 3.4166 | rl_loss: 1.6541 | pt_loss: 1.7625 | pg_loss: 0.3827 | reg_loss: 1.2714 | reward: -0.2347 | rev_kl: 0.4218 | stu_lens: 83.0000 | mixed_lens: 84.0000 | lr: 2.5721e-06 | scale: 1024.00 | time: 27.037 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2511/  5000| tot_loss: 3.9201 | rl_loss: 2.6068 | pt_loss: 1.3133 | pg_loss: 1.4192 | reg_loss: 1.1876 | reward: -1.0643 | rev_kl: 1.0446 | stu_lens: 53.5000 | mixed_lens: 33.5000 | lr: 2.5705e-06 | scale: 1024.00 | time: 26.999 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2512/  5000| tot_loss: 3.2653 | rl_loss: 1.4166 | pt_loss: 1.8487 | pg_loss: 0.3223 | reg_loss: 1.0943 | reward: -0.4572 | rev_kl: 0.4790 | stu_lens: 38.0000 | mixed_lens: 62.0000 | lr: 2.5689e-06 | scale: 1024.00 | time: 27.008 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2512/  5000| tot_loss: 2.9689 | rl_loss: 1.2702 | pt_loss: 1.6987 | pg_loss: 0.3817 | reg_loss: 0.8885 | reward: -0.3343 | rev_kl: 0.8038 | stu_lens: 90.9219 | mixed_lens: 85.6719 | lr: 2.5689e-06 | scale: 1024.00 | time: 27.008 | step time: 28.244
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2513/  5000| tot_loss: 2.5074 | rl_loss: 1.0001 | pt_loss: 1.5073 | pg_loss: 0.4556 | reg_loss: 0.5445 | reward: -0.0929 | rev_kl: 1.0295 | stu_lens: 101.0000 | mixed_lens: 78.0000 | lr: 2.5673e-06 | scale: 1024.00 | time: 26.981 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2514/  5000| tot_loss: 2.4979 | rl_loss: 1.1925 | pt_loss: 1.3054 | pg_loss: 0.4858 | reg_loss: 0.7067 | reward: -0.4319 | rev_kl: 0.3624 | stu_lens: 65.0000 | mixed_lens: 56.0000 | lr: 2.5657e-06 | scale: 1024.00 | time: 27.012 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2515/  5000| tot_loss: 3.0422 | rl_loss: 0.9106 | pt_loss: 2.1317 | pg_loss: 0.0893 | reg_loss: 0.8213 | reward: -0.1921 | rev_kl: 0.8271 | stu_lens: 88.0000 | mixed_lens: 111.5000 | lr: 2.5641e-06 | scale: 1024.00 | time: 26.978 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2516/  5000| tot_loss: 3.4958 | rl_loss: 1.4435 | pt_loss: 2.0523 | pg_loss: 0.3019 | reg_loss: 1.1416 | reward: -0.2781 | rev_kl: 0.5956 | stu_lens: 84.5000 | mixed_lens: 55.0000 | lr: 2.5625e-06 | scale: 1024.00 | time: 27.001 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2517/  5000| tot_loss: 2.2123 | rl_loss: 0.9211 | pt_loss: 1.2912 | pg_loss: 0.4049 | reg_loss: 0.5162 | reward: -0.6184 | rev_kl: 0.8095 | stu_lens: 50.0000 | mixed_lens: 56.5000 | lr: 2.5609e-06 | scale: 1024.00 | time: 26.993 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2518/  5000| tot_loss: 2.5081 | rl_loss: 0.9716 | pt_loss: 1.5366 | pg_loss: 0.2327 | reg_loss: 0.7389 | reward: -0.4898 | rev_kl: 0.9577 | stu_lens: 105.5000 | mixed_lens: 88.5000 | lr: 2.5593e-06 | scale: 1024.00 | time: 27.026 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2519/  5000| tot_loss: 2.6487 | rl_loss: 0.7126 | pt_loss: 1.9361 | pg_loss: 0.1268 | reg_loss: 0.5859 | reward: -0.2774 | rev_kl: 0.9737 | stu_lens: 77.0000 | mixed_lens: 98.5000 | lr: 2.5577e-06 | scale: 1024.00 | time: 26.953 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2520/  5000| tot_loss: 2.0708 | rl_loss: 0.6498 | pt_loss: 1.4210 | pg_loss: 0.1173 | reg_loss: 0.5325 | reward: -0.2286 | rev_kl: 1.0818 | stu_lens: 128.0000 | mixed_lens: 111.5000 | lr: 2.5561e-06 | scale: 1024.00 | time: 27.051 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2521/  5000| tot_loss: 2.6678 | rl_loss: 0.8121 | pt_loss: 1.8557 | pg_loss: 0.3040 | reg_loss: 0.5081 | reward: -0.4393 | rev_kl: 0.3308 | stu_lens: 73.5000 | mixed_lens: 73.0000 | lr: 2.5545e-06 | scale: 1024.00 | time: 27.004 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2522/  5000| tot_loss: 2.6429 | rl_loss: 0.6861 | pt_loss: 1.9569 | pg_loss: 0.1029 | reg_loss: 0.5832 | reward: -0.1567 | rev_kl: 0.8203 | stu_lens: 128.0000 | mixed_lens: 92.5000 | lr: 2.5529e-06 | scale: 1024.00 | time: 27.024 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2523/  5000| tot_loss: 2.0252 | rl_loss: 0.7874 | pt_loss: 1.2378 | pg_loss: 0.5146 | reg_loss: 0.2727 | reward: -0.0231 | rev_kl: 0.5225 | stu_lens: 57.5000 | mixed_lens: 58.0000 | lr: 2.5513e-06 | scale: 1024.00 | time: 26.957 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2524/  5000| tot_loss: 2.7139 | rl_loss: 1.2759 | pt_loss: 1.4380 | pg_loss: 0.4379 | reg_loss: 0.8380 | reward: -0.3206 | rev_kl: 0.6211 | stu_lens: 128.0000 | mixed_lens: 77.0000 | lr: 2.5497e-06 | scale: 1024.00 | time: 26.987 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2525/  5000| tot_loss: 3.2415 | rl_loss: 1.4996 | pt_loss: 1.7419 | pg_loss: 0.9674 | reg_loss: 0.5322 | reward: -0.9665 | rev_kl: 1.4944 | stu_lens: 20.0000 | mixed_lens: 39.5000 | lr: 2.5481e-06 | scale: 1024.00 | time: 26.993 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2526/  5000| tot_loss: 2.2020 | rl_loss: 0.7820 | pt_loss: 1.4201 | pg_loss: 0.1767 | reg_loss: 0.6052 | reward: -0.2646 | rev_kl: 0.8107 | stu_lens: 128.0000 | mixed_lens: 96.0000 | lr: 2.5465e-06 | scale: 1024.00 | time: 26.973 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2527/  5000| tot_loss: 2.5688 | rl_loss: 0.5489 | pt_loss: 2.0199 | pg_loss: 0.0999 | reg_loss: 0.4491 | reward: -0.1983 | rev_kl: 0.7330 | stu_lens: 76.5000 | mixed_lens: 113.5000 | lr: 2.5449e-06 | scale: 1024.00 | time: 26.948 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2528/  5000| tot_loss: 2.4627 | rl_loss: 0.5949 | pt_loss: 1.8678 | pg_loss: 0.1978 | reg_loss: 0.3971 | reward: -0.2310 | rev_kl: 0.7200 | stu_lens: 90.5000 | mixed_lens: 83.0000 | lr: 2.5433e-06 | scale: 1024.00 | time: 26.986 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2528/  5000| tot_loss: 2.7345 | rl_loss: 0.9795 | pt_loss: 1.7550 | pg_loss: 0.3288 | reg_loss: 0.6507 | reward: -0.3148 | rev_kl: 0.7882 | stu_lens: 88.3750 | mixed_lens: 82.4531 | lr: 2.5433e-06 | scale: 1024.00 | time: 26.986 | step time: 28.226
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2529/  5000| tot_loss: 2.6344 | rl_loss: 1.2519 | pt_loss: 1.3825 | pg_loss: 0.5983 | reg_loss: 0.6535 | reward: 0.3708 | rev_kl: 0.7610 | stu_lens: 128.0000 | mixed_lens: 67.5000 | lr: 2.5417e-06 | scale: 1024.00 | time: 26.997 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2530/  5000| tot_loss: 2.8431 | rl_loss: 1.3195 | pt_loss: 1.5236 | pg_loss: 0.8438 | reg_loss: 0.4757 | reward: -0.8174 | rev_kl: 0.3720 | stu_lens: 51.0000 | mixed_lens: 33.5000 | lr: 2.5401e-06 | scale: 1024.00 | time: 27.007 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2531/  5000| tot_loss: 1.8447 | rl_loss: 0.5224 | pt_loss: 1.3224 | pg_loss: 0.2091 | reg_loss: 0.3133 | reward: -0.3690 | rev_kl: 0.5664 | stu_lens: 105.0000 | mixed_lens: 87.0000 | lr: 2.5385e-06 | scale: 1024.00 | time: 26.961 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2532/  5000| tot_loss: 2.4463 | rl_loss: 0.8882 | pt_loss: 1.5582 | pg_loss: 0.5053 | reg_loss: 0.3829 | reward: -0.7529 | rev_kl: 1.3283 | stu_lens: 76.0000 | mixed_lens: 56.5000 | lr: 2.5369e-06 | scale: 1024.00 | time: 27.060 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2533/  5000| tot_loss: 2.7266 | rl_loss: 0.7159 | pt_loss: 2.0106 | pg_loss: 0.0868 | reg_loss: 0.6291 | reward: -0.2336 | rev_kl: 0.3775 | stu_lens: 71.0000 | mixed_lens: 110.0000 | lr: 2.5353e-06 | scale: 1024.00 | time: 27.049 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2534/  5000| tot_loss: 2.6437 | rl_loss: 0.7744 | pt_loss: 1.8693 | pg_loss: 0.3092 | reg_loss: 0.4653 | reward: -0.7422 | rev_kl: 1.2333 | stu_lens: 73.0000 | mixed_lens: 50.0000 | lr: 2.5337e-06 | scale: 1024.00 | time: 27.009 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2535/  5000| tot_loss: 1.9862 | rl_loss: 0.8567 | pt_loss: 1.1295 | pg_loss: 0.4055 | reg_loss: 0.4512 | reward: -0.2470 | rev_kl: 0.7565 | stu_lens: 22.5000 | mixed_lens: 64.5000 | lr: 2.5321e-06 | scale: 1024.00 | time: 26.966 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2536/  5000| tot_loss: 2.1065 | rl_loss: 0.8484 | pt_loss: 1.2581 | pg_loss: 0.5092 | reg_loss: 0.3393 | reward: -0.0671 | rev_kl: 1.1864 | stu_lens: 101.0000 | mixed_lens: 60.5000 | lr: 2.5305e-06 | scale: 1024.00 | time: 26.998 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2537/  5000| tot_loss: 2.4947 | rl_loss: 0.4883 | pt_loss: 2.0065 | pg_loss: -0.0228 | reg_loss: 0.5110 | reward: -0.1654 | rev_kl: 1.1414 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.5289e-06 | scale: 1024.00 | time: 26.980 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2538/  5000| tot_loss: 2.5443 | rl_loss: 0.8766 | pt_loss: 1.6677 | pg_loss: 0.3620 | reg_loss: 0.5146 | reward: -0.3844 | rev_kl: 0.6887 | stu_lens: 128.0000 | mixed_lens: 77.0000 | lr: 2.5272e-06 | scale: 1024.00 | time: 26.977 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2539/  5000| tot_loss: 2.4858 | rl_loss: 0.4881 | pt_loss: 1.9977 | pg_loss: -0.0014 | reg_loss: 0.4894 | reward: -0.1191 | rev_kl: 0.7572 | stu_lens: 104.0000 | mixed_lens: 128.0000 | lr: 2.5256e-06 | scale: 1024.00 | time: 26.956 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2540/  5000| tot_loss: 2.4777 | rl_loss: 0.5653 | pt_loss: 1.9125 | pg_loss: 0.0120 | reg_loss: 0.5532 | reward: -0.0686 | rev_kl: 0.7320 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.5240e-06 | scale: 1024.00 | time: 26.992 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2541/  5000| tot_loss: 2.4217 | rl_loss: 0.5193 | pt_loss: 1.9024 | pg_loss: -0.0368 | reg_loss: 0.5561 | reward: -0.3606 | rev_kl: 0.6541 | stu_lens: 78.0000 | mixed_lens: 74.0000 | lr: 2.5224e-06 | scale: 1024.00 | time: 26.971 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2542/  5000| tot_loss: 2.2136 | rl_loss: 0.4255 | pt_loss: 1.7881 | pg_loss: -0.0113 | reg_loss: 0.4368 | reward: -0.1523 | rev_kl: 0.8561 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.5208e-06 | scale: 1024.00 | time: 27.008 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2543/  5000| tot_loss: 2.5138 | rl_loss: 0.6757 | pt_loss: 1.8380 | pg_loss: 0.4440 | reg_loss: 0.2317 | reward: -0.5193 | rev_kl: 0.7900 | stu_lens: 20.5000 | mixed_lens: 80.0000 | lr: 2.5192e-06 | scale: 1024.00 | time: 26.985 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2544/  5000| tot_loss: 2.5572 | rl_loss: 0.7664 | pt_loss: 1.7908 | pg_loss: 0.3323 | reg_loss: 0.4341 | reward: -0.3564 | rev_kl: 0.8196 | stu_lens: 41.5000 | mixed_lens: 67.5000 | lr: 2.5176e-06 | scale: 1024.00 | time: 27.040 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2544/  5000| tot_loss: 2.3433 | rl_loss: 0.6984 | pt_loss: 1.6449 | pg_loss: 0.2268 | reg_loss: 0.4716 | reward: -0.2639 | rev_kl: 0.8227 | stu_lens: 94.2344 | mixed_lens: 87.9531 | lr: 2.5176e-06 | scale: 1024.00 | time: 27.040 | step time: 28.233
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2545/  5000| tot_loss: 0.6268 | rl_loss: -1.0765 | pt_loss: 1.7032 | pg_loss: -1.4124 | reg_loss: 0.3359 | reward: 0.1565 | rev_kl: 0.5753 | stu_lens: 78.0000 | mixed_lens: 13.5000 | lr: 2.5160e-06 | scale: 1024.00 | time: 27.046 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2546/  5000| tot_loss: 2.1859 | rl_loss: 0.6838 | pt_loss: 1.5021 | pg_loss: 0.5306 | reg_loss: 0.1532 | reward: -0.3813 | rev_kl: 0.7302 | stu_lens: 116.0000 | mixed_lens: 51.5000 | lr: 2.5144e-06 | scale: 1024.00 | time: 27.047 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2547/  5000| tot_loss: 2.0033 | rl_loss: 0.5341 | pt_loss: 1.4693 | pg_loss: 0.0627 | reg_loss: 0.4714 | reward: -0.2684 | rev_kl: 1.0094 | stu_lens: 77.0000 | mixed_lens: 116.5000 | lr: 2.5128e-06 | scale: 1024.00 | time: 26.970 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2548/  5000| tot_loss: 2.0644 | rl_loss: 0.3032 | pt_loss: 1.7612 | pg_loss: -0.0228 | reg_loss: 0.3260 | reward: -0.4929 | rev_kl: 0.5328 | stu_lens: 78.0000 | mixed_lens: 45.0000 | lr: 2.5112e-06 | scale: 1024.00 | time: 26.996 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2549/  5000| tot_loss: 2.3233 | rl_loss: 0.8664 | pt_loss: 1.4569 | pg_loss: 0.4070 | reg_loss: 0.4595 | reward: -0.1981 | rev_kl: 0.7061 | stu_lens: 115.0000 | mixed_lens: 74.5000 | lr: 2.5096e-06 | scale: 1024.00 | time: 27.004 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2550/  5000| tot_loss: 2.2144 | rl_loss: 0.5168 | pt_loss: 1.6975 | pg_loss: 0.1734 | reg_loss: 0.3434 | reward: -0.3125 | rev_kl: 0.4599 | stu_lens: 70.0000 | mixed_lens: 113.5000 | lr: 2.5080e-06 | scale: 1024.00 | time: 27.046 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2551/  5000| tot_loss: 3.1131 | rl_loss: 0.8857 | pt_loss: 2.2274 | pg_loss: 0.5859 | reg_loss: 0.2998 | reward: -0.4613 | rev_kl: 0.5925 | stu_lens: 59.5000 | mixed_lens: 52.0000 | lr: 2.5064e-06 | scale: 1024.00 | time: 26.957 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2552/  5000| tot_loss: 3.5857 | rl_loss: 1.8377 | pt_loss: 1.7480 | pg_loss: 1.0317 | reg_loss: 0.8060 | reward: -0.7111 | rev_kl: 1.1532 | stu_lens: 29.5000 | mixed_lens: 35.0000 | lr: 2.5048e-06 | scale: 1024.00 | time: 26.982 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2553/  5000| tot_loss: 2.4351 | rl_loss: 0.6324 | pt_loss: 1.8027 | pg_loss: 0.3687 | reg_loss: 0.2637 | reward: -0.0250 | rev_kl: 1.1563 | stu_lens: 81.5000 | mixed_lens: 77.0000 | lr: 2.5032e-06 | scale: 1024.00 | time: 27.035 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2554/  5000| tot_loss: 1.9772 | rl_loss: 0.3662 | pt_loss: 1.6109 | pg_loss: -0.0266 | reg_loss: 0.3928 | reward: -0.1294 | rev_kl: 1.0304 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.5016e-06 | scale: 1024.00 | time: 27.036 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2555/  5000| tot_loss: 2.1332 | rl_loss: 0.4435 | pt_loss: 1.6898 | pg_loss: 0.0721 | reg_loss: 0.3713 | reward: -0.3548 | rev_kl: 0.9610 | stu_lens: 96.0000 | mixed_lens: 105.5000 | lr: 2.5000e-06 | scale: 1024.00 | time: 27.046 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2556/  5000| tot_loss: 2.5821 | rl_loss: 0.4917 | pt_loss: 2.0904 | pg_loss: 0.1653 | reg_loss: 0.3264 | reward: -0.2205 | rev_kl: 0.8602 | stu_lens: 128.0000 | mixed_lens: 96.0000 | lr: 2.4984e-06 | scale: 1024.00 | time: 27.072 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2557/  5000| tot_loss: 2.5487 | rl_loss: 0.5552 | pt_loss: 1.9934 | pg_loss: 0.1722 | reg_loss: 0.3830 | reward: -0.3513 | rev_kl: 1.2650 | stu_lens: 95.5000 | mixed_lens: 83.5000 | lr: 2.4968e-06 | scale: 1024.00 | time: 27.025 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2558/  5000| tot_loss: 2.1203 | rl_loss: 0.2556 | pt_loss: 1.8647 | pg_loss: 0.0073 | reg_loss: 0.2483 | reward: -0.1370 | rev_kl: 0.5715 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.4952e-06 | scale: 1024.00 | time: 27.014 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2559/  5000| tot_loss: 2.6877 | rl_loss: 0.7350 | pt_loss: 1.9527 | pg_loss: 0.3521 | reg_loss: 0.3830 | reward: -0.1455 | rev_kl: 0.9726 | stu_lens: 73.5000 | mixed_lens: 68.0000 | lr: 2.4936e-06 | scale: 1024.00 | time: 26.973 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2560/  5000| tot_loss: 2.0269 | rl_loss: 0.7685 | pt_loss: 1.2584 | pg_loss: 0.3773 | reg_loss: 0.3912 | reward: -0.1083 | rev_kl: 0.5834 | stu_lens: 73.5000 | mixed_lens: 76.0000 | lr: 2.4920e-06 | scale: 1024.00 | time: 27.046 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2560/  5000| tot_loss: 2.2994 | rl_loss: 0.6247 | pt_loss: 1.6747 | pg_loss: 0.2450 | reg_loss: 0.3797 | reward: -0.3462 | rev_kl: 0.7779 | stu_lens: 89.8281 | mixed_lens: 82.1719 | lr: 2.4920e-06 | scale: 1024.00 | time: 27.046 | step time: 28.253
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2561/  5000| tot_loss: 2.8904 | rl_loss: 0.8166 | pt_loss: 2.0738 | pg_loss: 0.3887 | reg_loss: 0.4279 | reward: 0.3760 | rev_kl: 0.6644 | stu_lens: 88.0000 | mixed_lens: 55.5000 | lr: 2.4904e-06 | scale: 1024.00 | time: 27.020 | step time: 0.000
Another outer ppo epoch, outer ppo epoch: 1
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2562/  5000| tot_loss: 3.2840 | rl_loss: 1.4176 | pt_loss: 1.8663 | pg_loss: 0.4626 | reg_loss: 0.9550 | reward: -0.9765 | rev_kl: 1.8808 | stu_lens: 85.0000 | mixed_lens: 69.5000 | lr: 2.4888e-06 | scale: 1024.00 | time: 27.070 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2563/  5000| tot_loss: 2.9805 | rl_loss: 1.1241 | pt_loss: 1.8564 | pg_loss: 0.1786 | reg_loss: 0.9455 | reward: -0.2529 | rev_kl: 0.7063 | stu_lens: 92.5000 | mixed_lens: 100.5000 | lr: 2.4872e-06 | scale: 1024.00 | time: 27.016 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2564/  5000| tot_loss: 2.3719 | rl_loss: 0.9080 | pt_loss: 1.4639 | pg_loss: 0.0588 | reg_loss: 0.8492 | reward: -0.1003 | rev_kl: 0.9766 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.4856e-06 | scale: 1024.00 | time: 27.007 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2565/  5000| tot_loss: 3.1461 | rl_loss: 1.2528 | pt_loss: 1.8934 | pg_loss: 0.1967 | reg_loss: 1.0560 | reward: -0.2429 | rev_kl: 0.8666 | stu_lens: 122.5000 | mixed_lens: 97.0000 | lr: 2.4840e-06 | scale: 1024.00 | time: 27.011 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2566/  5000| tot_loss: 3.7575 | rl_loss: 1.8251 | pt_loss: 1.9324 | pg_loss: 0.7736 | reg_loss: 1.0515 | reward: -0.1228 | rev_kl: 0.9811 | stu_lens: 96.0000 | mixed_lens: 69.5000 | lr: 2.4824e-06 | scale: 1024.00 | time: 27.001 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2567/  5000| tot_loss: 1.9482 | rl_loss: 0.6439 | pt_loss: 1.3043 | pg_loss: 0.1532 | reg_loss: 0.4907 | reward: -0.0628 | rev_kl: 0.5797 | stu_lens: 93.5000 | mixed_lens: 100.5000 | lr: 2.4808e-06 | scale: 1024.00 | time: 26.994 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2568/  5000| tot_loss: 2.5773 | rl_loss: 1.2903 | pt_loss: 1.2869 | pg_loss: 0.2635 | reg_loss: 1.0268 | reward: -0.3163 | rev_kl: 0.5688 | stu_lens: 128.0000 | mixed_lens: 90.5000 | lr: 2.4792e-06 | scale: 1024.00 | time: 27.011 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2569/  5000| tot_loss: 2.8553 | rl_loss: 1.3821 | pt_loss: 1.4732 | pg_loss: 0.6794 | reg_loss: 0.7027 | reward: -0.4508 | rev_kl: 0.8786 | stu_lens: 93.5000 | mixed_lens: 69.5000 | lr: 2.4776e-06 | scale: 1024.00 | time: 27.042 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2570/  5000| tot_loss: 2.6309 | rl_loss: 1.2062 | pt_loss: 1.4247 | pg_loss: 0.3262 | reg_loss: 0.8800 | reward: -0.3277 | rev_kl: 0.7623 | stu_lens: 74.0000 | mixed_lens: 87.5000 | lr: 2.4760e-06 | scale: 1024.00 | time: 27.057 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2571/  5000| tot_loss: 2.4224 | rl_loss: 0.7889 | pt_loss: 1.6335 | pg_loss: 0.2827 | reg_loss: 0.5062 | reward: -0.0798 | rev_kl: 0.2618 | stu_lens: 87.5000 | mixed_lens: 87.5000 | lr: 2.4744e-06 | scale: 1024.00 | time: 27.052 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2572/  5000| tot_loss: 2.5674 | rl_loss: 0.9398 | pt_loss: 1.6276 | pg_loss: 0.0624 | reg_loss: 0.8774 | reward: -0.1091 | rev_kl: 1.1603 | stu_lens: 80.0000 | mixed_lens: 128.0000 | lr: 2.4728e-06 | scale: 1024.00 | time: 27.087 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2573/  5000| tot_loss: 2.6196 | rl_loss: 0.8230 | pt_loss: 1.7966 | pg_loss: 0.0311 | reg_loss: 0.7919 | reward: -0.2370 | rev_kl: 0.4435 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.4711e-06 | scale: 1024.00 | time: 27.104 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2574/  5000| tot_loss: 2.9095 | rl_loss: 0.9688 | pt_loss: 1.9406 | pg_loss: 0.2115 | reg_loss: 0.7573 | reward: -0.1803 | rev_kl: 0.6363 | stu_lens: 108.0000 | mixed_lens: 105.0000 | lr: 2.4695e-06 | scale: 1024.00 | time: 27.023 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2575/  5000| tot_loss: 3.0966 | rl_loss: 1.2807 | pt_loss: 1.8160 | pg_loss: 0.4656 | reg_loss: 0.8150 | reward: -0.0264 | rev_kl: 0.5182 | stu_lens: 73.5000 | mixed_lens: 73.5000 | lr: 2.4679e-06 | scale: 1024.00 | time: 27.049 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2576/  5000| tot_loss: 2.2058 | rl_loss: 0.5191 | pt_loss: 1.6867 | pg_loss: 0.0315 | reg_loss: 0.4876 | reward: -0.1141 | rev_kl: 0.6588 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.4663e-06 | scale: 1024.00 | time: 27.009 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2576/  5000| tot_loss: 2.8246 | rl_loss: 1.1593 | pt_loss: 1.6653 | pg_loss: 0.3525 | reg_loss: 0.8068 | reward: -0.3170 | rev_kl: 0.8928 | stu_lens: 93.6562 | mixed_lens: 86.6406 | lr: 2.4663e-06 | scale: 1024.00 | time: 27.009 | step time: 28.271
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2577/  5000| tot_loss: 2.2149 | rl_loss: 0.4847 | pt_loss: 1.7302 | pg_loss: -0.1042 | reg_loss: 0.5889 | reward: -0.1690 | rev_kl: 0.5242 | stu_lens: 36.0000 | mixed_lens: 34.5000 | lr: 2.4647e-06 | scale: 1024.00 | time: 27.027 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2578/  5000| tot_loss: 2.3272 | rl_loss: 0.7568 | pt_loss: 1.5704 | pg_loss: 0.2099 | reg_loss: 0.5469 | reward: -0.0977 | rev_kl: 0.5748 | stu_lens: 72.5000 | mixed_lens: 71.0000 | lr: 2.4631e-06 | scale: 1024.00 | time: 27.013 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2579/  5000| tot_loss: 2.2631 | rl_loss: 0.6765 | pt_loss: 1.5866 | pg_loss: -0.0181 | reg_loss: 0.6947 | reward: -0.1905 | rev_kl: 0.7336 | stu_lens: 97.5000 | mixed_lens: 128.0000 | lr: 2.4615e-06 | scale: 1024.00 | time: 27.035 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2580/  5000| tot_loss: 3.5088 | rl_loss: 1.4813 | pt_loss: 2.0275 | pg_loss: 0.6303 | reg_loss: 0.8510 | reward: -1.7450 | rev_kl: 1.0994 | stu_lens: 120.5000 | mixed_lens: 56.0000 | lr: 2.4599e-06 | scale: 1024.00 | time: 27.042 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2581/  5000| tot_loss: 2.6704 | rl_loss: 0.9643 | pt_loss: 1.7061 | pg_loss: 0.3013 | reg_loss: 0.6630 | reward: -0.8511 | rev_kl: 0.9618 | stu_lens: 88.0000 | mixed_lens: 73.5000 | lr: 2.4583e-06 | scale: 1024.00 | time: 27.012 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2582/  5000| tot_loss: 2.0809 | rl_loss: 0.8466 | pt_loss: 1.2344 | pg_loss: 0.1433 | reg_loss: 0.7033 | reward: -0.3011 | rev_kl: 0.5411 | stu_lens: 128.0000 | mixed_lens: 90.5000 | lr: 2.4567e-06 | scale: 1024.00 | time: 27.042 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2583/  5000| tot_loss: 2.5282 | rl_loss: 0.7449 | pt_loss: 1.7833 | pg_loss: 0.2669 | reg_loss: 0.4780 | reward: -0.4703 | rev_kl: 0.8720 | stu_lens: 104.5000 | mixed_lens: 71.5000 | lr: 2.4551e-06 | scale: 1024.00 | time: 27.035 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2584/  5000| tot_loss: 3.0706 | rl_loss: 1.3459 | pt_loss: 1.7247 | pg_loss: 1.1671 | reg_loss: 0.1788 | reward: -0.0360 | rev_kl: 0.7376 | stu_lens: 41.5000 | mixed_lens: 15.0000 | lr: 2.4535e-06 | scale: 1024.00 | time: 27.070 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2585/  5000| tot_loss: 2.6425 | rl_loss: 1.0272 | pt_loss: 1.6153 | pg_loss: 0.1602 | reg_loss: 0.8671 | reward: -0.3487 | rev_kl: 0.8362 | stu_lens: 128.0000 | mixed_lens: 88.5000 | lr: 2.4519e-06 | scale: 1024.00 | time: 27.042 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2586/  5000| tot_loss: 2.5729 | rl_loss: 0.8899 | pt_loss: 1.6830 | pg_loss: 0.2831 | reg_loss: 0.6068 | reward: -0.0959 | rev_kl: 0.5841 | stu_lens: 80.0000 | mixed_lens: 81.0000 | lr: 2.4503e-06 | scale: 1024.00 | time: 27.035 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2587/  5000| tot_loss: 2.5493 | rl_loss: 0.6029 | pt_loss: 1.9464 | pg_loss: 0.1270 | reg_loss: 0.4759 | reward: -0.1302 | rev_kl: 1.5663 | stu_lens: 101.5000 | mixed_lens: 96.0000 | lr: 2.4487e-06 | scale: 1024.00 | time: 27.060 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2588/  5000| tot_loss: 2.0018 | rl_loss: 0.7073 | pt_loss: 1.2944 | pg_loss: 0.1774 | reg_loss: 0.5299 | reward: -0.2625 | rev_kl: 0.7336 | stu_lens: 128.0000 | mixed_lens: 106.5000 | lr: 2.4471e-06 | scale: 1024.00 | time: 27.014 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2589/  5000| tot_loss: 2.1334 | rl_loss: 0.6701 | pt_loss: 1.4632 | pg_loss: 0.1821 | reg_loss: 0.4880 | reward: -0.1519 | rev_kl: 0.6996 | stu_lens: 77.0000 | mixed_lens: 82.5000 | lr: 2.4455e-06 | scale: 1024.00 | time: 27.034 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2590/  5000| tot_loss: 2.4935 | rl_loss: 0.9124 | pt_loss: 1.5811 | pg_loss: 0.7497 | reg_loss: 0.1627 | reward: -0.9009 | rev_kl: 1.2153 | stu_lens: 44.5000 | mixed_lens: 29.0000 | lr: 2.4439e-06 | scale: 1024.00 | time: 27.025 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2591/  5000| tot_loss: 2.6200 | rl_loss: 0.8203 | pt_loss: 1.7997 | pg_loss: 0.3102 | reg_loss: 0.5100 | reward: -0.1273 | rev_kl: 0.4856 | stu_lens: 78.0000 | mixed_lens: 80.5000 | lr: 2.4423e-06 | scale: 1024.00 | time: 27.048 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2592/  5000| tot_loss: 1.8107 | rl_loss: 0.7503 | pt_loss: 1.0603 | pg_loss: 0.2232 | reg_loss: 0.5271 | reward: -0.2353 | rev_kl: 0.7197 | stu_lens: 91.5000 | mixed_lens: 91.5000 | lr: 2.4407e-06 | scale: 1024.00 | time: 27.044 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2592/  5000| tot_loss: 2.4693 | rl_loss: 0.8134 | pt_loss: 1.6559 | pg_loss: 0.2555 | reg_loss: 0.5579 | reward: -0.3249 | rev_kl: 0.8560 | stu_lens: 90.5625 | mixed_lens: 83.9375 | lr: 2.4407e-06 | scale: 1024.00 | time: 27.044 | step time: 28.271
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2593/  5000| tot_loss: 2.4150 | rl_loss: 0.5046 | pt_loss: 1.9104 | pg_loss: 0.0078 | reg_loss: 0.4968 | reward: -0.2162 | rev_kl: 0.7667 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.4391e-06 | scale: 1024.00 | time: 27.091 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2594/  5000| tot_loss: 2.3329 | rl_loss: 0.6570 | pt_loss: 1.6759 | pg_loss: 0.1174 | reg_loss: 0.5396 | reward: -0.2320 | rev_kl: 0.4603 | stu_lens: 91.5000 | mixed_lens: 91.5000 | lr: 2.4375e-06 | scale: 1024.00 | time: 27.080 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2595/  5000| tot_loss: 2.6266 | rl_loss: 0.7484 | pt_loss: 1.8782 | pg_loss: 0.2669 | reg_loss: 0.4815 | reward: -0.1183 | rev_kl: 0.8477 | stu_lens: 73.5000 | mixed_lens: 73.5000 | lr: 2.4359e-06 | scale: 1024.00 | time: 27.080 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2596/  5000| tot_loss: 2.0305 | rl_loss: 0.4862 | pt_loss: 1.5442 | pg_loss: 0.0687 | reg_loss: 0.4176 | reward: -0.1539 | rev_kl: 0.8313 | stu_lens: 128.0000 | mixed_lens: 93.5000 | lr: 2.4343e-06 | scale: 1024.00 | time: 27.034 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2597/  5000| tot_loss: 2.2633 | rl_loss: 0.7658 | pt_loss: 1.4975 | pg_loss: 0.2794 | reg_loss: 0.4864 | reward: -0.3818 | rev_kl: 0.9528 | stu_lens: 43.0000 | mixed_lens: 81.0000 | lr: 2.4327e-06 | scale: 1024.00 | time: 27.064 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2598/  5000| tot_loss: 2.7737 | rl_loss: 0.7887 | pt_loss: 1.9850 | pg_loss: 0.4801 | reg_loss: 0.3086 | reward: -0.0121 | rev_kl: 0.6961 | stu_lens: 72.5000 | mixed_lens: 71.0000 | lr: 2.4311e-06 | scale: 1024.00 | time: 27.000 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2599/  5000| tot_loss: 2.0801 | rl_loss: 1.0011 | pt_loss: 1.0789 | pg_loss: 0.3340 | reg_loss: 0.6671 | reward: -0.3277 | rev_kl: 0.8808 | stu_lens: 128.0000 | mixed_lens: 79.0000 | lr: 2.4295e-06 | scale: 1024.00 | time: 27.015 | step time: 0.000
                                 Evaluation #26                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son particulas            │
│                                       │ elementales que se hallan entre los  │
│                                       │ quarks y los leptones, y son más     │
│                                       │ ligeros que los primeros y más       │
│                                       │ pesados que los segundos.            │
│                                       │                                      │
│                                       │ Los cuarks se subdividen en tres     │
│                                       │ familias dependiendo de su valor de  │
│                                       │ carga:                               │
│                                       │                                      │
│                                       │ - Cuarks de primera familia: el      │
│                                       │ cuarco, el mesón del cuarco y el     │
│                                       │ bárbaro.                             │
│                                       │ - Cuarks de segunda familia: el λ,   │
│                                       │ el μ y el τ.                         │
│                                       │ - Cuarks de tercera familia: el Ξ,   │
│                                       │ el Ω                                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ IMC es una abreviatura de "Inicial   │
│                                       │ Mano de Composición". Es un método   │
│                                       │ para crear un documento de escritura │
│                                       │ automáticamente, utilizando un       │
│                                       │ conjunto predefinido de estrategias  │
│                                       │ de composición. El IMC es un ejemplo │
│                                       │ de un software de composición basado │
│                                       │ en árboles.                          │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ 1. La cápsula del tiempo de Louis    │
│                                       │ XIV, 1667                            │
│                                       │ 2. La cápsula del tiempo de          │
│                                       │ Napoleón, 1815                       │
│                                       │ 3. La cápsula del tiempo del siglo   │
│                                       │ XX, 1900                             │
│                                       │ 4. La cápsula del tiempo del siglo   │
│                                       │ XXI, 2000                            │
│                                       │ 5. La cápsula del tiempo de          │
│                                       │ Tomorrowland, 2011                   │
│                                       │ 6. La cápsula del tiempo de Nueva    │
│                                       │ York, 2016                           │
│                                       │ 7. La cápsula del tiempo de Oslo     │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.851 | exact_match: 0.000 | rev_kl: 0.840 | lens: 96.073 | pt_loss: 1.733 | lm_loss: 1.863 | kd_loss: 1.602 
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2600/  5000| tot_loss: 2.5615 | rl_loss: 0.6559 | pt_loss: 1.9056 | pg_loss: 0.2911 | reg_loss: 0.3647 | reward: -0.0831 | rev_kl: 0.4643 | stu_lens: 60.0000 | mixed_lens: 58.0000 | lr: 2.4279e-06 | scale: 1024.00 | time: 27.017 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2601/  5000| tot_loss: 2.0715 | rl_loss: 0.4342 | pt_loss: 1.6373 | pg_loss: -0.0139 | reg_loss: 0.4480 | reward: -0.1644 | rev_kl: 0.7436 | stu_lens: 65.5000 | mixed_lens: 128.0000 | lr: 2.4263e-06 | scale: 1024.00 | time: 27.031 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2602/  5000| tot_loss: 2.3272 | rl_loss: 0.6313 | pt_loss: 1.6959 | pg_loss: 0.2966 | reg_loss: 0.3347 | reward: -0.8200 | rev_kl: 0.4825 | stu_lens: 70.5000 | mixed_lens: 69.5000 | lr: 2.4247e-06 | scale: 1024.00 | time: 27.046 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2603/  5000| tot_loss: 2.0376 | rl_loss: 0.2741 | pt_loss: 1.7635 | pg_loss: -0.0135 | reg_loss: 0.2876 | reward: -0.1833 | rev_kl: 0.5499 | stu_lens: 76.5000 | mixed_lens: 128.0000 | lr: 2.4231e-06 | scale: 1024.00 | time: 27.052 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2604/  5000| tot_loss: 2.7196 | rl_loss: 0.3777 | pt_loss: 2.3419 | pg_loss: 0.0191 | reg_loss: 0.3586 | reward: -0.2586 | rev_kl: 0.8522 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.4215e-06 | scale: 1024.00 | time: 27.025 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2605/  5000| tot_loss: 2.3765 | rl_loss: 0.4339 | pt_loss: 1.9427 | pg_loss: -0.0017 | reg_loss: 0.4355 | reward: -0.2418 | rev_kl: 0.9478 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.4199e-06 | scale: 1024.00 | time: 27.015 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2606/  5000| tot_loss: 2.5244 | rl_loss: 0.4979 | pt_loss: 2.0265 | pg_loss: 0.2291 | reg_loss: 0.2688 | reward: -0.2160 | rev_kl: 0.4359 | stu_lens: 86.5000 | mixed_lens: 48.0000 | lr: 2.4183e-06 | scale: 1024.00 | time: 27.039 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2607/  5000| tot_loss: 2.4244 | rl_loss: 0.7248 | pt_loss: 1.6997 | pg_loss: 0.4478 | reg_loss: 0.2770 | reward: -0.4888 | rev_kl: 0.7014 | stu_lens: 74.0000 | mixed_lens: 71.5000 | lr: 2.4167e-06 | scale: 1024.00 | time: 27.043 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2608/  5000| tot_loss: 2.3571 | rl_loss: 0.6224 | pt_loss: 1.7347 | pg_loss: 0.2584 | reg_loss: 0.3640 | reward: -0.1835 | rev_kl: 0.9763 | stu_lens: 77.0000 | mixed_lens: 82.5000 | lr: 2.4151e-06 | scale: 1024.00 | time: 27.061 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2608/  5000| tot_loss: 2.4572 | rl_loss: 0.6954 | pt_loss: 1.7618 | pg_loss: 0.2853 | reg_loss: 0.4101 | reward: -0.3330 | rev_kl: 0.8648 | stu_lens: 91.1875 | mixed_lens: 86.0469 | lr: 2.4151e-06 | scale: 1024.00 | time: 27.061 | step time: 28.278
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2609/  5000| tot_loss: 2.4899 | rl_loss: 0.3879 | pt_loss: 2.1020 | pg_loss: -0.0224 | reg_loss: 0.4103 | reward: -0.1765 | rev_kl: 0.7347 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.4135e-06 | scale: 1024.00 | time: 27.069 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2610/  5000| tot_loss: 1.6821 | rl_loss: 0.3609 | pt_loss: 1.3212 | pg_loss: -0.0164 | reg_loss: 0.3773 | reward: -0.1418 | rev_kl: 0.7990 | stu_lens: 104.5000 | mixed_lens: 128.0000 | lr: 2.4119e-06 | scale: 1024.00 | time: 27.108 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2611/  5000| tot_loss: 1.9197 | rl_loss: 0.6432 | pt_loss: 1.2765 | pg_loss: 0.2407 | reg_loss: 0.4025 | reward: -0.2353 | rev_kl: 0.8081 | stu_lens: 46.5000 | mixed_lens: 82.5000 | lr: 2.4103e-06 | scale: 1024.00 | time: 27.077 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2612/  5000| tot_loss: 2.6838 | rl_loss: 0.9318 | pt_loss: 1.7520 | pg_loss: 0.5572 | reg_loss: 0.3746 | reward: -0.9493 | rev_kl: 0.6660 | stu_lens: 88.0000 | mixed_lens: 40.5000 | lr: 2.4087e-06 | scale: 1024.00 | time: 27.058 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2613/  5000| tot_loss: 3.6032 | rl_loss: 1.9637 | pt_loss: 1.6395 | pg_loss: 1.4920 | reg_loss: 0.4717 | reward: -0.5261 | rev_kl: 0.4095 | stu_lens: 78.0000 | mixed_lens: 24.0000 | lr: 2.4071e-06 | scale: 1024.00 | time: 27.045 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2614/  5000| tot_loss: 2.1425 | rl_loss: 0.3117 | pt_loss: 1.8309 | pg_loss: -0.0061 | reg_loss: 0.3178 | reward: -0.0950 | rev_kl: 0.8745 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.4055e-06 | scale: 1024.00 | time: 27.073 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2615/  5000| tot_loss: 1.6066 | rl_loss: 0.2742 | pt_loss: 1.3324 | pg_loss: -0.0075 | reg_loss: 0.2816 | reward: -0.0347 | rev_kl: 0.6329 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.4039e-06 | scale: 1024.00 | time: 27.019 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2616/  5000| tot_loss: 1.7372 | rl_loss: 0.3125 | pt_loss: 1.4248 | pg_loss: -0.0154 | reg_loss: 0.3278 | reward: -0.1871 | rev_kl: 2.2556 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.4023e-06 | scale: 1024.00 | time: 27.011 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2617/  5000| tot_loss: 2.6944 | rl_loss: 0.6534 | pt_loss: 2.0410 | pg_loss: 0.3010 | reg_loss: 0.3524 | reward: 0.0467 | rev_kl: 0.9370 | stu_lens: 84.5000 | mixed_lens: 67.0000 | lr: 2.4006e-06 | scale: 1024.00 | time: 27.026 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2618/  5000| tot_loss: 3.1474 | rl_loss: 1.4067 | pt_loss: 1.7407 | pg_loss: 0.9327 | reg_loss: 0.4741 | reward: -0.3238 | rev_kl: 0.3829 | stu_lens: 128.0000 | mixed_lens: 51.0000 | lr: 2.3990e-06 | scale: 1024.00 | time: 27.046 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2619/  5000| tot_loss: 2.1232 | rl_loss: 0.6286 | pt_loss: 1.4947 | pg_loss: 0.3437 | reg_loss: 0.2849 | reward: -0.4268 | rev_kl: 1.1059 | stu_lens: 28.5000 | mixed_lens: 58.5000 | lr: 2.3974e-06 | scale: 1024.00 | time: 27.075 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2620/  5000| tot_loss: 2.4397 | rl_loss: 0.4713 | pt_loss: 1.9684 | pg_loss: 0.1494 | reg_loss: 0.3219 | reward: -0.1466 | rev_kl: 0.3496 | stu_lens: 17.5000 | mixed_lens: 81.0000 | lr: 2.3958e-06 | scale: 1024.00 | time: 27.091 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2621/  5000| tot_loss: 2.1671 | rl_loss: 0.4888 | pt_loss: 1.6783 | pg_loss: 0.1627 | reg_loss: 0.3261 | reward: -0.1832 | rev_kl: 0.9557 | stu_lens: 128.0000 | mixed_lens: 106.5000 | lr: 2.3942e-06 | scale: 1024.00 | time: 27.102 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2622/  5000| tot_loss: 2.0155 | rl_loss: 0.1811 | pt_loss: 1.8345 | pg_loss: 0.0037 | reg_loss: 0.1773 | reward: -0.1841 | rev_kl: 0.3131 | stu_lens: 57.0000 | mixed_lens: 64.0000 | lr: 2.3926e-06 | scale: 1024.00 | time: 27.070 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2623/  5000| tot_loss: 2.0607 | rl_loss: 0.4942 | pt_loss: 1.5665 | pg_loss: 0.1675 | reg_loss: 0.3267 | reward: -0.3593 | rev_kl: 0.6837 | stu_lens: 73.5000 | mixed_lens: 81.0000 | lr: 2.3910e-06 | scale: 1024.00 | time: 27.042 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2624/  5000| tot_loss: 2.1177 | rl_loss: 0.5924 | pt_loss: 1.5253 | pg_loss: 0.2964 | reg_loss: 0.2960 | reward: -0.9973 | rev_kl: 1.5576 | stu_lens: 85.0000 | mixed_lens: 69.5000 | lr: 2.3894e-06 | scale: 1024.00 | time: 27.069 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2624/  5000| tot_loss: 2.2562 | rl_loss: 0.5932 | pt_loss: 1.6630 | pg_loss: 0.2563 | reg_loss: 0.3369 | reward: -0.3273 | rev_kl: 0.8654 | stu_lens: 94.7656 | mixed_lens: 87.8594 | lr: 2.3894e-06 | scale: 1024.00 | time: 27.069 | step time: 28.296
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2625/  5000| tot_loss: 2.1134 | rl_loss: 0.3026 | pt_loss: 1.8108 | pg_loss: -0.0007 | reg_loss: 0.3033 | reward: -0.2541 | rev_kl: 0.8430 | stu_lens: 112.0000 | mixed_lens: 128.0000 | lr: 2.3878e-06 | scale: 1024.00 | time: 27.029 | step time: 0.000
[2023-12-20 02:19:20,989] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 1024, reducing to 512
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2626/  5000| tot_loss: 4.2275 | rl_loss: 1.1380 | pt_loss: 3.0894 | pg_loss: 0.1993 | reg_loss: 0.9388 | reward: -0.2846 | rev_kl: 0.9019 | stu_lens: 128.0000 | mixed_lens: 113.0000 | lr: 2.3878e-06 | scale: 512.00 | time: 2.859 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2627/  5000| tot_loss: 2.1655 | rl_loss: 0.5498 | pt_loss: 1.6157 | pg_loss: 0.0453 | reg_loss: 0.5044 | reward: -0.0845 | rev_kl: 0.5438 | stu_lens: 121.0000 | mixed_lens: 128.0000 | lr: 2.3862e-06 | scale: 512.00 | time: 27.053 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2628/  5000| tot_loss: 2.4853 | rl_loss: 1.2958 | pt_loss: 1.1896 | pg_loss: 0.1164 | reg_loss: 1.1794 | reward: -0.2040 | rev_kl: 1.0725 | stu_lens: 128.0000 | mixed_lens: 116.5000 | lr: 2.3846e-06 | scale: 512.00 | time: 27.005 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2629/  5000| tot_loss: 2.2683 | rl_loss: 0.9592 | pt_loss: 1.3090 | pg_loss: 0.0617 | reg_loss: 0.8975 | reward: -0.2308 | rev_kl: 0.5130 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.3830e-06 | scale: 512.00 | time: 27.005 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2630/  5000| tot_loss: 3.0019 | rl_loss: 1.1977 | pt_loss: 1.8042 | pg_loss: 0.1632 | reg_loss: 1.0345 | reward: -0.3605 | rev_kl: 0.7954 | stu_lens: 114.0000 | mixed_lens: 107.0000 | lr: 2.3814e-06 | scale: 512.00 | time: 27.006 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2631/  5000| tot_loss: 2.9230 | rl_loss: 1.1134 | pt_loss: 1.8096 | pg_loss: 0.3081 | reg_loss: 0.8053 | reward: -0.5793 | rev_kl: 0.5956 | stu_lens: 60.5000 | mixed_lens: 78.0000 | lr: 2.3798e-06 | scale: 512.00 | time: 27.058 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2632/  5000| tot_loss: 2.8864 | rl_loss: 1.1271 | pt_loss: 1.7593 | pg_loss: 0.2705 | reg_loss: 0.8566 | reward: -0.2567 | rev_kl: 0.8978 | stu_lens: 75.5000 | mixed_lens: 77.0000 | lr: 2.3782e-06 | scale: 512.00 | time: 27.037 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2633/  5000| tot_loss: 2.7221 | rl_loss: 1.1221 | pt_loss: 1.6000 | pg_loss: 0.2664 | reg_loss: 0.8557 | reward: -0.1791 | rev_kl: 0.9203 | stu_lens: 90.0000 | mixed_lens: 85.5000 | lr: 2.3766e-06 | scale: 512.00 | time: 27.026 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2634/  5000| tot_loss: 2.6953 | rl_loss: 1.0417 | pt_loss: 1.6536 | pg_loss: 0.2287 | reg_loss: 0.8129 | reward: -0.1651 | rev_kl: 0.7603 | stu_lens: 101.5000 | mixed_lens: 81.5000 | lr: 2.3750e-06 | scale: 512.00 | time: 27.016 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2635/  5000| tot_loss: 2.9343 | rl_loss: 0.9650 | pt_loss: 1.9693 | pg_loss: 0.0572 | reg_loss: 0.9077 | reward: -0.1777 | rev_kl: 1.2050 | stu_lens: 75.5000 | mixed_lens: 128.0000 | lr: 2.3734e-06 | scale: 512.00 | time: 27.045 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2636/  5000| tot_loss: 2.6320 | rl_loss: 0.9518 | pt_loss: 1.6802 | pg_loss: 0.0776 | reg_loss: 0.8742 | reward: -0.0567 | rev_kl: 0.7298 | stu_lens: 115.0000 | mixed_lens: 124.0000 | lr: 2.3718e-06 | scale: 512.00 | time: 27.046 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2637/  5000| tot_loss: 2.6107 | rl_loss: 0.5916 | pt_loss: 2.0192 | pg_loss: 0.0188 | reg_loss: 0.5728 | reward: -0.0686 | rev_kl: 0.7017 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.3702e-06 | scale: 512.00 | time: 27.080 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2638/  5000| tot_loss: 4.5680 | rl_loss: 2.6571 | pt_loss: 1.9108 | pg_loss: 1.8758 | reg_loss: 0.7813 | reward: -0.8372 | rev_kl: 1.5603 | stu_lens: 24.5000 | mixed_lens: 17.5000 | lr: 2.3686e-06 | scale: 512.00 | time: 26.995 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2639/  5000| tot_loss: 2.1396 | rl_loss: 1.0091 | pt_loss: 1.1305 | pg_loss: 0.0719 | reg_loss: 0.9371 | reward: -0.2127 | rev_kl: 2.0116 | stu_lens: 128.0000 | mixed_lens: 124.5000 | lr: 2.3670e-06 | scale: 512.00 | time: 27.019 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2640/  5000| tot_loss: 2.6113 | rl_loss: 1.0983 | pt_loss: 1.5130 | pg_loss: 0.1951 | reg_loss: 0.9032 | reward: -0.0668 | rev_kl: 0.6248 | stu_lens: 128.0000 | mixed_lens: 110.5000 | lr: 2.3654e-06 | scale: 512.00 | time: 26.991 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2640/  5000| tot_loss: 2.8324 | rl_loss: 1.1286 | pt_loss: 1.7038 | pg_loss: 0.3091 | reg_loss: 0.8195 | reward: -0.2587 | rev_kl: 0.8296 | stu_lens: 96.7656 | mixed_lens: 97.2812 | lr: 2.3654e-06 | scale: 512.00 | time: 26.991 | step time: 26.749
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2641/  5000| tot_loss: 2.7057 | rl_loss: 1.1552 | pt_loss: 1.5504 | pg_loss: 0.4302 | reg_loss: 0.7250 | reward: -0.1271 | rev_kl: 0.5822 | stu_lens: 104.5000 | mixed_lens: 90.0000 | lr: 2.3638e-06 | scale: 512.00 | time: 27.046 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2642/  5000| tot_loss: 2.7027 | rl_loss: 1.0750 | pt_loss: 1.6276 | pg_loss: 0.5351 | reg_loss: 0.5400 | reward: -0.3221 | rev_kl: 0.4382 | stu_lens: 56.5000 | mixed_lens: 49.5000 | lr: 2.3622e-06 | scale: 512.00 | time: 27.018 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2643/  5000| tot_loss: 2.4315 | rl_loss: 0.6609 | pt_loss: 1.7706 | pg_loss: 0.0413 | reg_loss: 0.6196 | reward: -0.2286 | rev_kl: 0.8617 | stu_lens: 91.5000 | mixed_lens: 128.0000 | lr: 2.3606e-06 | scale: 512.00 | time: 27.047 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2644/  5000| tot_loss: 2.3373 | rl_loss: 0.5392 | pt_loss: 1.7981 | pg_loss: -0.0190 | reg_loss: 0.5581 | reward: -0.0899 | rev_kl: 0.9393 | stu_lens: 80.5000 | mixed_lens: 128.0000 | lr: 2.3590e-06 | scale: 512.00 | time: 27.006 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2645/  5000| tot_loss: 2.4881 | rl_loss: 1.1197 | pt_loss: 1.3684 | pg_loss: 0.2590 | reg_loss: 0.8607 | reward: -0.3647 | rev_kl: 0.8707 | stu_lens: 90.0000 | mixed_lens: 98.0000 | lr: 2.3574e-06 | scale: 512.00 | time: 27.024 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2646/  5000| tot_loss: 3.3248 | rl_loss: 1.8590 | pt_loss: 1.4657 | pg_loss: 1.0045 | reg_loss: 0.8545 | reward: -0.9595 | rev_kl: 1.3033 | stu_lens: 16.5000 | mixed_lens: 20.0000 | lr: 2.3558e-06 | scale: 512.00 | time: 27.020 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2647/  5000| tot_loss: 2.5961 | rl_loss: 0.9167 | pt_loss: 1.6794 | pg_loss: 0.4539 | reg_loss: 0.4628 | reward: -0.2338 | rev_kl: 1.1125 | stu_lens: 112.0000 | mixed_lens: 59.5000 | lr: 2.3542e-06 | scale: 512.00 | time: 27.054 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2648/  5000| tot_loss: 2.4861 | rl_loss: 0.8116 | pt_loss: 1.6745 | pg_loss: 0.0528 | reg_loss: 0.7588 | reward: -0.2664 | rev_kl: 0.7992 | stu_lens: 128.0000 | mixed_lens: 116.5000 | lr: 2.3526e-06 | scale: 512.00 | time: 27.091 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2649/  5000| tot_loss: 2.7481 | rl_loss: 0.8251 | pt_loss: 1.9230 | pg_loss: 0.1944 | reg_loss: 0.6307 | reward: -0.1879 | rev_kl: 0.5412 | stu_lens: 128.0000 | mixed_lens: 91.5000 | lr: 2.3510e-06 | scale: 512.00 | time: 27.019 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2650/  5000| tot_loss: 2.2177 | rl_loss: 0.6127 | pt_loss: 1.6050 | pg_loss: 0.3349 | reg_loss: 0.2779 | reward: -0.3068 | rev_kl: 0.7662 | stu_lens: 73.0000 | mixed_lens: 83.0000 | lr: 2.3494e-06 | scale: 512.00 | time: 27.000 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2651/  5000| tot_loss: 2.4450 | rl_loss: 0.6442 | pt_loss: 1.8007 | pg_loss: 0.1931 | reg_loss: 0.4512 | reward: -0.1263 | rev_kl: 0.7223 | stu_lens: 98.5000 | mixed_lens: 93.0000 | lr: 2.3478e-06 | scale: 512.00 | time: 27.077 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2652/  5000| tot_loss: 2.4641 | rl_loss: 0.6397 | pt_loss: 1.8244 | pg_loss: 0.0367 | reg_loss: 0.6030 | reward: -0.1453 | rev_kl: 0.7927 | stu_lens: 93.0000 | mixed_lens: 113.0000 | lr: 2.3462e-06 | scale: 512.00 | time: 26.990 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2653/  5000| tot_loss: 2.4074 | rl_loss: 0.5355 | pt_loss: 1.8719 | pg_loss: -0.0132 | reg_loss: 0.5487 | reward: -0.1136 | rev_kl: 1.8377 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.3446e-06 | scale: 512.00 | time: 27.046 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2654/  5000| tot_loss: 3.1101 | rl_loss: 0.7498 | pt_loss: 2.3603 | pg_loss: -0.0055 | reg_loss: 0.7553 | reward: -0.2277 | rev_kl: 0.7970 | stu_lens: 128.0000 | mixed_lens: 124.5000 | lr: 2.3430e-06 | scale: 512.00 | time: 27.028 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2655/  5000| tot_loss: 2.2634 | rl_loss: 0.5784 | pt_loss: 1.6850 | pg_loss: 0.1502 | reg_loss: 0.4281 | reward: 0.0608 | rev_kl: 0.8806 | stu_lens: 56.0000 | mixed_lens: 62.5000 | lr: 2.3414e-06 | scale: 512.00 | time: 27.033 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2656/  5000| tot_loss: 3.6601 | rl_loss: 1.3257 | pt_loss: 2.3344 | pg_loss: 0.3557 | reg_loss: 0.9701 | reward: -0.1641 | rev_kl: 1.0655 | stu_lens: 86.0000 | mixed_lens: 74.5000 | lr: 2.3398e-06 | scale: 512.00 | time: 27.016 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2656/  5000| tot_loss: 2.6701 | rl_loss: 0.9044 | pt_loss: 1.7657 | pg_loss: 0.2292 | reg_loss: 0.6752 | reward: -0.2867 | rev_kl: 0.8359 | stu_lens: 98.2656 | mixed_lens: 93.5781 | lr: 2.3398e-06 | scale: 512.00 | time: 27.016 | step time: 28.262
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2657/  5000| tot_loss: 2.8312 | rl_loss: 1.0067 | pt_loss: 1.8245 | pg_loss: 0.2860 | reg_loss: 0.7207 | reward: -0.1837 | rev_kl: 1.0271 | stu_lens: 123.5000 | mixed_lens: 94.5000 | lr: 2.3382e-06 | scale: 512.00 | time: 27.047 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2658/  5000| tot_loss: 2.2521 | rl_loss: 0.7872 | pt_loss: 1.4649 | pg_loss: 0.1639 | reg_loss: 0.6234 | reward: -1.4749 | rev_kl: 2.1672 | stu_lens: 71.5000 | mixed_lens: 80.0000 | lr: 2.3366e-06 | scale: 512.00 | time: 27.044 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2659/  5000| tot_loss: 2.6745 | rl_loss: 0.5343 | pt_loss: 2.1402 | pg_loss: 0.1877 | reg_loss: 0.3466 | reward: -0.3418 | rev_kl: 0.7217 | stu_lens: 114.0000 | mixed_lens: 87.5000 | lr: 2.3350e-06 | scale: 512.00 | time: 27.051 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2660/  5000| tot_loss: 2.4732 | rl_loss: 0.9188 | pt_loss: 1.5544 | pg_loss: 0.3682 | reg_loss: 0.5506 | reward: -0.2981 | rev_kl: 0.6431 | stu_lens: 78.0000 | mixed_lens: 76.5000 | lr: 2.3334e-06 | scale: 512.00 | time: 27.001 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2661/  5000| tot_loss: 2.5948 | rl_loss: 0.6121 | pt_loss: 1.9827 | pg_loss: 0.1767 | reg_loss: 0.4353 | reward: -0.1609 | rev_kl: 0.8824 | stu_lens: 124.5000 | mixed_lens: 105.5000 | lr: 2.3318e-06 | scale: 512.00 | time: 27.027 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2662/  5000| tot_loss: 2.2937 | rl_loss: 0.5120 | pt_loss: 1.7817 | pg_loss: 0.0486 | reg_loss: 0.4634 | reward: -0.0868 | rev_kl: 0.6446 | stu_lens: 101.0000 | mixed_lens: 113.0000 | lr: 2.3302e-06 | scale: 512.00 | time: 27.047 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2663/  5000| tot_loss: 2.0828 | rl_loss: 0.5134 | pt_loss: 1.5694 | pg_loss: 0.1077 | reg_loss: 0.4057 | reward: -0.8155 | rev_kl: 0.8045 | stu_lens: 73.0000 | mixed_lens: 32.5000 | lr: 2.3286e-06 | scale: 512.00 | time: 27.020 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2664/  5000| tot_loss: 1.6439 | rl_loss: 0.4778 | pt_loss: 1.1661 | pg_loss: 0.1240 | reg_loss: 0.3539 | reward: -0.0554 | rev_kl: 0.5693 | stu_lens: 91.5000 | mixed_lens: 101.0000 | lr: 2.3270e-06 | scale: 512.00 | time: 26.991 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2665/  5000| tot_loss: 2.1468 | rl_loss: 0.4611 | pt_loss: 1.6857 | pg_loss: -0.0258 | reg_loss: 0.4869 | reward: -0.1676 | rev_kl: 0.8120 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.3254e-06 | scale: 512.00 | time: 27.043 | step time: 0.000
[2023-12-20 02:37:50,922] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 512, reducing to 256
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2666/  5000| tot_loss: 2.1889 | rl_loss: 0.6378 | pt_loss: 1.5512 | pg_loss: 0.4275 | reg_loss: 0.2103 | reward: -0.5916 | rev_kl: 0.2499 | stu_lens: 68.5000 | mixed_lens: 56.5000 | lr: 2.3254e-06 | scale: 256.00 | time: 2.832 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2667/  5000| tot_loss: 2.8293 | rl_loss: 0.7557 | pt_loss: 2.0737 | pg_loss: 0.3433 | reg_loss: 0.4124 | reward: 0.0099 | rev_kl: 1.0848 | stu_lens: 69.0000 | mixed_lens: 66.5000 | lr: 2.3238e-06 | scale: 256.00 | time: 27.040 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2668/  5000| tot_loss: 2.1404 | rl_loss: 0.4141 | pt_loss: 1.7263 | pg_loss: -0.0305 | reg_loss: 0.4446 | reward: -0.2494 | rev_kl: 0.9541 | stu_lens: 121.0000 | mixed_lens: 128.0000 | lr: 2.3222e-06 | scale: 256.00 | time: 27.088 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2669/  5000| tot_loss: 2.3789 | rl_loss: 0.5796 | pt_loss: 1.7992 | pg_loss: -0.0233 | reg_loss: 0.6029 | reward: -0.1366 | rev_kl: 0.7790 | stu_lens: 100.0000 | mixed_lens: 128.0000 | lr: 2.3206e-06 | scale: 256.00 | time: 27.080 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2670/  5000| tot_loss: 3.0756 | rl_loss: 1.2636 | pt_loss: 1.8120 | pg_loss: 0.7725 | reg_loss: 0.4911 | reward: -0.2124 | rev_kl: 0.7080 | stu_lens: 40.0000 | mixed_lens: 34.5000 | lr: 2.3190e-06 | scale: 256.00 | time: 27.124 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2671/  5000| tot_loss: 2.5475 | rl_loss: 0.8963 | pt_loss: 1.6512 | pg_loss: 0.2800 | reg_loss: 0.6163 | reward: -0.1609 | rev_kl: 0.9031 | stu_lens: 86.0000 | mixed_lens: 74.5000 | lr: 2.3174e-06 | scale: 256.00 | time: 27.070 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2672/  5000| tot_loss: 1.7344 | rl_loss: 0.5533 | pt_loss: 1.1812 | pg_loss: 0.1695 | reg_loss: 0.3837 | reward: -0.4510 | rev_kl: 0.8789 | stu_lens: 120.0000 | mixed_lens: 78.5000 | lr: 2.3158e-06 | scale: 256.00 | time: 27.090 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2672/  5000| tot_loss: 2.3934 | rl_loss: 0.6639 | pt_loss: 1.7296 | pg_loss: 0.1730 | reg_loss: 0.4909 | reward: -0.2764 | rev_kl: 0.8614 | stu_lens: 99.4219 | mixed_lens: 98.0156 | lr: 2.3158e-06 | scale: 256.00 | time: 27.090 | step time: 26.766
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2673/  5000| tot_loss: 2.6040 | rl_loss: 0.6023 | pt_loss: 2.0017 | pg_loss: 0.1257 | reg_loss: 0.4766 | reward: -0.1501 | rev_kl: 0.6456 | stu_lens: 54.0000 | mixed_lens: 23.5000 | lr: 2.3142e-06 | scale: 256.00 | time: 27.062 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2674/  5000| tot_loss: 2.3759 | rl_loss: 0.7119 | pt_loss: 1.6640 | pg_loss: 0.1531 | reg_loss: 0.5588 | reward: -0.1489 | rev_kl: 0.9750 | stu_lens: 128.0000 | mixed_lens: 116.5000 | lr: 2.3126e-06 | scale: 256.00 | time: 27.070 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2675/  5000| tot_loss: 2.2630 | rl_loss: 0.6160 | pt_loss: 1.6470 | pg_loss: 0.4387 | reg_loss: 0.1773 | reward: -0.3399 | rev_kl: 0.5259 | stu_lens: 78.0000 | mixed_lens: 57.0000 | lr: 2.3110e-06 | scale: 256.00 | time: 27.042 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2676/  5000| tot_loss: 2.0232 | rl_loss: 0.3493 | pt_loss: 1.6739 | pg_loss: -0.0112 | reg_loss: 0.3605 | reward: -0.1237 | rev_kl: 0.5595 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.3094e-06 | scale: 256.00 | time: 27.014 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2677/  5000| tot_loss: 2.4297 | rl_loss: 0.5783 | pt_loss: 1.8514 | pg_loss: 0.2373 | reg_loss: 0.3409 | reward: -0.4385 | rev_kl: 0.7442 | stu_lens: 128.0000 | mixed_lens: 78.5000 | lr: 2.3078e-06 | scale: 256.00 | time: 26.990 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2678/  5000| tot_loss: 2.1320 | rl_loss: 0.4427 | pt_loss: 1.6893 | pg_loss: 0.0859 | reg_loss: 0.3568 | reward: -0.1753 | rev_kl: 1.9222 | stu_lens: 112.0000 | mixed_lens: 81.5000 | lr: 2.3062e-06 | scale: 256.00 | time: 27.018 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2679/  5000| tot_loss: 2.4573 | rl_loss: 0.8039 | pt_loss: 1.6535 | pg_loss: 0.4506 | reg_loss: 0.3533 | reward: -0.4866 | rev_kl: 0.9862 | stu_lens: 73.0000 | mixed_lens: 83.0000 | lr: 2.3047e-06 | scale: 256.00 | time: 26.999 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2680/  5000| tot_loss: 1.8533 | rl_loss: 0.4669 | pt_loss: 1.3864 | pg_loss: 0.0603 | reg_loss: 0.4066 | reward: -0.1762 | rev_kl: 0.7825 | stu_lens: 128.0000 | mixed_lens: 113.0000 | lr: 2.3031e-06 | scale: 256.00 | time: 27.020 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2681/  5000| tot_loss: 2.2364 | rl_loss: 0.3291 | pt_loss: 1.9073 | pg_loss: -0.0190 | reg_loss: 0.3482 | reward: -0.1570 | rev_kl: 0.8003 | stu_lens: 117.5000 | mixed_lens: 128.0000 | lr: 2.3015e-06 | scale: 256.00 | time: 26.986 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2682/  5000| tot_loss: 1.9522 | rl_loss: 0.6001 | pt_loss: 1.3521 | pg_loss: 0.1571 | reg_loss: 0.4430 | reward: -0.6003 | rev_kl: 0.8263 | stu_lens: 128.0000 | mixed_lens: 62.5000 | lr: 2.2999e-06 | scale: 256.00 | time: 27.004 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2683/  5000| tot_loss: 2.2749 | rl_loss: 0.3457 | pt_loss: 1.9292 | pg_loss: -0.0025 | reg_loss: 0.3482 | reward: -0.1990 | rev_kl: 0.5056 | stu_lens: 100.0000 | mixed_lens: 128.0000 | lr: 2.2983e-06 | scale: 256.00 | time: 26.975 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2684/  5000| tot_loss: 2.2704 | rl_loss: 0.3383 | pt_loss: 1.9321 | pg_loss: -0.0153 | reg_loss: 0.3537 | reward: -0.1551 | rev_kl: 0.8162 | stu_lens: 121.0000 | mixed_lens: 128.0000 | lr: 2.2967e-06 | scale: 256.00 | time: 27.002 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2685/  5000| tot_loss: 3.9537 | rl_loss: 2.3496 | pt_loss: 1.6041 | pg_loss: 1.9157 | reg_loss: 0.4340 | reward: -0.4278 | rev_kl: 0.4962 | stu_lens: 9.5000 | mixed_lens: 16.5000 | lr: 2.2951e-06 | scale: 256.00 | time: 26.970 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2686/  5000| tot_loss: 2.6281 | rl_loss: 0.3737 | pt_loss: 2.2544 | pg_loss: 0.1114 | reg_loss: 0.2623 | reward: -0.3054 | rev_kl: 0.6700 | stu_lens: 91.5000 | mixed_lens: 106.5000 | lr: 2.2935e-06 | scale: 256.00 | time: 26.996 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2687/  5000| tot_loss: 2.5396 | rl_loss: 0.4763 | pt_loss: 2.0633 | pg_loss: 0.0783 | reg_loss: 0.3980 | reward: -0.2016 | rev_kl: 0.6823 | stu_lens: 128.0000 | mixed_lens: 110.5000 | lr: 2.2919e-06 | scale: 256.00 | time: 26.971 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2688/  5000| tot_loss: 2.7756 | rl_loss: 1.2360 | pt_loss: 1.5397 | pg_loss: 0.9060 | reg_loss: 0.3299 | reward: -0.1091 | rev_kl: 0.4488 | stu_lens: 67.0000 | mixed_lens: 48.0000 | lr: 2.2903e-06 | scale: 256.00 | time: 26.996 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2688/  5000| tot_loss: 2.3308 | rl_loss: 0.6014 | pt_loss: 1.7294 | pg_loss: 0.2266 | reg_loss: 0.3748 | reward: -0.2703 | rev_kl: 0.8302 | stu_lens: 97.4688 | mixed_lens: 94.7188 | lr: 2.2903e-06 | scale: 256.00 | time: 26.996 | step time: 28.237
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2689/  5000| tot_loss: 1.6160 | rl_loss: 0.5380 | pt_loss: 1.0780 | pg_loss: 0.3220 | reg_loss: 0.2160 | reward: -0.0711 | rev_kl: 0.7763 | stu_lens: 75.0000 | mixed_lens: 58.0000 | lr: 2.2887e-06 | scale: 256.00 | time: 26.985 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2690/  5000| tot_loss: 1.7189 | rl_loss: 0.9325 | pt_loss: 0.7864 | pg_loss: 0.0809 | reg_loss: 0.8516 | reward: -0.0871 | rev_kl: 0.7762 | stu_lens: 128.0000 | mixed_lens: 122.0000 | lr: 2.2871e-06 | scale: 256.00 | time: 27.006 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2691/  5000| tot_loss: 3.2782 | rl_loss: 1.3471 | pt_loss: 1.9311 | pg_loss: 0.4125 | reg_loss: 0.9346 | reward: -0.0007 | rev_kl: 0.5376 | stu_lens: 47.0000 | mixed_lens: 87.0000 | lr: 2.2855e-06 | scale: 256.00 | time: 26.967 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2692/  5000| tot_loss: 2.1276 | rl_loss: 0.8847 | pt_loss: 1.2430 | pg_loss: 0.3311 | reg_loss: 0.5536 | reward: -0.9230 | rev_kl: 0.5122 | stu_lens: 71.0000 | mixed_lens: 71.0000 | lr: 2.2839e-06 | scale: 256.00 | time: 26.994 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2693/  5000| tot_loss: 3.4687 | rl_loss: 2.1276 | pt_loss: 1.3411 | pg_loss: 1.2253 | reg_loss: 0.9023 | reward: -0.8898 | rev_kl: 0.7845 | stu_lens: 46.0000 | mixed_lens: 27.5000 | lr: 2.2823e-06 | scale: 256.00 | time: 26.982 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2694/  5000| tot_loss: 3.2488 | rl_loss: 1.8189 | pt_loss: 1.4299 | pg_loss: 1.2266 | reg_loss: 0.5922 | reward: 0.7091 | rev_kl: 0.9398 | stu_lens: 48.5000 | mixed_lens: 13.0000 | lr: 2.2807e-06 | scale: 256.00 | time: 27.032 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2695/  5000| tot_loss: 2.6879 | rl_loss: 0.9890 | pt_loss: 1.6989 | pg_loss: 0.1202 | reg_loss: 0.8688 | reward: -0.0789 | rev_kl: 0.6776 | stu_lens: 112.5000 | mixed_lens: 100.5000 | lr: 2.2791e-06 | scale: 256.00 | time: 27.002 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2696/  5000| tot_loss: 2.8153 | rl_loss: 0.9737 | pt_loss: 1.8416 | pg_loss: 0.1158 | reg_loss: 0.8579 | reward: -0.0701 | rev_kl: 0.6570 | stu_lens: 100.0000 | mixed_lens: 114.0000 | lr: 2.2775e-06 | scale: 256.00 | time: 27.019 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2697/  5000| tot_loss: 2.6813 | rl_loss: 1.1685 | pt_loss: 1.5129 | pg_loss: 0.2488 | reg_loss: 0.9196 | reward: -0.3537 | rev_kl: 1.0454 | stu_lens: 112.5000 | mixed_lens: 99.5000 | lr: 2.2759e-06 | scale: 256.00 | time: 27.039 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2698/  5000| tot_loss: 2.5613 | rl_loss: 0.9783 | pt_loss: 1.5831 | pg_loss: 0.2161 | reg_loss: 0.7621 | reward: -0.2281 | rev_kl: 1.5714 | stu_lens: 120.5000 | mixed_lens: 95.0000 | lr: 2.2743e-06 | scale: 256.00 | time: 27.009 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2699/  5000| tot_loss: 2.6549 | rl_loss: 0.9787 | pt_loss: 1.6762 | pg_loss: 0.0442 | reg_loss: 0.9345 | reward: -0.2339 | rev_kl: 1.3817 | stu_lens: 43.5000 | mixed_lens: 128.0000 | lr: 2.2727e-06 | scale: 256.00 | time: 26.986 | step time: 0.000
                                 Evaluation #27                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son una de las dos clases │
│                                       │ de particles elementales (los otros  │
│                                       │ son las partículas de fuerza nula)   │
│                                       │ que involucran aproximadamente el    │
│                                       │ 100% de la materia de la Universidad │
│                                       │ de Harvard. Los cuarks tienen una    │
│                                       │ carga de color, lo cual es una       │
│                                       │ propiedad que solo tiene las         │
│                                       │ partículas elementales. Los cuarks   │
│                                       │ también pueden producirse como       │
│                                       │ espín-1/2 y 3/2, dependiendo de la   │
│                                       │ carga de color y la masa. Los cuarks │
│                                       │ adheridos tienen que ver con la      │
│                                       │ carga de color, mientras             │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es el acrónimo de "Ingreso    │
│                                       │ Mínimo de Capital", el cual se       │
│                                       │ refiere a la cantidad de dinero que  │
│                                       │ un inversor puede invertir en una    │
│                                       │ empresa o proyectos de inversión.    │
│                                       │                                      │
│                                       │ El IMC se establece por la norma     │
│                                       │ estatal o federal y es un límite     │
│                                       │ mínimo o máximo de la cantidad de    │
│                                       │ dinero que un inversor puede         │
│                                       │ invertir en una empresa o proyectos  │
│                                       │ de inversión.                        │
│                                       │                                      │
│                                       │ Esta cantidad es importante para la  │
│                                       │ seguridad de los inversionistas, ya  │
│                                       │ que                                  │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ 1. Cápsula del tiempo de Archduke    │
│                                       │ Franz Ferdinand, 1912                │
│                                       │ 2. Cápsula del tiempo de H.G. Wells, │
│                                       │ 1895                                 │
│                                       │ 3. Cápsula del tiempo de Primer      │
│                                       │ Peru, 1951                           │
│                                       │ 4. Cápsula del tiempo de Tesla, 1904 │
│                                       │ 5. Cápsula del tiempo de Philae,     │
│                                       │ 2014                                 │
│                                       │ 6. Cápsula del tiempo de Carros de   │
│                                       │ fuego, 2004                          │
│                                       │ 7. Cápsula del tiempo                │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.074 | exact_match: 0.000 | rev_kl: 0.855 | lens: 99.219 | pt_loss: 1.731 | lm_loss: 1.861 | kd_loss: 1.602 
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2700/  5000| tot_loss: 4.9300 | rl_loss: 3.1603 | pt_loss: 1.7698 | pg_loss: 2.3233 | reg_loss: 0.8370 | reward: -0.6461 | rev_kl: 0.1573 | stu_lens: 10.5000 | mixed_lens: 11.5000 | lr: 2.2711e-06 | scale: 256.00 | time: 26.995 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2701/  5000| tot_loss: 2.4491 | rl_loss: 1.0059 | pt_loss: 1.4432 | pg_loss: 0.1280 | reg_loss: 0.8779 | reward: -0.3213 | rev_kl: 0.7079 | stu_lens: 128.0000 | mixed_lens: 107.0000 | lr: 2.2695e-06 | scale: 256.00 | time: 26.997 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2702/  5000| tot_loss: 3.1224 | rl_loss: 1.2361 | pt_loss: 1.8863 | pg_loss: 0.6631 | reg_loss: 0.5730 | reward: -0.1966 | rev_kl: 0.4595 | stu_lens: 86.5000 | mixed_lens: 54.0000 | lr: 2.2679e-06 | scale: 256.00 | time: 26.972 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2703/  5000| tot_loss: 2.6912 | rl_loss: 0.9524 | pt_loss: 1.7388 | pg_loss: 0.2950 | reg_loss: 0.6573 | reward: -0.4491 | rev_kl: 0.8918 | stu_lens: 96.0000 | mixed_lens: 76.5000 | lr: 2.2663e-06 | scale: 256.00 | time: 27.011 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2704/  5000| tot_loss: 3.0050 | rl_loss: 1.2314 | pt_loss: 1.7736 | pg_loss: 0.0784 | reg_loss: 1.1529 | reward: -0.1983 | rev_kl: 0.7470 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.2647e-06 | scale: 256.00 | time: 27.004 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2704/  5000| tot_loss: 2.8521 | rl_loss: 1.2085 | pt_loss: 1.6435 | pg_loss: 0.4125 | reg_loss: 0.7960 | reward: -0.2548 | rev_kl: 0.8488 | stu_lens: 82.4375 | mixed_lens: 86.9531 | lr: 2.2647e-06 | scale: 256.00 | time: 27.004 | step time: 28.232
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2705/  5000| tot_loss: 2.4256 | rl_loss: 0.8792 | pt_loss: 1.5463 | pg_loss: 0.0634 | reg_loss: 0.8158 | reward: -0.0647 | rev_kl: 0.5994 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.2631e-06 | scale: 256.00 | time: 27.027 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2706/  5000| tot_loss: 2.6417 | rl_loss: 0.8637 | pt_loss: 1.7780 | pg_loss: 0.2094 | reg_loss: 0.6542 | reward: -0.5688 | rev_kl: 0.3005 | stu_lens: 55.5000 | mixed_lens: 49.0000 | lr: 2.2615e-06 | scale: 256.00 | time: 27.028 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2707/  5000| tot_loss: 2.8821 | rl_loss: 0.4504 | pt_loss: 2.4316 | pg_loss: -0.0135 | reg_loss: 0.4639 | reward: -0.1056 | rev_kl: 0.7817 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.2599e-06 | scale: 256.00 | time: 26.971 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2708/  5000| tot_loss: 2.5125 | rl_loss: 0.7634 | pt_loss: 1.7490 | pg_loss: 0.0557 | reg_loss: 0.7077 | reward: -0.2813 | rev_kl: 0.8859 | stu_lens: 84.0000 | mixed_lens: 114.5000 | lr: 2.2583e-06 | scale: 256.00 | time: 26.941 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2709/  5000| tot_loss: 2.8114 | rl_loss: 0.9611 | pt_loss: 1.8502 | pg_loss: 0.3673 | reg_loss: 0.5938 | reward: -0.3897 | rev_kl: 0.9822 | stu_lens: 96.0000 | mixed_lens: 76.5000 | lr: 2.2568e-06 | scale: 256.00 | time: 26.972 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2710/  5000| tot_loss: 2.4422 | rl_loss: 0.6881 | pt_loss: 1.7541 | pg_loss: 0.1466 | reg_loss: 0.5415 | reward: -0.2966 | rev_kl: 0.6965 | stu_lens: 128.0000 | mixed_lens: 95.5000 | lr: 2.2552e-06 | scale: 256.00 | time: 26.950 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2711/  5000| tot_loss: 2.4105 | rl_loss: 0.7872 | pt_loss: 1.6234 | pg_loss: 0.2825 | reg_loss: 0.5047 | reward: -0.1965 | rev_kl: 0.7035 | stu_lens: 88.0000 | mixed_lens: 94.0000 | lr: 2.2536e-06 | scale: 256.00 | time: 26.948 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2712/  5000| tot_loss: 3.0672 | rl_loss: 1.1002 | pt_loss: 1.9670 | pg_loss: 0.2560 | reg_loss: 0.8441 | reward: -0.3818 | rev_kl: 1.2536 | stu_lens: 85.5000 | mixed_lens: 75.0000 | lr: 2.2520e-06 | scale: 256.00 | time: 26.937 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2713/  5000| tot_loss: 2.9551 | rl_loss: 1.1079 | pt_loss: 1.8473 | pg_loss: 0.6205 | reg_loss: 0.4873 | reward: -0.0257 | rev_kl: 0.6403 | stu_lens: 54.5000 | mixed_lens: 55.0000 | lr: 2.2504e-06 | scale: 256.00 | time: 26.957 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2714/  5000| tot_loss: 2.6822 | rl_loss: 0.7408 | pt_loss: 1.9414 | pg_loss: 0.0872 | reg_loss: 0.6536 | reward: -0.3215 | rev_kl: 1.2915 | stu_lens: 115.5000 | mixed_lens: 100.5000 | lr: 2.2488e-06 | scale: 256.00 | time: 26.970 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2715/  5000| tot_loss: 2.5078 | rl_loss: 0.6138 | pt_loss: 1.8940 | pg_loss: 0.1486 | reg_loss: 0.4652 | reward: -0.3978 | rev_kl: 0.2971 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 2.2472e-06 | scale: 256.00 | time: 27.000 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2716/  5000| tot_loss: 2.6113 | rl_loss: 0.7599 | pt_loss: 1.8515 | pg_loss: 0.3241 | reg_loss: 0.4357 | reward: -0.0985 | rev_kl: 0.2982 | stu_lens: 70.0000 | mixed_lens: 64.5000 | lr: 2.2456e-06 | scale: 256.00 | time: 26.952 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2717/  5000| tot_loss: 2.6296 | rl_loss: 0.6949 | pt_loss: 1.9347 | pg_loss: 0.4432 | reg_loss: 0.2517 | reward: -0.5152 | rev_kl: 0.2882 | stu_lens: 67.0000 | mixed_lens: 67.5000 | lr: 2.2440e-06 | scale: 256.00 | time: 27.024 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2718/  5000| tot_loss: 2.1658 | rl_loss: 0.5194 | pt_loss: 1.6464 | pg_loss: -0.0003 | reg_loss: 0.5198 | reward: -0.2118 | rev_kl: 0.6223 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.2424e-06 | scale: 256.00 | time: 27.009 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2719/  5000| tot_loss: 3.3184 | rl_loss: 1.2822 | pt_loss: 2.0363 | pg_loss: 0.5205 | reg_loss: 0.7617 | reward: 0.1532 | rev_kl: 0.5601 | stu_lens: 49.0000 | mixed_lens: 69.5000 | lr: 2.2408e-06 | scale: 256.00 | time: 27.003 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2720/  5000| tot_loss: 2.4388 | rl_loss: 0.7199 | pt_loss: 1.7189 | pg_loss: 0.0575 | reg_loss: 0.6624 | reward: -0.3063 | rev_kl: 1.6857 | stu_lens: 75.0000 | mixed_lens: 110.5000 | lr: 2.2392e-06 | scale: 256.00 | time: 26.981 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2720/  5000| tot_loss: 2.6237 | rl_loss: 0.8819 | pt_loss: 1.7417 | pg_loss: 0.2761 | reg_loss: 0.6058 | reward: -0.2235 | rev_kl: 0.8294 | stu_lens: 85.1875 | mixed_lens: 87.5000 | lr: 2.2392e-06 | scale: 256.00 | time: 26.981 | step time: 28.209
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2721/  5000| tot_loss: 2.2068 | rl_loss: 0.5218 | pt_loss: 1.6850 | pg_loss: 0.0771 | reg_loss: 0.4447 | reward: -0.2241 | rev_kl: 2.1712 | stu_lens: 65.0000 | mixed_lens: 99.5000 | lr: 2.2376e-06 | scale: 256.00 | time: 26.983 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2722/  5000| tot_loss: 2.3292 | rl_loss: 0.6654 | pt_loss: 1.6638 | pg_loss: 0.1066 | reg_loss: 0.5588 | reward: -0.1071 | rev_kl: 0.4259 | stu_lens: 90.0000 | mixed_lens: 100.5000 | lr: 2.2360e-06 | scale: 256.00 | time: 26.968 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2723/  5000| tot_loss: 2.4924 | rl_loss: 0.7410 | pt_loss: 1.7514 | pg_loss: 0.2711 | reg_loss: 0.4699 | reward: -0.2089 | rev_kl: 0.7803 | stu_lens: 128.0000 | mixed_lens: 94.0000 | lr: 2.2344e-06 | scale: 256.00 | time: 27.007 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2724/  5000| tot_loss: 2.7008 | rl_loss: 1.2855 | pt_loss: 1.4152 | pg_loss: 1.0210 | reg_loss: 0.2645 | reward: -0.4261 | rev_kl: 0.7885 | stu_lens: 63.5000 | mixed_lens: 30.5000 | lr: 2.2328e-06 | scale: 256.00 | time: 26.959 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2725/  5000| tot_loss: 2.0826 | rl_loss: 0.6174 | pt_loss: 1.4652 | pg_loss: 0.2869 | reg_loss: 0.3305 | reward: 0.8315 | rev_kl: 1.0530 | stu_lens: 57.5000 | mixed_lens: 60.0000 | lr: 2.2312e-06 | scale: 256.00 | time: 26.987 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2726/  5000| tot_loss: 2.2337 | rl_loss: 0.5385 | pt_loss: 1.6952 | pg_loss: -0.0110 | reg_loss: 0.5495 | reward: -0.2383 | rev_kl: 1.7552 | stu_lens: 91.0000 | mixed_lens: 128.0000 | lr: 2.2296e-06 | scale: 256.00 | time: 26.967 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2727/  5000| tot_loss: 3.5854 | rl_loss: 2.0952 | pt_loss: 1.4902 | pg_loss: 1.6092 | reg_loss: 0.4860 | reward: -0.7718 | rev_kl: 0.5266 | stu_lens: 67.0000 | mixed_lens: 24.0000 | lr: 2.2281e-06 | scale: 256.00 | time: 26.963 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2728/  5000| tot_loss: 4.5808 | rl_loss: 2.7459 | pt_loss: 1.8348 | pg_loss: 2.3275 | reg_loss: 0.4185 | reward: -1.1331 | rev_kl: 0.7708 | stu_lens: 13.0000 | mixed_lens: 12.0000 | lr: 2.2265e-06 | scale: 256.00 | time: 26.944 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2729/  5000| tot_loss: 2.5342 | rl_loss: 0.4990 | pt_loss: 2.0352 | pg_loss: -0.0454 | reg_loss: 0.5444 | reward: -0.2366 | rev_kl: 0.7978 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.2249e-06 | scale: 256.00 | time: 26.977 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2730/  5000| tot_loss: 2.1895 | rl_loss: 0.6767 | pt_loss: 1.5128 | pg_loss: 0.2742 | reg_loss: 0.4026 | reward: 0.0548 | rev_kl: 0.6558 | stu_lens: 68.0000 | mixed_lens: 64.5000 | lr: 2.2233e-06 | scale: 256.00 | time: 26.979 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2731/  5000| tot_loss: 2.4485 | rl_loss: 0.4296 | pt_loss: 2.0189 | pg_loss: 0.1094 | reg_loss: 0.3203 | reward: -0.1951 | rev_kl: 1.1734 | stu_lens: 85.0000 | mixed_lens: 107.0000 | lr: 2.2217e-06 | scale: 256.00 | time: 26.994 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2732/  5000| tot_loss: 2.9684 | rl_loss: 1.1018 | pt_loss: 1.8665 | pg_loss: 0.6942 | reg_loss: 0.4076 | reward: -0.7574 | rev_kl: 0.6367 | stu_lens: 60.0000 | mixed_lens: 52.0000 | lr: 2.2201e-06 | scale: 256.00 | time: 27.032 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2733/  5000| tot_loss: 2.5096 | rl_loss: 0.8297 | pt_loss: 1.6799 | pg_loss: 0.3407 | reg_loss: 0.4890 | reward: -0.1135 | rev_kl: 0.4880 | stu_lens: 86.5000 | mixed_lens: 86.5000 | lr: 2.2185e-06 | scale: 256.00 | time: 27.088 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2734/  5000| tot_loss: 1.9938 | rl_loss: 0.3298 | pt_loss: 1.6640 | pg_loss: -0.0083 | reg_loss: 0.3381 | reward: -0.0835 | rev_kl: 0.8293 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.2169e-06 | scale: 256.00 | time: 26.983 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2735/  5000| tot_loss: 2.5052 | rl_loss: 0.3510 | pt_loss: 2.1542 | pg_loss: 0.0350 | reg_loss: 0.3160 | reward: -0.1922 | rev_kl: 0.7043 | stu_lens: 112.0000 | mixed_lens: 110.5000 | lr: 2.2153e-06 | scale: 256.00 | time: 27.018 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2736/  5000| tot_loss: 2.6850 | rl_loss: 0.7740 | pt_loss: 1.9110 | pg_loss: 0.2128 | reg_loss: 0.5611 | reward: -0.5768 | rev_kl: 0.4947 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 2.2137e-06 | scale: 256.00 | time: 26.991 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2736/  5000| tot_loss: 2.4995 | rl_loss: 0.7788 | pt_loss: 1.7208 | pg_loss: 0.3607 | reg_loss: 0.4181 | reward: -0.2717 | rev_kl: 0.9009 | stu_lens: 79.5781 | mixed_lens: 86.1094 | lr: 2.2137e-06 | scale: 256.00 | time: 26.991 | step time: 28.220
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2737/  5000| tot_loss: 2.7858 | rl_loss: 0.7337 | pt_loss: 2.0521 | pg_loss: 0.3975 | reg_loss: 0.3362 | reward: -0.3434 | rev_kl: 0.8034 | stu_lens: 68.0000 | mixed_lens: 62.5000 | lr: 2.2121e-06 | scale: 256.00 | time: 26.995 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2738/  5000| tot_loss: 2.4055 | rl_loss: 1.1650 | pt_loss: 1.2405 | pg_loss: 0.9162 | reg_loss: 0.2489 | reward: -0.5512 | rev_kl: 0.4340 | stu_lens: 67.0000 | mixed_lens: 35.0000 | lr: 2.2105e-06 | scale: 256.00 | time: 26.973 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2739/  5000| tot_loss: 2.5725 | rl_loss: 0.5666 | pt_loss: 2.0058 | pg_loss: 0.2849 | reg_loss: 0.2818 | reward: -0.3488 | rev_kl: 1.4874 | stu_lens: 53.0000 | mixed_lens: 76.5000 | lr: 2.2089e-06 | scale: 256.00 | time: 26.991 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2740/  5000| tot_loss: 1.9287 | rl_loss: 0.3310 | pt_loss: 1.5977 | pg_loss: 0.1276 | reg_loss: 0.2033 | reward: 0.8030 | rev_kl: 0.8109 | stu_lens: 106.5000 | mixed_lens: 72.0000 | lr: 2.2074e-06 | scale: 256.00 | time: 26.987 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2741/  5000| tot_loss: 2.1681 | rl_loss: 0.4227 | pt_loss: 1.7454 | pg_loss: 0.0716 | reg_loss: 0.3511 | reward: -0.0265 | rev_kl: 0.6175 | stu_lens: 82.0000 | mixed_lens: 97.0000 | lr: 2.2058e-06 | scale: 256.00 | time: 27.014 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2742/  5000| tot_loss: 0.9943 | rl_loss: 0.2170 | pt_loss: 0.7773 | pg_loss: 0.0175 | reg_loss: 0.1995 | reward: -0.0701 | rev_kl: 1.7941 | stu_lens: 67.0000 | mixed_lens: 112.5000 | lr: 2.2042e-06 | scale: 256.00 | time: 27.004 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2743/  5000| tot_loss: 2.8238 | rl_loss: 0.9961 | pt_loss: 1.8276 | pg_loss: 0.4221 | reg_loss: 0.5740 | reward: -0.1521 | rev_kl: 0.7113 | stu_lens: 56.0000 | mixed_lens: 60.5000 | lr: 2.2026e-06 | scale: 256.00 | time: 27.048 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2744/  5000| tot_loss: 2.3925 | rl_loss: 0.6053 | pt_loss: 1.7872 | pg_loss: 0.1164 | reg_loss: 0.4889 | reward: -0.0862 | rev_kl: 0.6491 | stu_lens: 112.5000 | mixed_lens: 100.5000 | lr: 2.2010e-06 | scale: 256.00 | time: 27.021 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2745/  5000| tot_loss: 2.2570 | rl_loss: 0.4576 | pt_loss: 1.7994 | pg_loss: 0.2544 | reg_loss: 0.2032 | reward: -0.2441 | rev_kl: 0.6203 | stu_lens: 128.0000 | mixed_lens: 94.0000 | lr: 2.1994e-06 | scale: 256.00 | time: 27.061 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2746/  5000| tot_loss: 2.5820 | rl_loss: 0.6837 | pt_loss: 1.8982 | pg_loss: 0.2489 | reg_loss: 0.4349 | reward: -0.5042 | rev_kl: 0.4984 | stu_lens: 21.5000 | mixed_lens: 52.0000 | lr: 2.1978e-06 | scale: 256.00 | time: 26.984 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2747/  5000| tot_loss: 3.5375 | rl_loss: 1.6991 | pt_loss: 1.8384 | pg_loss: 1.4867 | reg_loss: 0.2124 | reward: -0.4980 | rev_kl: 0.7674 | stu_lens: 13.5000 | mixed_lens: 10.0000 | lr: 2.1962e-06 | scale: 256.00 | time: 27.014 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2748/  5000| tot_loss: 2.1483 | rl_loss: 0.5852 | pt_loss: 1.5631 | pg_loss: 0.2369 | reg_loss: 0.3484 | reward: -0.4010 | rev_kl: 0.6593 | stu_lens: 128.0000 | mixed_lens: 84.5000 | lr: 2.1946e-06 | scale: 256.00 | time: 27.000 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2749/  5000| tot_loss: 2.3002 | rl_loss: 0.4265 | pt_loss: 1.8737 | pg_loss: 0.1037 | reg_loss: 0.3229 | reward: -0.2177 | rev_kl: 0.9012 | stu_lens: 79.0000 | mixed_lens: 116.0000 | lr: 2.1930e-06 | scale: 256.00 | time: 27.001 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/2750
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2750/  5000| tot_loss: 2.1023 | rl_loss: 0.3728 | pt_loss: 1.7295 | pg_loss: 0.0994 | reg_loss: 0.2734 | reward: -0.2321 | rev_kl: 0.6853 | stu_lens: 114.5000 | mixed_lens: 112.5000 | lr: 2.1914e-06 | scale: 256.00 | time: 26.981 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2751/  5000| tot_loss: 2.0147 | rl_loss: 0.7575 | pt_loss: 1.2573 | pg_loss: 0.3168 | reg_loss: 0.4407 | reward: -0.3104 | rev_kl: 0.3449 | stu_lens: 73.0000 | mixed_lens: 68.0000 | lr: 2.1898e-06 | scale: 256.00 | time: 27.086 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2752/  5000| tot_loss: 2.4294 | rl_loss: 0.7424 | pt_loss: 1.6870 | pg_loss: 0.3213 | reg_loss: 0.4211 | reward: -0.5053 | rev_kl: 1.0853 | stu_lens: 51.5000 | mixed_lens: 73.5000 | lr: 2.1883e-06 | scale: 256.00 | time: 26.988 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2752/  5000| tot_loss: 2.2974 | rl_loss: 0.6216 | pt_loss: 1.6758 | pg_loss: 0.2625 | reg_loss: 0.3590 | reward: -0.2644 | rev_kl: 0.8757 | stu_lens: 82.7656 | mixed_lens: 86.6562 | lr: 2.1883e-06 | scale: 256.00 | time: 26.988 | step time: 28.240
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2753/  5000| tot_loss: 2.1895 | rl_loss: 0.3182 | pt_loss: 1.8713 | pg_loss: -0.0321 | reg_loss: 0.3503 | reward: -0.0514 | rev_kl: 0.5941 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.1867e-06 | scale: 256.00 | time: 27.015 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2754/  5000| tot_loss: 3.1550 | rl_loss: 1.2105 | pt_loss: 1.9445 | pg_loss: 0.2649 | reg_loss: 0.9456 | reward: -0.3443 | rev_kl: 0.4406 | stu_lens: 112.0000 | mixed_lens: 89.0000 | lr: 2.1851e-06 | scale: 256.00 | time: 27.079 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2755/  5000| tot_loss: 2.6290 | rl_loss: 1.2206 | pt_loss: 1.4083 | pg_loss: 0.3247 | reg_loss: 0.8959 | reward: -0.3298 | rev_kl: 0.8432 | stu_lens: 101.0000 | mixed_lens: 87.0000 | lr: 2.1835e-06 | scale: 256.00 | time: 27.034 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2756/  5000| tot_loss: 2.8822 | rl_loss: 0.9832 | pt_loss: 1.8989 | pg_loss: 0.0416 | reg_loss: 0.9416 | reward: -0.2362 | rev_kl: 0.9544 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.1819e-06 | scale: 256.00 | time: 27.036 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2757/  5000| tot_loss: 3.0787 | rl_loss: 1.5080 | pt_loss: 1.5707 | pg_loss: 0.3469 | reg_loss: 1.1611 | reward: -0.3393 | rev_kl: 1.0040 | stu_lens: 89.5000 | mixed_lens: 70.5000 | lr: 2.1803e-06 | scale: 256.00 | time: 27.054 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2758/  5000| tot_loss: 3.4640 | rl_loss: 1.5144 | pt_loss: 1.9496 | pg_loss: 0.3315 | reg_loss: 1.1829 | reward: -0.2155 | rev_kl: 0.6878 | stu_lens: 128.0000 | mixed_lens: 95.5000 | lr: 2.1787e-06 | scale: 256.00 | time: 26.982 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2759/  5000| tot_loss: 3.8195 | rl_loss: 1.8028 | pt_loss: 2.0167 | pg_loss: 0.5256 | reg_loss: 1.2772 | reward: -0.6690 | rev_kl: 0.6688 | stu_lens: 80.5000 | mixed_lens: 74.5000 | lr: 2.1771e-06 | scale: 256.00 | time: 27.001 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2760/  5000| tot_loss: 3.3189 | rl_loss: 1.2437 | pt_loss: 2.0751 | pg_loss: 0.3751 | reg_loss: 0.8686 | reward: -0.3338 | rev_kl: 0.7732 | stu_lens: 102.0000 | mixed_lens: 72.0000 | lr: 2.1755e-06 | scale: 256.00 | time: 26.996 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2761/  5000| tot_loss: 3.3546 | rl_loss: 1.3328 | pt_loss: 2.0218 | pg_loss: 0.4071 | reg_loss: 0.9257 | reward: -0.2854 | rev_kl: 0.8424 | stu_lens: 107.0000 | mixed_lens: 81.0000 | lr: 2.1739e-06 | scale: 256.00 | time: 27.004 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2762/  5000| tot_loss: 2.4314 | rl_loss: 1.2412 | pt_loss: 1.1902 | pg_loss: 0.1951 | reg_loss: 1.0460 | reward: -0.0447 | rev_kl: 0.7504 | stu_lens: 98.0000 | mixed_lens: 104.5000 | lr: 2.1724e-06 | scale: 256.00 | time: 26.981 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2763/  5000| tot_loss: 3.1499 | rl_loss: 1.4201 | pt_loss: 1.7298 | pg_loss: 0.4012 | reg_loss: 1.0190 | reward: -0.7279 | rev_kl: 0.8437 | stu_lens: 84.5000 | mixed_lens: 78.0000 | lr: 2.1708e-06 | scale: 256.00 | time: 27.025 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2764/  5000| tot_loss: 2.7866 | rl_loss: 1.0735 | pt_loss: 1.7131 | pg_loss: 0.1134 | reg_loss: 0.9601 | reward: -0.0330 | rev_kl: 0.7556 | stu_lens: 110.5000 | mixed_lens: 113.5000 | lr: 2.1692e-06 | scale: 256.00 | time: 26.991 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2765/  5000| tot_loss: 2.9920 | rl_loss: 1.0107 | pt_loss: 1.9813 | pg_loss: 0.4304 | reg_loss: 0.5803 | reward: -0.4750 | rev_kl: 0.5539 | stu_lens: 76.5000 | mixed_lens: 29.5000 | lr: 2.1676e-06 | scale: 256.00 | time: 27.007 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2766/  5000| tot_loss: 3.2143 | rl_loss: 1.2100 | pt_loss: 2.0043 | pg_loss: 0.4166 | reg_loss: 0.7934 | reward: 0.0306 | rev_kl: 0.3849 | stu_lens: 128.0000 | mixed_lens: 69.5000 | lr: 2.1660e-06 | scale: 256.00 | time: 26.983 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2767/  5000| tot_loss: 2.7183 | rl_loss: 0.8840 | pt_loss: 1.8343 | pg_loss: 0.0906 | reg_loss: 0.7934 | reward: -0.1954 | rev_kl: 1.0065 | stu_lens: 110.5000 | mixed_lens: 120.5000 | lr: 2.1644e-06 | scale: 256.00 | time: 27.024 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2768/  5000| tot_loss: 2.4546 | rl_loss: 0.7110 | pt_loss: 1.7436 | pg_loss: 0.0329 | reg_loss: 0.6781 | reward: -0.3262 | rev_kl: 0.7897 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.1628e-06 | scale: 256.00 | time: 27.020 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2768/  5000| tot_loss: 3.0344 | rl_loss: 1.2139 | pt_loss: 1.8205 | pg_loss: 0.3823 | reg_loss: 0.8316 | reward: -0.3008 | rev_kl: 0.7592 | stu_lens: 89.1250 | mixed_lens: 84.9375 | lr: 2.1628e-06 | scale: 256.00 | time: 27.020 | step time: 28.246
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2769/  5000| tot_loss: 2.2098 | rl_loss: 0.5807 | pt_loss: 1.6291 | pg_loss: 0.1261 | reg_loss: 0.4545 | reward: -0.2236 | rev_kl: 0.4087 | stu_lens: 114.5000 | mixed_lens: 108.0000 | lr: 2.1612e-06 | scale: 256.00 | time: 27.045 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2770/  5000| tot_loss: 2.5653 | rl_loss: 0.8710 | pt_loss: 1.6943 | pg_loss: 0.2465 | reg_loss: 0.6244 | reward: -0.1485 | rev_kl: 0.8999 | stu_lens: 98.0000 | mixed_lens: 93.5000 | lr: 2.1597e-06 | scale: 256.00 | time: 27.005 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2771/  5000| tot_loss: 1.7669 | rl_loss: 0.6036 | pt_loss: 1.1634 | pg_loss: 0.0800 | reg_loss: 0.5235 | reward: -0.1217 | rev_kl: 1.1360 | stu_lens: 80.5000 | mixed_lens: 114.0000 | lr: 2.1581e-06 | scale: 256.00 | time: 27.019 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2772/  5000| tot_loss: 3.4440 | rl_loss: 1.6863 | pt_loss: 1.7577 | pg_loss: 1.4128 | reg_loss: 0.2735 | reward: -0.4587 | rev_kl: 0.2576 | stu_lens: 15.5000 | mixed_lens: 19.5000 | lr: 2.1565e-06 | scale: 256.00 | time: 26.995 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2773/  5000| tot_loss: 2.6325 | rl_loss: 0.6155 | pt_loss: 2.0170 | pg_loss: 0.1019 | reg_loss: 0.5136 | reward: -0.1793 | rev_kl: 0.4850 | stu_lens: 117.5000 | mixed_lens: 101.0000 | lr: 2.1549e-06 | scale: 256.00 | time: 27.023 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2774/  5000| tot_loss: 2.8672 | rl_loss: 0.8552 | pt_loss: 2.0120 | pg_loss: 0.0540 | reg_loss: 0.8012 | reward: -0.2369 | rev_kl: 0.9084 | stu_lens: 94.0000 | mixed_lens: 126.5000 | lr: 2.1533e-06 | scale: 256.00 | time: 26.981 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2775/  5000| tot_loss: 3.7385 | rl_loss: 1.6253 | pt_loss: 2.1132 | pg_loss: 1.2829 | reg_loss: 0.3424 | reward: -0.1904 | rev_kl: 0.4997 | stu_lens: 13.0000 | mixed_lens: 36.0000 | lr: 2.1517e-06 | scale: 256.00 | time: 26.999 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2776/  5000| tot_loss: 1.9379 | rl_loss: 0.4229 | pt_loss: 1.5150 | pg_loss: 0.0029 | reg_loss: 0.4200 | reward: -0.2985 | rev_kl: 0.5092 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.1501e-06 | scale: 256.00 | time: 26.987 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2777/  5000| tot_loss: 2.5615 | rl_loss: 0.9993 | pt_loss: 1.5622 | pg_loss: 0.2792 | reg_loss: 0.7201 | reward: -0.7055 | rev_kl: 0.4970 | stu_lens: 27.0000 | mixed_lens: 81.5000 | lr: 2.1485e-06 | scale: 256.00 | time: 26.995 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2778/  5000| tot_loss: 4.0122 | rl_loss: 1.9180 | pt_loss: 2.0942 | pg_loss: 0.9249 | reg_loss: 0.9931 | reward: -2.0503 | rev_kl: 1.2419 | stu_lens: 37.0000 | mixed_lens: 43.5000 | lr: 2.1470e-06 | scale: 256.00 | time: 26.991 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2779/  5000| tot_loss: 3.2045 | rl_loss: 1.3721 | pt_loss: 1.8324 | pg_loss: 0.9767 | reg_loss: 0.3954 | reward: -0.1312 | rev_kl: 0.7772 | stu_lens: 9.5000 | mixed_lens: 26.5000 | lr: 2.1454e-06 | scale: 256.00 | time: 27.006 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2780/  5000| tot_loss: 1.7917 | rl_loss: 0.3994 | pt_loss: 1.3923 | pg_loss: 0.0120 | reg_loss: 0.3875 | reward: -0.2823 | rev_kl: 1.0974 | stu_lens: 71.5000 | mixed_lens: 121.5000 | lr: 2.1438e-06 | scale: 256.00 | time: 27.022 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2781/  5000| tot_loss: 3.7260 | rl_loss: 1.7313 | pt_loss: 1.9947 | pg_loss: 0.8975 | reg_loss: 0.8338 | reward: -0.7613 | rev_kl: 0.6866 | stu_lens: 80.5000 | mixed_lens: 47.0000 | lr: 2.1422e-06 | scale: 256.00 | time: 27.026 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2782/  5000| tot_loss: 2.5406 | rl_loss: 0.9897 | pt_loss: 1.5509 | pg_loss: 0.3640 | reg_loss: 0.6256 | reward: -0.2197 | rev_kl: 0.7659 | stu_lens: 85.0000 | mixed_lens: 74.5000 | lr: 2.1406e-06 | scale: 256.00 | time: 27.040 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2783/  5000| tot_loss: 2.4849 | rl_loss: 0.7086 | pt_loss: 1.7762 | pg_loss: 0.0228 | reg_loss: 0.6859 | reward: -0.1234 | rev_kl: 0.9815 | stu_lens: 110.5000 | mixed_lens: 128.0000 | lr: 2.1390e-06 | scale: 256.00 | time: 27.003 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2784/  5000| tot_loss: 3.1092 | rl_loss: 1.1505 | pt_loss: 1.9587 | pg_loss: 0.3268 | reg_loss: 0.8237 | reward: -0.2556 | rev_kl: 1.1225 | stu_lens: 90.0000 | mixed_lens: 77.0000 | lr: 2.1374e-06 | scale: 256.00 | time: 26.992 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2784/  5000| tot_loss: 2.8004 | rl_loss: 1.0042 | pt_loss: 1.7962 | pg_loss: 0.3704 | reg_loss: 0.6338 | reward: -0.3368 | rev_kl: 0.7665 | stu_lens: 88.8750 | mixed_lens: 86.3125 | lr: 2.1374e-06 | scale: 256.00 | time: 26.992 | step time: 28.237
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2785/  5000| tot_loss: 3.5954 | rl_loss: 1.0327 | pt_loss: 2.5626 | pg_loss: 0.4524 | reg_loss: 0.5803 | reward: -0.0364 | rev_kl: 0.7843 | stu_lens: 36.5000 | mixed_lens: 45.5000 | lr: 2.1358e-06 | scale: 256.00 | time: 26.989 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2786/  5000| tot_loss: 2.7725 | rl_loss: 0.6520 | pt_loss: 2.1204 | pg_loss: 0.0131 | reg_loss: 0.6390 | reward: -0.2419 | rev_kl: 0.9283 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.1343e-06 | scale: 256.00 | time: 26.997 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2787/  5000| tot_loss: 2.8276 | rl_loss: 0.9483 | pt_loss: 1.8794 | pg_loss: 0.3210 | reg_loss: 0.6273 | reward: -0.1930 | rev_kl: 0.8812 | stu_lens: 89.0000 | mixed_lens: 79.0000 | lr: 2.1327e-06 | scale: 256.00 | time: 26.970 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2788/  5000| tot_loss: 2.3090 | rl_loss: 0.3274 | pt_loss: 1.9816 | pg_loss: 0.0464 | reg_loss: 0.2811 | reward: -0.2939 | rev_kl: 0.9129 | stu_lens: 128.0000 | mixed_lens: 120.5000 | lr: 2.1311e-06 | scale: 256.00 | time: 26.999 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2789/  5000| tot_loss: 2.3647 | rl_loss: 0.9632 | pt_loss: 1.4014 | pg_loss: 0.3092 | reg_loss: 0.6540 | reward: -0.3639 | rev_kl: 0.6033 | stu_lens: 128.0000 | mixed_lens: 86.0000 | lr: 2.1295e-06 | scale: 256.00 | time: 26.985 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2790/  5000| tot_loss: 2.7299 | rl_loss: 0.4956 | pt_loss: 2.2343 | pg_loss: 0.1770 | reg_loss: 0.3186 | reward: -0.0111 | rev_kl: 0.5044 | stu_lens: 55.5000 | mixed_lens: 43.0000 | lr: 2.1279e-06 | scale: 256.00 | time: 27.014 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2791/  5000| tot_loss: 2.5149 | rl_loss: 0.4830 | pt_loss: 2.0320 | pg_loss: 0.0825 | reg_loss: 0.4005 | reward: -0.1364 | rev_kl: 0.6899 | stu_lens: 44.5000 | mixed_lens: 114.0000 | lr: 2.1263e-06 | scale: 256.00 | time: 26.998 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2792/  5000| tot_loss: 2.3721 | rl_loss: 0.4292 | pt_loss: 1.9429 | pg_loss: 0.0029 | reg_loss: 0.4263 | reward: -0.2658 | rev_kl: 0.6175 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.1248e-06 | scale: 256.00 | time: 27.056 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2793/  5000| tot_loss: 2.3876 | rl_loss: 0.5273 | pt_loss: 1.8603 | pg_loss: 0.2308 | reg_loss: 0.2965 | reward: -0.0296 | rev_kl: 0.9349 | stu_lens: 53.0000 | mixed_lens: 86.0000 | lr: 2.1232e-06 | scale: 256.00 | time: 27.023 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2794/  5000| tot_loss: 2.9770 | rl_loss: 0.8773 | pt_loss: 2.0997 | pg_loss: 0.4599 | reg_loss: 0.4174 | reward: -0.0752 | rev_kl: 0.5788 | stu_lens: 128.0000 | mixed_lens: 69.5000 | lr: 2.1216e-06 | scale: 256.00 | time: 27.060 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2795/  5000| tot_loss: 1.7837 | rl_loss: 0.3704 | pt_loss: 1.4133 | pg_loss: -0.0209 | reg_loss: 0.3913 | reward: -0.2905 | rev_kl: 0.5780 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.1200e-06 | scale: 256.00 | time: 26.986 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2796/  5000| tot_loss: 2.3458 | rl_loss: 0.7184 | pt_loss: 1.6275 | pg_loss: 0.2517 | reg_loss: 0.4667 | reward: -0.2333 | rev_kl: 0.4250 | stu_lens: 117.5000 | mixed_lens: 50.0000 | lr: 2.1184e-06 | scale: 256.00 | time: 27.008 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2797/  5000| tot_loss: 2.5064 | rl_loss: 0.7926 | pt_loss: 1.7138 | pg_loss: 0.2039 | reg_loss: 0.5887 | reward: -0.1602 | rev_kl: 1.0249 | stu_lens: 72.5000 | mixed_lens: 77.0000 | lr: 2.1168e-06 | scale: 256.00 | time: 26.985 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2798/  5000| tot_loss: 2.5454 | rl_loss: 0.8917 | pt_loss: 1.6537 | pg_loss: 0.5257 | reg_loss: 0.3661 | reward: -0.2311 | rev_kl: 0.8634 | stu_lens: 22.0000 | mixed_lens: 64.0000 | lr: 2.1152e-06 | scale: 256.00 | time: 26.997 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2799/  5000| tot_loss: 2.2131 | rl_loss: 1.0980 | pt_loss: 1.1152 | pg_loss: 0.3654 | reg_loss: 0.7325 | reward: -0.0918 | rev_kl: 0.8946 | stu_lens: 93.0000 | mixed_lens: 86.0000 | lr: 2.1137e-06 | scale: 256.00 | time: 26.981 | step time: 0.000
                                 Evaluation #28                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son particles elementales │
│                                       │ que forman parte de la materia, y    │
│                                       │ están incluidos en la teoría de la   │
│                                       │ relatividad y la mecánica cuántica.  │
│                                       │ Existen cuatro tipos de cuarks:      │
│                                       │                                      │
│                                       │ * Cuark de calor (quark c)           │
│                                       │ * Cuark de escalera (quark b)        │
│                                       │ * Cuark de burbuja (quark t)         │
│                                       │ * Cuark de fracción (quark u)        │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es una herramienta para       │
│                                       │ promover el intercambio de           │
│                                       │ información entre los riesgos de la  │
│                                       │ sociedad. Fundado en 1981, el IMC    │
│                                       │ está dedicado a la investigación, el │
│                                       │ desarrollo e implementación de       │
│                                       │ herramientas de información y        │
│                                       │ control de riesgos. Sus miembros,    │
│                                       │ que incluyen a gobiernos,            │
│                                       │ organizaciones internacionales,      │
│                                       │ empresas, instituciones académicas y │
│                                       │ organizaciones de la sociedad civil, │
│                                       │ trabajan juntos para producir        │
│                                       │ información de seguridad y gestión   │
│                                       │ de riesgos, que es esencial          │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ - La cápsula del tiempo del Doctor   │
│                                       │ Who, 1963                            │
│                                       │ - La cápsula del tiempo de la        │
│                                       │ muñeca, 1972                         │
│                                       │ - La cápsula del tiempo de la        │
│                                       │ novela, 1979                         │
│                                       │ - La cápsula del tiempo de la        │
│                                       │ película, 1980                       │
│                                       │ - La cápsula del tiempo del          │
│                                       │ Megadeth, 1991                       │
│                                       │ - La cápsula del tiempo de la        │
│                                       │ ceremonia, 1997                      │
│                                       │ - La cápsula del tiempo de la        │
│                                       │ cantante, 20                         │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.194 | exact_match: 0.000 | rev_kl: 0.845 | lens: 97.912 | pt_loss: 1.730 | lm_loss: 1.860 | kd_loss: 1.601 
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2800/  5000| tot_loss: 2.4390 | rl_loss: 0.6513 | pt_loss: 1.7877 | pg_loss: 0.3251 | reg_loss: 0.3261 | reward: -0.6957 | rev_kl: 0.7361 | stu_lens: 80.5000 | mixed_lens: 74.5000 | lr: 2.1121e-06 | scale: 256.00 | time: 27.001 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2800/  5000| tot_loss: 2.6626 | rl_loss: 0.8617 | pt_loss: 1.8010 | pg_loss: 0.3667 | reg_loss: 0.4950 | reward: -0.3088 | rev_kl: 0.7702 | stu_lens: 82.8594 | mixed_lens: 78.3906 | lr: 2.1121e-06 | scale: 256.00 | time: 27.001 | step time: 28.233
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2801/  5000| tot_loss: 2.3285 | rl_loss: 0.5961 | pt_loss: 1.7324 | pg_loss: 0.0370 | reg_loss: 0.5590 | reward: -0.1590 | rev_kl: 0.6704 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.1105e-06 | scale: 256.00 | time: 27.058 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2802/  5000| tot_loss: 2.4807 | rl_loss: 0.6567 | pt_loss: 1.8240 | pg_loss: 0.3891 | reg_loss: 0.2676 | reward: -2.3039 | rev_kl: 1.1435 | stu_lens: 61.5000 | mixed_lens: 55.0000 | lr: 2.1089e-06 | scale: 256.00 | time: 27.008 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2803/  5000| tot_loss: 2.3446 | rl_loss: 0.3702 | pt_loss: 1.9744 | pg_loss: 0.0312 | reg_loss: 0.3390 | reward: -0.2411 | rev_kl: 0.4053 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.1073e-06 | scale: 256.00 | time: 27.007 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2804/  5000| tot_loss: 2.3638 | rl_loss: 0.4691 | pt_loss: 1.8946 | pg_loss: 0.0961 | reg_loss: 0.3730 | reward: -0.2475 | rev_kl: 0.9734 | stu_lens: 74.5000 | mixed_lens: 97.5000 | lr: 2.1057e-06 | scale: 256.00 | time: 27.024 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2805/  5000| tot_loss: 1.9198 | rl_loss: 0.2826 | pt_loss: 1.6372 | pg_loss: 0.0023 | reg_loss: 0.2804 | reward: -0.1243 | rev_kl: 0.7141 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.1042e-06 | scale: 256.00 | time: 27.028 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2806/  5000| tot_loss: 2.3957 | rl_loss: 0.5523 | pt_loss: 1.8434 | pg_loss: 0.1087 | reg_loss: 0.4436 | reward: -0.2285 | rev_kl: 0.5717 | stu_lens: 65.5000 | mixed_lens: 109.5000 | lr: 2.1026e-06 | scale: 256.00 | time: 27.045 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2807/  5000| tot_loss: 2.5921 | rl_loss: 0.7387 | pt_loss: 1.8534 | pg_loss: 0.4023 | reg_loss: 0.3365 | reward: -0.1517 | rev_kl: 1.0669 | stu_lens: 41.0000 | mixed_lens: 54.5000 | lr: 2.1010e-06 | scale: 256.00 | time: 26.986 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2808/  5000| tot_loss: 2.2383 | rl_loss: 0.4730 | pt_loss: 1.7653 | pg_loss: 0.0515 | reg_loss: 0.4214 | reward: -0.4008 | rev_kl: 0.6181 | stu_lens: 128.0000 | mixed_lens: 120.5000 | lr: 2.0994e-06 | scale: 256.00 | time: 26.999 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2809/  5000| tot_loss: 1.9400 | rl_loss: 0.4956 | pt_loss: 1.4444 | pg_loss: 0.1892 | reg_loss: 0.3064 | reward: -0.2519 | rev_kl: 0.6599 | stu_lens: 107.0000 | mixed_lens: 81.0000 | lr: 2.0978e-06 | scale: 256.00 | time: 27.017 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2810/  5000| tot_loss: 2.6320 | rl_loss: 0.7285 | pt_loss: 1.9035 | pg_loss: 0.3313 | reg_loss: 0.3972 | reward: -0.0271 | rev_kl: 0.7538 | stu_lens: 84.5000 | mixed_lens: 84.5000 | lr: 2.0963e-06 | scale: 256.00 | time: 27.007 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2811/  5000| tot_loss: 1.9162 | rl_loss: 0.5031 | pt_loss: 1.4131 | pg_loss: 0.2457 | reg_loss: 0.2574 | reward: -0.1915 | rev_kl: 0.8680 | stu_lens: 90.0000 | mixed_lens: 92.0000 | lr: 2.0947e-06 | scale: 256.00 | time: 26.984 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2812/  5000| tot_loss: 1.9315 | rl_loss: 0.4923 | pt_loss: 1.4393 | pg_loss: 0.1304 | reg_loss: 0.3618 | reward: -0.2713 | rev_kl: 0.5452 | stu_lens: 117.5000 | mixed_lens: 101.0000 | lr: 2.0931e-06 | scale: 256.00 | time: 27.015 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2813/  5000| tot_loss: 1.4135 | rl_loss: 0.3141 | pt_loss: 1.0994 | pg_loss: 0.0556 | reg_loss: 0.2585 | reward: -0.4129 | rev_kl: 0.7901 | stu_lens: 62.0000 | mixed_lens: 109.5000 | lr: 2.0915e-06 | scale: 256.00 | time: 27.000 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2814/  5000| tot_loss: 2.1753 | rl_loss: 0.6520 | pt_loss: 1.5233 | pg_loss: 0.1750 | reg_loss: 0.4770 | reward: -0.1411 | rev_kl: 0.7528 | stu_lens: 86.5000 | mixed_lens: 79.0000 | lr: 2.0899e-06 | scale: 256.00 | time: 27.026 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2815/  5000| tot_loss: 2.5244 | rl_loss: 0.4140 | pt_loss: 2.1104 | pg_loss: 0.2791 | reg_loss: 0.1348 | reward: -0.7025 | rev_kl: 0.8230 | stu_lens: 80.5000 | mixed_lens: 74.5000 | lr: 2.0883e-06 | scale: 256.00 | time: 26.995 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2816/  5000| tot_loss: 2.1612 | rl_loss: 0.9558 | pt_loss: 1.2054 | pg_loss: 0.6861 | reg_loss: 0.2697 | reward: -0.3054 | rev_kl: 0.3924 | stu_lens: 76.5000 | mixed_lens: 22.0000 | lr: 2.0868e-06 | scale: 256.00 | time: 27.050 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2816/  5000| tot_loss: 2.2917 | rl_loss: 0.5611 | pt_loss: 1.7306 | pg_loss: 0.1963 | reg_loss: 0.3647 | reward: -0.3131 | rev_kl: 0.7895 | stu_lens: 90.5312 | mixed_lens: 87.6250 | lr: 2.0868e-06 | scale: 256.00 | time: 27.050 | step time: 28.252
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2817/  5000| tot_loss: 2.6672 | rl_loss: 1.2568 | pt_loss: 1.4104 | pg_loss: 1.0503 | reg_loss: 0.2065 | reward: -0.1055 | rev_kl: 0.3128 | stu_lens: 9.5000 | mixed_lens: 25.0000 | lr: 2.0852e-06 | scale: 256.00 | time: 27.032 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2818/  5000| tot_loss: 2.7416 | rl_loss: 1.1938 | pt_loss: 1.5478 | pg_loss: 0.1385 | reg_loss: 1.0552 | reward: -0.1693 | rev_kl: 0.9375 | stu_lens: 128.0000 | mixed_lens: 116.0000 | lr: 2.0836e-06 | scale: 256.00 | time: 27.082 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2819/  5000| tot_loss: 3.1596 | rl_loss: 0.8952 | pt_loss: 2.2644 | pg_loss: 0.0509 | reg_loss: 0.8443 | reward: -0.1433 | rev_kl: 0.5492 | stu_lens: 91.5000 | mixed_lens: 128.0000 | lr: 2.0820e-06 | scale: 256.00 | time: 27.005 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2820/  5000| tot_loss: 2.6164 | rl_loss: 1.3100 | pt_loss: 1.3064 | pg_loss: 0.3070 | reg_loss: 1.0031 | reward: -0.2659 | rev_kl: 0.6659 | stu_lens: 83.5000 | mixed_lens: 87.5000 | lr: 2.0804e-06 | scale: 256.00 | time: 27.030 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2821/  5000| tot_loss: 2.9488 | rl_loss: 0.9456 | pt_loss: 2.0032 | pg_loss: 0.1261 | reg_loss: 0.8194 | reward: -0.0847 | rev_kl: 0.6940 | stu_lens: 128.0000 | mixed_lens: 112.0000 | lr: 2.0789e-06 | scale: 256.00 | time: 27.012 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2822/  5000| tot_loss: 2.8908 | rl_loss: 1.1540 | pt_loss: 1.7368 | pg_loss: 0.0650 | reg_loss: 1.0890 | reward: -0.1630 | rev_kl: 0.9245 | stu_lens: 109.0000 | mixed_lens: 128.0000 | lr: 2.0773e-06 | scale: 256.00 | time: 27.009 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2823/  5000| tot_loss: 2.3706 | rl_loss: 0.4586 | pt_loss: 1.9120 | pg_loss: 0.1721 | reg_loss: 0.2865 | reward: 0.0031 | rev_kl: 0.5468 | stu_lens: 42.5000 | mixed_lens: 87.0000 | lr: 2.0757e-06 | scale: 256.00 | time: 26.986 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2824/  5000| tot_loss: 2.1874 | rl_loss: 0.9287 | pt_loss: 1.2588 | pg_loss: 0.0789 | reg_loss: 0.8498 | reward: -0.0105 | rev_kl: 0.7098 | stu_lens: 128.0000 | mixed_lens: 124.0000 | lr: 2.0741e-06 | scale: 256.00 | time: 27.017 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2825/  5000| tot_loss: 3.4594 | rl_loss: 1.4835 | pt_loss: 1.9760 | pg_loss: 1.0445 | reg_loss: 0.4389 | reward: -0.1125 | rev_kl: 0.3021 | stu_lens: 38.0000 | mixed_lens: 46.0000 | lr: 2.0725e-06 | scale: 256.00 | time: 27.003 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2826/  5000| tot_loss: 2.7829 | rl_loss: 0.8965 | pt_loss: 1.8864 | pg_loss: 0.0438 | reg_loss: 0.8527 | reward: -0.1907 | rev_kl: 2.2009 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.0710e-06 | scale: 256.00 | time: 27.041 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2827/  5000| tot_loss: 3.5439 | rl_loss: 1.9017 | pt_loss: 1.6423 | pg_loss: 1.0890 | reg_loss: 0.8127 | reward: -0.4484 | rev_kl: 1.0649 | stu_lens: 48.0000 | mixed_lens: 45.5000 | lr: 2.0694e-06 | scale: 256.00 | time: 27.030 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2828/  5000| tot_loss: 2.7415 | rl_loss: 1.4657 | pt_loss: 1.2758 | pg_loss: 0.7193 | reg_loss: 0.7464 | reward: -0.2711 | rev_kl: 0.3238 | stu_lens: 67.0000 | mixed_lens: 36.5000 | lr: 2.0678e-06 | scale: 256.00 | time: 27.047 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2829/  5000| tot_loss: 2.9763 | rl_loss: 1.1117 | pt_loss: 1.8646 | pg_loss: 0.3437 | reg_loss: 0.7679 | reward: -0.8394 | rev_kl: 0.4663 | stu_lens: 67.5000 | mixed_lens: 58.0000 | lr: 2.0662e-06 | scale: 256.00 | time: 27.059 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2830/  5000| tot_loss: 1.7384 | rl_loss: 0.4512 | pt_loss: 1.2872 | pg_loss: 0.2181 | reg_loss: 0.2331 | reward: 0.6601 | rev_kl: 0.0440 | stu_lens: 14.0000 | mixed_lens: 15.0000 | lr: 2.0647e-06 | scale: 256.00 | time: 27.034 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2831/  5000| tot_loss: 3.2600 | rl_loss: 1.2554 | pt_loss: 2.0047 | pg_loss: 0.2661 | reg_loss: 0.9893 | reward: -0.1876 | rev_kl: 0.6622 | stu_lens: 128.0000 | mixed_lens: 107.5000 | lr: 2.0631e-06 | scale: 256.00 | time: 27.009 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2832/  5000| tot_loss: 1.9744 | rl_loss: 0.4913 | pt_loss: 1.4831 | pg_loss: -0.0622 | reg_loss: 0.5535 | reward: -0.1329 | rev_kl: 0.5088 | stu_lens: 42.5000 | mixed_lens: 25.5000 | lr: 2.0615e-06 | scale: 256.00 | time: 27.046 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2832/  5000| tot_loss: 2.7710 | rl_loss: 1.0999 | pt_loss: 1.6711 | pg_loss: 0.3252 | reg_loss: 0.7747 | reward: -0.1929 | rev_kl: 0.6961 | stu_lens: 82.5469 | mixed_lens: 84.2031 | lr: 2.0615e-06 | scale: 256.00 | time: 27.046 | step time: 28.265
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2833/  5000| tot_loss: 3.0869 | rl_loss: 1.0317 | pt_loss: 2.0552 | pg_loss: 0.0885 | reg_loss: 0.9433 | reward: -0.1786 | rev_kl: 1.0103 | stu_lens: 117.5000 | mixed_lens: 125.5000 | lr: 2.0599e-06 | scale: 256.00 | time: 27.002 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2834/  5000| tot_loss: 1.7861 | rl_loss: 0.8247 | pt_loss: 0.9615 | pg_loss: 0.2522 | reg_loss: 0.5725 | reward: -0.0680 | rev_kl: 0.3622 | stu_lens: 93.0000 | mixed_lens: 93.5000 | lr: 2.0583e-06 | scale: 256.00 | time: 27.021 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2835/  5000| tot_loss: 2.7792 | rl_loss: 0.6314 | pt_loss: 2.1478 | pg_loss: -0.0097 | reg_loss: 0.6411 | reward: -0.1118 | rev_kl: 0.6541 | stu_lens: 92.5000 | mixed_lens: 128.0000 | lr: 2.0568e-06 | scale: 256.00 | time: 27.002 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2836/  5000| tot_loss: 2.3094 | rl_loss: 0.6283 | pt_loss: 1.6812 | pg_loss: 0.1231 | reg_loss: 0.5052 | reward: -0.4697 | rev_kl: 0.7488 | stu_lens: 84.0000 | mixed_lens: 60.0000 | lr: 2.0552e-06 | scale: 256.00 | time: 27.028 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2837/  5000| tot_loss: 2.6646 | rl_loss: 0.6594 | pt_loss: 2.0052 | pg_loss: -0.0078 | reg_loss: 0.6672 | reward: -0.1331 | rev_kl: 1.9089 | stu_lens: 91.5000 | mixed_lens: 128.0000 | lr: 2.0536e-06 | scale: 256.00 | time: 27.023 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2838/  5000| tot_loss: 1.9171 | rl_loss: 0.3012 | pt_loss: 1.6159 | pg_loss: 0.2210 | reg_loss: 0.0802 | reward: -0.8355 | rev_kl: 0.2965 | stu_lens: 22.0000 | mixed_lens: 22.5000 | lr: 2.0520e-06 | scale: 256.00 | time: 27.050 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2839/  5000| tot_loss: 2.5277 | rl_loss: 0.7419 | pt_loss: 1.7858 | pg_loss: 0.2774 | reg_loss: 0.4645 | reward: 0.5582 | rev_kl: 0.4251 | stu_lens: 65.5000 | mixed_lens: 66.0000 | lr: 2.0505e-06 | scale: 256.00 | time: 27.039 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2840/  5000| tot_loss: 2.2263 | rl_loss: 0.7720 | pt_loss: 1.4543 | pg_loss: 0.3074 | reg_loss: 0.4646 | reward: -0.1817 | rev_kl: 0.6473 | stu_lens: 112.5000 | mixed_lens: 92.5000 | lr: 2.0489e-06 | scale: 256.00 | time: 27.076 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2841/  5000| tot_loss: 2.8263 | rl_loss: 0.9905 | pt_loss: 1.8357 | pg_loss: 0.2061 | reg_loss: 0.7844 | reward: -0.3419 | rev_kl: 0.5336 | stu_lens: 126.5000 | mixed_lens: 89.5000 | lr: 2.0473e-06 | scale: 256.00 | time: 27.095 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2842/  5000| tot_loss: 2.9278 | rl_loss: 1.2601 | pt_loss: 1.6677 | pg_loss: 0.4678 | reg_loss: 0.7923 | reward: -0.2140 | rev_kl: 0.4487 | stu_lens: 73.0000 | mixed_lens: 63.5000 | lr: 2.0457e-06 | scale: 256.00 | time: 27.032 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2843/  5000| tot_loss: 2.1768 | rl_loss: 0.5997 | pt_loss: 1.5771 | pg_loss: 0.0204 | reg_loss: 0.5793 | reward: -0.0105 | rev_kl: 0.7098 | stu_lens: 128.0000 | mixed_lens: 124.0000 | lr: 2.0441e-06 | scale: 256.00 | time: 27.023 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2844/  5000| tot_loss: 2.9762 | rl_loss: 0.8052 | pt_loss: 2.1709 | pg_loss: 0.2470 | reg_loss: 0.5582 | reward: -0.2796 | rev_kl: 1.2179 | stu_lens: 79.0000 | mixed_lens: 99.5000 | lr: 2.0426e-06 | scale: 256.00 | time: 27.046 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2845/  5000| tot_loss: 2.2653 | rl_loss: 0.5456 | pt_loss: 1.7197 | pg_loss: 0.0090 | reg_loss: 0.5366 | reward: -0.2219 | rev_kl: 0.8571 | stu_lens: 126.5000 | mixed_lens: 128.0000 | lr: 2.0410e-06 | scale: 256.00 | time: 27.002 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2846/  5000| tot_loss: 2.6002 | rl_loss: 0.9605 | pt_loss: 1.6397 | pg_loss: 0.2916 | reg_loss: 0.6688 | reward: 0.1316 | rev_kl: 0.4360 | stu_lens: 21.5000 | mixed_lens: 42.5000 | lr: 2.0394e-06 | scale: 256.00 | time: 27.028 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2847/  5000| tot_loss: 2.6450 | rl_loss: 1.1853 | pt_loss: 1.4598 | pg_loss: 0.4172 | reg_loss: 0.7681 | reward: -0.0383 | rev_kl: 0.8149 | stu_lens: 80.5000 | mixed_lens: 75.5000 | lr: 2.0378e-06 | scale: 256.00 | time: 27.017 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2848/  5000| tot_loss: 2.6971 | rl_loss: 0.5962 | pt_loss: 2.1009 | pg_loss: 0.2595 | reg_loss: 0.3367 | reward: -0.2062 | rev_kl: 0.5785 | stu_lens: 19.5000 | mixed_lens: 64.0000 | lr: 2.0363e-06 | scale: 256.00 | time: 27.038 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2848/  5000| tot_loss: 2.5290 | rl_loss: 0.8177 | pt_loss: 1.7113 | pg_loss: 0.2026 | reg_loss: 0.6151 | reward: -0.1911 | rev_kl: 0.7150 | stu_lens: 88.8125 | mixed_lens: 92.6250 | lr: 2.0363e-06 | scale: 256.00 | time: 27.038 | step time: 28.268
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2849/  5000| tot_loss: 2.3966 | rl_loss: 0.3512 | pt_loss: 2.0454 | pg_loss: 0.2421 | reg_loss: 0.1091 | reward: -0.1243 | rev_kl: 1.0693 | stu_lens: 29.5000 | mixed_lens: 36.5000 | lr: 2.0347e-06 | scale: 256.00 | time: 27.038 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2850/  5000| tot_loss: 2.5083 | rl_loss: 0.6958 | pt_loss: 1.8125 | pg_loss: 0.2398 | reg_loss: 0.4559 | reward: -0.2448 | rev_kl: 0.5827 | stu_lens: 73.0000 | mixed_lens: 94.0000 | lr: 2.0331e-06 | scale: 256.00 | time: 27.069 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2851/  5000| tot_loss: 2.5015 | rl_loss: 0.9426 | pt_loss: 1.5590 | pg_loss: 0.3065 | reg_loss: 0.6361 | reward: -0.4090 | rev_kl: 0.8097 | stu_lens: 82.0000 | mixed_lens: 87.5000 | lr: 2.0315e-06 | scale: 256.00 | time: 27.064 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2852/  5000| tot_loss: 1.7715 | rl_loss: 0.4443 | pt_loss: 1.3272 | pg_loss: 0.1036 | reg_loss: 0.3407 | reward: -0.2592 | rev_kl: 0.9266 | stu_lens: 89.5000 | mixed_lens: 102.0000 | lr: 2.0300e-06 | scale: 256.00 | time: 27.073 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2853/  5000| tot_loss: 2.2250 | rl_loss: 0.7205 | pt_loss: 1.5045 | pg_loss: 0.4496 | reg_loss: 0.2708 | reward: -0.1723 | rev_kl: 0.2410 | stu_lens: 76.5000 | mixed_lens: 77.0000 | lr: 2.0284e-06 | scale: 256.00 | time: 27.041 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2854/  5000| tot_loss: 2.3570 | rl_loss: 0.6101 | pt_loss: 1.7469 | pg_loss: 0.1559 | reg_loss: 0.4542 | reward: -0.1971 | rev_kl: 0.4516 | stu_lens: 128.0000 | mixed_lens: 109.5000 | lr: 2.0268e-06 | scale: 256.00 | time: 27.047 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2855/  5000| tot_loss: 1.8581 | rl_loss: 0.4942 | pt_loss: 1.3639 | pg_loss: 0.1089 | reg_loss: 0.3854 | reward: -0.0432 | rev_kl: 0.7814 | stu_lens: 76.5000 | mixed_lens: 94.5000 | lr: 2.0253e-06 | scale: 256.00 | time: 27.007 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2856/  5000| tot_loss: 2.7493 | rl_loss: 0.6780 | pt_loss: 2.0713 | pg_loss: 0.2453 | reg_loss: 0.4327 | reward: -0.1724 | rev_kl: 0.7272 | stu_lens: 98.5000 | mixed_lens: 85.0000 | lr: 2.0237e-06 | scale: 256.00 | time: 27.026 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2857/  5000| tot_loss: 1.9411 | rl_loss: 0.0750 | pt_loss: 1.8661 | pg_loss: 0.0631 | reg_loss: 0.0119 | reward: -0.0268 | rev_kl: 0.0045 | stu_lens: 35.0000 | mixed_lens: 35.0000 | lr: 2.0221e-06 | scale: 256.00 | time: 27.012 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2858/  5000| tot_loss: 2.0323 | rl_loss: 0.4577 | pt_loss: 1.5746 | pg_loss: 0.1491 | reg_loss: 0.3086 | reward: -0.9374 | rev_kl: 0.6776 | stu_lens: 73.5000 | mixed_lens: 73.5000 | lr: 2.0205e-06 | scale: 256.00 | time: 27.045 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2859/  5000| tot_loss: 2.7685 | rl_loss: 1.0367 | pt_loss: 1.7318 | pg_loss: 0.3763 | reg_loss: 0.6605 | reward: -0.0383 | rev_kl: 0.9099 | stu_lens: 50.0000 | mixed_lens: 75.5000 | lr: 2.0190e-06 | scale: 256.00 | time: 27.033 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2860/  5000| tot_loss: 0.7694 | rl_loss: -0.6738 | pt_loss: 1.4432 | pg_loss: -0.7181 | reg_loss: 0.0443 | reward: 0.1942 | rev_kl: 0.1493 | stu_lens: 17.5000 | mixed_lens: 17.5000 | lr: 2.0174e-06 | scale: 256.00 | time: 27.064 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2861/  5000| tot_loss: 2.4749 | rl_loss: 0.7809 | pt_loss: 1.6941 | pg_loss: 0.4120 | reg_loss: 0.3689 | reward: -0.1049 | rev_kl: 0.6252 | stu_lens: 93.0000 | mixed_lens: 85.0000 | lr: 2.0158e-06 | scale: 256.00 | time: 27.054 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2862/  5000| tot_loss: 2.3468 | rl_loss: 0.7082 | pt_loss: 1.6387 | pg_loss: 0.1200 | reg_loss: 0.5881 | reward: -0.1525 | rev_kl: 0.8924 | stu_lens: 103.0000 | mixed_lens: 107.5000 | lr: 2.0142e-06 | scale: 256.00 | time: 27.093 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2863/  5000| tot_loss: 2.1622 | rl_loss: 0.6032 | pt_loss: 1.5590 | pg_loss: 0.1454 | reg_loss: 0.4578 | reward: -0.1037 | rev_kl: 0.9912 | stu_lens: 112.5000 | mixed_lens: 80.5000 | lr: 2.0127e-06 | scale: 256.00 | time: 27.040 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2864/  5000| tot_loss: 2.3465 | rl_loss: 0.3561 | pt_loss: 1.9904 | pg_loss: 0.2446 | reg_loss: 0.1115 | reward: 0.6292 | rev_kl: 0.0690 | stu_lens: 30.5000 | mixed_lens: 31.5000 | lr: 2.0111e-06 | scale: 256.00 | time: 27.042 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2864/  5000| tot_loss: 2.3394 | rl_loss: 0.6154 | pt_loss: 1.7240 | pg_loss: 0.1875 | reg_loss: 0.4279 | reward: -0.1854 | rev_kl: 0.6881 | stu_lens: 80.7344 | mixed_lens: 85.2969 | lr: 2.0111e-06 | scale: 256.00 | time: 27.042 | step time: 28.282
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2865/  5000| tot_loss: 2.2446 | rl_loss: 0.5356 | pt_loss: 1.7090 | pg_loss: -0.0100 | reg_loss: 0.5456 | reward: -0.1833 | rev_kl: 2.0947 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.0095e-06 | scale: 256.00 | time: 27.026 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2866/  5000| tot_loss: 2.0624 | rl_loss: 0.3513 | pt_loss: 1.7111 | pg_loss: 0.1715 | reg_loss: 0.1798 | reward: -0.0585 | rev_kl: 0.5853 | stu_lens: 45.5000 | mixed_lens: 90.5000 | lr: 2.0080e-06 | scale: 256.00 | time: 27.032 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2867/  5000| tot_loss: 2.4941 | rl_loss: 0.6651 | pt_loss: 1.8290 | pg_loss: 0.1309 | reg_loss: 0.5342 | reward: -0.1975 | rev_kl: 0.9636 | stu_lens: 128.0000 | mixed_lens: 107.5000 | lr: 2.0064e-06 | scale: 256.00 | time: 27.014 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2868/  5000| tot_loss: 2.0537 | rl_loss: 0.3346 | pt_loss: 1.7191 | pg_loss: -0.0229 | reg_loss: 0.3576 | reward: -0.2104 | rev_kl: 1.8955 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.0048e-06 | scale: 256.00 | time: 27.040 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2869/  5000| tot_loss: 1.8642 | rl_loss: 0.7342 | pt_loss: 1.1300 | pg_loss: 0.2285 | reg_loss: 0.5057 | reward: -0.1804 | rev_kl: 0.7702 | stu_lens: 128.0000 | mixed_lens: 83.0000 | lr: 2.0032e-06 | scale: 256.00 | time: 27.026 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2870/  5000| tot_loss: 2.5324 | rl_loss: 0.7642 | pt_loss: 1.7683 | pg_loss: 0.2104 | reg_loss: 0.5538 | reward: -0.2461 | rev_kl: 0.9156 | stu_lens: 79.0000 | mixed_lens: 98.5000 | lr: 2.0017e-06 | scale: 256.00 | time: 27.052 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2871/  5000| tot_loss: 2.3779 | rl_loss: 0.5868 | pt_loss: 1.7911 | pg_loss: 0.2221 | reg_loss: 0.3648 | reward: -0.1976 | rev_kl: 0.7515 | stu_lens: 128.0000 | mixed_lens: 97.5000 | lr: 2.0001e-06 | scale: 256.00 | time: 27.047 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2872/  5000| tot_loss: 1.7969 | rl_loss: 0.3183 | pt_loss: 1.4787 | pg_loss: 0.0395 | reg_loss: 0.2788 | reward: -0.1232 | rev_kl: 0.3310 | stu_lens: 103.5000 | mixed_lens: 109.5000 | lr: 1.9985e-06 | scale: 256.00 | time: 27.077 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2873/  5000| tot_loss: 1.7244 | rl_loss: 0.3074 | pt_loss: 1.4169 | pg_loss: 0.0955 | reg_loss: 0.2120 | reward: -0.0922 | rev_kl: 0.6753 | stu_lens: 112.5000 | mixed_lens: 92.5000 | lr: 1.9970e-06 | scale: 256.00 | time: 27.096 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2874/  5000| tot_loss: 2.5272 | rl_loss: 0.8409 | pt_loss: 1.6863 | pg_loss: 0.5317 | reg_loss: 0.3092 | reward: -0.1160 | rev_kl: 0.3277 | stu_lens: 74.0000 | mixed_lens: 57.5000 | lr: 1.9954e-06 | scale: 256.00 | time: 27.034 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2875/  5000| tot_loss: 3.1105 | rl_loss: 1.2917 | pt_loss: 1.8187 | pg_loss: 0.5614 | reg_loss: 0.7303 | reward: -0.4856 | rev_kl: 0.6293 | stu_lens: 38.5000 | mixed_lens: 43.5000 | lr: 1.9938e-06 | scale: 256.00 | time: 27.023 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2876/  5000| tot_loss: 2.7595 | rl_loss: 0.4509 | pt_loss: 2.3086 | pg_loss: -0.0097 | reg_loss: 0.4607 | reward: -0.0718 | rev_kl: 0.5833 | stu_lens: 91.5000 | mixed_lens: 128.0000 | lr: 1.9922e-06 | scale: 256.00 | time: 27.028 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2877/  5000| tot_loss: 2.4035 | rl_loss: 0.6078 | pt_loss: 1.7957 | pg_loss: 0.2076 | reg_loss: 0.4003 | reward: -0.4151 | rev_kl: 0.5079 | stu_lens: 70.5000 | mixed_lens: 82.5000 | lr: 1.9907e-06 | scale: 256.00 | time: 27.002 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2878/  5000| tot_loss: 2.2820 | rl_loss: 0.7106 | pt_loss: 1.5714 | pg_loss: 0.4309 | reg_loss: 0.2797 | reward: -0.0647 | rev_kl: 0.5551 | stu_lens: 62.5000 | mixed_lens: 70.5000 | lr: 1.9891e-06 | scale: 256.00 | time: 27.027 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2879/  5000| tot_loss: 2.8194 | rl_loss: 0.6909 | pt_loss: 2.1285 | pg_loss: 0.4433 | reg_loss: 0.2476 | reward: -0.0096 | rev_kl: 0.5867 | stu_lens: 80.5000 | mixed_lens: 75.5000 | lr: 1.9875e-06 | scale: 256.00 | time: 27.014 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2880/  5000| tot_loss: 2.0816 | rl_loss: 0.5102 | pt_loss: 1.5715 | pg_loss: 0.2023 | reg_loss: 0.3078 | reward: -0.1229 | rev_kl: 0.8236 | stu_lens: 54.5000 | mixed_lens: 90.0000 | lr: 1.9860e-06 | scale: 256.00 | time: 27.047 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2880/  5000| tot_loss: 2.2988 | rl_loss: 0.5942 | pt_loss: 1.7047 | pg_loss: 0.2294 | reg_loss: 0.3648 | reward: -0.1862 | rev_kl: 0.7769 | stu_lens: 88.7969 | mixed_lens: 90.5156 | lr: 1.9860e-06 | scale: 256.00 | time: 27.047 | step time: 28.272
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2881/  5000| tot_loss: 3.4111 | rl_loss: 1.7224 | pt_loss: 1.6888 | pg_loss: 1.6236 | reg_loss: 0.0987 | reward: -0.2808 | rev_kl: 0.2264 | stu_lens: 13.5000 | mixed_lens: 31.5000 | lr: 1.9844e-06 | scale: 256.00 | time: 27.039 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2882/  5000| tot_loss: 2.6654 | rl_loss: 1.0429 | pt_loss: 1.6225 | pg_loss: 0.4062 | reg_loss: 0.6367 | reward: -0.2388 | rev_kl: 0.5503 | stu_lens: 120.5000 | mixed_lens: 86.0000 | lr: 1.9828e-06 | scale: 256.00 | time: 27.044 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2883/  5000| tot_loss: 3.5602 | rl_loss: 2.0908 | pt_loss: 1.4694 | pg_loss: 1.2204 | reg_loss: 0.8704 | reward: -0.7966 | rev_kl: 0.7669 | stu_lens: 69.0000 | mixed_lens: 15.0000 | lr: 1.9813e-06 | scale: 256.00 | time: 27.026 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2884/  5000| tot_loss: 2.7116 | rl_loss: 0.8639 | pt_loss: 1.8478 | pg_loss: 0.1960 | reg_loss: 0.6678 | reward: -0.2095 | rev_kl: 1.6058 | stu_lens: 128.0000 | mixed_lens: 91.5000 | lr: 1.9797e-06 | scale: 256.00 | time: 27.040 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2885/  5000| tot_loss: 3.6751 | rl_loss: 1.5993 | pt_loss: 2.0759 | pg_loss: 0.2932 | reg_loss: 1.3061 | reward: -0.1678 | rev_kl: 0.6340 | stu_lens: 105.0000 | mixed_lens: 96.0000 | lr: 1.9781e-06 | scale: 256.00 | time: 27.027 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2886/  5000| tot_loss: 2.5467 | rl_loss: 0.9301 | pt_loss: 1.6167 | pg_loss: 0.0543 | reg_loss: 0.8758 | reward: -0.1823 | rev_kl: 0.7137 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.9766e-06 | scale: 256.00 | time: 27.057 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2887/  5000| tot_loss: 2.6259 | rl_loss: 0.9680 | pt_loss: 1.6579 | pg_loss: 0.0576 | reg_loss: 0.9104 | reward: -0.1818 | rev_kl: 0.8938 | stu_lens: 110.0000 | mixed_lens: 128.0000 | lr: 1.9750e-06 | scale: 256.00 | time: 27.049 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2888/  5000| tot_loss: 0.9201 | rl_loss: -0.5468 | pt_loss: 1.4669 | pg_loss: -1.0302 | reg_loss: 0.4834 | reward: -0.0461 | rev_kl: 0.2229 | stu_lens: 11.0000 | mixed_lens: 10.5000 | lr: 1.9734e-06 | scale: 256.00 | time: 27.089 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2889/  5000| tot_loss: 2.7659 | rl_loss: 1.1483 | pt_loss: 1.6176 | pg_loss: 0.1840 | reg_loss: 0.9643 | reward: -0.2165 | rev_kl: 0.7744 | stu_lens: 74.5000 | mixed_lens: 105.5000 | lr: 1.9719e-06 | scale: 256.00 | time: 27.032 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2890/  5000| tot_loss: 2.8522 | rl_loss: 1.3014 | pt_loss: 1.5509 | pg_loss: 0.3999 | reg_loss: 0.9015 | reward: -0.1778 | rev_kl: 0.3299 | stu_lens: 69.0000 | mixed_lens: 69.0000 | lr: 1.9703e-06 | scale: 256.00 | time: 27.037 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2891/  5000| tot_loss: 2.5311 | rl_loss: 1.0861 | pt_loss: 1.4451 | pg_loss: 0.1108 | reg_loss: 0.9752 | reward: -0.0733 | rev_kl: 0.5732 | stu_lens: 96.5000 | mixed_lens: 114.5000 | lr: 1.9687e-06 | scale: 256.00 | time: 27.015 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2892/  5000| tot_loss: 3.1162 | rl_loss: 1.0152 | pt_loss: 2.1011 | pg_loss: 0.0561 | reg_loss: 0.9590 | reward: -0.1816 | rev_kl: 0.6996 | stu_lens: 91.0000 | mixed_lens: 124.0000 | lr: 1.9672e-06 | scale: 256.00 | time: 27.043 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2893/  5000| tot_loss: 3.2428 | rl_loss: 1.3523 | pt_loss: 1.8905 | pg_loss: 0.2296 | reg_loss: 1.1226 | reward: -0.1311 | rev_kl: 0.8654 | stu_lens: 128.0000 | mixed_lens: 80.5000 | lr: 1.9656e-06 | scale: 256.00 | time: 27.036 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2894/  5000| tot_loss: 2.9245 | rl_loss: 1.1024 | pt_loss: 1.8221 | pg_loss: 0.1692 | reg_loss: 0.9333 | reward: -0.2536 | rev_kl: 0.8373 | stu_lens: 81.5000 | mixed_lens: 117.5000 | lr: 1.9640e-06 | scale: 256.00 | time: 27.027 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2895/  5000| tot_loss: 2.5070 | rl_loss: 0.8014 | pt_loss: 1.7056 | pg_loss: 0.1348 | reg_loss: 0.6666 | reward: -0.3542 | rev_kl: 0.5173 | stu_lens: 128.0000 | mixed_lens: 87.5000 | lr: 1.9625e-06 | scale: 256.00 | time: 27.014 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2896/  5000| tot_loss: 2.6177 | rl_loss: 0.9882 | pt_loss: 1.6295 | pg_loss: 0.1962 | reg_loss: 0.7920 | reward: -0.1247 | rev_kl: 1.1619 | stu_lens: 92.5000 | mixed_lens: 116.0000 | lr: 1.9609e-06 | scale: 256.00 | time: 27.044 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2896/  5000| tot_loss: 2.7518 | rl_loss: 1.0937 | pt_loss: 1.6581 | pg_loss: 0.2352 | reg_loss: 0.8585 | reward: -0.2264 | rev_kl: 0.7496 | stu_lens: 92.3438 | mixed_lens: 92.9062 | lr: 1.9609e-06 | scale: 256.00 | time: 27.044 | step time: 28.271
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2897/  5000| tot_loss: 2.7255 | rl_loss: 0.8110 | pt_loss: 1.9145 | pg_loss: 0.2480 | reg_loss: 0.5630 | reward: -0.3118 | rev_kl: 0.3444 | stu_lens: 38.5000 | mixed_lens: 62.5000 | lr: 1.9593e-06 | scale: 256.00 | time: 27.030 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2898/  5000| tot_loss: 2.1167 | rl_loss: 0.9665 | pt_loss: 1.1501 | pg_loss: 0.3088 | reg_loss: 0.6578 | reward: -0.1104 | rev_kl: 0.3212 | stu_lens: 69.0000 | mixed_lens: 69.0000 | lr: 1.9578e-06 | scale: 256.00 | time: 27.061 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2899/  5000| tot_loss: 3.2542 | rl_loss: 1.4478 | pt_loss: 1.8064 | pg_loss: 0.5220 | reg_loss: 0.9258 | reward: -0.2330 | rev_kl: 0.4250 | stu_lens: 38.0000 | mixed_lens: 63.5000 | lr: 1.9562e-06 | scale: 256.00 | time: 27.055 | step time: 0.000
                                 Evaluation #29                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son partículas            │
│                                       │ elementales que se originan de la    │
│                                       │ fuerza nuclear fuerte. Los cuarks    │
│                                       │ son los elementos con las más        │
│                                       │ grandes masas de los quarks, entre   │
│                                       │ los que se encuentran:               │
│                                       │                                      │
│                                       │ - El cuark túrgido, también conocido │
│                                       │ como quark up, que tiene carga       │
│                                       │ electromagnética positiva,           │
│                                       │ - El cuark débil, también llamado    │
│                                       │ quark down, que tiene carga          │
│                                       │ electromagnética negativa,           │
│                                       │ - El cuark s o cetillo, que no tiene │
│                                       │ carga electromagnética,              │
│                                       │                                      │
│                                       │ Además del cuark, otra               │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC, o Intermediate Mixing        │
│                                       │ Chamber, es una estructura de        │
│                                       │ almacenamiento de leche que se       │
│                                       │ emplea para que la leche materna se  │
│                                       │ mixture durante el parto. La leche   │
│                                       │ materna está compuesta por dos       │
│                                       │ componentes: la leche es decir, el   │
│                                       │ fluido que se encuentra en la        │
│                                       │ mameta, y el secreto de leche, el    │
│                                       │ cual se encuentra en los conductos   │
│                                       │ conectados a la mameta. El IMC está  │
│                                       │ diseñado para separar este flujo de  │
│                                       │ secreto de leche de la leche, y      │
│                                       │ mezclarlos de manera                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Cápsula del tiempo de Dick Tracy:    │
│                                       │ 1933, contenido: paladio, fecha de   │
│                                       │ apertura: 1933                       │
│                                       │ Cápsula del tiempo del gorila: 1937, │
│                                       │ contenido: velocidad infinita, fecha │
│                                       │ de apertura: 1937                    │
│                                       │ Cápsula del tiempo de HG Wells:      │
│                                       │ 1895, contenido: pólipos, fecha de   │
│                                       │ apertura: 1895                       │
│                                       │ Cápsula del tiempo de Philo          │
│                                       │ Farnsworth: 1939                     │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.301 | exact_match: 0.104 | rev_kl: 0.798 | lens: 100.969 | pt_loss: 1.729 | lm_loss: 1.859 | kd_loss: 1.599 
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2900/  5000| tot_loss: 2.3800 | rl_loss: 0.7840 | pt_loss: 1.5960 | pg_loss: 0.1037 | reg_loss: 0.6802 | reward: -0.2926 | rev_kl: 0.6153 | stu_lens: 91.0000 | mixed_lens: 98.5000 | lr: 1.9546e-06 | scale: 256.00 | time: 27.091 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2901/  5000| tot_loss: 2.6981 | rl_loss: 0.6255 | pt_loss: 2.0726 | pg_loss: -0.0149 | reg_loss: 0.6404 | reward: -0.1390 | rev_kl: 0.9547 | stu_lens: 118.0000 | mixed_lens: 128.0000 | lr: 1.9531e-06 | scale: 256.00 | time: 27.090 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2902/  5000| tot_loss: 1.7229 | rl_loss: 0.5831 | pt_loss: 1.1398 | pg_loss: 0.1523 | reg_loss: 0.4308 | reward: -0.2388 | rev_kl: 1.6297 | stu_lens: 88.5000 | mixed_lens: 81.5000 | lr: 1.9515e-06 | scale: 256.00 | time: 27.006 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2903/  5000| tot_loss: 2.3766 | rl_loss: 0.5200 | pt_loss: 1.8566 | pg_loss: 0.0821 | reg_loss: 0.4380 | reward: -0.2933 | rev_kl: 0.5580 | stu_lens: 128.0000 | mixed_lens: 87.5000 | lr: 1.9500e-06 | scale: 256.00 | time: 27.027 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2904/  5000| tot_loss: 2.4834 | rl_loss: 0.6952 | pt_loss: 1.7882 | pg_loss: 0.0816 | reg_loss: 0.6136 | reward: -0.1636 | rev_kl: 0.5323 | stu_lens: 85.0000 | mixed_lens: 114.5000 | lr: 1.9484e-06 | scale: 256.00 | time: 27.014 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2905/  5000| tot_loss: 2.6556 | rl_loss: 0.8751 | pt_loss: 1.7805 | pg_loss: 0.0238 | reg_loss: 0.8513 | reward: -0.1155 | rev_kl: 0.9450 | stu_lens: 111.0000 | mixed_lens: 118.5000 | lr: 1.9468e-06 | scale: 256.00 | time: 27.038 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2906/  5000| tot_loss: 2.3092 | rl_loss: 0.2938 | pt_loss: 2.0154 | pg_loss: -0.1242 | reg_loss: 0.4180 | reward: -0.5767 | rev_kl: 0.6869 | stu_lens: 82.0000 | mixed_lens: 55.5000 | lr: 1.9453e-06 | scale: 256.00 | time: 27.025 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2907/  5000| tot_loss: 3.1555 | rl_loss: 1.4277 | pt_loss: 1.7278 | pg_loss: 0.6861 | reg_loss: 0.7416 | reward: -0.3720 | rev_kl: 0.5523 | stu_lens: 97.5000 | mixed_lens: 54.0000 | lr: 1.9437e-06 | scale: 256.00 | time: 27.046 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2908/  5000| tot_loss: 1.9824 | rl_loss: 0.6204 | pt_loss: 1.3620 | pg_loss: 0.1159 | reg_loss: 0.5045 | reward: -0.3215 | rev_kl: 0.6795 | stu_lens: 119.5000 | mixed_lens: 99.0000 | lr: 1.9421e-06 | scale: 256.00 | time: 27.068 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2909/  5000| tot_loss: 2.7696 | rl_loss: 1.1107 | pt_loss: 1.6589 | pg_loss: 0.1077 | reg_loss: 1.0030 | reward: -0.1010 | rev_kl: 1.0518 | stu_lens: 75.0000 | mixed_lens: 110.0000 | lr: 1.9406e-06 | scale: 256.00 | time: 27.094 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2910/  5000| tot_loss: 2.2545 | rl_loss: 0.5630 | pt_loss: 1.6915 | pg_loss: -0.0055 | reg_loss: 0.5684 | reward: -0.1940 | rev_kl: 0.9540 | stu_lens: 110.0000 | mixed_lens: 128.0000 | lr: 1.9390e-06 | scale: 256.00 | time: 27.033 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2911/  5000| tot_loss: 2.4356 | rl_loss: 1.0655 | pt_loss: 1.3701 | pg_loss: 0.3432 | reg_loss: 0.7223 | reward: 0.0505 | rev_kl: 0.7231 | stu_lens: 51.0000 | mixed_lens: 69.0000 | lr: 1.9374e-06 | scale: 256.00 | time: 27.041 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2912/  5000| tot_loss: 2.4061 | rl_loss: 0.5775 | pt_loss: 1.8286 | pg_loss: 0.0936 | reg_loss: 0.4839 | reward: -0.0178 | rev_kl: 0.6395 | stu_lens: 118.5000 | mixed_lens: 97.5000 | lr: 1.9359e-06 | scale: 256.00 | time: 27.028 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2912/  5000| tot_loss: 2.7169 | rl_loss: 0.9092 | pt_loss: 1.8077 | pg_loss: 0.2187 | reg_loss: 0.6905 | reward: -0.2371 | rev_kl: 0.7190 | stu_lens: 92.5469 | mixed_lens: 92.2969 | lr: 1.9359e-06 | scale: 256.00 | time: 27.028 | step time: 28.283
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2913/  5000| tot_loss: 2.2887 | rl_loss: 0.3964 | pt_loss: 1.8923 | pg_loss: 0.0287 | reg_loss: 0.3676 | reward: -0.0546 | rev_kl: 1.5321 | stu_lens: 128.0000 | mixed_lens: 126.0000 | lr: 1.9343e-06 | scale: 256.00 | time: 27.033 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2914/  5000| tot_loss: 2.0578 | rl_loss: 0.3682 | pt_loss: 1.6896 | pg_loss: -0.0064 | reg_loss: 0.3745 | reward: -0.1676 | rev_kl: 0.7587 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.9328e-06 | scale: 256.00 | time: 27.007 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2915/  5000| tot_loss: 2.3286 | rl_loss: 0.3918 | pt_loss: 1.9368 | pg_loss: -0.0103 | reg_loss: 0.4021 | reward: -0.1393 | rev_kl: 0.7054 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.9312e-06 | scale: 256.00 | time: 27.035 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2916/  5000| tot_loss: 2.3343 | rl_loss: 0.6174 | pt_loss: 1.7168 | pg_loss: 0.0350 | reg_loss: 0.5824 | reward: -0.1103 | rev_kl: 1.0071 | stu_lens: 128.0000 | mixed_lens: 120.0000 | lr: 1.9296e-06 | scale: 256.00 | time: 27.012 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2917/  5000| tot_loss: 2.4727 | rl_loss: 0.6696 | pt_loss: 1.8032 | pg_loss: 0.2033 | reg_loss: 0.4663 | reward: -0.5733 | rev_kl: 0.5618 | stu_lens: 128.0000 | mixed_lens: 73.0000 | lr: 1.9281e-06 | scale: 256.00 | time: 27.052 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2918/  5000| tot_loss: 2.5224 | rl_loss: 1.0044 | pt_loss: 1.5180 | pg_loss: 0.6070 | reg_loss: 0.3974 | reward: -0.3544 | rev_kl: 0.7695 | stu_lens: 61.0000 | mixed_lens: 72.5000 | lr: 1.9265e-06 | scale: 256.00 | time: 27.042 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2919/  5000| tot_loss: 2.8614 | rl_loss: 1.2999 | pt_loss: 1.5614 | pg_loss: 0.7822 | reg_loss: 0.5177 | reward: -0.0719 | rev_kl: 0.4257 | stu_lens: 26.0000 | mixed_lens: 22.0000 | lr: 1.9250e-06 | scale: 256.00 | time: 27.098 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2920/  5000| tot_loss: 2.4343 | rl_loss: 0.5779 | pt_loss: 1.8564 | pg_loss: 0.2550 | reg_loss: 0.3229 | reward: -0.3927 | rev_kl: 0.7024 | stu_lens: 112.0000 | mixed_lens: 57.0000 | lr: 1.9234e-06 | scale: 256.00 | time: 27.075 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2921/  5000| tot_loss: 1.7710 | rl_loss: 0.5435 | pt_loss: 1.2275 | pg_loss: 0.1219 | reg_loss: 0.4215 | reward: -0.2592 | rev_kl: 0.3957 | stu_lens: 105.0000 | mixed_lens: 96.0000 | lr: 1.9218e-06 | scale: 256.00 | time: 27.048 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2922/  5000| tot_loss: 2.6198 | rl_loss: 0.8903 | pt_loss: 1.7295 | pg_loss: 0.2912 | reg_loss: 0.5990 | reward: -0.1575 | rev_kl: 0.6067 | stu_lens: 70.5000 | mixed_lens: 80.5000 | lr: 1.9203e-06 | scale: 256.00 | time: 27.026 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2923/  5000| tot_loss: 2.1475 | rl_loss: 0.4230 | pt_loss: 1.7245 | pg_loss: -0.0251 | reg_loss: 0.4481 | reward: -0.2431 | rev_kl: 0.9380 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.9187e-06 | scale: 256.00 | time: 27.058 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2924/  5000| tot_loss: 2.2080 | rl_loss: 0.4056 | pt_loss: 1.8024 | pg_loss: -0.0226 | reg_loss: 0.4282 | reward: -0.0771 | rev_kl: 0.8587 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.9172e-06 | scale: 256.00 | time: 27.018 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2925/  5000| tot_loss: 2.0686 | rl_loss: 0.4797 | pt_loss: 1.5889 | pg_loss: 0.2429 | reg_loss: 0.2368 | reward: -0.2056 | rev_kl: 0.5824 | stu_lens: 128.0000 | mixed_lens: 96.5000 | lr: 1.9156e-06 | scale: 256.00 | time: 27.043 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2926/  5000| tot_loss: 1.6221 | rl_loss: 0.5735 | pt_loss: 1.0487 | pg_loss: 0.1863 | reg_loss: 0.3872 | reward: -0.1623 | rev_kl: 1.8589 | stu_lens: 88.5000 | mixed_lens: 75.0000 | lr: 1.9140e-06 | scale: 256.00 | time: 27.024 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2927/  5000| tot_loss: 2.7273 | rl_loss: 0.7514 | pt_loss: 1.9759 | pg_loss: 0.1399 | reg_loss: 0.6116 | reward: -0.2379 | rev_kl: 0.7174 | stu_lens: 128.0000 | mixed_lens: 105.5000 | lr: 1.9125e-06 | scale: 256.00 | time: 27.052 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2928/  5000| tot_loss: 2.2939 | rl_loss: 0.4462 | pt_loss: 1.8477 | pg_loss: 0.0500 | reg_loss: 0.3962 | reward: -0.0527 | rev_kl: 0.7074 | stu_lens: 114.5000 | mixed_lens: 128.0000 | lr: 1.9109e-06 | scale: 256.00 | time: 27.041 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2928/  5000| tot_loss: 2.3990 | rl_loss: 0.6921 | pt_loss: 1.7069 | pg_loss: 0.2074 | reg_loss: 0.4847 | reward: -0.2184 | rev_kl: 0.7843 | stu_lens: 95.1094 | mixed_lens: 95.1406 | lr: 1.9109e-06 | scale: 256.00 | time: 27.041 | step time: 28.277
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2929/  5000| tot_loss: 3.5624 | rl_loss: 1.3120 | pt_loss: 2.2503 | pg_loss: 0.5722 | reg_loss: 0.7398 | reward: -0.2258 | rev_kl: 0.5720 | stu_lens: 30.0000 | mixed_lens: 51.5000 | lr: 1.9094e-06 | scale: 256.00 | time: 27.075 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2930/  5000| tot_loss: 2.6754 | rl_loss: 0.9210 | pt_loss: 1.7544 | pg_loss: 0.4717 | reg_loss: 0.4493 | reward: -0.5704 | rev_kl: 0.6398 | stu_lens: 128.0000 | mixed_lens: 69.0000 | lr: 1.9078e-06 | scale: 256.00 | time: 27.062 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2931/  5000| tot_loss: 3.0400 | rl_loss: 0.9520 | pt_loss: 2.0879 | pg_loss: 0.5816 | reg_loss: 0.3705 | reward: -0.1991 | rev_kl: 0.4832 | stu_lens: 46.5000 | mixed_lens: 41.5000 | lr: 1.9063e-06 | scale: 256.00 | time: 27.099 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2932/  5000| tot_loss: 2.0579 | rl_loss: 0.2800 | pt_loss: 1.7779 | pg_loss: 0.0441 | reg_loss: 0.2359 | reward: -0.0494 | rev_kl: 0.8540 | stu_lens: 128.0000 | mixed_lens: 121.5000 | lr: 1.9047e-06 | scale: 256.00 | time: 27.041 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2933/  5000| tot_loss: 2.3956 | rl_loss: 0.4180 | pt_loss: 1.9776 | pg_loss: -0.0165 | reg_loss: 0.4345 | reward: -0.2422 | rev_kl: 1.0459 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.9031e-06 | scale: 256.00 | time: 27.049 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2934/  5000| tot_loss: 1.7028 | rl_loss: 0.5195 | pt_loss: 1.1832 | pg_loss: 0.0819 | reg_loss: 0.4377 | reward: -0.2536 | rev_kl: 0.8373 | stu_lens: 81.5000 | mixed_lens: 117.5000 | lr: 1.9016e-06 | scale: 256.00 | time: 27.037 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2935/  5000| tot_loss: 2.4373 | rl_loss: 0.5496 | pt_loss: 1.8877 | pg_loss: 0.2178 | reg_loss: 0.3318 | reward: -0.2200 | rev_kl: 0.6166 | stu_lens: 70.5000 | mixed_lens: 98.5000 | lr: 1.9000e-06 | scale: 256.00 | time: 27.034 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   2936/  5000| tot_loss: 2.0722 | rl_loss: 0.6196 | pt_loss: 1.4526 | pg_loss: 0.1332 | reg_loss: 0.4864 | reward: -0.1024 | rev_kl: 0.6426 | stu_lens: 74.0000 | mixed_lens: 98.0000 | lr: 1.8985e-06 | scale: 256.00 | time: 27.022 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   2937/  5000| tot_loss: 2.4298 | rl_loss: 0.8398 | pt_loss: 1.5900 | pg_loss: 0.3850 | reg_loss: 0.4548 | reward: -0.2158 | rev_kl: 1.9585 | stu_lens: 88.5000 | mixed_lens: 81.5000 | lr: 1.8969e-06 | scale: 256.00 | time: 27.042 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   2938/  5000| tot_loss: 1.7332 | rl_loss: 0.4832 | pt_loss: 1.2500 | pg_loss: 0.1275 | reg_loss: 0.3557 | reward: 0.0107 | rev_kl: 0.4376 | stu_lens: 87.0000 | mixed_lens: 84.0000 | lr: 1.8954e-06 | scale: 256.00 | time: 27.030 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   2939/  5000| tot_loss: 2.6864 | rl_loss: 0.7992 | pt_loss: 1.8872 | pg_loss: 0.2415 | reg_loss: 0.5577 | reward: -0.2019 | rev_kl: 0.6600 | stu_lens: 84.5000 | mixed_lens: 81.0000 | lr: 1.8938e-06 | scale: 256.00 | time: 27.060 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   2940/  5000| tot_loss: 2.6568 | rl_loss: 0.7159 | pt_loss: 1.9409 | pg_loss: 0.3800 | reg_loss: 0.3358 | reward: 0.0840 | rev_kl: 0.8112 | stu_lens: 59.5000 | mixed_lens: 69.0000 | lr: 1.8923e-06 | scale: 256.00 | time: 27.076 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   2941/  5000| tot_loss: 2.5618 | rl_loss: 0.8089 | pt_loss: 1.7529 | pg_loss: 0.4256 | reg_loss: 0.3833 | reward: -0.3880 | rev_kl: 0.6814 | stu_lens: 52.5000 | mixed_lens: 72.5000 | lr: 1.8907e-06 | scale: 256.00 | time: 27.093 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   2942/  5000| tot_loss: 2.3701 | rl_loss: 0.5134 | pt_loss: 1.8567 | pg_loss: 0.0723 | reg_loss: 0.4411 | reward: -0.2293 | rev_kl: 0.5523 | stu_lens: 65.0000 | mixed_lens: 100.0000 | lr: 1.8891e-06 | scale: 256.00 | time: 27.087 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   2943/  5000| tot_loss: 2.4027 | rl_loss: 0.9652 | pt_loss: 1.4375 | pg_loss: 0.7250 | reg_loss: 0.2402 | reward: -0.1286 | rev_kl: 0.3995 | stu_lens: 69.0000 | mixed_lens: 69.0000 | lr: 1.8876e-06 | scale: 256.00 | time: 27.051 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2944/  5000| tot_loss: 1.7547 | rl_loss: 0.5267 | pt_loss: 1.2280 | pg_loss: 0.1332 | reg_loss: 0.3935 | reward: -0.3872 | rev_kl: 0.3734 | stu_lens: 91.0000 | mixed_lens: 87.5000 | lr: 1.8860e-06 | scale: 256.00 | time: 27.040 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   2944/  5000| tot_loss: 2.3648 | rl_loss: 0.6339 | pt_loss: 1.7309 | pg_loss: 0.2396 | reg_loss: 0.3942 | reward: -0.2363 | rev_kl: 0.7298 | stu_lens: 92.0312 | mixed_lens: 92.0938 | lr: 1.8860e-06 | scale: 256.00 | time: 27.040 | step time: 28.292
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   2945/  5000| tot_loss: 2.1446 | rl_loss: 0.9006 | pt_loss: 1.2439 | pg_loss: 0.3896 | reg_loss: 0.5110 | reward: -0.2303 | rev_kl: 0.8859 | stu_lens: 105.5000 | mixed_lens: 70.0000 | lr: 1.8845e-06 | scale: 256.00 | time: 27.043 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   2946/  5000| tot_loss: 1.6132 | rl_loss: 0.6967 | pt_loss: 0.9165 | pg_loss: 0.0434 | reg_loss: 0.6534 | reward: -0.0967 | rev_kl: 0.7436 | stu_lens: 113.5000 | mixed_lens: 126.0000 | lr: 1.8829e-06 | scale: 256.00 | time: 27.071 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   2947/  5000| tot_loss: 2.7797 | rl_loss: 1.1684 | pt_loss: 1.6113 | pg_loss: 0.1987 | reg_loss: 0.9697 | reward: -0.1034 | rev_kl: 1.2283 | stu_lens: 102.0000 | mixed_lens: 106.5000 | lr: 1.8814e-06 | scale: 256.00 | time: 27.042 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   2948/  5000| tot_loss: 3.0509 | rl_loss: 1.0725 | pt_loss: 1.9785 | pg_loss: 0.0561 | reg_loss: 1.0164 | reward: -0.1208 | rev_kl: 0.8308 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.8798e-06 | scale: 256.00 | time: 27.077 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   2949/  5000| tot_loss: 2.1736 | rl_loss: 0.5888 | pt_loss: 1.5848 | pg_loss: 0.2403 | reg_loss: 0.3485 | reward: 0.0460 | rev_kl: 0.2500 | stu_lens: 75.5000 | mixed_lens: 75.5000 | lr: 1.8783e-06 | scale: 256.00 | time: 27.075 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   2950/  5000| tot_loss: 2.4913 | rl_loss: 0.9735 | pt_loss: 1.5178 | pg_loss: 0.0819 | reg_loss: 0.8916 | reward: -0.2368 | rev_kl: 0.9881 | stu_lens: 121.0000 | mixed_lens: 128.0000 | lr: 1.8767e-06 | scale: 256.00 | time: 27.122 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   2951/  5000| tot_loss: 2.6459 | rl_loss: 0.9548 | pt_loss: 1.6911 | pg_loss: 0.1968 | reg_loss: 0.7581 | reward: -0.4595 | rev_kl: 0.8131 | stu_lens: 85.0000 | mixed_lens: 88.0000 | lr: 1.8752e-06 | scale: 256.00 | time: 27.054 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   2952/  5000| tot_loss: 3.4406 | rl_loss: 1.6994 | pt_loss: 1.7411 | pg_loss: 0.7937 | reg_loss: 0.9058 | reward: -0.7487 | rev_kl: 0.8026 | stu_lens: 128.0000 | mixed_lens: 58.0000 | lr: 1.8736e-06 | scale: 256.00 | time: 27.055 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   2953/  5000| tot_loss: 2.4345 | rl_loss: 0.9915 | pt_loss: 1.4429 | pg_loss: 0.0850 | reg_loss: 0.9066 | reward: -0.2184 | rev_kl: 0.7459 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.8721e-06 | scale: 256.00 | time: 27.037 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   2954/  5000| tot_loss: 3.4371 | rl_loss: 1.8675 | pt_loss: 1.5696 | pg_loss: 0.8454 | reg_loss: 1.0221 | reward: -0.0793 | rev_kl: 0.4512 | stu_lens: 64.0000 | mixed_lens: 48.5000 | lr: 1.8705e-06 | scale: 256.00 | time: 27.039 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   2955/  5000| tot_loss: 4.2251 | rl_loss: 2.6472 | pt_loss: 1.5779 | pg_loss: 1.9993 | reg_loss: 0.6479 | reward: -0.2605 | rev_kl: 0.7186 | stu_lens: 66.0000 | mixed_lens: 21.0000 | lr: 1.8690e-06 | scale: 256.00 | time: 27.022 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   2956/  5000| tot_loss: 2.8984 | rl_loss: 1.2626 | pt_loss: 1.6358 | pg_loss: 1.1706 | reg_loss: 0.0920 | reward: -0.1819 | rev_kl: 0.0619 | stu_lens: 15.5000 | mixed_lens: 15.5000 | lr: 1.8674e-06 | scale: 256.00 | time: 27.041 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   2957/  5000| tot_loss: 2.6634 | rl_loss: 0.9823 | pt_loss: 1.6810 | pg_loss: 0.1449 | reg_loss: 0.8375 | reward: -0.1156 | rev_kl: 0.4475 | stu_lens: 80.0000 | mixed_lens: 111.0000 | lr: 1.8659e-06 | scale: 256.00 | time: 27.037 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   2958/  5000| tot_loss: 3.5292 | rl_loss: 1.8547 | pt_loss: 1.6745 | pg_loss: 1.0611 | reg_loss: 0.7936 | reward: -0.5490 | rev_kl: 0.4780 | stu_lens: 67.0000 | mixed_lens: 36.0000 | lr: 1.8643e-06 | scale: 256.00 | time: 27.066 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   2959/  5000| tot_loss: 2.0583 | rl_loss: 0.9907 | pt_loss: 1.0676 | pg_loss: 0.5359 | reg_loss: 0.4548 | reward: -0.1986 | rev_kl: 0.2877 | stu_lens: 67.0000 | mixed_lens: 64.0000 | lr: 1.8628e-06 | scale: 256.00 | time: 27.058 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2960/  5000| tot_loss: 2.1128 | rl_loss: 1.0391 | pt_loss: 1.0737 | pg_loss: 0.0280 | reg_loss: 1.0111 | reward: -0.2519 | rev_kl: 0.9009 | stu_lens: 115.5000 | mixed_lens: 128.0000 | lr: 1.8612e-06 | scale: 256.00 | time: 27.113 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   2960/  5000| tot_loss: 2.7804 | rl_loss: 1.1673 | pt_loss: 1.6131 | pg_loss: 0.3579 | reg_loss: 0.8094 | reward: -0.2033 | rev_kl: 0.7690 | stu_lens: 97.2500 | mixed_lens: 92.0469 | lr: 1.8612e-06 | scale: 256.00 | time: 27.113 | step time: 28.291
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   2961/  5000| tot_loss: 2.3115 | rl_loss: 0.8854 | pt_loss: 1.4261 | pg_loss: 0.0465 | reg_loss: 0.8389 | reward: -0.1049 | rev_kl: 1.8993 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.8597e-06 | scale: 256.00 | time: 27.045 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   2962/  5000| tot_loss: 2.5814 | rl_loss: 0.9583 | pt_loss: 1.6231 | pg_loss: 0.2899 | reg_loss: 0.6683 | reward: -0.2372 | rev_kl: 0.6648 | stu_lens: 74.5000 | mixed_lens: 75.5000 | lr: 1.8581e-06 | scale: 256.00 | time: 27.055 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   2963/  5000| tot_loss: 3.2019 | rl_loss: 1.4985 | pt_loss: 1.7034 | pg_loss: 0.3979 | reg_loss: 1.1006 | reward: -0.5077 | rev_kl: 1.0072 | stu_lens: 85.0000 | mixed_lens: 86.0000 | lr: 1.8566e-06 | scale: 256.00 | time: 27.032 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   2964/  5000| tot_loss: 2.1532 | rl_loss: 0.7455 | pt_loss: 1.4078 | pg_loss: -0.0166 | reg_loss: 0.7620 | reward: -0.2724 | rev_kl: 0.9397 | stu_lens: 86.5000 | mixed_lens: 128.0000 | lr: 1.8550e-06 | scale: 256.00 | time: 27.064 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   2965/  5000| tot_loss: 2.6313 | rl_loss: 1.3042 | pt_loss: 1.3271 | pg_loss: 0.4856 | reg_loss: 0.8186 | reward: -0.2070 | rev_kl: 0.4160 | stu_lens: 68.0000 | mixed_lens: 68.5000 | lr: 1.8535e-06 | scale: 256.00 | time: 27.019 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   2966/  5000| tot_loss: 2.6613 | rl_loss: 0.9359 | pt_loss: 1.7254 | pg_loss: 0.3859 | reg_loss: 0.5500 | reward: -0.1695 | rev_kl: 0.3323 | stu_lens: 81.5000 | mixed_lens: 82.5000 | lr: 1.8519e-06 | scale: 256.00 | time: 27.045 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   2967/  5000| tot_loss: 2.3598 | rl_loss: 0.5946 | pt_loss: 1.7652 | pg_loss: 0.0089 | reg_loss: 0.5857 | reward: -0.2250 | rev_kl: 0.6833 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.8504e-06 | scale: 256.00 | time: 27.033 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   2968/  5000| tot_loss: 2.5930 | rl_loss: 1.0362 | pt_loss: 1.5568 | pg_loss: 0.4007 | reg_loss: 0.6354 | reward: -0.6199 | rev_kl: 1.0977 | stu_lens: 128.0000 | mixed_lens: 81.0000 | lr: 1.8488e-06 | scale: 256.00 | time: 27.060 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   2969/  5000| tot_loss: 2.6733 | rl_loss: 0.7916 | pt_loss: 1.8817 | pg_loss: 0.0908 | reg_loss: 0.7008 | reward: -0.2756 | rev_kl: 1.0160 | stu_lens: 128.0000 | mixed_lens: 109.0000 | lr: 1.8473e-06 | scale: 256.00 | time: 27.054 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   2970/  5000| tot_loss: 3.4710 | rl_loss: 1.4768 | pt_loss: 1.9942 | pg_loss: 0.7384 | reg_loss: 0.7384 | reward: -0.5036 | rev_kl: 0.7562 | stu_lens: 54.5000 | mixed_lens: 45.5000 | lr: 1.8457e-06 | scale: 256.00 | time: 27.082 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   2971/  5000| tot_loss: 2.3061 | rl_loss: 0.8410 | pt_loss: 1.4651 | pg_loss: 0.2012 | reg_loss: 0.6398 | reward: -0.1448 | rev_kl: 1.8272 | stu_lens: 128.0000 | mixed_lens: 76.0000 | lr: 1.8442e-06 | scale: 256.00 | time: 27.077 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   2972/  5000| tot_loss: 2.6822 | rl_loss: 1.1177 | pt_loss: 1.5645 | pg_loss: 0.3690 | reg_loss: 0.7487 | reward: -0.2670 | rev_kl: 0.7396 | stu_lens: 108.5000 | mixed_lens: 73.5000 | lr: 1.8426e-06 | scale: 256.00 | time: 27.124 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   2973/  5000| tot_loss: 2.6297 | rl_loss: 0.9495 | pt_loss: 1.6802 | pg_loss: 0.1102 | reg_loss: 0.8392 | reward: -0.2287 | rev_kl: 0.5234 | stu_lens: 128.0000 | mixed_lens: 115.5000 | lr: 1.8411e-06 | scale: 256.00 | time: 27.040 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   2974/  5000| tot_loss: 2.2289 | rl_loss: 0.4666 | pt_loss: 1.7623 | pg_loss: 0.0226 | reg_loss: 0.4441 | reward: -0.0680 | rev_kl: 0.9059 | stu_lens: 114.5000 | mixed_lens: 128.0000 | lr: 1.8395e-06 | scale: 256.00 | time: 27.061 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   2975/  5000| tot_loss: 2.9094 | rl_loss: 1.1818 | pt_loss: 1.7276 | pg_loss: 0.3384 | reg_loss: 0.8434 | reward: -0.0373 | rev_kl: 0.3155 | stu_lens: 75.0000 | mixed_lens: 75.0000 | lr: 1.8380e-06 | scale: 256.00 | time: 27.043 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2976/  5000| tot_loss: 2.5670 | rl_loss: 0.5330 | pt_loss: 2.0340 | pg_loss: -0.0011 | reg_loss: 0.5341 | reward: -0.0957 | rev_kl: 1.9855 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.8365e-06 | scale: 256.00 | time: 27.047 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   2976/  5000| tot_loss: 2.5490 | rl_loss: 0.8624 | pt_loss: 1.6866 | pg_loss: 0.2208 | reg_loss: 0.6416 | reward: -0.2034 | rev_kl: 0.8199 | stu_lens: 102.3906 | mixed_lens: 94.8125 | lr: 1.8365e-06 | scale: 256.00 | time: 27.047 | step time: 28.285
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   2977/  5000| tot_loss: 2.4522 | rl_loss: 0.8816 | pt_loss: 1.5705 | pg_loss: 0.3208 | reg_loss: 0.5608 | reward: -0.2738 | rev_kl: 0.8378 | stu_lens: 86.0000 | mixed_lens: 93.0000 | lr: 1.8349e-06 | scale: 256.00 | time: 27.036 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   2978/  5000| tot_loss: 2.0072 | rl_loss: 0.2914 | pt_loss: 1.7158 | pg_loss: -0.0117 | reg_loss: 0.3031 | reward: 0.0732 | rev_kl: 0.6004 | stu_lens: 81.5000 | mixed_lens: 78.5000 | lr: 1.8334e-06 | scale: 256.00 | time: 27.058 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   2979/  5000| tot_loss: 2.2308 | rl_loss: 0.4718 | pt_loss: 1.7590 | pg_loss: -0.0187 | reg_loss: 0.4905 | reward: -0.2238 | rev_kl: 0.5825 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.8318e-06 | scale: 256.00 | time: 27.049 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   2980/  5000| tot_loss: 1.8890 | rl_loss: 0.3559 | pt_loss: 1.5331 | pg_loss: -0.0216 | reg_loss: 0.3776 | reward: -0.0609 | rev_kl: 0.6898 | stu_lens: 99.0000 | mixed_lens: 128.0000 | lr: 1.8303e-06 | scale: 256.00 | time: 27.103 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   2981/  5000| tot_loss: 2.2223 | rl_loss: 0.3763 | pt_loss: 1.8461 | pg_loss: 0.1459 | reg_loss: 0.2303 | reward: -0.1016 | rev_kl: 0.4679 | stu_lens: 110.5000 | mixed_lens: 95.0000 | lr: 1.8287e-06 | scale: 256.00 | time: 27.068 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   2982/  5000| tot_loss: 2.3414 | rl_loss: 0.4624 | pt_loss: 1.8790 | pg_loss: -0.0199 | reg_loss: 0.4823 | reward: -0.0752 | rev_kl: 0.8335 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.8272e-06 | scale: 256.00 | time: 27.123 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   2983/  5000| tot_loss: 3.2012 | rl_loss: 1.1251 | pt_loss: 2.0761 | pg_loss: 0.6954 | reg_loss: 0.4297 | reward: -0.2926 | rev_kl: 1.6250 | stu_lens: 81.5000 | mixed_lens: 54.0000 | lr: 1.8256e-06 | scale: 256.00 | time: 27.038 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   2984/  5000| tot_loss: 2.4212 | rl_loss: 0.5241 | pt_loss: 1.8971 | pg_loss: -0.0130 | reg_loss: 0.5371 | reward: -0.1463 | rev_kl: 0.8763 | stu_lens: 127.5000 | mixed_lens: 128.0000 | lr: 1.8241e-06 | scale: 256.00 | time: 27.063 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   2985/  5000| tot_loss: 2.4109 | rl_loss: 0.7962 | pt_loss: 1.6147 | pg_loss: 0.3369 | reg_loss: 0.4593 | reward: -0.2133 | rev_kl: 1.1413 | stu_lens: 128.0000 | mixed_lens: 83.0000 | lr: 1.8226e-06 | scale: 256.00 | time: 27.049 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   2986/  5000| tot_loss: 1.8781 | rl_loss: 0.4764 | pt_loss: 1.4017 | pg_loss: 0.0552 | reg_loss: 0.4212 | reward: -0.1546 | rev_kl: 1.0480 | stu_lens: 121.0000 | mixed_lens: 128.0000 | lr: 1.8210e-06 | scale: 256.00 | time: 27.050 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   2987/  5000| tot_loss: 1.8440 | rl_loss: 0.5139 | pt_loss: 1.3301 | pg_loss: 0.1304 | reg_loss: 0.3835 | reward: -0.1393 | rev_kl: 0.9205 | stu_lens: 128.0000 | mixed_lens: 95.5000 | lr: 1.8195e-06 | scale: 256.00 | time: 27.033 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   2988/  5000| tot_loss: 4.2619 | rl_loss: 1.6365 | pt_loss: 2.6254 | pg_loss: 1.4139 | reg_loss: 0.2226 | reward: -0.1561 | rev_kl: 0.1991 | stu_lens: 22.0000 | mixed_lens: 22.5000 | lr: 1.8179e-06 | scale: 256.00 | time: 27.059 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   2989/  5000| tot_loss: 2.9812 | rl_loss: 0.7556 | pt_loss: 2.2257 | pg_loss: 0.3749 | reg_loss: 0.3806 | reward: -0.2262 | rev_kl: 0.5099 | stu_lens: 68.5000 | mixed_lens: 68.5000 | lr: 1.8164e-06 | scale: 256.00 | time: 27.045 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   2990/  5000| tot_loss: 2.5001 | rl_loss: 0.5131 | pt_loss: 1.9869 | pg_loss: 0.0651 | reg_loss: 0.4480 | reward: -0.2493 | rev_kl: 0.8694 | stu_lens: 128.0000 | mixed_lens: 109.0000 | lr: 1.8148e-06 | scale: 256.00 | time: 27.079 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   2991/  5000| tot_loss: 2.1753 | rl_loss: 0.7455 | pt_loss: 1.4298 | pg_loss: 0.3707 | reg_loss: 0.3748 | reward: -0.0891 | rev_kl: 0.7175 | stu_lens: 66.0000 | mixed_lens: 66.0000 | lr: 1.8133e-06 | scale: 256.00 | time: 27.086 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2992/  5000| tot_loss: 3.2980 | rl_loss: 1.3846 | pt_loss: 1.9134 | pg_loss: 0.9392 | reg_loss: 0.4454 | reward: -0.7796 | rev_kl: 0.8155 | stu_lens: 128.0000 | mixed_lens: 41.0000 | lr: 1.8118e-06 | scale: 256.00 | time: 27.105 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   2992/  5000| tot_loss: 2.5421 | rl_loss: 0.7665 | pt_loss: 1.7756 | pg_loss: 0.3172 | reg_loss: 0.4493 | reward: -0.2047 | rev_kl: 0.8037 | stu_lens: 97.6875 | mixed_lens: 89.5156 | lr: 1.8118e-06 | scale: 256.00 | time: 27.105 | step time: 28.295
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   2993/  5000| tot_loss: 2.2533 | rl_loss: 0.5146 | pt_loss: 1.7387 | pg_loss: 0.0178 | reg_loss: 0.4968 | reward: -0.0798 | rev_kl: 0.4041 | stu_lens: 120.0000 | mixed_lens: 116.5000 | lr: 1.8102e-06 | scale: 256.00 | time: 27.057 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   2994/  5000| tot_loss: 1.8806 | rl_loss: 0.2429 | pt_loss: 1.6378 | pg_loss: -0.0147 | reg_loss: 0.2576 | reward: -0.0782 | rev_kl: 0.6595 | stu_lens: 99.0000 | mixed_lens: 128.0000 | lr: 1.8087e-06 | scale: 256.00 | time: 27.071 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   2995/  5000| tot_loss: 2.3879 | rl_loss: 0.6527 | pt_loss: 1.7352 | pg_loss: 0.3265 | reg_loss: 0.3262 | reward: -0.1973 | rev_kl: 1.6304 | stu_lens: 68.5000 | mixed_lens: 68.5000 | lr: 1.8071e-06 | scale: 256.00 | time: 27.044 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   2996/  5000| tot_loss: 2.4932 | rl_loss: 0.5698 | pt_loss: 1.9233 | pg_loss: -0.0188 | reg_loss: 0.5887 | reward: -0.0921 | rev_kl: 0.9463 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.8056e-06 | scale: 256.00 | time: 27.050 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   2997/  5000| tot_loss: 2.6150 | rl_loss: 0.7471 | pt_loss: 1.8680 | pg_loss: 0.2514 | reg_loss: 0.4956 | reward: -0.0863 | rev_kl: 0.9012 | stu_lens: 81.0000 | mixed_lens: 86.0000 | lr: 1.8041e-06 | scale: 256.00 | time: 27.033 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   2998/  5000| tot_loss: 2.3573 | rl_loss: 0.4692 | pt_loss: 1.8881 | pg_loss: 0.1077 | reg_loss: 0.3615 | reward: -0.1471 | rev_kl: 0.9902 | stu_lens: 124.5000 | mixed_lens: 108.0000 | lr: 1.8025e-06 | scale: 256.00 | time: 27.061 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   2999/  5000| tot_loss: 2.4627 | rl_loss: 0.4905 | pt_loss: 1.9721 | pg_loss: 0.1302 | reg_loss: 0.3603 | reward: -0.1034 | rev_kl: 1.2283 | stu_lens: 102.0000 | mixed_lens: 106.5000 | lr: 1.8010e-06 | scale: 256.00 | time: 27.050 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/3000
                                 Evaluation #30                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son una clase de          │
│                                       │ partículas elementales que forman la │
│                                       │ parte más pequeña deladémos de la    │
│                                       │ materia. Existen cuatro tipos de     │
│                                       │ cuarks:                              │
│                                       │                                      │
│                                       │ - Cuark up (o quark up): es el cuark │
│                                       │ más ligeramente pesado.              │
│                                       │ - Cuark down (o quark down): es el   │
│                                       │ cuark más pesado.                    │
│                                       │ - Cuark strange (o quark strange):   │
│                                       │ es el cuark con la masa intermedia.  │
│                                       │ - Cuark charm (o quark charm): es el │
│                                       │ cuark con la masa más ligeramente    │
│                                       │ corriente                            │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC (Intrusion Management Center) │
│                                       │ es un dispositivo que sirve para     │
│                                       │ gestionar las alertas de intrusos en │
│                                       │ un ordenador o red. Los intrusos     │
│                                       │ pueden ser, por ejemplo, virus,      │
│                                       │ spyware o malware. El IMC evalua las │
│                                       │ alertas de intrusos, y con base a    │
│                                       │ ellas, decide qué acciones tomar.    │
│                                       │ Las acciones pueden ser, por         │
│                                       │ ejemplo, notificar a un              │
│                                       │ administrador de sistemas o hacer    │
│                                       │ una copia de seguridad.              │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ 1. Cápsula del tiempo de Pigmalión,  │
│                                       │ 2000 a. C.                           │
│                                       │ 2. Cápsula del tiempo de Moisés,     │
│                                       │ 1242 a. C.                           │
│                                       │ 3. Cápsula del tiempo de Heráclito,  │
│                                       │ 535 a. C.                            │
│                                       │ 4. Cápsula del tiempo de Ramsés II,  │
│                                       │ 1279 a. C.                           │
│                                       │ 5. Cápsula del tiempo de Alejandro   │
│                                       │ el Grande, 336 a. C.                 │
│                                       │ 6. Cápsula del tiempo de             │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.097 | exact_match: 0.104 | rev_kl: 0.792 | lens: 93.335 | pt_loss: 1.728 | lm_loss: 1.858 | kd_loss: 1.599 
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   3000/  5000| tot_loss: 3.0314 | rl_loss: 1.0212 | pt_loss: 2.0102 | pg_loss: 0.4815 | reg_loss: 0.5397 | reward: -0.6336 | rev_kl: 0.9681 | stu_lens: 128.0000 | mixed_lens: 79.0000 | lr: 1.7994e-06 | scale: 256.00 | time: 27.084 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   3001/  5000| tot_loss: 1.8333 | rl_loss: 0.4069 | pt_loss: 1.4265 | pg_loss: 0.1680 | reg_loss: 0.2388 | reward: -0.1937 | rev_kl: 0.4492 | stu_lens: 75.0000 | mixed_lens: 56.0000 | lr: 1.7979e-06 | scale: 256.00 | time: 27.100 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   3002/  5000| tot_loss: 1.9475 | rl_loss: 0.5466 | pt_loss: 1.4008 | pg_loss: 0.2310 | reg_loss: 0.3156 | reward: -0.1813 | rev_kl: 0.7683 | stu_lens: 128.0000 | mixed_lens: 97.0000 | lr: 1.7964e-06 | scale: 256.00 | time: 27.061 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   3003/  5000| tot_loss: 2.2793 | rl_loss: 0.9692 | pt_loss: 1.3101 | pg_loss: 0.7936 | reg_loss: 0.1756 | reward: -0.2363 | rev_kl: 0.4584 | stu_lens: 57.5000 | mixed_lens: 42.5000 | lr: 1.7948e-06 | scale: 256.00 | time: 27.056 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   3004/  5000| tot_loss: 2.8507 | rl_loss: 0.8350 | pt_loss: 2.0158 | pg_loss: 0.5018 | reg_loss: 0.3332 | reward: -0.3696 | rev_kl: 0.6432 | stu_lens: 128.0000 | mixed_lens: 75.5000 | lr: 1.7933e-06 | scale: 256.00 | time: 27.050 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   3005/  5000| tot_loss: 1.6837 | rl_loss: 0.2805 | pt_loss: 1.4032 | pg_loss: -0.0201 | reg_loss: 0.3006 | reward: -0.0852 | rev_kl: 0.7047 | stu_lens: 127.5000 | mixed_lens: 128.0000 | lr: 1.7918e-06 | scale: 256.00 | time: 27.063 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   3006/  5000| tot_loss: 1.9983 | rl_loss: 0.9492 | pt_loss: 1.0491 | pg_loss: 0.5964 | reg_loss: 0.3527 | reward: -0.2814 | rev_kl: 0.7745 | stu_lens: 80.0000 | mixed_lens: 66.0000 | lr: 1.7902e-06 | scale: 256.00 | time: 27.056 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   3007/  5000| tot_loss: 1.7929 | rl_loss: 0.3484 | pt_loss: 1.4444 | pg_loss: 0.0168 | reg_loss: 0.3316 | reward: -0.0894 | rev_kl: 0.6662 | stu_lens: 127.5000 | mixed_lens: 128.0000 | lr: 1.7887e-06 | scale: 256.00 | time: 27.093 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3008/  5000| tot_loss: 2.2471 | rl_loss: 0.5465 | pt_loss: 1.7005 | pg_loss: 0.4550 | reg_loss: 0.0915 | reward: -0.0190 | rev_kl: 0.1348 | stu_lens: 67.5000 | mixed_lens: 64.0000 | lr: 1.7871e-06 | scale: 256.00 | time: 27.082 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3008/  5000| tot_loss: 2.3361 | rl_loss: 0.6036 | pt_loss: 1.7325 | pg_loss: 0.2133 | reg_loss: 0.3904 | reward: -0.1984 | rev_kl: 0.8033 | stu_lens: 100.2500 | mixed_lens: 93.5156 | lr: 1.7871e-06 | scale: 256.00 | time: 27.082 | step time: 28.295
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   3009/  5000| tot_loss: 2.4107 | rl_loss: 0.5805 | pt_loss: 1.8302 | pg_loss: 0.2468 | reg_loss: 0.3337 | reward: -0.2591 | rev_kl: 0.3828 | stu_lens: 81.5000 | mixed_lens: 82.5000 | lr: 1.7856e-06 | scale: 256.00 | time: 27.120 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   3010/  5000| tot_loss: 3.1186 | rl_loss: 1.2153 | pt_loss: 1.9033 | pg_loss: 0.1655 | reg_loss: 1.0498 | reward: -0.1498 | rev_kl: 0.9062 | stu_lens: 126.5000 | mixed_lens: 110.0000 | lr: 1.7841e-06 | scale: 256.00 | time: 27.100 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   3011/  5000| tot_loss: 2.3826 | rl_loss: 1.1222 | pt_loss: 1.2604 | pg_loss: 0.1899 | reg_loss: 0.9323 | reward: -0.2915 | rev_kl: 0.6754 | stu_lens: 124.0000 | mixed_lens: 110.0000 | lr: 1.7825e-06 | scale: 256.00 | time: 27.086 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   3012/  5000| tot_loss: 3.4467 | rl_loss: 1.5455 | pt_loss: 1.9012 | pg_loss: 0.3065 | reg_loss: 1.2389 | reward: -0.3145 | rev_kl: 0.5177 | stu_lens: 75.5000 | mixed_lens: 80.5000 | lr: 1.7810e-06 | scale: 256.00 | time: 27.082 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   3013/  5000| tot_loss: 2.6759 | rl_loss: 0.8887 | pt_loss: 1.7872 | pg_loss: 0.0491 | reg_loss: 0.8396 | reward: -0.1056 | rev_kl: 0.6403 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.7795e-06 | scale: 256.00 | time: 27.113 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   3014/  5000| tot_loss: 3.2135 | rl_loss: 1.4449 | pt_loss: 1.7686 | pg_loss: 0.5911 | reg_loss: 0.8538 | reward: -0.4838 | rev_kl: 0.4223 | stu_lens: 76.5000 | mixed_lens: 71.5000 | lr: 1.7779e-06 | scale: 256.00 | time: 27.065 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   3015/  5000| tot_loss: 3.3063 | rl_loss: 1.4733 | pt_loss: 1.8330 | pg_loss: 0.4736 | reg_loss: 0.9996 | reward: -0.4730 | rev_kl: 0.5417 | stu_lens: 72.5000 | mixed_lens: 70.5000 | lr: 1.7764e-06 | scale: 256.00 | time: 27.053 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   3016/  5000| tot_loss: 2.6984 | rl_loss: 0.9832 | pt_loss: 1.7152 | pg_loss: 0.5812 | reg_loss: 0.4020 | reward: 0.0191 | rev_kl: 2.1812 | stu_lens: 65.5000 | mixed_lens: 53.5000 | lr: 1.7749e-06 | scale: 256.00 | time: 27.065 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   3017/  5000| tot_loss: 2.0127 | rl_loss: 0.7543 | pt_loss: 1.2584 | pg_loss: 0.0959 | reg_loss: 0.6585 | reward: -0.1110 | rev_kl: 0.3901 | stu_lens: 104.5000 | mixed_lens: 112.0000 | lr: 1.7733e-06 | scale: 256.00 | time: 27.054 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   3018/  5000| tot_loss: 2.8386 | rl_loss: 0.7519 | pt_loss: 2.0867 | pg_loss: 0.0498 | reg_loss: 0.7021 | reward: -0.0659 | rev_kl: 1.0227 | stu_lens: 115.5000 | mixed_lens: 128.0000 | lr: 1.7718e-06 | scale: 256.00 | time: 27.050 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   3019/  5000| tot_loss: 2.7152 | rl_loss: 1.0716 | pt_loss: 1.6436 | pg_loss: 0.1654 | reg_loss: 0.9062 | reward: -0.2389 | rev_kl: 0.7696 | stu_lens: 124.0000 | mixed_lens: 101.5000 | lr: 1.7703e-06 | scale: 256.00 | time: 27.046 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   3020/  5000| tot_loss: 3.0560 | rl_loss: 1.4510 | pt_loss: 1.6050 | pg_loss: 0.5849 | reg_loss: 0.8661 | reward: -0.3573 | rev_kl: 0.5793 | stu_lens: 72.5000 | mixed_lens: 64.0000 | lr: 1.7687e-06 | scale: 256.00 | time: 27.065 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   3021/  5000| tot_loss: 2.6835 | rl_loss: 1.4271 | pt_loss: 1.2565 | pg_loss: 0.5457 | reg_loss: 0.8814 | reward: -0.2059 | rev_kl: 1.5239 | stu_lens: 67.5000 | mixed_lens: 67.0000 | lr: 1.7672e-06 | scale: 256.00 | time: 27.062 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   3022/  5000| tot_loss: 2.4939 | rl_loss: 0.9357 | pt_loss: 1.5581 | pg_loss: 0.0634 | reg_loss: 0.8723 | reward: -0.0497 | rev_kl: 0.6750 | stu_lens: 97.0000 | mixed_lens: 128.0000 | lr: 1.7657e-06 | scale: 256.00 | time: 27.084 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   3023/  5000| tot_loss: 2.6983 | rl_loss: 0.8285 | pt_loss: 1.8698 | pg_loss: 0.0488 | reg_loss: 0.7796 | reward: -0.0673 | rev_kl: 0.6683 | stu_lens: 116.5000 | mixed_lens: 128.0000 | lr: 1.7641e-06 | scale: 256.00 | time: 27.092 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3024/  5000| tot_loss: 2.9782 | rl_loss: 1.2221 | pt_loss: 1.7561 | pg_loss: 0.1762 | reg_loss: 1.0459 | reward: -0.3699 | rev_kl: 0.6941 | stu_lens: 96.0000 | mixed_lens: 112.0000 | lr: 1.7626e-06 | scale: 256.00 | time: 27.075 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3024/  5000| tot_loss: 2.7587 | rl_loss: 1.0815 | pt_loss: 1.6773 | pg_loss: 0.2622 | reg_loss: 0.8193 | reward: -0.2716 | rev_kl: 0.7330 | stu_lens: 94.1562 | mixed_lens: 94.1406 | lr: 1.7626e-06 | scale: 256.00 | time: 27.075 | step time: 28.307
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   3025/  5000| tot_loss: 3.2411 | rl_loss: 1.4241 | pt_loss: 1.8170 | pg_loss: 0.6002 | reg_loss: 0.8239 | reward: -0.4386 | rev_kl: 0.5710 | stu_lens: 71.0000 | mixed_lens: 43.5000 | lr: 1.7611e-06 | scale: 256.00 | time: 27.050 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   3026/  5000| tot_loss: 2.4839 | rl_loss: 1.2602 | pt_loss: 1.2238 | pg_loss: 0.3691 | reg_loss: 0.8910 | reward: -0.6602 | rev_kl: 0.6818 | stu_lens: 67.5000 | mixed_lens: 70.5000 | lr: 1.7595e-06 | scale: 256.00 | time: 27.080 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   3027/  5000| tot_loss: 2.3719 | rl_loss: 0.7135 | pt_loss: 1.6584 | pg_loss: 0.1052 | reg_loss: 0.6083 | reward: -0.3415 | rev_kl: 0.7345 | stu_lens: 92.5000 | mixed_lens: 100.5000 | lr: 1.7580e-06 | scale: 256.00 | time: 27.061 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   3028/  5000| tot_loss: 2.2432 | rl_loss: 0.5822 | pt_loss: 1.6609 | pg_loss: 0.0453 | reg_loss: 0.5370 | reward: -0.2080 | rev_kl: 0.5836 | stu_lens: 128.0000 | mixed_lens: 116.0000 | lr: 1.7565e-06 | scale: 256.00 | time: 27.061 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   3029/  5000| tot_loss: 2.5789 | rl_loss: 0.5670 | pt_loss: 2.0119 | pg_loss: -0.0194 | reg_loss: 0.5864 | reward: -0.2185 | rev_kl: 0.8197 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.7549e-06 | scale: 256.00 | time: 27.049 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   3030/  5000| tot_loss: 3.2811 | rl_loss: 1.2710 | pt_loss: 2.0101 | pg_loss: 0.9977 | reg_loss: 0.2733 | reward: -0.1896 | rev_kl: 1.4041 | stu_lens: 23.5000 | mixed_lens: 21.5000 | lr: 1.7534e-06 | scale: 256.00 | time: 27.075 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   3031/  5000| tot_loss: 3.2484 | rl_loss: 1.1390 | pt_loss: 2.1094 | pg_loss: 0.4574 | reg_loss: 0.6816 | reward: -0.3791 | rev_kl: 0.6301 | stu_lens: 88.5000 | mixed_lens: 67.5000 | lr: 1.7519e-06 | scale: 256.00 | time: 27.065 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   3032/  5000| tot_loss: 2.9545 | rl_loss: 1.0097 | pt_loss: 1.9448 | pg_loss: 0.2643 | reg_loss: 0.7454 | reward: -0.2431 | rev_kl: 1.1159 | stu_lens: 96.0000 | mixed_lens: 96.0000 | lr: 1.7504e-06 | scale: 256.00 | time: 27.102 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   3033/  5000| tot_loss: 2.5395 | rl_loss: 0.6058 | pt_loss: 1.9337 | pg_loss: 0.0010 | reg_loss: 0.6048 | reward: -0.0345 | rev_kl: 0.7339 | stu_lens: 84.5000 | mixed_lens: 128.0000 | lr: 1.7488e-06 | scale: 256.00 | time: 27.094 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   3034/  5000| tot_loss: 2.1660 | rl_loss: 0.9075 | pt_loss: 1.2586 | pg_loss: 0.3539 | reg_loss: 0.5536 | reward: -0.2975 | rev_kl: 0.5008 | stu_lens: 60.5000 | mixed_lens: 72.0000 | lr: 1.7473e-06 | scale: 256.00 | time: 27.087 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   3035/  5000| tot_loss: 2.2598 | rl_loss: 1.0238 | pt_loss: 1.2360 | pg_loss: 0.4560 | reg_loss: 0.5678 | reward: -0.4502 | rev_kl: 0.7252 | stu_lens: 73.0000 | mixed_lens: 75.0000 | lr: 1.7458e-06 | scale: 256.00 | time: 27.049 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   3036/  5000| tot_loss: 2.5796 | rl_loss: 0.5945 | pt_loss: 1.9851 | pg_loss: -0.0278 | reg_loss: 0.6223 | reward: -0.1639 | rev_kl: 0.8352 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.7442e-06 | scale: 256.00 | time: 27.082 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   3037/  5000| tot_loss: 2.6096 | rl_loss: 0.8504 | pt_loss: 1.7591 | pg_loss: 0.2673 | reg_loss: 0.5832 | reward: -0.3760 | rev_kl: 0.5711 | stu_lens: 128.0000 | mixed_lens: 91.5000 | lr: 1.7427e-06 | scale: 256.00 | time: 27.066 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   3038/  5000| tot_loss: 2.9228 | rl_loss: 1.2676 | pt_loss: 1.6552 | pg_loss: 0.4201 | reg_loss: 0.8476 | reward: -0.3841 | rev_kl: 0.5570 | stu_lens: 75.0000 | mixed_lens: 65.5000 | lr: 1.7412e-06 | scale: 256.00 | time: 27.063 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   3039/  5000| tot_loss: 2.1180 | rl_loss: 0.4562 | pt_loss: 1.6618 | pg_loss: -0.0045 | reg_loss: 0.4607 | reward: -0.1076 | rev_kl: 0.7615 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.7397e-06 | scale: 256.00 | time: 27.203 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3040/  5000| tot_loss: 2.5706 | rl_loss: 0.8482 | pt_loss: 1.7224 | pg_loss: 0.0060 | reg_loss: 0.8422 | reward: -0.2814 | rev_kl: 1.1216 | stu_lens: 127.0000 | mixed_lens: 128.0000 | lr: 1.7381e-06 | scale: 256.00 | time: 27.233 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3040/  5000| tot_loss: 2.7040 | rl_loss: 0.9137 | pt_loss: 1.7903 | pg_loss: 0.2646 | reg_loss: 0.6492 | reward: -0.2954 | rev_kl: 0.7558 | stu_lens: 91.3594 | mixed_lens: 89.3750 | lr: 1.7381e-06 | scale: 256.00 | time: 27.233 | step time: 28.319
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   3041/  5000| tot_loss: 2.3259 | rl_loss: 0.6297 | pt_loss: 1.6962 | pg_loss: 0.0036 | reg_loss: 0.6261 | reward: -0.1904 | rev_kl: 0.7171 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.7366e-06 | scale: 256.00 | time: 27.202 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   3042/  5000| tot_loss: 3.5412 | rl_loss: 1.6028 | pt_loss: 1.9384 | pg_loss: 1.0483 | reg_loss: 0.5545 | reward: -0.6478 | rev_kl: 0.6260 | stu_lens: 64.0000 | mixed_lens: 39.0000 | lr: 1.7351e-06 | scale: 256.00 | time: 27.204 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   3043/  5000| tot_loss: 2.6167 | rl_loss: 1.1469 | pt_loss: 1.4698 | pg_loss: 0.5346 | reg_loss: 0.6124 | reward: -0.4499 | rev_kl: 0.9292 | stu_lens: 69.5000 | mixed_lens: 64.5000 | lr: 1.7336e-06 | scale: 256.00 | time: 27.178 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   3044/  5000| tot_loss: 2.4761 | rl_loss: 1.0413 | pt_loss: 1.4348 | pg_loss: 0.3671 | reg_loss: 0.6742 | reward: -0.1384 | rev_kl: 2.2678 | stu_lens: 64.5000 | mixed_lens: 74.0000 | lr: 1.7320e-06 | scale: 256.00 | time: 27.238 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   3045/  5000| tot_loss: 2.5239 | rl_loss: 0.5928 | pt_loss: 1.9311 | pg_loss: 0.1277 | reg_loss: 0.4651 | reward: -0.2194 | rev_kl: 0.8578 | stu_lens: 128.0000 | mixed_lens: 88.0000 | lr: 1.7305e-06 | scale: 256.00 | time: 27.184 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   3046/  5000| tot_loss: 2.0242 | rl_loss: 0.5375 | pt_loss: 1.4867 | pg_loss: 0.0177 | reg_loss: 0.5198 | reward: -0.2257 | rev_kl: 0.9718 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.7290e-06 | scale: 256.00 | time: 27.233 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   3047/  5000| tot_loss: 3.6525 | rl_loss: 1.2849 | pt_loss: 2.3676 | pg_loss: 0.8188 | reg_loss: 0.4661 | reward: -0.4581 | rev_kl: 0.6239 | stu_lens: 73.0000 | mixed_lens: 49.5000 | lr: 1.7275e-06 | scale: 256.00 | time: 27.215 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   3048/  5000| tot_loss: 2.3284 | rl_loss: 0.7560 | pt_loss: 1.5724 | pg_loss: 0.2933 | reg_loss: 0.4627 | reward: -0.2400 | rev_kl: 0.6093 | stu_lens: 100.5000 | mixed_lens: 94.0000 | lr: 1.7259e-06 | scale: 256.00 | time: 27.204 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   3049/  5000| tot_loss: 2.1155 | rl_loss: 0.3734 | pt_loss: 1.7421 | pg_loss: 0.1164 | reg_loss: 0.2570 | reward: -0.2267 | rev_kl: 0.8859 | stu_lens: 96.0000 | mixed_lens: 96.0000 | lr: 1.7244e-06 | scale: 256.00 | time: 27.190 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   3050/  5000| tot_loss: 2.4714 | rl_loss: 0.7330 | pt_loss: 1.7384 | pg_loss: 0.1838 | reg_loss: 0.5492 | reward: -0.3053 | rev_kl: 0.8729 | stu_lens: 128.0000 | mixed_lens: 102.5000 | lr: 1.7229e-06 | scale: 256.00 | time: 27.219 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   3051/  5000| tot_loss: 1.9434 | rl_loss: 0.4229 | pt_loss: 1.5205 | pg_loss: -0.0060 | reg_loss: 0.4289 | reward: -0.1151 | rev_kl: 0.7554 | stu_lens: 96.5000 | mixed_lens: 125.0000 | lr: 1.7214e-06 | scale: 256.00 | time: 27.194 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   3052/  5000| tot_loss: 2.3289 | rl_loss: 0.2839 | pt_loss: 2.0450 | pg_loss: 0.0386 | reg_loss: 0.2452 | reward: -0.0652 | rev_kl: 0.5702 | stu_lens: 118.5000 | mixed_lens: 109.5000 | lr: 1.7198e-06 | scale: 256.00 | time: 27.244 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   3053/  5000| tot_loss: 2.0297 | rl_loss: 0.4172 | pt_loss: 1.6124 | pg_loss: 0.0080 | reg_loss: 0.4092 | reward: 0.0061 | rev_kl: 0.7898 | stu_lens: 128.0000 | mixed_lens: 126.0000 | lr: 1.7183e-06 | scale: 256.00 | time: 27.197 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   3054/  5000| tot_loss: 2.1824 | rl_loss: 0.8719 | pt_loss: 1.3105 | pg_loss: 0.3770 | reg_loss: 0.4949 | reward: -0.5611 | rev_kl: 0.7026 | stu_lens: 74.5000 | mixed_lens: 74.0000 | lr: 1.7168e-06 | scale: 256.00 | time: 27.246 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   3055/  5000| tot_loss: 2.5798 | rl_loss: 0.6706 | pt_loss: 1.9092 | pg_loss: 0.1672 | reg_loss: 0.5033 | reward: -0.2686 | rev_kl: 0.5724 | stu_lens: 72.5000 | mixed_lens: 100.5000 | lr: 1.7153e-06 | scale: 256.00 | time: 27.229 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3056/  5000| tot_loss: 1.8153 | rl_loss: 0.5195 | pt_loss: 1.2957 | pg_loss: 0.0031 | reg_loss: 0.5165 | reward: -0.1163 | rev_kl: 0.8310 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.7138e-06 | scale: 256.00 | time: 27.227 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3056/  5000| tot_loss: 2.3947 | rl_loss: 0.6823 | pt_loss: 1.7124 | pg_loss: 0.2047 | reg_loss: 0.4776 | reward: -0.2695 | rev_kl: 0.7702 | stu_lens: 97.6406 | mixed_lens: 96.2344 | lr: 1.7138e-06 | scale: 256.00 | time: 27.227 | step time: 28.443
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   3057/  5000| tot_loss: 2.5299 | rl_loss: 0.7554 | pt_loss: 1.7745 | pg_loss: 0.3505 | reg_loss: 0.4049 | reward: -0.0614 | rev_kl: 0.6413 | stu_lens: 71.5000 | mixed_lens: 82.5000 | lr: 1.7122e-06 | scale: 256.00 | time: 27.209 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   3058/  5000| tot_loss: 2.0138 | rl_loss: 0.2889 | pt_loss: 1.7248 | pg_loss: -0.0194 | reg_loss: 0.3084 | reward: -0.2126 | rev_kl: 0.8238 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.7107e-06 | scale: 256.00 | time: 27.196 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   3059/  5000| tot_loss: 2.3903 | rl_loss: 0.7663 | pt_loss: 1.6241 | pg_loss: 0.3513 | reg_loss: 0.4150 | reward: -0.4917 | rev_kl: 0.7083 | stu_lens: 64.5000 | mixed_lens: 83.5000 | lr: 1.7092e-06 | scale: 256.00 | time: 27.167 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   3060/  5000| tot_loss: 2.2650 | rl_loss: 0.3779 | pt_loss: 1.8871 | pg_loss: 0.0821 | reg_loss: 0.2958 | reward: -0.0398 | rev_kl: 0.9256 | stu_lens: 128.0000 | mixed_lens: 107.5000 | lr: 1.7077e-06 | scale: 256.00 | time: 27.230 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   3061/  5000| tot_loss: 1.9523 | rl_loss: 0.3275 | pt_loss: 1.6247 | pg_loss: 0.0189 | reg_loss: 0.3086 | reward: -0.1181 | rev_kl: 0.5697 | stu_lens: 77.5000 | mixed_lens: 122.0000 | lr: 1.7061e-06 | scale: 256.00 | time: 27.249 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   3062/  5000| tot_loss: 3.4460 | rl_loss: 1.9684 | pt_loss: 1.4776 | pg_loss: 1.2301 | reg_loss: 0.7383 | reward: -0.6364 | rev_kl: 1.5142 | stu_lens: 14.0000 | mixed_lens: 13.0000 | lr: 1.7046e-06 | scale: 256.00 | time: 27.221 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   3063/  5000| tot_loss: 2.3186 | rl_loss: 0.3300 | pt_loss: 1.9887 | pg_loss: -0.0230 | reg_loss: 0.3529 | reward: -0.0786 | rev_kl: 0.7945 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.7031e-06 | scale: 256.00 | time: 27.233 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   3064/  5000| tot_loss: 1.9119 | rl_loss: 0.3265 | pt_loss: 1.5854 | pg_loss: -0.0303 | reg_loss: 0.3569 | reward: -0.1414 | rev_kl: 0.5544 | stu_lens: 116.5000 | mixed_lens: 128.0000 | lr: 1.7016e-06 | scale: 256.00 | time: 27.203 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   3065/  5000| tot_loss: 2.5651 | rl_loss: 0.5835 | pt_loss: 1.9816 | pg_loss: 0.2892 | reg_loss: 0.2943 | reward: -0.3937 | rev_kl: 0.3084 | stu_lens: 72.5000 | mixed_lens: 70.5000 | lr: 1.7001e-06 | scale: 256.00 | time: 27.220 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   3066/  5000| tot_loss: 2.4044 | rl_loss: 0.2632 | pt_loss: 2.1412 | pg_loss: -0.0171 | reg_loss: 0.2802 | reward: -0.1728 | rev_kl: 0.7853 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.6986e-06 | scale: 256.00 | time: 27.221 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   3067/  5000| tot_loss: 2.1945 | rl_loss: 0.3465 | pt_loss: 1.8479 | pg_loss: 0.0282 | reg_loss: 0.3183 | reward: -0.1595 | rev_kl: 0.7062 | stu_lens: 96.5000 | mixed_lens: 125.0000 | lr: 1.6970e-06 | scale: 256.00 | time: 27.218 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   3068/  5000| tot_loss: 2.3087 | rl_loss: 0.7845 | pt_loss: 1.5242 | pg_loss: 0.3318 | reg_loss: 0.4527 | reward: -0.2603 | rev_kl: 0.9695 | stu_lens: 97.0000 | mixed_lens: 87.0000 | lr: 1.6955e-06 | scale: 256.00 | time: 27.237 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   3069/  5000| tot_loss: 1.5087 | rl_loss: 0.3321 | pt_loss: 1.1767 | pg_loss: 0.0065 | reg_loss: 0.3255 | reward: -0.0150 | rev_kl: 0.9598 | stu_lens: 128.0000 | mixed_lens: 126.0000 | lr: 1.6940e-06 | scale: 256.00 | time: 27.217 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   3070/  5000| tot_loss: 2.6364 | rl_loss: 0.6624 | pt_loss: 1.9740 | pg_loss: 0.2954 | reg_loss: 0.3671 | reward: -0.2400 | rev_kl: 0.6093 | stu_lens: 100.5000 | mixed_lens: 94.0000 | lr: 1.6925e-06 | scale: 256.00 | time: 27.272 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   3071/  5000| tot_loss: 2.4656 | rl_loss: 0.7633 | pt_loss: 1.7022 | pg_loss: 0.4065 | reg_loss: 0.3568 | reward: -0.3913 | rev_kl: 0.5443 | stu_lens: 76.5000 | mixed_lens: 71.5000 | lr: 1.6910e-06 | scale: 256.00 | time: 27.252 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3072/  5000| tot_loss: 1.9977 | rl_loss: 0.3661 | pt_loss: 1.6317 | pg_loss: 0.0985 | reg_loss: 0.2675 | reward: -0.2742 | rev_kl: 0.8210 | stu_lens: 128.0000 | mixed_lens: 116.0000 | lr: 1.6894e-06 | scale: 256.00 | time: 27.245 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3072/  5000| tot_loss: 2.3065 | rl_loss: 0.6226 | pt_loss: 1.6838 | pg_loss: 0.2389 | reg_loss: 0.3838 | reward: -0.2823 | rev_kl: 0.7570 | stu_lens: 92.6719 | mixed_lens: 91.2344 | lr: 1.6894e-06 | scale: 256.00 | time: 27.245 | step time: 28.454
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   3073/  5000| tot_loss: 2.5049 | rl_loss: 0.4946 | pt_loss: 2.0102 | pg_loss: 0.1759 | reg_loss: 0.3188 | reward: -0.1711 | rev_kl: 0.5575 | stu_lens: 72.5000 | mixed_lens: 100.5000 | lr: 1.6879e-06 | scale: 256.00 | time: 27.219 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   3074/  5000| tot_loss: 2.9735 | rl_loss: 0.8106 | pt_loss: 2.1630 | pg_loss: 0.0507 | reg_loss: 0.7599 | reward: -0.1970 | rev_kl: 0.8450 | stu_lens: 110.0000 | mixed_lens: 128.0000 | lr: 1.6864e-06 | scale: 256.00 | time: 27.315 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   3075/  5000| tot_loss: 2.9184 | rl_loss: 1.2123 | pt_loss: 1.7061 | pg_loss: 0.1595 | reg_loss: 1.0528 | reward: -0.2665 | rev_kl: 0.8984 | stu_lens: 119.0000 | mixed_lens: 113.5000 | lr: 1.6849e-06 | scale: 256.00 | time: 27.218 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   3076/  5000| tot_loss: 3.8677 | rl_loss: 1.0035 | pt_loss: 2.8642 | pg_loss: 0.2458 | reg_loss: 0.7577 | reward: -0.0820 | rev_kl: 0.8352 | stu_lens: 91.0000 | mixed_lens: 95.5000 | lr: 1.6834e-06 | scale: 256.00 | time: 27.229 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   3077/  5000| tot_loss: 2.7430 | rl_loss: 0.9781 | pt_loss: 1.7649 | pg_loss: 0.1779 | reg_loss: 0.8001 | reward: -0.1475 | rev_kl: 0.7120 | stu_lens: 128.0000 | mixed_lens: 109.5000 | lr: 1.6819e-06 | scale: 256.00 | time: 27.212 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   3078/  5000| tot_loss: 3.3696 | rl_loss: 1.2794 | pt_loss: 2.0902 | pg_loss: 0.4743 | reg_loss: 0.8050 | reward: -0.4127 | rev_kl: 0.3209 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 1.6804e-06 | scale: 256.00 | time: 27.209 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   3079/  5000| tot_loss: 2.5284 | rl_loss: 0.9213 | pt_loss: 1.6070 | pg_loss: 0.0528 | reg_loss: 0.8685 | reward: -0.0887 | rev_kl: 2.7690 | stu_lens: 128.0000 | mixed_lens: 126.5000 | lr: 1.6788e-06 | scale: 256.00 | time: 27.230 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   3080/  5000| tot_loss: 2.8727 | rl_loss: 1.2558 | pt_loss: 1.6170 | pg_loss: 0.2436 | reg_loss: 1.0121 | reward: -0.5685 | rev_kl: 0.8736 | stu_lens: 128.0000 | mixed_lens: 97.0000 | lr: 1.6773e-06 | scale: 256.00 | time: 27.235 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   3081/  5000| tot_loss: 2.9214 | rl_loss: 0.7904 | pt_loss: 2.1310 | pg_loss: 0.3845 | reg_loss: 0.4059 | reward: -1.6262 | rev_kl: 0.2410 | stu_lens: 66.0000 | mixed_lens: 66.5000 | lr: 1.6758e-06 | scale: 256.00 | time: 27.268 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   3082/  5000| tot_loss: 2.7115 | rl_loss: 1.2769 | pt_loss: 1.4345 | pg_loss: 0.7529 | reg_loss: 0.5240 | reward: -0.2667 | rev_kl: 0.2885 | stu_lens: 65.0000 | mixed_lens: 43.5000 | lr: 1.6743e-06 | scale: 256.00 | time: 27.225 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   3083/  5000| tot_loss: 3.0296 | rl_loss: 1.2266 | pt_loss: 1.8030 | pg_loss: 0.1417 | reg_loss: 1.0850 | reward: -0.1718 | rev_kl: 0.8736 | stu_lens: 120.0000 | mixed_lens: 110.5000 | lr: 1.6728e-06 | scale: 256.00 | time: 27.244 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   3084/  5000| tot_loss: 2.5008 | rl_loss: 0.9229 | pt_loss: 1.5779 | pg_loss: 0.2453 | reg_loss: 0.6776 | reward: -0.2146 | rev_kl: 0.9285 | stu_lens: 87.5000 | mixed_lens: 101.0000 | lr: 1.6713e-06 | scale: 256.00 | time: 27.226 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   3085/  5000| tot_loss: 2.6705 | rl_loss: 1.2024 | pt_loss: 1.4681 | pg_loss: 0.3666 | reg_loss: 0.8357 | reward: -0.3501 | rev_kl: 0.8503 | stu_lens: 90.5000 | mixed_lens: 85.5000 | lr: 1.6698e-06 | scale: 256.00 | time: 27.229 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   3086/  5000| tot_loss: 3.0253 | rl_loss: 0.9144 | pt_loss: 2.1108 | pg_loss: 0.0534 | reg_loss: 0.8610 | reward: -0.1902 | rev_kl: 0.6572 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.6683e-06 | scale: 256.00 | time: 27.228 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   3087/  5000| tot_loss: 2.2551 | rl_loss: 0.7127 | pt_loss: 1.5424 | pg_loss: 0.0424 | reg_loss: 0.6703 | reward: -0.0688 | rev_kl: 0.9058 | stu_lens: 127.5000 | mixed_lens: 128.0000 | lr: 1.6667e-06 | scale: 256.00 | time: 27.272 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3088/  5000| tot_loss: 2.6241 | rl_loss: 1.0520 | pt_loss: 1.5721 | pg_loss: 0.0355 | reg_loss: 1.0164 | reward: -0.1657 | rev_kl: 0.8998 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.6652e-06 | scale: 256.00 | time: 27.270 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3088/  5000| tot_loss: 2.9729 | rl_loss: 1.1540 | pt_loss: 1.8189 | pg_loss: 0.3575 | reg_loss: 0.7965 | reward: -0.3472 | rev_kl: 0.8013 | stu_lens: 92.5312 | mixed_lens: 90.5469 | lr: 1.6652e-06 | scale: 256.00 | time: 27.270 | step time: 28.476
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   3089/  5000| tot_loss: 2.8732 | rl_loss: 1.1247 | pt_loss: 1.7485 | pg_loss: 0.2705 | reg_loss: 0.8543 | reward: -0.2004 | rev_kl: 0.4733 | stu_lens: 128.0000 | mixed_lens: 96.5000 | lr: 1.6637e-06 | scale: 256.00 | time: 27.232 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   3090/  5000| tot_loss: 2.4854 | rl_loss: 0.5586 | pt_loss: 1.9268 | pg_loss: 0.0369 | reg_loss: 0.5217 | reward: -0.1050 | rev_kl: 0.4755 | stu_lens: 107.0000 | mixed_lens: 119.0000 | lr: 1.6622e-06 | scale: 256.00 | time: 27.233 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   3091/  5000| tot_loss: 2.6053 | rl_loss: 0.8342 | pt_loss: 1.7712 | pg_loss: 0.2794 | reg_loss: 0.5547 | reward: -0.2933 | rev_kl: 0.6043 | stu_lens: 78.0000 | mixed_lens: 78.5000 | lr: 1.6607e-06 | scale: 256.00 | time: 27.242 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   3092/  5000| tot_loss: 2.4315 | rl_loss: 0.9644 | pt_loss: 1.4672 | pg_loss: -0.0045 | reg_loss: 0.9689 | reward: -0.2216 | rev_kl: 0.7323 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.6592e-06 | scale: 256.00 | time: 27.217 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   3093/  5000| tot_loss: 2.2660 | rl_loss: 0.8203 | pt_loss: 1.4458 | pg_loss: 0.0401 | reg_loss: 0.7802 | reward: -0.1300 | rev_kl: 0.8809 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.6577e-06 | scale: 256.00 | time: 27.248 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   3094/  5000| tot_loss: 2.7447 | rl_loss: 0.9278 | pt_loss: 1.8170 | pg_loss: 0.2241 | reg_loss: 0.7037 | reward: -0.2091 | rev_kl: 0.9274 | stu_lens: 128.0000 | mixed_lens: 82.0000 | lr: 1.6562e-06 | scale: 256.00 | time: 27.242 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   3095/  5000| tot_loss: 2.5171 | rl_loss: 0.9214 | pt_loss: 1.5957 | pg_loss: 0.2545 | reg_loss: 0.6669 | reward: -0.6672 | rev_kl: 0.7411 | stu_lens: 66.0000 | mixed_lens: 70.0000 | lr: 1.6547e-06 | scale: 256.00 | time: 27.280 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   3096/  5000| tot_loss: 3.2452 | rl_loss: 1.3082 | pt_loss: 1.9370 | pg_loss: 0.6949 | reg_loss: 0.6133 | reward: -0.1941 | rev_kl: 0.3424 | stu_lens: 46.0000 | mixed_lens: 65.0000 | lr: 1.6532e-06 | scale: 256.00 | time: 27.215 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   3097/  5000| tot_loss: 2.3792 | rl_loss: 0.6795 | pt_loss: 1.6997 | pg_loss: 0.0947 | reg_loss: 0.5848 | reward: -0.1187 | rev_kl: 0.4263 | stu_lens: 128.0000 | mixed_lens: 109.5000 | lr: 1.6516e-06 | scale: 256.00 | time: 27.252 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   3098/  5000| tot_loss: 3.2438 | rl_loss: 1.3839 | pt_loss: 1.8600 | pg_loss: 0.4834 | reg_loss: 0.9004 | reward: -0.4567 | rev_kl: 1.0791 | stu_lens: 90.5000 | mixed_lens: 68.0000 | lr: 1.6501e-06 | scale: 256.00 | time: 27.209 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   3099/  5000| tot_loss: 3.8150 | rl_loss: 2.1596 | pt_loss: 1.6554 | pg_loss: 1.2086 | reg_loss: 0.9510 | reward: -0.8424 | rev_kl: 2.0065 | stu_lens: 68.5000 | mixed_lens: 30.0000 | lr: 1.6486e-06 | scale: 256.00 | time: 27.246 | step time: 0.000
                                 Evaluation #31                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son partículas            │
│                                       │ elementales que interactuan con la   │
│                                       │ materia a través de fuerzas          │
│                                       │ nucleares. Existen cuatro tipos de   │
│                                       │ cuarks:                              │
│                                       │                                      │
│                                       │ - Cuark up (cu)                      │
│                                       │ - Cuark down (cd)                    │
│                                       │ - Cuark strange (ss)                 │
│                                       │ - Cuark charm (cc)                   │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC (Instituto de Máquinas        │
│                                       │ Cósmicas) es una organización        │
│                                       │ espacial que tiene por objeto la     │
│                                       │ exploración y el estudio de las      │
│                                       │ propiedades de la energía clase S.   │
│                                       │ El IMC es el mayor centro de         │
│                                       │ investigación espacial del sistema   │
│                                       │ solar y sus posibles colonias.       │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ - Cápsula del tiempo de Jules Verne: │
│                                       │ creada en 1867, iniciando una serie  │
│                                       │ de cápsulas del tiempo de Verne.     │
│                                       │ - Cápsula del tiempo de H.G. Wells:  │
│                                       │ creada en 1895, iniciando una serie  │
│                                       │ de cápsulas del tiempo de Wells.     │
│                                       │ - Cápsula del tiempo de John W.      │
│                                       │ Campbell: creada en 1931, iniciando  │
│                                       │ una serie de cápsulas del tiempo de  │
│                                       │ Campbell.                            │
│                                       │ - Cápsula del tiempo de Philip K.    │
│                                       │ Dick: cre                            │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.207 | exact_match: 0.104 | rev_kl: 0.858 | lens: 100.287 | pt_loss: 1.728 | lm_loss: 1.857 | kd_loss: 1.598 
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   3100/  5000| tot_loss: 5.1925 | rl_loss: 3.6514 | pt_loss: 1.5412 | pg_loss: 2.7721 | reg_loss: 0.8793 | reward: -1.4127 | rev_kl: 0.4458 | stu_lens: 6.5000 | mixed_lens: 6.5000 | lr: 1.6471e-06 | scale: 256.00 | time: 27.244 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   3101/  5000| tot_loss: 2.6287 | rl_loss: 0.8348 | pt_loss: 1.7939 | pg_loss: 0.3669 | reg_loss: 0.4679 | reward: -0.5990 | rev_kl: 1.0910 | stu_lens: 74.5000 | mixed_lens: 71.0000 | lr: 1.6456e-06 | scale: 256.00 | time: 27.251 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   3102/  5000| tot_loss: 2.2569 | rl_loss: 0.6760 | pt_loss: 1.5810 | pg_loss: 0.2340 | reg_loss: 0.4420 | reward: -0.1973 | rev_kl: 0.9657 | stu_lens: 105.5000 | mixed_lens: 95.5000 | lr: 1.6441e-06 | scale: 256.00 | time: 27.225 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   3103/  5000| tot_loss: 1.8688 | rl_loss: 0.4075 | pt_loss: 1.4613 | pg_loss: 0.0126 | reg_loss: 0.3950 | reward: -0.1541 | rev_kl: 0.6511 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.6426e-06 | scale: 256.00 | time: 27.226 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3104/  5000| tot_loss: 2.5326 | rl_loss: 0.6386 | pt_loss: 1.8940 | pg_loss: -0.0252 | reg_loss: 0.6637 | reward: -0.2206 | rev_kl: 0.9846 | stu_lens: 119.0000 | mixed_lens: 128.0000 | lr: 1.6411e-06 | scale: 256.00 | time: 27.269 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3104/  5000| tot_loss: 2.6990 | rl_loss: 1.0156 | pt_loss: 1.6834 | pg_loss: 0.3480 | reg_loss: 0.6676 | reward: -0.3518 | rev_kl: 0.7615 | stu_lens: 97.6875 | mixed_lens: 90.5625 | lr: 1.6411e-06 | scale: 256.00 | time: 27.269 | step time: 28.475
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   3105/  5000| tot_loss: 2.8738 | rl_loss: 1.3677 | pt_loss: 1.5061 | pg_loss: 0.5257 | reg_loss: 0.8420 | reward: -0.3936 | rev_kl: 2.4943 | stu_lens: 65.5000 | mixed_lens: 64.0000 | lr: 1.6396e-06 | scale: 256.00 | time: 27.268 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   3106/  5000| tot_loss: 2.3957 | rl_loss: 0.6161 | pt_loss: 1.7796 | pg_loss: 0.0809 | reg_loss: 0.5352 | reward: -0.1654 | rev_kl: 0.5974 | stu_lens: 128.0000 | mixed_lens: 109.5000 | lr: 1.6381e-06 | scale: 256.00 | time: 27.264 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   3107/  5000| tot_loss: 2.7086 | rl_loss: 0.8484 | pt_loss: 1.8602 | pg_loss: 0.5587 | reg_loss: 0.2896 | reward: -0.3313 | rev_kl: 0.7459 | stu_lens: 60.0000 | mixed_lens: 54.0000 | lr: 1.6366e-06 | scale: 256.00 | time: 27.230 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   3108/  5000| tot_loss: 2.6273 | rl_loss: 0.6575 | pt_loss: 1.9698 | pg_loss: 0.1596 | reg_loss: 0.4979 | reward: -0.1449 | rev_kl: 0.7477 | stu_lens: 128.0000 | mixed_lens: 105.5000 | lr: 1.6351e-06 | scale: 256.00 | time: 27.248 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   3109/  5000| tot_loss: 2.6783 | rl_loss: 0.9505 | pt_loss: 1.7278 | pg_loss: 0.5025 | reg_loss: 0.4480 | reward: -0.6862 | rev_kl: 0.8117 | stu_lens: 33.5000 | mixed_lens: 43.0000 | lr: 1.6336e-06 | scale: 256.00 | time: 27.229 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   3110/  5000| tot_loss: 2.2421 | rl_loss: 0.3443 | pt_loss: 1.8978 | pg_loss: -0.0188 | reg_loss: 0.3632 | reward: -0.2169 | rev_kl: 0.8659 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.6321e-06 | scale: 256.00 | time: 27.258 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   3111/  5000| tot_loss: 2.1797 | rl_loss: 0.5754 | pt_loss: 1.6043 | pg_loss: 0.0730 | reg_loss: 0.5024 | reward: -0.2560 | rev_kl: 0.7714 | stu_lens: 105.5000 | mixed_lens: 102.0000 | lr: 1.6306e-06 | scale: 256.00 | time: 27.245 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   3112/  5000| tot_loss: 3.7249 | rl_loss: 2.0879 | pt_loss: 1.6370 | pg_loss: 1.3600 | reg_loss: 0.7279 | reward: -0.7859 | rev_kl: 1.5080 | stu_lens: 9.0000 | mixed_lens: 26.5000 | lr: 1.6291e-06 | scale: 256.00 | time: 27.293 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   3113/  5000| tot_loss: 1.7317 | rl_loss: 0.4002 | pt_loss: 1.3315 | pg_loss: 0.0190 | reg_loss: 0.3812 | reward: -0.1263 | rev_kl: 0.6316 | stu_lens: 115.5000 | mixed_lens: 127.0000 | lr: 1.6276e-06 | scale: 256.00 | time: 27.246 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   3114/  5000| tot_loss: 2.5876 | rl_loss: 0.6447 | pt_loss: 1.9429 | pg_loss: 0.1214 | reg_loss: 0.5234 | reward: -0.1823 | rev_kl: 0.6050 | stu_lens: 93.0000 | mixed_lens: 102.0000 | lr: 1.6261e-06 | scale: 256.00 | time: 27.260 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   3115/  5000| tot_loss: 2.1346 | rl_loss: 0.5350 | pt_loss: 1.5996 | pg_loss: 0.0131 | reg_loss: 0.5219 | reward: -0.0753 | rev_kl: 2.7467 | stu_lens: 128.0000 | mixed_lens: 126.5000 | lr: 1.6246e-06 | scale: 256.00 | time: 27.215 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   3116/  5000| tot_loss: 2.2632 | rl_loss: 0.5914 | pt_loss: 1.6718 | pg_loss: 0.1241 | reg_loss: 0.4673 | reward: -0.5553 | rev_kl: 0.8531 | stu_lens: 110.0000 | mixed_lens: 97.0000 | lr: 1.6231e-06 | scale: 256.00 | time: 27.250 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   3117/  5000| tot_loss: 1.8690 | rl_loss: 0.4164 | pt_loss: 1.4526 | pg_loss: 0.0403 | reg_loss: 0.3761 | reward: -0.0501 | rev_kl: 0.8036 | stu_lens: 128.0000 | mixed_lens: 121.5000 | lr: 1.6216e-06 | scale: 256.00 | time: 27.264 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   3118/  5000| tot_loss: 2.1993 | rl_loss: 0.4975 | pt_loss: 1.7019 | pg_loss: 0.2090 | reg_loss: 0.2885 | reward: -0.2066 | rev_kl: 0.5783 | stu_lens: 111.5000 | mixed_lens: 91.5000 | lr: 1.6201e-06 | scale: 256.00 | time: 27.274 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   3119/  5000| tot_loss: 1.7358 | rl_loss: 0.0927 | pt_loss: 1.6432 | pg_loss: -0.4033 | reg_loss: 0.4959 | reward: -0.6776 | rev_kl: 0.9874 | stu_lens: 74.5000 | mixed_lens: 25.0000 | lr: 1.6186e-06 | scale: 256.00 | time: 27.275 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3120/  5000| tot_loss: 2.4850 | rl_loss: 0.4925 | pt_loss: 1.9925 | pg_loss: 0.0239 | reg_loss: 0.4686 | reward: -0.1031 | rev_kl: 0.6451 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.6171e-06 | scale: 256.00 | time: 27.248 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3120/  5000| tot_loss: 2.4555 | rl_loss: 0.7242 | pt_loss: 1.7314 | pg_loss: 0.2454 | reg_loss: 0.4787 | reward: -0.3507 | rev_kl: 0.8644 | stu_lens: 91.4375 | mixed_lens: 87.4531 | lr: 1.6171e-06 | scale: 256.00 | time: 27.248 | step time: 28.485
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   3121/  5000| tot_loss: 1.9774 | rl_loss: 0.7041 | pt_loss: 1.2733 | pg_loss: -0.0094 | reg_loss: 0.7135 | reward: -0.2223 | rev_kl: 0.8825 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.6156e-06 | scale: 256.00 | time: 27.233 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   3122/  5000| tot_loss: 2.4291 | rl_loss: 0.5249 | pt_loss: 1.9041 | pg_loss: 0.0126 | reg_loss: 0.5124 | reward: -0.1843 | rev_kl: 0.8959 | stu_lens: 115.5000 | mixed_lens: 127.0000 | lr: 1.6141e-06 | scale: 256.00 | time: 27.238 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   3123/  5000| tot_loss: 2.2086 | rl_loss: 0.4118 | pt_loss: 1.7968 | pg_loss: 0.0086 | reg_loss: 0.4032 | reward: -0.2463 | rev_kl: 0.7962 | stu_lens: 128.0000 | mixed_lens: 50.0000 | lr: 1.6126e-06 | scale: 256.00 | time: 27.228 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   3124/  5000| tot_loss: 2.9121 | rl_loss: 1.0603 | pt_loss: 1.8518 | pg_loss: 0.5229 | reg_loss: 0.5373 | reward: -0.4964 | rev_kl: 0.5394 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 1.6111e-06 | scale: 256.00 | time: 27.259 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   3125/  5000| tot_loss: 3.5079 | rl_loss: 1.5781 | pt_loss: 1.9298 | pg_loss: 1.1782 | reg_loss: 0.3999 | reward: -0.7935 | rev_kl: 1.6113 | stu_lens: 18.5000 | mixed_lens: 24.5000 | lr: 1.6096e-06 | scale: 256.00 | time: 27.225 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   3126/  5000| tot_loss: 2.1897 | rl_loss: 0.4127 | pt_loss: 1.7769 | pg_loss: 0.0479 | reg_loss: 0.3648 | reward: -0.1318 | rev_kl: 0.6415 | stu_lens: 128.0000 | mixed_lens: 109.5000 | lr: 1.6081e-06 | scale: 256.00 | time: 27.318 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   3127/  5000| tot_loss: 2.9512 | rl_loss: 1.1182 | pt_loss: 1.8330 | pg_loss: 0.6886 | reg_loss: 0.4297 | reward: -1.0377 | rev_kl: 1.0837 | stu_lens: 74.5000 | mixed_lens: 40.0000 | lr: 1.6066e-06 | scale: 256.00 | time: 27.256 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   3128/  5000| tot_loss: 2.7479 | rl_loss: 0.7443 | pt_loss: 2.0036 | pg_loss: 0.1782 | reg_loss: 0.5661 | reward: -0.0194 | rev_kl: 0.3788 | stu_lens: 66.5000 | mixed_lens: 66.5000 | lr: 1.6051e-06 | scale: 256.00 | time: 27.252 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   3129/  5000| tot_loss: 2.4104 | rl_loss: 0.3207 | pt_loss: 2.0897 | pg_loss: -0.0228 | reg_loss: 0.3435 | reward: -0.1367 | rev_kl: 1.0330 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.6036e-06 | scale: 256.00 | time: 27.249 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   3130/  5000| tot_loss: 3.1459 | rl_loss: 1.0646 | pt_loss: 2.0813 | pg_loss: 0.6908 | reg_loss: 0.3738 | reward: -0.1612 | rev_kl: 0.4979 | stu_lens: 47.5000 | mixed_lens: 66.0000 | lr: 1.6021e-06 | scale: 256.00 | time: 27.254 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   3131/  5000| tot_loss: 2.0407 | rl_loss: 0.3434 | pt_loss: 1.6973 | pg_loss: 0.1570 | reg_loss: 0.1865 | reward: -0.1718 | rev_kl: 0.8059 | stu_lens: 93.0000 | mixed_lens: 95.5000 | lr: 1.6006e-06 | scale: 256.00 | time: 27.245 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   3132/  5000| tot_loss: 2.2892 | rl_loss: 0.6346 | pt_loss: 1.6546 | pg_loss: 0.1662 | reg_loss: 0.4684 | reward: -0.0880 | rev_kl: 0.4598 | stu_lens: 128.0000 | mixed_lens: 105.5000 | lr: 1.5991e-06 | scale: 256.00 | time: 27.283 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   3133/  5000| tot_loss: 2.3967 | rl_loss: 0.4730 | pt_loss: 1.9237 | pg_loss: 0.0974 | reg_loss: 0.3757 | reward: -0.1870 | rev_kl: 0.6582 | stu_lens: 128.0000 | mixed_lens: 113.5000 | lr: 1.5976e-06 | scale: 256.00 | time: 27.284 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   3134/  5000| tot_loss: 1.2476 | rl_loss: 0.2457 | pt_loss: 1.0019 | pg_loss: -0.0337 | reg_loss: 0.2794 | reward: -0.1728 | rev_kl: 0.6143 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.5961e-06 | scale: 256.00 | time: 27.260 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   3135/  5000| tot_loss: 2.3662 | rl_loss: 0.6670 | pt_loss: 1.6991 | pg_loss: 0.1224 | reg_loss: 0.5447 | reward: -0.2048 | rev_kl: 0.9003 | stu_lens: 128.0000 | mixed_lens: 110.5000 | lr: 1.5946e-06 | scale: 256.00 | time: 27.244 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3136/  5000| tot_loss: 2.7544 | rl_loss: 0.7210 | pt_loss: 2.0334 | pg_loss: 0.3396 | reg_loss: 0.3813 | reward: -0.3185 | rev_kl: 0.7248 | stu_lens: 68.5000 | mixed_lens: 80.5000 | lr: 1.5931e-06 | scale: 256.00 | time: 27.254 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3136/  5000| tot_loss: 2.4381 | rl_loss: 0.6366 | pt_loss: 1.8015 | pg_loss: 0.2378 | reg_loss: 0.3988 | reward: -0.3411 | rev_kl: 0.8156 | stu_lens: 97.4688 | mixed_lens: 93.0156 | lr: 1.5931e-06 | scale: 256.00 | time: 27.254 | step time: 28.486
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   3137/  5000| tot_loss: 2.1745 | rl_loss: 0.4581 | pt_loss: 1.7164 | pg_loss: 0.1122 | reg_loss: 0.3459 | reward: -0.1984 | rev_kl: 0.5974 | stu_lens: 113.0000 | mixed_lens: 101.0000 | lr: 1.5916e-06 | scale: 256.00 | time: 27.245 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   3138/  5000| tot_loss: 2.9948 | rl_loss: 1.2511 | pt_loss: 1.7436 | pg_loss: 0.4912 | reg_loss: 0.7600 | reward: -0.3582 | rev_kl: 0.5543 | stu_lens: 67.5000 | mixed_lens: 55.0000 | lr: 1.5901e-06 | scale: 256.00 | time: 27.334 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   3139/  5000| tot_loss: 2.8010 | rl_loss: 1.2438 | pt_loss: 1.5572 | pg_loss: 0.1370 | reg_loss: 1.1068 | reward: -0.1326 | rev_kl: 1.0617 | stu_lens: 78.0000 | mixed_lens: 120.0000 | lr: 1.5886e-06 | scale: 256.00 | time: 27.256 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   3140/  5000| tot_loss: 2.9610 | rl_loss: 1.0477 | pt_loss: 1.9133 | pg_loss: 0.1875 | reg_loss: 0.8602 | reward: -0.0996 | rev_kl: 0.7737 | stu_lens: 118.5000 | mixed_lens: 98.5000 | lr: 1.5871e-06 | scale: 256.00 | time: 27.248 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   3141/  5000| tot_loss: 3.2286 | rl_loss: 1.1682 | pt_loss: 2.0604 | pg_loss: 0.0660 | reg_loss: 1.1022 | reward: -0.1426 | rev_kl: 0.7471 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.5857e-06 | scale: 256.00 | time: 27.249 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   3142/  5000| tot_loss: 2.7523 | rl_loss: 1.1140 | pt_loss: 1.6383 | pg_loss: 0.0349 | reg_loss: 1.0791 | reward: -0.1401 | rev_kl: 0.8235 | stu_lens: 126.0000 | mixed_lens: 128.0000 | lr: 1.5842e-06 | scale: 256.00 | time: 27.249 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   3143/  5000| tot_loss: 3.5089 | rl_loss: 1.5767 | pt_loss: 1.9322 | pg_loss: 1.0771 | reg_loss: 0.4995 | reward: -1.5023 | rev_kl: 0.5870 | stu_lens: 46.0000 | mixed_lens: 20.0000 | lr: 1.5827e-06 | scale: 256.00 | time: 27.242 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   3144/  5000| tot_loss: 2.9733 | rl_loss: 0.9957 | pt_loss: 1.9776 | pg_loss: 0.0351 | reg_loss: 0.9606 | reward: -0.0859 | rev_kl: 0.7456 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.5812e-06 | scale: 256.00 | time: 27.287 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   3145/  5000| tot_loss: 2.8611 | rl_loss: 1.0526 | pt_loss: 1.8085 | pg_loss: 0.3006 | reg_loss: 0.7520 | reward: -0.2825 | rev_kl: 0.5706 | stu_lens: 73.0000 | mixed_lens: 90.0000 | lr: 1.5797e-06 | scale: 256.00 | time: 27.273 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   3146/  5000| tot_loss: 2.7782 | rl_loss: 1.1891 | pt_loss: 1.5891 | pg_loss: 0.3712 | reg_loss: 0.8179 | reward: -0.1040 | rev_kl: 0.6619 | stu_lens: 64.5000 | mixed_lens: 78.0000 | lr: 1.5782e-06 | scale: 256.00 | time: 27.265 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   3147/  5000| tot_loss: 2.6408 | rl_loss: 1.1699 | pt_loss: 1.4710 | pg_loss: 0.3671 | reg_loss: 0.8028 | reward: -0.3616 | rev_kl: 1.9658 | stu_lens: 73.0000 | mixed_lens: 71.5000 | lr: 1.5767e-06 | scale: 256.00 | time: 27.267 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   3148/  5000| tot_loss: 3.0043 | rl_loss: 1.3028 | pt_loss: 1.7015 | pg_loss: 0.0828 | reg_loss: 1.2200 | reward: -0.2531 | rev_kl: 1.1428 | stu_lens: 128.0000 | mixed_lens: 126.5000 | lr: 1.5752e-06 | scale: 256.00 | time: 27.255 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   3149/  5000| tot_loss: 3.0081 | rl_loss: 1.3777 | pt_loss: 1.6305 | pg_loss: 0.2382 | reg_loss: 1.1395 | reward: -0.1618 | rev_kl: 0.7286 | stu_lens: 104.5000 | mixed_lens: 106.0000 | lr: 1.5737e-06 | scale: 256.00 | time: 27.230 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   3150/  5000| tot_loss: 3.1395 | rl_loss: 1.6253 | pt_loss: 1.5141 | pg_loss: 0.4967 | reg_loss: 1.1286 | reward: -0.2371 | rev_kl: 1.0044 | stu_lens: 70.5000 | mixed_lens: 70.5000 | lr: 1.5722e-06 | scale: 256.00 | time: 27.261 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   3151/  5000| tot_loss: 3.5420 | rl_loss: 1.4523 | pt_loss: 2.0897 | pg_loss: 0.6652 | reg_loss: 0.7871 | reward: -0.2055 | rev_kl: 0.4447 | stu_lens: 70.5000 | mixed_lens: 70.5000 | lr: 1.5708e-06 | scale: 256.00 | time: 27.269 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3152/  5000| tot_loss: 3.4809 | rl_loss: 1.1926 | pt_loss: 2.2883 | pg_loss: 0.4832 | reg_loss: 0.7095 | reward: 0.0124 | rev_kl: 0.6727 | stu_lens: 63.5000 | mixed_lens: 69.0000 | lr: 1.5693e-06 | scale: 256.00 | time: 27.297 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3152/  5000| tot_loss: 2.9253 | rl_loss: 1.1608 | pt_loss: 1.7645 | pg_loss: 0.3113 | reg_loss: 0.8495 | reward: -0.1497 | rev_kl: 0.8341 | stu_lens: 95.8750 | mixed_lens: 95.7344 | lr: 1.5693e-06 | scale: 256.00 | time: 27.297 | step time: 28.501
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   3153/  5000| tot_loss: 3.1585 | rl_loss: 1.3838 | pt_loss: 1.7747 | pg_loss: 0.3028 | reg_loss: 1.0811 | reward: -0.4228 | rev_kl: 1.0108 | stu_lens: 128.0000 | mixed_lens: 98.0000 | lr: 1.5678e-06 | scale: 256.00 | time: 27.250 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   3154/  5000| tot_loss: 3.5430 | rl_loss: 1.7511 | pt_loss: 1.7919 | pg_loss: 1.3074 | reg_loss: 0.4437 | reward: 2.9020 | rev_kl: 0.3983 | stu_lens: 34.5000 | mixed_lens: 18.0000 | lr: 1.5663e-06 | scale: 256.00 | time: 27.259 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   3155/  5000| tot_loss: 3.3210 | rl_loss: 1.7341 | pt_loss: 1.5869 | pg_loss: 1.6429 | reg_loss: 0.0912 | reward: -1.4729 | rev_kl: 0.7750 | stu_lens: 39.5000 | mixed_lens: 8.5000 | lr: 1.5648e-06 | scale: 256.00 | time: 27.223 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   3156/  5000| tot_loss: 3.4292 | rl_loss: 1.6306 | pt_loss: 1.7987 | pg_loss: 0.4761 | reg_loss: 1.1544 | reward: -0.4810 | rev_kl: 1.1630 | stu_lens: 111.5000 | mixed_lens: 68.0000 | lr: 1.5633e-06 | scale: 256.00 | time: 27.251 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   3157/  5000| tot_loss: 2.7268 | rl_loss: 1.2568 | pt_loss: 1.4700 | pg_loss: 0.2935 | reg_loss: 0.9633 | reward: -0.3927 | rev_kl: 0.8833 | stu_lens: 91.5000 | mixed_lens: 88.5000 | lr: 1.5618e-06 | scale: 256.00 | time: 27.270 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   3158/  5000| tot_loss: 2.9050 | rl_loss: 0.9014 | pt_loss: 2.0036 | pg_loss: 0.0541 | reg_loss: 0.8473 | reward: -0.1330 | rev_kl: 0.7015 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.5603e-06 | scale: 256.00 | time: 27.290 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   3159/  5000| tot_loss: 2.1555 | rl_loss: 0.4072 | pt_loss: 1.7484 | pg_loss: 0.0540 | reg_loss: 0.3532 | reward: 0.0062 | rev_kl: 0.5686 | stu_lens: 77.5000 | mixed_lens: 98.5000 | lr: 1.5589e-06 | scale: 256.00 | time: 27.288 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   3160/  5000| tot_loss: 2.9966 | rl_loss: 1.2561 | pt_loss: 1.7405 | pg_loss: 0.4788 | reg_loss: 0.7773 | reward: -0.2381 | rev_kl: 1.8032 | stu_lens: 49.5000 | mixed_lens: 62.5000 | lr: 1.5574e-06 | scale: 256.00 | time: 27.270 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   3161/  5000| tot_loss: 1.9564 | rl_loss: 0.6056 | pt_loss: 1.3508 | pg_loss: 0.0314 | reg_loss: 0.5742 | reward: -0.1181 | rev_kl: 0.6191 | stu_lens: 122.0000 | mixed_lens: 122.5000 | lr: 1.5559e-06 | scale: 256.00 | time: 27.230 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   3162/  5000| tot_loss: 2.4128 | rl_loss: 0.7512 | pt_loss: 1.6616 | pg_loss: 0.0834 | reg_loss: 0.6678 | reward: -0.1059 | rev_kl: 0.8529 | stu_lens: 113.5000 | mixed_lens: 120.0000 | lr: 1.5544e-06 | scale: 256.00 | time: 27.250 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   3163/  5000| tot_loss: 2.9036 | rl_loss: 0.6737 | pt_loss: 2.2299 | pg_loss: -0.0116 | reg_loss: 0.6853 | reward: -0.0698 | rev_kl: 0.6204 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.5529e-06 | scale: 256.00 | time: 27.234 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   3164/  5000| tot_loss: 3.0419 | rl_loss: 1.3707 | pt_loss: 1.6711 | pg_loss: 0.6822 | reg_loss: 0.6885 | reward: -0.5673 | rev_kl: 1.8140 | stu_lens: 55.5000 | mixed_lens: 51.5000 | lr: 1.5514e-06 | scale: 256.00 | time: 27.270 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   3165/  5000| tot_loss: 1.5701 | rl_loss: 0.6705 | pt_loss: 0.8996 | pg_loss: -0.0049 | reg_loss: 0.6753 | reward: -0.0912 | rev_kl: 0.8412 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.5500e-06 | scale: 256.00 | time: 27.268 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   3166/  5000| tot_loss: 2.9924 | rl_loss: 0.9785 | pt_loss: 2.0140 | pg_loss: 0.1665 | reg_loss: 0.8120 | reward: -0.1633 | rev_kl: 0.8492 | stu_lens: 97.0000 | mixed_lens: 102.5000 | lr: 1.5485e-06 | scale: 256.00 | time: 27.319 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   3167/  5000| tot_loss: 3.3592 | rl_loss: 1.1417 | pt_loss: 2.2176 | pg_loss: 0.4885 | reg_loss: 0.6532 | reward: -0.1925 | rev_kl: 0.5053 | stu_lens: 72.0000 | mixed_lens: 70.5000 | lr: 1.5470e-06 | scale: 256.00 | time: 27.242 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3168/  5000| tot_loss: 2.2152 | rl_loss: 0.5664 | pt_loss: 1.6487 | pg_loss: 0.0049 | reg_loss: 0.5615 | reward: -0.2921 | rev_kl: 0.6724 | stu_lens: 128.0000 | mixed_lens: 124.5000 | lr: 1.5455e-06 | scale: 256.00 | time: 27.276 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3168/  5000| tot_loss: 2.6975 | rl_loss: 0.9582 | pt_loss: 1.7393 | pg_loss: 0.2523 | reg_loss: 0.7059 | reward: -0.1530 | rev_kl: 0.8308 | stu_lens: 99.2812 | mixed_lens: 97.1250 | lr: 1.5455e-06 | scale: 256.00 | time: 27.276 | step time: 28.498
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   3169/  5000| tot_loss: 2.7713 | rl_loss: 0.7012 | pt_loss: 2.0701 | pg_loss: 0.4150 | reg_loss: 0.2862 | reward: -0.1018 | rev_kl: 0.7252 | stu_lens: 110.0000 | mixed_lens: 77.5000 | lr: 1.5440e-06 | scale: 256.00 | time: 27.231 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   3170/  5000| tot_loss: 2.6355 | rl_loss: 0.8762 | pt_loss: 1.7593 | pg_loss: 0.2524 | reg_loss: 0.6238 | reward: -0.3693 | rev_kl: 0.9071 | stu_lens: 92.5000 | mixed_lens: 88.0000 | lr: 1.5426e-06 | scale: 256.00 | time: 27.285 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   3171/  5000| tot_loss: 2.2932 | rl_loss: 0.5643 | pt_loss: 1.7288 | pg_loss: -0.0221 | reg_loss: 0.5865 | reward: -0.0207 | rev_kl: 0.6625 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.5411e-06 | scale: 256.00 | time: 27.254 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   3172/  5000| tot_loss: 2.0818 | rl_loss: 0.5807 | pt_loss: 1.5011 | pg_loss: 0.2775 | reg_loss: 0.3032 | reward: -0.0876 | rev_kl: 0.4941 | stu_lens: 62.5000 | mixed_lens: 66.5000 | lr: 1.5396e-06 | scale: 256.00 | time: 27.288 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   3173/  5000| tot_loss: 2.4437 | rl_loss: 0.7325 | pt_loss: 1.7112 | pg_loss: 0.2862 | reg_loss: 0.4463 | reward: -0.3181 | rev_kl: 0.6255 | stu_lens: 66.0000 | mixed_lens: 85.0000 | lr: 1.5381e-06 | scale: 256.00 | time: 27.282 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   3174/  5000| tot_loss: 2.3349 | rl_loss: 0.5240 | pt_loss: 1.8110 | pg_loss: 0.0451 | reg_loss: 0.4788 | reward: -0.1080 | rev_kl: 0.8168 | stu_lens: 111.5000 | mixed_lens: 92.5000 | lr: 1.5366e-06 | scale: 256.00 | time: 27.259 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   3175/  5000| tot_loss: 2.3834 | rl_loss: 0.5592 | pt_loss: 1.8242 | pg_loss: 0.0094 | reg_loss: 0.5498 | reward: -0.1074 | rev_kl: 0.6307 | stu_lens: 109.5000 | mixed_lens: 128.0000 | lr: 1.5352e-06 | scale: 256.00 | time: 27.230 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   3176/  5000| tot_loss: 2.5732 | rl_loss: 0.4962 | pt_loss: 2.0771 | pg_loss: 0.0550 | reg_loss: 0.4412 | reward: -0.2310 | rev_kl: 0.7939 | stu_lens: 104.5000 | mixed_lens: 119.0000 | lr: 1.5337e-06 | scale: 256.00 | time: 27.253 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   3177/  5000| tot_loss: 2.9136 | rl_loss: 1.6497 | pt_loss: 1.2639 | pg_loss: 0.9092 | reg_loss: 0.7406 | reward: -0.0916 | rev_kl: 0.7673 | stu_lens: 78.0000 | mixed_lens: 56.0000 | lr: 1.5322e-06 | scale: 256.00 | time: 27.238 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   3178/  5000| tot_loss: 1.9364 | rl_loss: 0.5349 | pt_loss: 1.4015 | pg_loss: -0.0245 | reg_loss: 0.5594 | reward: -0.2110 | rev_kl: 0.8989 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.5307e-06 | scale: 256.00 | time: 27.288 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   3179/  5000| tot_loss: 1.7617 | rl_loss: 0.4943 | pt_loss: 1.2674 | pg_loss: -0.0105 | reg_loss: 0.5048 | reward: -0.2751 | rev_kl: 0.6971 | stu_lens: 128.0000 | mixed_lens: 124.5000 | lr: 1.5292e-06 | scale: 256.00 | time: 27.282 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   3180/  5000| tot_loss: 2.7351 | rl_loss: 0.7691 | pt_loss: 1.9660 | pg_loss: 0.2329 | reg_loss: 0.5363 | reward: -0.5017 | rev_kl: 1.0726 | stu_lens: 128.0000 | mixed_lens: 103.5000 | lr: 1.5278e-06 | scale: 256.00 | time: 27.313 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   3181/  5000| tot_loss: 2.6681 | rl_loss: 0.8324 | pt_loss: 1.8357 | pg_loss: 0.3133 | reg_loss: 0.5191 | reward: -0.1015 | rev_kl: 0.8242 | stu_lens: 128.0000 | mixed_lens: 92.5000 | lr: 1.5263e-06 | scale: 256.00 | time: 27.242 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   3182/  5000| tot_loss: 2.2598 | rl_loss: 1.0653 | pt_loss: 1.1945 | pg_loss: 0.5908 | reg_loss: 0.4744 | reward: -0.2859 | rev_kl: 0.9488 | stu_lens: 54.5000 | mixed_lens: 67.0000 | lr: 1.5248e-06 | scale: 256.00 | time: 27.253 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   3183/  5000| tot_loss: 2.4680 | rl_loss: 0.6599 | pt_loss: 1.8080 | pg_loss: 0.2281 | reg_loss: 0.4318 | reward: -0.1169 | rev_kl: 0.7280 | stu_lens: 104.0000 | mixed_lens: 63.5000 | lr: 1.5233e-06 | scale: 256.00 | time: 27.238 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3184/  5000| tot_loss: 3.0248 | rl_loss: 0.6480 | pt_loss: 2.3769 | pg_loss: 0.0174 | reg_loss: 0.6306 | reward: -0.2783 | rev_kl: 0.8644 | stu_lens: 128.0000 | mixed_lens: 126.5000 | lr: 1.5219e-06 | scale: 256.00 | time: 27.266 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3184/  5000| tot_loss: 2.4183 | rl_loss: 0.7284 | pt_loss: 1.6899 | pg_loss: 0.2310 | reg_loss: 0.4974 | reward: -0.1400 | rev_kl: 0.8376 | stu_lens: 95.1719 | mixed_lens: 93.2344 | lr: 1.5219e-06 | scale: 256.00 | time: 27.266 | step time: 28.499
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   3185/  5000| tot_loss: 2.6440 | rl_loss: 0.8528 | pt_loss: 1.7913 | pg_loss: 0.3407 | reg_loss: 0.5120 | reward: -0.3722 | rev_kl: 1.6984 | stu_lens: 91.0000 | mixed_lens: 91.5000 | lr: 1.5204e-06 | scale: 256.00 | time: 27.260 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   3186/  5000| tot_loss: 2.3106 | rl_loss: 0.6379 | pt_loss: 1.6728 | pg_loss: 0.0186 | reg_loss: 0.6192 | reward: -0.1220 | rev_kl: 0.8496 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.5189e-06 | scale: 256.00 | time: 27.303 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   3187/  5000| tot_loss: 2.0824 | rl_loss: 0.6435 | pt_loss: 1.4389 | pg_loss: 0.2311 | reg_loss: 0.4124 | reward: -0.0873 | rev_kl: 0.6777 | stu_lens: 95.0000 | mixed_lens: 89.5000 | lr: 1.5174e-06 | scale: 256.00 | time: 27.252 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   3188/  5000| tot_loss: 2.2833 | rl_loss: 0.3091 | pt_loss: 1.9742 | pg_loss: 0.0630 | reg_loss: 0.2461 | reward: -0.5354 | rev_kl: 0.7815 | stu_lens: 128.0000 | mixed_lens: 86.5000 | lr: 1.5160e-06 | scale: 256.00 | time: 27.281 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   3189/  5000| tot_loss: 2.6078 | rl_loss: 0.8674 | pt_loss: 1.7404 | pg_loss: 0.2895 | reg_loss: 0.5779 | reward: -0.0259 | rev_kl: 0.7243 | stu_lens: 78.0000 | mixed_lens: 69.0000 | lr: 1.5145e-06 | scale: 256.00 | time: 27.250 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   3190/  5000| tot_loss: 2.7225 | rl_loss: 0.5408 | pt_loss: 2.1817 | pg_loss: 0.1153 | reg_loss: 0.4254 | reward: -0.2874 | rev_kl: 0.7707 | stu_lens: 67.5000 | mixed_lens: 85.0000 | lr: 1.5130e-06 | scale: 256.00 | time: 27.262 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   3191/  5000| tot_loss: 3.6543 | rl_loss: 1.5065 | pt_loss: 2.1478 | pg_loss: 1.0708 | reg_loss: 0.4357 | reward: -0.3161 | rev_kl: 0.6617 | stu_lens: 49.0000 | mixed_lens: 40.5000 | lr: 1.5115e-06 | scale: 256.00 | time: 27.250 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   3192/  5000| tot_loss: 2.4301 | rl_loss: 0.5675 | pt_loss: 1.8626 | pg_loss: -0.0273 | reg_loss: 0.5948 | reward: -0.3217 | rev_kl: 0.9785 | stu_lens: 126.0000 | mixed_lens: 126.5000 | lr: 1.5101e-06 | scale: 256.00 | time: 27.294 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   3193/  5000| tot_loss: 2.5643 | rl_loss: 0.8925 | pt_loss: 1.6718 | pg_loss: 0.3930 | reg_loss: 0.4995 | reward: -0.0794 | rev_kl: 0.7797 | stu_lens: 104.0000 | mixed_lens: 64.0000 | lr: 1.5086e-06 | scale: 256.00 | time: 27.282 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   3194/  5000| tot_loss: 2.2621 | rl_loss: 0.6139 | pt_loss: 1.6482 | pg_loss: 0.1519 | reg_loss: 0.4620 | reward: -0.2289 | rev_kl: 0.6896 | stu_lens: 118.0000 | mixed_lens: 98.0000 | lr: 1.5071e-06 | scale: 256.00 | time: 27.260 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   3195/  5000| tot_loss: 2.1957 | rl_loss: 0.3699 | pt_loss: 1.8258 | pg_loss: 0.0014 | reg_loss: 0.3685 | reward: -0.1749 | rev_kl: 0.7689 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.5057e-06 | scale: 256.00 | time: 27.251 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   3196/  5000| tot_loss: 1.7167 | rl_loss: 0.3220 | pt_loss: 1.3947 | pg_loss: -0.0269 | reg_loss: 0.3489 | reward: -0.2228 | rev_kl: 0.9009 | stu_lens: 93.0000 | mixed_lens: 128.0000 | lr: 1.5042e-06 | scale: 256.00 | time: 27.268 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   3197/  5000| tot_loss: 2.1018 | rl_loss: 0.6091 | pt_loss: 1.4927 | pg_loss: 0.1941 | reg_loss: 0.4150 | reward: -0.1022 | rev_kl: 0.7614 | stu_lens: 97.0000 | mixed_lens: 92.5000 | lr: 1.5027e-06 | scale: 256.00 | time: 27.248 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   3198/  5000| tot_loss: 1.4068 | rl_loss: 0.3097 | pt_loss: 1.0971 | pg_loss: -0.0165 | reg_loss: 0.3262 | reward: -0.1258 | rev_kl: 0.8511 | stu_lens: 126.5000 | mixed_lens: 128.0000 | lr: 1.5012e-06 | scale: 256.00 | time: 27.311 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   3199/  5000| tot_loss: 2.4393 | rl_loss: 0.6067 | pt_loss: 1.8326 | pg_loss: 0.1959 | reg_loss: 0.4108 | reward: -1.5635 | rev_kl: 0.8831 | stu_lens: 73.5000 | mixed_lens: 64.0000 | lr: 1.4998e-06 | scale: 256.00 | time: 27.280 | step time: 0.000
                                 Evaluation #32                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks son los elementos básicos │
│                                       │ de la física de partículas. Existen  │
│                                       │ seis tipos de cuarks:                │
│                                       │                                      │
│                                       │ - Cuark arriba (u)                   │
│                                       │ - Cuark abajo (d)                    │
│                                       │ - Cuark escalón (s)                  │
│                                       │ - Cuark pareja (c)                   │
│                                       │ - Cuark pesado (b)                   │
│                                       │ - Cuark ligero (t)                   │
│                                       │                                      │
│                                       │ Los seis tipos de cuarks están       │
│                                       │ sujetos a las siguientes condiciones │
│                                       │ de conservación:                     │
│                                       │                                      │
│                                       │ - Conservación de la energía         │
│                                       │ - Conservación de la masa            │
│                                       │ - Conservación de la                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC o Interactive Media Coalition │
│                                       │ es un primer sistema de referencia   │
│                                       │ que indica qué médias están          │
│                                       │ disponibles para una organización y  │
│                                       │ cuál es su calidad. El IMC se basa   │
│                                       │ en una estructura de índices que     │
│                                       │ sirven para ordenar y descubrir los  │
│                                       │ medios disponibles para una          │
│                                       │ organización. Por ejemplo, el IMC    │
│                                       │ contiene índices para medios de      │
│                                       │ comunicación, información,           │
│                                       │ publicidad, entretenimiento,         │
│                                       │ according to their quality. The IMC  │
│                                       │ can be used to identify the most     │
│                                       │ suitable media for a particular      │
│                                       │ objective, and to compare different  │
│                                       │ media options.                       │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ La lista de cápsulas del tiempo más  │
│                                       │ famosas de la historia es la         │
│                                       │ siguiente:                           │
│                                       │                                      │
│                                       │ - Cápsula del tiempo de Duke         │
│                                       │ University, creada en 1939 y abierta │
│                                       │ en 1942, contenía un informe         │
│                                       │ detallado de los acontecimientos     │
│                                       │ globales entre 1939 y 1942.          │
│                                       │ - Cápsula del tiempo de la NASA,     │
│                                       │ creada en 1962 y abierta en 1970,    │
│                                       │ contenía un relato detallado de los  │
│                                       │ eventos más destacados de la         │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.318 | exact_match: 0.000 | rev_kl: 0.824 | lens: 99.848 | pt_loss: 1.726 | lm_loss: 1.856 | kd_loss: 1.597 
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3200/  5000| tot_loss: 2.5146 | rl_loss: 0.4147 | pt_loss: 2.0998 | pg_loss: 0.0082 | reg_loss: 0.4066 | reward: -0.1455 | rev_kl: 0.8377 | stu_lens: 128.0000 | mixed_lens: 124.5000 | lr: 1.4983e-06 | scale: 256.00 | time: 27.330 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3200/  5000| tot_loss: 2.2577 | rl_loss: 0.5689 | pt_loss: 1.6887 | pg_loss: 0.1551 | reg_loss: 0.4139 | reward: -0.1527 | rev_kl: 0.8709 | stu_lens: 99.3125 | mixed_lens: 96.4844 | lr: 1.4983e-06 | scale: 256.00 | time: 27.330 | step time: 28.510
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   3201/  5000| tot_loss: 2.9564 | rl_loss: 0.9143 | pt_loss: 2.0421 | pg_loss: 0.4486 | reg_loss: 0.4657 | reward: -0.2427 | rev_kl: 1.0135 | stu_lens: 20.5000 | mixed_lens: 70.5000 | lr: 1.4968e-06 | scale: 256.00 | time: 27.334 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   3202/  5000| tot_loss: 2.3593 | rl_loss: 1.1042 | pt_loss: 1.2551 | pg_loss: 0.2517 | reg_loss: 0.8524 | reward: -0.2488 | rev_kl: 0.5295 | stu_lens: 92.5000 | mixed_lens: 102.5000 | lr: 1.4954e-06 | scale: 256.00 | time: 27.321 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   3203/  5000| tot_loss: 2.8169 | rl_loss: 1.0028 | pt_loss: 1.8141 | pg_loss: 0.0930 | reg_loss: 0.9099 | reward: -0.1499 | rev_kl: 1.0226 | stu_lens: 128.0000 | mixed_lens: 122.5000 | lr: 1.4939e-06 | scale: 256.00 | time: 27.273 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   3204/  5000| tot_loss: 2.5571 | rl_loss: 1.0630 | pt_loss: 1.4941 | pg_loss: 0.0588 | reg_loss: 1.0042 | reward: -0.0350 | rev_kl: 0.8649 | stu_lens: 127.5000 | mixed_lens: 128.0000 | lr: 1.4924e-06 | scale: 256.00 | time: 27.287 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   3205/  5000| tot_loss: 3.0060 | rl_loss: 1.2003 | pt_loss: 1.8056 | pg_loss: 0.1600 | reg_loss: 1.0403 | reward: -0.0649 | rev_kl: 0.8970 | stu_lens: 108.0000 | mixed_lens: 106.5000 | lr: 1.4910e-06 | scale: 256.00 | time: 27.243 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   3206/  5000| tot_loss: 3.4488 | rl_loss: 1.6967 | pt_loss: 1.7520 | pg_loss: 0.9379 | reg_loss: 0.7588 | reward: -0.6152 | rev_kl: 0.6770 | stu_lens: 20.0000 | mixed_lens: 36.5000 | lr: 1.4895e-06 | scale: 256.00 | time: 27.272 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   3207/  5000| tot_loss: 2.6239 | rl_loss: 1.1732 | pt_loss: 1.4507 | pg_loss: 0.1614 | reg_loss: 1.0118 | reward: -0.1056 | rev_kl: 0.7261 | stu_lens: 108.0000 | mixed_lens: 108.5000 | lr: 1.4880e-06 | scale: 256.00 | time: 27.261 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   3208/  5000| tot_loss: 3.3027 | rl_loss: 1.1614 | pt_loss: 2.1413 | pg_loss: 0.4336 | reg_loss: 0.7277 | reward: -0.3988 | rev_kl: 0.5202 | stu_lens: 76.5000 | mixed_lens: 70.5000 | lr: 1.4866e-06 | scale: 256.00 | time: 27.289 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   3209/  5000| tot_loss: 2.1884 | rl_loss: 0.9327 | pt_loss: 1.2556 | pg_loss: 0.1071 | reg_loss: 0.8256 | reward: -0.1368 | rev_kl: 0.7559 | stu_lens: 94.0000 | mixed_lens: 111.0000 | lr: 1.4851e-06 | scale: 256.00 | time: 27.300 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   3210/  5000| tot_loss: 3.1442 | rl_loss: 1.3445 | pt_loss: 1.7997 | pg_loss: 0.4519 | reg_loss: 0.8926 | reward: 0.6573 | rev_kl: 0.5679 | stu_lens: 68.5000 | mixed_lens: 56.0000 | lr: 1.4836e-06 | scale: 256.00 | time: 27.273 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   3211/  5000| tot_loss: 3.1475 | rl_loss: 1.1877 | pt_loss: 1.9599 | pg_loss: 0.1717 | reg_loss: 1.0159 | reward: -0.0613 | rev_kl: 1.1571 | stu_lens: 101.5000 | mixed_lens: 109.5000 | lr: 1.4822e-06 | scale: 256.00 | time: 27.254 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   3212/  5000| tot_loss: 3.0169 | rl_loss: 1.3343 | pt_loss: 1.6827 | pg_loss: 0.0697 | reg_loss: 1.2646 | reward: -0.1105 | rev_kl: 1.2090 | stu_lens: 90.0000 | mixed_lens: 128.0000 | lr: 1.4807e-06 | scale: 256.00 | time: 27.262 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   3213/  5000| tot_loss: 2.1965 | rl_loss: 0.8002 | pt_loss: 1.3963 | pg_loss: 0.1086 | reg_loss: 0.6916 | reward: -0.1503 | rev_kl: 0.6181 | stu_lens: 128.0000 | mixed_lens: 110.0000 | lr: 1.4793e-06 | scale: 256.00 | time: 27.253 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   3214/  5000| tot_loss: 2.9701 | rl_loss: 1.4306 | pt_loss: 1.5395 | pg_loss: 0.3476 | reg_loss: 1.0830 | reward: -0.1340 | rev_kl: 0.9078 | stu_lens: 128.0000 | mixed_lens: 94.0000 | lr: 1.4778e-06 | scale: 256.00 | time: 27.267 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   3215/  5000| tot_loss: 2.5366 | rl_loss: 1.1678 | pt_loss: 1.3688 | pg_loss: 0.5976 | reg_loss: 0.5703 | reward: -0.3800 | rev_kl: 0.4538 | stu_lens: 71.0000 | mixed_lens: 30.5000 | lr: 1.4763e-06 | scale: 256.00 | time: 27.299 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3216/  5000| tot_loss: 3.0464 | rl_loss: 1.0405 | pt_loss: 2.0059 | pg_loss: 0.0387 | reg_loss: 1.0018 | reward: -0.1387 | rev_kl: 0.7324 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4749e-06 | scale: 256.00 | time: 27.317 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3216/  5000| tot_loss: 2.8323 | rl_loss: 1.1225 | pt_loss: 1.7099 | pg_loss: 0.2636 | reg_loss: 0.8588 | reward: -0.2349 | rev_kl: 0.7891 | stu_lens: 99.5156 | mixed_lens: 95.3281 | lr: 1.4749e-06 | scale: 256.00 | time: 27.317 | step time: 28.514
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   3217/  5000| tot_loss: 2.7329 | rl_loss: 1.0296 | pt_loss: 1.7033 | pg_loss: 0.1650 | reg_loss: 0.8646 | reward: -0.2658 | rev_kl: 0.7849 | stu_lens: 83.0000 | mixed_lens: 107.0000 | lr: 1.4734e-06 | scale: 256.00 | time: 27.269 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   3218/  5000| tot_loss: 1.9830 | rl_loss: 0.8510 | pt_loss: 1.1320 | pg_loss: 0.3569 | reg_loss: 0.4941 | reward: -0.4107 | rev_kl: 0.6109 | stu_lens: 76.5000 | mixed_lens: 70.5000 | lr: 1.4719e-06 | scale: 256.00 | time: 27.282 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   3219/  5000| tot_loss: 2.4356 | rl_loss: 0.7496 | pt_loss: 1.6860 | pg_loss: 0.0108 | reg_loss: 0.7389 | reward: -0.1037 | rev_kl: 1.0674 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4705e-06 | scale: 256.00 | time: 27.242 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   3220/  5000| tot_loss: 2.5504 | rl_loss: 0.8076 | pt_loss: 1.7427 | pg_loss: 0.0882 | reg_loss: 0.7195 | reward: -0.1624 | rev_kl: 0.8869 | stu_lens: 128.0000 | mixed_lens: 112.0000 | lr: 1.4690e-06 | scale: 256.00 | time: 27.281 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   3221/  5000| tot_loss: 2.3111 | rl_loss: 0.5311 | pt_loss: 1.7800 | pg_loss: 0.0102 | reg_loss: 0.5210 | reward: -0.1337 | rev_kl: 0.7355 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4676e-06 | scale: 256.00 | time: 27.272 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   3222/  5000| tot_loss: 2.1850 | rl_loss: 0.6983 | pt_loss: 1.4867 | pg_loss: 0.1846 | reg_loss: 0.5136 | reward: -0.2656 | rev_kl: 0.5164 | stu_lens: 92.5000 | mixed_lens: 102.5000 | lr: 1.4661e-06 | scale: 256.00 | time: 27.319 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   3223/  5000| tot_loss: 2.3281 | rl_loss: 0.7267 | pt_loss: 1.6014 | pg_loss: 0.0812 | reg_loss: 0.6456 | reward: -0.0716 | rev_kl: 0.7126 | stu_lens: 83.5000 | mixed_lens: 62.5000 | lr: 1.4646e-06 | scale: 256.00 | time: 27.275 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   3224/  5000| tot_loss: 2.7807 | rl_loss: 0.9003 | pt_loss: 1.8804 | pg_loss: 0.0505 | reg_loss: 0.8497 | reward: -0.0666 | rev_kl: 0.5428 | stu_lens: 94.0000 | mixed_lens: 111.0000 | lr: 1.4632e-06 | scale: 256.00 | time: 27.293 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   3225/  5000| tot_loss: 2.7400 | rl_loss: 0.8684 | pt_loss: 1.8717 | pg_loss: 0.0721 | reg_loss: 0.7962 | reward: -0.1534 | rev_kl: 0.5777 | stu_lens: 108.0000 | mixed_lens: 108.5000 | lr: 1.4617e-06 | scale: 256.00 | time: 27.250 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   3226/  5000| tot_loss: 2.8695 | rl_loss: 0.9806 | pt_loss: 1.8889 | pg_loss: 0.2022 | reg_loss: 0.7784 | reward: -0.1973 | rev_kl: 0.7898 | stu_lens: 128.0000 | mixed_lens: 105.5000 | lr: 1.4603e-06 | scale: 256.00 | time: 27.277 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   3227/  5000| tot_loss: 2.7094 | rl_loss: 0.7134 | pt_loss: 1.9960 | pg_loss: 0.0038 | reg_loss: 0.7096 | reward: -0.1185 | rev_kl: 1.4505 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4588e-06 | scale: 256.00 | time: 27.266 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   3228/  5000| tot_loss: 3.1305 | rl_loss: 1.1676 | pt_loss: 1.9629 | pg_loss: 0.3842 | reg_loss: 0.7834 | reward: -0.2144 | rev_kl: 0.2520 | stu_lens: 66.5000 | mixed_lens: 58.5000 | lr: 1.4574e-06 | scale: 256.00 | time: 27.307 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   3229/  5000| tot_loss: 3.1484 | rl_loss: 1.2259 | pt_loss: 1.9225 | pg_loss: 0.3940 | reg_loss: 0.8319 | reward: -0.5126 | rev_kl: 0.5438 | stu_lens: 67.0000 | mixed_lens: 67.0000 | lr: 1.4559e-06 | scale: 256.00 | time: 27.303 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   3230/  5000| tot_loss: 2.6767 | rl_loss: 0.6783 | pt_loss: 1.9984 | pg_loss: 0.0723 | reg_loss: 0.6060 | reward: -0.1210 | rev_kl: 0.8162 | stu_lens: 127.5000 | mixed_lens: 115.0000 | lr: 1.4544e-06 | scale: 256.00 | time: 27.304 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   3231/  5000| tot_loss: 2.7049 | rl_loss: 0.9425 | pt_loss: 1.7623 | pg_loss: 0.1429 | reg_loss: 0.7996 | reward: -0.0613 | rev_kl: 1.1571 | stu_lens: 101.5000 | mixed_lens: 109.5000 | lr: 1.4530e-06 | scale: 256.00 | time: 27.263 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3232/  5000| tot_loss: 2.9243 | rl_loss: 0.9566 | pt_loss: 1.9677 | pg_loss: 0.3357 | reg_loss: 0.6209 | reward: -0.2299 | rev_kl: 1.3501 | stu_lens: 81.0000 | mixed_lens: 97.5000 | lr: 1.4515e-06 | scale: 256.00 | time: 27.268 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3232/  5000| tot_loss: 2.6639 | rl_loss: 0.8865 | pt_loss: 1.7774 | pg_loss: 0.2063 | reg_loss: 0.6802 | reward: -0.2353 | rev_kl: 0.7586 | stu_lens: 100.2656 | mixed_lens: 96.3750 | lr: 1.4515e-06 | scale: 256.00 | time: 27.268 | step time: 28.510
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   3233/  5000| tot_loss: 2.4535 | rl_loss: 0.8733 | pt_loss: 1.5802 | pg_loss: 0.1641 | reg_loss: 0.7092 | reward: -0.2832 | rev_kl: 0.7902 | stu_lens: 94.0000 | mixed_lens: 101.0000 | lr: 1.4501e-06 | scale: 256.00 | time: 27.264 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   3234/  5000| tot_loss: 2.0442 | rl_loss: 0.7103 | pt_loss: 1.3339 | pg_loss: 0.0303 | reg_loss: 0.6800 | reward: -0.2478 | rev_kl: 0.6053 | stu_lens: 123.5000 | mixed_lens: 115.5000 | lr: 1.4486e-06 | scale: 256.00 | time: 27.320 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   3235/  5000| tot_loss: 2.3210 | rl_loss: 0.8310 | pt_loss: 1.4900 | pg_loss: 0.4543 | reg_loss: 0.3766 | reward: -0.0285 | rev_kl: 0.4806 | stu_lens: 71.0000 | mixed_lens: 71.0000 | lr: 1.4472e-06 | scale: 256.00 | time: 27.307 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   3236/  5000| tot_loss: 2.2823 | rl_loss: 0.4602 | pt_loss: 1.8221 | pg_loss: -0.0030 | reg_loss: 0.4632 | reward: -0.0934 | rev_kl: 0.9325 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4457e-06 | scale: 256.00 | time: 27.276 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   3237/  5000| tot_loss: 2.1428 | rl_loss: 0.3692 | pt_loss: 1.7736 | pg_loss: -0.0138 | reg_loss: 0.3830 | reward: -0.0821 | rev_kl: 0.6063 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4443e-06 | scale: 256.00 | time: 27.285 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   3238/  5000| tot_loss: 2.4910 | rl_loss: 0.7837 | pt_loss: 1.7073 | pg_loss: 0.3031 | reg_loss: 0.4806 | reward: -0.5299 | rev_kl: 0.6578 | stu_lens: 67.0000 | mixed_lens: 51.0000 | lr: 1.4428e-06 | scale: 256.00 | time: 27.272 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   3239/  5000| tot_loss: 2.3970 | rl_loss: 0.9560 | pt_loss: 1.4410 | pg_loss: 0.3630 | reg_loss: 0.5930 | reward: -2.4247 | rev_kl: 1.4497 | stu_lens: 67.5000 | mixed_lens: 66.5000 | lr: 1.4414e-06 | scale: 256.00 | time: 27.259 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   3240/  5000| tot_loss: 2.4043 | rl_loss: 0.5857 | pt_loss: 1.8186 | pg_loss: -0.0027 | reg_loss: 0.5884 | reward: -0.1412 | rev_kl: 1.0023 | stu_lens: 127.5000 | mixed_lens: 128.0000 | lr: 1.4399e-06 | scale: 256.00 | time: 27.291 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   3241/  5000| tot_loss: 2.5467 | rl_loss: 0.7394 | pt_loss: 1.8073 | pg_loss: 0.0288 | reg_loss: 0.7106 | reward: -0.2318 | rev_kl: 0.8757 | stu_lens: 128.0000 | mixed_lens: 123.5000 | lr: 1.4385e-06 | scale: 256.00 | time: 27.287 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   3242/  5000| tot_loss: 2.6774 | rl_loss: 0.7982 | pt_loss: 1.8791 | pg_loss: 0.2061 | reg_loss: 0.5922 | reward: -0.2912 | rev_kl: 0.6250 | stu_lens: 92.5000 | mixed_lens: 102.5000 | lr: 1.4370e-06 | scale: 256.00 | time: 27.326 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   3243/  5000| tot_loss: 2.3759 | rl_loss: 0.7837 | pt_loss: 1.5922 | pg_loss: 0.2501 | reg_loss: 0.5336 | reward: -0.0663 | rev_kl: 0.9471 | stu_lens: 101.5000 | mixed_lens: 87.0000 | lr: 1.4356e-06 | scale: 256.00 | time: 27.277 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   3244/  5000| tot_loss: 2.6882 | rl_loss: 0.8257 | pt_loss: 1.8624 | pg_loss: 0.2229 | reg_loss: 0.6028 | reward: -0.1045 | rev_kl: 1.0843 | stu_lens: 128.0000 | mixed_lens: 94.0000 | lr: 1.4341e-06 | scale: 256.00 | time: 27.289 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   3245/  5000| tot_loss: 2.5798 | rl_loss: 0.9015 | pt_loss: 1.6783 | pg_loss: 0.2823 | reg_loss: 0.6192 | reward: -0.2183 | rev_kl: 0.8969 | stu_lens: 108.0000 | mixed_lens: 85.0000 | lr: 1.4327e-06 | scale: 256.00 | time: 27.255 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   3246/  5000| tot_loss: 2.5631 | rl_loss: 0.7830 | pt_loss: 1.7801 | pg_loss: 0.1568 | reg_loss: 0.6261 | reward: -0.3782 | rev_kl: 0.9102 | stu_lens: 111.5000 | mixed_lens: 101.0000 | lr: 1.4312e-06 | scale: 256.00 | time: 27.301 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   3247/  5000| tot_loss: 2.1265 | rl_loss: 0.5117 | pt_loss: 1.6148 | pg_loss: 0.0676 | reg_loss: 0.4441 | reward: -0.1319 | rev_kl: 0.5566 | stu_lens: 94.0000 | mixed_lens: 107.0000 | lr: 1.4298e-06 | scale: 256.00 | time: 27.279 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3248/  5000| tot_loss: 2.1532 | rl_loss: 0.6297 | pt_loss: 1.5235 | pg_loss: 0.0975 | reg_loss: 0.5322 | reward: -0.0595 | rev_kl: 0.7094 | stu_lens: 128.0000 | mixed_lens: 93.5000 | lr: 1.4283e-06 | scale: 256.00 | time: 27.319 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3248/  5000| tot_loss: 2.3847 | rl_loss: 0.7204 | pt_loss: 1.6644 | pg_loss: 0.2140 | reg_loss: 0.5064 | reward: -0.2439 | rev_kl: 0.7837 | stu_lens: 100.8125 | mixed_lens: 97.2031 | lr: 1.4283e-06 | scale: 256.00 | time: 27.319 | step time: 28.518
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   3249/  5000| tot_loss: 3.0076 | rl_loss: 1.1743 | pt_loss: 1.8333 | pg_loss: 0.7450 | reg_loss: 0.4293 | reward: -0.2836 | rev_kl: 0.8929 | stu_lens: 81.0000 | mixed_lens: 56.0000 | lr: 1.4269e-06 | scale: 256.00 | time: 27.272 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/3250
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   3250/  5000| tot_loss: 3.1260 | rl_loss: 1.2990 | pt_loss: 1.8269 | pg_loss: 0.8014 | reg_loss: 0.4976 | reward: -0.6254 | rev_kl: 0.7145 | stu_lens: 67.0000 | mixed_lens: 43.5000 | lr: 1.4254e-06 | scale: 256.00 | time: 27.289 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   3251/  5000| tot_loss: 2.9907 | rl_loss: 1.2264 | pt_loss: 1.7643 | pg_loss: 0.6877 | reg_loss: 0.5386 | reward: -0.1965 | rev_kl: 0.5032 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 1.4240e-06 | scale: 256.00 | time: 27.266 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   3252/  5000| tot_loss: 2.2457 | rl_loss: 0.4658 | pt_loss: 1.7799 | pg_loss: 0.0320 | reg_loss: 0.4338 | reward: -0.0816 | rev_kl: 0.6422 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4225e-06 | scale: 256.00 | time: 27.291 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   3253/  5000| tot_loss: 2.4806 | rl_loss: 0.6530 | pt_loss: 1.8276 | pg_loss: 0.2468 | reg_loss: 0.4062 | reward: -0.3619 | rev_kl: 0.9856 | stu_lens: 87.5000 | mixed_lens: 88.5000 | lr: 1.4211e-06 | scale: 256.00 | time: 27.255 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   3254/  5000| tot_loss: 2.2740 | rl_loss: 0.4660 | pt_loss: 1.8081 | pg_loss: 0.1527 | reg_loss: 0.3133 | reward: -0.1165 | rev_kl: 0.5677 | stu_lens: 128.0000 | mixed_lens: 101.0000 | lr: 1.4196e-06 | scale: 256.00 | time: 27.290 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   3255/  5000| tot_loss: 2.5138 | rl_loss: 0.7111 | pt_loss: 1.8027 | pg_loss: 0.2027 | reg_loss: 0.5084 | reward: -0.4458 | rev_kl: 0.5830 | stu_lens: 89.5000 | mixed_lens: 88.5000 | lr: 1.4182e-06 | scale: 256.00 | time: 27.310 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   3256/  5000| tot_loss: 2.6564 | rl_loss: 0.8966 | pt_loss: 1.7598 | pg_loss: 0.4569 | reg_loss: 0.4398 | reward: -0.1272 | rev_kl: 0.8929 | stu_lens: 73.0000 | mixed_lens: 75.0000 | lr: 1.4167e-06 | scale: 256.00 | time: 27.292 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   3257/  5000| tot_loss: 2.0587 | rl_loss: 0.4401 | pt_loss: 1.6187 | pg_loss: -0.0315 | reg_loss: 0.4716 | reward: -0.1352 | rev_kl: 1.2381 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4153e-06 | scale: 256.00 | time: 27.285 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   3258/  5000| tot_loss: 2.1438 | rl_loss: 0.4382 | pt_loss: 1.7056 | pg_loss: -0.0089 | reg_loss: 0.4471 | reward: -0.1504 | rev_kl: 0.8780 | stu_lens: 127.5000 | mixed_lens: 128.0000 | lr: 1.4138e-06 | scale: 256.00 | time: 27.297 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   3259/  5000| tot_loss: 2.3832 | rl_loss: 0.5559 | pt_loss: 1.8273 | pg_loss: 0.2827 | reg_loss: 0.2732 | reward: -0.0058 | rev_kl: 0.1934 | stu_lens: 71.0000 | mixed_lens: 71.0000 | lr: 1.4124e-06 | scale: 256.00 | time: 27.284 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   3260/  5000| tot_loss: 2.3977 | rl_loss: 0.3723 | pt_loss: 2.0255 | pg_loss: 0.0258 | reg_loss: 0.3464 | reward: -0.0546 | rev_kl: 0.6077 | stu_lens: 127.5000 | mixed_lens: 121.5000 | lr: 1.4110e-06 | scale: 256.00 | time: 27.283 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   3261/  5000| tot_loss: 2.3305 | rl_loss: 0.5176 | pt_loss: 1.8130 | pg_loss: 0.0392 | reg_loss: 0.4784 | reward: 0.7491 | rev_kl: 0.7752 | stu_lens: 30.5000 | mixed_lens: 69.0000 | lr: 1.4095e-06 | scale: 256.00 | time: 27.286 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   3262/  5000| tot_loss: 2.6857 | rl_loss: 1.0566 | pt_loss: 1.6292 | pg_loss: 0.4437 | reg_loss: 0.6128 | reward: -2.4210 | rev_kl: 1.2446 | stu_lens: 33.5000 | mixed_lens: 49.5000 | lr: 1.4081e-06 | scale: 256.00 | time: 27.328 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   3263/  5000| tot_loss: 2.4583 | rl_loss: 0.4332 | pt_loss: 2.0251 | pg_loss: 0.0076 | reg_loss: 0.4255 | reward: -0.1071 | rev_kl: 0.8989 | stu_lens: 108.0000 | mixed_lens: 128.0000 | lr: 1.4066e-06 | scale: 256.00 | time: 27.328 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3264/  5000| tot_loss: 2.4035 | rl_loss: 0.3704 | pt_loss: 2.0330 | pg_loss: 0.1188 | reg_loss: 0.2516 | reward: -0.1670 | rev_kl: 0.6897 | stu_lens: 81.0000 | mixed_lens: 97.5000 | lr: 1.4052e-06 | scale: 256.00 | time: 27.304 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3264/  5000| tot_loss: 2.4299 | rl_loss: 0.6127 | pt_loss: 1.8172 | pg_loss: 0.2092 | reg_loss: 0.4035 | reward: -0.2501 | rev_kl: 0.7660 | stu_lens: 97.6719 | mixed_lens: 92.9844 | lr: 1.4052e-06 | scale: 256.00 | time: 27.304 | step time: 28.527
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   3265/  5000| tot_loss: 2.5786 | rl_loss: 0.4795 | pt_loss: 2.0991 | pg_loss: 0.0079 | reg_loss: 0.4716 | reward: -0.2225 | rev_kl: 1.1878 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4038e-06 | scale: 256.00 | time: 27.276 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   3266/  5000| tot_loss: 2.5515 | rl_loss: 0.7085 | pt_loss: 1.8430 | pg_loss: 0.0404 | reg_loss: 0.6681 | reward: -0.2147 | rev_kl: 0.4760 | stu_lens: 107.0000 | mixed_lens: 128.0000 | lr: 1.4023e-06 | scale: 256.00 | time: 27.336 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   3267/  5000| tot_loss: 2.6466 | rl_loss: 1.0223 | pt_loss: 1.6243 | pg_loss: 0.0770 | reg_loss: 0.9453 | reward: -0.1069 | rev_kl: 1.4348 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.4009e-06 | scale: 256.00 | time: 27.300 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   3268/  5000| tot_loss: 3.1910 | rl_loss: 1.2129 | pt_loss: 1.9781 | pg_loss: 0.3461 | reg_loss: 0.8668 | reward: -0.0797 | rev_kl: 1.4295 | stu_lens: 70.0000 | mixed_lens: 81.0000 | lr: 1.3994e-06 | scale: 256.00 | time: 27.271 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   3269/  5000| tot_loss: 4.2189 | rl_loss: 2.2044 | pt_loss: 2.0145 | pg_loss: 1.0795 | reg_loss: 1.1249 | reward: -0.0709 | rev_kl: 0.3265 | stu_lens: 70.0000 | mixed_lens: 28.0000 | lr: 1.3980e-06 | scale: 256.00 | time: 27.283 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   3270/  5000| tot_loss: 2.9483 | rl_loss: 1.3771 | pt_loss: 1.5712 | pg_loss: 0.3551 | reg_loss: 1.0220 | reward: -0.4163 | rev_kl: 0.7098 | stu_lens: 128.0000 | mixed_lens: 97.5000 | lr: 1.3966e-06 | scale: 256.00 | time: 27.301 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   3271/  5000| tot_loss: 2.3214 | rl_loss: 1.0097 | pt_loss: 1.3117 | pg_loss: 0.0505 | reg_loss: 0.9592 | reward: -0.2109 | rev_kl: 0.7705 | stu_lens: 73.5000 | mixed_lens: 128.0000 | lr: 1.3951e-06 | scale: 256.00 | time: 27.304 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   3272/  5000| tot_loss: 2.6142 | rl_loss: 0.9026 | pt_loss: 1.7116 | pg_loss: 0.1591 | reg_loss: 0.7435 | reward: -0.2681 | rev_kl: 0.6752 | stu_lens: 102.0000 | mixed_lens: 114.0000 | lr: 1.3937e-06 | scale: 256.00 | time: 27.320 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   3273/  5000| tot_loss: 2.5151 | rl_loss: 0.9389 | pt_loss: 1.5762 | pg_loss: 0.0686 | reg_loss: 0.8703 | reward: -0.1547 | rev_kl: 0.7965 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.3922e-06 | scale: 256.00 | time: 27.278 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   3274/  5000| tot_loss: 2.9196 | rl_loss: 1.2670 | pt_loss: 1.6527 | pg_loss: 0.2512 | reg_loss: 1.0157 | reward: -0.1761 | rev_kl: 0.6370 | stu_lens: 117.0000 | mixed_lens: 100.0000 | lr: 1.3908e-06 | scale: 256.00 | time: 27.277 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   3275/  5000| tot_loss: 2.4110 | rl_loss: 1.1899 | pt_loss: 1.2210 | pg_loss: 0.3382 | reg_loss: 0.8518 | reward: -0.3727 | rev_kl: 0.4458 | stu_lens: 83.0000 | mixed_lens: 93.5000 | lr: 1.3894e-06 | scale: 256.00 | time: 27.269 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   3276/  5000| tot_loss: 2.7257 | rl_loss: 0.9550 | pt_loss: 1.7707 | pg_loss: 0.1185 | reg_loss: 0.8365 | reward: 0.0024 | rev_kl: 0.5254 | stu_lens: 128.0000 | mixed_lens: 119.0000 | lr: 1.3879e-06 | scale: 256.00 | time: 27.292 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   3277/  5000| tot_loss: 3.4059 | rl_loss: 1.6711 | pt_loss: 1.7348 | pg_loss: 0.5533 | reg_loss: 1.1178 | reward: -0.5840 | rev_kl: 0.7270 | stu_lens: 40.5000 | mixed_lens: 43.0000 | lr: 1.3865e-06 | scale: 256.00 | time: 27.301 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   3278/  5000| tot_loss: 2.8523 | rl_loss: 0.8761 | pt_loss: 1.9762 | pg_loss: 0.0351 | reg_loss: 0.8410 | reward: -0.1264 | rev_kl: 0.7869 | stu_lens: 53.0000 | mixed_lens: 128.0000 | lr: 1.3851e-06 | scale: 256.00 | time: 27.339 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   3279/  5000| tot_loss: 3.3945 | rl_loss: 1.8311 | pt_loss: 1.5634 | pg_loss: 0.9107 | reg_loss: 0.9204 | reward: -0.3551 | rev_kl: 0.7096 | stu_lens: 31.0000 | mixed_lens: 36.0000 | lr: 1.3836e-06 | scale: 256.00 | time: 27.275 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3280/  5000| tot_loss: 2.6689 | rl_loss: 0.9314 | pt_loss: 1.7375 | pg_loss: 0.1220 | reg_loss: 0.8093 | reward: -0.1132 | rev_kl: 1.0599 | stu_lens: 76.0000 | mixed_lens: 111.0000 | lr: 1.3822e-06 | scale: 256.00 | time: 27.326 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3280/  5000| tot_loss: 2.8964 | rl_loss: 1.1415 | pt_loss: 1.7549 | pg_loss: 0.2883 | reg_loss: 0.8532 | reward: -0.2248 | rev_kl: 0.7403 | stu_lens: 88.2656 | mixed_lens: 93.6406 | lr: 1.3822e-06 | scale: 256.00 | time: 27.326 | step time: 28.528
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   3281/  5000| tot_loss: 3.1108 | rl_loss: 0.9947 | pt_loss: 2.1161 | pg_loss: 0.0791 | reg_loss: 0.9155 | reward: -0.1866 | rev_kl: 0.6493 | stu_lens: 128.0000 | mixed_lens: 122.0000 | lr: 1.3808e-06 | scale: 256.00 | time: 27.273 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   3282/  5000| tot_loss: 2.7035 | rl_loss: 0.7834 | pt_loss: 1.9201 | pg_loss: 0.1321 | reg_loss: 0.6514 | reward: -0.2897 | rev_kl: 0.6392 | stu_lens: 117.0000 | mixed_lens: 100.0000 | lr: 1.3793e-06 | scale: 256.00 | time: 27.305 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   3283/  5000| tot_loss: 2.2683 | rl_loss: 0.5258 | pt_loss: 1.7425 | pg_loss: 0.1505 | reg_loss: 0.3753 | reward: -0.2043 | rev_kl: 0.4922 | stu_lens: 86.5000 | mixed_lens: 104.5000 | lr: 1.3779e-06 | scale: 256.00 | time: 27.346 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   3284/  5000| tot_loss: 3.1020 | rl_loss: 1.1906 | pt_loss: 1.9114 | pg_loss: 0.4647 | reg_loss: 0.7259 | reward: -0.1514 | rev_kl: 0.3733 | stu_lens: 70.0000 | mixed_lens: 72.5000 | lr: 1.3765e-06 | scale: 256.00 | time: 27.381 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   3285/  5000| tot_loss: 2.3139 | rl_loss: 1.0654 | pt_loss: 1.2485 | pg_loss: 0.3143 | reg_loss: 0.7512 | reward: 0.0043 | rev_kl: 0.6350 | stu_lens: 48.0000 | mixed_lens: 80.0000 | lr: 1.3750e-06 | scale: 256.00 | time: 27.276 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   3286/  5000| tot_loss: 2.2615 | rl_loss: 1.2203 | pt_loss: 1.0412 | pg_loss: 0.4964 | reg_loss: 0.7239 | reward: -0.6055 | rev_kl: 0.6656 | stu_lens: 26.5000 | mixed_lens: 31.5000 | lr: 1.3736e-06 | scale: 256.00 | time: 27.330 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   3287/  5000| tot_loss: 2.5517 | rl_loss: 0.6548 | pt_loss: 1.8969 | pg_loss: 0.0277 | reg_loss: 0.6271 | reward: 0.0024 | rev_kl: 0.5254 | stu_lens: 128.0000 | mixed_lens: 119.0000 | lr: 1.3722e-06 | scale: 256.00 | time: 27.272 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   3288/  5000| tot_loss: 2.5047 | rl_loss: 0.9238 | pt_loss: 1.5810 | pg_loss: 0.1774 | reg_loss: 0.7464 | reward: -0.2205 | rev_kl: 0.7952 | stu_lens: 99.0000 | mixed_lens: 96.5000 | lr: 1.3707e-06 | scale: 256.00 | time: 27.309 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   3289/  5000| tot_loss: 1.9434 | rl_loss: 0.6153 | pt_loss: 1.3281 | pg_loss: -0.0067 | reg_loss: 0.6220 | reward: -0.0795 | rev_kl: 0.7762 | stu_lens: 99.5000 | mixed_lens: 128.0000 | lr: 1.3693e-06 | scale: 256.00 | time: 27.301 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   3290/  5000| tot_loss: 2.9658 | rl_loss: 0.8070 | pt_loss: 2.1588 | pg_loss: 0.5385 | reg_loss: 0.2685 | reward: -0.4288 | rev_kl: 0.9347 | stu_lens: 77.5000 | mixed_lens: 61.5000 | lr: 1.3679e-06 | scale: 256.00 | time: 27.331 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   3291/  5000| tot_loss: 2.6944 | rl_loss: 0.9983 | pt_loss: 1.6961 | pg_loss: 0.3532 | reg_loss: 0.6451 | reward: -0.1083 | rev_kl: 1.3591 | stu_lens: 70.0000 | mixed_lens: 81.0000 | lr: 1.3665e-06 | scale: 256.00 | time: 27.294 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   3292/  5000| tot_loss: 2.9503 | rl_loss: 1.0344 | pt_loss: 1.9159 | pg_loss: 0.3875 | reg_loss: 0.6469 | reward: -0.4274 | rev_kl: 0.4554 | stu_lens: 75.0000 | mixed_lens: 73.5000 | lr: 1.3650e-06 | scale: 256.00 | time: 27.314 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   3293/  5000| tot_loss: 2.9988 | rl_loss: 1.2269 | pt_loss: 1.7719 | pg_loss: 0.3850 | reg_loss: 0.8420 | reward: -0.4844 | rev_kl: 0.6351 | stu_lens: 73.0000 | mixed_lens: 73.0000 | lr: 1.3636e-06 | scale: 256.00 | time: 27.272 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   3294/  5000| tot_loss: 2.7481 | rl_loss: 0.9545 | pt_loss: 1.7936 | pg_loss: 0.2906 | reg_loss: 0.6638 | reward: -0.1864 | rev_kl: 1.5001 | stu_lens: 73.0000 | mixed_lens: 84.0000 | lr: 1.3622e-06 | scale: 256.00 | time: 27.309 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   3295/  5000| tot_loss: 2.8638 | rl_loss: 0.5965 | pt_loss: 2.2673 | pg_loss: 0.0060 | reg_loss: 0.5905 | reward: -0.2852 | rev_kl: 0.7152 | stu_lens: 120.0000 | mixed_lens: 128.0000 | lr: 1.3607e-06 | scale: 256.00 | time: 27.324 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3296/  5000| tot_loss: 2.7336 | rl_loss: 0.8183 | pt_loss: 1.9154 | pg_loss: 0.1131 | reg_loss: 0.7052 | reward: -0.1419 | rev_kl: 0.8088 | stu_lens: 102.0000 | mixed_lens: 114.0000 | lr: 1.3593e-06 | scale: 256.00 | time: 27.336 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3296/  5000| tot_loss: 2.6023 | rl_loss: 0.8712 | pt_loss: 1.7311 | pg_loss: 0.2092 | reg_loss: 0.6620 | reward: -0.2298 | rev_kl: 0.7157 | stu_lens: 88.0312 | mixed_lens: 94.5469 | lr: 1.3593e-06 | scale: 256.00 | time: 27.336 | step time: 28.541
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   3297/  5000| tot_loss: 2.6400 | rl_loss: 1.1430 | pt_loss: 1.4970 | pg_loss: 0.7783 | reg_loss: 0.3647 | reward: 0.2323 | rev_kl: 0.2304 | stu_lens: 51.0000 | mixed_lens: 39.0000 | lr: 1.3579e-06 | scale: 256.00 | time: 27.327 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   3298/  5000| tot_loss: 2.1644 | rl_loss: 0.7586 | pt_loss: 1.4058 | pg_loss: 0.2105 | reg_loss: 0.5480 | reward: -0.3763 | rev_kl: 0.7640 | stu_lens: 128.0000 | mixed_lens: 97.5000 | lr: 1.3565e-06 | scale: 256.00 | time: 27.306 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   3299/  5000| tot_loss: 3.3646 | rl_loss: 1.4701 | pt_loss: 1.8945 | pg_loss: 0.8454 | reg_loss: 0.6247 | reward: -0.6664 | rev_kl: 0.8635 | stu_lens: 21.0000 | mixed_lens: 39.5000 | lr: 1.3550e-06 | scale: 256.00 | time: 27.294 | step time: 0.000
                                 Evaluation #33                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Existen dos tipos básicos de cuarks: │
│                                       │ los quarks de color (o vuelta de     │
│                                       │ tuerca) y los quarks blancos. Los    │
│                                       │ quarks de color son los que dan      │
│                                       │ color a la materia y son más pesados │
│                                       │ que los quarks blancos. Los quarks   │
│                                       │ blancos son los que dan la masa al   │
│                                       │ núcleo atómico y son más livianos    │
│                                       │ que los quarks de color.             │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC o IMC (Industrial             │
│                                       │ Merchandising Council) es una        │
│                                       │ organización que reúne a las         │
│                                       │ principales empresas de distribución │
│                                       │ de productos para la industria. Su   │
│                                       │ principal utilidad es la de invertir │
│                                       │ en la investigación y la innovación, │
│                                       │ para poder ofrecer a sus clientes    │
│                                       │ productos y servicios de calidad.    │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ - Cápsula del tiempo de 1965:        │
│                                       │ Contenido: Recuerdos de la Guerra de │
│                                       │ Vietnam, fecha de apertura: 26 de    │
│                                       │ noviembre de 2022                    │
│                                       │ - Cápsula del tiempo de 1975:        │
│                                       │ Contenido: Recuerdos de la muerte de │
│                                       │ Salvador Allende, fecha de apertura: │
│                                       │ 1 de junio de 2022                   │
│                                       │ - Cápsula del tiempo de 1990:        │
│                                       │ Contenido: Recuerdos de la caída del │
│                                       │ Muro de Berlín, fecha de             │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 17.124 | exact_match: 0.000 | rev_kl: 0.840 | lens: 96.390 | pt_loss: 1.726 | lm_loss: 1.856 | kd_loss: 1.597 
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   3300/  5000| tot_loss: 2.8533 | rl_loss: 1.0244 | pt_loss: 1.8289 | pg_loss: 0.7408 | reg_loss: 0.2836 | reward: -0.3276 | rev_kl: 0.5279 | stu_lens: 83.0000 | mixed_lens: 50.5000 | lr: 1.3536e-06 | scale: 256.00 | time: 27.299 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   3301/  5000| tot_loss: 2.3119 | rl_loss: 0.6160 | pt_loss: 1.6959 | pg_loss: 0.0835 | reg_loss: 0.5326 | reward: -0.5502 | rev_kl: 0.6865 | stu_lens: 126.0000 | mixed_lens: 97.0000 | lr: 1.3522e-06 | scale: 256.00 | time: 27.390 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   3302/  5000| tot_loss: 2.9388 | rl_loss: 1.1101 | pt_loss: 1.8287 | pg_loss: 0.4748 | reg_loss: 0.6354 | reward: -0.5201 | rev_kl: 0.5344 | stu_lens: 68.0000 | mixed_lens: 68.0000 | lr: 1.3508e-06 | scale: 256.00 | time: 27.378 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   3303/  5000| tot_loss: 2.1573 | rl_loss: 0.7219 | pt_loss: 1.4355 | pg_loss: 0.2490 | reg_loss: 0.4728 | reward: -0.0797 | rev_kl: 1.4295 | stu_lens: 70.0000 | mixed_lens: 81.0000 | lr: 1.3493e-06 | scale: 256.00 | time: 27.337 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   3304/  5000| tot_loss: 2.0034 | rl_loss: 0.5521 | pt_loss: 1.4513 | pg_loss: -0.0193 | reg_loss: 0.5714 | reward: -0.1006 | rev_kl: 0.9571 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.3479e-06 | scale: 256.00 | time: 27.320 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   3305/  5000| tot_loss: 2.0220 | rl_loss: 0.3227 | pt_loss: 1.6993 | pg_loss: 0.0863 | reg_loss: 0.2364 | reward: -0.2003 | rev_kl: 0.8538 | stu_lens: 91.5000 | mixed_lens: 102.5000 | lr: 1.3465e-06 | scale: 256.00 | time: 27.343 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   3306/  5000| tot_loss: 2.3381 | rl_loss: 0.6726 | pt_loss: 1.6656 | pg_loss: 0.1682 | reg_loss: 0.5044 | reward: -0.1435 | rev_kl: 0.3668 | stu_lens: 117.0000 | mixed_lens: 91.0000 | lr: 1.3451e-06 | scale: 256.00 | time: 27.375 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   3307/  5000| tot_loss: 2.6013 | rl_loss: 0.5037 | pt_loss: 2.0976 | pg_loss: -0.0167 | reg_loss: 0.5204 | reward: -0.0609 | rev_kl: 0.9800 | stu_lens: 100.5000 | mixed_lens: 128.0000 | lr: 1.3437e-06 | scale: 256.00 | time: 27.391 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   3308/  5000| tot_loss: 1.9813 | rl_loss: 0.4399 | pt_loss: 1.5414 | pg_loss: 0.0687 | reg_loss: 0.3712 | reward: -0.0028 | rev_kl: 1.0030 | stu_lens: 67.0000 | mixed_lens: 111.0000 | lr: 1.3422e-06 | scale: 256.00 | time: 27.297 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   3309/  5000| tot_loss: 2.3382 | rl_loss: 0.6600 | pt_loss: 1.6782 | pg_loss: 0.1419 | reg_loss: 0.5181 | reward: -0.1436 | rev_kl: 1.6242 | stu_lens: 86.5000 | mixed_lens: 91.5000 | lr: 1.3408e-06 | scale: 256.00 | time: 27.313 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   3310/  5000| tot_loss: 2.4604 | rl_loss: 0.5502 | pt_loss: 1.9102 | pg_loss: -0.0122 | reg_loss: 0.5624 | reward: -0.2272 | rev_kl: 0.5443 | stu_lens: 105.5000 | mixed_lens: 128.0000 | lr: 1.3394e-06 | scale: 256.00 | time: 27.292 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   3311/  5000| tot_loss: 2.6475 | rl_loss: 0.7049 | pt_loss: 1.9425 | pg_loss: 0.2014 | reg_loss: 0.5035 | reward: -0.0673 | rev_kl: 0.7211 | stu_lens: 128.0000 | mixed_lens: 83.5000 | lr: 1.3380e-06 | scale: 256.00 | time: 27.317 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3312/  5000| tot_loss: 2.1036 | rl_loss: 0.5606 | pt_loss: 1.5429 | pg_loss: -0.0104 | reg_loss: 0.5710 | reward: -0.1716 | rev_kl: 0.6551 | stu_lens: 81.5000 | mixed_lens: 128.0000 | lr: 1.3366e-06 | scale: 256.00 | time: 27.311 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3312/  5000| tot_loss: 2.4719 | rl_loss: 0.7901 | pt_loss: 1.6818 | pg_loss: 0.2938 | reg_loss: 0.4962 | reward: -0.2293 | rev_kl: 0.7050 | stu_lens: 83.8594 | mixed_lens: 87.1250 | lr: 1.3366e-06 | scale: 256.00 | time: 27.311 | step time: 28.562
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   3313/  5000| tot_loss: 2.1106 | rl_loss: 0.4242 | pt_loss: 1.6864 | pg_loss: -0.0011 | reg_loss: 0.4253 | reward: -0.2232 | rev_kl: 0.9345 | stu_lens: 100.5000 | mixed_lens: 128.0000 | lr: 1.3351e-06 | scale: 256.00 | time: 27.348 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   3314/  5000| tot_loss: 2.4650 | rl_loss: 0.4778 | pt_loss: 1.9872 | pg_loss: 0.0858 | reg_loss: 0.3921 | reward: -0.3176 | rev_kl: 0.5226 | stu_lens: 73.0000 | mixed_lens: 94.5000 | lr: 1.3337e-06 | scale: 256.00 | time: 27.325 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   3315/  5000| tot_loss: 1.9674 | rl_loss: 0.6547 | pt_loss: 1.3128 | pg_loss: 0.2287 | reg_loss: 0.4259 | reward: -0.4030 | rev_kl: 0.9567 | stu_lens: 76.0000 | mixed_lens: 91.5000 | lr: 1.3323e-06 | scale: 256.00 | time: 27.311 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   3316/  5000| tot_loss: 2.2041 | rl_loss: 0.5027 | pt_loss: 1.7014 | pg_loss: 0.1235 | reg_loss: 0.3791 | reward: -0.2314 | rev_kl: 0.7043 | stu_lens: 128.0000 | mixed_lens: 108.0000 | lr: 1.3309e-06 | scale: 256.00 | time: 27.295 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   3317/  5000| tot_loss: 2.9392 | rl_loss: 0.7681 | pt_loss: 2.1710 | pg_loss: 0.2541 | reg_loss: 0.5140 | reward: -0.3846 | rev_kl: 0.5426 | stu_lens: 128.0000 | mixed_lens: 88.5000 | lr: 1.3295e-06 | scale: 256.00 | time: 27.291 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   3318/  5000| tot_loss: 2.3912 | rl_loss: 0.6652 | pt_loss: 1.7260 | pg_loss: 0.1989 | reg_loss: 0.4664 | reward: -0.0866 | rev_kl: 0.5946 | stu_lens: 103.0000 | mixed_lens: 99.5000 | lr: 1.3281e-06 | scale: 256.00 | time: 27.255 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   3319/  5000| tot_loss: 2.1072 | rl_loss: 0.4497 | pt_loss: 1.6574 | pg_loss: 0.0064 | reg_loss: 0.4433 | reward: -0.2123 | rev_kl: 0.5666 | stu_lens: 128.0000 | mixed_lens: 125.0000 | lr: 1.3266e-06 | scale: 256.00 | time: 27.327 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   3320/  5000| tot_loss: 2.3586 | rl_loss: 0.5628 | pt_loss: 1.7958 | pg_loss: 0.2306 | reg_loss: 0.3323 | reward: -0.2413 | rev_kl: 0.5154 | stu_lens: 78.5000 | mixed_lens: 79.0000 | lr: 1.3252e-06 | scale: 256.00 | time: 27.329 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   3321/  5000| tot_loss: 2.7433 | rl_loss: 0.4937 | pt_loss: 2.2495 | pg_loss: -0.0107 | reg_loss: 0.5044 | reward: -0.1020 | rev_kl: 0.5805 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.3238e-06 | scale: 256.00 | time: 27.331 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   3322/  5000| tot_loss: 1.7920 | rl_loss: 0.2821 | pt_loss: 1.5099 | pg_loss: -0.0013 | reg_loss: 0.2834 | reward: -0.0593 | rev_kl: 0.5313 | stu_lens: 73.5000 | mixed_lens: 128.0000 | lr: 1.3224e-06 | scale: 256.00 | time: 27.300 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   3323/  5000| tot_loss: 2.3858 | rl_loss: 0.4710 | pt_loss: 1.9148 | pg_loss: 0.1988 | reg_loss: 0.2722 | reward: 0.0787 | rev_kl: 0.7052 | stu_lens: 82.0000 | mixed_lens: 95.5000 | lr: 1.3210e-06 | scale: 256.00 | time: 27.334 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   3324/  5000| tot_loss: 1.6674 | rl_loss: 0.3375 | pt_loss: 1.3299 | pg_loss: -0.0169 | reg_loss: 0.3544 | reward: -0.0755 | rev_kl: 0.8496 | stu_lens: 120.0000 | mixed_lens: 128.0000 | lr: 1.3196e-06 | scale: 256.00 | time: 27.283 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   3325/  5000| tot_loss: 2.7306 | rl_loss: 0.8363 | pt_loss: 1.8943 | pg_loss: 0.5132 | reg_loss: 0.3231 | reward: -0.5306 | rev_kl: 0.6889 | stu_lens: 47.5000 | mixed_lens: 48.5000 | lr: 1.3182e-06 | scale: 256.00 | time: 27.326 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   3326/  5000| tot_loss: 1.8694 | rl_loss: 0.3369 | pt_loss: 1.5325 | pg_loss: -0.0041 | reg_loss: 0.3410 | reward: -0.0644 | rev_kl: 0.7028 | stu_lens: 118.5000 | mixed_lens: 128.0000 | lr: 1.3167e-06 | scale: 256.00 | time: 27.319 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   3327/  5000| tot_loss: 2.5970 | rl_loss: 0.7809 | pt_loss: 1.8160 | pg_loss: 0.4645 | reg_loss: 0.3165 | reward: -0.1473 | rev_kl: 0.3611 | stu_lens: 23.5000 | mixed_lens: 72.5000 | lr: 1.3153e-06 | scale: 256.00 | time: 27.325 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3328/  5000| tot_loss: 2.4482 | rl_loss: 0.4591 | pt_loss: 1.9890 | pg_loss: -0.0158 | reg_loss: 0.4750 | reward: -0.2903 | rev_kl: 0.8242 | stu_lens: 86.5000 | mixed_lens: 128.0000 | lr: 1.3139e-06 | scale: 256.00 | time: 27.300 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3328/  5000| tot_loss: 2.4268 | rl_loss: 0.6201 | pt_loss: 1.8067 | pg_loss: 0.2140 | reg_loss: 0.4060 | reward: -0.2148 | rev_kl: 0.7269 | stu_lens: 86.9062 | mixed_lens: 92.3125 | lr: 1.3139e-06 | scale: 256.00 | time: 27.300 | step time: 28.542
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   3329/  5000| tot_loss: 1.1638 | rl_loss: 0.3067 | pt_loss: 0.8571 | pg_loss: 0.0731 | reg_loss: 0.2335 | reward: -0.2167 | rev_kl: 0.8172 | stu_lens: 107.0000 | mixed_lens: 109.0000 | lr: 1.3125e-06 | scale: 256.00 | time: 27.276 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   3330/  5000| tot_loss: 3.3470 | rl_loss: 1.2505 | pt_loss: 2.0966 | pg_loss: 0.0578 | reg_loss: 1.1927 | reward: -0.1518 | rev_kl: 0.9110 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.3111e-06 | scale: 256.00 | time: 27.354 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   3331/  5000| tot_loss: 3.1938 | rl_loss: 1.8533 | pt_loss: 1.3405 | pg_loss: 1.2331 | reg_loss: 0.6202 | reward: -0.4593 | rev_kl: 0.7931 | stu_lens: 38.5000 | mixed_lens: 28.5000 | lr: 1.3097e-06 | scale: 256.00 | time: 27.276 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   3332/  5000| tot_loss: 2.5557 | rl_loss: 0.7510 | pt_loss: 1.8047 | pg_loss: 0.0558 | reg_loss: 0.6952 | reward: -0.0711 | rev_kl: 0.6403 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.3083e-06 | scale: 256.00 | time: 27.266 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   3333/  5000| tot_loss: 2.5140 | rl_loss: 0.8786 | pt_loss: 1.6354 | pg_loss: 0.1740 | reg_loss: 0.7046 | reward: -0.2168 | rev_kl: 0.7878 | stu_lens: 105.5000 | mixed_lens: 106.0000 | lr: 1.3069e-06 | scale: 256.00 | time: 27.282 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   3334/  5000| tot_loss: 2.7879 | rl_loss: 1.2782 | pt_loss: 1.5097 | pg_loss: 0.4196 | reg_loss: 0.8586 | reward: -0.3424 | rev_kl: 0.5802 | stu_lens: 94.5000 | mixed_lens: 79.0000 | lr: 1.3055e-06 | scale: 256.00 | time: 27.281 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   3335/  5000| tot_loss: 2.9095 | rl_loss: 0.8933 | pt_loss: 2.0162 | pg_loss: 0.1555 | reg_loss: 0.7378 | reward: -0.2289 | rev_kl: 0.2810 | stu_lens: 89.0000 | mixed_lens: 113.5000 | lr: 1.3041e-06 | scale: 256.00 | time: 27.314 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   3336/  5000| tot_loss: 2.8397 | rl_loss: 1.1589 | pt_loss: 1.6809 | pg_loss: 0.2610 | reg_loss: 0.8979 | reward: -0.0833 | rev_kl: 0.5564 | stu_lens: 116.5000 | mixed_lens: 89.0000 | lr: 1.3026e-06 | scale: 256.00 | time: 27.324 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   3337/  5000| tot_loss: 3.3058 | rl_loss: 1.3744 | pt_loss: 1.9314 | pg_loss: 0.2608 | reg_loss: 1.1136 | reward: -0.3067 | rev_kl: 0.8240 | stu_lens: 128.0000 | mixed_lens: 88.0000 | lr: 1.3012e-06 | scale: 256.00 | time: 27.281 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   3338/  5000| tot_loss: 2.5582 | rl_loss: 0.8687 | pt_loss: 1.6895 | pg_loss: 0.2958 | reg_loss: 0.5729 | reward: -0.2079 | rev_kl: 0.5720 | stu_lens: 69.0000 | mixed_lens: 88.0000 | lr: 1.2998e-06 | scale: 256.00 | time: 27.292 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   3339/  5000| tot_loss: 2.6258 | rl_loss: 1.0496 | pt_loss: 1.5762 | pg_loss: 0.1950 | reg_loss: 0.8546 | reward: -0.2567 | rev_kl: 1.0045 | stu_lens: 45.5000 | mixed_lens: 92.0000 | lr: 1.2984e-06 | scale: 256.00 | time: 27.296 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   3340/  5000| tot_loss: 2.6805 | rl_loss: 1.0690 | pt_loss: 1.6115 | pg_loss: 0.0490 | reg_loss: 1.0200 | reward: -0.1483 | rev_kl: 0.7700 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.2970e-06 | scale: 256.00 | time: 27.296 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   3341/  5000| tot_loss: 2.4471 | rl_loss: 0.8220 | pt_loss: 1.6251 | pg_loss: 0.1393 | reg_loss: 0.6827 | reward: -0.1202 | rev_kl: 0.5786 | stu_lens: 128.0000 | mixed_lens: 113.0000 | lr: 1.2956e-06 | scale: 256.00 | time: 27.333 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   3342/  5000| tot_loss: 2.8697 | rl_loss: 1.1138 | pt_loss: 1.7559 | pg_loss: 0.0662 | reg_loss: 1.0476 | reward: -0.0713 | rev_kl: 1.0142 | stu_lens: 126.5000 | mixed_lens: 128.0000 | lr: 1.2942e-06 | scale: 256.00 | time: 27.335 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   3343/  5000| tot_loss: 3.5373 | rl_loss: 1.6191 | pt_loss: 1.9182 | pg_loss: 1.0770 | reg_loss: 0.5421 | reward: -0.5583 | rev_kl: 1.7442 | stu_lens: 35.0000 | mixed_lens: 35.0000 | lr: 1.2928e-06 | scale: 256.00 | time: 27.336 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3344/  5000| tot_loss: 3.2136 | rl_loss: 1.7220 | pt_loss: 1.4915 | pg_loss: 0.7354 | reg_loss: 0.9867 | reward: -0.1980 | rev_kl: 0.8217 | stu_lens: 36.5000 | mixed_lens: 45.0000 | lr: 1.2914e-06 | scale: 256.00 | time: 27.302 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3344/  5000| tot_loss: 2.7809 | rl_loss: 1.0946 | pt_loss: 1.6862 | pg_loss: 0.2836 | reg_loss: 0.8111 | reward: -0.1163 | rev_kl: 0.7423 | stu_lens: 97.4844 | mixed_lens: 96.6250 | lr: 1.2914e-06 | scale: 256.00 | time: 27.302 | step time: 28.537
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   3345/  5000| tot_loss: 2.8615 | rl_loss: 0.9852 | pt_loss: 1.8763 | pg_loss: 0.0983 | reg_loss: 0.8868 | reward: -0.1198 | rev_kl: 0.8161 | stu_lens: 87.5000 | mixed_lens: 120.5000 | lr: 1.2900e-06 | scale: 256.00 | time: 27.301 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   3346/  5000| tot_loss: 2.4435 | rl_loss: 0.6420 | pt_loss: 1.8015 | pg_loss: 0.0017 | reg_loss: 0.6403 | reward: -0.0909 | rev_kl: 0.8430 | stu_lens: 89.0000 | mixed_lens: 124.5000 | lr: 1.2886e-06 | scale: 256.00 | time: 27.290 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   3347/  5000| tot_loss: 3.8394 | rl_loss: 1.8051 | pt_loss: 2.0343 | pg_loss: 0.9448 | reg_loss: 0.8603 | reward: -0.5825 | rev_kl: 1.6017 | stu_lens: 24.0000 | mixed_lens: 32.5000 | lr: 1.2872e-06 | scale: 256.00 | time: 27.329 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   3348/  5000| tot_loss: 2.5631 | rl_loss: 0.8425 | pt_loss: 1.7206 | pg_loss: 0.1133 | reg_loss: 0.7292 | reward: -0.2629 | rev_kl: 0.7666 | stu_lens: 128.0000 | mixed_lens: 107.0000 | lr: 1.2858e-06 | scale: 256.00 | time: 27.331 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   3349/  5000| tot_loss: 2.6350 | rl_loss: 0.8223 | pt_loss: 1.8127 | pg_loss: 0.1947 | reg_loss: 0.6276 | reward: -0.2011 | rev_kl: 0.6359 | stu_lens: 114.0000 | mixed_lens: 85.5000 | lr: 1.2844e-06 | scale: 256.00 | time: 27.376 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   3350/  5000| tot_loss: 2.2501 | rl_loss: 0.6497 | pt_loss: 1.6004 | pg_loss: 0.1361 | reg_loss: 0.5136 | reward: -0.2118 | rev_kl: 0.8907 | stu_lens: 127.5000 | mixed_lens: 103.5000 | lr: 1.2830e-06 | scale: 256.00 | time: 27.302 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   3351/  5000| tot_loss: 2.3572 | rl_loss: 0.8906 | pt_loss: 1.4666 | pg_loss: 0.0528 | reg_loss: 0.8378 | reward: -0.0893 | rev_kl: 0.8581 | stu_lens: 100.5000 | mixed_lens: 120.5000 | lr: 1.2816e-06 | scale: 256.00 | time: 27.306 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   3352/  5000| tot_loss: 2.1104 | rl_loss: 0.6439 | pt_loss: 1.4664 | pg_loss: 0.1813 | reg_loss: 0.4626 | reward: -0.2192 | rev_kl: 0.3850 | stu_lens: 63.5000 | mixed_lens: 79.0000 | lr: 1.2802e-06 | scale: 256.00 | time: 27.303 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   3353/  5000| tot_loss: 2.7980 | rl_loss: 1.0056 | pt_loss: 1.7923 | pg_loss: 0.4198 | reg_loss: 0.5858 | reward: -0.4702 | rev_kl: 0.9540 | stu_lens: 94.5000 | mixed_lens: 67.5000 | lr: 1.2788e-06 | scale: 256.00 | time: 27.332 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   3354/  5000| tot_loss: 2.4790 | rl_loss: 1.0980 | pt_loss: 1.3810 | pg_loss: 0.4029 | reg_loss: 0.6951 | reward: -0.3206 | rev_kl: 1.0186 | stu_lens: 83.0000 | mixed_lens: 82.0000 | lr: 1.2774e-06 | scale: 256.00 | time: 27.428 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   3355/  5000| tot_loss: 2.6942 | rl_loss: 0.9607 | pt_loss: 1.7335 | pg_loss: 0.0227 | reg_loss: 0.9381 | reward: -0.2548 | rev_kl: 0.8538 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.2760e-06 | scale: 256.00 | time: 27.353 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   3356/  5000| tot_loss: 2.9289 | rl_loss: 1.2036 | pt_loss: 1.7253 | pg_loss: 0.4951 | reg_loss: 0.7085 | reward: 0.0342 | rev_kl: 0.8743 | stu_lens: 81.0000 | mixed_lens: 81.5000 | lr: 1.2746e-06 | scale: 256.00 | time: 27.343 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   3357/  5000| tot_loss: 2.6741 | rl_loss: 0.8359 | pt_loss: 1.8382 | pg_loss: 0.2226 | reg_loss: 0.6132 | reward: -0.2721 | rev_kl: 0.5653 | stu_lens: 128.0000 | mixed_lens: 90.0000 | lr: 1.2732e-06 | scale: 256.00 | time: 27.320 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   3358/  5000| tot_loss: 2.6184 | rl_loss: 1.3172 | pt_loss: 1.3012 | pg_loss: 0.3526 | reg_loss: 0.9646 | reward: -0.2683 | rev_kl: 0.9725 | stu_lens: 100.0000 | mixed_lens: 88.0000 | lr: 1.2718e-06 | scale: 256.00 | time: 27.288 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   3359/  5000| tot_loss: 2.5214 | rl_loss: 0.7703 | pt_loss: 1.7511 | pg_loss: 0.1718 | reg_loss: 0.5985 | reward: -0.2420 | rev_kl: 1.1249 | stu_lens: 60.5000 | mixed_lens: 92.0000 | lr: 1.2704e-06 | scale: 256.00 | time: 27.340 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3360/  5000| tot_loss: 2.6884 | rl_loss: 0.9410 | pt_loss: 1.7473 | pg_loss: 0.1572 | reg_loss: 0.7838 | reward: -0.3695 | rev_kl: 0.7584 | stu_lens: 118.5000 | mixed_lens: 88.0000 | lr: 1.2690e-06 | scale: 256.00 | time: 27.324 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3360/  5000| tot_loss: 2.5880 | rl_loss: 0.8743 | pt_loss: 1.7137 | pg_loss: 0.1950 | reg_loss: 0.6793 | reward: -0.1043 | rev_kl: 0.7897 | stu_lens: 98.1250 | mixed_lens: 99.9062 | lr: 1.2690e-06 | scale: 256.00 | time: 27.324 | step time: 28.565
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   3361/  5000| tot_loss: 2.6034 | rl_loss: 0.9946 | pt_loss: 1.6089 | pg_loss: 0.1381 | reg_loss: 0.8565 | reward: -0.2185 | rev_kl: 0.3959 | stu_lens: 92.5000 | mixed_lens: 97.0000 | lr: 1.2676e-06 | scale: 256.00 | time: 27.316 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   3362/  5000| tot_loss: 2.7608 | rl_loss: 0.9007 | pt_loss: 1.8601 | pg_loss: 0.4586 | reg_loss: 0.4421 | reward: -0.2801 | rev_kl: 1.5977 | stu_lens: 55.5000 | mixed_lens: 69.0000 | lr: 1.2662e-06 | scale: 256.00 | time: 27.285 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   3363/  5000| tot_loss: 2.4657 | rl_loss: 0.7738 | pt_loss: 1.6919 | pg_loss: 0.1835 | reg_loss: 0.5903 | reward: -0.1549 | rev_kl: 0.2389 | stu_lens: 92.5000 | mixed_lens: 97.0000 | lr: 1.2648e-06 | scale: 256.00 | time: 27.369 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   3364/  5000| tot_loss: 2.1312 | rl_loss: 0.6067 | pt_loss: 1.5245 | pg_loss: -0.0012 | reg_loss: 0.6079 | reward: -0.0660 | rev_kl: 0.7577 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.2634e-06 | scale: 256.00 | time: 27.121 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   3365/  5000| tot_loss: 2.2275 | rl_loss: 0.3046 | pt_loss: 1.9229 | pg_loss: -0.0041 | reg_loss: 0.3087 | reward: -0.0438 | rev_kl: 0.7633 | stu_lens: 68.5000 | mixed_lens: 124.5000 | lr: 1.2620e-06 | scale: 256.00 | time: 27.182 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   3366/  5000| tot_loss: 2.9069 | rl_loss: 0.7382 | pt_loss: 2.1688 | pg_loss: 0.3230 | reg_loss: 0.4152 | reward: -0.3034 | rev_kl: 0.7458 | stu_lens: 128.0000 | mixed_lens: 81.0000 | lr: 1.2607e-06 | scale: 256.00 | time: 27.147 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   3367/  5000| tot_loss: 2.7743 | rl_loss: 0.7698 | pt_loss: 2.0045 | pg_loss: -0.0076 | reg_loss: 0.7774 | reward: -0.2199 | rev_kl: 0.9041 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.2593e-06 | scale: 256.00 | time: 27.180 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   3368/  5000| tot_loss: 2.2075 | rl_loss: 0.5387 | pt_loss: 1.6688 | pg_loss: 0.1739 | reg_loss: 0.3648 | reward: -0.3617 | rev_kl: 0.9401 | stu_lens: 117.5000 | mixed_lens: 106.0000 | lr: 1.2579e-06 | scale: 256.00 | time: 27.159 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   3369/  5000| tot_loss: 2.1656 | rl_loss: 0.7721 | pt_loss: 1.3935 | pg_loss: 0.2054 | reg_loss: 0.5667 | reward: -0.1315 | rev_kl: 0.6653 | stu_lens: 93.5000 | mixed_lens: 104.0000 | lr: 1.2565e-06 | scale: 256.00 | time: 27.164 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   3370/  5000| tot_loss: 2.1099 | rl_loss: 0.4603 | pt_loss: 1.6497 | pg_loss: -0.0175 | reg_loss: 0.4778 | reward: -0.0107 | rev_kl: 0.8925 | stu_lens: 91.5000 | mixed_lens: 128.0000 | lr: 1.2551e-06 | scale: 256.00 | time: 27.115 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   3371/  5000| tot_loss: 2.5088 | rl_loss: 0.5569 | pt_loss: 1.9519 | pg_loss: -0.0007 | reg_loss: 0.5576 | reward: -0.0706 | rev_kl: 0.8722 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.2537e-06 | scale: 256.00 | time: 27.181 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   3372/  5000| tot_loss: 2.3597 | rl_loss: 0.7584 | pt_loss: 1.6013 | pg_loss: 0.0975 | reg_loss: 0.6608 | reward: -0.3360 | rev_kl: 0.8686 | stu_lens: 106.5000 | mixed_lens: 107.5000 | lr: 1.2523e-06 | scale: 256.00 | time: 27.117 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   3373/  5000| tot_loss: 2.1677 | rl_loss: 0.4216 | pt_loss: 1.7461 | pg_loss: 0.0741 | reg_loss: 0.3475 | reward: -0.0256 | rev_kl: 0.5590 | stu_lens: 128.0000 | mixed_lens: 113.0000 | lr: 1.2509e-06 | scale: 256.00 | time: 27.221 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   3374/  5000| tot_loss: 2.4143 | rl_loss: 0.9365 | pt_loss: 1.4778 | pg_loss: 0.3082 | reg_loss: 0.6283 | reward: -0.3203 | rev_kl: 0.5925 | stu_lens: 94.5000 | mixed_lens: 79.0000 | lr: 1.2495e-06 | scale: 256.00 | time: 27.157 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   3375/  5000| tot_loss: 2.7111 | rl_loss: 0.7584 | pt_loss: 1.9526 | pg_loss: 0.2552 | reg_loss: 0.5032 | reward: 0.0126 | rev_kl: 0.4607 | stu_lens: 81.5000 | mixed_lens: 89.0000 | lr: 1.2481e-06 | scale: 256.00 | time: 27.174 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3376/  5000| tot_loss: 2.8230 | rl_loss: 0.7824 | pt_loss: 2.0407 | pg_loss: 0.2050 | reg_loss: 0.5774 | reward: -0.2251 | rev_kl: 0.7112 | stu_lens: 104.5000 | mixed_lens: 85.5000 | lr: 1.2468e-06 | scale: 256.00 | time: 27.162 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3376/  5000| tot_loss: 2.4169 | rl_loss: 0.6854 | pt_loss: 1.7315 | pg_loss: 0.1856 | reg_loss: 0.4998 | reward: -0.0973 | rev_kl: 0.7310 | stu_lens: 100.1094 | mixed_lens: 98.3281 | lr: 1.2468e-06 | scale: 256.00 | time: 27.162 | step time: 28.425
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   3377/  5000| tot_loss: 2.2254 | rl_loss: 0.7385 | pt_loss: 1.4869 | pg_loss: 0.3036 | reg_loss: 0.4349 | reward: -0.2389 | rev_kl: 0.7550 | stu_lens: 88.5000 | mixed_lens: 89.0000 | lr: 1.2454e-06 | scale: 256.00 | time: 27.142 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   3378/  5000| tot_loss: 2.5219 | rl_loss: 0.5949 | pt_loss: 1.9271 | pg_loss: 0.1006 | reg_loss: 0.4943 | reward: -0.2029 | rev_kl: 0.7111 | stu_lens: 89.0000 | mixed_lens: 113.5000 | lr: 1.2440e-06 | scale: 256.00 | time: 27.172 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   3379/  5000| tot_loss: 2.3644 | rl_loss: 0.2750 | pt_loss: 2.0894 | pg_loss: 0.0494 | reg_loss: 0.2255 | reward: -0.0839 | rev_kl: 0.1345 | stu_lens: 128.0000 | mixed_lens: 110.5000 | lr: 1.2426e-06 | scale: 256.00 | time: 27.182 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   3380/  5000| tot_loss: 2.7075 | rl_loss: 0.8929 | pt_loss: 1.8146 | pg_loss: 0.5338 | reg_loss: 0.3592 | reward: -0.0420 | rev_kl: 0.9390 | stu_lens: 81.0000 | mixed_lens: 55.0000 | lr: 1.2412e-06 | scale: 256.00 | time: 27.161 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   3381/  5000| tot_loss: 2.3876 | rl_loss: 0.5403 | pt_loss: 1.8473 | pg_loss: 0.1410 | reg_loss: 0.3993 | reward: -0.1339 | rev_kl: 0.7904 | stu_lens: 92.0000 | mixed_lens: 104.0000 | lr: 1.2398e-06 | scale: 256.00 | time: 27.167 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   3382/  5000| tot_loss: 2.9478 | rl_loss: 0.7154 | pt_loss: 2.2324 | pg_loss: 0.2237 | reg_loss: 0.4916 | reward: -0.3335 | rev_kl: 0.8833 | stu_lens: 94.5000 | mixed_lens: 94.0000 | lr: 1.2385e-06 | scale: 256.00 | time: 27.183 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   3383/  5000| tot_loss: 2.5292 | rl_loss: 0.7941 | pt_loss: 1.7351 | pg_loss: 0.3696 | reg_loss: 0.4246 | reward: -0.4246 | rev_kl: 1.2879 | stu_lens: 29.0000 | mixed_lens: 38.5000 | lr: 1.2371e-06 | scale: 256.00 | time: 27.213 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   3384/  5000| tot_loss: 1.9254 | rl_loss: 0.3860 | pt_loss: 1.5394 | pg_loss: -0.0191 | reg_loss: 0.4051 | reward: -0.1530 | rev_kl: 0.6362 | stu_lens: 118.5000 | mixed_lens: 128.0000 | lr: 1.2357e-06 | scale: 256.00 | time: 27.175 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   3385/  5000| tot_loss: 2.3657 | rl_loss: 0.4669 | pt_loss: 1.8988 | pg_loss: 0.1638 | reg_loss: 0.3031 | reward: -0.2110 | rev_kl: 0.6230 | stu_lens: 128.0000 | mixed_lens: 107.5000 | lr: 1.2343e-06 | scale: 256.00 | time: 27.188 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   3386/  5000| tot_loss: 2.3873 | rl_loss: 0.3497 | pt_loss: 2.0376 | pg_loss: -0.0222 | reg_loss: 0.3718 | reward: -0.0627 | rev_kl: 0.5284 | stu_lens: 100.0000 | mixed_lens: 128.0000 | lr: 1.2329e-06 | scale: 256.00 | time: 27.160 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   3387/  5000| tot_loss: 2.6442 | rl_loss: 0.6818 | pt_loss: 1.9624 | pg_loss: 0.1699 | reg_loss: 0.5118 | reward: -0.2081 | rev_kl: 0.6797 | stu_lens: 92.5000 | mixed_lens: 85.5000 | lr: 1.2315e-06 | scale: 256.00 | time: 27.172 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   3388/  5000| tot_loss: 2.1735 | rl_loss: 0.4653 | pt_loss: 1.7082 | pg_loss: 0.1613 | reg_loss: 0.3039 | reward: -0.2192 | rev_kl: 0.3850 | stu_lens: 63.5000 | mixed_lens: 79.0000 | lr: 1.2302e-06 | scale: 256.00 | time: 27.157 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   3389/  5000| tot_loss: 2.6390 | rl_loss: 0.6795 | pt_loss: 1.9595 | pg_loss: 0.1840 | reg_loss: 0.4955 | reward: -0.4409 | rev_kl: 0.7235 | stu_lens: 83.5000 | mixed_lens: 91.5000 | lr: 1.2288e-06 | scale: 256.00 | time: 27.202 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   3390/  5000| tot_loss: 1.9732 | rl_loss: 0.4251 | pt_loss: 1.5480 | pg_loss: -0.0191 | reg_loss: 0.4442 | reward: -0.1951 | rev_kl: 0.6680 | stu_lens: 119.5000 | mixed_lens: 128.0000 | lr: 1.2274e-06 | scale: 256.00 | time: 27.162 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   3391/  5000| tot_loss: 2.4229 | rl_loss: 0.5541 | pt_loss: 1.8688 | pg_loss: -0.0047 | reg_loss: 0.5588 | reward: -0.3671 | rev_kl: 0.7949 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.2260e-06 | scale: 256.00 | time: 27.193 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3392/  5000| tot_loss: 2.9263 | rl_loss: 1.2034 | pt_loss: 1.7229 | pg_loss: 0.7142 | reg_loss: 0.4892 | reward: -0.4309 | rev_kl: 0.8638 | stu_lens: 100.0000 | mixed_lens: 67.0000 | lr: 1.2246e-06 | scale: 256.00 | time: 27.168 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3392/  5000| tot_loss: 2.3561 | rl_loss: 0.6030 | pt_loss: 1.7531 | pg_loss: 0.1962 | reg_loss: 0.4068 | reward: -0.1101 | rev_kl: 0.7829 | stu_lens: 97.2969 | mixed_lens: 98.1875 | lr: 1.2246e-06 | scale: 256.00 | time: 27.168 | step time: 28.409
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   3393/  5000| tot_loss: 2.4343 | rl_loss: 0.4997 | pt_loss: 1.9345 | pg_loss: 0.0815 | reg_loss: 0.4182 | reward: -0.3013 | rev_kl: 0.7312 | stu_lens: 128.0000 | mixed_lens: 88.0000 | lr: 1.2233e-06 | scale: 256.00 | time: 27.193 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:   3394/  5000| tot_loss: 2.6055 | rl_loss: 1.0859 | pt_loss: 1.5196 | pg_loss: 0.3078 | reg_loss: 0.7780 | reward: 0.4957 | rev_kl: 0.6698 | stu_lens: 96.0000 | mixed_lens: 62.0000 | lr: 1.2219e-06 | scale: 256.00 | time: 27.257 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:   3395/  5000| tot_loss: 2.3731 | rl_loss: 0.7441 | pt_loss: 1.6289 | pg_loss: 0.2389 | reg_loss: 0.5052 | reward: -0.0821 | rev_kl: 0.6743 | stu_lens: 98.5000 | mixed_lens: 98.0000 | lr: 1.2205e-06 | scale: 256.00 | time: 27.164 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:   3396/  5000| tot_loss: 2.5631 | rl_loss: 0.7652 | pt_loss: 1.7979 | pg_loss: 0.0395 | reg_loss: 0.7257 | reward: -0.0828 | rev_kl: 0.7120 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.2191e-06 | scale: 256.00 | time: 27.185 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:   3397/  5000| tot_loss: 2.9629 | rl_loss: 1.3428 | pt_loss: 1.6202 | pg_loss: 0.4646 | reg_loss: 0.8782 | reward: -0.6532 | rev_kl: 0.7305 | stu_lens: 59.5000 | mixed_lens: 70.5000 | lr: 1.2178e-06 | scale: 256.00 | time: 27.156 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:   3398/  5000| tot_loss: 1.6972 | rl_loss: 0.8021 | pt_loss: 0.8951 | pg_loss: 0.0567 | reg_loss: 0.7453 | reward: -0.1404 | rev_kl: 0.8050 | stu_lens: 121.5000 | mixed_lens: 128.0000 | lr: 1.2164e-06 | scale: 256.00 | time: 27.189 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:   3399/  5000| tot_loss: 3.7784 | rl_loss: 1.5738 | pt_loss: 2.2047 | pg_loss: 0.6616 | reg_loss: 0.9122 | reward: -0.6254 | rev_kl: 0.9918 | stu_lens: 128.0000 | mixed_lens: 57.0000 | lr: 1.2150e-06 | scale: 256.00 | time: 27.146 | step time: 0.000
                                 Evaluation #34                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Cuáles son los distintos tipos de    │ ¿Cuáles son los distintos tipos de   │
│ cuarks en física de partículas?       │ cuarks en física de partículas?      │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cuarks están divididos en tres   │
│                                       │ familias:                            │
│                                       │                                      │
│                                       │ - Cuark de color (o criptonio): Es   │
│                                       │ un cuark que se ha descubierto que   │
│                                       │ existe, y que es el responsable de   │
│                                       │ la fuerza nuclear de la materia. Los │
│                                       │ cuarks de color son de una sola      │
│                                       │ especie, ya que son fermiones.       │
│                                       │ - Cuark de estilo (o stylio): Son    │
│                                       │ cuarks que hay que imaginar, ya que  │
│                                       │ ninguno de ellos se ha podido ver.   │
│                                       │ Estos son los responsables de la     │
│                                       │ fuerza de la interacción físiica de  │
│                                       │ la materia. Son                      │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ ¿Qué es el IMC? ¿Cuál es su utilidad? │ ¿Qué es el IMC? ¿Cuál es su          │
│                                       │ utilidad?                            │
│ ### Respuesta:                        │                                      │
│                                       │ ### Respuesta:                       │
│                                       │ El IMC es un acrónimo de Interactive │
│                                       │ Marketing Communications, y se       │
│                                       │ refiere a la interacción que marca   │
│                                       │ la comunicación entre un emisor y un │
│                                       │ receptor. Esto puede referirse a la  │
│                                       │ interacción entre un anunciante y un │
│                                       │ espectador, o entre un vendedor y un │
│                                       │ cliente.                             │
│                                       │                                      │
│                                       │ El IMC puede ser utilizado para      │
│                                       │ mejorar la eficacia de la            │
│                                       │ comunicación a través de la          │
│                                       │ interacción. Por ejemplo, un         │
│                                       │ anunciante puede utilizar la         │
│                                       │ interacción para mejorar la entrega  │
│                                       │ de información sobre un producto     │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Debajo hay una instrucción que        │ Debajo hay una instrucción que       │
│ describe una tarea. Escribe una       │ describe una tarea. Escribe una      │
│ respuesta que complete adecuadamente  │ respuesta que complete adecuadamente │
│ la solicitud.                         │ la solicitud.                        │
│                                       │                                      │
│ ### Instrucción:                      │ ### Instrucción:                     │
│ Elabora una lista con las cápsulas    │ Elabora una lista con las cápsulas   │
│ del tiempo más famosas de la          │ del tiempo más famosas de la         │
│ historia, especificando las fechas en │ historia, especificando las fechas   │
│ las que fueron creadas, y en el caso  │ en las que fueron creadas, y en el   │
│ de que hayan sido abiertas, el        │ caso de que hayan sido abiertas, el  │
│ contenido además de la fecha de       │ contenido además de la fecha de      │
│ apertura.                             │ apertura.                            │
│                                       │                                      │
│ ### Respuesta:                        │ ### Respuesta:                       │
│                                       │ Los cronómetros de la navegación,    │
│                                       │ del siglo XVIII, de los cuales se    │
│                                       │ han encontrado ejemplares que datan  │
│                                       │ de poco antes de la llamada "Edad de │
│                                       │ la Luz" (a partir del siglo XVI).    │
│                                       │                                      │
│                                       │ Los cápsulas del tiempo son pequeños │
│                                       │ recipientes que contienen un diario  │
│                                       │ o una lista de fecha, donde se anota │
│                                       │ la fecha de apertura y el contenido. │
│                                       │ El sistema de cápsulas del tiempo    │
│                                       │ fue inventado por el historiador     │
│                                       │ británico John Thorpe, quien empezó  │
│                                       │ a utilizarlo en 1844.                │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.826 | exact_match: 0.000 | rev_kl: 0.844 | lens: 94.600 | pt_loss: 1.725 | lm_loss: 1.855 | kd_loss: 1.596 
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:   3400/  5000| tot_loss: 3.1551 | rl_loss: 1.3037 | pt_loss: 1.8514 | pg_loss: 0.3220 | reg_loss: 0.9817 | reward: -0.3255 | rev_kl: 0.6803 | stu_lens: 94.0000 | mixed_lens: 96.5000 | lr: 1.2136e-06 | scale: 256.00 | time: 27.191 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:   3401/  5000| tot_loss: 2.9171 | rl_loss: 1.1171 | pt_loss: 1.8000 | pg_loss: 0.2691 | reg_loss: 0.8479 | reward: -0.1501 | rev_kl: 0.6883 | stu_lens: 81.0000 | mixed_lens: 103.5000 | lr: 1.2123e-06 | scale: 256.00 | time: 27.189 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:   3402/  5000| tot_loss: 2.7320 | rl_loss: 0.8350 | pt_loss: 1.8971 | pg_loss: 0.0379 | reg_loss: 0.7970 | reward: -0.1487 | rev_kl: 1.0853 | stu_lens: 117.0000 | mixed_lens: 128.0000 | lr: 1.2109e-06 | scale: 256.00 | time: 27.150 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:   3403/  5000| tot_loss: 3.0175 | rl_loss: 1.3068 | pt_loss: 1.7107 | pg_loss: 0.4471 | reg_loss: 0.8596 | reward: -0.2118 | rev_kl: 1.0402 | stu_lens: 72.0000 | mixed_lens: 50.0000 | lr: 1.2095e-06 | scale: 256.00 | time: 27.168 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:   3404/  5000| tot_loss: 3.0793 | rl_loss: 1.1738 | pt_loss: 1.9055 | pg_loss: 0.2956 | reg_loss: 0.8782 | reward: -0.1867 | rev_kl: 0.8085 | stu_lens: 79.0000 | mixed_lens: 76.5000 | lr: 1.2081e-06 | scale: 256.00 | time: 27.182 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:   3405/  5000| tot_loss: 2.6874 | rl_loss: 0.9808 | pt_loss: 1.7065 | pg_loss: 0.1176 | reg_loss: 0.8632 | reward: -0.1712 | rev_kl: 0.8852 | stu_lens: 121.0000 | mixed_lens: 108.0000 | lr: 1.2068e-06 | scale: 256.00 | time: 27.190 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:   3406/  5000| tot_loss: 2.5917 | rl_loss: 1.0202 | pt_loss: 1.5715 | pg_loss: 0.3266 | reg_loss: 0.6936 | reward: -0.1100 | rev_kl: 0.4633 | stu_lens: 65.5000 | mixed_lens: 57.5000 | lr: 1.2054e-06 | scale: 256.00 | time: 27.146 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:   3407/  5000| tot_loss: 2.7045 | rl_loss: 0.8776 | pt_loss: 1.8270 | pg_loss: 0.0566 | reg_loss: 0.8210 | reward: -0.1824 | rev_kl: 0.4934 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.2040e-06 | scale: 256.00 | time: 27.148 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3408/  5000| tot_loss: 2.7214 | rl_loss: 1.3972 | pt_loss: 1.3242 | pg_loss: 0.5282 | reg_loss: 0.8689 | reward: -0.2556 | rev_kl: 0.7850 | stu_lens: 110.5000 | mixed_lens: 52.5000 | lr: 1.2026e-06 | scale: 256.00 | time: 27.121 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:   3408/  5000| tot_loss: 2.7902 | rl_loss: 1.0943 | pt_loss: 1.6958 | pg_loss: 0.2967 | reg_loss: 0.7976 | reward: -0.1978 | rev_kl: 0.7160 | stu_lens: 98.5469 | mixed_lens: 89.7812 | lr: 1.2026e-06 | scale: 256.00 | time: 27.121 | step time: 28.405
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:   3409/  5000| tot_loss: 2.7747 | rl_loss: 1.0993 | pt_loss: 1.6755 | pg_loss: 0.3800 | reg_loss: 0.7193 | reward: -0.3762 | rev_kl: 1.0900 | stu_lens: 59.0000 | mixed_lens: 83.5000 | lr: 1.2013e-06 | scale: 256.00 | time: 27.169 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:   3410/  5000| tot_loss: 2.8494 | rl_loss: 0.9482 | pt_loss: 1.9012 | pg_loss: 0.3052 | reg_loss: 0.6430 | reward: -0.2285 | rev_kl: 0.9191 | stu_lens: 81.0000 | mixed_lens: 84.5000 | lr: 1.1999e-06 | scale: 256.00 | time: 27.147 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:   3411/  5000| tot_loss: 3.2675 | rl_loss: 1.2823 | pt_loss: 1.9853 | pg_loss: 0.5469 | reg_loss: 0.7354 | reward: -0.1150 | rev_kl: 0.3590 | stu_lens: 65.5000 | mixed_lens: 65.5000 | lr: 1.1985e-06 | scale: 256.00 | time: 27.178 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:   3412/  5000| tot_loss: 2.0880 | rl_loss: 0.7953 | pt_loss: 1.2928 | pg_loss: 0.0726 | reg_loss: 0.7227 | reward: -0.2404 | rev_kl: 0.9272 | stu_lens: 81.0000 | mixed_lens: 91.0000 | lr: 1.1972e-06 | scale: 256.00 | time: 27.174 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:   3413/  5000| tot_loss: 2.3636 | rl_loss: 0.7150 | pt_loss: 1.6486 | pg_loss: -0.0066 | reg_loss: 0.7215 | reward: -0.0617 | rev_kl: 1.0310 | stu_lens: 109.5000 | mixed_lens: 128.0000 | lr: 1.1958e-06 | scale: 256.00 | time: 27.169 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:   3414/  5000| tot_loss: 2.8065 | rl_loss: 0.6715 | pt_loss: 2.1350 | pg_loss: -0.0033 | reg_loss: 0.6748 | reward: -0.1742 | rev_kl: 0.4155 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.1944e-06 | scale: 256.00 | time: 27.149 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:   3415/  5000| tot_loss: 2.9565 | rl_loss: 1.0145 | pt_loss: 1.9420 | pg_loss: 0.2370 | reg_loss: 0.7775 | reward: -0.5917 | rev_kl: 0.7037 | stu_lens: 128.0000 | mixed_lens: 89.5000 | lr: 1.1931e-06 | scale: 256.00 | time: 27.172 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:   3416/  5000| tot_loss: 2.6717 | rl_loss: 0.8237 | pt_loss: 1.8481 | pg_loss: 0.2572 | reg_loss: 0.5664 | reward: -0.4205 | rev_kl: 0.8184 | stu_lens: 89.5000 | mixed_lens: 89.5000 | lr: 1.1917e-06 | scale: 256.00 | time: 27.152 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:   3417/  5000| tot_loss: 3.0893 | rl_loss: 0.8810 | pt_loss: 2.2082 | pg_loss: 0.2510 | reg_loss: 0.6301 | reward: -0.2340 | rev_kl: 0.9782 | stu_lens: 128.0000 | mixed_lens: 95.5000 | lr: 1.1903e-06 | scale: 256.00 | time: 27.190 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:   3418/  5000| tot_loss: 2.7171 | rl_loss: 0.8406 | pt_loss: 1.8765 | pg_loss: 0.1606 | reg_loss: 0.6800 | reward: -0.3037 | rev_kl: 0.8089 | stu_lens: 95.5000 | mixed_lens: 98.0000 | lr: 1.1890e-06 | scale: 256.00 | time: 27.153 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:   3419/  5000| tot_loss: 3.3110 | rl_loss: 1.5569 | pt_loss: 1.7541 | pg_loss: 1.0530 | reg_loss: 0.5038 | reward: 0.2107 | rev_kl: 0.4071 | stu_lens: 119.0000 | mixed_lens: 30.5000 | lr: 1.1876e-06 | scale: 256.00 | time: 27.168 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:   3420/  5000| tot_loss: 2.7526 | rl_loss: 0.7953 | pt_loss: 1.9573 | pg_loss: 0.3451 | reg_loss: 0.4502 | reward: -0.2109 | rev_kl: 0.4569 | stu_lens: 101.5000 | mixed_lens: 77.5000 | lr: 1.1862e-06 | scale: 256.00 | time: 27.166 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:   3421/  5000| tot_loss: 2.9249 | rl_loss: 1.1803 | pt_loss: 1.7446 | pg_loss: 0.3369 | reg_loss: 0.8435 | reward: -0.1429 | rev_kl: 0.7348 | stu_lens: 79.0000 | mixed_lens: 76.5000 | lr: 1.1849e-06 | scale: 256.00 | time: 27.179 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:   3422/  5000| tot_loss: 2.7915 | rl_loss: 0.7350 | pt_loss: 2.0565 | pg_loss: 0.2826 | reg_loss: 0.4524 | reward: 0.2450 | rev_kl: 0.6506 | stu_lens: 56.5000 | mixed_lens: 32.5000 | lr: 1.1835e-06 | scale: 256.00 | time: 27.184 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:   3423/  5000| tot_loss: 2.7448 | rl_loss: 1.1639 | pt_loss: 1.5809 | pg_loss: 0.5373 | reg_loss: 0.6266 | reward: -0.3079 | rev_kl: 0.6772 | stu_lens: 98.5000 | mixed_lens: 70.0000 | lr: 1.1822e-06 | scale: 256.00 | time: 27.173 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3424/  5000| tot_loss: 2.1647 | rl_loss: 0.6148 | pt_loss: 1.5498 | pg_loss: 0.2094 | reg_loss: 0.4054 | reward: -0.1399 | rev_kl: 0.7832 | stu_lens: 128.0000 | mixed_lens: 88.5000 | lr: 1.1808e-06 | scale: 256.00 | time: 27.153 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:   3424/  5000| tot_loss: 2.6907 | rl_loss: 0.9232 | pt_loss: 1.7675 | pg_loss: 0.2505 | reg_loss: 0.6727 | reward: -0.2167 | rev_kl: 0.7464 | stu_lens: 98.5156 | mixed_lens: 90.1094 | lr: 1.1808e-06 | scale: 256.00 | time: 27.153 | step time: 28.396
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:   3425/  5000| tot_loss: 2.5188 | rl_loss: 0.8956 | pt_loss: 1.6233 | pg_loss: 0.2362 | reg_loss: 0.6594 | reward: 0.1119 | rev_kl: 0.5185 | stu_lens: 66.5000 | mixed_lens: 67.0000 | lr: 1.1794e-06 | scale: 256.00 | time: 27.168 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:   3426/  5000| tot_loss: 2.4882 | rl_loss: 0.6209 | pt_loss: 1.8673 | pg_loss: 0.0060 | reg_loss: 0.6149 | reward: -0.2544 | rev_kl: 0.9846 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.1781e-06 | scale: 256.00 | time: 27.161 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:   3427/  5000| tot_loss: 3.0228 | rl_loss: 1.1246 | pt_loss: 1.8981 | pg_loss: 0.3452 | reg_loss: 0.7794 | reward: -0.2096 | rev_kl: 1.0516 | stu_lens: 81.0000 | mixed_lens: 84.5000 | lr: 1.1767e-06 | scale: 256.00 | time: 27.178 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:   3428/  5000| tot_loss: 2.3557 | rl_loss: 0.6171 | pt_loss: 1.7386 | pg_loss: 0.2762 | reg_loss: 0.3408 | reward: -0.1145 | rev_kl: 0.4432 | stu_lens: 87.0000 | mixed_lens: 83.0000 | lr: 1.1754e-06 | scale: 256.00 | time: 27.165 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:   3429/  5000| tot_loss: 2.4962 | rl_loss: 0.8999 | pt_loss: 1.5963 | pg_loss: 0.2103 | reg_loss: 0.6896 | reward: -0.4382 | rev_kl: 0.5807 | stu_lens: 119.0000 | mixed_lens: 79.5000 | lr: 1.1740e-06 | scale: 256.00 | time: 27.197 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:   3430/  5000| tot_loss: 2.2801 | rl_loss: 0.6182 | pt_loss: 1.6619 | pg_loss: -0.0075 | reg_loss: 0.6257 | reward: -0.1656 | rev_kl: 1.0831 | stu_lens: 124.5000 | mixed_lens: 128.0000 | lr: 1.1726e-06 | scale: 256.00 | time: 27.196 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:   3431/  5000| tot_loss: 2.7017 | rl_loss: 0.7588 | pt_loss: 1.9429 | pg_loss: 0.1829 | reg_loss: 0.5759 | reward: -0.2662 | rev_kl: 1.0106 | stu_lens: 83.0000 | mixed_lens: 96.5000 | lr: 1.1713e-06 | scale: 256.00 | time: 27.234 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   3432/  5000| tot_loss: 2.3770 | rl_loss: 0.6562 | pt_loss: 1.7208 | pg_loss: 0.1672 | reg_loss: 0.4890 | reward: -0.2751 | rev_kl: 1.1018 | stu_lens: 117.0000 | mixed_lens: 95.5000 | lr: 1.1699e-06 | scale: 256.00 | time: 27.185 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:   3433/  5000| tot_loss: 3.0963 | rl_loss: 1.2786 | pt_loss: 1.8177 | pg_loss: 0.8802 | reg_loss: 0.3984 | reward: -0.2067 | rev_kl: 0.3822 | stu_lens: 33.0000 | mixed_lens: 51.0000 | lr: 1.1686e-06 | scale: 256.00 | time: 27.226 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:   3434/  5000| tot_loss: 2.1518 | rl_loss: 0.3560 | pt_loss: 1.7959 | pg_loss: 0.0263 | reg_loss: 0.3297 | reward: 0.4020 | rev_kl: 0.6892 | stu_lens: 47.0000 | mixed_lens: 19.0000 | lr: 1.1672e-06 | scale: 256.00 | time: 27.155 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:   3435/  5000| tot_loss: 2.5740 | rl_loss: 0.8046 | pt_loss: 1.7694 | pg_loss: 0.2379 | reg_loss: 0.5667 | reward: -0.5279 | rev_kl: 0.8049 | stu_lens: 121.5000 | mixed_lens: 89.5000 | lr: 1.1659e-06 | scale: 256.00 | time: 27.182 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:   3436/  5000| tot_loss: 2.1789 | rl_loss: 0.4130 | pt_loss: 1.7659 | pg_loss: -0.0154 | reg_loss: 0.4284 | reward: -0.1574 | rev_kl: 0.5451 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.1645e-06 | scale: 256.00 | time: 27.172 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:   3437/  5000| tot_loss: 2.1254 | rl_loss: 0.3658 | pt_loss: 1.7596 | pg_loss: 0.0287 | reg_loss: 0.3371 | reward: -0.1164 | rev_kl: 1.0907 | stu_lens: 97.5000 | mixed_lens: 122.0000 | lr: 1.1631e-06 | scale: 256.00 | time: 27.211 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:   3438/  5000| tot_loss: 1.9563 | rl_loss: 0.7968 | pt_loss: 1.1596 | pg_loss: 0.3168 | reg_loss: 0.4800 | reward: 0.5188 | rev_kl: 0.5268 | stu_lens: 101.0000 | mixed_lens: 74.5000 | lr: 1.1618e-06 | scale: 256.00 | time: 27.233 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:   3439/  5000| tot_loss: 3.1948 | rl_loss: 0.7917 | pt_loss: 2.4031 | pg_loss: 0.5890 | reg_loss: 0.2027 | reward: -0.1295 | rev_kl: 0.6600 | stu_lens: 110.5000 | mixed_lens: 41.0000 | lr: 1.1604e-06 | scale: 256.00 | time: 27.254 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3440/  5000| tot_loss: 2.6223 | rl_loss: 0.4635 | pt_loss: 2.1588 | pg_loss: 0.0236 | reg_loss: 0.4400 | reward: -0.0878 | rev_kl: 0.6405 | stu_lens: 101.5000 | mixed_lens: 128.0000 | lr: 1.1591e-06 | scale: 256.00 | time: 27.183 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:   3440/  5000| tot_loss: 2.5605 | rl_loss: 0.7984 | pt_loss: 1.7621 | pg_loss: 0.2773 | reg_loss: 0.5210 | reward: -0.2185 | rev_kl: 0.7315 | stu_lens: 93.5781 | mixed_lens: 87.5625 | lr: 1.1591e-06 | scale: 256.00 | time: 27.183 | step time: 28.422
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:   3441/  5000| tot_loss: 1.8474 | rl_loss: 0.4263 | pt_loss: 1.4210 | pg_loss: 0.0365 | reg_loss: 0.3898 | reward: -0.0996 | rev_kl: 0.6374 | stu_lens: 128.0000 | mixed_lens: 119.5000 | lr: 1.1577e-06 | scale: 256.00 | time: 27.237 | step time: 0.000
train | data_epochs  1/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:   3442/  5000| tot_loss: 2.2410 | rl_loss: 0.5923 | pt_loss: 1.6487 | pg_loss: -0.0042 | reg_loss: 0.5965 | reward: -0.2323 | rev_kl: 0.9188 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.1564e-06 | scale: 256.00 | time: 27.182 | step time: 0.000
train | data_epochs  1/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:   3443/  5000| tot_loss: 2.2855 | rl_loss: 0.2867 | pt_loss: 1.9988 | pg_loss: -0.0088 | reg_loss: 0.2955 | reward: -0.1633 | rev_kl: 0.4795 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.1550e-06 | scale: 256.00 | time: 27.206 | step time: 0.000
train | data_epochs  1/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:   3444/  5000| tot_loss: 2.4881 | rl_loss: 0.6326 | pt_loss: 1.8555 | pg_loss: 0.1779 | reg_loss: 0.4547 | reward: -0.3291 | rev_kl: 0.8309 | stu_lens: 72.0000 | mixed_lens: 64.0000 | lr: 1.1537e-06 | scale: 256.00 | time: 27.196 | step time: 0.000
train | data_epochs  1/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:   3445/  5000| tot_loss: 2.4813 | rl_loss: 0.5017 | pt_loss: 1.9796 | pg_loss: 0.0459 | reg_loss: 0.4558 | reward: -0.2090 | rev_kl: 0.8031 | stu_lens: 101.0000 | mixed_lens: 112.5000 | lr: 1.1523e-06 | scale: 256.00 | time: 27.262 | step time: 0.000
train | data_epochs  1/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:   3446/  5000| tot_loss: 2.7216 | rl_loss: 0.8536 | pt_loss: 1.8680 | pg_loss: 0.3544 | reg_loss: 0.4992 | reward: -0.2212 | rev_kl: 1.1281 | stu_lens: 128.0000 | mixed_lens: 78.0000 | lr: 1.1510e-06 | scale: 256.00 | time: 27.228 | step time: 0.000
train | data_epochs  1/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:   3447/  5000| tot_loss: 2.3981 | rl_loss: 0.5588 | pt_loss: 1.8393 | pg_loss: 0.1799 | reg_loss: 0.3789 | reward: -0.1704 | rev_kl: 0.6381 | stu_lens: 87.0000 | mixed_lens: 83.0000 | lr: 1.1496e-06 | scale: 256.00 | time: 27.223 | step time: 0.000
train | data_epochs  1/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:   3448/  5000| tot_loss: 3.0273 | rl_loss: 1.2700 | pt_loss: 1.7573 | pg_loss: 0.7998 | reg_loss: 0.4702 | reward: 0.3667 | rev_kl: 0.8856 | stu_lens: 49.0000 | mixed_lens: 27.0000 | lr: 1.1483e-06 | scale: 256.00 | time: 27.185 | step time: 0.000
train | data_epochs  1/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:   3449/  5000| tot_loss: 2.5490 | rl_loss: 0.7366 | pt_loss: 1.8124 | pg_loss: 0.2394 | reg_loss: 0.4971 | reward: -0.1889 | rev_kl: 0.9879 | stu_lens: 68.0000 | mixed_lens: 76.5000 | lr: 1.1469e-06 | scale: 256.00 | time: 27.194 | step time: 0.000
train | data_epochs  1/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:   3450/  5000| tot_loss: 2.1765 | rl_loss: 0.2839 | pt_loss: 1.8926 | pg_loss: -0.0005 | reg_loss: 0.2844 | reward: -0.1126 | rev_kl: 1.0394 | stu_lens: 97.5000 | mixed_lens: 122.0000 | lr: 1.1456e-06 | scale: 256.00 | time: 27.174 | step time: 0.000
train | data_epochs  1/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:   3451/  5000| tot_loss: 2.9288 | rl_loss: 1.0767 | pt_loss: 1.8521 | pg_loss: 0.6035 | reg_loss: 0.4732 | reward: -0.4498 | rev_kl: 0.5966 | stu_lens: 88.5000 | mixed_lens: 69.5000 | lr: 1.1442e-06 | scale: 256.00 | time: 27.203 | step time: 0.000
train | data_epochs  1/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:   3452/  5000| tot_loss: 2.7017 | rl_loss: 0.5253 | pt_loss: 2.1764 | pg_loss: 0.0581 | reg_loss: 0.4672 | reward: -0.3192 | rev_kl: 0.6818 | stu_lens: 128.0000 | mixed_lens: 110.0000 | lr: 1.1429e-06 | scale: 256.00 | time: 27.205 | step time: 0.000
train | data_epochs  1/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:   3453/  5000| tot_loss: 2.6535 | rl_loss: 0.8536 | pt_loss: 1.7999 | pg_loss: 0.3539 | reg_loss: 0.4997 | reward: 0.5649 | rev_kl: 0.7355 | stu_lens: 128.0000 | mixed_lens: 74.5000 | lr: 1.1415e-06 | scale: 256.00 | time: 27.222 | step time: 0.000
train | data_epochs  1/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:   3454/  5000| tot_loss: 2.5679 | rl_loss: 0.5742 | pt_loss: 1.9937 | pg_loss: -0.0043 | reg_loss: 0.5785 | reward: -0.2389 | rev_kl: 0.7000 | stu_lens: 124.5000 | mixed_lens: 128.0000 | lr: 1.1402e-06 | scale: 256.00 | time: 27.260 | step time: 0.000
train | data_epochs  1/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:   3455/  5000| tot_loss: 2.4689 | rl_loss: 0.7590 | pt_loss: 1.7099 | pg_loss: 0.2930 | reg_loss: 0.4660 | reward: -0.6197 | rev_kl: 0.8463 | stu_lens: 69.5000 | mixed_lens: 91.5000 | lr: 1.1389e-06 | scale: 256.00 | time: 27.200 | step time: 0.000
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3456/  5000| tot_loss: 1.9143 | rl_loss: 0.4583 | pt_loss: 1.4560 | pg_loss: -0.0175 | reg_loss: 0.4758 | reward: -0.1072 | rev_kl: 0.5573 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.1375e-06 | scale: 256.00 | time: 27.184 | step time: 0.000
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:   3456/  5000| tot_loss: 2.4743 | rl_loss: 0.6996 | pt_loss: 1.7746 | pg_loss: 0.2830 | reg_loss: 0.4166 | reward: -0.2050 | rev_kl: 0.7419 | stu_lens: 98.7969 | mixed_lens: 88.7031 | lr: 1.1375e-06 | scale: 256.00 | time: 27.184 | step time: 28.439
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  1/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:   3457/  5000| tot_loss: 2.1701 | rl_loss: 0.4834 | pt_loss: 1.6867 | pg_loss: 0.0206 | reg_loss: 0.4628 | reward: -0.1316 | rev_kl: 0.6346 | stu_lens: 95.0000 | mixed_lens: 128.0000 | lr: 1.1362e-06 | scale: 256.00 | time: 27.191 | step time: 0.000
