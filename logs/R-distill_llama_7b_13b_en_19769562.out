Wed Dec 13 16:07:20 2023       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.104.12             Driver Version: 535.104.12   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA H100 PCIe               On  | 00000000:41:00.0 Off |                    0 |
| N/A   28C    P0              46W / 350W |      4MiB / 81559MiB |      0%   E. Process |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
python3 -m torch.distributed.run --nproc_per_node 1 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 3017 /dtu/p1/johlau/LMOps/minillm/train_minillm.py --base-path /dtu/p1/johlau/LMOps/minillm --model-path /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_init/llama-7B --teacher-model-path /dtu/p1/johlau/LMOps/minillm/results/llama/train/sft/llama-13B --ckpt-name 7B-init --teacher-ckpt-name 13B-sft --n-gpu 1 --n-nodes 1 --model-type llama --teacher-model-fp16 --gradient-checkpointing --prompt-data-dir /dtu/p1/johlau/LMOps/minillm/processed_data/dolly_en/prompt/llama/ --lm-data-dir /dtu/p1/johlau/LMOps/minillm/processed_data/roberta_en/llama/256/20M/ --dev-num 1000 --num-workers 0 --epochs 10 --total-iters 1000 --kd-ratio 0.5 --batch-size 2 --eval-batch-size 4 --lr 5e-6 --lr-min 5e-6 --gradient-accumulation-steps 2 --max-length 256 --max-prompt-length 128 --warmup-iters 100 --scheduler-name cosine_trm --save /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/ --seed 10 --seed-ppo 42 --seed-lm 7 --save-interval 500 --eval-interval 100 --log-interval 16 --mid-log-num 1 --type minillm --ppo-epochs 4 --num-rollouts 64 --chunk-size 2 --length-norm --single-step-reg --teacher-mixed-alpha 0.2 --reward-scaling 0.5 --cliprange-reward 100 --do-sample --top-k 0 --top-p 1.0 --temperature 1.0 --deepspeed --deepspeed_config /dtu/p1/johlau/LMOps/minillm/configs/deepspeed/ds_config_zero2_offload.json /dtu/p1/johlau/LMOps/minillm 3017
PYTHONPATH=/dtu/p1/johlau/LMOps/minillm
[2023-12-13 16:07:26,559] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
using world size: 1
[2023-12-13 16:07:28,166] [INFO] [comm.py:637:init_distributed] cdb=None
[2023-12-13 16:07:28,166] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_path ................... /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_init/llama-7B
  ckpt_name .................... 7B-init
  model_type ................... llama
  teacher_model_type ........... None
  n_gpu ........................ 1
  n_nodes ...................... 1
  teacher_model_path ........... /dtu/p1/johlau/LMOps/minillm/results/llama/train/sft/llama-13B
  teacher_ckpt_name ............ 13B-sft
  teacher_model_fp16 ........... True
  model_parallel ............... False
  model_parallel_size .......... None
  no_value ..................... False
  dropout_path_rate ............ None
  fp32 ......................... False
  type ......................... minillm
  do_train ..................... False
  do_valid ..................... False
  do_eval ...................... False
  base_path .................... /dtu/p1/johlau/LMOps/minillm
  load ......................... None
  save ......................... /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
  log_interval ................. 16
  mid_log_num .................. 1
  save_interval ................ 500
  eval_interval ................ 100
  local_rank ................... 0
  save_additional_suffix ....... 
  save_rollout ................. False
  eb_sample_times .............. 3
  data_dir ..................... None
  processed_data_dir ........... None
  force_process ................ False
  force_process_demo ........... False
  data_process_workers ......... -1
  train_num .................... -1
  train_ratio .................. 1
  dev_num ...................... 1000
  dev_ratio .................... 1
  gen_num ...................... -1
  data_names ................... None
  prompt_type .................. None
  num_workers .................. 0
  max_prompt_length ............ 128
  min_prompt_length ............ 64
  json_data .................... False
  bin_data ..................... False
  txt_data ..................... False
  prompt_data_dir .............. /dtu/p1/johlau/LMOps/minillm/processed_data/dolly_en/prompt/llama/
  lm_data_dir .................. /dtu/p1/johlau/LMOps/minillm/processed_data/roberta_en/llama/256/20M/
  eval_ppl ..................... False
  eval_rw ...................... False
  eval_gen ..................... False
  only_prompt .................. False
  batch_size ................... 2
  eval_batch_size .............. 4
  clip_grad .................... 1.0
  total_iters .................. 1000
  train_iters_per_epoch ........ -1
  max_length ................... 256
  seed ......................... 10
  seed_order ................... 42
  seed_data .................... 42
  seed_ppo ..................... 42
  seed_lm ...................... 7
  epochs ....................... 10
  training_epochs .............. 10000
  gradient_accumulation_steps .. 2
  gradient_checkpointing ....... True
  attn_dtype ................... None
  lr ........................... 5e-06
  lr_min ....................... 5e-06
  weight_decay ................. 0.01
  loss_scale ................... 65536
  kd_ratio ..................... 0.5
  warmup_iters ................. 100
  lr_decay_iters ............... None
  lr_decay_style ............... noam
  scheduler_name ............... cosine_trm
  reward_scaling ............... 0.5
  cliprange_reward ............. 100.0
  ppo_epochs ................... 4
  num_rollouts ................. 64
  num_rollouts_per_device ...... 64
  cliprange .................... 0.2
  chunk_size ................... 2
  gamma ........................ 0.95
  length_norm .................. True
  single_step_reg .............. True
  teacher_mixed_alpha .......... 0.2
  lm_coef ...................... 1
  top_k ........................ 0
  top_p ........................ 1.0
  do_sample .................... True
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  num_beams .................... 1
  temperature .................. 1.0
  peft ......................... None
  peft_lora_r .................. 8
  peft_lora_alpha .............. 32
  peft_lora_dropout ............ 0.1
  peft_name .................... None
  peft_path .................... None
  teacher_peft_name ............ None
  teacher_peft_path ............ None
  deepspeed .................... True
  deepspeed_config ............. /dtu/p1/johlau/LMOps/minillm/configs/deepspeed/ds_config_zero2_offload.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  rank ......................... 0
  world_size ................... 1
 > number of parameters: 13015864320
 > number of parameters: 6738415616
Model load time: 6.110689878463745s
 > number of parameters: 6738M
[2023-12-13 16:07:46,726] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.12.1, git-hash=unknown, git-branch=unknown
[2023-12-13 16:07:47,648] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-12-13 16:07:47,649] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2023-12-13 16:07:47,649] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2023-12-13 16:07:47,661] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = AdamW
[2023-12-13 16:07:47,661] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=AdamW type=<class 'torch.optim.adamw.AdamW'>
[2023-12-13 16:07:47,661] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2023-12-13 16:07:47,661] [INFO] [stage_1_and_2.py:147:__init__] Reduce bucket size 200000000
[2023-12-13 16:07:47,661] [INFO] [stage_1_and_2.py:148:__init__] Allgather bucket size 200000000
[2023-12-13 16:07:47,661] [INFO] [stage_1_and_2.py:149:__init__] CPU Offload: True
[2023-12-13 16:07:47,661] [INFO] [stage_1_and_2.py:150:__init__] Round robin gradient partitioning: False
[2023-12-13 16:07:59,511] [INFO] [utils.py:802:see_memory_usage] Before initializing optimizer states
[2023-12-13 16:07:59,511] [INFO] [utils.py:803:see_memory_usage] MA 37.23 GB         Max_MA 37.23 GB         CA 37.23 GB         Max_CA 37 GB 
[2023-12-13 16:07:59,512] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 58.69 GB, percent = 7.8%
[2023-12-13 16:08:48,598] [INFO] [utils.py:802:see_memory_usage] After initializing optimizer states
[2023-12-13 16:08:48,599] [INFO] [utils.py:803:see_memory_usage] MA 37.23 GB         Max_MA 37.23 GB         CA 37.23 GB         Max_CA 37 GB 
[2023-12-13 16:08:48,600] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 238.5 GB, percent = 31.6%
[2023-12-13 16:08:48,600] [INFO] [stage_1_and_2.py:514:__init__] optimizer state initialized
[2023-12-13 16:08:48,690] [INFO] [utils.py:802:see_memory_usage] After initializing ZeRO optimizer
[2023-12-13 16:08:48,690] [INFO] [utils.py:803:see_memory_usage] MA 37.23 GB         Max_MA 37.23 GB         CA 37.23 GB         Max_CA 37 GB 
[2023-12-13 16:08:48,690] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 238.58 GB, percent = 31.6%
[2023-12-13 16:08:48,698] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = AdamW
[2023-12-13 16:08:48,698] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2023-12-13 16:08:48,699] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <torch.optim.lr_scheduler.LambdaLR object at 0x7fb35bf4e4f0>
[2023-12-13 16:08:48,699] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0], mom=[[0.9, 0.95]]
[2023-12-13 16:08:48,699] [INFO] [config.py:972:print] DeepSpeedEngine configuration:
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   amp_enabled .................. False
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   amp_params ................... False
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   bfloat16_enabled ............. False
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   checkpoint_parallel_write_pipeline  False
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   checkpoint_tag_validation_enabled  True
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   checkpoint_tag_validation_fail  False
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fb35bf4e460>
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   communication_data_type ...... None
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   curriculum_enabled_legacy .... False
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   curriculum_params_legacy ..... False
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   data_efficiency_enabled ...... False
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   dataloader_drop_last ......... False
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   disable_allgather ............ False
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   dump_state ................... False
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 5000, 'delayed_shift': 4, 'consecutive_hysteresis': False, 'min_scale': 1}
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   eigenvalue_enabled ........... False
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   eigenvalue_gas_boundary_resolution  1
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   eigenvalue_layer_num ......... 0
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   eigenvalue_max_iter .......... 100
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   eigenvalue_stability ......... 1e-06
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   eigenvalue_tol ............... 0.01
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   eigenvalue_verbose ........... False
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   elasticity_enabled ........... False
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   fp16_auto_cast ............... False
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   fp16_enabled ................. True
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   fp16_master_weights_and_gradients  False
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   global_rank .................. 0
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   grad_accum_dtype ............. None
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   gradient_accumulation_steps .. 2
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   gradient_clipping ............ 1.0
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   gradient_predivide_factor .... 1.0
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   initial_dynamic_scale ........ 2048
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   load_universal_checkpoint .... False
[2023-12-13 16:08:48,700] [INFO] [config.py:976:print]   loss_scale ................... 0
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   memory_breakdown ............. False
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   mics_hierarchial_params_gather  False
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   mics_shard_size .............. -1
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   optimizer_legacy_fusion ...... False
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   optimizer_name ............... None
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   optimizer_params ............. None
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   pld_enabled .................. False
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   pld_params ................... False
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   prescale_gradients ........... False
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   scheduler_name ............... None
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   scheduler_params ............. None
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   seq_parallel_communication_data_type  torch.float32
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   sparse_attention ............. None
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   sparse_gradients_enabled ..... False
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   steps_per_print .............. 10000000
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   train_batch_size ............. 4
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   train_micro_batch_size_per_gpu  2
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   use_node_local_storage ....... False
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   wall_clock_breakdown ......... False
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   weight_quantization_config ... None
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   world_size ................... 1
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   zero_allow_untested_optimizer  True
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=200000000 allgather_partitions=True allgather_bucket_size=200000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=DeepSpeedZeroOffloadOptimizerConfig(device='cpu', nvme_path=None, buffer_count=4, pin_memory=False, pipeline=False, pipeline_read=False, pipeline_write=False, fast_init=False) sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   zero_enabled ................. True
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   zero_force_ds_cpu_optimizer .. False
[2023-12-13 16:08:48,701] [INFO] [config.py:976:print]   zero_optimization_stage ...... 2
[2023-12-13 16:08:48,701] [INFO] [config.py:962:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 2, 
    "zero_optimization": {
        "stage": 2, 
        "offload_optimizer": {
            "device": "cpu"
        }, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 2.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 2.000000e+08, 
        "contiguous_gradients": true
    }, 
    "zero_force_ds_cpu_optimizer": false, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 5.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1.000000e+07
}
Probing Dataset
Probing end. Max data state 1, total length 22065
Num PPO instances: 22065
Probing Dataset
Probing end. Max data state 1, total length 975
Num PPO instances: 975
Probing Dataset
Probing end. Max data state 1, total length 20000001
Num LM instances: 20000001
Probing Dataset
Probing end. Max data state 1, total length 10000
Num LM instances: 10000
                                 Evaluation #0                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Convert the above time to Pacific     │ Convert the above time to Pacific    │
│ Standard Time.                        │ Standard Time.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 10:17:10 - 7:00:00 = 3:17:10         │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 1970-01-01 + 1731562139499 lol.      │
│                                       │                                      │
│                                       │ PS. There isn't a 1731562139499      │
│                                       │ seconds since 1970 since it will     │
│                                       │ round up to 1731568 years (plus, by  │
│                                       │ the way, you'll miss the second).    │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 1693129600                           │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 11.370 | exact_match: 0.103 | rev_kl: 2.162 | lens: 73.045 | pt_loss: 1.152 | lm_loss: 1.263 | kd_loss: 1.042 
Total Steps: 1000 Data Epochs: 10
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:      2/  1000| tot_loss: 4.1207 | rl_loss: 2.3742 | pt_loss: 1.7465 | pg_loss: 0.0598 | reg_loss: 2.3143 | reward: -0.6635 | rev_kl: 1.8517 | stu_lens: 113.0000 | mixed_lens: 127.5000 | lr: 5.0000e-08 | scale: 2048.00 | time: 26.017 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:      3/  1000| tot_loss: 5.0926 | rl_loss: 3.0285 | pt_loss: 2.0640 | pg_loss: 0.6341 | reg_loss: 2.3944 | reward: -1.4391 | rev_kl: 2.5645 | stu_lens: 94.0000 | mixed_lens: 78.0000 | lr: 1.0000e-07 | scale: 2048.00 | time: 26.449 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:      4/  1000| tot_loss: 4.5356 | rl_loss: 3.0207 | pt_loss: 1.5149 | pg_loss: 0.5538 | reg_loss: 2.4670 | reward: -4.1663 | rev_kl: 2.1518 | stu_lens: 128.0000 | mixed_lens: 67.0000 | lr: 1.5000e-07 | scale: 2048.00 | time: 26.444 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:      5/  1000| tot_loss: 4.2396 | rl_loss: 2.3753 | pt_loss: 1.8642 | pg_loss: 0.0752 | reg_loss: 2.3001 | reward: -0.4234 | rev_kl: 2.0416 | stu_lens: 114.0000 | mixed_lens: 128.0000 | lr: 2.0000e-07 | scale: 2048.00 | time: 26.440 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:      6/  1000| tot_loss: 4.0720 | rl_loss: 2.0833 | pt_loss: 1.9887 | pg_loss: 0.7402 | reg_loss: 1.3432 | reward: -1.2660 | rev_kl: 0.9118 | stu_lens: 57.0000 | mixed_lens: 52.0000 | lr: 2.5000e-07 | scale: 2048.00 | time: 26.418 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:      7/  1000| tot_loss: 4.6055 | rl_loss: 2.5673 | pt_loss: 2.0382 | pg_loss: 0.1192 | reg_loss: 2.4481 | reward: -0.4293 | rev_kl: 1.7690 | stu_lens: 83.5000 | mixed_lens: 123.5000 | lr: 3.0000e-07 | scale: 2048.00 | time: 26.380 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:      8/  1000| tot_loss: 4.3055 | rl_loss: 3.1675 | pt_loss: 1.1380 | pg_loss: 0.4292 | reg_loss: 2.7382 | reward: -1.4660 | rev_kl: 1.8188 | stu_lens: 60.0000 | mixed_lens: 77.0000 | lr: 3.5000e-07 | scale: 2048.00 | time: 26.430 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:      9/  1000| tot_loss: 4.1459 | rl_loss: 2.1815 | pt_loss: 1.9644 | pg_loss: 0.3818 | reg_loss: 1.7997 | reward: -0.4351 | rev_kl: 1.9642 | stu_lens: 105.0000 | mixed_lens: 76.5000 | lr: 4.0000e-07 | scale: 2048.00 | time: 26.387 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:     10/  1000| tot_loss: 4.8744 | rl_loss: 2.3421 | pt_loss: 2.5323 | pg_loss: 0.1240 | reg_loss: 2.2181 | reward: -0.5311 | rev_kl: 2.5727 | stu_lens: 89.5000 | mixed_lens: 118.5000 | lr: 4.5000e-07 | scale: 2048.00 | time: 26.419 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:     11/  1000| tot_loss: 3.5822 | rl_loss: 1.7981 | pt_loss: 1.7841 | pg_loss: 0.3165 | reg_loss: 1.4816 | reward: -0.5343 | rev_kl: 1.7176 | stu_lens: 24.0000 | mixed_lens: 95.5000 | lr: 5.0000e-07 | scale: 2048.00 | time: 26.392 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:     12/  1000| tot_loss: 4.4830 | rl_loss: 2.4479 | pt_loss: 2.0351 | pg_loss: 0.0940 | reg_loss: 2.3539 | reward: -0.5939 | rev_kl: 2.2104 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 5.5000e-07 | scale: 2048.00 | time: 26.402 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:     13/  1000| tot_loss: 3.3938 | rl_loss: 1.5516 | pt_loss: 1.8423 | pg_loss: 0.0376 | reg_loss: 1.5140 | reward: -0.5560 | rev_kl: 2.2435 | stu_lens: 107.5000 | mixed_lens: 128.0000 | lr: 6.0000e-07 | scale: 2048.00 | time: 26.390 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:     14/  1000| tot_loss: 4.2107 | rl_loss: 2.0969 | pt_loss: 2.1138 | pg_loss: 0.4976 | reg_loss: 1.5993 | reward: -1.0358 | rev_kl: 1.9356 | stu_lens: 98.5000 | mixed_lens: 77.0000 | lr: 6.5000e-07 | scale: 2048.00 | time: 26.454 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:     15/  1000| tot_loss: 4.2728 | rl_loss: 2.5409 | pt_loss: 1.7319 | pg_loss: 0.2015 | reg_loss: 2.3394 | reward: -0.8948 | rev_kl: 1.9978 | stu_lens: 91.5000 | mixed_lens: 105.5000 | lr: 7.0000e-07 | scale: 2048.00 | time: 26.431 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     16/  1000| tot_loss: 4.4955 | rl_loss: 2.7608 | pt_loss: 1.7347 | pg_loss: 0.5007 | reg_loss: 2.2601 | reward: -1.0965 | rev_kl: 2.2388 | stu_lens: 93.5000 | mixed_lens: 71.5000 | lr: 7.5000e-07 | scale: 2048.00 | time: 26.433 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     16/  1000| tot_loss: 4.1921 | rl_loss: 2.4866 | pt_loss: 1.7055 | pg_loss: 0.4425 | reg_loss: 2.0441 | reward: -1.0533 | rev_kl: 1.9348 | stu_lens: 67.7188 | mixed_lens: 83.2969 | lr: 7.5000e-07 | scale: 2048.00 | time: 26.433 | step time: 26.075
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:     17/  1000| tot_loss: 5.5753 | rl_loss: 3.5848 | pt_loss: 1.9905 | pg_loss: 1.5877 | reg_loss: 1.9972 | reward: -1.9396 | rev_kl: 4.1652 | stu_lens: 5.0000 | mixed_lens: 13.0000 | lr: 8.0000e-07 | scale: 2048.00 | time: 26.425 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:     18/  1000| tot_loss: 4.1742 | rl_loss: 2.1803 | pt_loss: 1.9939 | pg_loss: 0.0393 | reg_loss: 2.1410 | reward: -0.3410 | rev_kl: 1.8662 | stu_lens: 49.0000 | mixed_lens: 128.0000 | lr: 8.5000e-07 | scale: 2048.00 | time: 26.448 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:     19/  1000| tot_loss: 4.3738 | rl_loss: 2.5356 | pt_loss: 1.8382 | pg_loss: 0.2111 | reg_loss: 2.3244 | reward: -0.7596 | rev_kl: 2.5896 | stu_lens: 83.5000 | mixed_lens: 100.5000 | lr: 9.0000e-07 | scale: 2048.00 | time: 26.405 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:     20/  1000| tot_loss: 3.5544 | rl_loss: 1.6677 | pt_loss: 1.8867 | pg_loss: 0.0571 | reg_loss: 1.6105 | reward: -0.4496 | rev_kl: 1.9257 | stu_lens: 128.0000 | mixed_lens: 118.5000 | lr: 9.5000e-07 | scale: 2048.00 | time: 26.393 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:     21/  1000| tot_loss: 4.0054 | rl_loss: 2.1792 | pt_loss: 1.8262 | pg_loss: 0.1361 | reg_loss: 2.0431 | reward: -0.7404 | rev_kl: 2.9401 | stu_lens: 72.0000 | mixed_lens: 122.0000 | lr: 1.0000e-06 | scale: 2048.00 | time: 26.396 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:     22/  1000| tot_loss: 4.7092 | rl_loss: 3.0445 | pt_loss: 1.6646 | pg_loss: 0.8628 | reg_loss: 2.1818 | reward: -1.8325 | rev_kl: 2.4088 | stu_lens: 94.0000 | mixed_lens: 39.0000 | lr: 1.0500e-06 | scale: 2048.00 | time: 26.379 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:     23/  1000| tot_loss: 2.5462 | rl_loss: 1.0548 | pt_loss: 1.4914 | pg_loss: 0.0118 | reg_loss: 1.0429 | reward: -0.3320 | rev_kl: 1.8430 | stu_lens: 79.0000 | mixed_lens: 122.0000 | lr: 1.1000e-06 | scale: 2048.00 | time: 26.387 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:     24/  1000| tot_loss: 3.9469 | rl_loss: 2.1367 | pt_loss: 1.8102 | pg_loss: 0.1718 | reg_loss: 1.9649 | reward: -0.5343 | rev_kl: 2.5590 | stu_lens: 76.5000 | mixed_lens: 106.5000 | lr: 1.1500e-06 | scale: 2048.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:     25/  1000| tot_loss: 5.2064 | rl_loss: 2.9631 | pt_loss: 2.2432 | pg_loss: 0.7850 | reg_loss: 2.1781 | reward: -1.3731 | rev_kl: 2.9910 | stu_lens: 41.0000 | mixed_lens: 66.5000 | lr: 1.2000e-06 | scale: 2048.00 | time: 26.354 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:     26/  1000| tot_loss: 3.7303 | rl_loss: 2.1892 | pt_loss: 1.5411 | pg_loss: 0.0395 | reg_loss: 2.1498 | reward: -0.5633 | rev_kl: 3.5754 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.2500e-06 | scale: 2048.00 | time: 26.377 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:     27/  1000| tot_loss: 4.6744 | rl_loss: 2.9581 | pt_loss: 1.7162 | pg_loss: 0.5864 | reg_loss: 2.3717 | reward: -4.0853 | rev_kl: 2.0191 | stu_lens: 114.0000 | mixed_lens: 67.0000 | lr: 1.3000e-06 | scale: 2048.00 | time: 26.346 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:     28/  1000| tot_loss: 3.4971 | rl_loss: 1.8232 | pt_loss: 1.6739 | pg_loss: 0.1622 | reg_loss: 1.6610 | reward: -0.3444 | rev_kl: 2.1612 | stu_lens: 77.5000 | mixed_lens: 102.0000 | lr: 1.3500e-06 | scale: 2048.00 | time: 26.367 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:     29/  1000| tot_loss: 4.4472 | rl_loss: 3.0360 | pt_loss: 1.4112 | pg_loss: 0.8715 | reg_loss: 2.1645 | reward: -0.7523 | rev_kl: 1.9143 | stu_lens: 44.0000 | mixed_lens: 54.0000 | lr: 1.4000e-06 | scale: 2048.00 | time: 26.382 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:     30/  1000| tot_loss: 6.0638 | rl_loss: 4.4428 | pt_loss: 1.6209 | pg_loss: 2.0659 | reg_loss: 2.3769 | reward: -6.4126 | rev_kl: 1.0931 | stu_lens: 12.0000 | mixed_lens: 11.0000 | lr: 1.4500e-06 | scale: 2048.00 | time: 26.396 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:     31/  1000| tot_loss: 4.0597 | rl_loss: 1.9851 | pt_loss: 2.0747 | pg_loss: 0.0110 | reg_loss: 1.9740 | reward: -0.6925 | rev_kl: 1.8250 | stu_lens: 77.5000 | mixed_lens: 128.0000 | lr: 1.5000e-06 | scale: 2048.00 | time: 26.380 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     32/  1000| tot_loss: 3.7518 | rl_loss: 1.6923 | pt_loss: 2.0595 | pg_loss: 0.7143 | reg_loss: 0.9780 | reward: -1.0499 | rev_kl: 1.2517 | stu_lens: 42.0000 | mixed_lens: 45.0000 | lr: 1.5500e-06 | scale: 2048.00 | time: 26.427 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     32/  1000| tot_loss: 4.2085 | rl_loss: 2.4136 | pt_loss: 1.7949 | pg_loss: 0.4560 | reg_loss: 1.9576 | reward: -1.1638 | rev_kl: 2.2371 | stu_lens: 68.2500 | mixed_lens: 86.4219 | lr: 1.5500e-06 | scale: 2048.00 | time: 26.427 | step time: 27.657
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:     33/  1000| tot_loss: 4.1540 | rl_loss: 2.2465 | pt_loss: 1.9075 | pg_loss: 0.1034 | reg_loss: 2.1431 | reward: -0.4874 | rev_kl: 2.4039 | stu_lens: 50.0000 | mixed_lens: 118.0000 | lr: 1.6000e-06 | scale: 2048.00 | time: 26.410 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:     34/  1000| tot_loss: 3.6158 | rl_loss: 1.9286 | pt_loss: 1.6872 | pg_loss: 0.8480 | reg_loss: 1.0807 | reward: -1.1983 | rev_kl: 1.0040 | stu_lens: 38.5000 | mixed_lens: 44.0000 | lr: 1.6500e-06 | scale: 2048.00 | time: 26.410 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:     35/  1000| tot_loss: 5.6695 | rl_loss: 3.7103 | pt_loss: 1.9593 | pg_loss: 1.6588 | reg_loss: 2.0515 | reward: -2.4188 | rev_kl: 1.2481 | stu_lens: 66.5000 | mixed_lens: 20.5000 | lr: 1.7000e-06 | scale: 2048.00 | time: 26.400 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:     36/  1000| tot_loss: 4.0172 | rl_loss: 2.4673 | pt_loss: 1.5498 | pg_loss: 0.4903 | reg_loss: 1.9771 | reward: -1.4856 | rev_kl: 2.8410 | stu_lens: 57.5000 | mixed_lens: 78.0000 | lr: 1.7500e-06 | scale: 2048.00 | time: 26.405 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:     37/  1000| tot_loss: 2.8089 | rl_loss: 1.2895 | pt_loss: 1.5194 | pg_loss: -0.0122 | reg_loss: 1.3017 | reward: -0.5472 | rev_kl: 2.3367 | stu_lens: 74.0000 | mixed_lens: 128.0000 | lr: 1.8000e-06 | scale: 2048.00 | time: 26.345 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:     38/  1000| tot_loss: 3.1406 | rl_loss: 1.4141 | pt_loss: 1.7265 | pg_loss: 0.0824 | reg_loss: 1.3316 | reward: -0.3832 | rev_kl: 1.7487 | stu_lens: 88.5000 | mixed_lens: 118.0000 | lr: 1.8500e-06 | scale: 2048.00 | time: 26.357 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:     39/  1000| tot_loss: 3.2875 | rl_loss: 2.0104 | pt_loss: 1.2771 | pg_loss: 0.5280 | reg_loss: 1.4824 | reward: -1.1774 | rev_kl: 1.9639 | stu_lens: 67.0000 | mixed_lens: 66.5000 | lr: 1.9000e-06 | scale: 2048.00 | time: 26.333 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:     40/  1000| tot_loss: 3.3014 | rl_loss: 1.4505 | pt_loss: 1.8509 | pg_loss: -0.0164 | reg_loss: 1.4668 | reward: -0.6428 | rev_kl: 2.4527 | stu_lens: 92.5000 | mixed_lens: 128.0000 | lr: 1.9500e-06 | scale: 2048.00 | time: 26.362 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:     41/  1000| tot_loss: 3.2578 | rl_loss: 1.7540 | pt_loss: 1.5038 | pg_loss: 1.2140 | reg_loss: 0.5400 | reward: -1.3339 | rev_kl: 2.5108 | stu_lens: 24.0000 | mixed_lens: 35.0000 | lr: 2.0000e-06 | scale: 2048.00 | time: 26.343 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:     42/  1000| tot_loss: 3.1446 | rl_loss: 1.4827 | pt_loss: 1.6619 | pg_loss: 0.1492 | reg_loss: 1.3335 | reward: -0.5998 | rev_kl: 1.6921 | stu_lens: 52.0000 | mixed_lens: 100.5000 | lr: 2.0500e-06 | scale: 2048.00 | time: 26.347 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:     43/  1000| tot_loss: 3.6588 | rl_loss: 1.8726 | pt_loss: 1.7863 | pg_loss: 0.4303 | reg_loss: 1.4423 | reward: -1.0101 | rev_kl: 2.1263 | stu_lens: 32.5000 | mixed_lens: 77.0000 | lr: 2.1000e-06 | scale: 2048.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:     44/  1000| tot_loss: 3.8794 | rl_loss: 1.9390 | pt_loss: 1.9404 | pg_loss: 0.5489 | reg_loss: 1.3901 | reward: -0.7719 | rev_kl: 1.8228 | stu_lens: 65.0000 | mixed_lens: 76.5000 | lr: 2.1500e-06 | scale: 2048.00 | time: 26.388 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:     45/  1000| tot_loss: 2.8230 | rl_loss: 1.6078 | pt_loss: 1.2153 | pg_loss: 0.3336 | reg_loss: 1.2741 | reward: -0.6801 | rev_kl: 2.2913 | stu_lens: 66.5000 | mixed_lens: 89.5000 | lr: 2.2000e-06 | scale: 2048.00 | time: 26.359 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:     46/  1000| tot_loss: 3.1511 | rl_loss: 1.4829 | pt_loss: 1.6682 | pg_loss: 0.4731 | reg_loss: 1.0098 | reward: -1.4245 | rev_kl: 1.8909 | stu_lens: 74.0000 | mixed_lens: 67.5000 | lr: 2.2500e-06 | scale: 2048.00 | time: 26.410 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:     47/  1000| tot_loss: 3.1742 | rl_loss: 1.3297 | pt_loss: 1.8444 | pg_loss: 0.1709 | reg_loss: 1.1588 | reward: -0.5446 | rev_kl: 2.1832 | stu_lens: 76.5000 | mixed_lens: 106.5000 | lr: 2.3000e-06 | scale: 2048.00 | time: 26.424 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:     48/  1000| tot_loss: 3.5012 | rl_loss: 2.0524 | pt_loss: 1.4489 | pg_loss: 1.1153 | reg_loss: 0.9371 | reward: -0.4810 | rev_kl: 2.2727 | stu_lens: 63.0000 | mixed_lens: 36.0000 | lr: 2.3500e-06 | scale: 2048.00 | time: 26.414 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:     48/  1000| tot_loss: 3.5731 | rl_loss: 1.8180 | pt_loss: 1.7551 | pg_loss: 0.4163 | reg_loss: 1.4016 | reward: -1.1451 | rev_kl: 2.1580 | stu_lens: 69.0781 | mixed_lens: 86.2188 | lr: 2.3500e-06 | scale: 2048.00 | time: 26.414 | step time: 27.642
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:     49/  1000| tot_loss: 2.4307 | rl_loss: 1.0754 | pt_loss: 1.3553 | pg_loss: 0.2246 | reg_loss: 0.8507 | reward: -0.5955 | rev_kl: 1.3169 | stu_lens: 20.0000 | mixed_lens: 101.5000 | lr: 2.4000e-06 | scale: 2048.00 | time: 26.376 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:     50/  1000| tot_loss: 3.7526 | rl_loss: 1.6119 | pt_loss: 2.1407 | pg_loss: 0.8074 | reg_loss: 0.8045 | reward: -1.2409 | rev_kl: 2.6054 | stu_lens: 37.0000 | mixed_lens: 63.0000 | lr: 2.4500e-06 | scale: 2048.00 | time: 26.371 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:     51/  1000| tot_loss: 2.6254 | rl_loss: 1.2756 | pt_loss: 1.3498 | pg_loss: 0.0589 | reg_loss: 1.2166 | reward: -0.5356 | rev_kl: 2.1247 | stu_lens: 76.0000 | mixed_lens: 128.0000 | lr: 2.5000e-06 | scale: 2048.00 | time: 26.354 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:     52/  1000| tot_loss: 2.9914 | rl_loss: 1.3038 | pt_loss: 1.6876 | pg_loss: 0.5281 | reg_loss: 0.7757 | reward: -1.4208 | rev_kl: 1.4683 | stu_lens: 29.5000 | mixed_lens: 72.5000 | lr: 2.5500e-06 | scale: 2048.00 | time: 26.383 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:     53/  1000| tot_loss: 3.7957 | rl_loss: 1.8427 | pt_loss: 1.9530 | pg_loss: 1.5586 | reg_loss: 0.2840 | reward: -1.6179 | rev_kl: 2.8695 | stu_lens: 20.5000 | mixed_lens: 21.0000 | lr: 2.6000e-06 | scale: 2048.00 | time: 26.336 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:     54/  1000| tot_loss: 2.8264 | rl_loss: 0.9852 | pt_loss: 1.8413 | pg_loss: 0.1572 | reg_loss: 0.8280 | reward: -0.7003 | rev_kl: 2.2989 | stu_lens: 83.5000 | mixed_lens: 100.5000 | lr: 2.6500e-06 | scale: 2048.00 | time: 26.351 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:     55/  1000| tot_loss: 2.8055 | rl_loss: 1.1053 | pt_loss: 1.7001 | pg_loss: 0.3585 | reg_loss: 0.7468 | reward: -0.9646 | rev_kl: 2.2767 | stu_lens: 40.0000 | mixed_lens: 84.0000 | lr: 2.7000e-06 | scale: 2048.00 | time: 26.344 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:     56/  1000| tot_loss: 2.5681 | rl_loss: 0.7057 | pt_loss: 1.8624 | pg_loss: 0.0083 | reg_loss: 0.6973 | reward: -0.4284 | rev_kl: 1.9808 | stu_lens: 80.5000 | mixed_lens: 128.0000 | lr: 2.7500e-06 | scale: 2048.00 | time: 26.358 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:     57/  1000| tot_loss: 2.5804 | rl_loss: 0.8822 | pt_loss: 1.6982 | pg_loss: 0.0430 | reg_loss: 0.8392 | reward: -0.5515 | rev_kl: 2.0812 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8000e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:     58/  1000| tot_loss: 2.0934 | rl_loss: 0.5531 | pt_loss: 1.5403 | pg_loss: 0.2559 | reg_loss: 0.2972 | reward: -0.6420 | rev_kl: 1.2253 | stu_lens: 71.0000 | mixed_lens: 82.5000 | lr: 2.8500e-06 | scale: 2048.00 | time: 26.368 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:     59/  1000| tot_loss: 3.3720 | rl_loss: 1.6597 | pt_loss: 1.7122 | pg_loss: 0.5574 | reg_loss: 1.1024 | reward: -1.4856 | rev_kl: 2.8410 | stu_lens: 57.5000 | mixed_lens: 78.0000 | lr: 2.9000e-06 | scale: 2048.00 | time: 26.339 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:     60/  1000| tot_loss: 2.8078 | rl_loss: 1.3102 | pt_loss: 1.4975 | pg_loss: 0.2822 | reg_loss: 1.0280 | reward: -0.6706 | rev_kl: 2.2031 | stu_lens: 34.5000 | mixed_lens: 101.5000 | lr: 2.9500e-06 | scale: 2048.00 | time: 26.403 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:     61/  1000| tot_loss: 2.9625 | rl_loss: 1.2675 | pt_loss: 1.6949 | pg_loss: 0.2404 | reg_loss: 1.0272 | reward: -0.8163 | rev_kl: 1.7393 | stu_lens: 128.0000 | mixed_lens: 100.5000 | lr: 3.0000e-06 | scale: 2048.00 | time: 26.395 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:     62/  1000| tot_loss: 2.3069 | rl_loss: 0.8116 | pt_loss: 1.4952 | pg_loss: 0.0374 | reg_loss: 0.7742 | reward: -0.5738 | rev_kl: 1.9527 | stu_lens: 92.5000 | mixed_lens: 128.0000 | lr: 3.0500e-06 | scale: 2048.00 | time: 26.402 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:     63/  1000| tot_loss: 3.3558 | rl_loss: 1.3258 | pt_loss: 2.0300 | pg_loss: 0.6021 | reg_loss: 0.7237 | reward: -0.6085 | rev_kl: 2.6728 | stu_lens: 69.5000 | mixed_lens: 70.5000 | lr: 3.1000e-06 | scale: 2048.00 | time: 26.354 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:     64/  1000| tot_loss: 2.2146 | rl_loss: 0.9003 | pt_loss: 1.3144 | pg_loss: 0.3486 | reg_loss: 0.5517 | reward: -5.3515 | rev_kl: 1.7977 | stu_lens: 24.5000 | mixed_lens: 59.5000 | lr: 3.1500e-06 | scale: 2048.00 | time: 26.353 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:     64/  1000| tot_loss: 2.9128 | rl_loss: 1.2065 | pt_loss: 1.7063 | pg_loss: 0.3817 | reg_loss: 0.8248 | reward: -1.0829 | rev_kl: 2.1592 | stu_lens: 69.4375 | mixed_lens: 90.7344 | lr: 3.1500e-06 | scale: 2048.00 | time: 26.353 | step time: 27.628
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:     65/  1000| tot_loss: 2.7271 | rl_loss: 1.1814 | pt_loss: 1.5457 | pg_loss: 0.4313 | reg_loss: 0.7501 | reward: -1.4643 | rev_kl: 2.0473 | stu_lens: 128.0000 | mixed_lens: 65.5000 | lr: 3.2000e-06 | scale: 2048.00 | time: 26.353 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:     66/  1000| tot_loss: 3.5855 | rl_loss: 1.9433 | pt_loss: 1.6422 | pg_loss: 0.3425 | reg_loss: 1.6008 | reward: -0.3478 | rev_kl: 1.2578 | stu_lens: 85.0000 | mixed_lens: 94.5000 | lr: 3.2500e-06 | scale: 2048.00 | time: 26.358 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:     67/  1000| tot_loss: 3.5566 | rl_loss: 1.8454 | pt_loss: 1.7111 | pg_loss: 0.6107 | reg_loss: 1.2347 | reward: -1.0203 | rev_kl: 0.5865 | stu_lens: 69.0000 | mixed_lens: 53.5000 | lr: 3.3000e-06 | scale: 2048.00 | time: 26.321 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:     68/  1000| tot_loss: 3.8899 | rl_loss: 2.4588 | pt_loss: 1.4311 | pg_loss: 1.1470 | reg_loss: 1.3118 | reward: -0.7651 | rev_kl: 1.3306 | stu_lens: 33.0000 | mixed_lens: 35.5000 | lr: 3.3500e-06 | scale: 2048.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:     69/  1000| tot_loss: 2.9222 | rl_loss: 0.8361 | pt_loss: 2.0861 | pg_loss: 0.6478 | reg_loss: 0.1883 | reward: -0.1944 | rev_kl: 1.0110 | stu_lens: 26.5000 | mixed_lens: 36.5000 | lr: 3.4000e-06 | scale: 2048.00 | time: 26.363 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:     70/  1000| tot_loss: 3.2273 | rl_loss: 1.4509 | pt_loss: 1.7764 | pg_loss: 0.3605 | reg_loss: 1.0903 | reward: -2.8205 | rev_kl: 0.8931 | stu_lens: 77.0000 | mixed_lens: 66.5000 | lr: 3.4500e-06 | scale: 2048.00 | time: 26.357 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:     71/  1000| tot_loss: 3.3143 | rl_loss: 1.6298 | pt_loss: 1.6845 | pg_loss: 0.1626 | reg_loss: 1.4672 | reward: -0.3417 | rev_kl: 0.7172 | stu_lens: 74.0000 | mixed_lens: 111.0000 | lr: 3.5000e-06 | scale: 2048.00 | time: 26.377 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:     72/  1000| tot_loss: 3.7168 | rl_loss: 1.8644 | pt_loss: 1.8524 | pg_loss: 0.3473 | reg_loss: 1.5171 | reward: -0.3614 | rev_kl: 1.4031 | stu_lens: 85.0000 | mixed_lens: 89.5000 | lr: 3.5500e-06 | scale: 2048.00 | time: 26.340 | step time: 0.000
[2023-12-13 17:13:36,605] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, but hysteresis is 4. Reducing hysteresis to 3
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:     73/  1000| tot_loss: 1.9345 | rl_loss: 0.0674 | pt_loss: 1.8671 | pg_loss: -0.6108 | reg_loss: 0.6783 | reward: 0.3001 | rev_kl: 0.9372 | stu_lens: 27.5000 | mixed_lens: 32.0000 | lr: 3.5500e-06 | scale: 2048.00 | time: 2.848 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:     74/  1000| tot_loss: 3.2230 | rl_loss: 1.4589 | pt_loss: 1.7641 | pg_loss: 0.3038 | reg_loss: 1.1551 | reward: -0.4659 | rev_kl: 1.9123 | stu_lens: 95.0000 | mixed_lens: 82.5000 | lr: 3.6000e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:     75/  1000| tot_loss: 3.8127 | rl_loss: 1.9192 | pt_loss: 1.8935 | pg_loss: 0.6030 | reg_loss: 1.3162 | reward: -1.6239 | rev_kl: 1.4291 | stu_lens: 70.0000 | mixed_lens: 68.0000 | lr: 3.6500e-06 | scale: 2048.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:     76/  1000| tot_loss: 3.5520 | rl_loss: 1.9241 | pt_loss: 1.6279 | pg_loss: 0.5633 | reg_loss: 1.3608 | reward: -0.6863 | rev_kl: 0.8885 | stu_lens: 106.0000 | mixed_lens: 76.5000 | lr: 3.7000e-06 | scale: 2048.00 | time: 26.324 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:     77/  1000| tot_loss: 4.0667 | rl_loss: 2.6523 | pt_loss: 1.4144 | pg_loss: 0.9986 | reg_loss: 1.6537 | reward: -0.7303 | rev_kl: 1.7208 | stu_lens: 72.5000 | mixed_lens: 51.5000 | lr: 3.7500e-06 | scale: 2048.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:     78/  1000| tot_loss: 3.1098 | rl_loss: 1.0649 | pt_loss: 2.0450 | pg_loss: 0.0426 | reg_loss: 1.0222 | reward: -0.0393 | rev_kl: 1.3963 | stu_lens: 78.0000 | mixed_lens: 128.0000 | lr: 3.8000e-06 | scale: 2048.00 | time: 26.338 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:     79/  1000| tot_loss: 3.5413 | rl_loss: 1.4596 | pt_loss: 2.0817 | pg_loss: 0.2246 | reg_loss: 1.2350 | reward: -0.2429 | rev_kl: 1.3630 | stu_lens: 128.0000 | mixed_lens: 89.0000 | lr: 3.8500e-06 | scale: 2048.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     80/  1000| tot_loss: 3.4989 | rl_loss: 1.6048 | pt_loss: 1.8942 | pg_loss: 0.0595 | reg_loss: 1.5452 | reward: -0.2205 | rev_kl: 1.8266 | stu_lens: 116.5000 | mixed_lens: 128.0000 | lr: 3.9000e-06 | scale: 2048.00 | time: 26.315 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:     80/  1000| tot_loss: 3.4770 | rl_loss: 1.7182 | pt_loss: 1.7588 | pg_loss: 0.4590 | reg_loss: 1.2592 | reward: -0.6028 | rev_kl: 1.3417 | stu_lens: 77.4688 | mixed_lens: 73.8750 | lr: 3.9000e-06 | scale: 2048.00 | time: 26.315 | step time: 26.127
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:     81/  1000| tot_loss: 3.9195 | rl_loss: 1.9222 | pt_loss: 1.9973 | pg_loss: 0.3272 | reg_loss: 1.5950 | reward: -0.5198 | rev_kl: 1.1176 | stu_lens: 59.0000 | mixed_lens: 103.0000 | lr: 3.9500e-06 | scale: 2048.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:     82/  1000| tot_loss: 3.1385 | rl_loss: 1.2145 | pt_loss: 1.9240 | pg_loss: 0.0665 | reg_loss: 1.1479 | reward: -0.1464 | rev_kl: 1.8077 | stu_lens: 96.5000 | mixed_lens: 128.0000 | lr: 4.0000e-06 | scale: 2048.00 | time: 26.376 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:     83/  1000| tot_loss: 2.9405 | rl_loss: 0.9385 | pt_loss: 2.0019 | pg_loss: 0.1234 | reg_loss: 0.8151 | reward: -0.1641 | rev_kl: 1.2448 | stu_lens: 74.0000 | mixed_lens: 111.0000 | lr: 4.0500e-06 | scale: 2048.00 | time: 26.357 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:     84/  1000| tot_loss: 3.1132 | rl_loss: 1.4438 | pt_loss: 1.6694 | pg_loss: 0.4736 | reg_loss: 0.9702 | reward: -1.5232 | rev_kl: 1.2308 | stu_lens: 84.0000 | mixed_lens: 78.0000 | lr: 4.1000e-06 | scale: 2048.00 | time: 26.379 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:     85/  1000| tot_loss: 3.2548 | rl_loss: 1.0685 | pt_loss: 2.1862 | pg_loss: 0.3009 | reg_loss: 0.7676 | reward: -0.3129 | rev_kl: 0.5577 | stu_lens: 106.0000 | mixed_lens: 104.0000 | lr: 4.1500e-06 | scale: 2048.00 | time: 26.341 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:     86/  1000| tot_loss: 3.8794 | rl_loss: 1.9208 | pt_loss: 1.9586 | pg_loss: 1.2134 | reg_loss: 0.7074 | reward: -1.0986 | rev_kl: 1.0027 | stu_lens: 13.5000 | mixed_lens: 33.0000 | lr: 4.2000e-06 | scale: 2048.00 | time: 26.327 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:     87/  1000| tot_loss: 2.7123 | rl_loss: 0.9505 | pt_loss: 1.7618 | pg_loss: 0.2402 | reg_loss: 0.7103 | reward: -0.1654 | rev_kl: 1.2609 | stu_lens: 128.0000 | mixed_lens: 96.5000 | lr: 4.2500e-06 | scale: 2048.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:     88/  1000| tot_loss: 2.1748 | rl_loss: 0.4783 | pt_loss: 1.6966 | pg_loss: 0.2899 | reg_loss: 0.1884 | reward: -0.1929 | rev_kl: 0.7081 | stu_lens: 62.0000 | mixed_lens: 79.5000 | lr: 4.3000e-06 | scale: 2048.00 | time: 26.331 | step time: 0.000
[2023-12-13 17:20:35,987] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, but hysteresis is 3. Reducing hysteresis to 2
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:     89/  1000| tot_loss: 1.9791 | rl_loss: -0.0427 | pt_loss: 2.0218 | pg_loss: -0.6464 | reg_loss: 0.6037 | reward: 0.3001 | rev_kl: 0.9372 | stu_lens: 27.5000 | mixed_lens: 32.0000 | lr: 4.3000e-06 | scale: 2048.00 | time: 2.827 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:     90/  1000| tot_loss: 2.9689 | rl_loss: 1.2382 | pt_loss: 1.7306 | pg_loss: 0.4194 | reg_loss: 0.8188 | reward: -0.6927 | rev_kl: 1.1757 | stu_lens: 80.0000 | mixed_lens: 76.0000 | lr: 4.3500e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:     91/  1000| tot_loss: 2.9041 | rl_loss: 0.8289 | pt_loss: 2.0752 | pg_loss: 0.2730 | reg_loss: 0.5559 | reward: -0.4196 | rev_kl: 1.4200 | stu_lens: 95.0000 | mixed_lens: 81.0000 | lr: 4.4000e-06 | scale: 2048.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:     92/  1000| tot_loss: 2.8834 | rl_loss: 1.1062 | pt_loss: 1.7772 | pg_loss: 0.4587 | reg_loss: 0.6475 | reward: -0.1185 | rev_kl: 1.4788 | stu_lens: 67.5000 | mixed_lens: 70.0000 | lr: 4.4500e-06 | scale: 2048.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:     93/  1000| tot_loss: 4.3644 | rl_loss: 2.3391 | pt_loss: 2.0254 | pg_loss: 1.1268 | reg_loss: 1.2122 | reward: -1.7619 | rev_kl: 1.2736 | stu_lens: 46.5000 | mixed_lens: 47.0000 | lr: 4.5000e-06 | scale: 2048.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:     94/  1000| tot_loss: 3.5497 | rl_loss: 1.5558 | pt_loss: 1.9939 | pg_loss: 0.4168 | reg_loss: 1.1390 | reward: -0.5767 | rev_kl: 1.1940 | stu_lens: 128.0000 | mixed_lens: 84.5000 | lr: 4.5500e-06 | scale: 2048.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:     95/  1000| tot_loss: 2.5865 | rl_loss: 0.7240 | pt_loss: 1.8625 | pg_loss: -0.0077 | reg_loss: 0.7317 | reward: -0.3019 | rev_kl: 1.2663 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.6000e-06 | scale: 2048.00 | time: 26.327 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     96/  1000| tot_loss: 3.0040 | rl_loss: 1.3627 | pt_loss: 1.6413 | pg_loss: 0.5106 | reg_loss: 0.8521 | reward: -0.4850 | rev_kl: 2.2904 | stu_lens: 19.0000 | mixed_lens: 53.0000 | lr: 4.6500e-06 | scale: 2048.00 | time: 26.320 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:     96/  1000| tot_loss: 3.0980 | rl_loss: 1.2463 | pt_loss: 1.8516 | pg_loss: 0.3752 | reg_loss: 0.8712 | reward: -0.5306 | rev_kl: 1.3586 | stu_lens: 80.4688 | mixed_lens: 80.6562 | lr: 4.6500e-06 | scale: 2048.00 | time: 26.320 | step time: 26.118
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:     97/  1000| tot_loss: 3.2276 | rl_loss: 1.4579 | pt_loss: 1.7697 | pg_loss: 0.9285 | reg_loss: 0.5294 | reward: -0.3836 | rev_kl: 0.6133 | stu_lens: 30.5000 | mixed_lens: 39.0000 | lr: 4.7000e-06 | scale: 2048.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:     98/  1000| tot_loss: 2.1177 | rl_loss: 0.5068 | pt_loss: 1.6109 | pg_loss: 0.0063 | reg_loss: 0.5005 | reward: -0.1211 | rev_kl: 1.0971 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.7500e-06 | scale: 2048.00 | time: 26.330 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:     99/  1000| tot_loss: 2.6857 | rl_loss: 0.7860 | pt_loss: 1.8997 | pg_loss: 0.2975 | reg_loss: 0.4885 | reward: -0.5942 | rev_kl: 2.0305 | stu_lens: 47.0000 | mixed_lens: 87.0000 | lr: 4.8000e-06 | scale: 2048.00 | time: 26.338 | step time: 0.000
                                 Evaluation #1                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Convert the above time to Pacific     │ Convert the above time to Pacific    │
│ Standard Time.                        │ Standard Time.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 11:19 PM PST                         │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ In unix 'epoch' time, 0 seconds      │
│                                       │ would be 1970-01-01 00:00:00.000000  │
│                                       │ UTC.                                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ Zero seconds is the same as          │
│                                       │ 1970-01-01 00:00:00 in unix time.    │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.311 | exact_match: 0.000 | rev_kl: 1.258 | lens: 95.624 | pt_loss: 1.117 | lm_loss: 1.229 | kd_loss: 1.006 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    100/  1000| tot_loss: 3.5596 | rl_loss: 1.3861 | pt_loss: 2.1734 | pg_loss: 0.6008 | reg_loss: 0.7853 | reward: -0.3638 | rev_kl: 1.9353 | stu_lens: 68.5000 | mixed_lens: 63.0000 | lr: 4.8500e-06 | scale: 2048.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    101/  1000| tot_loss: 3.5185 | rl_loss: 1.6993 | pt_loss: 1.8192 | pg_loss: 1.0296 | reg_loss: 0.6697 | reward: -1.4474 | rev_kl: 1.7947 | stu_lens: 54.0000 | mixed_lens: 42.0000 | lr: 4.9000e-06 | scale: 2048.00 | time: 26.358 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    102/  1000| tot_loss: 2.5987 | rl_loss: 0.8545 | pt_loss: 1.7442 | pg_loss: 0.2041 | reg_loss: 0.6504 | reward: -0.6376 | rev_kl: 1.3660 | stu_lens: 128.0000 | mixed_lens: 87.5000 | lr: 4.9500e-06 | scale: 2048.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    103/  1000| tot_loss: 2.5786 | rl_loss: 0.7248 | pt_loss: 1.8539 | pg_loss: 0.5779 | reg_loss: 0.1469 | reward: -0.1944 | rev_kl: 1.0110 | stu_lens: 26.5000 | mixed_lens: 36.5000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    104/  1000| tot_loss: 2.3298 | rl_loss: 0.9428 | pt_loss: 1.3870 | pg_loss: 0.3480 | reg_loss: 0.5948 | reward: -0.1255 | rev_kl: 0.9810 | stu_lens: 80.5000 | mixed_lens: 83.5000 | lr: 5.0000e-06 | scale: 2048.00 | time: 26.268 | step time: 0.000
[2023-12-13 17:52:59,740] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, but hysteresis is 2. Reducing hysteresis to 1
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    105/  1000| tot_loss: 1.7027 | rl_loss: 0.4046 | pt_loss: 1.2980 | pg_loss: 0.1454 | reg_loss: 0.2592 | reward: -0.2362 | rev_kl: 1.2093 | stu_lens: 66.0000 | mixed_lens: 103.0000 | lr: 5.0000e-06 | scale: 2048.00 | time: 2.827 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    106/  1000| tot_loss: 2.8367 | rl_loss: 1.0593 | pt_loss: 1.7774 | pg_loss: 0.2419 | reg_loss: 0.8174 | reward: 0.0068 | rev_kl: 1.5840 | stu_lens: 36.0000 | mixed_lens: 70.0000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    107/  1000| tot_loss: 3.1320 | rl_loss: 0.9905 | pt_loss: 2.1415 | pg_loss: 0.3354 | reg_loss: 0.6551 | reward: -0.3344 | rev_kl: 1.1687 | stu_lens: 81.0000 | mixed_lens: 86.5000 | lr: 4.9999e-06 | scale: 2048.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    108/  1000| tot_loss: 2.3990 | rl_loss: 0.7617 | pt_loss: 1.6373 | pg_loss: 0.2444 | reg_loss: 0.5172 | reward: -0.2471 | rev_kl: 1.3323 | stu_lens: 128.0000 | mixed_lens: 89.0000 | lr: 4.9998e-06 | scale: 2048.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    109/  1000| tot_loss: 3.0019 | rl_loss: 1.4240 | pt_loss: 1.5779 | pg_loss: 0.8248 | reg_loss: 0.5992 | reward: -0.6061 | rev_kl: 1.2321 | stu_lens: 54.5000 | mixed_lens: 37.5000 | lr: 4.9996e-06 | scale: 2048.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    110/  1000| tot_loss: 2.9534 | rl_loss: 0.7789 | pt_loss: 2.1745 | pg_loss: 0.2225 | reg_loss: 0.5565 | reward: -0.2638 | rev_kl: 0.8801 | stu_lens: 106.0000 | mixed_lens: 88.5000 | lr: 4.9995e-06 | scale: 2048.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    111/  1000| tot_loss: 2.6158 | rl_loss: 0.6916 | pt_loss: 1.9241 | pg_loss: 0.1793 | reg_loss: 0.5123 | reward: -0.4097 | rev_kl: 1.5470 | stu_lens: 104.5000 | mixed_lens: 107.0000 | lr: 4.9993e-06 | scale: 2048.00 | time: 26.367 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    112/  1000| tot_loss: 3.0376 | rl_loss: 1.5957 | pt_loss: 1.4419 | pg_loss: 0.7268 | reg_loss: 0.8689 | reward: -0.5445 | rev_kl: 2.4517 | stu_lens: 37.0000 | mixed_lens: 59.0000 | lr: 4.9990e-06 | scale: 2048.00 | time: 26.351 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    112/  1000| tot_loss: 2.7597 | rl_loss: 1.0531 | pt_loss: 1.7066 | pg_loss: 0.4709 | reg_loss: 0.5822 | reward: -0.5192 | rev_kl: 1.2941 | stu_lens: 77.4219 | mixed_lens: 76.4375 | lr: 4.9990e-06 | scale: 2048.00 | time: 26.351 | step time: 26.105
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    113/  1000| tot_loss: 3.2496 | rl_loss: 1.3607 | pt_loss: 1.8889 | pg_loss: 0.8369 | reg_loss: 0.5238 | reward: -0.9164 | rev_kl: 1.2765 | stu_lens: 128.0000 | mixed_lens: 49.5000 | lr: 4.9988e-06 | scale: 2048.00 | time: 26.354 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    114/  1000| tot_loss: 2.1559 | rl_loss: 0.6731 | pt_loss: 1.4827 | pg_loss: 0.1624 | reg_loss: 0.5107 | reward: -0.3292 | rev_kl: 1.9224 | stu_lens: 93.0000 | mixed_lens: 107.0000 | lr: 4.9985e-06 | scale: 2048.00 | time: 26.334 | step time: 0.000
[2023-12-13 17:57:12,807] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 2048, reducing to 1024
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    115/  1000| tot_loss: 2.6853 | rl_loss: 1.2537 | pt_loss: 1.4316 | pg_loss: 0.5528 | reg_loss: 0.7009 | reward: 0.1084 | rev_kl: 1.6535 | stu_lens: 32.0000 | mixed_lens: 38.0000 | lr: 4.9985e-06 | scale: 1024.00 | time: 2.846 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    116/  1000| tot_loss: 3.2680 | rl_loss: 1.7988 | pt_loss: 1.4692 | pg_loss: 1.5450 | reg_loss: 0.2539 | reward: -0.9131 | rev_kl: 1.1021 | stu_lens: 37.0000 | mixed_lens: 21.5000 | lr: 4.9982e-06 | scale: 1024.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    117/  1000| tot_loss: 2.4538 | rl_loss: 0.6384 | pt_loss: 1.8154 | pg_loss: 0.2587 | reg_loss: 0.3796 | reward: 0.0050 | rev_kl: 1.5940 | stu_lens: 74.0000 | mixed_lens: 85.0000 | lr: 4.9978e-06 | scale: 1024.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    118/  1000| tot_loss: 2.5225 | rl_loss: 1.0115 | pt_loss: 1.5110 | pg_loss: 0.4319 | reg_loss: 0.5796 | reward: -0.3946 | rev_kl: 1.6212 | stu_lens: 72.5000 | mixed_lens: 92.0000 | lr: 4.9974e-06 | scale: 1024.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    119/  1000| tot_loss: 1.8752 | rl_loss: 0.6120 | pt_loss: 1.2632 | pg_loss: 0.2953 | reg_loss: 0.3167 | reward: -0.3957 | rev_kl: 1.7255 | stu_lens: 68.5000 | mixed_lens: 76.0000 | lr: 4.9970e-06 | scale: 1024.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    120/  1000| tot_loss: 1.4418 | rl_loss: 0.3248 | pt_loss: 1.1169 | pg_loss: -0.0040 | reg_loss: 0.3288 | reward: -0.2113 | rev_kl: 1.0683 | stu_lens: 128.0000 | mixed_lens: 126.5000 | lr: 4.9966e-06 | scale: 1024.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    121/  1000| tot_loss: 2.1923 | rl_loss: 0.8304 | pt_loss: 1.3619 | pg_loss: 0.3904 | reg_loss: 0.4400 | reward: -0.6937 | rev_kl: 0.6301 | stu_lens: 128.0000 | mixed_lens: 84.5000 | lr: 4.9961e-06 | scale: 1024.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    122/  1000| tot_loss: 2.5578 | rl_loss: 0.8045 | pt_loss: 1.7533 | pg_loss: 0.3285 | reg_loss: 0.4760 | reward: -1.5049 | rev_kl: 1.2110 | stu_lens: 109.5000 | mixed_lens: 78.0000 | lr: 4.9956e-06 | scale: 1024.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    123/  1000| tot_loss: 2.4022 | rl_loss: 0.6973 | pt_loss: 1.7049 | pg_loss: 0.1913 | reg_loss: 0.5060 | reward: -0.2563 | rev_kl: 1.6176 | stu_lens: 94.0000 | mixed_lens: 103.0000 | lr: 4.9951e-06 | scale: 1024.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    124/  1000| tot_loss: 2.0804 | rl_loss: 0.6783 | pt_loss: 1.4021 | pg_loss: 0.1266 | reg_loss: 0.5517 | reward: -0.1810 | rev_kl: 1.1905 | stu_lens: 74.5000 | mixed_lens: 104.0000 | lr: 4.9945e-06 | scale: 1024.00 | time: 26.323 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    125/  1000| tot_loss: 3.6186 | rl_loss: 1.3417 | pt_loss: 2.2768 | pg_loss: 1.0848 | reg_loss: 0.2569 | reward: -0.9444 | rev_kl: 0.6749 | stu_lens: 69.0000 | mixed_lens: 37.5000 | lr: 4.9939e-06 | scale: 1024.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    126/  1000| tot_loss: 3.4150 | rl_loss: 1.6277 | pt_loss: 1.7873 | pg_loss: 0.8507 | reg_loss: 0.7770 | reward: -0.7077 | rev_kl: 1.4994 | stu_lens: 81.0000 | mixed_lens: 59.0000 | lr: 4.9933e-06 | scale: 1024.00 | time: 26.371 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    127/  1000| tot_loss: 2.3466 | rl_loss: 0.8045 | pt_loss: 1.5421 | pg_loss: 0.3563 | reg_loss: 0.4482 | reward: -0.6865 | rev_kl: 1.7952 | stu_lens: 18.0000 | mixed_lens: 72.5000 | lr: 4.9926e-06 | scale: 1024.00 | time: 26.317 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    128/  1000| tot_loss: 2.8268 | rl_loss: 0.8621 | pt_loss: 1.9647 | pg_loss: 0.3427 | reg_loss: 0.5194 | reward: -0.3228 | rev_kl: 1.1826 | stu_lens: 124.0000 | mixed_lens: 89.5000 | lr: 4.9919e-06 | scale: 1024.00 | time: 26.346 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    128/  1000| tot_loss: 2.5853 | rl_loss: 0.9066 | pt_loss: 1.6787 | pg_loss: 0.4541 | reg_loss: 0.4525 | reward: -0.5298 | rev_kl: 1.3205 | stu_lens: 76.4688 | mixed_lens: 74.8594 | lr: 4.9919e-06 | scale: 1024.00 | time: 26.346 | step time: 26.106
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    129/  1000| tot_loss: 1.9057 | rl_loss: 0.5830 | pt_loss: 1.3227 | pg_loss: 0.0313 | reg_loss: 0.5517 | reward: -0.1733 | rev_kl: 1.4141 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9912e-06 | scale: 1024.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    130/  1000| tot_loss: 3.0225 | rl_loss: 1.4654 | pt_loss: 1.5571 | pg_loss: 0.1872 | reg_loss: 1.2782 | reward: -0.3966 | rev_kl: 1.4398 | stu_lens: 60.5000 | mixed_lens: 101.5000 | lr: 4.9905e-06 | scale: 1024.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    131/  1000| tot_loss: 2.8799 | rl_loss: 1.6256 | pt_loss: 1.2544 | pg_loss: 0.2060 | reg_loss: 1.4195 | reward: -0.3469 | rev_kl: 1.5691 | stu_lens: 98.0000 | mixed_lens: 110.0000 | lr: 4.9897e-06 | scale: 1024.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    132/  1000| tot_loss: 3.2318 | rl_loss: 1.5373 | pt_loss: 1.6945 | pg_loss: 0.1496 | reg_loss: 1.3876 | reward: -0.3020 | rev_kl: 1.3691 | stu_lens: 103.5000 | mixed_lens: 119.0000 | lr: 4.9889e-06 | scale: 1024.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    133/  1000| tot_loss: 4.4928 | rl_loss: 2.7170 | pt_loss: 1.7758 | pg_loss: 1.3595 | reg_loss: 1.3575 | reward: -0.6994 | rev_kl: 1.0845 | stu_lens: 93.5000 | mixed_lens: 29.0000 | lr: 4.9881e-06 | scale: 1024.00 | time: 26.445 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    134/  1000| tot_loss: 3.8845 | rl_loss: 2.0452 | pt_loss: 1.8393 | pg_loss: 0.4536 | reg_loss: 1.5916 | reward: -0.8197 | rev_kl: 0.8815 | stu_lens: 127.5000 | mixed_lens: 71.5000 | lr: 4.9872e-06 | scale: 1024.00 | time: 26.388 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    135/  1000| tot_loss: 2.9782 | rl_loss: 1.2957 | pt_loss: 1.6825 | pg_loss: 0.1734 | reg_loss: 1.1222 | reward: -0.3824 | rev_kl: 0.7821 | stu_lens: 67.5000 | mixed_lens: 108.5000 | lr: 4.9863e-06 | scale: 1024.00 | time: 26.435 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    136/  1000| tot_loss: 2.9762 | rl_loss: 1.5942 | pt_loss: 1.3820 | pg_loss: 0.5077 | reg_loss: 1.0865 | reward: -0.5411 | rev_kl: 1.4985 | stu_lens: 82.5000 | mixed_lens: 79.0000 | lr: 4.9854e-06 | scale: 1024.00 | time: 26.375 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    137/  1000| tot_loss: 3.9042 | rl_loss: 1.8784 | pt_loss: 2.0258 | pg_loss: 0.5504 | reg_loss: 1.3280 | reward: -0.6648 | rev_kl: 1.6035 | stu_lens: 65.5000 | mixed_lens: 70.0000 | lr: 4.9844e-06 | scale: 1024.00 | time: 26.383 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    138/  1000| tot_loss: 2.3437 | rl_loss: 1.0313 | pt_loss: 1.3124 | pg_loss: 0.1982 | reg_loss: 0.8331 | reward: 0.3353 | rev_kl: 0.3957 | stu_lens: 70.0000 | mixed_lens: 76.5000 | lr: 4.9834e-06 | scale: 1024.00 | time: 26.382 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    139/  1000| tot_loss: 3.2688 | rl_loss: 1.1661 | pt_loss: 2.1026 | pg_loss: 0.1944 | reg_loss: 0.9717 | reward: -0.2979 | rev_kl: 1.0437 | stu_lens: 128.0000 | mixed_lens: 108.0000 | lr: 4.9824e-06 | scale: 1024.00 | time: 26.404 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    140/  1000| tot_loss: 3.4783 | rl_loss: 1.3433 | pt_loss: 2.1350 | pg_loss: 0.2327 | reg_loss: 1.1106 | reward: -0.3538 | rev_kl: 0.7446 | stu_lens: 125.5000 | mixed_lens: 108.0000 | lr: 4.9814e-06 | scale: 1024.00 | time: 26.387 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    141/  1000| tot_loss: 2.7658 | rl_loss: 1.5319 | pt_loss: 1.2339 | pg_loss: 0.1742 | reg_loss: 1.3577 | reward: -0.0324 | rev_kl: 1.4005 | stu_lens: 128.0000 | mixed_lens: 110.5000 | lr: 4.9803e-06 | scale: 1024.00 | time: 26.372 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    142/  1000| tot_loss: 3.3484 | rl_loss: 1.8926 | pt_loss: 1.4558 | pg_loss: 0.2447 | reg_loss: 1.6479 | reward: -0.1139 | rev_kl: 0.7602 | stu_lens: 65.5000 | mixed_lens: 78.5000 | lr: 4.9792e-06 | scale: 1024.00 | time: 26.328 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    143/  1000| tot_loss: 3.3804 | rl_loss: 1.7524 | pt_loss: 1.6280 | pg_loss: 0.4112 | reg_loss: 1.3412 | reward: -0.7441 | rev_kl: 1.1039 | stu_lens: 72.0000 | mixed_lens: 85.0000 | lr: 4.9780e-06 | scale: 1024.00 | time: 26.390 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    144/  1000| tot_loss: 3.2016 | rl_loss: 1.4393 | pt_loss: 1.7623 | pg_loss: 0.0473 | reg_loss: 1.3920 | reward: -0.3989 | rev_kl: 1.1246 | stu_lens: 106.0000 | mixed_lens: 128.0000 | lr: 4.9769e-06 | scale: 1024.00 | time: 26.351 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    144/  1000| tot_loss: 3.3958 | rl_loss: 1.6858 | pt_loss: 1.7100 | pg_loss: 0.3964 | reg_loss: 1.2894 | reward: -0.5670 | rev_kl: 1.1269 | stu_lens: 93.6250 | mixed_lens: 89.0781 | lr: 4.9769e-06 | scale: 1024.00 | time: 26.351 | step time: 27.626
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    145/  1000| tot_loss: 3.1249 | rl_loss: 1.3386 | pt_loss: 1.7863 | pg_loss: 0.1377 | reg_loss: 1.2009 | reward: -0.2928 | rev_kl: 1.1116 | stu_lens: 58.0000 | mixed_lens: 115.0000 | lr: 4.9757e-06 | scale: 1024.00 | time: 26.385 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    146/  1000| tot_loss: 2.2929 | rl_loss: 0.9585 | pt_loss: 1.3344 | pg_loss: 0.1685 | reg_loss: 0.7900 | reward: -0.7033 | rev_kl: 1.3799 | stu_lens: 84.0000 | mixed_lens: 93.0000 | lr: 4.9744e-06 | scale: 1024.00 | time: 26.357 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    147/  1000| tot_loss: 2.7662 | rl_loss: 1.1166 | pt_loss: 1.6496 | pg_loss: 0.4632 | reg_loss: 0.6534 | reward: -0.1860 | rev_kl: 0.5126 | stu_lens: 38.0000 | mixed_lens: 39.0000 | lr: 4.9732e-06 | scale: 1024.00 | time: 26.398 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    148/  1000| tot_loss: 2.3702 | rl_loss: 0.9029 | pt_loss: 1.4672 | pg_loss: 0.1081 | reg_loss: 0.7948 | reward: -0.4622 | rev_kl: 1.0982 | stu_lens: 117.0000 | mixed_lens: 112.5000 | lr: 4.9719e-06 | scale: 1024.00 | time: 26.364 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    149/  1000| tot_loss: 2.7769 | rl_loss: 1.2934 | pt_loss: 1.4835 | pg_loss: 0.3220 | reg_loss: 0.9715 | reward: -0.4507 | rev_kl: 1.2987 | stu_lens: 64.5000 | mixed_lens: 79.5000 | lr: 4.9706e-06 | scale: 1024.00 | time: 26.407 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    150/  1000| tot_loss: 2.7469 | rl_loss: 1.1324 | pt_loss: 1.6145 | pg_loss: 0.0142 | reg_loss: 1.1181 | reward: -0.5413 | rev_kl: 1.0033 | stu_lens: 93.5000 | mixed_lens: 123.5000 | lr: 4.9692e-06 | scale: 1024.00 | time: 26.387 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    151/  1000| tot_loss: 2.8528 | rl_loss: 1.3387 | pt_loss: 1.5141 | pg_loss: 0.5402 | reg_loss: 0.7985 | reward: -0.8239 | rev_kl: 1.0440 | stu_lens: 127.5000 | mixed_lens: 65.5000 | lr: 4.9678e-06 | scale: 1024.00 | time: 26.403 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    152/  1000| tot_loss: 3.1670 | rl_loss: 1.1802 | pt_loss: 1.9868 | pg_loss: 0.1827 | reg_loss: 0.9976 | reward: -0.4974 | rev_kl: 0.9184 | stu_lens: 109.5000 | mixed_lens: 108.5000 | lr: 4.9664e-06 | scale: 1024.00 | time: 26.398 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    153/  1000| tot_loss: 3.7935 | rl_loss: 2.0340 | pt_loss: 1.7595 | pg_loss: 1.2251 | reg_loss: 0.8089 | reward: -0.5937 | rev_kl: 1.1356 | stu_lens: 82.5000 | mixed_lens: 23.0000 | lr: 4.9650e-06 | scale: 1024.00 | time: 26.424 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    154/  1000| tot_loss: 3.0293 | rl_loss: 1.0455 | pt_loss: 1.9838 | pg_loss: 0.1808 | reg_loss: 0.8648 | reward: 0.1622 | rev_kl: 0.4524 | stu_lens: 70.0000 | mixed_lens: 72.0000 | lr: 4.9635e-06 | scale: 1024.00 | time: 26.363 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    155/  1000| tot_loss: 2.2152 | rl_loss: 1.0111 | pt_loss: 1.2040 | pg_loss: 0.2265 | reg_loss: 0.7847 | reward: -0.3947 | rev_kl: 1.0027 | stu_lens: 128.0000 | mixed_lens: 103.0000 | lr: 4.9620e-06 | scale: 1024.00 | time: 26.389 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    156/  1000| tot_loss: 2.8521 | rl_loss: 1.1308 | pt_loss: 1.7213 | pg_loss: 0.5166 | reg_loss: 0.6142 | reward: -0.8362 | rev_kl: 1.5004 | stu_lens: 67.5000 | mixed_lens: 67.5000 | lr: 4.9605e-06 | scale: 1024.00 | time: 26.335 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    157/  1000| tot_loss: 3.6871 | rl_loss: 1.3992 | pt_loss: 2.2878 | pg_loss: 0.6572 | reg_loss: 0.7420 | reward: -0.8843 | rev_kl: 1.3365 | stu_lens: 69.0000 | mixed_lens: 68.5000 | lr: 4.9589e-06 | scale: 1024.00 | time: 26.397 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    158/  1000| tot_loss: 2.7082 | rl_loss: 0.7683 | pt_loss: 1.9399 | pg_loss: 0.0823 | reg_loss: 0.6860 | reward: -0.2382 | rev_kl: 0.8471 | stu_lens: 92.0000 | mixed_lens: 115.0000 | lr: 4.9573e-06 | scale: 1024.00 | time: 26.364 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    159/  1000| tot_loss: 2.3964 | rl_loss: 0.6008 | pt_loss: 1.7956 | pg_loss: 0.0522 | reg_loss: 0.5486 | reward: -0.1839 | rev_kl: 0.8166 | stu_lens: 65.0000 | mixed_lens: 114.0000 | lr: 4.9557e-06 | scale: 1024.00 | time: 26.381 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    160/  1000| tot_loss: 2.9530 | rl_loss: 0.8781 | pt_loss: 2.0749 | pg_loss: 0.0216 | reg_loss: 0.8565 | reward: -0.2959 | rev_kl: 1.0299 | stu_lens: 86.0000 | mixed_lens: 128.0000 | lr: 4.9541e-06 | scale: 1024.00 | time: 26.347 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    160/  1000| tot_loss: 2.8951 | rl_loss: 1.1491 | pt_loss: 1.7460 | pg_loss: 0.3156 | reg_loss: 0.8335 | reward: -0.5576 | rev_kl: 1.1153 | stu_lens: 91.2500 | mixed_lens: 88.3281 | lr: 4.9541e-06 | scale: 1024.00 | time: 26.347 | step time: 27.646
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    161/  1000| tot_loss: 2.6498 | rl_loss: 0.6141 | pt_loss: 2.0357 | pg_loss: 0.0096 | reg_loss: 0.6045 | reward: -0.0666 | rev_kl: 1.1226 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9524e-06 | scale: 1024.00 | time: 26.382 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    162/  1000| tot_loss: 2.9279 | rl_loss: 1.7227 | pt_loss: 1.2052 | pg_loss: 1.3301 | reg_loss: 0.3926 | reward: -0.9754 | rev_kl: 1.2002 | stu_lens: 69.0000 | mixed_lens: 26.0000 | lr: 4.9507e-06 | scale: 1024.00 | time: 26.386 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    163/  1000| tot_loss: 2.2618 | rl_loss: 0.4136 | pt_loss: 1.8483 | pg_loss: 0.0024 | reg_loss: 0.4111 | reward: -0.2883 | rev_kl: 1.2737 | stu_lens: 116.0000 | mixed_lens: 124.0000 | lr: 4.9489e-06 | scale: 1024.00 | time: 26.407 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    164/  1000| tot_loss: 2.1643 | rl_loss: 0.6025 | pt_loss: 1.5618 | pg_loss: 0.0369 | reg_loss: 0.5656 | reward: -0.4306 | rev_kl: 1.5028 | stu_lens: 103.5000 | mixed_lens: 127.0000 | lr: 4.9472e-06 | scale: 1024.00 | time: 26.418 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    165/  1000| tot_loss: 2.6942 | rl_loss: 1.2912 | pt_loss: 1.4030 | pg_loss: 0.4035 | reg_loss: 0.8877 | reward: -0.1077 | rev_kl: 0.9961 | stu_lens: 59.5000 | mixed_lens: 60.5000 | lr: 4.9454e-06 | scale: 1024.00 | time: 26.429 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    166/  1000| tot_loss: 2.1470 | rl_loss: 0.7452 | pt_loss: 1.4017 | pg_loss: 0.2460 | reg_loss: 0.4992 | reward: -0.4950 | rev_kl: 1.1699 | stu_lens: 95.5000 | mixed_lens: 104.0000 | lr: 4.9435e-06 | scale: 1024.00 | time: 26.418 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    167/  1000| tot_loss: 2.4707 | rl_loss: 0.6334 | pt_loss: 1.8373 | pg_loss: 0.0240 | reg_loss: 0.6094 | reward: -0.2972 | rev_kl: 1.2368 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.9417e-06 | scale: 1024.00 | time: 26.432 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    168/  1000| tot_loss: 2.4801 | rl_loss: 0.8602 | pt_loss: 1.6199 | pg_loss: 0.2255 | reg_loss: 0.6347 | reward: -0.5406 | rev_kl: 1.3247 | stu_lens: 103.5000 | mixed_lens: 91.0000 | lr: 4.9398e-06 | scale: 1024.00 | time: 26.403 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    169/  1000| tot_loss: 2.8091 | rl_loss: 1.0484 | pt_loss: 1.7606 | pg_loss: 0.4898 | reg_loss: 0.5586 | reward: -0.7578 | rev_kl: 1.3003 | stu_lens: 128.0000 | mixed_lens: 73.0000 | lr: 4.9379e-06 | scale: 1024.00 | time: 26.405 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    170/  1000| tot_loss: 2.3784 | rl_loss: 0.6183 | pt_loss: 1.7600 | pg_loss: 0.1326 | reg_loss: 0.4857 | reward: 0.3695 | rev_kl: 0.6736 | stu_lens: 70.0000 | mixed_lens: 59.0000 | lr: 4.9359e-06 | scale: 1024.00 | time: 26.376 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    171/  1000| tot_loss: 3.2132 | rl_loss: 1.0575 | pt_loss: 2.1557 | pg_loss: 0.5453 | reg_loss: 0.5122 | reward: -0.3477 | rev_kl: 1.2554 | stu_lens: 128.0000 | mixed_lens: 72.0000 | lr: 4.9339e-06 | scale: 1024.00 | time: 26.393 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    172/  1000| tot_loss: 2.5967 | rl_loss: 0.8735 | pt_loss: 1.7232 | pg_loss: 0.4111 | reg_loss: 0.4624 | reward: -0.4860 | rev_kl: 1.1905 | stu_lens: 82.5000 | mixed_lens: 79.0000 | lr: 4.9319e-06 | scale: 1024.00 | time: 26.361 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    173/  1000| tot_loss: 2.7845 | rl_loss: 0.7094 | pt_loss: 2.0751 | pg_loss: 0.0209 | reg_loss: 0.6884 | reward: -0.3399 | rev_kl: 1.3374 | stu_lens: 94.0000 | mixed_lens: 128.0000 | lr: 4.9299e-06 | scale: 1024.00 | time: 26.379 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    174/  1000| tot_loss: 2.7988 | rl_loss: 0.9295 | pt_loss: 1.8693 | pg_loss: 0.2822 | reg_loss: 0.6473 | reward: -0.4948 | rev_kl: 0.7745 | stu_lens: 106.0000 | mixed_lens: 84.0000 | lr: 4.9278e-06 | scale: 1024.00 | time: 26.348 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    175/  1000| tot_loss: 2.6146 | rl_loss: 0.9236 | pt_loss: 1.6910 | pg_loss: 0.5136 | reg_loss: 0.4100 | reward: -0.5722 | rev_kl: 1.0882 | stu_lens: 45.5000 | mixed_lens: 56.0000 | lr: 4.9257e-06 | scale: 1024.00 | time: 26.367 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    176/  1000| tot_loss: 3.4657 | rl_loss: 1.7066 | pt_loss: 1.7591 | pg_loss: 0.7981 | reg_loss: 0.9085 | reward: -1.6622 | rev_kl: 0.7934 | stu_lens: 128.0000 | mixed_lens: 41.5000 | lr: 4.9236e-06 | scale: 1024.00 | time: 26.350 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    176/  1000| tot_loss: 2.6701 | rl_loss: 0.9079 | pt_loss: 1.7622 | pg_loss: 0.3105 | reg_loss: 0.5974 | reward: -0.5372 | rev_kl: 1.1153 | stu_lens: 97.1406 | mixed_lens: 87.9688 | lr: 4.9236e-06 | scale: 1024.00 | time: 26.350 | step time: 27.656
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    177/  1000| tot_loss: 2.1833 | rl_loss: 0.8339 | pt_loss: 1.3494 | pg_loss: 0.2180 | reg_loss: 0.6159 | reward: -0.3256 | rev_kl: 0.8952 | stu_lens: 53.0000 | mixed_lens: 93.0000 | lr: 4.9215e-06 | scale: 1024.00 | time: 26.394 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    178/  1000| tot_loss: 2.6045 | rl_loss: 1.0127 | pt_loss: 1.5918 | pg_loss: 0.6471 | reg_loss: 0.3656 | reward: -0.8313 | rev_kl: 1.3904 | stu_lens: 67.5000 | mixed_lens: 67.5000 | lr: 4.9193e-06 | scale: 1024.00 | time: 26.347 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    179/  1000| tot_loss: 2.2431 | rl_loss: 0.5021 | pt_loss: 1.7410 | pg_loss: 0.2087 | reg_loss: 0.2934 | reward: -0.4251 | rev_kl: 1.0857 | stu_lens: 76.5000 | mixed_lens: 88.5000 | lr: 4.9171e-06 | scale: 1024.00 | time: 26.393 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    180/  1000| tot_loss: 2.3924 | rl_loss: 0.7023 | pt_loss: 1.6901 | pg_loss: 0.2694 | reg_loss: 0.4330 | reward: -0.0768 | rev_kl: 0.9400 | stu_lens: 65.5000 | mixed_lens: 78.5000 | lr: 4.9148e-06 | scale: 1024.00 | time: 26.317 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    181/  1000| tot_loss: 2.7190 | rl_loss: 0.7834 | pt_loss: 1.9355 | pg_loss: 0.3329 | reg_loss: 0.4505 | reward: -0.4514 | rev_kl: 1.2300 | stu_lens: 128.0000 | mixed_lens: 75.0000 | lr: 4.9125e-06 | scale: 1024.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    182/  1000| tot_loss: 3.6117 | rl_loss: 1.6139 | pt_loss: 1.9979 | pg_loss: 1.0459 | reg_loss: 0.5679 | reward: -1.2236 | rev_kl: 0.8545 | stu_lens: 126.0000 | mixed_lens: 43.0000 | lr: 4.9102e-06 | scale: 1024.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    183/  1000| tot_loss: 2.3789 | rl_loss: 0.8275 | pt_loss: 1.5514 | pg_loss: 0.3001 | reg_loss: 0.5273 | reward: 0.2211 | rev_kl: 0.4853 | stu_lens: 70.0000 | mixed_lens: 76.5000 | lr: 4.9079e-06 | scale: 1024.00 | time: 26.325 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    184/  1000| tot_loss: 2.1710 | rl_loss: 0.4031 | pt_loss: 1.7679 | pg_loss: 0.0114 | reg_loss: 0.3918 | reward: -0.3129 | rev_kl: 1.2566 | stu_lens: 116.0000 | mixed_lens: 124.0000 | lr: 4.9055e-06 | scale: 1024.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    185/  1000| tot_loss: 4.0924 | rl_loss: 2.3231 | pt_loss: 1.7693 | pg_loss: 1.4051 | reg_loss: 0.9179 | reward: -1.7073 | rev_kl: 1.1229 | stu_lens: 90.5000 | mixed_lens: 31.0000 | lr: 4.9032e-06 | scale: 1024.00 | time: 26.308 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    186/  1000| tot_loss: 2.5525 | rl_loss: 0.6847 | pt_loss: 1.8678 | pg_loss: 0.2209 | reg_loss: 0.4638 | reward: -0.7370 | rev_kl: 1.1428 | stu_lens: 83.0000 | mixed_lens: 63.5000 | lr: 4.9007e-06 | scale: 1024.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    187/  1000| tot_loss: 2.3535 | rl_loss: 0.5974 | pt_loss: 1.7561 | pg_loss: 0.1645 | reg_loss: 0.4329 | reward: -0.3608 | rev_kl: 1.2281 | stu_lens: 94.0000 | mixed_lens: 108.0000 | lr: 4.8983e-06 | scale: 1024.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    188/  1000| tot_loss: 2.3744 | rl_loss: 0.4582 | pt_loss: 1.9161 | pg_loss: 0.0354 | reg_loss: 0.4228 | reward: -0.1940 | rev_kl: 1.2500 | stu_lens: 90.0000 | mixed_lens: 127.0000 | lr: 4.8958e-06 | scale: 1024.00 | time: 26.273 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    189/  1000| tot_loss: 1.9516 | rl_loss: 0.4024 | pt_loss: 1.5492 | pg_loss: 0.0079 | reg_loss: 0.3945 | reward: -0.4132 | rev_kl: 1.2220 | stu_lens: 128.0000 | mixed_lens: 123.5000 | lr: 4.8933e-06 | scale: 1024.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    190/  1000| tot_loss: 4.5271 | rl_loss: 2.7259 | pt_loss: 1.8012 | pg_loss: 1.9285 | reg_loss: 0.7974 | reward: -1.0681 | rev_kl: 1.4306 | stu_lens: 65.0000 | mixed_lens: 18.0000 | lr: 4.8908e-06 | scale: 1024.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    191/  1000| tot_loss: 1.9713 | rl_loss: 0.5380 | pt_loss: 1.4333 | pg_loss: 0.1783 | reg_loss: 0.3598 | reward: -0.3628 | rev_kl: 0.4728 | stu_lens: 89.5000 | mixed_lens: 94.5000 | lr: 4.8882e-06 | scale: 1024.00 | time: 26.326 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    192/  1000| tot_loss: 2.1102 | rl_loss: 0.3911 | pt_loss: 1.7191 | pg_loss: 0.0617 | reg_loss: 0.3294 | reward: -0.4138 | rev_kl: 1.2643 | stu_lens: 115.5000 | mixed_lens: 123.5000 | lr: 4.8856e-06 | scale: 1024.00 | time: 26.300 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    192/  1000| tot_loss: 2.5635 | rl_loss: 0.8130 | pt_loss: 1.7505 | pg_loss: 0.3507 | reg_loss: 0.4623 | reward: -0.5451 | rev_kl: 1.1091 | stu_lens: 89.1719 | mixed_lens: 88.0625 | lr: 4.8856e-06 | scale: 1024.00 | time: 26.300 | step time: 27.573
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    193/  1000| tot_loss: 2.1557 | rl_loss: 0.5333 | pt_loss: 1.6224 | pg_loss: 0.0241 | reg_loss: 0.5092 | reward: -0.3610 | rev_kl: 1.1896 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8830e-06 | scale: 1024.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    194/  1000| tot_loss: 2.8308 | rl_loss: 1.4233 | pt_loss: 1.4075 | pg_loss: 0.1528 | reg_loss: 1.2705 | reward: -0.3490 | rev_kl: 1.3514 | stu_lens: 110.0000 | mixed_lens: 119.5000 | lr: 4.8803e-06 | scale: 1024.00 | time: 26.336 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    195/  1000| tot_loss: 2.9914 | rl_loss: 1.0683 | pt_loss: 1.9231 | pg_loss: 0.0363 | reg_loss: 1.0320 | reward: -0.2124 | rev_kl: 1.2600 | stu_lens: 102.5000 | mixed_lens: 128.0000 | lr: 4.8776e-06 | scale: 1024.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    196/  1000| tot_loss: 2.8563 | rl_loss: 1.3692 | pt_loss: 1.4871 | pg_loss: 0.0351 | reg_loss: 1.3341 | reward: -0.3343 | rev_kl: 1.5769 | stu_lens: 112.0000 | mixed_lens: 127.0000 | lr: 4.8749e-06 | scale: 1024.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    197/  1000| tot_loss: 3.3080 | rl_loss: 1.7267 | pt_loss: 1.5814 | pg_loss: 0.4327 | reg_loss: 1.2940 | reward: -0.8375 | rev_kl: 1.0694 | stu_lens: 118.5000 | mixed_lens: 78.5000 | lr: 4.8722e-06 | scale: 1024.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    198/  1000| tot_loss: 2.7878 | rl_loss: 1.1807 | pt_loss: 1.6072 | pg_loss: 0.1478 | reg_loss: 1.0329 | reward: -0.2940 | rev_kl: 1.0041 | stu_lens: 125.0000 | mixed_lens: 112.5000 | lr: 4.8694e-06 | scale: 1024.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    199/  1000| tot_loss: 3.2853 | rl_loss: 1.6501 | pt_loss: 1.6353 | pg_loss: 0.5024 | reg_loss: 1.1476 | reward: -0.5567 | rev_kl: 1.0131 | stu_lens: 78.5000 | mixed_lens: 56.5000 | lr: 4.8666e-06 | scale: 1024.00 | time: 26.248 | step time: 0.000
                                 Evaluation #2                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Convert the above time to Pacific     │ Convert the above time to Pacific    │
│ Standard Time.                        │ Standard Time.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 5:00 PM Pacific Standard Time        │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ In unix 'epoch' time, the epoch is   │
│                                       │ defined as '1970-01-01 00:00:00'.    │
│                                       │ Therefore, for example, 1 second in  │
│                                       │ 'epoch' time is '1970-01-01          │
│                                       │ 00:00:01'.                           │
│                                       │ Note that the epoch is not 0         │
│                                       │ seconds, but rather 1 second.        │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 00:54:49                             │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 15.315 | exact_match: 0.103 | rev_kl: 1.119 | lens: 87.383 | pt_loss: 1.101 | lm_loss: 1.200 | kd_loss: 1.001 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    200/  1000| tot_loss: 2.8887 | rl_loss: 0.8456 | pt_loss: 2.0431 | pg_loss: 0.0345 | reg_loss: 0.8111 | reward: -0.2712 | rev_kl: 0.9690 | stu_lens: 120.0000 | mixed_lens: 128.0000 | lr: 4.8638e-06 | scale: 1024.00 | time: 26.203 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    201/  1000| tot_loss: 3.3782 | rl_loss: 1.8116 | pt_loss: 1.5666 | pg_loss: 0.5952 | reg_loss: 1.2164 | reward: -0.6898 | rev_kl: 3.4425 | stu_lens: 77.0000 | mixed_lens: 62.5000 | lr: 4.8609e-06 | scale: 1024.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    202/  1000| tot_loss: 3.7567 | rl_loss: 2.2258 | pt_loss: 1.5309 | pg_loss: 0.7448 | reg_loss: 1.4810 | reward: -0.2732 | rev_kl: 0.5703 | stu_lens: 94.5000 | mixed_lens: 46.5000 | lr: 4.8581e-06 | scale: 1024.00 | time: 26.309 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    203/  1000| tot_loss: 3.6332 | rl_loss: 1.8497 | pt_loss: 1.7835 | pg_loss: 0.2969 | reg_loss: 1.5528 | reward: -0.4297 | rev_kl: 1.4238 | stu_lens: 82.5000 | mixed_lens: 88.5000 | lr: 4.8551e-06 | scale: 1024.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    204/  1000| tot_loss: 3.1098 | rl_loss: 1.5704 | pt_loss: 1.5394 | pg_loss: 0.3349 | reg_loss: 1.2355 | reward: -0.2173 | rev_kl: 0.8484 | stu_lens: 123.0000 | mixed_lens: 82.0000 | lr: 4.8522e-06 | scale: 1024.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    205/  1000| tot_loss: 2.4675 | rl_loss: 1.1812 | pt_loss: 1.2863 | pg_loss: 0.2729 | reg_loss: 0.9082 | reward: -0.3773 | rev_kl: 0.9380 | stu_lens: 110.0000 | mixed_lens: 98.5000 | lr: 4.8492e-06 | scale: 1024.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    206/  1000| tot_loss: 4.2810 | rl_loss: 2.5006 | pt_loss: 1.7804 | pg_loss: 0.7924 | reg_loss: 1.7083 | reward: -0.8053 | rev_kl: 1.1226 | stu_lens: 64.5000 | mixed_lens: 55.5000 | lr: 4.8462e-06 | scale: 1024.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    207/  1000| tot_loss: 3.4136 | rl_loss: 1.7032 | pt_loss: 1.7105 | pg_loss: 0.0612 | reg_loss: 1.6420 | reward: -0.2885 | rev_kl: 1.1219 | stu_lens: 118.5000 | mixed_lens: 128.0000 | lr: 4.8432e-06 | scale: 1024.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    208/  1000| tot_loss: 4.1045 | rl_loss: 2.4560 | pt_loss: 1.6486 | pg_loss: 1.1420 | reg_loss: 1.3140 | reward: -1.0770 | rev_kl: 2.1136 | stu_lens: 100.0000 | mixed_lens: 35.5000 | lr: 4.8401e-06 | scale: 1024.00 | time: 26.264 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    208/  1000| tot_loss: 3.2418 | rl_loss: 1.5624 | pt_loss: 1.6794 | pg_loss: 0.3642 | reg_loss: 1.1982 | reward: -0.6753 | rev_kl: 1.1958 | stu_lens: 96.0312 | mixed_lens: 88.3750 | lr: 4.8401e-06 | scale: 1024.00 | time: 26.264 | step time: 27.536
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    209/  1000| tot_loss: 3.9551 | rl_loss: 1.9458 | pt_loss: 2.0093 | pg_loss: 1.3142 | reg_loss: 0.6316 | reward: -0.6757 | rev_kl: 0.3502 | stu_lens: 21.5000 | mixed_lens: 21.5000 | lr: 4.8371e-06 | scale: 1024.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    210/  1000| tot_loss: 3.3107 | rl_loss: 1.2391 | pt_loss: 2.0716 | pg_loss: 0.4212 | reg_loss: 0.8179 | reward: -0.8862 | rev_kl: 1.4497 | stu_lens: 98.5000 | mixed_lens: 76.0000 | lr: 4.8340e-06 | scale: 1024.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    211/  1000| tot_loss: 2.9139 | rl_loss: 1.2780 | pt_loss: 1.6359 | pg_loss: 0.3242 | reg_loss: 0.9538 | reward: -0.6021 | rev_kl: 1.3207 | stu_lens: 82.5000 | mixed_lens: 76.5000 | lr: 4.8308e-06 | scale: 1024.00 | time: 26.302 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    212/  1000| tot_loss: 3.4360 | rl_loss: 1.2464 | pt_loss: 2.1896 | pg_loss: 0.3456 | reg_loss: 0.9007 | reward: -0.3995 | rev_kl: 1.5623 | stu_lens: 88.0000 | mixed_lens: 76.5000 | lr: 4.8276e-06 | scale: 1024.00 | time: 26.331 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    213/  1000| tot_loss: 2.2908 | rl_loss: 0.6836 | pt_loss: 1.6072 | pg_loss: 0.0337 | reg_loss: 0.6499 | reward: -0.3372 | rev_kl: 0.8566 | stu_lens: 110.0000 | mixed_lens: 119.5000 | lr: 4.8244e-06 | scale: 1024.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    214/  1000| tot_loss: 4.2366 | rl_loss: 2.3958 | pt_loss: 1.8409 | pg_loss: 1.1025 | reg_loss: 1.2933 | reward: -0.5288 | rev_kl: 1.7455 | stu_lens: 128.0000 | mixed_lens: 31.5000 | lr: 4.8212e-06 | scale: 1024.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    215/  1000| tot_loss: 3.0067 | rl_loss: 1.2418 | pt_loss: 1.7648 | pg_loss: 0.4198 | reg_loss: 0.8221 | reward: -0.2829 | rev_kl: 0.8886 | stu_lens: 73.0000 | mixed_lens: 80.5000 | lr: 4.8180e-06 | scale: 1024.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    216/  1000| tot_loss: 2.7451 | rl_loss: 0.6645 | pt_loss: 2.0806 | pg_loss: 0.0142 | reg_loss: 0.6503 | reward: -0.3559 | rev_kl: 0.7128 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.8147e-06 | scale: 1024.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    217/  1000| tot_loss: 2.3962 | rl_loss: 0.8282 | pt_loss: 1.5680 | pg_loss: 0.1505 | reg_loss: 0.6777 | reward: -0.4224 | rev_kl: 1.0466 | stu_lens: 114.5000 | mixed_lens: 98.5000 | lr: 4.8114e-06 | scale: 1024.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    218/  1000| tot_loss: 3.5254 | rl_loss: 1.7261 | pt_loss: 1.7993 | pg_loss: 0.6790 | reg_loss: 1.0471 | reward: -0.3431 | rev_kl: 1.0034 | stu_lens: 73.0000 | mixed_lens: 80.5000 | lr: 4.8080e-06 | scale: 1024.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    219/  1000| tot_loss: 3.0831 | rl_loss: 1.7177 | pt_loss: 1.3654 | pg_loss: 0.5580 | reg_loss: 1.1597 | reward: -0.6138 | rev_kl: 1.1146 | stu_lens: 104.5000 | mixed_lens: 64.5000 | lr: 4.8047e-06 | scale: 1024.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    220/  1000| tot_loss: 2.9213 | rl_loss: 1.1661 | pt_loss: 1.7551 | pg_loss: 0.4580 | reg_loss: 0.7082 | reward: -0.4867 | rev_kl: 3.8501 | stu_lens: 94.5000 | mixed_lens: 64.5000 | lr: 4.8013e-06 | scale: 1024.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    221/  1000| tot_loss: 2.5261 | rl_loss: 0.7276 | pt_loss: 1.7984 | pg_loss: 0.1544 | reg_loss: 0.5732 | reward: -0.2839 | rev_kl: 1.2732 | stu_lens: 107.0000 | mixed_lens: 88.0000 | lr: 4.7978e-06 | scale: 1024.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    222/  1000| tot_loss: 2.6259 | rl_loss: 0.7504 | pt_loss: 1.8755 | pg_loss: 0.1506 | reg_loss: 0.5997 | reward: -7.8572 | rev_kl: 0.5501 | stu_lens: 76.0000 | mixed_lens: 65.0000 | lr: 4.7944e-06 | scale: 1024.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    223/  1000| tot_loss: 2.2317 | rl_loss: 0.8315 | pt_loss: 1.4002 | pg_loss: 0.0971 | reg_loss: 0.7344 | reward: -0.2888 | rev_kl: 0.7571 | stu_lens: 62.0000 | mixed_lens: 107.0000 | lr: 4.7909e-06 | scale: 1024.00 | time: 26.290 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    224/  1000| tot_loss: 2.1524 | rl_loss: 0.5660 | pt_loss: 1.5865 | pg_loss: 0.0062 | reg_loss: 0.5598 | reward: -0.5211 | rev_kl: 0.7103 | stu_lens: 75.5000 | mixed_lens: 65.5000 | lr: 4.7874e-06 | scale: 1024.00 | time: 26.280 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    224/  1000| tot_loss: 2.9262 | rl_loss: 1.1534 | pt_loss: 1.7728 | pg_loss: 0.3732 | reg_loss: 0.7801 | reward: -0.7139 | rev_kl: 1.1236 | stu_lens: 90.2188 | mixed_lens: 79.4062 | lr: 4.7874e-06 | scale: 1024.00 | time: 26.280 | step time: 27.536
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    225/  1000| tot_loss: 2.2521 | rl_loss: 0.8326 | pt_loss: 1.4194 | pg_loss: 0.0426 | reg_loss: 0.7900 | reward: -0.2544 | rev_kl: 0.9167 | stu_lens: 25.5000 | mixed_lens: 128.0000 | lr: 4.7839e-06 | scale: 1024.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    226/  1000| tot_loss: 2.2599 | rl_loss: 0.7442 | pt_loss: 1.5158 | pg_loss: 0.1919 | reg_loss: 0.5523 | reward: -0.4112 | rev_kl: 1.5039 | stu_lens: 98.5000 | mixed_lens: 98.5000 | lr: 4.7803e-06 | scale: 1024.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    227/  1000| tot_loss: 2.6571 | rl_loss: 0.7745 | pt_loss: 1.8826 | pg_loss: 0.2427 | reg_loss: 0.5318 | reward: -0.5971 | rev_kl: 1.6167 | stu_lens: 114.0000 | mixed_lens: 84.5000 | lr: 4.7767e-06 | scale: 1024.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    228/  1000| tot_loss: 1.6152 | rl_loss: 0.3608 | pt_loss: 1.2545 | pg_loss: 0.0737 | reg_loss: 0.2871 | reward: -0.2526 | rev_kl: 3.3183 | stu_lens: 128.0000 | mixed_lens: 108.0000 | lr: 4.7731e-06 | scale: 1024.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    229/  1000| tot_loss: 2.4873 | rl_loss: 0.5632 | pt_loss: 1.9241 | pg_loss: 0.1083 | reg_loss: 0.4549 | reward: -0.1397 | rev_kl: 1.2217 | stu_lens: 80.5000 | mixed_lens: 117.0000 | lr: 4.7694e-06 | scale: 1024.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    230/  1000| tot_loss: 2.8829 | rl_loss: 0.9732 | pt_loss: 1.9097 | pg_loss: 0.3025 | reg_loss: 0.6707 | reward: -0.9512 | rev_kl: 1.5531 | stu_lens: 128.0000 | mixed_lens: 82.0000 | lr: 4.7658e-06 | scale: 1024.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    231/  1000| tot_loss: 3.3332 | rl_loss: 1.0918 | pt_loss: 2.2414 | pg_loss: 0.6165 | reg_loss: 0.4752 | reward: -0.7836 | rev_kl: 0.4962 | stu_lens: 67.0000 | mixed_lens: 69.0000 | lr: 4.7621e-06 | scale: 1024.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    232/  1000| tot_loss: 2.4022 | rl_loss: 0.9570 | pt_loss: 1.4452 | pg_loss: 0.2085 | reg_loss: 0.7485 | reward: -0.5064 | rev_kl: 1.0268 | stu_lens: 88.0000 | mixed_lens: 95.0000 | lr: 4.7583e-06 | scale: 1024.00 | time: 26.310 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    233/  1000| tot_loss: 2.9056 | rl_loss: 1.1123 | pt_loss: 1.7934 | pg_loss: 0.4487 | reg_loss: 0.6636 | reward: -0.4654 | rev_kl: 1.1298 | stu_lens: 85.0000 | mixed_lens: 71.0000 | lr: 4.7546e-06 | scale: 1024.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    234/  1000| tot_loss: 2.8121 | rl_loss: 0.9950 | pt_loss: 1.8172 | pg_loss: 0.3939 | reg_loss: 0.6010 | reward: -0.8719 | rev_kl: 0.9665 | stu_lens: 54.0000 | mixed_lens: 76.0000 | lr: 4.7508e-06 | scale: 1024.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    235/  1000| tot_loss: 2.6063 | rl_loss: 0.9751 | pt_loss: 1.6312 | pg_loss: 0.2458 | reg_loss: 0.7293 | reward: -0.5024 | rev_kl: 1.4621 | stu_lens: 104.5000 | mixed_lens: 99.5000 | lr: 4.7470e-06 | scale: 1024.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    236/  1000| tot_loss: 2.5462 | rl_loss: 0.7092 | pt_loss: 1.8370 | pg_loss: 0.1362 | reg_loss: 0.5730 | reward: -0.3738 | rev_kl: 0.8129 | stu_lens: 128.0000 | mixed_lens: 93.0000 | lr: 4.7431e-06 | scale: 1024.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    237/  1000| tot_loss: 2.9629 | rl_loss: 1.1450 | pt_loss: 1.8179 | pg_loss: 0.3441 | reg_loss: 0.8009 | reward: -0.5023 | rev_kl: 1.8846 | stu_lens: 81.5000 | mixed_lens: 91.0000 | lr: 4.7393e-06 | scale: 1024.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    238/  1000| tot_loss: 2.6495 | rl_loss: 1.0522 | pt_loss: 1.5973 | pg_loss: 0.6007 | reg_loss: 0.4515 | reward: -0.1777 | rev_kl: 1.0659 | stu_lens: 79.5000 | mixed_lens: 25.5000 | lr: 4.7354e-06 | scale: 1024.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    239/  1000| tot_loss: 3.1457 | rl_loss: 1.3304 | pt_loss: 1.8153 | pg_loss: 0.6277 | reg_loss: 0.7027 | reward: -0.3615 | rev_kl: 0.6270 | stu_lens: 60.0000 | mixed_lens: 66.5000 | lr: 4.7315e-06 | scale: 1024.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    240/  1000| tot_loss: 2.5676 | rl_loss: 0.8253 | pt_loss: 1.7423 | pg_loss: 0.2716 | reg_loss: 0.5537 | reward: -0.4903 | rev_kl: 0.9885 | stu_lens: 66.0000 | mixed_lens: 97.0000 | lr: 4.7275e-06 | scale: 1024.00 | time: 26.242 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    240/  1000| tot_loss: 2.5342 | rl_loss: 0.8709 | pt_loss: 1.6633 | pg_loss: 0.2631 | reg_loss: 0.6077 | reward: -0.6758 | rev_kl: 1.1401 | stu_lens: 90.9375 | mixed_lens: 88.3750 | lr: 4.7275e-06 | scale: 1024.00 | time: 26.242 | step time: 27.520
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    241/  1000| tot_loss: 2.9307 | rl_loss: 1.0994 | pt_loss: 1.8313 | pg_loss: 0.6954 | reg_loss: 0.4040 | reward: -0.4264 | rev_kl: 1.8730 | stu_lens: 68.0000 | mixed_lens: 40.0000 | lr: 4.7235e-06 | scale: 1024.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    242/  1000| tot_loss: 2.5166 | rl_loss: 0.5409 | pt_loss: 1.9757 | pg_loss: 0.1400 | reg_loss: 0.4009 | reward: -0.4198 | rev_kl: 1.0608 | stu_lens: 127.0000 | mixed_lens: 96.0000 | lr: 4.7195e-06 | scale: 1024.00 | time: 26.323 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    243/  1000| tot_loss: 2.1762 | rl_loss: 0.6648 | pt_loss: 1.5114 | pg_loss: 0.1442 | reg_loss: 0.5206 | reward: -0.2635 | rev_kl: 1.5752 | stu_lens: 114.0000 | mixed_lens: 107.5000 | lr: 4.7155e-06 | scale: 1024.00 | time: 26.311 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    244/  1000| tot_loss: 1.6847 | rl_loss: 0.6185 | pt_loss: 1.0663 | pg_loss: 0.1965 | reg_loss: 0.4220 | reward: -0.2368 | rev_kl: 1.3790 | stu_lens: 106.0000 | mixed_lens: 106.0000 | lr: 4.7115e-06 | scale: 1024.00 | time: 26.312 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    245/  1000| tot_loss: 2.7276 | rl_loss: 0.6895 | pt_loss: 2.0381 | pg_loss: 0.2336 | reg_loss: 0.4559 | reward: -0.4131 | rev_kl: 0.9134 | stu_lens: 27.5000 | mixed_lens: 96.0000 | lr: 4.7074e-06 | scale: 1024.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    246/  1000| tot_loss: 2.8424 | rl_loss: 1.3715 | pt_loss: 1.4709 | pg_loss: 0.8015 | reg_loss: 0.5700 | reward: -0.8336 | rev_kl: 0.9935 | stu_lens: 53.5000 | mixed_lens: 54.0000 | lr: 4.7033e-06 | scale: 1024.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    247/  1000| tot_loss: 2.1886 | rl_loss: 0.3929 | pt_loss: 1.7957 | pg_loss: 0.0499 | reg_loss: 0.3430 | reward: -0.2396 | rev_kl: 0.9380 | stu_lens: 128.0000 | mixed_lens: 114.5000 | lr: 4.6991e-06 | scale: 1024.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    248/  1000| tot_loss: 1.7033 | rl_loss: 0.3644 | pt_loss: 1.3389 | pg_loss: 0.0017 | reg_loss: 0.3627 | reward: -0.2707 | rev_kl: 1.2695 | stu_lens: 118.0000 | mixed_lens: 74.5000 | lr: 4.6950e-06 | scale: 1024.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    249/  1000| tot_loss: 2.8671 | rl_loss: 0.7965 | pt_loss: 2.0706 | pg_loss: 0.3026 | reg_loss: 0.4939 | reward: -0.5604 | rev_kl: 1.3352 | stu_lens: 71.0000 | mixed_lens: 84.5000 | lr: 4.6908e-06 | scale: 1024.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    250/  1000| tot_loss: 2.1968 | rl_loss: 0.7304 | pt_loss: 1.4664 | pg_loss: 0.2638 | reg_loss: 0.4666 | reward: -0.4903 | rev_kl: 0.9885 | stu_lens: 66.0000 | mixed_lens: 97.0000 | lr: 4.6865e-06 | scale: 1024.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    251/  1000| tot_loss: 3.0432 | rl_loss: 1.3078 | pt_loss: 1.7355 | pg_loss: 0.8488 | reg_loss: 0.4589 | reward: -0.3838 | rev_kl: 1.0437 | stu_lens: 64.5000 | mixed_lens: 51.0000 | lr: 4.6823e-06 | scale: 1024.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    252/  1000| tot_loss: 2.8744 | rl_loss: 1.1255 | pt_loss: 1.7488 | pg_loss: 0.6206 | reg_loss: 0.5050 | reward: -0.7572 | rev_kl: 3.3660 | stu_lens: 67.0000 | mixed_lens: 49.0000 | lr: 4.6780e-06 | scale: 1024.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    253/  1000| tot_loss: 2.7304 | rl_loss: 0.9220 | pt_loss: 1.8084 | pg_loss: 0.6317 | reg_loss: 0.2903 | reward: -0.4356 | rev_kl: 0.3459 | stu_lens: 45.0000 | mixed_lens: 34.5000 | lr: 4.6737e-06 | scale: 1024.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    254/  1000| tot_loss: 1.9950 | rl_loss: 0.3167 | pt_loss: 1.6784 | pg_loss: 0.0132 | reg_loss: 0.3034 | reward: -0.3072 | rev_kl: 1.0078 | stu_lens: 114.0000 | mixed_lens: 126.0000 | lr: 4.6694e-06 | scale: 1024.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    255/  1000| tot_loss: 1.6494 | rl_loss: 0.6271 | pt_loss: 1.0222 | pg_loss: 0.3029 | reg_loss: 0.3243 | reward: -0.2111 | rev_kl: 0.8074 | stu_lens: 79.5000 | mixed_lens: 80.5000 | lr: 4.6651e-06 | scale: 1024.00 | time: 26.297 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    256/  1000| tot_loss: 2.9809 | rl_loss: 1.0018 | pt_loss: 1.9790 | pg_loss: 0.4351 | reg_loss: 0.5667 | reward: -0.9862 | rev_kl: 0.7753 | stu_lens: 76.5000 | mixed_lens: 39.0000 | lr: 4.6607e-06 | scale: 1024.00 | time: 26.290 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    256/  1000| tot_loss: 2.4252 | rl_loss: 0.7595 | pt_loss: 1.6657 | pg_loss: 0.3006 | reg_loss: 0.4589 | reward: -0.4605 | rev_kl: 1.1728 | stu_lens: 89.7969 | mixed_lens: 83.2656 | lr: 4.6607e-06 | scale: 1024.00 | time: 26.290 | step time: 27.539
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    257/  1000| tot_loss: 1.9786 | rl_loss: 0.4146 | pt_loss: 1.5640 | pg_loss: 0.0903 | reg_loss: 0.3243 | reward: -7.8938 | rev_kl: 0.5544 | stu_lens: 76.0000 | mixed_lens: 65.0000 | lr: 4.6563e-06 | scale: 1024.00 | time: 26.263 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    258/  1000| tot_loss: 3.3772 | rl_loss: 1.9642 | pt_loss: 1.4129 | pg_loss: 1.2471 | reg_loss: 0.7171 | reward: -0.4340 | rev_kl: 0.4106 | stu_lens: 24.0000 | mixed_lens: 20.0000 | lr: 4.6519e-06 | scale: 1024.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    259/  1000| tot_loss: 3.2922 | rl_loss: 1.7537 | pt_loss: 1.5385 | pg_loss: 0.6518 | reg_loss: 1.1019 | reward: -0.6276 | rev_kl: 0.8853 | stu_lens: 65.0000 | mixed_lens: 22.5000 | lr: 4.6474e-06 | scale: 1024.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    260/  1000| tot_loss: 2.7261 | rl_loss: 1.5401 | pt_loss: 1.1860 | pg_loss: 0.5657 | reg_loss: 0.9744 | reward: -0.2680 | rev_kl: 1.2212 | stu_lens: 91.0000 | mixed_lens: 50.5000 | lr: 4.6429e-06 | scale: 1024.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    261/  1000| tot_loss: 2.4962 | rl_loss: 0.7456 | pt_loss: 1.7506 | pg_loss: 0.0967 | reg_loss: 0.6489 | reward: -0.1002 | rev_kl: 0.9066 | stu_lens: 93.5000 | mixed_lens: 121.5000 | lr: 4.6384e-06 | scale: 1024.00 | time: 26.209 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    262/  1000| tot_loss: 3.1832 | rl_loss: 1.4710 | pt_loss: 1.7121 | pg_loss: 0.6019 | reg_loss: 0.8691 | reward: -0.6723 | rev_kl: 0.9588 | stu_lens: 47.0000 | mixed_lens: 48.5000 | lr: 4.6339e-06 | scale: 1024.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    263/  1000| tot_loss: 2.6719 | rl_loss: 1.0437 | pt_loss: 1.6282 | pg_loss: 0.0943 | reg_loss: 0.9494 | reward: -0.2775 | rev_kl: 0.9954 | stu_lens: 96.0000 | mixed_lens: 117.5000 | lr: 4.6293e-06 | scale: 1024.00 | time: 26.207 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    264/  1000| tot_loss: 3.5498 | rl_loss: 1.7287 | pt_loss: 1.8211 | pg_loss: 0.3402 | reg_loss: 1.3885 | reward: -0.3295 | rev_kl: 1.3957 | stu_lens: 53.5000 | mixed_lens: 83.5000 | lr: 4.6247e-06 | scale: 1024.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    265/  1000| tot_loss: 2.7029 | rl_loss: 1.2966 | pt_loss: 1.4063 | pg_loss: 0.3150 | reg_loss: 0.9816 | reward: -0.3053 | rev_kl: 1.7614 | stu_lens: 121.0000 | mixed_lens: 61.5000 | lr: 4.6201e-06 | scale: 1024.00 | time: 26.328 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    266/  1000| tot_loss: 3.2571 | rl_loss: 1.3347 | pt_loss: 1.9223 | pg_loss: 0.3302 | reg_loss: 1.0045 | reward: -0.2457 | rev_kl: 0.5154 | stu_lens: 43.0000 | mixed_lens: 38.0000 | lr: 4.6155e-06 | scale: 1024.00 | time: 26.334 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    267/  1000| tot_loss: 4.1860 | rl_loss: 2.1012 | pt_loss: 2.0848 | pg_loss: 0.4855 | reg_loss: 1.6158 | reward: -0.6357 | rev_kl: 1.2578 | stu_lens: 72.0000 | mixed_lens: 79.5000 | lr: 4.6108e-06 | scale: 1024.00 | time: 26.300 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    268/  1000| tot_loss: 3.3327 | rl_loss: 1.9266 | pt_loss: 1.4060 | pg_loss: 0.4936 | reg_loss: 1.4330 | reward: -0.7382 | rev_kl: 0.8738 | stu_lens: 70.5000 | mixed_lens: 70.0000 | lr: 4.6061e-06 | scale: 1024.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    269/  1000| tot_loss: 3.6268 | rl_loss: 1.7969 | pt_loss: 1.8299 | pg_loss: 0.2464 | reg_loss: 1.5504 | reward: -0.2955 | rev_kl: 0.9808 | stu_lens: 92.5000 | mixed_lens: 104.0000 | lr: 4.6014e-06 | scale: 1024.00 | time: 26.272 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    270/  1000| tot_loss: 3.8235 | rl_loss: 2.2818 | pt_loss: 1.5416 | pg_loss: 0.7252 | reg_loss: 1.5567 | reward: -1.3356 | rev_kl: 2.2649 | stu_lens: 55.5000 | mixed_lens: 48.0000 | lr: 4.5967e-06 | scale: 1024.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    271/  1000| tot_loss: 3.7353 | rl_loss: 1.9823 | pt_loss: 1.7530 | pg_loss: 0.6282 | reg_loss: 1.3541 | reward: -1.1438 | rev_kl: 1.1656 | stu_lens: 29.5000 | mixed_lens: 66.0000 | lr: 4.5919e-06 | scale: 1024.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    272/  1000| tot_loss: 2.7487 | rl_loss: 1.1377 | pt_loss: 1.6110 | pg_loss: 0.0307 | reg_loss: 1.1069 | reward: -0.2441 | rev_kl: 0.8318 | stu_lens: 128.0000 | mixed_lens: 127.5000 | lr: 4.5871e-06 | scale: 1024.00 | time: 26.260 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    272/  1000| tot_loss: 3.2467 | rl_loss: 1.5626 | pt_loss: 1.6841 | pg_loss: 0.3938 | reg_loss: 1.1688 | reward: -0.6763 | rev_kl: 1.1460 | stu_lens: 84.4375 | mixed_lens: 78.3438 | lr: 4.5871e-06 | scale: 1024.00 | time: 26.260 | step time: 27.533
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    273/  1000| tot_loss: 3.5068 | rl_loss: 2.1602 | pt_loss: 1.3466 | pg_loss: 0.6796 | reg_loss: 1.4806 | reward: -0.4076 | rev_kl: 4.1120 | stu_lens: 128.0000 | mixed_lens: 54.0000 | lr: 4.5823e-06 | scale: 1024.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    274/  1000| tot_loss: 2.2368 | rl_loss: 0.6446 | pt_loss: 1.5922 | pg_loss: 0.1840 | reg_loss: 0.4606 | reward: -0.2575 | rev_kl: 0.8892 | stu_lens: 109.5000 | mixed_lens: 96.5000 | lr: 4.5775e-06 | scale: 1024.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    275/  1000| tot_loss: 2.9007 | rl_loss: 1.4963 | pt_loss: 1.4044 | pg_loss: 0.6989 | reg_loss: 0.7974 | reward: -0.5897 | rev_kl: 1.0193 | stu_lens: 81.5000 | mixed_lens: 50.5000 | lr: 4.5726e-06 | scale: 1024.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    276/  1000| tot_loss: 2.7248 | rl_loss: 0.7638 | pt_loss: 1.9610 | pg_loss: 0.0746 | reg_loss: 0.6893 | reward: -0.2760 | rev_kl: 0.9737 | stu_lens: 128.0000 | mixed_lens: 104.0000 | lr: 4.5677e-06 | scale: 1024.00 | time: 26.327 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    277/  1000| tot_loss: 3.4119 | rl_loss: 1.2938 | pt_loss: 2.1181 | pg_loss: 0.5892 | reg_loss: 0.7046 | reward: -0.4083 | rev_kl: 4.0184 | stu_lens: 121.5000 | mixed_lens: 55.5000 | lr: 4.5628e-06 | scale: 1024.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    278/  1000| tot_loss: 5.0288 | rl_loss: 2.9983 | pt_loss: 2.0305 | pg_loss: 1.6526 | reg_loss: 1.3456 | reward: -1.2128 | rev_kl: 0.9268 | stu_lens: 37.5000 | mixed_lens: 28.5000 | lr: 4.5578e-06 | scale: 1024.00 | time: 26.304 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    279/  1000| tot_loss: 2.9088 | rl_loss: 1.4672 | pt_loss: 1.4416 | pg_loss: 0.4050 | reg_loss: 1.0621 | reward: -0.2009 | rev_kl: 1.3938 | stu_lens: 128.0000 | mixed_lens: 93.5000 | lr: 4.5529e-06 | scale: 1024.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    280/  1000| tot_loss: 3.0453 | rl_loss: 1.0832 | pt_loss: 1.9621 | pg_loss: 0.3387 | reg_loss: 0.7445 | reward: -0.3325 | rev_kl: 1.3204 | stu_lens: 128.0000 | mixed_lens: 90.5000 | lr: 4.5479e-06 | scale: 1024.00 | time: 26.289 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    281/  1000| tot_loss: 2.7787 | rl_loss: 0.9207 | pt_loss: 1.8580 | pg_loss: 0.0602 | reg_loss: 0.8605 | reward: -0.5667 | rev_kl: 1.6905 | stu_lens: 90.0000 | mixed_lens: 123.5000 | lr: 4.5429e-06 | scale: 1024.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    282/  1000| tot_loss: 2.7874 | rl_loss: 0.9951 | pt_loss: 1.7923 | pg_loss: 0.0461 | reg_loss: 0.9490 | reward: -0.4145 | rev_kl: 2.3886 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.5378e-06 | scale: 1024.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    283/  1000| tot_loss: 2.4787 | rl_loss: 1.1002 | pt_loss: 1.3785 | pg_loss: 0.4475 | reg_loss: 0.6527 | reward: -0.2283 | rev_kl: 1.5757 | stu_lens: 91.0000 | mixed_lens: 76.0000 | lr: 4.5328e-06 | scale: 1024.00 | time: 26.207 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    284/  1000| tot_loss: 3.5084 | rl_loss: 1.5642 | pt_loss: 1.9442 | pg_loss: 0.6677 | reg_loss: 0.8965 | reward: -0.1004 | rev_kl: 1.0418 | stu_lens: 62.5000 | mixed_lens: 44.5000 | lr: 4.5277e-06 | scale: 1024.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    285/  1000| tot_loss: 2.6482 | rl_loss: 0.9324 | pt_loss: 1.7157 | pg_loss: 0.3184 | reg_loss: 0.6140 | reward: -0.4187 | rev_kl: 1.1406 | stu_lens: 121.0000 | mixed_lens: 85.5000 | lr: 4.5225e-06 | scale: 1024.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    286/  1000| tot_loss: 3.1465 | rl_loss: 1.4274 | pt_loss: 1.7191 | pg_loss: 0.7150 | reg_loss: 0.7125 | reward: -0.4576 | rev_kl: 1.2248 | stu_lens: 72.0000 | mixed_lens: 79.5000 | lr: 4.5174e-06 | scale: 1024.00 | time: 26.320 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    287/  1000| tot_loss: 2.7884 | rl_loss: 1.3211 | pt_loss: 1.4673 | pg_loss: 0.4887 | reg_loss: 0.8324 | reward: -0.5349 | rev_kl: 0.6383 | stu_lens: 32.5000 | mixed_lens: 50.0000 | lr: 4.5122e-06 | scale: 1024.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    288/  1000| tot_loss: 3.6107 | rl_loss: 1.6304 | pt_loss: 1.9803 | pg_loss: 0.6188 | reg_loss: 1.0116 | reward: -1.3577 | rev_kl: 1.8135 | stu_lens: 33.0000 | mixed_lens: 70.5000 | lr: 4.5070e-06 | scale: 1024.00 | time: 26.345 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    288/  1000| tot_loss: 2.9655 | rl_loss: 1.2801 | pt_loss: 1.6855 | pg_loss: 0.4489 | reg_loss: 0.8312 | reward: -0.4314 | rev_kl: 1.3642 | stu_lens: 85.7812 | mixed_lens: 77.7344 | lr: 4.5070e-06 | scale: 1024.00 | time: 26.345 | step time: 27.541
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    289/  1000| tot_loss: 2.3758 | rl_loss: 0.6150 | pt_loss: 1.7608 | pg_loss: 0.1085 | reg_loss: 0.5065 | reward: -0.3164 | rev_kl: 0.7800 | stu_lens: 106.0000 | mixed_lens: 84.0000 | lr: 4.5018e-06 | scale: 1024.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    290/  1000| tot_loss: 2.3981 | rl_loss: 0.8889 | pt_loss: 1.5092 | pg_loss: 0.3824 | reg_loss: 0.5064 | reward: -0.4541 | rev_kl: 1.3105 | stu_lens: 114.5000 | mixed_lens: 67.5000 | lr: 4.4966e-06 | scale: 1024.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    291/  1000| tot_loss: 2.8491 | rl_loss: 1.1334 | pt_loss: 1.7157 | pg_loss: 0.3221 | reg_loss: 0.8113 | reward: -0.6982 | rev_kl: 1.1953 | stu_lens: 92.5000 | mixed_lens: 94.5000 | lr: 4.4913e-06 | scale: 1024.00 | time: 26.266 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    292/  1000| tot_loss: 3.2810 | rl_loss: 1.5006 | pt_loss: 1.7804 | pg_loss: 0.6609 | reg_loss: 0.8397 | reward: -0.6572 | rev_kl: 1.6322 | stu_lens: 50.5000 | mixed_lens: 46.0000 | lr: 4.4860e-06 | scale: 1024.00 | time: 26.275 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    293/  1000| tot_loss: 2.2575 | rl_loss: 1.0109 | pt_loss: 1.2466 | pg_loss: 0.4053 | reg_loss: 0.6056 | reward: -1.3058 | rev_kl: 2.0004 | stu_lens: 39.0000 | mixed_lens: 70.5000 | lr: 4.4807e-06 | scale: 1024.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    294/  1000| tot_loss: 2.3892 | rl_loss: 0.3582 | pt_loss: 2.0309 | pg_loss: -0.0076 | reg_loss: 0.3658 | reward: -0.3121 | rev_kl: 0.9311 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.4754e-06 | scale: 1024.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    295/  1000| tot_loss: 3.4525 | rl_loss: 1.7388 | pt_loss: 1.7137 | pg_loss: 1.0438 | reg_loss: 0.6950 | reward: -0.5811 | rev_kl: 0.6186 | stu_lens: 24.0000 | mixed_lens: 26.0000 | lr: 4.4700e-06 | scale: 1024.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    296/  1000| tot_loss: 3.0050 | rl_loss: 0.7634 | pt_loss: 2.2416 | pg_loss: 0.1462 | reg_loss: 0.6172 | reward: -0.4266 | rev_kl: 1.3129 | stu_lens: 99.0000 | mixed_lens: 107.5000 | lr: 4.4646e-06 | scale: 1024.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    297/  1000| tot_loss: 2.5748 | rl_loss: 0.9717 | pt_loss: 1.6031 | pg_loss: 0.3580 | reg_loss: 0.6137 | reward: -0.2389 | rev_kl: 1.2369 | stu_lens: 74.5000 | mixed_lens: 71.5000 | lr: 4.4592e-06 | scale: 1024.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    298/  1000| tot_loss: 2.7014 | rl_loss: 1.0944 | pt_loss: 1.6070 | pg_loss: 0.6651 | reg_loss: 0.4293 | reward: -0.8299 | rev_kl: 1.0660 | stu_lens: 20.5000 | mixed_lens: 32.5000 | lr: 4.4538e-06 | scale: 1024.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    299/  1000| tot_loss: 1.9695 | rl_loss: 0.2227 | pt_loss: 1.7468 | pg_loss: 0.1118 | reg_loss: 0.1109 | reward: -0.6219 | rev_kl: 0.5852 | stu_lens: 69.0000 | mixed_lens: 24.0000 | lr: 4.4483e-06 | scale: 1024.00 | time: 26.308 | step time: 0.000
                                 Evaluation #3                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Convert the above time to Pacific     │ Convert the above time to Pacific    │
│ Standard Time.                        │ Standard Time.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 7:00 PM                              │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ In Unix 'epoch' time, 0 seconds      │
│                                       │ would be the date 1970-01-01         │
│                                       │ 00:00:00.                            │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 1970-01-01T00:00:00Z                 │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 15.709 | exact_match: 0.000 | rev_kl: 1.129 | lens: 85.843 | pt_loss: 1.096 | lm_loss: 1.193 | kd_loss: 1.000 
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    300/  1000| tot_loss: 2.6969 | rl_loss: 0.9369 | pt_loss: 1.7600 | pg_loss: 0.2248 | reg_loss: 0.7120 | reward: -0.3732 | rev_kl: 2.6315 | stu_lens: 100.0000 | mixed_lens: 95.5000 | lr: 4.4429e-06 | scale: 1024.00 | time: 26.313 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    301/  1000| tot_loss: 2.0965 | rl_loss: 0.8253 | pt_loss: 1.2712 | pg_loss: 0.3186 | reg_loss: 0.5068 | reward: -0.3455 | rev_kl: 1.4535 | stu_lens: 109.0000 | mixed_lens: 59.5000 | lr: 4.4374e-06 | scale: 1024.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    302/  1000| tot_loss: 3.2066 | rl_loss: 1.0989 | pt_loss: 2.1077 | pg_loss: 0.4309 | reg_loss: 0.6680 | reward: -0.4354 | rev_kl: 1.1262 | stu_lens: 89.5000 | mixed_lens: 73.5000 | lr: 4.4318e-06 | scale: 1024.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    303/  1000| tot_loss: 2.6562 | rl_loss: 0.6419 | pt_loss: 2.0143 | pg_loss: 0.1871 | reg_loss: 0.4548 | reward: -0.3350 | rev_kl: 0.8572 | stu_lens: 86.0000 | mixed_lens: 95.0000 | lr: 4.4263e-06 | scale: 1024.00 | time: 26.344 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    304/  1000| tot_loss: 1.9397 | rl_loss: 0.3231 | pt_loss: 1.6167 | pg_loss: -0.3136 | reg_loss: 0.6367 | reward: -0.6400 | rev_kl: 0.8036 | stu_lens: 28.5000 | mixed_lens: 18.0000 | lr: 4.4207e-06 | scale: 1024.00 | time: 26.354 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    304/  1000| tot_loss: 2.6485 | rl_loss: 0.8853 | pt_loss: 1.7633 | pg_loss: 0.3109 | reg_loss: 0.5744 | reward: -0.4407 | rev_kl: 1.2461 | stu_lens: 84.4531 | mixed_lens: 73.7812 | lr: 4.4207e-06 | scale: 1024.00 | time: 26.354 | step time: 27.551
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    305/  1000| tot_loss: 2.4630 | rl_loss: 0.8401 | pt_loss: 1.6229 | pg_loss: 0.2234 | reg_loss: 0.6167 | reward: -0.1421 | rev_kl: 1.0903 | stu_lens: 96.0000 | mixed_lens: 101.5000 | lr: 4.4151e-06 | scale: 1024.00 | time: 26.418 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    306/  1000| tot_loss: 2.7116 | rl_loss: 0.6798 | pt_loss: 2.0318 | pg_loss: 0.2822 | reg_loss: 0.3977 | reward: -0.6387 | rev_kl: 0.8450 | stu_lens: 105.0000 | mixed_lens: 65.0000 | lr: 4.4095e-06 | scale: 1024.00 | time: 26.380 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    307/  1000| tot_loss: 2.9554 | rl_loss: 0.9797 | pt_loss: 1.9757 | pg_loss: 0.4981 | reg_loss: 0.4816 | reward: -0.1521 | rev_kl: 0.9992 | stu_lens: 81.5000 | mixed_lens: 84.0000 | lr: 4.4038e-06 | scale: 1024.00 | time: 26.390 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    308/  1000| tot_loss: 2.4788 | rl_loss: 0.8720 | pt_loss: 1.6068 | pg_loss: 0.4213 | reg_loss: 0.4507 | reward: -0.5083 | rev_kl: 0.5553 | stu_lens: 41.0000 | mixed_lens: 42.5000 | lr: 4.3982e-06 | scale: 1024.00 | time: 26.360 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    309/  1000| tot_loss: 1.9967 | rl_loss: 0.6490 | pt_loss: 1.3477 | pg_loss: 0.2223 | reg_loss: 0.4266 | reward: -0.4735 | rev_kl: 1.1426 | stu_lens: 99.0000 | mixed_lens: 91.0000 | lr: 4.3925e-06 | scale: 1024.00 | time: 26.376 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    310/  1000| tot_loss: 2.3531 | rl_loss: 0.6042 | pt_loss: 1.7489 | pg_loss: 0.2810 | reg_loss: 0.3232 | reward: -0.2148 | rev_kl: 0.8080 | stu_lens: 108.0000 | mixed_lens: 78.0000 | lr: 4.3868e-06 | scale: 1024.00 | time: 26.364 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    311/  1000| tot_loss: 2.4450 | rl_loss: 0.6279 | pt_loss: 1.8171 | pg_loss: 0.0408 | reg_loss: 0.5871 | reward: -0.2869 | rev_kl: 2.1050 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 4.3810e-06 | scale: 1024.00 | time: 26.398 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    312/  1000| tot_loss: 2.6708 | rl_loss: 0.8338 | pt_loss: 1.8370 | pg_loss: 0.4451 | reg_loss: 0.3887 | reward: -0.7671 | rev_kl: 0.7882 | stu_lens: 48.0000 | mixed_lens: 54.0000 | lr: 4.3753e-06 | scale: 1024.00 | time: 26.340 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    313/  1000| tot_loss: 2.1546 | rl_loss: 0.6553 | pt_loss: 1.4993 | pg_loss: 0.2285 | reg_loss: 0.4268 | reward: -0.5062 | rev_kl: 0.9505 | stu_lens: 111.0000 | mixed_lens: 104.0000 | lr: 4.3695e-06 | scale: 1024.00 | time: 26.352 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    314/  1000| tot_loss: 2.5373 | rl_loss: 1.1505 | pt_loss: 1.3869 | pg_loss: 0.9478 | reg_loss: 0.2027 | reward: -1.4065 | rev_kl: 1.5938 | stu_lens: 19.0000 | mixed_lens: 19.0000 | lr: 4.3637e-06 | scale: 1024.00 | time: 26.393 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    315/  1000| tot_loss: 2.6394 | rl_loss: 1.2414 | pt_loss: 1.3980 | pg_loss: 0.6431 | reg_loss: 0.5983 | reward: -0.0878 | rev_kl: 0.6045 | stu_lens: 21.0000 | mixed_lens: 39.5000 | lr: 4.3579e-06 | scale: 1024.00 | time: 26.332 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    316/  1000| tot_loss: 2.3879 | rl_loss: 0.7038 | pt_loss: 1.6841 | pg_loss: 0.1985 | reg_loss: 0.5053 | reward: -0.4435 | rev_kl: 1.2804 | stu_lens: 128.0000 | mixed_lens: 89.0000 | lr: 4.3520e-06 | scale: 1024.00 | time: 26.378 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    317/  1000| tot_loss: 2.9728 | rl_loss: 1.0999 | pt_loss: 1.8728 | pg_loss: 0.7198 | reg_loss: 0.3802 | reward: -0.9355 | rev_kl: 0.6330 | stu_lens: 67.5000 | mixed_lens: 48.0000 | lr: 4.3461e-06 | scale: 1024.00 | time: 26.356 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    318/  1000| tot_loss: 2.1759 | rl_loss: 0.4801 | pt_loss: 1.6958 | pg_loss: -0.0107 | reg_loss: 0.4908 | reward: -0.2372 | rev_kl: 1.2681 | stu_lens: 107.0000 | mixed_lens: 128.0000 | lr: 4.3402e-06 | scale: 1024.00 | time: 26.374 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    319/  1000| tot_loss: 2.9622 | rl_loss: 0.8901 | pt_loss: 2.0722 | pg_loss: 0.3091 | reg_loss: 0.5809 | reward: -0.2660 | rev_kl: 1.9066 | stu_lens: 128.0000 | mixed_lens: 69.0000 | lr: 4.3343e-06 | scale: 1024.00 | time: 26.337 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    320/  1000| tot_loss: 2.5464 | rl_loss: 0.7805 | pt_loss: 1.7659 | pg_loss: 0.4388 | reg_loss: 0.3417 | reward: -0.1833 | rev_kl: 1.4366 | stu_lens: 91.0000 | mixed_lens: 76.5000 | lr: 4.3284e-06 | scale: 1024.00 | time: 26.400 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    320/  1000| tot_loss: 2.5145 | rl_loss: 0.8226 | pt_loss: 1.6919 | pg_loss: 0.3293 | reg_loss: 0.4933 | reward: -0.4213 | rev_kl: 1.2037 | stu_lens: 86.6094 | mixed_lens: 80.0469 | lr: 4.3284e-06 | scale: 1024.00 | time: 26.400 | step time: 27.626
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    321/  1000| tot_loss: 2.2116 | rl_loss: 0.3937 | pt_loss: 1.8179 | pg_loss: 0.2130 | reg_loss: 0.1806 | reward: -0.2332 | rev_kl: 0.9463 | stu_lens: 100.0000 | mixed_lens: 95.5000 | lr: 4.3224e-06 | scale: 1024.00 | time: 26.384 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    322/  1000| tot_loss: 2.7669 | rl_loss: 1.2229 | pt_loss: 1.5440 | pg_loss: 0.2727 | reg_loss: 0.9502 | reward: -0.7329 | rev_kl: 0.5056 | stu_lens: 124.0000 | mixed_lens: 84.5000 | lr: 4.3164e-06 | scale: 1024.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    323/  1000| tot_loss: 5.0261 | rl_loss: 2.8550 | pt_loss: 2.1712 | pg_loss: 1.0792 | reg_loss: 1.7757 | reward: -3.1258 | rev_kl: 2.7145 | stu_lens: 29.0000 | mixed_lens: 38.0000 | lr: 4.3104e-06 | scale: 1024.00 | time: 26.209 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    324/  1000| tot_loss: 3.3230 | rl_loss: 1.3375 | pt_loss: 1.9855 | pg_loss: 0.2882 | reg_loss: 1.0492 | reward: -0.5507 | rev_kl: 1.2161 | stu_lens: 101.5000 | mixed_lens: 87.5000 | lr: 4.3044e-06 | scale: 1024.00 | time: 26.198 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    325/  1000| tot_loss: 2.9980 | rl_loss: 1.6855 | pt_loss: 1.3125 | pg_loss: 0.1799 | reg_loss: 1.5056 | reward: -0.4490 | rev_kl: 1.0494 | stu_lens: 100.5000 | mixed_lens: 96.0000 | lr: 4.2983e-06 | scale: 1024.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    326/  1000| tot_loss: 2.2609 | rl_loss: 0.7143 | pt_loss: 1.5466 | pg_loss: 0.0511 | reg_loss: 0.6633 | reward: 0.0350 | rev_kl: 0.8663 | stu_lens: 90.5000 | mixed_lens: 128.0000 | lr: 4.2923e-06 | scale: 1024.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    327/  1000| tot_loss: 3.5490 | rl_loss: 2.0379 | pt_loss: 1.5110 | pg_loss: 0.3930 | reg_loss: 1.6449 | reward: -0.6448 | rev_kl: 2.9667 | stu_lens: 126.5000 | mixed_lens: 95.0000 | lr: 4.2862e-06 | scale: 1024.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    328/  1000| tot_loss: 3.4549 | rl_loss: 1.8540 | pt_loss: 1.6010 | pg_loss: 0.6838 | reg_loss: 1.1701 | reward: -0.3541 | rev_kl: 1.4603 | stu_lens: 71.0000 | mixed_lens: 46.0000 | lr: 4.2801e-06 | scale: 1024.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    329/  1000| tot_loss: 3.2909 | rl_loss: 1.2384 | pt_loss: 2.0525 | pg_loss: 0.1337 | reg_loss: 1.1047 | reward: -0.1498 | rev_kl: 1.0793 | stu_lens: 61.5000 | mixed_lens: 118.5000 | lr: 4.2739e-06 | scale: 1024.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    330/  1000| tot_loss: 3.5518 | rl_loss: 1.5304 | pt_loss: 2.0214 | pg_loss: 0.0708 | reg_loss: 1.4596 | reward: -0.1666 | rev_kl: 1.3384 | stu_lens: 108.5000 | mixed_lens: 128.0000 | lr: 4.2678e-06 | scale: 1024.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    331/  1000| tot_loss: 3.5194 | rl_loss: 1.8632 | pt_loss: 1.6562 | pg_loss: 0.2817 | reg_loss: 1.5815 | reward: -0.3859 | rev_kl: 1.4848 | stu_lens: 110.0000 | mixed_lens: 92.0000 | lr: 4.2616e-06 | scale: 1024.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    332/  1000| tot_loss: 3.1957 | rl_loss: 1.5009 | pt_loss: 1.6948 | pg_loss: 0.3953 | reg_loss: 1.1056 | reward: -0.7271 | rev_kl: 1.2583 | stu_lens: 68.0000 | mixed_lens: 78.5000 | lr: 4.2554e-06 | scale: 1024.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    333/  1000| tot_loss: 3.8361 | rl_loss: 1.6687 | pt_loss: 2.1674 | pg_loss: 0.3234 | reg_loss: 1.3453 | reward: -0.3267 | rev_kl: 1.0256 | stu_lens: 101.0000 | mixed_lens: 104.0000 | lr: 4.2492e-06 | scale: 1024.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    334/  1000| tot_loss: 3.7149 | rl_loss: 1.8103 | pt_loss: 1.9046 | pg_loss: 0.4795 | reg_loss: 1.3308 | reward: -0.9928 | rev_kl: 1.3059 | stu_lens: 54.0000 | mixed_lens: 71.5000 | lr: 4.2429e-06 | scale: 1024.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    335/  1000| tot_loss: 4.3627 | rl_loss: 2.6142 | pt_loss: 1.7484 | pg_loss: 0.9539 | reg_loss: 1.6604 | reward: -0.3085 | rev_kl: 1.4830 | stu_lens: 59.5000 | mixed_lens: 52.0000 | lr: 4.2366e-06 | scale: 1024.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    336/  1000| tot_loss: 2.7950 | rl_loss: 1.1336 | pt_loss: 1.6614 | pg_loss: 0.1703 | reg_loss: 0.9633 | reward: -0.1870 | rev_kl: 1.2801 | stu_lens: 97.0000 | mixed_lens: 110.0000 | lr: 4.2304e-06 | scale: 1024.00 | time: 26.283 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    336/  1000| tot_loss: 3.4312 | rl_loss: 1.7120 | pt_loss: 1.7192 | pg_loss: 0.4973 | reg_loss: 1.2146 | reward: -0.5557 | rev_kl: 1.3842 | stu_lens: 79.9688 | mixed_lens: 78.2812 | lr: 4.2304e-06 | scale: 1024.00 | time: 26.283 | step time: 27.519
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    337/  1000| tot_loss: 2.6689 | rl_loss: 0.9310 | pt_loss: 1.7380 | pg_loss: 0.1331 | reg_loss: 0.7978 | reward: -0.3847 | rev_kl: 1.3208 | stu_lens: 71.5000 | mixed_lens: 74.5000 | lr: 4.2240e-06 | scale: 1024.00 | time: 26.295 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    338/  1000| tot_loss: 2.6246 | rl_loss: 0.5942 | pt_loss: 2.0304 | pg_loss: 0.0065 | reg_loss: 0.5877 | reward: -0.0938 | rev_kl: 1.4310 | stu_lens: 90.5000 | mixed_lens: 128.0000 | lr: 4.2177e-06 | scale: 1024.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    339/  1000| tot_loss: 2.3932 | rl_loss: 0.9935 | pt_loss: 1.3997 | pg_loss: 0.2103 | reg_loss: 0.7832 | reward: -0.3900 | rev_kl: 1.0423 | stu_lens: 90.0000 | mixed_lens: 104.0000 | lr: 4.2114e-06 | scale: 1024.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    340/  1000| tot_loss: 2.9699 | rl_loss: 1.1836 | pt_loss: 1.7863 | pg_loss: 0.2374 | reg_loss: 0.9463 | reward: -0.4176 | rev_kl: 1.3262 | stu_lens: 121.5000 | mixed_lens: 91.0000 | lr: 4.2050e-06 | scale: 1024.00 | time: 26.225 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    341/  1000| tot_loss: 2.9358 | rl_loss: 0.9287 | pt_loss: 2.0070 | pg_loss: 0.1982 | reg_loss: 0.7305 | reward: -0.2608 | rev_kl: 1.1451 | stu_lens: 22.5000 | mixed_lens: 99.5000 | lr: 4.1986e-06 | scale: 1024.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    342/  1000| tot_loss: 2.5633 | rl_loss: 0.7173 | pt_loss: 1.8459 | pg_loss: 0.1326 | reg_loss: 0.5848 | reward: 0.0246 | rev_kl: 1.3478 | stu_lens: 102.0000 | mixed_lens: 78.0000 | lr: 4.1922e-06 | scale: 1024.00 | time: 26.199 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    343/  1000| tot_loss: 2.7608 | rl_loss: 1.3399 | pt_loss: 1.4209 | pg_loss: 0.7873 | reg_loss: 0.5526 | reward: -0.6686 | rev_kl: 1.2080 | stu_lens: 83.5000 | mixed_lens: 64.5000 | lr: 4.1858e-06 | scale: 1024.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    344/  1000| tot_loss: 3.3125 | rl_loss: 1.9946 | pt_loss: 1.3179 | pg_loss: 1.1076 | reg_loss: 0.8871 | reward: -0.9499 | rev_kl: 1.3054 | stu_lens: 42.5000 | mixed_lens: 51.0000 | lr: 4.1793e-06 | scale: 1024.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    345/  1000| tot_loss: 2.9440 | rl_loss: 1.1830 | pt_loss: 1.7610 | pg_loss: 0.2362 | reg_loss: 0.9468 | reward: -0.4784 | rev_kl: 1.4412 | stu_lens: 119.5000 | mixed_lens: 92.0000 | lr: 4.1728e-06 | scale: 1024.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    346/  1000| tot_loss: 1.8591 | rl_loss: 0.5958 | pt_loss: 1.2633 | pg_loss: 0.0289 | reg_loss: 0.5668 | reward: -0.1828 | rev_kl: 0.8919 | stu_lens: 126.0000 | mixed_lens: 128.0000 | lr: 4.1663e-06 | scale: 1024.00 | time: 26.292 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    347/  1000| tot_loss: 3.9930 | rl_loss: 2.2924 | pt_loss: 1.7006 | pg_loss: 1.3147 | reg_loss: 0.9777 | reward: -1.6880 | rev_kl: 0.5672 | stu_lens: 40.5000 | mixed_lens: 27.5000 | lr: 4.1598e-06 | scale: 1024.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    348/  1000| tot_loss: 3.1974 | rl_loss: 1.5375 | pt_loss: 1.6598 | pg_loss: 0.6596 | reg_loss: 0.8780 | reward: -0.3564 | rev_kl: 1.2339 | stu_lens: 44.5000 | mixed_lens: 56.5000 | lr: 4.1533e-06 | scale: 1024.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    349/  1000| tot_loss: 2.2532 | rl_loss: 0.6556 | pt_loss: 1.5976 | pg_loss: 0.0829 | reg_loss: 0.5727 | reward: -0.1475 | rev_kl: 1.3603 | stu_lens: 81.5000 | mixed_lens: 114.5000 | lr: 4.1467e-06 | scale: 1024.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    350/  1000| tot_loss: 3.8906 | rl_loss: 2.0780 | pt_loss: 1.8126 | pg_loss: 1.1076 | reg_loss: 0.9704 | reward: -0.6089 | rev_kl: 1.7241 | stu_lens: 32.5000 | mixed_lens: 41.5000 | lr: 4.1401e-06 | scale: 1024.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    351/  1000| tot_loss: 2.9175 | rl_loss: 1.4780 | pt_loss: 1.4394 | pg_loss: 0.7768 | reg_loss: 0.7013 | reward: -1.3920 | rev_kl: 1.6333 | stu_lens: 66.5000 | mixed_lens: 41.0000 | lr: 4.1336e-06 | scale: 1024.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    352/  1000| tot_loss: 2.4898 | rl_loss: 1.3886 | pt_loss: 1.1012 | pg_loss: 0.5115 | reg_loss: 0.8770 | reward: -0.9763 | rev_kl: 1.2899 | stu_lens: 40.0000 | mixed_lens: 68.0000 | lr: 4.1269e-06 | scale: 1024.00 | time: 26.187 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    352/  1000| tot_loss: 2.9868 | rl_loss: 1.3224 | pt_loss: 1.6644 | pg_loss: 0.5022 | reg_loss: 0.8201 | reward: -0.6342 | rev_kl: 1.3219 | stu_lens: 75.0781 | mixed_lens: 76.9219 | lr: 4.1269e-06 | scale: 1024.00 | time: 26.187 | step time: 27.512
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    353/  1000| tot_loss: 2.9546 | rl_loss: 1.2330 | pt_loss: 1.7216 | pg_loss: 0.5201 | reg_loss: 0.7129 | reward: -0.3798 | rev_kl: 1.4543 | stu_lens: 94.5000 | mixed_lens: 67.0000 | lr: 4.1203e-06 | scale: 1024.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    354/  1000| tot_loss: 3.1788 | rl_loss: 1.6565 | pt_loss: 1.5223 | pg_loss: 0.8416 | reg_loss: 0.8149 | reward: -0.9966 | rev_kl: 2.0439 | stu_lens: 29.5000 | mixed_lens: 41.5000 | lr: 4.1136e-06 | scale: 1024.00 | time: 26.220 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    355/  1000| tot_loss: 2.1421 | rl_loss: 0.4626 | pt_loss: 1.6795 | pg_loss: 0.1364 | reg_loss: 0.3263 | reward: -0.4263 | rev_kl: 1.1587 | stu_lens: 98.0000 | mixed_lens: 84.5000 | lr: 4.1070e-06 | scale: 1024.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    356/  1000| tot_loss: 2.1372 | rl_loss: 0.5027 | pt_loss: 1.6345 | pg_loss: -0.0044 | reg_loss: 0.5071 | reward: -0.2127 | rev_kl: 0.5574 | stu_lens: 124.0000 | mixed_lens: 128.0000 | lr: 4.1003e-06 | scale: 1024.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    357/  1000| tot_loss: 2.7260 | rl_loss: 0.9890 | pt_loss: 1.7369 | pg_loss: 0.4073 | reg_loss: 0.5817 | reward: -0.2292 | rev_kl: 1.1580 | stu_lens: 102.0000 | mixed_lens: 83.5000 | lr: 4.0936e-06 | scale: 1024.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    358/  1000| tot_loss: 3.2768 | rl_loss: 1.6481 | pt_loss: 1.6287 | pg_loss: 1.0141 | reg_loss: 0.6340 | reward: -0.5379 | rev_kl: 1.0047 | stu_lens: 61.5000 | mixed_lens: 34.0000 | lr: 4.0868e-06 | scale: 1024.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    359/  1000| tot_loss: 3.9128 | rl_loss: 2.1373 | pt_loss: 1.7755 | pg_loss: 1.6766 | reg_loss: 0.4607 | reward: -2.1094 | rev_kl: 1.9459 | stu_lens: 7.0000 | mixed_lens: 15.0000 | lr: 4.0801e-06 | scale: 1024.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    360/  1000| tot_loss: 2.7575 | rl_loss: 0.8496 | pt_loss: 1.9079 | pg_loss: 0.3626 | reg_loss: 0.4870 | reward: -0.2313 | rev_kl: 1.0285 | stu_lens: 70.0000 | mixed_lens: 90.5000 | lr: 4.0733e-06 | scale: 1024.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    361/  1000| tot_loss: 3.4368 | rl_loss: 1.3465 | pt_loss: 2.0903 | pg_loss: 0.9772 | reg_loss: 0.3693 | reward: -1.5634 | rev_kl: 0.8849 | stu_lens: 22.5000 | mixed_lens: 27.5000 | lr: 4.0665e-06 | scale: 1024.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    362/  1000| tot_loss: 2.9859 | rl_loss: 1.0026 | pt_loss: 1.9833 | pg_loss: 0.2492 | reg_loss: 0.7534 | reward: -0.2063 | rev_kl: 1.6070 | stu_lens: 105.5000 | mixed_lens: 86.0000 | lr: 4.0597e-06 | scale: 1024.00 | time: 26.205 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    363/  1000| tot_loss: 2.1301 | rl_loss: 0.4879 | pt_loss: 1.6421 | pg_loss: 0.0837 | reg_loss: 0.4042 | reward: -0.2799 | rev_kl: 0.7798 | stu_lens: 38.0000 | mixed_lens: 118.5000 | lr: 4.0529e-06 | scale: 1024.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    364/  1000| tot_loss: 2.8036 | rl_loss: 1.0145 | pt_loss: 1.7891 | pg_loss: 0.5048 | reg_loss: 0.5097 | reward: -0.2406 | rev_kl: 1.2397 | stu_lens: 121.5000 | mixed_lens: 66.0000 | lr: 4.0460e-06 | scale: 1024.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    365/  1000| tot_loss: 2.8385 | rl_loss: 0.9677 | pt_loss: 1.8708 | pg_loss: 0.3750 | reg_loss: 0.5927 | reward: -0.6463 | rev_kl: 1.3113 | stu_lens: 70.0000 | mixed_lens: 56.0000 | lr: 4.0392e-06 | scale: 1024.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    366/  1000| tot_loss: 2.8439 | rl_loss: 0.9316 | pt_loss: 1.9123 | pg_loss: 0.3822 | reg_loss: 0.5494 | reward: -0.2453 | rev_kl: 0.9426 | stu_lens: 48.0000 | mixed_lens: 78.0000 | lr: 4.0323e-06 | scale: 1024.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    367/  1000| tot_loss: 2.2016 | rl_loss: 0.7169 | pt_loss: 1.4847 | pg_loss: 0.1247 | reg_loss: 0.5921 | reward: -0.2391 | rev_kl: 1.0101 | stu_lens: 100.5000 | mixed_lens: 104.0000 | lr: 4.0254e-06 | scale: 1024.00 | time: 26.299 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    368/  1000| tot_loss: 2.1883 | rl_loss: 0.6445 | pt_loss: 1.5438 | pg_loss: 0.2085 | reg_loss: 0.4360 | reward: -0.6691 | rev_kl: 0.8377 | stu_lens: 75.5000 | mixed_lens: 87.5000 | lr: 4.0184e-06 | scale: 1024.00 | time: 26.265 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    368/  1000| tot_loss: 2.7094 | rl_loss: 1.0255 | pt_loss: 1.6839 | pg_loss: 0.4340 | reg_loss: 0.5916 | reward: -0.5917 | rev_kl: 1.2911 | stu_lens: 78.4688 | mixed_lens: 76.2031 | lr: 4.0184e-06 | scale: 1024.00 | time: 26.265 | step time: 27.521
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    369/  1000| tot_loss: 3.0344 | rl_loss: 0.8847 | pt_loss: 2.1498 | pg_loss: 0.2402 | reg_loss: 0.6444 | reward: -0.4879 | rev_kl: 3.0682 | stu_lens: 117.0000 | mixed_lens: 95.0000 | lr: 4.0115e-06 | scale: 1024.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    370/  1000| tot_loss: 2.4518 | rl_loss: 0.8015 | pt_loss: 1.6504 | pg_loss: 0.2396 | reg_loss: 0.5619 | reward: -0.5358 | rev_kl: 2.6121 | stu_lens: 122.5000 | mixed_lens: 95.0000 | lr: 4.0045e-06 | scale: 1024.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    371/  1000| tot_loss: 3.2376 | rl_loss: 1.5415 | pt_loss: 1.6961 | pg_loss: 0.7697 | reg_loss: 0.7718 | reward: -0.3682 | rev_kl: 1.2777 | stu_lens: 75.5000 | mixed_lens: 42.0000 | lr: 3.9976e-06 | scale: 1024.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    372/  1000| tot_loss: 2.4256 | rl_loss: 1.0062 | pt_loss: 1.4194 | pg_loss: 0.3010 | reg_loss: 0.7052 | reward: -0.4777 | rev_kl: 1.2416 | stu_lens: 105.0000 | mixed_lens: 97.0000 | lr: 3.9906e-06 | scale: 1024.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    373/  1000| tot_loss: 2.5561 | rl_loss: 1.1033 | pt_loss: 1.4528 | pg_loss: 0.6056 | reg_loss: 0.4976 | reward: -0.5822 | rev_kl: 1.2134 | stu_lens: 88.5000 | mixed_lens: 70.5000 | lr: 3.9835e-06 | scale: 1024.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    374/  1000| tot_loss: 2.6683 | rl_loss: 1.0080 | pt_loss: 1.6604 | pg_loss: 0.6801 | reg_loss: 0.3279 | reward: -0.4422 | rev_kl: 1.2800 | stu_lens: 41.5000 | mixed_lens: 39.5000 | lr: 3.9765e-06 | scale: 1024.00 | time: 26.204 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    375/  1000| tot_loss: 3.4346 | rl_loss: 1.7885 | pt_loss: 1.6461 | pg_loss: 1.2031 | reg_loss: 0.5854 | reward: -1.7340 | rev_kl: 2.5702 | stu_lens: 29.0000 | mixed_lens: 37.5000 | lr: 3.9695e-06 | scale: 1024.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    376/  1000| tot_loss: 2.4648 | rl_loss: 0.8678 | pt_loss: 1.5970 | pg_loss: 0.4565 | reg_loss: 0.4113 | reward: -0.1029 | rev_kl: 0.9537 | stu_lens: 42.5000 | mixed_lens: 48.0000 | lr: 3.9624e-06 | scale: 1024.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    377/  1000| tot_loss: 2.5985 | rl_loss: 0.8365 | pt_loss: 1.7620 | pg_loss: 0.2906 | reg_loss: 0.5459 | reward: -0.4056 | rev_kl: 0.9391 | stu_lens: 100.5000 | mixed_lens: 100.5000 | lr: 3.9553e-06 | scale: 1024.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    378/  1000| tot_loss: 2.8076 | rl_loss: 0.8429 | pt_loss: 1.9647 | pg_loss: 0.2357 | reg_loss: 0.6073 | reward: -0.3257 | rev_kl: 2.4578 | stu_lens: 101.0000 | mixed_lens: 104.0000 | lr: 3.9482e-06 | scale: 1024.00 | time: 26.282 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    379/  1000| tot_loss: 2.0883 | rl_loss: 0.4303 | pt_loss: 1.6580 | pg_loss: 0.0725 | reg_loss: 0.3577 | reward: -0.1498 | rev_kl: 1.0769 | stu_lens: 111.0000 | mixed_lens: 116.5000 | lr: 3.9411e-06 | scale: 1024.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    380/  1000| tot_loss: 2.6517 | rl_loss: 0.7300 | pt_loss: 1.9217 | pg_loss: 0.1405 | reg_loss: 0.5894 | reward: -0.1192 | rev_kl: 1.3647 | stu_lens: 87.0000 | mixed_lens: 114.5000 | lr: 3.9339e-06 | scale: 1024.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    381/  1000| tot_loss: 4.3045 | rl_loss: 2.2403 | pt_loss: 2.0641 | pg_loss: 1.7654 | reg_loss: 0.4750 | reward: -0.8012 | rev_kl: 0.8153 | stu_lens: 36.0000 | mixed_lens: 22.0000 | lr: 3.9268e-06 | scale: 1024.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    382/  1000| tot_loss: 2.5592 | rl_loss: 0.6786 | pt_loss: 1.8805 | pg_loss: 0.2360 | reg_loss: 0.4426 | reward: -0.1227 | rev_kl: 0.9588 | stu_lens: 119.0000 | mixed_lens: 95.0000 | lr: 3.9196e-06 | scale: 1024.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    383/  1000| tot_loss: 2.3164 | rl_loss: 0.7708 | pt_loss: 1.5456 | pg_loss: 0.4327 | reg_loss: 0.3382 | reward: -0.3303 | rev_kl: 1.5266 | stu_lens: 106.0000 | mixed_lens: 86.0000 | lr: 3.9124e-06 | scale: 1024.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    384/  1000| tot_loss: 2.4621 | rl_loss: 0.4800 | pt_loss: 1.9821 | pg_loss: -0.0072 | reg_loss: 0.4872 | reward: -0.4478 | rev_kl: 1.3270 | stu_lens: 117.0000 | mixed_lens: 128.0000 | lr: 3.9052e-06 | scale: 1024.00 | time: 26.210 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    384/  1000| tot_loss: 2.6824 | rl_loss: 0.9500 | pt_loss: 1.7325 | pg_loss: 0.4468 | reg_loss: 0.5031 | reward: -0.6058 | rev_kl: 1.3804 | stu_lens: 79.4375 | mixed_lens: 78.1719 | lr: 3.9052e-06 | scale: 1024.00 | time: 26.210 | step time: 27.507
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    385/  1000| tot_loss: 2.2745 | rl_loss: 0.5400 | pt_loss: 1.7345 | pg_loss: 0.1992 | reg_loss: 0.3408 | reward: -0.2494 | rev_kl: 1.3285 | stu_lens: 44.0000 | mixed_lens: 99.5000 | lr: 3.8980e-06 | scale: 1024.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    386/  1000| tot_loss: 3.6718 | rl_loss: 1.6000 | pt_loss: 2.0718 | pg_loss: 0.3170 | reg_loss: 1.2830 | reward: -0.4791 | rev_kl: 1.2400 | stu_lens: 113.5000 | mixed_lens: 88.0000 | lr: 3.8907e-06 | scale: 1024.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    387/  1000| tot_loss: 3.0256 | rl_loss: 1.4462 | pt_loss: 1.5794 | pg_loss: 0.1664 | reg_loss: 1.2797 | reward: -0.3002 | rev_kl: 1.3607 | stu_lens: 91.5000 | mixed_lens: 116.0000 | lr: 3.8835e-06 | scale: 1024.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    388/  1000| tot_loss: 3.6304 | rl_loss: 1.8739 | pt_loss: 1.7565 | pg_loss: 0.3246 | reg_loss: 1.5493 | reward: -0.4114 | rev_kl: 1.1984 | stu_lens: 82.0000 | mixed_lens: 83.5000 | lr: 3.8762e-06 | scale: 1024.00 | time: 26.188 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    389/  1000| tot_loss: 2.5362 | rl_loss: 1.2987 | pt_loss: 1.2375 | pg_loss: 0.0565 | reg_loss: 1.2422 | reward: -0.2062 | rev_kl: 2.0362 | stu_lens: 96.0000 | mixed_lens: 128.0000 | lr: 3.8689e-06 | scale: 1024.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    390/  1000| tot_loss: 3.3486 | rl_loss: 1.6308 | pt_loss: 1.7178 | pg_loss: 0.2550 | reg_loss: 1.3758 | reward: -0.6064 | rev_kl: 1.0984 | stu_lens: 80.0000 | mixed_lens: 41.5000 | lr: 3.8616e-06 | scale: 1024.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    391/  1000| tot_loss: 3.3152 | rl_loss: 1.5485 | pt_loss: 1.7668 | pg_loss: 0.6142 | reg_loss: 0.9343 | reward: -0.3608 | rev_kl: 0.6979 | stu_lens: 48.0000 | mixed_lens: 70.0000 | lr: 3.8543e-06 | scale: 1024.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    392/  1000| tot_loss: 3.5921 | rl_loss: 1.6064 | pt_loss: 1.9858 | pg_loss: 0.3486 | reg_loss: 1.2577 | reward: -0.7752 | rev_kl: 1.2167 | stu_lens: 94.0000 | mixed_lens: 73.5000 | lr: 3.8469e-06 | scale: 1024.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    393/  1000| tot_loss: 2.8704 | rl_loss: 1.2813 | pt_loss: 1.5891 | pg_loss: 0.1659 | reg_loss: 1.1153 | reward: -0.1525 | rev_kl: 0.8798 | stu_lens: 63.5000 | mixed_lens: 86.5000 | lr: 3.8396e-06 | scale: 1024.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    394/  1000| tot_loss: 2.9270 | rl_loss: 1.2663 | pt_loss: 1.6607 | pg_loss: 0.1611 | reg_loss: 1.1052 | reward: -0.3033 | rev_kl: 1.2971 | stu_lens: 110.5000 | mixed_lens: 112.0000 | lr: 3.8322e-06 | scale: 1024.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    395/  1000| tot_loss: 3.0658 | rl_loss: 2.0518 | pt_loss: 1.0140 | pg_loss: 1.1495 | reg_loss: 0.9023 | reward: -1.0214 | rev_kl: 1.7341 | stu_lens: 18.5000 | mixed_lens: 38.0000 | lr: 3.8248e-06 | scale: 1024.00 | time: 26.225 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    396/  1000| tot_loss: 3.3213 | rl_loss: 1.3588 | pt_loss: 1.9625 | pg_loss: 0.4688 | reg_loss: 0.8900 | reward: -0.1280 | rev_kl: 0.9532 | stu_lens: 79.0000 | mixed_lens: 58.5000 | lr: 3.8174e-06 | scale: 1024.00 | time: 26.196 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    397/  1000| tot_loss: 3.3832 | rl_loss: 2.0993 | pt_loss: 1.2839 | pg_loss: 1.3660 | reg_loss: 0.7334 | reward: -0.9974 | rev_kl: 0.9259 | stu_lens: 56.5000 | mixed_lens: 29.5000 | lr: 3.8100e-06 | scale: 1024.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    398/  1000| tot_loss: 2.9202 | rl_loss: 1.4167 | pt_loss: 1.5035 | pg_loss: 0.0760 | reg_loss: 1.3407 | reward: -0.3712 | rev_kl: 1.2517 | stu_lens: 97.0000 | mixed_lens: 117.0000 | lr: 3.8025e-06 | scale: 1024.00 | time: 26.192 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    399/  1000| tot_loss: 3.2509 | rl_loss: 1.3694 | pt_loss: 1.8815 | pg_loss: 0.0881 | reg_loss: 1.2813 | reward: -0.5442 | rev_kl: 1.2284 | stu_lens: 101.0000 | mixed_lens: 117.5000 | lr: 3.7951e-06 | scale: 1024.00 | time: 26.248 | step time: 0.000
                                 Evaluation #4                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Convert the above time to Pacific     │ Convert the above time to Pacific    │
│ Standard Time.                        │ Standard Time.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ The above time is 5:11 PM in Pacific │
│                                       │ Standard Time.                       │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ The unix 'epoch' time is 1970-01-01  │
│                                       │ 00:00:00.                            │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 2022-01-24T00:00:00+00:00            │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 15.526 | exact_match: 0.103 | rev_kl: 1.142 | lens: 81.084 | pt_loss: 1.092 | lm_loss: 1.186 | kd_loss: 0.997 
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    400/  1000| tot_loss: 3.3923 | rl_loss: 1.6511 | pt_loss: 1.7411 | pg_loss: 0.6356 | reg_loss: 1.0155 | reward: -0.3097 | rev_kl: 0.6916 | stu_lens: 73.5000 | mixed_lens: 68.0000 | lr: 3.7876e-06 | scale: 1024.00 | time: 26.205 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    400/  1000| tot_loss: 3.1702 | rl_loss: 1.5515 | pt_loss: 1.6188 | pg_loss: 0.3721 | reg_loss: 1.1794 | reward: -0.4283 | rev_kl: 1.2081 | stu_lens: 77.3594 | mixed_lens: 78.9375 | lr: 3.7876e-06 | scale: 1024.00 | time: 26.205 | step time: 27.489
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    401/  1000| tot_loss: 3.0666 | rl_loss: 1.4916 | pt_loss: 1.5749 | pg_loss: 0.0503 | reg_loss: 1.4414 | reward: -0.3397 | rev_kl: 1.4043 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7801e-06 | scale: 1024.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    402/  1000| tot_loss: 2.3213 | rl_loss: 0.8386 | pt_loss: 1.4827 | pg_loss: 0.0532 | reg_loss: 0.7854 | reward: -0.8790 | rev_kl: 1.0767 | stu_lens: 95.0000 | mixed_lens: 56.0000 | lr: 3.7726e-06 | scale: 1024.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    403/  1000| tot_loss: 3.7175 | rl_loss: 1.5804 | pt_loss: 2.1371 | pg_loss: 0.5580 | reg_loss: 1.0225 | reward: -0.8026 | rev_kl: 1.1446 | stu_lens: 41.0000 | mixed_lens: 71.0000 | lr: 3.7651e-06 | scale: 1024.00 | time: 26.279 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    404/  1000| tot_loss: 3.3684 | rl_loss: 1.5216 | pt_loss: 1.8468 | pg_loss: 0.4166 | reg_loss: 1.1050 | reward: -0.3311 | rev_kl: 1.8631 | stu_lens: 41.5000 | mixed_lens: 60.0000 | lr: 3.7575e-06 | scale: 1024.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    405/  1000| tot_loss: 2.9376 | rl_loss: 1.1305 | pt_loss: 1.8072 | pg_loss: 0.0538 | reg_loss: 1.0767 | reward: -0.2881 | rev_kl: 1.9573 | stu_lens: 108.5000 | mixed_lens: 123.5000 | lr: 3.7500e-06 | scale: 1024.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    406/  1000| tot_loss: 3.2891 | rl_loss: 1.4366 | pt_loss: 1.8525 | pg_loss: 0.5234 | reg_loss: 0.9131 | reward: -0.6708 | rev_kl: 1.1162 | stu_lens: 73.0000 | mixed_lens: 55.5000 | lr: 3.7424e-06 | scale: 1024.00 | time: 26.211 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    407/  1000| tot_loss: 2.7474 | rl_loss: 1.1091 | pt_loss: 1.6383 | pg_loss: 0.0176 | reg_loss: 1.0915 | reward: -0.2805 | rev_kl: 1.1255 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.7349e-06 | scale: 1024.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    408/  1000| tot_loss: 3.2854 | rl_loss: 1.6480 | pt_loss: 1.6373 | pg_loss: 0.7734 | reg_loss: 0.8746 | reward: -0.3333 | rev_kl: 0.8673 | stu_lens: 33.0000 | mixed_lens: 38.5000 | lr: 3.7273e-06 | scale: 1024.00 | time: 26.192 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    409/  1000| tot_loss: 2.9239 | rl_loss: 1.0976 | pt_loss: 1.8264 | pg_loss: 0.2705 | reg_loss: 0.8270 | reward: -0.2172 | rev_kl: 1.3386 | stu_lens: 104.0000 | mixed_lens: 95.0000 | lr: 3.7196e-06 | scale: 1024.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    410/  1000| tot_loss: 2.2040 | rl_loss: 0.9058 | pt_loss: 1.2982 | pg_loss: 0.1512 | reg_loss: 0.7546 | reward: -0.3055 | rev_kl: 0.8835 | stu_lens: 64.0000 | mixed_lens: 85.5000 | lr: 3.7120e-06 | scale: 1024.00 | time: 26.196 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    411/  1000| tot_loss: 2.5805 | rl_loss: 0.8800 | pt_loss: 1.7005 | pg_loss: 0.3521 | reg_loss: 0.5278 | reward: -0.1938 | rev_kl: 1.3458 | stu_lens: 57.5000 | mixed_lens: 73.5000 | lr: 3.7044e-06 | scale: 1024.00 | time: 26.276 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    412/  1000| tot_loss: 3.0285 | rl_loss: 0.9340 | pt_loss: 2.0946 | pg_loss: 0.4720 | reg_loss: 0.4619 | reward: -0.1250 | rev_kl: 0.8236 | stu_lens: 87.0000 | mixed_lens: 67.0000 | lr: 3.6967e-06 | scale: 1024.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    413/  1000| tot_loss: 3.1256 | rl_loss: 0.9042 | pt_loss: 2.2214 | pg_loss: 0.0409 | reg_loss: 0.8632 | reward: -0.2749 | rev_kl: 1.2766 | stu_lens: 100.0000 | mixed_lens: 128.0000 | lr: 3.6891e-06 | scale: 1024.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    414/  1000| tot_loss: 2.6618 | rl_loss: 1.1709 | pt_loss: 1.4909 | pg_loss: 0.4754 | reg_loss: 0.6954 | reward: -0.4580 | rev_kl: 1.2518 | stu_lens: 67.0000 | mixed_lens: 64.5000 | lr: 3.6814e-06 | scale: 1024.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    415/  1000| tot_loss: 2.6259 | rl_loss: 0.9825 | pt_loss: 1.6434 | pg_loss: 0.3683 | reg_loss: 0.6142 | reward: -0.5244 | rev_kl: 1.0185 | stu_lens: 118.0000 | mixed_lens: 83.0000 | lr: 3.6737e-06 | scale: 1024.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    416/  1000| tot_loss: 2.5473 | rl_loss: 0.7909 | pt_loss: 1.7564 | pg_loss: 0.0163 | reg_loss: 0.7746 | reward: -0.2416 | rev_kl: 1.4691 | stu_lens: 108.5000 | mixed_lens: 128.0000 | lr: 3.6660e-06 | scale: 1024.00 | time: 26.191 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    416/  1000| tot_loss: 2.8952 | rl_loss: 1.1663 | pt_loss: 1.7289 | pg_loss: 0.3382 | reg_loss: 0.8282 | reward: -0.3950 | rev_kl: 1.2114 | stu_lens: 82.6406 | mixed_lens: 85.8906 | lr: 3.6660e-06 | scale: 1024.00 | time: 26.191 | step time: 27.505
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    417/  1000| tot_loss: 2.7387 | rl_loss: 0.9790 | pt_loss: 1.7597 | pg_loss: 0.2244 | reg_loss: 0.7546 | reward: -0.4267 | rev_kl: 1.1740 | stu_lens: 114.0000 | mixed_lens: 83.0000 | lr: 3.6582e-06 | scale: 1024.00 | time: 26.203 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    418/  1000| tot_loss: 2.1232 | rl_loss: 0.6198 | pt_loss: 1.5034 | pg_loss: 0.0142 | reg_loss: 0.6056 | reward: -0.2822 | rev_kl: 2.0774 | stu_lens: 92.0000 | mixed_lens: 128.0000 | lr: 3.6505e-06 | scale: 1024.00 | time: 26.173 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    419/  1000| tot_loss: 1.3211 | rl_loss: 0.4051 | pt_loss: 0.9160 | pg_loss: 0.0134 | reg_loss: 0.3916 | reward: -0.3876 | rev_kl: 1.1591 | stu_lens: 94.0000 | mixed_lens: 126.5000 | lr: 3.6427e-06 | scale: 1024.00 | time: 26.204 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    420/  1000| tot_loss: 2.9735 | rl_loss: 1.2261 | pt_loss: 1.7473 | pg_loss: 0.5517 | reg_loss: 0.6745 | reward: -0.6391 | rev_kl: 1.1470 | stu_lens: 81.5000 | mixed_lens: 78.0000 | lr: 3.6350e-06 | scale: 1024.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    421/  1000| tot_loss: 2.9726 | rl_loss: 1.0617 | pt_loss: 1.9110 | pg_loss: 0.3456 | reg_loss: 0.7161 | reward: -0.5222 | rev_kl: 1.4162 | stu_lens: 84.5000 | mixed_lens: 83.5000 | lr: 3.6272e-06 | scale: 1024.00 | time: 26.303 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    422/  1000| tot_loss: 2.9233 | rl_loss: 0.8933 | pt_loss: 2.0300 | pg_loss: 0.2775 | reg_loss: 0.6158 | reward: -0.2002 | rev_kl: 1.0029 | stu_lens: 59.5000 | mixed_lens: 91.0000 | lr: 3.6194e-06 | scale: 1024.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    423/  1000| tot_loss: 3.3038 | rl_loss: 1.1825 | pt_loss: 2.1213 | pg_loss: 0.4366 | reg_loss: 0.7459 | reward: -0.2299 | rev_kl: 1.0151 | stu_lens: 89.0000 | mixed_lens: 79.5000 | lr: 3.6116e-06 | scale: 1024.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    424/  1000| tot_loss: 2.4441 | rl_loss: 0.9509 | pt_loss: 1.4932 | pg_loss: 0.4732 | reg_loss: 0.4777 | reward: -0.1200 | rev_kl: 1.3294 | stu_lens: 49.5000 | mixed_lens: 69.5000 | lr: 3.6038e-06 | scale: 1024.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    425/  1000| tot_loss: 2.7638 | rl_loss: 1.1503 | pt_loss: 1.6135 | pg_loss: 0.4626 | reg_loss: 0.6877 | reward: -0.6156 | rev_kl: 1.1804 | stu_lens: 91.0000 | mixed_lens: 80.5000 | lr: 3.5959e-06 | scale: 1024.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    426/  1000| tot_loss: 2.1574 | rl_loss: 0.6368 | pt_loss: 1.5207 | pg_loss: 0.1870 | reg_loss: 0.4497 | reward: -0.2299 | rev_kl: 1.2156 | stu_lens: 80.0000 | mixed_lens: 95.0000 | lr: 3.5881e-06 | scale: 1024.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    427/  1000| tot_loss: 2.3714 | rl_loss: 0.7104 | pt_loss: 1.6610 | pg_loss: 0.1293 | reg_loss: 0.5810 | reward: -0.2011 | rev_kl: 1.2142 | stu_lens: 114.0000 | mixed_lens: 93.5000 | lr: 3.5802e-06 | scale: 1024.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    428/  1000| tot_loss: 2.3759 | rl_loss: 0.3663 | pt_loss: 2.0096 | pg_loss: 0.0777 | reg_loss: 0.2886 | reward: -0.5408 | rev_kl: 1.1627 | stu_lens: 73.0000 | mixed_lens: 63.5000 | lr: 3.5723e-06 | scale: 1024.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    429/  1000| tot_loss: 2.8832 | rl_loss: 1.1299 | pt_loss: 1.7532 | pg_loss: 0.7625 | reg_loss: 0.3674 | reward: -0.9032 | rev_kl: 1.3416 | stu_lens: 84.5000 | mixed_lens: 52.0000 | lr: 3.5644e-06 | scale: 1024.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    430/  1000| tot_loss: 2.6028 | rl_loss: 0.7402 | pt_loss: 1.8627 | pg_loss: 0.3057 | reg_loss: 0.4345 | reward: -0.3508 | rev_kl: 0.7952 | stu_lens: 60.5000 | mixed_lens: 85.5000 | lr: 3.5565e-06 | scale: 1024.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    431/  1000| tot_loss: 3.1393 | rl_loss: 1.7941 | pt_loss: 1.3452 | pg_loss: 0.9925 | reg_loss: 0.8016 | reward: -1.1579 | rev_kl: 0.8688 | stu_lens: 32.5000 | mixed_lens: 27.5000 | lr: 3.5486e-06 | scale: 1024.00 | time: 26.287 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    432/  1000| tot_loss: 3.1343 | rl_loss: 0.9874 | pt_loss: 2.1469 | pg_loss: 0.2620 | reg_loss: 0.7255 | reward: -0.4555 | rev_kl: 1.6452 | stu_lens: 106.5000 | mixed_lens: 95.0000 | lr: 3.5407e-06 | scale: 1024.00 | time: 26.236 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    432/  1000| tot_loss: 2.5969 | rl_loss: 0.9631 | pt_loss: 1.6339 | pg_loss: 0.3702 | reg_loss: 0.5929 | reward: -0.4564 | rev_kl: 1.2052 | stu_lens: 81.7500 | mixed_lens: 80.4844 | lr: 3.5407e-06 | scale: 1024.00 | time: 26.236 | step time: 27.504
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    433/  1000| tot_loss: 2.8335 | rl_loss: 0.7764 | pt_loss: 2.0571 | pg_loss: 0.3700 | reg_loss: 0.4064 | reward: -0.2221 | rev_kl: 1.0940 | stu_lens: 55.0000 | mixed_lens: 77.5000 | lr: 3.5328e-06 | scale: 1024.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    434/  1000| tot_loss: 2.4207 | rl_loss: 0.4648 | pt_loss: 1.9560 | pg_loss: 0.1201 | reg_loss: 0.3446 | reward: -0.3570 | rev_kl: 0.9686 | stu_lens: 79.0000 | mixed_lens: 81.0000 | lr: 3.5248e-06 | scale: 1024.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    435/  1000| tot_loss: 2.9734 | rl_loss: 1.0322 | pt_loss: 1.9412 | pg_loss: 0.4383 | reg_loss: 0.5939 | reward: -0.9715 | rev_kl: 1.1936 | stu_lens: 84.5000 | mixed_lens: 71.5000 | lr: 3.5168e-06 | scale: 1024.00 | time: 26.278 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    436/  1000| tot_loss: 2.2123 | rl_loss: 0.6722 | pt_loss: 1.5401 | pg_loss: 0.4809 | reg_loss: 0.1913 | reward: -0.1610 | rev_kl: 0.3878 | stu_lens: 46.5000 | mixed_lens: 44.0000 | lr: 3.5089e-06 | scale: 1024.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    437/  1000| tot_loss: 2.6142 | rl_loss: 0.7820 | pt_loss: 1.8321 | pg_loss: 0.4148 | reg_loss: 0.3672 | reward: -0.5060 | rev_kl: 1.3755 | stu_lens: 101.0000 | mixed_lens: 76.5000 | lr: 3.5009e-06 | scale: 1024.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    438/  1000| tot_loss: 2.5928 | rl_loss: 0.7468 | pt_loss: 1.8460 | pg_loss: 0.2206 | reg_loss: 0.5263 | reward: -0.5296 | rev_kl: 1.1828 | stu_lens: 66.0000 | mixed_lens: 66.0000 | lr: 3.4929e-06 | scale: 1024.00 | time: 26.197 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    439/  1000| tot_loss: 2.3786 | rl_loss: 0.8977 | pt_loss: 1.4810 | pg_loss: 0.4128 | reg_loss: 0.4849 | reward: -0.7665 | rev_kl: 1.6850 | stu_lens: 56.5000 | mixed_lens: 56.5000 | lr: 3.4849e-06 | scale: 1024.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    440/  1000| tot_loss: 2.6730 | rl_loss: 0.8724 | pt_loss: 1.8005 | pg_loss: 0.3396 | reg_loss: 0.5328 | reward: -0.4960 | rev_kl: 1.7558 | stu_lens: 40.0000 | mixed_lens: 87.5000 | lr: 3.4768e-06 | scale: 1024.00 | time: 26.212 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    441/  1000| tot_loss: 2.7328 | rl_loss: 0.9247 | pt_loss: 1.8080 | pg_loss: 0.3551 | reg_loss: 0.5696 | reward: -0.1675 | rev_kl: 0.9805 | stu_lens: 75.5000 | mixed_lens: 77.0000 | lr: 3.4688e-06 | scale: 1024.00 | time: 26.285 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    442/  1000| tot_loss: 2.8284 | rl_loss: 0.6585 | pt_loss: 2.1699 | pg_loss: 0.2360 | reg_loss: 0.4225 | reward: -0.2491 | rev_kl: 2.1731 | stu_lens: 80.5000 | mixed_lens: 88.5000 | lr: 3.4607e-06 | scale: 1024.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    443/  1000| tot_loss: 2.2068 | rl_loss: 0.4291 | pt_loss: 1.7777 | pg_loss: 0.0510 | reg_loss: 0.3781 | reward: -0.1855 | rev_kl: 1.2322 | stu_lens: 128.0000 | mixed_lens: 121.0000 | lr: 3.4527e-06 | scale: 1024.00 | time: 26.291 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    444/  1000| tot_loss: 2.2899 | rl_loss: 0.7745 | pt_loss: 1.5154 | pg_loss: 0.2280 | reg_loss: 0.5465 | reward: -0.1702 | rev_kl: 1.1121 | stu_lens: 64.5000 | mixed_lens: 103.5000 | lr: 3.4446e-06 | scale: 1024.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    445/  1000| tot_loss: 2.4867 | rl_loss: 0.9991 | pt_loss: 1.4876 | pg_loss: 0.5169 | reg_loss: 0.4822 | reward: -0.0717 | rev_kl: 0.4447 | stu_lens: 31.5000 | mixed_lens: 74.5000 | lr: 3.4365e-06 | scale: 1024.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    446/  1000| tot_loss: 1.8374 | rl_loss: 0.4181 | pt_loss: 1.4193 | pg_loss: 0.0996 | reg_loss: 0.3185 | reward: -0.0614 | rev_kl: 0.9157 | stu_lens: 38.5000 | mixed_lens: 45.0000 | lr: 3.4284e-06 | scale: 1024.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    447/  1000| tot_loss: 2.5156 | rl_loss: 0.7687 | pt_loss: 1.7469 | pg_loss: 0.4236 | reg_loss: 0.3451 | reward: -0.3326 | rev_kl: 1.0643 | stu_lens: 89.0000 | mixed_lens: 74.0000 | lr: 3.4203e-06 | scale: 1024.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    448/  1000| tot_loss: 2.9480 | rl_loss: 0.9936 | pt_loss: 1.9544 | pg_loss: 0.5279 | reg_loss: 0.4657 | reward: -0.7083 | rev_kl: 1.2934 | stu_lens: 75.0000 | mixed_lens: 52.0000 | lr: 3.4122e-06 | scale: 1024.00 | time: 26.206 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    448/  1000| tot_loss: 2.4814 | rl_loss: 0.7517 | pt_loss: 1.7297 | pg_loss: 0.3107 | reg_loss: 0.4409 | reward: -0.4095 | rev_kl: 1.1751 | stu_lens: 79.0312 | mixed_lens: 81.2500 | lr: 3.4122e-06 | scale: 1024.00 | time: 26.206 | step time: 27.505
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    449/  1000| tot_loss: 2.9454 | rl_loss: 1.2047 | pt_loss: 1.7407 | pg_loss: 0.6311 | reg_loss: 0.5737 | reward: -0.6884 | rev_kl: 1.5659 | stu_lens: 90.0000 | mixed_lens: 61.0000 | lr: 3.4041e-06 | scale: 1024.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    450/  1000| tot_loss: 3.5530 | rl_loss: 1.6764 | pt_loss: 1.8767 | pg_loss: 0.6290 | reg_loss: 1.0474 | reward: -0.1654 | rev_kl: 1.4593 | stu_lens: 36.5000 | mixed_lens: 54.5000 | lr: 3.3959e-06 | scale: 1024.00 | time: 26.274 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    451/  1000| tot_loss: 3.6553 | rl_loss: 1.7108 | pt_loss: 1.9445 | pg_loss: 0.6149 | reg_loss: 1.0959 | reward: 0.2577 | rev_kl: 0.7586 | stu_lens: 66.0000 | mixed_lens: 62.5000 | lr: 3.3878e-06 | scale: 1024.00 | time: 26.190 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    452/  1000| tot_loss: 3.1196 | rl_loss: 1.8970 | pt_loss: 1.2226 | pg_loss: 0.3655 | reg_loss: 1.5315 | reward: -0.5416 | rev_kl: 1.1595 | stu_lens: 110.0000 | mixed_lens: 93.0000 | lr: 3.3796e-06 | scale: 1024.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    453/  1000| tot_loss: 3.1670 | rl_loss: 1.2064 | pt_loss: 1.9606 | pg_loss: 0.0891 | reg_loss: 1.1173 | reward: -0.2366 | rev_kl: 0.8814 | stu_lens: 98.5000 | mixed_lens: 124.0000 | lr: 3.3714e-06 | scale: 1024.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    454/  1000| tot_loss: 5.1590 | rl_loss: 3.8599 | pt_loss: 1.2991 | pg_loss: 2.2386 | reg_loss: 1.6213 | reward: -2.0239 | rev_kl: 1.0686 | stu_lens: 18.5000 | mixed_lens: 16.5000 | lr: 3.3632e-06 | scale: 1024.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    455/  1000| tot_loss: 3.3590 | rl_loss: 1.9657 | pt_loss: 1.3933 | pg_loss: 0.3854 | reg_loss: 1.5803 | reward: -0.4137 | rev_kl: 1.0299 | stu_lens: 70.0000 | mixed_lens: 81.5000 | lr: 3.3551e-06 | scale: 1024.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    456/  1000| tot_loss: 2.9807 | rl_loss: 1.2707 | pt_loss: 1.7100 | pg_loss: 0.1265 | reg_loss: 1.1442 | reward: -0.2125 | rev_kl: 1.4654 | stu_lens: 65.0000 | mixed_lens: 111.5000 | lr: 3.3468e-06 | scale: 1024.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    457/  1000| tot_loss: 3.1624 | rl_loss: 1.3795 | pt_loss: 1.7829 | pg_loss: 0.0584 | reg_loss: 1.3211 | reward: -0.1180 | rev_kl: 0.8597 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.3386e-06 | scale: 1024.00 | time: 26.212 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    458/  1000| tot_loss: 3.8110 | rl_loss: 1.9129 | pt_loss: 1.8980 | pg_loss: 0.8897 | reg_loss: 1.0233 | reward: -0.2199 | rev_kl: 0.5906 | stu_lens: 51.5000 | mixed_lens: 57.0000 | lr: 3.3304e-06 | scale: 1024.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    459/  1000| tot_loss: 3.5666 | rl_loss: 1.5644 | pt_loss: 2.0021 | pg_loss: 0.3483 | reg_loss: 1.2161 | reward: -0.5238 | rev_kl: 1.1244 | stu_lens: 99.0000 | mixed_lens: 90.5000 | lr: 3.3222e-06 | scale: 1024.00 | time: 26.204 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    460/  1000| tot_loss: 4.3639 | rl_loss: 2.8502 | pt_loss: 1.5137 | pg_loss: 0.7523 | reg_loss: 2.0979 | reward: -0.0812 | rev_kl: 1.0688 | stu_lens: 116.5000 | mixed_lens: 49.0000 | lr: 3.3139e-06 | scale: 1024.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    461/  1000| tot_loss: 3.1942 | rl_loss: 1.4481 | pt_loss: 1.7461 | pg_loss: 0.0707 | reg_loss: 1.3773 | reward: -0.2327 | rev_kl: 1.5093 | stu_lens: 121.5000 | mixed_lens: 128.0000 | lr: 3.3057e-06 | scale: 1024.00 | time: 26.192 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    462/  1000| tot_loss: 3.2083 | rl_loss: 1.5054 | pt_loss: 1.7029 | pg_loss: 0.4834 | reg_loss: 1.0220 | reward: -0.8593 | rev_kl: 0.5053 | stu_lens: 62.0000 | mixed_lens: 73.5000 | lr: 3.2974e-06 | scale: 1024.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    463/  1000| tot_loss: 3.4436 | rl_loss: 1.7822 | pt_loss: 1.6615 | pg_loss: 0.3845 | reg_loss: 1.3977 | reward: -0.1027 | rev_kl: 0.9950 | stu_lens: 94.5000 | mixed_lens: 62.0000 | lr: 3.2891e-06 | scale: 1024.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    464/  1000| tot_loss: 3.2825 | rl_loss: 1.2959 | pt_loss: 1.9865 | pg_loss: 0.3367 | reg_loss: 0.9593 | reward: -0.3505 | rev_kl: 0.6331 | stu_lens: 76.5000 | mixed_lens: 97.0000 | lr: 3.2808e-06 | scale: 1024.00 | time: 26.267 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    464/  1000| tot_loss: 3.3915 | rl_loss: 1.7058 | pt_loss: 1.6857 | pg_loss: 0.4941 | reg_loss: 1.2116 | reward: -0.4932 | rev_kl: 1.0227 | stu_lens: 83.6094 | mixed_lens: 80.3906 | lr: 3.2808e-06 | scale: 1024.00 | time: 26.267 | step time: 27.498
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    465/  1000| tot_loss: 3.8016 | rl_loss: 1.9447 | pt_loss: 1.8569 | pg_loss: 0.1433 | reg_loss: 1.8014 | reward: -0.4359 | rev_kl: 0.9144 | stu_lens: 88.5000 | mixed_lens: 116.5000 | lr: 3.2725e-06 | scale: 1024.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    466/  1000| tot_loss: 2.6694 | rl_loss: 1.1219 | pt_loss: 1.5475 | pg_loss: -0.0030 | reg_loss: 1.1250 | reward: -0.3361 | rev_kl: 0.9084 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.2642e-06 | scale: 1024.00 | time: 26.220 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    467/  1000| tot_loss: 2.5803 | rl_loss: 1.0979 | pt_loss: 1.4824 | pg_loss: 0.2034 | reg_loss: 0.8945 | reward: -0.6226 | rev_kl: 1.0060 | stu_lens: 59.0000 | mixed_lens: 96.5000 | lr: 3.2559e-06 | scale: 1024.00 | time: 26.177 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    468/  1000| tot_loss: 3.4377 | rl_loss: 1.5099 | pt_loss: 1.9277 | pg_loss: 0.4167 | reg_loss: 1.0932 | reward: -0.6697 | rev_kl: 0.9674 | stu_lens: 98.5000 | mixed_lens: 72.0000 | lr: 3.2476e-06 | scale: 1024.00 | time: 26.193 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    469/  1000| tot_loss: 3.0192 | rl_loss: 0.9410 | pt_loss: 2.0782 | pg_loss: 0.3060 | reg_loss: 0.6350 | reward: -0.5638 | rev_kl: 1.1495 | stu_lens: 93.0000 | mixed_lens: 85.0000 | lr: 3.2393e-06 | scale: 1024.00 | time: 26.175 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    470/  1000| tot_loss: 2.2110 | rl_loss: 0.4193 | pt_loss: 1.7917 | pg_loss: 0.2770 | reg_loss: 0.1423 | reward: -0.0885 | rev_kl: 0.6042 | stu_lens: 128.0000 | mixed_lens: 51.5000 | lr: 3.2309e-06 | scale: 1024.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    471/  1000| tot_loss: 2.8061 | rl_loss: 1.3353 | pt_loss: 1.4708 | pg_loss: 0.2374 | reg_loss: 1.0979 | reward: -0.6104 | rev_kl: 1.1148 | stu_lens: 88.0000 | mixed_lens: 100.0000 | lr: 3.2226e-06 | scale: 1024.00 | time: 26.192 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    472/  1000| tot_loss: 2.2609 | rl_loss: 0.5221 | pt_loss: 1.7388 | pg_loss: 0.1012 | reg_loss: 0.4209 | reward: -0.2125 | rev_kl: 0.8302 | stu_lens: 107.0000 | mixed_lens: 113.5000 | lr: 3.2142e-06 | scale: 1024.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    473/  1000| tot_loss: 2.2813 | rl_loss: 0.8525 | pt_loss: 1.4288 | pg_loss: 0.3158 | reg_loss: 0.5366 | reward: -0.5031 | rev_kl: 0.7281 | stu_lens: 88.0000 | mixed_lens: 46.5000 | lr: 3.2059e-06 | scale: 1024.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    474/  1000| tot_loss: 2.8360 | rl_loss: 1.0102 | pt_loss: 1.8258 | pg_loss: 0.1152 | reg_loss: 0.8950 | reward: -0.3610 | rev_kl: 1.3819 | stu_lens: 100.0000 | mixed_lens: 112.0000 | lr: 3.1975e-06 | scale: 1024.00 | time: 26.254 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    475/  1000| tot_loss: 2.7527 | rl_loss: 0.8943 | pt_loss: 1.8584 | pg_loss: 0.2552 | reg_loss: 0.6391 | reward: -1.8864 | rev_kl: 1.2787 | stu_lens: 90.5000 | mixed_lens: 67.0000 | lr: 3.1891e-06 | scale: 1024.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    476/  1000| tot_loss: 3.5066 | rl_loss: 1.3469 | pt_loss: 2.1597 | pg_loss: 0.7146 | reg_loss: 0.6323 | reward: -1.0235 | rev_kl: 0.6452 | stu_lens: 20.5000 | mixed_lens: 41.0000 | lr: 3.1807e-06 | scale: 1024.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    477/  1000| tot_loss: 3.1200 | rl_loss: 1.0543 | pt_loss: 2.0657 | pg_loss: 0.1668 | reg_loss: 0.8875 | reward: -0.0915 | rev_kl: 0.7180 | stu_lens: 73.0000 | mixed_lens: 73.0000 | lr: 3.1723e-06 | scale: 1024.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    478/  1000| tot_loss: 2.9300 | rl_loss: 1.1915 | pt_loss: 1.7385 | pg_loss: 0.5070 | reg_loss: 0.6845 | reward: -0.8595 | rev_kl: 0.4502 | stu_lens: 66.5000 | mixed_lens: 64.0000 | lr: 3.1639e-06 | scale: 1024.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    479/  1000| tot_loss: 2.7810 | rl_loss: 0.9565 | pt_loss: 1.8244 | pg_loss: 0.1244 | reg_loss: 0.8322 | reward: -0.2841 | rev_kl: 1.2431 | stu_lens: 128.0000 | mixed_lens: 117.0000 | lr: 3.1555e-06 | scale: 1024.00 | time: 26.205 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    480/  1000| tot_loss: 3.3099 | rl_loss: 1.3031 | pt_loss: 2.0068 | pg_loss: 0.6123 | reg_loss: 0.6908 | reward: -0.0762 | rev_kl: 0.5524 | stu_lens: 66.5000 | mixed_lens: 66.5000 | lr: 3.1470e-06 | scale: 1024.00 | time: 26.244 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    480/  1000| tot_loss: 2.9777 | rl_loss: 1.1992 | pt_loss: 1.7785 | pg_loss: 0.3419 | reg_loss: 0.8572 | reward: -0.4549 | rev_kl: 0.9608 | stu_lens: 80.6719 | mixed_lens: 80.3906 | lr: 3.1470e-06 | scale: 1024.00 | time: 26.244 | step time: 27.482
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    481/  1000| tot_loss: 4.0377 | rl_loss: 2.6505 | pt_loss: 1.3872 | pg_loss: 1.5110 | reg_loss: 1.1396 | reward: -1.6768 | rev_kl: 1.5446 | stu_lens: 16.0000 | mixed_lens: 18.0000 | lr: 3.1386e-06 | scale: 1024.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    482/  1000| tot_loss: 3.0120 | rl_loss: 1.2490 | pt_loss: 1.7630 | pg_loss: 0.4102 | reg_loss: 0.8387 | reward: -0.3350 | rev_kl: 1.0864 | stu_lens: 40.0000 | mixed_lens: 46.5000 | lr: 3.1302e-06 | scale: 1024.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    483/  1000| tot_loss: 3.0405 | rl_loss: 0.9709 | pt_loss: 2.0697 | pg_loss: 0.3380 | reg_loss: 0.6329 | reward: -0.8198 | rev_kl: 0.5225 | stu_lens: 66.5000 | mixed_lens: 61.5000 | lr: 3.1217e-06 | scale: 1024.00 | time: 26.260 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    484/  1000| tot_loss: 2.9927 | rl_loss: 1.2213 | pt_loss: 1.7714 | pg_loss: 0.6476 | reg_loss: 0.5737 | reward: -0.1737 | rev_kl: 0.5904 | stu_lens: 37.0000 | mixed_lens: 62.5000 | lr: 3.1133e-06 | scale: 1024.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    485/  1000| tot_loss: 2.1610 | rl_loss: 0.5048 | pt_loss: 1.6562 | pg_loss: 0.0587 | reg_loss: 0.4461 | reward: -0.2235 | rev_kl: 0.8343 | stu_lens: 128.0000 | mixed_lens: 112.0000 | lr: 3.1048e-06 | scale: 1024.00 | time: 26.216 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    486/  1000| tot_loss: 3.7018 | rl_loss: 1.7797 | pt_loss: 1.9222 | pg_loss: 1.0205 | reg_loss: 0.7592 | reward: -1.3651 | rev_kl: 1.3376 | stu_lens: 58.5000 | mixed_lens: 41.0000 | lr: 3.0963e-06 | scale: 1024.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    487/  1000| tot_loss: 2.6087 | rl_loss: 0.8936 | pt_loss: 1.7151 | pg_loss: 0.0803 | reg_loss: 0.8133 | reward: -0.2039 | rev_kl: 1.1261 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 3.0879e-06 | scale: 1024.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    488/  1000| tot_loss: 2.8613 | rl_loss: 1.2988 | pt_loss: 1.5625 | pg_loss: 0.4033 | reg_loss: 0.8955 | reward: -0.7084 | rev_kl: 1.4099 | stu_lens: 72.5000 | mixed_lens: 74.5000 | lr: 3.0794e-06 | scale: 1024.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    489/  1000| tot_loss: 2.6011 | rl_loss: 0.6268 | pt_loss: 1.9743 | pg_loss: 0.0117 | reg_loss: 0.6150 | reward: -0.2461 | rev_kl: 0.5724 | stu_lens: 113.0000 | mixed_lens: 124.0000 | lr: 3.0709e-06 | scale: 1024.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    490/  1000| tot_loss: 2.5414 | rl_loss: 1.3230 | pt_loss: 1.2184 | pg_loss: 0.6254 | reg_loss: 0.6976 | reward: -0.7820 | rev_kl: 0.8332 | stu_lens: 70.0000 | mixed_lens: 42.5000 | lr: 3.0624e-06 | scale: 1024.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    491/  1000| tot_loss: 2.3516 | rl_loss: 0.6695 | pt_loss: 1.6821 | pg_loss: 0.0992 | reg_loss: 0.5703 | reward: -0.0043 | rev_kl: 1.1231 | stu_lens: 116.5000 | mixed_lens: 109.5000 | lr: 3.0539e-06 | scale: 1024.00 | time: 26.193 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    492/  1000| tot_loss: 2.9631 | rl_loss: 1.2101 | pt_loss: 1.7530 | pg_loss: 0.6409 | reg_loss: 0.5692 | reward: 0.1406 | rev_kl: 1.0234 | stu_lens: 66.0000 | mixed_lens: 66.0000 | lr: 3.0454e-06 | scale: 1024.00 | time: 26.305 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    493/  1000| tot_loss: 2.9207 | rl_loss: 1.2103 | pt_loss: 1.7104 | pg_loss: 0.8143 | reg_loss: 0.3959 | reward: -0.9976 | rev_kl: 1.5809 | stu_lens: 15.0000 | mixed_lens: 47.0000 | lr: 3.0368e-06 | scale: 1024.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    494/  1000| tot_loss: 2.0956 | rl_loss: 0.8256 | pt_loss: 1.2699 | pg_loss: 0.1686 | reg_loss: 0.6571 | reward: -0.4663 | rev_kl: 0.8426 | stu_lens: 88.0000 | mixed_lens: 81.5000 | lr: 3.0283e-06 | scale: 1024.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    495/  1000| tot_loss: 3.5183 | rl_loss: 1.2056 | pt_loss: 2.3126 | pg_loss: 0.5422 | reg_loss: 0.6634 | reward: -0.1040 | rev_kl: 0.5327 | stu_lens: 73.0000 | mixed_lens: 73.0000 | lr: 3.0198e-06 | scale: 1024.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    496/  1000| tot_loss: 2.4285 | rl_loss: 1.0727 | pt_loss: 1.3558 | pg_loss: 0.3227 | reg_loss: 0.7500 | reward: -0.9223 | rev_kl: 0.7401 | stu_lens: 72.0000 | mixed_lens: 72.0000 | lr: 3.0112e-06 | scale: 1024.00 | time: 26.221 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    496/  1000| tot_loss: 2.7165 | rl_loss: 1.0339 | pt_loss: 1.6826 | pg_loss: 0.4138 | reg_loss: 0.6202 | reward: -0.5062 | rev_kl: 0.9778 | stu_lens: 79.4688 | mixed_lens: 76.3906 | lr: 3.0112e-06 | scale: 1024.00 | time: 26.221 | step time: 27.514
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    497/  1000| tot_loss: 2.4534 | rl_loss: 0.6665 | pt_loss: 1.7869 | pg_loss: 0.0695 | reg_loss: 0.5970 | reward: -0.3764 | rev_kl: 1.2282 | stu_lens: 85.5000 | mixed_lens: 119.5000 | lr: 3.0027e-06 | scale: 1024.00 | time: 26.195 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    498/  1000| tot_loss: 2.6574 | rl_loss: 1.0672 | pt_loss: 1.5902 | pg_loss: 0.7051 | reg_loss: 0.3621 | reward: -1.2420 | rev_kl: 1.0678 | stu_lens: 18.5000 | mixed_lens: 23.0000 | lr: 2.9941e-06 | scale: 1024.00 | time: 26.207 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    499/  1000| tot_loss: 2.1381 | rl_loss: 0.6416 | pt_loss: 1.4965 | pg_loss: 0.0179 | reg_loss: 0.6237 | reward: -0.4638 | rev_kl: 2.0417 | stu_lens: 111.0000 | mixed_lens: 128.0000 | lr: 2.9856e-06 | scale: 1024.00 | time: 26.198 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/500
                                 Evaluation #5                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Convert the above time to Pacific     │ Convert the above time to Pacific    │
│ Standard Time.                        │ Standard Time.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 13:00 - 14:00 = 1 hour               │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 1970-01-01 00:00:00                  │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 1970-01-01T00:00:00.000Z             │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 14.890 | exact_match: 0.000 | rev_kl: 1.127 | lens: 82.945 | pt_loss: 1.090 | lm_loss: 1.182 | kd_loss: 0.998 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    500/  1000| tot_loss: 2.1815 | rl_loss: 0.5871 | pt_loss: 1.5944 | pg_loss: 0.2422 | reg_loss: 0.3449 | reward: -0.7937 | rev_kl: 1.0452 | stu_lens: 93.5000 | mixed_lens: 84.0000 | lr: 2.9770e-06 | scale: 1024.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    501/  1000| tot_loss: 2.8944 | rl_loss: 1.0836 | pt_loss: 1.8109 | pg_loss: 0.3857 | reg_loss: 0.6978 | reward: -0.6534 | rev_kl: 0.8619 | stu_lens: 56.0000 | mixed_lens: 78.0000 | lr: 2.9685e-06 | scale: 1024.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    502/  1000| tot_loss: 2.0055 | rl_loss: 0.7080 | pt_loss: 1.2975 | pg_loss: 0.1588 | reg_loss: 0.5492 | reward: -0.6524 | rev_kl: 0.9839 | stu_lens: 128.0000 | mixed_lens: 76.0000 | lr: 2.9599e-06 | scale: 1024.00 | time: 26.201 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    503/  1000| tot_loss: 2.4406 | rl_loss: 0.7699 | pt_loss: 1.6707 | pg_loss: 0.3780 | reg_loss: 0.3919 | reward: -0.4964 | rev_kl: 1.4367 | stu_lens: 68.5000 | mixed_lens: 79.5000 | lr: 2.9513e-06 | scale: 1024.00 | time: 26.173 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    504/  1000| tot_loss: 2.4006 | rl_loss: 0.6679 | pt_loss: 1.7327 | pg_loss: 0.3076 | reg_loss: 0.3603 | reward: -0.1838 | rev_kl: 0.9352 | stu_lens: 90.0000 | mixed_lens: 85.0000 | lr: 2.9427e-06 | scale: 1024.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    505/  1000| tot_loss: 2.4008 | rl_loss: 0.5329 | pt_loss: 1.8680 | pg_loss: 0.2142 | reg_loss: 0.3187 | reward: -0.1812 | rev_kl: 0.4897 | stu_lens: 96.0000 | mixed_lens: 96.0000 | lr: 2.9341e-06 | scale: 1024.00 | time: 26.162 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    506/  1000| tot_loss: 3.1153 | rl_loss: 1.2637 | pt_loss: 1.8516 | pg_loss: 0.7621 | reg_loss: 0.5016 | reward: -0.4267 | rev_kl: 0.6607 | stu_lens: 57.0000 | mixed_lens: 49.0000 | lr: 2.9255e-06 | scale: 1024.00 | time: 26.179 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    507/  1000| tot_loss: 2.4969 | rl_loss: 0.9628 | pt_loss: 1.5342 | pg_loss: 0.4305 | reg_loss: 0.5323 | reward: -0.5217 | rev_kl: 1.0656 | stu_lens: 88.0000 | mixed_lens: 89.0000 | lr: 2.9169e-06 | scale: 1024.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    508/  1000| tot_loss: 2.0317 | rl_loss: 0.5051 | pt_loss: 1.5266 | pg_loss: 0.0375 | reg_loss: 0.4676 | reward: -0.1726 | rev_kl: 0.6150 | stu_lens: 113.0000 | mixed_lens: 124.0000 | lr: 2.9083e-06 | scale: 1024.00 | time: 26.187 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    509/  1000| tot_loss: 3.7547 | rl_loss: 1.8222 | pt_loss: 1.9326 | pg_loss: 1.1334 | reg_loss: 0.6887 | reward: -1.0107 | rev_kl: 0.2788 | stu_lens: 26.5000 | mixed_lens: 27.0000 | lr: 2.8997e-06 | scale: 1024.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    510/  1000| tot_loss: 2.5697 | rl_loss: 0.8448 | pt_loss: 1.7249 | pg_loss: 0.4498 | reg_loss: 0.3949 | reward: -0.5465 | rev_kl: 1.6066 | stu_lens: 72.5000 | mixed_lens: 71.0000 | lr: 2.8911e-06 | scale: 1024.00 | time: 26.173 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    511/  1000| tot_loss: 2.4189 | rl_loss: 0.6548 | pt_loss: 1.7641 | pg_loss: 0.2252 | reg_loss: 0.4296 | reward: -0.1938 | rev_kl: 1.6512 | stu_lens: 68.0000 | mixed_lens: 102.0000 | lr: 2.8825e-06 | scale: 1024.00 | time: 26.192 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    512/  1000| tot_loss: 2.0951 | rl_loss: 0.5589 | pt_loss: 1.5362 | pg_loss: 0.0062 | reg_loss: 0.5527 | reward: -0.2706 | rev_kl: 1.0083 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.8738e-06 | scale: 1024.00 | time: 26.181 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    512/  1000| tot_loss: 2.5202 | rl_loss: 0.8424 | pt_loss: 1.6778 | pg_loss: 0.3919 | reg_loss: 0.4505 | reward: -0.4918 | rev_kl: 1.0098 | stu_lens: 79.3594 | mixed_lens: 79.1250 | lr: 2.8738e-06 | scale: 1024.00 | time: 26.181 | step time: 27.464
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    513/  1000| tot_loss: 3.2545 | rl_loss: 1.3360 | pt_loss: 1.9185 | pg_loss: 0.8065 | reg_loss: 0.5294 | reward: -2.2465 | rev_kl: 1.2539 | stu_lens: 32.5000 | mixed_lens: 33.5000 | lr: 2.8652e-06 | scale: 1024.00 | time: 26.192 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    514/  1000| tot_loss: 2.4882 | rl_loss: 1.3339 | pt_loss: 1.1543 | pg_loss: 0.3986 | reg_loss: 0.9353 | reward: -0.3881 | rev_kl: 1.1071 | stu_lens: 87.5000 | mixed_lens: 82.0000 | lr: 2.8566e-06 | scale: 1024.00 | time: 26.196 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    515/  1000| tot_loss: 3.7421 | rl_loss: 1.9846 | pt_loss: 1.7575 | pg_loss: 0.5773 | reg_loss: 1.4073 | reward: -0.7795 | rev_kl: 2.0551 | stu_lens: 65.0000 | mixed_lens: 58.0000 | lr: 2.8479e-06 | scale: 1024.00 | time: 26.185 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    516/  1000| tot_loss: 3.1247 | rl_loss: 1.4198 | pt_loss: 1.7049 | pg_loss: 0.3442 | reg_loss: 1.0755 | reward: -0.2856 | rev_kl: 0.7708 | stu_lens: 92.0000 | mixed_lens: 96.5000 | lr: 2.8393e-06 | scale: 1024.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    517/  1000| tot_loss: 4.1092 | rl_loss: 2.4055 | pt_loss: 1.7037 | pg_loss: 1.1448 | reg_loss: 1.2607 | reward: -0.9488 | rev_kl: 0.8937 | stu_lens: 39.5000 | mixed_lens: 39.5000 | lr: 2.8306e-06 | scale: 1024.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    518/  1000| tot_loss: 4.1459 | rl_loss: 2.6027 | pt_loss: 1.5433 | pg_loss: 1.2354 | reg_loss: 1.3672 | reward: -1.1679 | rev_kl: 1.7960 | stu_lens: 52.5000 | mixed_lens: 35.0000 | lr: 2.8220e-06 | scale: 1024.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    519/  1000| tot_loss: 3.8947 | rl_loss: 1.8347 | pt_loss: 2.0600 | pg_loss: 0.4351 | reg_loss: 1.3996 | reward: -0.5007 | rev_kl: 0.5613 | stu_lens: 35.0000 | mixed_lens: 72.5000 | lr: 2.8133e-06 | scale: 1024.00 | time: 26.319 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    520/  1000| tot_loss: 3.0396 | rl_loss: 1.7807 | pt_loss: 1.2589 | pg_loss: 0.2645 | reg_loss: 1.5162 | reward: -0.5046 | rev_kl: 1.0734 | stu_lens: 59.5000 | mixed_lens: 107.5000 | lr: 2.8047e-06 | scale: 1024.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    521/  1000| tot_loss: 4.1311 | rl_loss: 2.3865 | pt_loss: 1.7446 | pg_loss: 0.8083 | reg_loss: 1.5783 | reward: -0.9601 | rev_kl: 0.9640 | stu_lens: 125.0000 | mixed_lens: 56.0000 | lr: 2.7960e-06 | scale: 1024.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    522/  1000| tot_loss: 3.8507 | rl_loss: 2.6278 | pt_loss: 1.2230 | pg_loss: 0.9578 | reg_loss: 1.6700 | reward: -1.0532 | rev_kl: 0.8504 | stu_lens: 24.5000 | mixed_lens: 55.0000 | lr: 2.7873e-06 | scale: 1024.00 | time: 26.209 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    523/  1000| tot_loss: 3.4932 | rl_loss: 1.6820 | pt_loss: 1.8112 | pg_loss: 0.5298 | reg_loss: 1.1522 | reward: -0.5748 | rev_kl: 1.4374 | stu_lens: 33.5000 | mixed_lens: 71.5000 | lr: 2.7787e-06 | scale: 1024.00 | time: 26.212 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    524/  1000| tot_loss: 2.8728 | rl_loss: 1.4096 | pt_loss: 1.4632 | pg_loss: 0.3448 | reg_loss: 1.0648 | reward: -0.4277 | rev_kl: 0.8446 | stu_lens: 127.5000 | mixed_lens: 83.5000 | lr: 2.7700e-06 | scale: 1024.00 | time: 26.190 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    525/  1000| tot_loss: 2.6688 | rl_loss: 1.2006 | pt_loss: 1.4682 | pg_loss: 0.4910 | reg_loss: 0.7096 | reward: 0.2967 | rev_kl: 1.7537 | stu_lens: 67.0000 | mixed_lens: 66.5000 | lr: 2.7613e-06 | scale: 1024.00 | time: 26.206 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    526/  1000| tot_loss: 3.0892 | rl_loss: 0.9579 | pt_loss: 2.1314 | pg_loss: 0.1601 | reg_loss: 0.7978 | reward: -0.4122 | rev_kl: 0.7525 | stu_lens: 96.0000 | mixed_lens: 107.5000 | lr: 2.7526e-06 | scale: 1024.00 | time: 26.204 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    527/  1000| tot_loss: 3.1217 | rl_loss: 1.7338 | pt_loss: 1.3879 | pg_loss: 0.4633 | reg_loss: 1.2706 | reward: -2.2093 | rev_kl: 1.7423 | stu_lens: 67.5000 | mixed_lens: 66.5000 | lr: 2.7440e-06 | scale: 1024.00 | time: 26.301 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    528/  1000| tot_loss: 3.9653 | rl_loss: 2.2981 | pt_loss: 1.6672 | pg_loss: 0.8066 | reg_loss: 1.4915 | reward: -0.6475 | rev_kl: 1.8028 | stu_lens: 56.0000 | mixed_lens: 60.0000 | lr: 2.7353e-06 | scale: 1024.00 | time: 26.230 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    528/  1000| tot_loss: 3.4178 | rl_loss: 1.7396 | pt_loss: 1.6782 | pg_loss: 0.5535 | reg_loss: 1.1861 | reward: -0.7195 | rev_kl: 1.1578 | stu_lens: 67.3438 | mixed_lens: 69.7031 | lr: 2.7353e-06 | scale: 1024.00 | time: 26.230 | step time: 27.490
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    529/  1000| tot_loss: 4.5246 | rl_loss: 2.7761 | pt_loss: 1.7486 | pg_loss: 1.9235 | reg_loss: 0.8525 | reward: -0.7728 | rev_kl: 1.2551 | stu_lens: 72.5000 | mixed_lens: 21.0000 | lr: 2.7266e-06 | scale: 1024.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    530/  1000| tot_loss: 3.3950 | rl_loss: 1.3221 | pt_loss: 2.0729 | pg_loss: 0.6333 | reg_loss: 0.6888 | reward: -0.6747 | rev_kl: 0.5986 | stu_lens: 37.0000 | mixed_lens: 57.5000 | lr: 2.7179e-06 | scale: 1024.00 | time: 26.203 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    531/  1000| tot_loss: 2.1446 | rl_loss: 0.4693 | pt_loss: 1.6753 | pg_loss: -0.0027 | reg_loss: 0.4720 | reward: -0.2829 | rev_kl: 0.8514 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 2.7092e-06 | scale: 1024.00 | time: 26.256 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    532/  1000| tot_loss: 2.9699 | rl_loss: 1.0138 | pt_loss: 1.9561 | pg_loss: 0.4841 | reg_loss: 0.5296 | reward: -0.3307 | rev_kl: 0.8151 | stu_lens: 63.5000 | mixed_lens: 80.0000 | lr: 2.7005e-06 | scale: 1024.00 | time: 26.190 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    533/  1000| tot_loss: 4.0269 | rl_loss: 1.9739 | pt_loss: 2.0529 | pg_loss: 1.1072 | reg_loss: 0.8668 | reward: -0.5703 | rev_kl: 1.8927 | stu_lens: 48.5000 | mixed_lens: 36.5000 | lr: 2.6918e-06 | scale: 1024.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    534/  1000| tot_loss: 2.7475 | rl_loss: 1.0506 | pt_loss: 1.6970 | pg_loss: 0.3230 | reg_loss: 0.7275 | reward: -0.5765 | rev_kl: 1.0222 | stu_lens: 92.5000 | mixed_lens: 75.5000 | lr: 2.6831e-06 | scale: 1024.00 | time: 26.174 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    535/  1000| tot_loss: 2.7458 | rl_loss: 0.8299 | pt_loss: 1.9160 | pg_loss: 0.1270 | reg_loss: 0.7029 | reward: -0.2528 | rev_kl: 1.3698 | stu_lens: 63.0000 | mixed_lens: 103.5000 | lr: 2.6744e-06 | scale: 1024.00 | time: 26.216 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    536/  1000| tot_loss: 2.7401 | rl_loss: 1.0016 | pt_loss: 1.7386 | pg_loss: 0.2702 | reg_loss: 0.7313 | reward: -0.7832 | rev_kl: 1.0342 | stu_lens: 124.5000 | mixed_lens: 85.5000 | lr: 2.6657e-06 | scale: 1024.00 | time: 26.191 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    537/  1000| tot_loss: 2.9437 | rl_loss: 1.0625 | pt_loss: 1.8811 | pg_loss: 0.2866 | reg_loss: 0.7759 | reward: -1.5313 | rev_kl: 1.3084 | stu_lens: 95.0000 | mixed_lens: 73.0000 | lr: 2.6570e-06 | scale: 1024.00 | time: 26.183 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    538/  1000| tot_loss: 3.7029 | rl_loss: 1.9467 | pt_loss: 1.7562 | pg_loss: 0.9849 | reg_loss: 0.9618 | reward: -1.1094 | rev_kl: 0.4769 | stu_lens: 14.0000 | mixed_lens: 52.5000 | lr: 2.6483e-06 | scale: 1024.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    539/  1000| tot_loss: 3.2145 | rl_loss: 1.2930 | pt_loss: 1.9215 | pg_loss: 0.4799 | reg_loss: 0.8131 | reward: -0.8463 | rev_kl: 1.3799 | stu_lens: 29.5000 | mixed_lens: 62.5000 | lr: 2.6396e-06 | scale: 1024.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    540/  1000| tot_loss: 2.9544 | rl_loss: 1.0350 | pt_loss: 1.9194 | pg_loss: 0.5016 | reg_loss: 0.5334 | reward: -0.6296 | rev_kl: 2.1828 | stu_lens: 65.5000 | mixed_lens: 67.0000 | lr: 2.6308e-06 | scale: 1024.00 | time: 26.177 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    541/  1000| tot_loss: 2.6880 | rl_loss: 0.8362 | pt_loss: 1.8517 | pg_loss: 0.2271 | reg_loss: 0.6091 | reward: -0.6066 | rev_kl: 0.9411 | stu_lens: 62.5000 | mixed_lens: 57.5000 | lr: 2.6221e-06 | scale: 1024.00 | time: 26.184 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    542/  1000| tot_loss: 3.8800 | rl_loss: 2.1003 | pt_loss: 1.7796 | pg_loss: 0.7871 | reg_loss: 1.3132 | reward: -1.0356 | rev_kl: 1.1747 | stu_lens: 55.5000 | mixed_lens: 46.0000 | lr: 2.6134e-06 | scale: 1024.00 | time: 26.172 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    543/  1000| tot_loss: 2.4407 | rl_loss: 0.6868 | pt_loss: 1.7539 | pg_loss: 0.0939 | reg_loss: 0.5929 | reward: -0.2848 | rev_kl: 0.9871 | stu_lens: 84.5000 | mixed_lens: 118.0000 | lr: 2.6047e-06 | scale: 1024.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    544/  1000| tot_loss: 3.1984 | rl_loss: 1.1594 | pt_loss: 2.0390 | pg_loss: 0.1508 | reg_loss: 1.0086 | reward: -0.2669 | rev_kl: 1.1774 | stu_lens: 63.5000 | mixed_lens: 99.0000 | lr: 2.5960e-06 | scale: 1024.00 | time: 26.193 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    544/  1000| tot_loss: 3.3201 | rl_loss: 1.4738 | pt_loss: 1.8463 | pg_loss: 0.6469 | reg_loss: 0.8269 | reward: -0.6645 | rev_kl: 1.1613 | stu_lens: 67.5000 | mixed_lens: 66.2656 | lr: 2.5960e-06 | scale: 1024.00 | time: 26.193 | step time: 27.478
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    545/  1000| tot_loss: 3.2742 | rl_loss: 1.5063 | pt_loss: 1.7679 | pg_loss: 0.4293 | reg_loss: 1.0770 | reward: -0.9770 | rev_kl: 0.8995 | stu_lens: 44.5000 | mixed_lens: 67.0000 | lr: 2.5872e-06 | scale: 1024.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    546/  1000| tot_loss: 2.3544 | rl_loss: 0.7372 | pt_loss: 1.6172 | pg_loss: 0.0044 | reg_loss: 0.7327 | reward: -0.1682 | rev_kl: 0.8491 | stu_lens: 90.0000 | mixed_lens: 128.0000 | lr: 2.5785e-06 | scale: 1024.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    547/  1000| tot_loss: 2.5332 | rl_loss: 1.0491 | pt_loss: 1.4841 | pg_loss: 0.5543 | reg_loss: 0.4948 | reward: -0.4946 | rev_kl: 0.5145 | stu_lens: 54.0000 | mixed_lens: 62.5000 | lr: 2.5698e-06 | scale: 1024.00 | time: 26.294 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    548/  1000| tot_loss: 2.5261 | rl_loss: 1.1593 | pt_loss: 1.3668 | pg_loss: 0.5714 | reg_loss: 0.5879 | reward: 0.3724 | rev_kl: 1.2147 | stu_lens: 28.5000 | mixed_lens: 59.0000 | lr: 2.5611e-06 | scale: 1024.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    549/  1000| tot_loss: 2.2539 | rl_loss: 0.7739 | pt_loss: 1.4801 | pg_loss: 0.4350 | reg_loss: 0.3388 | reward: -0.3441 | rev_kl: 1.2233 | stu_lens: 108.0000 | mixed_lens: 73.5000 | lr: 2.5524e-06 | scale: 1024.00 | time: 26.264 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    550/  1000| tot_loss: 2.7484 | rl_loss: 1.1866 | pt_loss: 1.5618 | pg_loss: 0.5337 | reg_loss: 0.6529 | reward: -0.9337 | rev_kl: 1.3071 | stu_lens: 56.0000 | mixed_lens: 68.0000 | lr: 2.5436e-06 | scale: 1024.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    551/  1000| tot_loss: 3.5189 | rl_loss: 1.8979 | pt_loss: 1.6210 | pg_loss: 1.1695 | reg_loss: 0.7284 | reward: -0.6200 | rev_kl: 0.9359 | stu_lens: 91.0000 | mixed_lens: 42.0000 | lr: 2.5349e-06 | scale: 1024.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    552/  1000| tot_loss: 2.8216 | rl_loss: 0.6133 | pt_loss: 2.2084 | pg_loss: 0.2367 | reg_loss: 0.3766 | reward: -0.3873 | rev_kl: 0.8873 | stu_lens: 85.0000 | mixed_lens: 101.0000 | lr: 2.5262e-06 | scale: 1024.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    553/  1000| tot_loss: 2.8643 | rl_loss: 1.0805 | pt_loss: 1.7838 | pg_loss: 0.4357 | reg_loss: 0.6448 | reward: -0.3358 | rev_kl: 0.6591 | stu_lens: 75.5000 | mixed_lens: 73.5000 | lr: 2.5175e-06 | scale: 1024.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    554/  1000| tot_loss: 3.5380 | rl_loss: 1.8336 | pt_loss: 1.7044 | pg_loss: 1.0554 | reg_loss: 0.7782 | reward: -2.6563 | rev_kl: 2.5312 | stu_lens: 41.5000 | mixed_lens: 27.0000 | lr: 2.5087e-06 | scale: 1024.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    555/  1000| tot_loss: 2.6779 | rl_loss: 0.6840 | pt_loss: 1.9940 | pg_loss: 0.1710 | reg_loss: 0.5130 | reward: -0.2278 | rev_kl: 1.1207 | stu_lens: 99.5000 | mixed_lens: 100.5000 | lr: 2.5000e-06 | scale: 1024.00 | time: 26.250 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    556/  1000| tot_loss: 2.7309 | rl_loss: 0.8489 | pt_loss: 1.8820 | pg_loss: 0.3887 | reg_loss: 0.4602 | reward: -0.3864 | rev_kl: 1.5247 | stu_lens: 33.0000 | mixed_lens: 79.5000 | lr: 2.4913e-06 | scale: 1024.00 | time: 26.286 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    557/  1000| tot_loss: 2.6195 | rl_loss: 0.8350 | pt_loss: 1.7845 | pg_loss: 0.3770 | reg_loss: 0.4580 | reward: -0.5912 | rev_kl: 1.4190 | stu_lens: 63.5000 | mixed_lens: 70.5000 | lr: 2.4825e-06 | scale: 1024.00 | time: 26.283 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    558/  1000| tot_loss: 5.0579 | rl_loss: 2.9243 | pt_loss: 2.1336 | pg_loss: 2.2932 | reg_loss: 0.6310 | reward: -1.4347 | rev_kl: 0.7509 | stu_lens: 17.5000 | mixed_lens: 14.0000 | lr: 2.4738e-06 | scale: 1024.00 | time: 26.262 | step time: 0.000
[2023-12-13 23:30:16,927] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 1024, reducing to 512
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    559/  1000| tot_loss: 2.6556 | rl_loss: 1.2286 | pt_loss: 1.4269 | pg_loss: 0.4199 | reg_loss: 0.8087 | reward: -0.9770 | rev_kl: 0.8995 | stu_lens: 44.5000 | mixed_lens: 67.0000 | lr: 2.4738e-06 | scale: 512.00 | time: 2.850 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    560/  1000| tot_loss: 3.6558 | rl_loss: 2.0195 | pt_loss: 1.6363 | pg_loss: 1.1176 | reg_loss: 0.9019 | reward: -0.8310 | rev_kl: 2.3122 | stu_lens: 53.0000 | mixed_lens: 36.0000 | lr: 2.4651e-06 | scale: 512.00 | time: 26.196 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    560/  1000| tot_loss: 3.0731 | rl_loss: 1.2945 | pt_loss: 1.7786 | pg_loss: 0.6141 | reg_loss: 0.6803 | reward: -0.6869 | rev_kl: 1.1500 | stu_lens: 63.6094 | mixed_lens: 67.2344 | lr: 2.4651e-06 | scale: 512.00 | time: 26.196 | step time: 26.048
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    561/  1000| tot_loss: 2.2547 | rl_loss: 0.6197 | pt_loss: 1.6350 | pg_loss: 0.1722 | reg_loss: 0.4475 | reward: -0.4354 | rev_kl: 1.1082 | stu_lens: 76.0000 | mixed_lens: 90.5000 | lr: 2.4564e-06 | scale: 512.00 | time: 26.205 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    562/  1000| tot_loss: 2.7074 | rl_loss: 0.9745 | pt_loss: 1.7329 | pg_loss: 0.6570 | reg_loss: 0.3174 | reward: -0.5942 | rev_kl: 1.5010 | stu_lens: 65.5000 | mixed_lens: 54.0000 | lr: 2.4476e-06 | scale: 512.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    563/  1000| tot_loss: 2.4875 | rl_loss: 0.6074 | pt_loss: 1.8801 | pg_loss: 0.1126 | reg_loss: 0.4947 | reward: -0.3172 | rev_kl: 0.9632 | stu_lens: 128.0000 | mixed_lens: 102.0000 | lr: 2.4389e-06 | scale: 512.00 | time: 26.191 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    564/  1000| tot_loss: 2.0900 | rl_loss: 0.7429 | pt_loss: 1.3471 | pg_loss: 0.3964 | reg_loss: 0.3465 | reward: -0.5321 | rev_kl: 0.9280 | stu_lens: 128.0000 | mixed_lens: 83.5000 | lr: 2.4302e-06 | scale: 512.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    565/  1000| tot_loss: 1.9367 | rl_loss: 0.4619 | pt_loss: 1.4748 | pg_loss: 0.0467 | reg_loss: 0.4152 | reward: -0.2890 | rev_kl: 1.7980 | stu_lens: 82.5000 | mixed_lens: 116.0000 | lr: 2.4215e-06 | scale: 512.00 | time: 26.191 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    566/  1000| tot_loss: 2.6083 | rl_loss: 0.9756 | pt_loss: 1.6327 | pg_loss: 0.4595 | reg_loss: 0.5161 | reward: -0.3544 | rev_kl: 0.8936 | stu_lens: 72.5000 | mixed_lens: 76.5000 | lr: 2.4128e-06 | scale: 512.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    567/  1000| tot_loss: 3.5460 | rl_loss: 1.9340 | pt_loss: 1.6120 | pg_loss: 1.3691 | reg_loss: 0.5649 | reward: -1.1696 | rev_kl: 1.7316 | stu_lens: 27.0000 | mixed_lens: 22.5000 | lr: 2.4040e-06 | scale: 512.00 | time: 26.252 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    568/  1000| tot_loss: 2.8462 | rl_loss: 1.0700 | pt_loss: 1.7762 | pg_loss: 0.4965 | reg_loss: 0.5735 | reward: -0.8875 | rev_kl: 1.7328 | stu_lens: 17.5000 | mixed_lens: 64.0000 | lr: 2.3953e-06 | scale: 512.00 | time: 26.267 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    569/  1000| tot_loss: 2.5205 | rl_loss: 0.7050 | pt_loss: 1.8155 | pg_loss: 0.2423 | reg_loss: 0.4627 | reward: -0.5793 | rev_kl: 1.5857 | stu_lens: 108.0000 | mixed_lens: 81.5000 | lr: 2.3866e-06 | scale: 512.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    570/  1000| tot_loss: 2.4974 | rl_loss: 0.9586 | pt_loss: 1.5388 | pg_loss: 0.5760 | reg_loss: 0.3826 | reward: -0.9446 | rev_kl: 0.9135 | stu_lens: 83.0000 | mixed_lens: 63.0000 | lr: 2.3779e-06 | scale: 512.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    571/  1000| tot_loss: 2.7270 | rl_loss: 1.0886 | pt_loss: 1.6384 | pg_loss: 0.3524 | reg_loss: 0.7362 | reward: -0.4855 | rev_kl: 0.7770 | stu_lens: 49.0000 | mixed_lens: 72.5000 | lr: 2.3692e-06 | scale: 512.00 | time: 26.200 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    572/  1000| tot_loss: 2.9466 | rl_loss: 0.7128 | pt_loss: 2.2338 | pg_loss: 0.3045 | reg_loss: 0.4084 | reward: -0.2844 | rev_kl: 1.2374 | stu_lens: 94.0000 | mixed_lens: 94.5000 | lr: 2.3604e-06 | scale: 512.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    573/  1000| tot_loss: 2.1905 | rl_loss: 0.4647 | pt_loss: 1.7258 | pg_loss: 0.2453 | reg_loss: 0.2194 | reward: 0.3550 | rev_kl: 1.6268 | stu_lens: 31.5000 | mixed_lens: 55.0000 | lr: 2.3517e-06 | scale: 512.00 | time: 26.199 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    574/  1000| tot_loss: 2.7322 | rl_loss: 1.0308 | pt_loss: 1.7014 | pg_loss: 0.5071 | reg_loss: 0.5237 | reward: -0.4215 | rev_kl: 1.4576 | stu_lens: 68.5000 | mixed_lens: 79.0000 | lr: 2.3430e-06 | scale: 512.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    575/  1000| tot_loss: 4.8803 | rl_loss: 3.2755 | pt_loss: 1.6049 | pg_loss: 2.8440 | reg_loss: 0.4315 | reward: -1.5105 | rev_kl: 0.7584 | stu_lens: 20.0000 | mixed_lens: 8.5000 | lr: 2.3343e-06 | scale: 512.00 | time: 26.195 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    576/  1000| tot_loss: 2.1144 | rl_loss: 0.5653 | pt_loss: 1.5491 | pg_loss: 0.2887 | reg_loss: 0.2766 | reward: -0.2902 | rev_kl: 0.8479 | stu_lens: 54.5000 | mixed_lens: 86.5000 | lr: 2.3256e-06 | scale: 512.00 | time: 26.223 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    576/  1000| tot_loss: 2.7892 | rl_loss: 1.1378 | pt_loss: 1.6514 | pg_loss: 0.6195 | reg_loss: 0.5183 | reward: -0.6423 | rev_kl: 1.1450 | stu_lens: 68.4219 | mixed_lens: 70.5469 | lr: 2.3256e-06 | scale: 512.00 | time: 26.223 | step time: 27.487
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    577/  1000| tot_loss: 4.0267 | rl_loss: 2.0809 | pt_loss: 1.9458 | pg_loss: 1.7025 | reg_loss: 0.3784 | reward: -1.2359 | rev_kl: 0.9281 | stu_lens: 37.0000 | mixed_lens: 22.5000 | lr: 2.3169e-06 | scale: 512.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    578/  1000| tot_loss: 3.0531 | rl_loss: 1.4658 | pt_loss: 1.5873 | pg_loss: 0.3037 | reg_loss: 1.1621 | reward: -0.1998 | rev_kl: 0.9973 | stu_lens: 90.0000 | mixed_lens: 94.5000 | lr: 2.3082e-06 | scale: 512.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    579/  1000| tot_loss: 3.6635 | rl_loss: 1.8574 | pt_loss: 1.8061 | pg_loss: 0.5921 | reg_loss: 1.2654 | reward: -0.4532 | rev_kl: 1.5326 | stu_lens: 128.0000 | mixed_lens: 70.0000 | lr: 2.2995e-06 | scale: 512.00 | time: 26.188 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    580/  1000| tot_loss: 2.7120 | rl_loss: 0.5032 | pt_loss: 2.2088 | pg_loss: -0.1850 | reg_loss: 0.6882 | reward: -0.4086 | rev_kl: 1.6817 | stu_lens: 89.0000 | mixed_lens: 33.5000 | lr: 2.2908e-06 | scale: 512.00 | time: 26.189 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    581/  1000| tot_loss: 2.6783 | rl_loss: 1.3849 | pt_loss: 1.2934 | pg_loss: 0.3791 | reg_loss: 1.0058 | reward: -0.2602 | rev_kl: 1.0460 | stu_lens: 81.5000 | mixed_lens: 88.0000 | lr: 2.2821e-06 | scale: 512.00 | time: 26.202 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    582/  1000| tot_loss: 3.2900 | rl_loss: 1.5898 | pt_loss: 1.7002 | pg_loss: 0.5631 | reg_loss: 1.0267 | reward: -0.5415 | rev_kl: 0.7009 | stu_lens: 53.5000 | mixed_lens: 65.0000 | lr: 2.2734e-06 | scale: 512.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    583/  1000| tot_loss: 3.7068 | rl_loss: 1.7036 | pt_loss: 2.0032 | pg_loss: 0.1181 | reg_loss: 1.5855 | reward: -0.2593 | rev_kl: 1.3871 | stu_lens: 105.5000 | mixed_lens: 117.0000 | lr: 2.2647e-06 | scale: 512.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    584/  1000| tot_loss: 5.0599 | rl_loss: 3.1674 | pt_loss: 1.8925 | pg_loss: 1.7604 | reg_loss: 1.4070 | reward: -1.4566 | rev_kl: 2.0622 | stu_lens: 14.0000 | mixed_lens: 19.5000 | lr: 2.2560e-06 | scale: 512.00 | time: 26.216 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    585/  1000| tot_loss: 2.3741 | rl_loss: 1.2657 | pt_loss: 1.1084 | pg_loss: 0.1336 | reg_loss: 1.1321 | reward: -0.0798 | rev_kl: 0.9681 | stu_lens: 94.5000 | mixed_lens: 103.5000 | lr: 2.2474e-06 | scale: 512.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    586/  1000| tot_loss: 2.2622 | rl_loss: 0.9195 | pt_loss: 1.3427 | pg_loss: 0.1739 | reg_loss: 0.7456 | reward: -0.2866 | rev_kl: 0.7668 | stu_lens: 128.0000 | mixed_lens: 107.0000 | lr: 2.2387e-06 | scale: 512.00 | time: 26.196 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    587/  1000| tot_loss: 3.0307 | rl_loss: 1.5738 | pt_loss: 1.4569 | pg_loss: 0.2856 | reg_loss: 1.2882 | reward: -0.3596 | rev_kl: 1.0908 | stu_lens: 76.5000 | mixed_lens: 105.0000 | lr: 2.2300e-06 | scale: 512.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    588/  1000| tot_loss: 2.4555 | rl_loss: 0.7766 | pt_loss: 1.6788 | pg_loss: 0.0916 | reg_loss: 0.6850 | reward: -0.1980 | rev_kl: 0.5535 | stu_lens: 128.0000 | mixed_lens: 114.0000 | lr: 2.2213e-06 | scale: 512.00 | time: 26.196 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    589/  1000| tot_loss: 2.8175 | rl_loss: 1.0873 | pt_loss: 1.7302 | pg_loss: 0.2160 | reg_loss: 0.8712 | reward: -0.4822 | rev_kl: 0.4751 | stu_lens: 86.0000 | mixed_lens: 104.5000 | lr: 2.2127e-06 | scale: 512.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    590/  1000| tot_loss: 2.3391 | rl_loss: 0.1066 | pt_loss: 2.2325 | pg_loss: -0.8634 | reg_loss: 0.9699 | reward: 0.5898 | rev_kl: 1.7686 | stu_lens: 12.5000 | mixed_lens: 7.0000 | lr: 2.2040e-06 | scale: 512.00 | time: 26.194 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    591/  1000| tot_loss: 3.5576 | rl_loss: 1.7806 | pt_loss: 1.7770 | pg_loss: 0.3609 | reg_loss: 1.4197 | reward: -0.3368 | rev_kl: 1.3987 | stu_lens: 91.5000 | mixed_lens: 90.5000 | lr: 2.1953e-06 | scale: 512.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    592/  1000| tot_loss: 2.1263 | rl_loss: 0.8491 | pt_loss: 1.2773 | pg_loss: 0.0401 | reg_loss: 0.8089 | reward: -0.1535 | rev_kl: 1.1866 | stu_lens: 107.5000 | mixed_lens: 128.0000 | lr: 2.1867e-06 | scale: 512.00 | time: 26.263 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    592/  1000| tot_loss: 3.1158 | rl_loss: 1.4175 | pt_loss: 1.6983 | pg_loss: 0.3532 | reg_loss: 1.0643 | reward: -0.4503 | rev_kl: 1.1538 | stu_lens: 86.8438 | mixed_lens: 83.8750 | lr: 2.1867e-06 | scale: 512.00 | time: 26.263 | step time: 27.495
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    593/  1000| tot_loss: 3.5107 | rl_loss: 1.5533 | pt_loss: 1.9573 | pg_loss: 0.3129 | reg_loss: 1.2404 | reward: -1.0999 | rev_kl: 1.2416 | stu_lens: 46.5000 | mixed_lens: 72.0000 | lr: 2.1780e-06 | scale: 512.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    594/  1000| tot_loss: 3.0524 | rl_loss: 1.2227 | pt_loss: 1.8297 | pg_loss: 0.1826 | reg_loss: 1.0401 | reward: -0.1389 | rev_kl: 1.6004 | stu_lens: 105.0000 | mixed_lens: 59.5000 | lr: 2.1694e-06 | scale: 512.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    595/  1000| tot_loss: 2.0025 | rl_loss: 0.9181 | pt_loss: 1.0844 | pg_loss: 0.1445 | reg_loss: 0.7736 | reward: -0.0923 | rev_kl: 0.9077 | stu_lens: 94.5000 | mixed_lens: 104.5000 | lr: 2.1607e-06 | scale: 512.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    596/  1000| tot_loss: 2.9732 | rl_loss: 0.9799 | pt_loss: 1.9933 | pg_loss: 0.2536 | reg_loss: 0.7262 | reward: -0.4153 | rev_kl: 0.9142 | stu_lens: 121.0000 | mixed_lens: 93.5000 | lr: 2.1521e-06 | scale: 512.00 | time: 26.198 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    597/  1000| tot_loss: 2.5701 | rl_loss: 0.4548 | pt_loss: 2.1153 | pg_loss: 0.0548 | reg_loss: 0.4000 | reward: -0.2660 | rev_kl: 0.4898 | stu_lens: 69.5000 | mixed_lens: 98.5000 | lr: 2.1434e-06 | scale: 512.00 | time: 26.212 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    598/  1000| tot_loss: 2.4778 | rl_loss: 1.2548 | pt_loss: 1.2230 | pg_loss: 0.5349 | reg_loss: 0.7200 | reward: -0.4064 | rev_kl: 1.2765 | stu_lens: 90.0000 | mixed_lens: 48.0000 | lr: 2.1348e-06 | scale: 512.00 | time: 26.186 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    599/  1000| tot_loss: 2.5529 | rl_loss: 0.8998 | pt_loss: 1.6531 | pg_loss: 0.0070 | reg_loss: 0.8928 | reward: -0.5174 | rev_kl: 1.8174 | stu_lens: 45.5000 | mixed_lens: 128.0000 | lr: 2.1262e-06 | scale: 512.00 | time: 26.214 | step time: 0.000
                                 Evaluation #6                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Convert the above time to Pacific     │ Convert the above time to Pacific    │
│ Standard Time.                        │ Standard Time.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 10:30 AM                             │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 1970-01-01T00:00:00Z                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 2022-03-29 00:00:00                  │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 14.915 | exact_match: 0.103 | rev_kl: 1.164 | lens: 77.997 | pt_loss: 1.089 | lm_loss: 1.182 | kd_loss: 0.996 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    600/  1000| tot_loss: 1.9440 | rl_loss: 0.3284 | pt_loss: 1.6156 | pg_loss: -0.0127 | reg_loss: 0.3410 | reward: -0.0901 | rev_kl: 0.6944 | stu_lens: 89.0000 | mixed_lens: 80.0000 | lr: 2.1175e-06 | scale: 512.00 | time: 26.198 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    601/  1000| tot_loss: 3.5464 | rl_loss: 1.7853 | pt_loss: 1.7611 | pg_loss: 0.5541 | reg_loss: 1.2312 | reward: -1.1453 | rev_kl: 1.3204 | stu_lens: 74.5000 | mixed_lens: 72.0000 | lr: 2.1089e-06 | scale: 512.00 | time: 26.211 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    602/  1000| tot_loss: 1.8065 | rl_loss: 0.0809 | pt_loss: 1.7256 | pg_loss: -0.0389 | reg_loss: 0.1198 | reward: 0.0900 | rev_kl: 0.1846 | stu_lens: 96.5000 | mixed_lens: 66.5000 | lr: 2.1003e-06 | scale: 512.00 | time: 26.168 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    603/  1000| tot_loss: 2.5078 | rl_loss: 0.7703 | pt_loss: 1.7375 | pg_loss: 0.0825 | reg_loss: 0.6878 | reward: -0.1108 | rev_kl: 0.6557 | stu_lens: 89.5000 | mixed_lens: 112.0000 | lr: 2.0917e-06 | scale: 512.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    604/  1000| tot_loss: 2.3464 | rl_loss: 0.8862 | pt_loss: 1.4602 | pg_loss: 0.1003 | reg_loss: 0.7859 | reward: -0.4020 | rev_kl: 0.6557 | stu_lens: 76.5000 | mixed_lens: 117.5000 | lr: 2.0831e-06 | scale: 512.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    605/  1000| tot_loss: 2.7205 | rl_loss: 1.2756 | pt_loss: 1.4449 | pg_loss: 0.2115 | reg_loss: 1.0641 | reward: -0.6966 | rev_kl: 1.3641 | stu_lens: 35.5000 | mixed_lens: 96.5000 | lr: 2.0745e-06 | scale: 512.00 | time: 26.194 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    606/  1000| tot_loss: 2.2997 | rl_loss: 0.8306 | pt_loss: 1.4691 | pg_loss: 0.3075 | reg_loss: 0.5231 | reward: -0.9466 | rev_kl: 1.2687 | stu_lens: 75.0000 | mixed_lens: 73.5000 | lr: 2.0659e-06 | scale: 512.00 | time: 26.203 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    607/  1000| tot_loss: 3.7288 | rl_loss: 1.9395 | pt_loss: 1.7893 | pg_loss: 0.9152 | reg_loss: 1.0243 | reward: -1.1046 | rev_kl: 0.6870 | stu_lens: 30.0000 | mixed_lens: 48.5000 | lr: 2.0573e-06 | scale: 512.00 | time: 26.212 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    608/  1000| tot_loss: 2.4912 | rl_loss: 1.1167 | pt_loss: 1.3745 | pg_loss: 0.2914 | reg_loss: 0.8252 | reward: -0.2084 | rev_kl: 1.3729 | stu_lens: 87.5000 | mixed_lens: 87.0000 | lr: 2.0487e-06 | scale: 512.00 | time: 26.164 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    608/  1000| tot_loss: 2.7709 | rl_loss: 1.0748 | pt_loss: 1.6961 | pg_loss: 0.2850 | reg_loss: 0.7897 | reward: -0.4611 | rev_kl: 1.1351 | stu_lens: 82.9375 | mixed_lens: 84.8438 | lr: 2.0487e-06 | scale: 512.00 | time: 26.164 | step time: 27.479
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    609/  1000| tot_loss: 2.8608 | rl_loss: 1.1481 | pt_loss: 1.7128 | pg_loss: 0.1152 | reg_loss: 1.0329 | reward: -0.2345 | rev_kl: 1.4618 | stu_lens: 105.5000 | mixed_lens: 117.0000 | lr: 2.0401e-06 | scale: 512.00 | time: 26.177 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    610/  1000| tot_loss: 2.4087 | rl_loss: 0.5669 | pt_loss: 1.8418 | pg_loss: 0.2221 | reg_loss: 0.3448 | reward: -0.3216 | rev_kl: 0.7948 | stu_lens: 98.0000 | mixed_lens: 64.5000 | lr: 2.0315e-06 | scale: 512.00 | time: 26.176 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    611/  1000| tot_loss: 2.1314 | rl_loss: 0.4753 | pt_loss: 1.6561 | pg_loss: 0.0079 | reg_loss: 0.4674 | reward: -0.1183 | rev_kl: 1.1607 | stu_lens: 94.0000 | mixed_lens: 121.0000 | lr: 2.0230e-06 | scale: 512.00 | time: 26.191 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    612/  1000| tot_loss: 2.9863 | rl_loss: 1.1991 | pt_loss: 1.7873 | pg_loss: 0.2611 | reg_loss: 0.9380 | reward: -0.6913 | rev_kl: 1.3589 | stu_lens: 85.0000 | mixed_lens: 96.5000 | lr: 2.0144e-06 | scale: 512.00 | time: 26.186 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    613/  1000| tot_loss: 2.2755 | rl_loss: 0.4840 | pt_loss: 1.7914 | pg_loss: 0.0170 | reg_loss: 0.4671 | reward: -0.0576 | rev_kl: 0.9065 | stu_lens: 91.5000 | mixed_lens: 125.5000 | lr: 2.0059e-06 | scale: 512.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    614/  1000| tot_loss: 2.7850 | rl_loss: 1.3250 | pt_loss: 1.4600 | pg_loss: 0.6212 | reg_loss: 0.7038 | reward: -1.0940 | rev_kl: 1.9710 | stu_lens: 75.0000 | mixed_lens: 65.0000 | lr: 1.9973e-06 | scale: 512.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    615/  1000| tot_loss: 2.8034 | rl_loss: 1.3518 | pt_loss: 1.4516 | pg_loss: 0.8591 | reg_loss: 0.4927 | reward: -0.1586 | rev_kl: 1.1731 | stu_lens: 33.0000 | mixed_lens: 33.5000 | lr: 1.9888e-06 | scale: 512.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    616/  1000| tot_loss: 2.3219 | rl_loss: 0.8377 | pt_loss: 1.4841 | pg_loss: 0.1398 | reg_loss: 0.6980 | reward: -0.5604 | rev_kl: 0.9275 | stu_lens: 26.0000 | mixed_lens: 105.0000 | lr: 1.9802e-06 | scale: 512.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    617/  1000| tot_loss: 2.1394 | rl_loss: 0.4475 | pt_loss: 1.6918 | pg_loss: -0.0001 | reg_loss: 0.4476 | reward: -0.1575 | rev_kl: 0.8128 | stu_lens: 108.5000 | mixed_lens: 128.0000 | lr: 1.9717e-06 | scale: 512.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    618/  1000| tot_loss: 2.8816 | rl_loss: 0.6389 | pt_loss: 2.2428 | pg_loss: 0.1289 | reg_loss: 0.5099 | reward: -0.2180 | rev_kl: 0.8521 | stu_lens: 105.5000 | mixed_lens: 117.0000 | lr: 1.9632e-06 | scale: 512.00 | time: 26.188 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    619/  1000| tot_loss: 3.5179 | rl_loss: 1.8630 | pt_loss: 1.6550 | pg_loss: 1.0722 | reg_loss: 0.7907 | reward: -2.0963 | rev_kl: 1.3079 | stu_lens: 88.5000 | mixed_lens: 40.0000 | lr: 1.9546e-06 | scale: 512.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    620/  1000| tot_loss: 1.8349 | rl_loss: -0.1340 | pt_loss: 1.9689 | pg_loss: -0.2942 | reg_loss: 0.1601 | reward: 0.1044 | rev_kl: 0.7542 | stu_lens: 89.0000 | mixed_lens: 50.0000 | lr: 1.9461e-06 | scale: 512.00 | time: 26.179 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    621/  1000| tot_loss: 3.0920 | rl_loss: 1.0554 | pt_loss: 2.0366 | pg_loss: 0.4537 | reg_loss: 0.6017 | reward: -0.8317 | rev_kl: 1.4388 | stu_lens: 73.5000 | mixed_lens: 60.0000 | lr: 1.9376e-06 | scale: 512.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    622/  1000| tot_loss: 2.0827 | rl_loss: 0.9820 | pt_loss: 1.1007 | pg_loss: 0.0952 | reg_loss: 0.8868 | reward: -0.2816 | rev_kl: 1.3430 | stu_lens: 128.0000 | mixed_lens: 114.0000 | lr: 1.9291e-06 | scale: 512.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    623/  1000| tot_loss: 2.2476 | rl_loss: 0.5032 | pt_loss: 1.7445 | pg_loss: 0.1226 | reg_loss: 0.3805 | reward: -0.2559 | rev_kl: 0.6796 | stu_lens: 99.5000 | mixed_lens: 73.5000 | lr: 1.9206e-06 | scale: 512.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    624/  1000| tot_loss: 2.7958 | rl_loss: 0.7684 | pt_loss: 2.0274 | pg_loss: 0.2059 | reg_loss: 0.5625 | reward: -0.5464 | rev_kl: 0.9515 | stu_lens: 56.0000 | mixed_lens: 104.5000 | lr: 1.9121e-06 | scale: 512.00 | time: 26.223 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    624/  1000| tot_loss: 2.5012 | rl_loss: 0.8313 | pt_loss: 1.6698 | pg_loss: 0.2730 | reg_loss: 0.5583 | reward: -0.4247 | rev_kl: 1.1463 | stu_lens: 85.4062 | mixed_lens: 85.7188 | lr: 1.9121e-06 | scale: 512.00 | time: 26.223 | step time: 27.477
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    625/  1000| tot_loss: 2.4002 | rl_loss: 0.7252 | pt_loss: 1.6749 | pg_loss: 0.4091 | reg_loss: 0.3162 | reward: -0.3395 | rev_kl: 1.1113 | stu_lens: 87.5000 | mixed_lens: 66.0000 | lr: 1.9037e-06 | scale: 512.00 | time: 26.228 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    626/  1000| tot_loss: 2.3893 | rl_loss: 0.5800 | pt_loss: 1.8093 | pg_loss: 0.1993 | reg_loss: 0.3807 | reward: -0.4066 | rev_kl: 1.2324 | stu_lens: 128.0000 | mixed_lens: 94.0000 | lr: 1.8952e-06 | scale: 512.00 | time: 26.173 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    627/  1000| tot_loss: 2.1718 | rl_loss: 0.6033 | pt_loss: 1.5685 | pg_loss: 0.3453 | reg_loss: 0.2580 | reward: -0.7959 | rev_kl: 0.7051 | stu_lens: 62.5000 | mixed_lens: 64.5000 | lr: 1.8867e-06 | scale: 512.00 | time: 26.195 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    628/  1000| tot_loss: 3.5362 | rl_loss: 1.8044 | pt_loss: 1.7318 | pg_loss: 1.4958 | reg_loss: 0.3086 | reward: -0.9404 | rev_kl: 1.5972 | stu_lens: 28.0000 | mixed_lens: 21.0000 | lr: 1.8783e-06 | scale: 512.00 | time: 26.167 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    629/  1000| tot_loss: 2.4341 | rl_loss: 0.5745 | pt_loss: 1.8596 | pg_loss: 0.0153 | reg_loss: 0.5592 | reward: -0.2628 | rev_kl: 1.2249 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.8698e-06 | scale: 512.00 | time: 26.189 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    630/  1000| tot_loss: 2.6787 | rl_loss: 0.6765 | pt_loss: 2.0022 | pg_loss: 0.1750 | reg_loss: 0.5015 | reward: -0.5081 | rev_kl: 1.0073 | stu_lens: 128.0000 | mixed_lens: 105.5000 | lr: 1.8614e-06 | scale: 512.00 | time: 26.162 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    631/  1000| tot_loss: 2.4487 | rl_loss: 0.5849 | pt_loss: 1.8638 | pg_loss: 0.1163 | reg_loss: 0.4685 | reward: -0.1097 | rev_kl: 1.4932 | stu_lens: 77.0000 | mixed_lens: 71.0000 | lr: 1.8530e-06 | scale: 512.00 | time: 26.195 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    632/  1000| tot_loss: 1.6561 | rl_loss: 0.3242 | pt_loss: 1.3319 | pg_loss: 0.0065 | reg_loss: 0.3177 | reward: -0.0650 | rev_kl: 0.8478 | stu_lens: 78.5000 | mixed_lens: 98.0000 | lr: 1.8445e-06 | scale: 512.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    633/  1000| tot_loss: 2.8630 | rl_loss: 0.9026 | pt_loss: 1.9604 | pg_loss: 0.2521 | reg_loss: 0.6504 | reward: -0.2186 | rev_kl: 1.1153 | stu_lens: 90.0000 | mixed_lens: 80.5000 | lr: 1.8361e-06 | scale: 512.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    634/  1000| tot_loss: 2.4302 | rl_loss: 0.5472 | pt_loss: 1.8830 | pg_loss: 0.0785 | reg_loss: 0.4687 | reward: -0.4337 | rev_kl: 0.9634 | stu_lens: 105.5000 | mixed_lens: 104.5000 | lr: 1.8277e-06 | scale: 512.00 | time: 26.216 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    635/  1000| tot_loss: 2.3352 | rl_loss: 0.8626 | pt_loss: 1.4726 | pg_loss: 0.4262 | reg_loss: 0.4364 | reward: -0.7836 | rev_kl: 1.7473 | stu_lens: 53.0000 | mixed_lens: 74.0000 | lr: 1.8193e-06 | scale: 512.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    636/  1000| tot_loss: 1.8839 | rl_loss: 0.4993 | pt_loss: 1.3846 | pg_loss: 0.2920 | reg_loss: 0.2073 | reward: -0.0759 | rev_kl: 0.4855 | stu_lens: 62.5000 | mixed_lens: 89.5000 | lr: 1.8109e-06 | scale: 512.00 | time: 26.179 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    637/  1000| tot_loss: 3.1439 | rl_loss: 1.1810 | pt_loss: 1.9629 | pg_loss: 0.7210 | reg_loss: 0.4600 | reward: -0.3441 | rev_kl: 1.3690 | stu_lens: 87.5000 | mixed_lens: 52.0000 | lr: 1.8025e-06 | scale: 512.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    638/  1000| tot_loss: 2.6735 | rl_loss: 0.9379 | pt_loss: 1.7355 | pg_loss: 0.3496 | reg_loss: 0.5883 | reward: -0.5728 | rev_kl: 1.7701 | stu_lens: 128.0000 | mixed_lens: 81.5000 | lr: 1.7941e-06 | scale: 512.00 | time: 26.197 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    639/  1000| tot_loss: 2.8984 | rl_loss: 1.2669 | pt_loss: 1.6315 | pg_loss: 0.8003 | reg_loss: 0.4666 | reward: -2.0873 | rev_kl: 1.6372 | stu_lens: 128.0000 | mixed_lens: 21.5000 | lr: 1.7858e-06 | scale: 512.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    640/  1000| tot_loss: 2.5479 | rl_loss: 0.6108 | pt_loss: 1.9371 | pg_loss: 0.4410 | reg_loss: 0.1698 | reward: -0.2273 | rev_kl: 1.1035 | stu_lens: 71.0000 | mixed_lens: 46.0000 | lr: 1.7774e-06 | scale: 512.00 | time: 26.198 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    640/  1000| tot_loss: 2.3892 | rl_loss: 0.7002 | pt_loss: 1.6889 | pg_loss: 0.2848 | reg_loss: 0.4154 | reward: -0.4065 | rev_kl: 1.1464 | stu_lens: 86.1250 | mixed_lens: 86.5781 | lr: 1.7774e-06 | scale: 512.00 | time: 26.198 | step time: 27.468
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    641/  1000| tot_loss: 2.7721 | rl_loss: 1.0328 | pt_loss: 1.7393 | pg_loss: 0.4417 | reg_loss: 0.5910 | reward: -1.0513 | rev_kl: 1.2813 | stu_lens: 74.5000 | mixed_lens: 59.0000 | lr: 1.7691e-06 | scale: 512.00 | time: 26.280 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    642/  1000| tot_loss: 3.3010 | rl_loss: 1.8619 | pt_loss: 1.4390 | pg_loss: 0.3524 | reg_loss: 1.5095 | reward: -0.3822 | rev_kl: 1.1342 | stu_lens: 111.0000 | mixed_lens: 81.0000 | lr: 1.7607e-06 | scale: 512.00 | time: 26.244 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    643/  1000| tot_loss: 3.4507 | rl_loss: 1.4384 | pt_loss: 2.0123 | pg_loss: 0.3175 | reg_loss: 1.1209 | reward: -0.1239 | rev_kl: 1.0602 | stu_lens: 97.5000 | mixed_lens: 84.0000 | lr: 1.7524e-06 | scale: 512.00 | time: 26.204 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    644/  1000| tot_loss: 3.4547 | rl_loss: 2.1089 | pt_loss: 1.3459 | pg_loss: 0.6141 | reg_loss: 1.4948 | reward: -0.4706 | rev_kl: 1.2807 | stu_lens: 39.0000 | mixed_lens: 60.5000 | lr: 1.7441e-06 | scale: 512.00 | time: 26.201 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    645/  1000| tot_loss: 2.8826 | rl_loss: 1.0917 | pt_loss: 1.7908 | pg_loss: 0.2659 | reg_loss: 0.8258 | reward: -0.3714 | rev_kl: 1.1583 | stu_lens: 101.0000 | mixed_lens: 94.0000 | lr: 1.7358e-06 | scale: 512.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    646/  1000| tot_loss: 3.6635 | rl_loss: 2.0619 | pt_loss: 1.6016 | pg_loss: 0.6009 | reg_loss: 1.4611 | reward: -0.5902 | rev_kl: 1.1537 | stu_lens: 52.0000 | mixed_lens: 64.5000 | lr: 1.7275e-06 | scale: 512.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    647/  1000| tot_loss: 3.1481 | rl_loss: 1.5407 | pt_loss: 1.6074 | pg_loss: 0.3431 | reg_loss: 1.1976 | reward: -0.4091 | rev_kl: 1.3904 | stu_lens: 86.5000 | mixed_lens: 89.0000 | lr: 1.7192e-06 | scale: 512.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    648/  1000| tot_loss: 3.4929 | rl_loss: 1.4899 | pt_loss: 2.0031 | pg_loss: 0.2030 | reg_loss: 1.2868 | reward: -0.2099 | rev_kl: 1.2523 | stu_lens: 128.0000 | mixed_lens: 96.0000 | lr: 1.7109e-06 | scale: 512.00 | time: 26.265 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    649/  1000| tot_loss: 4.1282 | rl_loss: 2.1071 | pt_loss: 2.0211 | pg_loss: 0.6256 | reg_loss: 1.4815 | reward: -1.2612 | rev_kl: 0.5633 | stu_lens: 59.5000 | mixed_lens: 62.0000 | lr: 1.7026e-06 | scale: 512.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    650/  1000| tot_loss: 3.4702 | rl_loss: 1.7222 | pt_loss: 1.7479 | pg_loss: 0.3502 | reg_loss: 1.3720 | reward: -0.3611 | rev_kl: 0.4833 | stu_lens: 81.0000 | mixed_lens: 73.5000 | lr: 1.6943e-06 | scale: 512.00 | time: 26.200 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    651/  1000| tot_loss: 4.4337 | rl_loss: 2.4994 | pt_loss: 1.9343 | pg_loss: 0.9476 | reg_loss: 1.5518 | reward: -1.3510 | rev_kl: 1.2117 | stu_lens: 47.5000 | mixed_lens: 38.0000 | lr: 1.6861e-06 | scale: 512.00 | time: 26.205 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    652/  1000| tot_loss: 3.5560 | rl_loss: 1.7929 | pt_loss: 1.7631 | pg_loss: 0.5943 | reg_loss: 1.1986 | reward: -0.3401 | rev_kl: 1.1234 | stu_lens: 89.5000 | mixed_lens: 71.0000 | lr: 1.6778e-06 | scale: 512.00 | time: 26.186 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    653/  1000| tot_loss: 2.9211 | rl_loss: 1.1679 | pt_loss: 1.7532 | pg_loss: 0.3712 | reg_loss: 0.7967 | reward: -0.1806 | rev_kl: 0.9202 | stu_lens: 75.0000 | mixed_lens: 80.5000 | lr: 1.6696e-06 | scale: 512.00 | time: 26.206 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    654/  1000| tot_loss: 2.9746 | rl_loss: 1.3062 | pt_loss: 1.6684 | pg_loss: 0.1298 | reg_loss: 1.1764 | reward: -0.2775 | rev_kl: 1.5263 | stu_lens: 73.0000 | mixed_lens: 110.0000 | lr: 1.6614e-06 | scale: 512.00 | time: 26.185 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    655/  1000| tot_loss: 3.4895 | rl_loss: 1.8006 | pt_loss: 1.6889 | pg_loss: 0.7735 | reg_loss: 1.0271 | reward: -0.5617 | rev_kl: 1.0291 | stu_lens: 95.0000 | mixed_lens: 61.0000 | lr: 1.6532e-06 | scale: 512.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    656/  1000| tot_loss: 2.6154 | rl_loss: 0.8450 | pt_loss: 1.7704 | pg_loss: 0.2548 | reg_loss: 0.5902 | reward: -0.5466 | rev_kl: 1.1804 | stu_lens: 32.0000 | mixed_lens: 65.0000 | lr: 1.6449e-06 | scale: 512.00 | time: 26.255 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    656/  1000| tot_loss: 3.4328 | rl_loss: 1.6771 | pt_loss: 1.7556 | pg_loss: 0.5150 | reg_loss: 1.1621 | reward: -0.5179 | rev_kl: 1.1471 | stu_lens: 81.6875 | mixed_lens: 74.6406 | lr: 1.6449e-06 | scale: 512.00 | time: 26.255 | step time: 27.487
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    657/  1000| tot_loss: 3.4067 | rl_loss: 1.3926 | pt_loss: 2.0141 | pg_loss: 0.0478 | reg_loss: 1.3448 | reward: -0.3201 | rev_kl: 1.6203 | stu_lens: 47.0000 | mixed_lens: 128.0000 | lr: 1.6368e-06 | scale: 512.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    658/  1000| tot_loss: 2.6182 | rl_loss: 1.2018 | pt_loss: 1.4163 | pg_loss: 0.3739 | reg_loss: 0.8279 | reward: -0.6239 | rev_kl: 1.7239 | stu_lens: 116.5000 | mixed_lens: 89.0000 | lr: 1.6286e-06 | scale: 512.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    659/  1000| tot_loss: 3.3342 | rl_loss: 1.3419 | pt_loss: 1.9923 | pg_loss: 0.3905 | reg_loss: 0.9514 | reward: -0.3310 | rev_kl: 1.2217 | stu_lens: 63.0000 | mixed_lens: 76.0000 | lr: 1.6204e-06 | scale: 512.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    660/  1000| tot_loss: 2.7535 | rl_loss: 1.3138 | pt_loss: 1.4397 | pg_loss: 0.2186 | reg_loss: 1.0952 | reward: -0.8408 | rev_kl: 0.7035 | stu_lens: 128.0000 | mixed_lens: 83.0000 | lr: 1.6122e-06 | scale: 512.00 | time: 26.218 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    661/  1000| tot_loss: 3.1286 | rl_loss: 1.4594 | pt_loss: 1.6692 | pg_loss: 0.3871 | reg_loss: 1.0723 | reward: -0.0620 | rev_kl: 0.8003 | stu_lens: 87.5000 | mixed_lens: 84.0000 | lr: 1.6041e-06 | scale: 512.00 | time: 26.216 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    662/  1000| tot_loss: 2.8351 | rl_loss: 1.3595 | pt_loss: 1.4756 | pg_loss: 0.3371 | reg_loss: 1.0224 | reward: -0.6605 | rev_kl: 1.0522 | stu_lens: 92.0000 | mixed_lens: 88.0000 | lr: 1.5959e-06 | scale: 512.00 | time: 26.182 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    663/  1000| tot_loss: 3.7652 | rl_loss: 1.8332 | pt_loss: 1.9321 | pg_loss: 0.8855 | reg_loss: 0.9477 | reward: -0.5547 | rev_kl: 1.2974 | stu_lens: 43.0000 | mixed_lens: 37.0000 | lr: 1.5878e-06 | scale: 512.00 | time: 26.220 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    664/  1000| tot_loss: 1.9874 | rl_loss: 0.4594 | pt_loss: 1.5280 | pg_loss: 0.1028 | reg_loss: 0.3566 | reward: -0.1033 | rev_kl: 1.6339 | stu_lens: 125.0000 | mixed_lens: 96.0000 | lr: 1.5797e-06 | scale: 512.00 | time: 26.171 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    665/  1000| tot_loss: 3.6093 | rl_loss: 1.7644 | pt_loss: 1.8449 | pg_loss: 0.8206 | reg_loss: 0.9438 | reward: -0.4933 | rev_kl: 1.2900 | stu_lens: 17.0000 | mixed_lens: 47.0000 | lr: 1.5716e-06 | scale: 512.00 | time: 26.262 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    666/  1000| tot_loss: 2.8417 | rl_loss: 1.5492 | pt_loss: 1.2925 | pg_loss: 0.4768 | reg_loss: 1.0724 | reward: -0.8147 | rev_kl: 0.8926 | stu_lens: 54.0000 | mixed_lens: 68.0000 | lr: 1.5635e-06 | scale: 512.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    667/  1000| tot_loss: 3.3162 | rl_loss: 1.2904 | pt_loss: 2.0258 | pg_loss: 0.5695 | reg_loss: 0.7209 | reward: -0.3828 | rev_kl: 0.8959 | stu_lens: 52.5000 | mixed_lens: 58.0000 | lr: 1.5554e-06 | scale: 512.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    668/  1000| tot_loss: 4.1230 | rl_loss: 2.3803 | pt_loss: 1.7427 | pg_loss: 1.1103 | reg_loss: 1.2700 | reward: -0.8223 | rev_kl: 1.0344 | stu_lens: 32.0000 | mixed_lens: 28.0000 | lr: 1.5473e-06 | scale: 512.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    669/  1000| tot_loss: 3.0851 | rl_loss: 1.0571 | pt_loss: 2.0280 | pg_loss: 0.0917 | reg_loss: 0.9654 | reward: -0.3581 | rev_kl: 1.1294 | stu_lens: 120.5000 | mixed_lens: 114.0000 | lr: 1.5393e-06 | scale: 512.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    670/  1000| tot_loss: 2.7406 | rl_loss: 0.8715 | pt_loss: 1.8691 | pg_loss: 0.0873 | reg_loss: 0.7843 | reward: 0.0578 | rev_kl: 1.0780 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 1.5312e-06 | scale: 512.00 | time: 26.190 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    671/  1000| tot_loss: 3.0742 | rl_loss: 1.1546 | pt_loss: 1.9195 | pg_loss: 0.0267 | reg_loss: 1.1279 | reward: -0.1944 | rev_kl: 1.5109 | stu_lens: 73.0000 | mixed_lens: 128.0000 | lr: 1.5232e-06 | scale: 512.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    672/  1000| tot_loss: 2.7176 | rl_loss: 1.1283 | pt_loss: 1.5893 | pg_loss: 0.1826 | reg_loss: 0.9457 | reward: -0.2878 | rev_kl: 1.2302 | stu_lens: 89.5000 | mixed_lens: 90.5000 | lr: 1.5151e-06 | scale: 512.00 | time: 26.167 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    672/  1000| tot_loss: 3.0590 | rl_loss: 1.3671 | pt_loss: 1.6919 | pg_loss: 0.4409 | reg_loss: 0.9262 | reward: -0.4899 | rev_kl: 1.1112 | stu_lens: 81.0938 | mixed_lens: 79.0000 | lr: 1.5151e-06 | scale: 512.00 | time: 26.167 | step time: 27.486
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    673/  1000| tot_loss: 3.2002 | rl_loss: 1.8209 | pt_loss: 1.3793 | pg_loss: 0.8643 | reg_loss: 0.9566 | reward: -1.2205 | rev_kl: 1.2827 | stu_lens: 128.0000 | mixed_lens: 35.0000 | lr: 1.5071e-06 | scale: 512.00 | time: 26.203 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    674/  1000| tot_loss: 2.7504 | rl_loss: 0.6989 | pt_loss: 2.0515 | pg_loss: 0.3344 | reg_loss: 0.3646 | reward: -0.5475 | rev_kl: 1.3739 | stu_lens: 128.0000 | mixed_lens: 54.0000 | lr: 1.4991e-06 | scale: 512.00 | time: 26.179 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    675/  1000| tot_loss: 3.6318 | rl_loss: 1.5281 | pt_loss: 2.1037 | pg_loss: 0.8571 | reg_loss: 0.6710 | reward: -1.0995 | rev_kl: 0.4895 | stu_lens: 77.0000 | mixed_lens: 34.5000 | lr: 1.4911e-06 | scale: 512.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    676/  1000| tot_loss: 3.2119 | rl_loss: 1.9425 | pt_loss: 1.2694 | pg_loss: 1.0679 | reg_loss: 0.8746 | reward: -0.7874 | rev_kl: 0.9701 | stu_lens: 36.5000 | mixed_lens: 35.5000 | lr: 1.4832e-06 | scale: 512.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    677/  1000| tot_loss: 3.2157 | rl_loss: 0.9953 | pt_loss: 2.2204 | pg_loss: 0.2660 | reg_loss: 0.7293 | reward: -1.8360 | rev_kl: 1.0029 | stu_lens: 59.5000 | mixed_lens: 69.5000 | lr: 1.4752e-06 | scale: 512.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    678/  1000| tot_loss: 2.3003 | rl_loss: 0.5779 | pt_loss: 1.7224 | pg_loss: 0.0048 | reg_loss: 0.5730 | reward: -0.0907 | rev_kl: 1.2649 | stu_lens: 73.5000 | mixed_lens: 128.0000 | lr: 1.4672e-06 | scale: 512.00 | time: 26.209 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    679/  1000| tot_loss: 2.7919 | rl_loss: 0.7588 | pt_loss: 2.0331 | pg_loss: 0.0178 | reg_loss: 0.7410 | reward: -0.3289 | rev_kl: 0.8902 | stu_lens: 114.0000 | mixed_lens: 128.0000 | lr: 1.4593e-06 | scale: 512.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    680/  1000| tot_loss: 2.8840 | rl_loss: 0.8789 | pt_loss: 2.0051 | pg_loss: 0.1276 | reg_loss: 0.7513 | reward: -0.7455 | rev_kl: 1.2755 | stu_lens: 125.0000 | mixed_lens: 95.5000 | lr: 1.4514e-06 | scale: 512.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    681/  1000| tot_loss: 2.0109 | rl_loss: 0.7850 | pt_loss: 1.2259 | pg_loss: 0.1440 | reg_loss: 0.6411 | reward: -0.3027 | rev_kl: 1.2624 | stu_lens: 84.0000 | mixed_lens: 114.0000 | lr: 1.4435e-06 | scale: 512.00 | time: 26.205 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    682/  1000| tot_loss: 2.7546 | rl_loss: 0.9038 | pt_loss: 1.8508 | pg_loss: 0.2393 | reg_loss: 0.6645 | reward: -0.8911 | rev_kl: 1.4715 | stu_lens: 128.0000 | mixed_lens: 77.0000 | lr: 1.4356e-06 | scale: 512.00 | time: 26.194 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    683/  1000| tot_loss: 2.8733 | rl_loss: 1.1301 | pt_loss: 1.7432 | pg_loss: 0.6227 | reg_loss: 0.5074 | reward: -0.8871 | rev_kl: 1.4299 | stu_lens: 69.0000 | mixed_lens: 51.0000 | lr: 1.4277e-06 | scale: 512.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    684/  1000| tot_loss: 2.9488 | rl_loss: 0.8135 | pt_loss: 2.1352 | pg_loss: 0.0876 | reg_loss: 0.7259 | reward: -0.4144 | rev_kl: 1.4966 | stu_lens: 124.0000 | mixed_lens: 117.0000 | lr: 1.4198e-06 | scale: 512.00 | time: 26.211 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    685/  1000| tot_loss: 2.6819 | rl_loss: 0.7794 | pt_loss: 1.9025 | pg_loss: 0.1023 | reg_loss: 0.6771 | reward: -0.3352 | rev_kl: 1.1599 | stu_lens: 120.5000 | mixed_lens: 108.5000 | lr: 1.4119e-06 | scale: 512.00 | time: 26.281 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    686/  1000| tot_loss: 2.3963 | rl_loss: 1.0409 | pt_loss: 1.3554 | pg_loss: 0.1605 | reg_loss: 0.8804 | reward: -0.5790 | rev_kl: 1.6604 | stu_lens: 22.0000 | mixed_lens: 74.0000 | lr: 1.4041e-06 | scale: 512.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    687/  1000| tot_loss: 2.4408 | rl_loss: 0.9086 | pt_loss: 1.5322 | pg_loss: 0.1552 | reg_loss: 0.7534 | reward: -0.9523 | rev_kl: 1.1257 | stu_lens: 74.0000 | mixed_lens: 74.5000 | lr: 1.3962e-06 | scale: 512.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    688/  1000| tot_loss: 2.2652 | rl_loss: 0.5558 | pt_loss: 1.7094 | pg_loss: 0.1313 | reg_loss: 0.4245 | reward: -0.2831 | rev_kl: 0.8482 | stu_lens: 117.5000 | mixed_lens: 115.0000 | lr: 1.3884e-06 | scale: 512.00 | time: 26.165 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    688/  1000| tot_loss: 2.8169 | rl_loss: 1.0517 | pt_loss: 1.7652 | pg_loss: 0.3757 | reg_loss: 0.6759 | reward: -0.5307 | rev_kl: 1.1729 | stu_lens: 83.6875 | mixed_lens: 76.9844 | lr: 1.3884e-06 | scale: 512.00 | time: 26.165 | step time: 27.484
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    689/  1000| tot_loss: 3.2291 | rl_loss: 1.1792 | pt_loss: 2.0499 | pg_loss: 0.5624 | reg_loss: 0.6168 | reward: -0.2787 | rev_kl: 1.2914 | stu_lens: 39.0000 | mixed_lens: 57.0000 | lr: 1.3806e-06 | scale: 512.00 | time: 26.259 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    690/  1000| tot_loss: 2.5870 | rl_loss: 0.9610 | pt_loss: 1.6261 | pg_loss: 0.4286 | reg_loss: 0.5324 | reward: -0.5578 | rev_kl: 1.0649 | stu_lens: 95.0000 | mixed_lens: 81.5000 | lr: 1.3728e-06 | scale: 512.00 | time: 26.196 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    691/  1000| tot_loss: 3.1030 | rl_loss: 1.1400 | pt_loss: 1.9630 | pg_loss: 0.6402 | reg_loss: 0.4997 | reward: -1.1242 | rev_kl: 1.6427 | stu_lens: 69.0000 | mixed_lens: 43.5000 | lr: 1.3650e-06 | scale: 512.00 | time: 26.200 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    692/  1000| tot_loss: 2.1165 | rl_loss: 0.5669 | pt_loss: 1.5496 | pg_loss: 0.3194 | reg_loss: 0.2475 | reward: -0.5390 | rev_kl: 0.6275 | stu_lens: 41.0000 | mixed_lens: 51.0000 | lr: 1.3573e-06 | scale: 512.00 | time: 26.194 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    693/  1000| tot_loss: 3.2684 | rl_loss: 1.4487 | pt_loss: 1.8197 | pg_loss: 1.0392 | reg_loss: 0.4095 | reward: -0.7451 | rev_kl: 1.1889 | stu_lens: 28.0000 | mixed_lens: 37.0000 | lr: 1.3495e-06 | scale: 512.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    694/  1000| tot_loss: 2.6807 | rl_loss: 0.8404 | pt_loss: 1.8403 | pg_loss: 0.3085 | reg_loss: 0.5319 | reward: -0.3082 | rev_kl: 1.5554 | stu_lens: 125.0000 | mixed_lens: 81.0000 | lr: 1.3418e-06 | scale: 512.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    695/  1000| tot_loss: 2.3875 | rl_loss: 0.8092 | pt_loss: 1.5783 | pg_loss: 0.4427 | reg_loss: 0.3664 | reward: -0.3025 | rev_kl: 0.8303 | stu_lens: 98.5000 | mixed_lens: 70.5000 | lr: 1.3340e-06 | scale: 512.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    696/  1000| tot_loss: 2.5198 | rl_loss: 0.7597 | pt_loss: 1.7601 | pg_loss: -0.0063 | reg_loss: 0.7661 | reward: -0.3459 | rev_kl: 2.3631 | stu_lens: 43.5000 | mixed_lens: 128.0000 | lr: 1.3263e-06 | scale: 512.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    697/  1000| tot_loss: 3.3178 | rl_loss: 1.5008 | pt_loss: 1.8170 | pg_loss: 0.9409 | reg_loss: 0.5599 | reward: -0.6993 | rev_kl: 0.4148 | stu_lens: 59.0000 | mixed_lens: 33.5000 | lr: 1.3186e-06 | scale: 512.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    698/  1000| tot_loss: 3.0855 | rl_loss: 1.1943 | pt_loss: 1.8912 | pg_loss: 0.5206 | reg_loss: 0.6737 | reward: -0.7121 | rev_kl: 1.0448 | stu_lens: 128.0000 | mixed_lens: 58.0000 | lr: 1.3109e-06 | scale: 512.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    699/  1000| tot_loss: 2.6170 | rl_loss: 0.9406 | pt_loss: 1.6764 | pg_loss: 0.4029 | reg_loss: 0.5377 | reward: -0.4783 | rev_kl: 1.8336 | stu_lens: 30.0000 | mixed_lens: 74.5000 | lr: 1.3033e-06 | scale: 512.00 | time: 26.204 | step time: 0.000
                                 Evaluation #7                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Convert the above time to Pacific     │ Convert the above time to Pacific    │
│ Standard Time.                        │ Standard Time.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 10:00 A.M. Pacific Time is 13:00     │
│                                       │ P.M. Pacific Time.                   │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 1970-01-01 00:00:00                  │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 1970-01-01T00:00:01.000Z             │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 15.828 | exact_match: 0.205 | rev_kl: 1.226 | lens: 80.783 | pt_loss: 1.088 | lm_loss: 1.179 | kd_loss: 0.997 
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    700/  1000| tot_loss: 2.0906 | rl_loss: 0.7050 | pt_loss: 1.3856 | pg_loss: 0.1047 | reg_loss: 0.6003 | reward: -0.4067 | rev_kl: 1.2812 | stu_lens: 128.0000 | mixed_lens: 114.0000 | lr: 1.2956e-06 | scale: 512.00 | time: 26.197 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    701/  1000| tot_loss: 2.3349 | rl_loss: 0.9776 | pt_loss: 1.3573 | pg_loss: 0.4930 | reg_loss: 0.4845 | reward: -1.1973 | rev_kl: 0.8025 | stu_lens: 22.0000 | mixed_lens: 65.5000 | lr: 1.2880e-06 | scale: 512.00 | time: 26.206 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    702/  1000| tot_loss: 2.9498 | rl_loss: 1.1915 | pt_loss: 1.7582 | pg_loss: 0.5542 | reg_loss: 0.6374 | reward: -0.5938 | rev_kl: 1.7039 | stu_lens: 37.5000 | mixed_lens: 65.5000 | lr: 1.2804e-06 | scale: 512.00 | time: 26.188 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    703/  1000| tot_loss: 2.9881 | rl_loss: 1.5067 | pt_loss: 1.4814 | pg_loss: 1.1762 | reg_loss: 0.3305 | reward: -0.9858 | rev_kl: 0.8270 | stu_lens: 51.0000 | mixed_lens: 39.0000 | lr: 1.2727e-06 | scale: 512.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    704/  1000| tot_loss: 2.9156 | rl_loss: 0.9804 | pt_loss: 1.9352 | pg_loss: 0.1996 | reg_loss: 0.7808 | reward: -0.9121 | rev_kl: 1.4463 | stu_lens: 128.0000 | mixed_lens: 70.0000 | lr: 1.2651e-06 | scale: 512.00 | time: 26.257 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    704/  1000| tot_loss: 2.6296 | rl_loss: 0.9367 | pt_loss: 1.6928 | pg_loss: 0.4314 | reg_loss: 0.5054 | reward: -0.5208 | rev_kl: 1.1689 | stu_lens: 76.3281 | mixed_lens: 73.8906 | lr: 1.2651e-06 | scale: 512.00 | time: 26.257 | step time: 27.489
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    705/  1000| tot_loss: 1.9451 | rl_loss: 0.6686 | pt_loss: 1.2765 | pg_loss: 0.2500 | reg_loss: 0.4186 | reward: -0.4110 | rev_kl: 1.0984 | stu_lens: 128.0000 | mixed_lens: 96.5000 | lr: 1.2576e-06 | scale: 512.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    706/  1000| tot_loss: 2.3696 | rl_loss: 0.5115 | pt_loss: 1.8581 | pg_loss: 0.1035 | reg_loss: 0.4080 | reward: -0.7976 | rev_kl: 0.6294 | stu_lens: 59.0000 | mixed_lens: 72.5000 | lr: 1.2500e-06 | scale: 512.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    707/  1000| tot_loss: 3.4504 | rl_loss: 1.2326 | pt_loss: 2.2178 | pg_loss: 0.2046 | reg_loss: 1.0280 | reward: -0.2454 | rev_kl: 3.4910 | stu_lens: 79.5000 | mixed_lens: 102.0000 | lr: 1.2425e-06 | scale: 512.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    708/  1000| tot_loss: 3.2155 | rl_loss: 1.6461 | pt_loss: 1.5695 | pg_loss: 0.4845 | reg_loss: 1.1616 | reward: -0.4666 | rev_kl: 0.9157 | stu_lens: 128.0000 | mixed_lens: 68.0000 | lr: 1.2349e-06 | scale: 512.00 | time: 26.188 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    709/  1000| tot_loss: 3.2493 | rl_loss: 1.7457 | pt_loss: 1.5036 | pg_loss: 0.4994 | reg_loss: 1.2463 | reward: -0.3392 | rev_kl: 1.4598 | stu_lens: 60.5000 | mixed_lens: 86.0000 | lr: 1.2274e-06 | scale: 512.00 | time: 26.220 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    710/  1000| tot_loss: 4.2015 | rl_loss: 2.4568 | pt_loss: 1.7447 | pg_loss: 1.5008 | reg_loss: 0.9560 | reward: -1.3561 | rev_kl: 1.1399 | stu_lens: 56.0000 | mixed_lens: 27.0000 | lr: 1.2199e-06 | scale: 512.00 | time: 26.168 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    711/  1000| tot_loss: 2.7742 | rl_loss: 1.0309 | pt_loss: 1.7433 | pg_loss: 0.4231 | reg_loss: 0.6078 | reward: 0.7960 | rev_kl: 1.0594 | stu_lens: 68.5000 | mixed_lens: 65.0000 | lr: 1.2124e-06 | scale: 512.00 | time: 26.178 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    712/  1000| tot_loss: 2.4747 | rl_loss: 0.9748 | pt_loss: 1.4999 | pg_loss: 0.2693 | reg_loss: 0.7054 | reward: -0.3231 | rev_kl: 0.7177 | stu_lens: 86.5000 | mixed_lens: 60.0000 | lr: 1.2049e-06 | scale: 512.00 | time: 26.151 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    713/  1000| tot_loss: 2.5995 | rl_loss: 0.9850 | pt_loss: 1.6144 | pg_loss: 0.1460 | reg_loss: 0.8391 | reward: -0.3870 | rev_kl: 0.6684 | stu_lens: 100.5000 | mixed_lens: 100.5000 | lr: 1.1975e-06 | scale: 512.00 | time: 26.168 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    714/  1000| tot_loss: 2.9763 | rl_loss: 1.0162 | pt_loss: 1.9601 | pg_loss: 0.1060 | reg_loss: 0.9102 | reward: -0.2485 | rev_kl: 1.0723 | stu_lens: 128.0000 | mixed_lens: 110.5000 | lr: 1.1900e-06 | scale: 512.00 | time: 26.158 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    715/  1000| tot_loss: 3.8965 | rl_loss: 1.8940 | pt_loss: 2.0025 | pg_loss: 0.7065 | reg_loss: 1.1875 | reward: -0.2477 | rev_kl: 1.2064 | stu_lens: 78.0000 | mixed_lens: 63.5000 | lr: 1.1826e-06 | scale: 512.00 | time: 26.200 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    716/  1000| tot_loss: 2.9241 | rl_loss: 0.8316 | pt_loss: 2.0925 | pg_loss: 0.0483 | reg_loss: 0.7832 | reward: -0.1049 | rev_kl: 0.8027 | stu_lens: 94.5000 | mixed_lens: 128.0000 | lr: 1.1752e-06 | scale: 512.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    717/  1000| tot_loss: 2.9335 | rl_loss: 1.1036 | pt_loss: 1.8299 | pg_loss: 0.3048 | reg_loss: 0.7988 | reward: -0.8817 | rev_kl: 0.6694 | stu_lens: 51.5000 | mixed_lens: 77.0000 | lr: 1.1678e-06 | scale: 512.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    718/  1000| tot_loss: 2.3995 | rl_loss: 0.5457 | pt_loss: 1.8538 | pg_loss: 0.0328 | reg_loss: 0.5129 | reward: -0.1781 | rev_kl: 1.4388 | stu_lens: 83.0000 | mixed_lens: 128.0000 | lr: 1.1604e-06 | scale: 512.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    719/  1000| tot_loss: 2.9801 | rl_loss: 1.7040 | pt_loss: 1.2761 | pg_loss: 0.3498 | reg_loss: 1.3542 | reward: -0.2973 | rev_kl: 1.2619 | stu_lens: 54.0000 | mixed_lens: 79.5000 | lr: 1.1531e-06 | scale: 512.00 | time: 26.261 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    720/  1000| tot_loss: 3.0617 | rl_loss: 1.4332 | pt_loss: 1.6285 | pg_loss: 0.1479 | reg_loss: 1.2853 | reward: -0.1924 | rev_kl: 0.8707 | stu_lens: 82.0000 | mixed_lens: 112.0000 | lr: 1.1457e-06 | scale: 512.00 | time: 26.209 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    720/  1000| tot_loss: 3.2248 | rl_loss: 1.5177 | pt_loss: 1.7071 | pg_loss: 0.4852 | reg_loss: 1.0324 | reward: -0.5365 | rev_kl: 1.1383 | stu_lens: 68.0469 | mixed_lens: 77.0312 | lr: 1.1457e-06 | scale: 512.00 | time: 26.209 | step time: 27.474
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    721/  1000| tot_loss: 4.6699 | rl_loss: 2.5792 | pt_loss: 2.0908 | pg_loss: 0.7705 | reg_loss: 1.8086 | reward: -0.7703 | rev_kl: 1.3156 | stu_lens: 48.5000 | mixed_lens: 55.0000 | lr: 1.1384e-06 | scale: 512.00 | time: 26.234 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    722/  1000| tot_loss: 3.4696 | rl_loss: 1.7108 | pt_loss: 1.7588 | pg_loss: 0.4608 | reg_loss: 1.2499 | reward: -0.6199 | rev_kl: 0.8570 | stu_lens: 34.5000 | mixed_lens: 44.5000 | lr: 1.1311e-06 | scale: 512.00 | time: 26.194 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    723/  1000| tot_loss: 2.4999 | rl_loss: 0.7934 | pt_loss: 1.7065 | pg_loss: 0.3033 | reg_loss: 0.4901 | reward: -0.2253 | rev_kl: 0.9031 | stu_lens: 27.0000 | mixed_lens: 77.0000 | lr: 1.1238e-06 | scale: 512.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    724/  1000| tot_loss: 3.2283 | rl_loss: 1.7852 | pt_loss: 1.4431 | pg_loss: 0.5894 | reg_loss: 1.1958 | reward: -0.3864 | rev_kl: 1.4710 | stu_lens: 63.5000 | mixed_lens: 65.5000 | lr: 1.1165e-06 | scale: 512.00 | time: 26.200 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    725/  1000| tot_loss: 2.6388 | rl_loss: 0.9345 | pt_loss: 1.7043 | pg_loss: 0.1729 | reg_loss: 0.7616 | reward: -0.3891 | rev_kl: 0.7180 | stu_lens: 73.5000 | mixed_lens: 95.5000 | lr: 1.1093e-06 | scale: 512.00 | time: 26.284 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    726/  1000| tot_loss: 2.8855 | rl_loss: 1.3930 | pt_loss: 1.4924 | pg_loss: 0.4673 | reg_loss: 0.9258 | reward: -1.3645 | rev_kl: 1.0606 | stu_lens: 85.0000 | mixed_lens: 62.0000 | lr: 1.1020e-06 | scale: 512.00 | time: 26.253 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    727/  1000| tot_loss: 3.5558 | rl_loss: 1.9583 | pt_loss: 1.5976 | pg_loss: 0.4113 | reg_loss: 1.5470 | reward: -0.9180 | rev_kl: 0.8538 | stu_lens: 60.0000 | mixed_lens: 66.5000 | lr: 1.0948e-06 | scale: 512.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    728/  1000| tot_loss: 3.9712 | rl_loss: 1.9286 | pt_loss: 2.0425 | pg_loss: 0.5322 | reg_loss: 1.3964 | reward: -2.3638 | rev_kl: 2.6821 | stu_lens: 65.5000 | mixed_lens: 66.0000 | lr: 1.0876e-06 | scale: 512.00 | time: 26.204 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    729/  1000| tot_loss: 3.2640 | rl_loss: 1.4210 | pt_loss: 1.8430 | pg_loss: 0.2376 | reg_loss: 1.1834 | reward: -0.2365 | rev_kl: 1.1014 | stu_lens: 47.5000 | mixed_lens: 91.0000 | lr: 1.0804e-06 | scale: 512.00 | time: 26.209 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    730/  1000| tot_loss: 1.8070 | rl_loss: 0.4225 | pt_loss: 1.3845 | pg_loss: -0.0039 | reg_loss: 0.4264 | reward: -0.1138 | rev_kl: 0.7163 | stu_lens: 85.5000 | mixed_lens: 128.0000 | lr: 1.0732e-06 | scale: 512.00 | time: 26.182 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    731/  1000| tot_loss: 1.8381 | rl_loss: 0.5224 | pt_loss: 1.3157 | pg_loss: 0.1537 | reg_loss: 0.3686 | reward: -0.4515 | rev_kl: 0.6491 | stu_lens: 114.5000 | mixed_lens: 78.5000 | lr: 1.0661e-06 | scale: 512.00 | time: 26.209 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    732/  1000| tot_loss: 2.6285 | rl_loss: 1.0181 | pt_loss: 1.6104 | pg_loss: 0.1951 | reg_loss: 0.8230 | reward: -0.0379 | rev_kl: 1.1082 | stu_lens: 71.0000 | mixed_lens: 98.5000 | lr: 1.0589e-06 | scale: 512.00 | time: 26.181 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    733/  1000| tot_loss: 2.3250 | rl_loss: 0.7950 | pt_loss: 1.5300 | pg_loss: -0.0066 | reg_loss: 0.8016 | reward: -0.1791 | rev_kl: 1.3061 | stu_lens: 103.5000 | mixed_lens: 128.0000 | lr: 1.0518e-06 | scale: 512.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    734/  1000| tot_loss: 3.7157 | rl_loss: 1.7027 | pt_loss: 2.0130 | pg_loss: 0.9106 | reg_loss: 0.7921 | reward: -0.7637 | rev_kl: 1.3882 | stu_lens: 54.0000 | mixed_lens: 42.5000 | lr: 1.0447e-06 | scale: 512.00 | time: 26.203 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    735/  1000| tot_loss: 2.7178 | rl_loss: 1.1370 | pt_loss: 1.5808 | pg_loss: 0.1573 | reg_loss: 0.9797 | reward: -0.2328 | rev_kl: 1.3218 | stu_lens: 81.0000 | mixed_lens: 51.5000 | lr: 1.0376e-06 | scale: 512.00 | time: 26.258 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    736/  1000| tot_loss: 3.3047 | rl_loss: 1.4589 | pt_loss: 1.8458 | pg_loss: 0.8884 | reg_loss: 0.5705 | reward: -0.4423 | rev_kl: 0.5997 | stu_lens: 56.0000 | mixed_lens: 45.0000 | lr: 1.0305e-06 | scale: 512.00 | time: 26.244 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    736/  1000| tot_loss: 3.0688 | rl_loss: 1.3578 | pt_loss: 1.7110 | pg_loss: 0.4391 | reg_loss: 0.9187 | reward: -0.5571 | rev_kl: 1.1241 | stu_lens: 66.3750 | mixed_lens: 77.7969 | lr: 1.0305e-06 | scale: 512.00 | time: 26.244 | step time: 27.487
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    737/  1000| tot_loss: 2.2903 | rl_loss: 0.6228 | pt_loss: 1.6675 | pg_loss: 0.2734 | reg_loss: 0.3494 | reward: -0.4688 | rev_kl: 2.6255 | stu_lens: 88.0000 | mixed_lens: 60.0000 | lr: 1.0235e-06 | scale: 512.00 | time: 26.216 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    738/  1000| tot_loss: 2.9463 | rl_loss: 1.1373 | pt_loss: 1.8090 | pg_loss: 0.3385 | reg_loss: 0.7988 | reward: -0.8605 | rev_kl: 0.6897 | stu_lens: 76.0000 | mixed_lens: 77.0000 | lr: 1.0165e-06 | scale: 512.00 | time: 26.181 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    739/  1000| tot_loss: 2.4238 | rl_loss: 0.3584 | pt_loss: 2.0654 | pg_loss: -0.0273 | reg_loss: 0.3856 | reward: -0.1260 | rev_kl: 0.7824 | stu_lens: 70.0000 | mixed_lens: 128.0000 | lr: 1.0094e-06 | scale: 512.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    740/  1000| tot_loss: 3.6610 | rl_loss: 1.6119 | pt_loss: 2.0491 | pg_loss: 0.5780 | reg_loss: 1.0339 | reward: 0.7868 | rev_kl: 1.5522 | stu_lens: 68.5000 | mixed_lens: 65.0000 | lr: 1.0024e-06 | scale: 512.00 | time: 26.163 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    741/  1000| tot_loss: 1.8759 | rl_loss: 0.4248 | pt_loss: 1.4511 | pg_loss: -0.0017 | reg_loss: 0.4265 | reward: -0.1658 | rev_kl: 0.8739 | stu_lens: 46.5000 | mixed_lens: 128.0000 | lr: 9.9546e-07 | scale: 512.00 | time: 26.207 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    742/  1000| tot_loss: 2.2209 | rl_loss: 0.4972 | pt_loss: 1.7237 | pg_loss: 0.2109 | reg_loss: 0.2863 | reward: -0.7838 | rev_kl: 1.0470 | stu_lens: 28.0000 | mixed_lens: 82.5000 | lr: 9.8850e-07 | scale: 512.00 | time: 26.143 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    743/  1000| tot_loss: 2.4169 | rl_loss: 0.7806 | pt_loss: 1.6363 | pg_loss: 0.1307 | reg_loss: 0.6499 | reward: -0.2125 | rev_kl: 1.4954 | stu_lens: 78.0000 | mixed_lens: 110.5000 | lr: 9.8156e-07 | scale: 512.00 | time: 26.179 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    744/  1000| tot_loss: 2.3785 | rl_loss: 0.7258 | pt_loss: 1.6527 | pg_loss: -0.0094 | reg_loss: 0.7353 | reward: -0.2564 | rev_kl: 0.8814 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 9.7464e-07 | scale: 512.00 | time: 26.209 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    745/  1000| tot_loss: 3.2483 | rl_loss: 1.3652 | pt_loss: 1.8831 | pg_loss: 1.0082 | reg_loss: 0.3570 | reward: -0.3688 | rev_kl: 0.7308 | stu_lens: 40.0000 | mixed_lens: 35.5000 | lr: 9.6773e-07 | scale: 512.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    746/  1000| tot_loss: 3.0463 | rl_loss: 1.3234 | pt_loss: 1.7228 | pg_loss: 0.9663 | reg_loss: 0.3571 | reward: -0.4393 | rev_kl: 0.8539 | stu_lens: 51.5000 | mixed_lens: 44.5000 | lr: 9.6085e-07 | scale: 512.00 | time: 26.190 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    747/  1000| tot_loss: 2.2443 | rl_loss: 0.7954 | pt_loss: 1.4489 | pg_loss: 0.2172 | reg_loss: 0.5782 | reward: -0.6739 | rev_kl: 1.6054 | stu_lens: 74.5000 | mixed_lens: 78.0000 | lr: 9.5398e-07 | scale: 512.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    748/  1000| tot_loss: 2.1939 | rl_loss: 0.6236 | pt_loss: 1.5703 | pg_loss: 0.1244 | reg_loss: 0.4992 | reward: -0.2236 | rev_kl: 1.1343 | stu_lens: 90.5000 | mixed_lens: 88.0000 | lr: 9.4713e-07 | scale: 512.00 | time: 26.202 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    749/  1000| tot_loss: 2.4903 | rl_loss: 0.9403 | pt_loss: 1.5500 | pg_loss: 0.3831 | reg_loss: 0.5573 | reward: -0.4340 | rev_kl: 0.4249 | stu_lens: 43.0000 | mixed_lens: 63.5000 | lr: 9.4030e-07 | scale: 512.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    750/  1000| tot_loss: 2.9833 | rl_loss: 0.9072 | pt_loss: 2.0761 | pg_loss: 0.4926 | reg_loss: 0.4146 | reward: -0.3129 | rev_kl: 0.7624 | stu_lens: 29.5000 | mixed_lens: 22.5000 | lr: 9.3349e-07 | scale: 512.00 | time: 26.179 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    751/  1000| tot_loss: 2.6913 | rl_loss: 0.9502 | pt_loss: 1.7411 | pg_loss: 0.2854 | reg_loss: 0.6647 | reward: -1.8615 | rev_kl: 0.8434 | stu_lens: 48.0000 | mixed_lens: 64.0000 | lr: 9.2670e-07 | scale: 512.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    752/  1000| tot_loss: 2.8081 | rl_loss: 2.0258 | pt_loss: 0.7823 | pg_loss: 1.1298 | reg_loss: 0.8961 | reward: -0.6968 | rev_kl: 1.7000 | stu_lens: 39.0000 | mixed_lens: 30.0000 | lr: 9.1993e-07 | scale: 512.00 | time: 26.182 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    752/  1000| tot_loss: 2.7143 | rl_loss: 1.0271 | pt_loss: 1.6872 | pg_loss: 0.3946 | reg_loss: 0.6325 | reward: -0.5489 | rev_kl: 1.1668 | stu_lens: 66.0781 | mixed_lens: 73.7500 | lr: 9.1993e-07 | scale: 512.00 | time: 26.182 | step time: 27.464
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    753/  1000| tot_loss: 2.0322 | rl_loss: 0.4499 | pt_loss: 1.5823 | pg_loss: 0.0184 | reg_loss: 0.4316 | reward: -0.1722 | rev_kl: 1.6054 | stu_lens: 66.0000 | mixed_lens: 128.0000 | lr: 9.1317e-07 | scale: 512.00 | time: 26.271 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    754/  1000| tot_loss: 2.9506 | rl_loss: 1.0955 | pt_loss: 1.8551 | pg_loss: 0.4858 | reg_loss: 0.6096 | reward: -0.4622 | rev_kl: 1.2500 | stu_lens: 45.5000 | mixed_lens: 63.5000 | lr: 9.0644e-07 | scale: 512.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    755/  1000| tot_loss: 3.1042 | rl_loss: 0.9625 | pt_loss: 2.1417 | pg_loss: 0.1666 | reg_loss: 0.7959 | reward: -0.1566 | rev_kl: 1.2535 | stu_lens: 51.5000 | mixed_lens: 101.5000 | lr: 8.9973e-07 | scale: 512.00 | time: 26.257 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    756/  1000| tot_loss: 2.1216 | rl_loss: 0.6752 | pt_loss: 1.4464 | pg_loss: 0.1118 | reg_loss: 0.5634 | reward: -0.1652 | rev_kl: 1.1935 | stu_lens: 88.5000 | mixed_lens: 115.0000 | lr: 8.9303e-07 | scale: 512.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    757/  1000| tot_loss: 2.7045 | rl_loss: 1.2745 | pt_loss: 1.4300 | pg_loss: 0.6452 | reg_loss: 0.6294 | reward: -0.8788 | rev_kl: 1.1927 | stu_lens: 49.5000 | mixed_lens: 72.5000 | lr: 8.8636e-07 | scale: 512.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    758/  1000| tot_loss: 2.4443 | rl_loss: 0.4585 | pt_loss: 1.9858 | pg_loss: 0.0805 | reg_loss: 0.3780 | reward: -0.2146 | rev_kl: 1.0768 | stu_lens: 49.5000 | mixed_lens: 110.5000 | lr: 8.7970e-07 | scale: 512.00 | time: 26.211 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    759/  1000| tot_loss: 2.5994 | rl_loss: 1.1082 | pt_loss: 1.4912 | pg_loss: 0.4855 | reg_loss: 0.6227 | reward: -0.2813 | rev_kl: 1.7123 | stu_lens: 22.5000 | mixed_lens: 70.0000 | lr: 8.7306e-07 | scale: 512.00 | time: 26.251 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    760/  1000| tot_loss: 3.5572 | rl_loss: 2.1493 | pt_loss: 1.4079 | pg_loss: 1.2984 | reg_loss: 0.8509 | reward: -2.9760 | rev_kl: 2.6297 | stu_lens: 18.5000 | mixed_lens: 21.0000 | lr: 8.6645e-07 | scale: 512.00 | time: 26.202 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    761/  1000| tot_loss: 3.2504 | rl_loss: 1.3235 | pt_loss: 1.9269 | pg_loss: 0.7293 | reg_loss: 0.5942 | reward: -0.6740 | rev_kl: 1.0980 | stu_lens: 31.5000 | mixed_lens: 50.0000 | lr: 8.5985e-07 | scale: 512.00 | time: 26.211 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    762/  1000| tot_loss: 4.1427 | rl_loss: 1.7289 | pt_loss: 2.4138 | pg_loss: 1.2460 | reg_loss: 0.4829 | reward: -1.0645 | rev_kl: 0.5200 | stu_lens: 24.0000 | mixed_lens: 20.5000 | lr: 8.5328e-07 | scale: 512.00 | time: 26.212 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    763/  1000| tot_loss: 1.9586 | rl_loss: 0.2527 | pt_loss: 1.7060 | pg_loss: -0.0062 | reg_loss: 0.2588 | reward: -0.2467 | rev_kl: 1.1543 | stu_lens: 28.0000 | mixed_lens: 84.0000 | lr: 8.4672e-07 | scale: 512.00 | time: 26.277 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    764/  1000| tot_loss: 2.6459 | rl_loss: 0.8989 | pt_loss: 1.7470 | pg_loss: 0.3902 | reg_loss: 0.5087 | reward: -0.9198 | rev_kl: 0.4081 | stu_lens: 57.0000 | mixed_lens: 61.0000 | lr: 8.4018e-07 | scale: 512.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    765/  1000| tot_loss: 2.5919 | rl_loss: 1.1492 | pt_loss: 1.4427 | pg_loss: 0.7379 | reg_loss: 0.4113 | reward: -1.3972 | rev_kl: 1.1491 | stu_lens: 62.5000 | mixed_lens: 30.5000 | lr: 8.3367e-07 | scale: 512.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    766/  1000| tot_loss: 2.1433 | rl_loss: 0.5031 | pt_loss: 1.6402 | pg_loss: 0.2376 | reg_loss: 0.2655 | reward: -0.4669 | rev_kl: 0.4508 | stu_lens: 40.5000 | mixed_lens: 84.5000 | lr: 8.2717e-07 | scale: 512.00 | time: 26.221 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    767/  1000| tot_loss: 3.4318 | rl_loss: 1.7112 | pt_loss: 1.7206 | pg_loss: 0.9447 | reg_loss: 0.7665 | reward: -1.9064 | rev_kl: 0.5503 | stu_lens: 17.5000 | mixed_lens: 32.0000 | lr: 8.2070e-07 | scale: 512.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    768/  1000| tot_loss: 3.0565 | rl_loss: 0.6968 | pt_loss: 2.3597 | pg_loss: 0.0636 | reg_loss: 0.6332 | reward: -0.4179 | rev_kl: 1.1925 | stu_lens: 89.5000 | mixed_lens: 119.0000 | lr: 8.1424e-07 | scale: 512.00 | time: 26.193 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    768/  1000| tot_loss: 2.6390 | rl_loss: 0.9430 | pt_loss: 1.6960 | pg_loss: 0.4182 | reg_loss: 0.5249 | reward: -0.5454 | rev_kl: 1.1068 | stu_lens: 62.3125 | mixed_lens: 76.5938 | lr: 8.1424e-07 | scale: 512.00 | time: 26.193 | step time: 27.499
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    769/  1000| tot_loss: 2.0946 | rl_loss: 0.8156 | pt_loss: 1.2791 | pg_loss: 0.4143 | reg_loss: 0.4013 | reward: -0.4274 | rev_kl: 2.9997 | stu_lens: 100.5000 | mixed_lens: 65.0000 | lr: 8.0781e-07 | scale: 512.00 | time: 26.235 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    770/  1000| tot_loss: 4.4458 | rl_loss: 2.6113 | pt_loss: 1.8345 | pg_loss: 1.0475 | reg_loss: 1.5638 | reward: -1.2539 | rev_kl: 2.0370 | stu_lens: 32.5000 | mixed_lens: 30.5000 | lr: 8.0140e-07 | scale: 512.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    771/  1000| tot_loss: 3.3447 | rl_loss: 1.5185 | pt_loss: 1.8262 | pg_loss: 0.1377 | reg_loss: 1.3807 | reward: -0.5203 | rev_kl: 0.7406 | stu_lens: 42.5000 | mixed_lens: 75.5000 | lr: 7.9500e-07 | scale: 512.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    772/  1000| tot_loss: 3.4156 | rl_loss: 1.9397 | pt_loss: 1.4759 | pg_loss: 0.3667 | reg_loss: 1.5729 | reward: -0.2319 | rev_kl: 1.4552 | stu_lens: 109.0000 | mixed_lens: 90.5000 | lr: 7.8863e-07 | scale: 512.00 | time: 26.270 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    773/  1000| tot_loss: 3.5045 | rl_loss: 1.7042 | pt_loss: 1.8003 | pg_loss: 0.7042 | reg_loss: 1.0000 | reward: -0.5917 | rev_kl: 1.4327 | stu_lens: 58.0000 | mixed_lens: 52.5000 | lr: 7.8228e-07 | scale: 512.00 | time: 26.248 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    774/  1000| tot_loss: 3.0426 | rl_loss: 1.2977 | pt_loss: 1.7450 | pg_loss: 0.0661 | reg_loss: 1.2316 | reward: -0.2091 | rev_kl: 0.9985 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 7.7595e-07 | scale: 512.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    775/  1000| tot_loss: 7.7995 | rl_loss: 6.0883 | pt_loss: 1.7112 | pg_loss: 3.4041 | reg_loss: 2.6842 | reward: -4.4088 | rev_kl: 0.8672 | stu_lens: 6.0000 | mixed_lens: 5.5000 | lr: 7.6964e-07 | scale: 512.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    776/  1000| tot_loss: 5.0757 | rl_loss: 3.3519 | pt_loss: 1.7238 | pg_loss: 1.4643 | reg_loss: 1.8876 | reward: -0.2329 | rev_kl: 2.2610 | stu_lens: 27.0000 | mixed_lens: 26.0000 | lr: 7.6335e-07 | scale: 512.00 | time: 26.216 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    777/  1000| tot_loss: 3.0109 | rl_loss: 1.2928 | pt_loss: 1.7181 | pg_loss: 0.1935 | reg_loss: 1.0993 | reward: -0.3785 | rev_kl: 1.4583 | stu_lens: 73.0000 | mixed_lens: 99.5000 | lr: 7.5709e-07 | scale: 512.00 | time: 26.172 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    778/  1000| tot_loss: 2.6110 | rl_loss: 0.9464 | pt_loss: 1.6647 | pg_loss: 0.1890 | reg_loss: 0.7574 | reward: -0.3487 | rev_kl: 0.2937 | stu_lens: 128.0000 | mixed_lens: 101.5000 | lr: 7.5084e-07 | scale: 512.00 | time: 26.212 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    779/  1000| tot_loss: 3.5531 | rl_loss: 2.1156 | pt_loss: 1.4375 | pg_loss: 0.9906 | reg_loss: 1.1251 | reward: -0.6327 | rev_kl: 0.7823 | stu_lens: 89.5000 | mixed_lens: 51.0000 | lr: 7.4462e-07 | scale: 512.00 | time: 26.166 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    780/  1000| tot_loss: 3.4136 | rl_loss: 1.2540 | pt_loss: 2.1596 | pg_loss: 0.3695 | reg_loss: 0.8845 | reward: -0.4694 | rev_kl: 1.0108 | stu_lens: 69.0000 | mixed_lens: 76.5000 | lr: 7.3841e-07 | scale: 512.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    781/  1000| tot_loss: 3.3271 | rl_loss: 1.7329 | pt_loss: 1.5942 | pg_loss: 0.2965 | reg_loss: 1.4364 | reward: -0.4067 | rev_kl: 1.3056 | stu_lens: 85.0000 | mixed_lens: 83.0000 | lr: 7.3223e-07 | scale: 512.00 | time: 26.226 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    782/  1000| tot_loss: 3.8567 | rl_loss: 1.9580 | pt_loss: 1.8987 | pg_loss: 0.3023 | reg_loss: 1.6557 | reward: -0.3830 | rev_kl: 1.5745 | stu_lens: 106.0000 | mixed_lens: 99.0000 | lr: 7.2607e-07 | scale: 512.00 | time: 26.293 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    783/  1000| tot_loss: 3.8169 | rl_loss: 1.7135 | pt_loss: 2.1034 | pg_loss: 1.0156 | reg_loss: 0.6980 | reward: 0.0853 | rev_kl: 0.5563 | stu_lens: 19.5000 | mixed_lens: 19.0000 | lr: 7.1993e-07 | scale: 512.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    784/  1000| tot_loss: 3.3706 | rl_loss: 1.4707 | pt_loss: 1.9000 | pg_loss: 0.1625 | reg_loss: 1.3082 | reward: -0.2382 | rev_kl: 0.5395 | stu_lens: 91.5000 | mixed_lens: 115.0000 | lr: 7.1382e-07 | scale: 512.00 | time: 26.236 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    784/  1000| tot_loss: 3.5262 | rl_loss: 1.8042 | pt_loss: 1.7220 | pg_loss: 0.5444 | reg_loss: 1.2598 | reward: -0.5085 | rev_kl: 1.1843 | stu_lens: 79.9844 | mixed_lens: 77.9062 | lr: 7.1382e-07 | scale: 512.00 | time: 26.236 | step time: 27.492
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    785/  1000| tot_loss: 2.0488 | rl_loss: 0.6897 | pt_loss: 1.3591 | pg_loss: 0.0275 | reg_loss: 0.6622 | reward: -0.1486 | rev_kl: 0.7982 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 7.0772e-07 | scale: 512.00 | time: 26.195 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    786/  1000| tot_loss: 2.2614 | rl_loss: 0.6494 | pt_loss: 1.6120 | pg_loss: 0.0902 | reg_loss: 0.5592 | reward: -0.3722 | rev_kl: 1.1108 | stu_lens: 104.0000 | mixed_lens: 96.0000 | lr: 7.0165e-07 | scale: 512.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    787/  1000| tot_loss: 3.3900 | rl_loss: 1.5367 | pt_loss: 1.8532 | pg_loss: 0.4151 | reg_loss: 1.1217 | reward: -0.5954 | rev_kl: 1.3778 | stu_lens: 44.0000 | mixed_lens: 61.0000 | lr: 6.9560e-07 | scale: 512.00 | time: 26.158 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    788/  1000| tot_loss: 3.6727 | rl_loss: 2.2087 | pt_loss: 1.4640 | pg_loss: 0.5932 | reg_loss: 1.6156 | reward: -0.7227 | rev_kl: 1.5226 | stu_lens: 57.5000 | mixed_lens: 49.0000 | lr: 6.8957e-07 | scale: 512.00 | time: 26.198 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    789/  1000| tot_loss: 2.7643 | rl_loss: 1.3045 | pt_loss: 1.4598 | pg_loss: 0.0889 | reg_loss: 1.2156 | reward: -0.4131 | rev_kl: 1.0830 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 6.8356e-07 | scale: 512.00 | time: 26.165 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    790/  1000| tot_loss: 3.4911 | rl_loss: 1.6936 | pt_loss: 1.7976 | pg_loss: 0.3676 | reg_loss: 1.3260 | reward: -0.3885 | rev_kl: 1.5166 | stu_lens: 86.0000 | mixed_lens: 87.5000 | lr: 6.7758e-07 | scale: 512.00 | time: 26.269 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    791/  1000| tot_loss: 3.4460 | rl_loss: 1.4858 | pt_loss: 1.9602 | pg_loss: 0.4651 | reg_loss: 1.0207 | reward: -0.4795 | rev_kl: 0.7494 | stu_lens: 126.5000 | mixed_lens: 83.5000 | lr: 6.7162e-07 | scale: 512.00 | time: 26.205 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    792/  1000| tot_loss: 3.4819 | rl_loss: 2.0462 | pt_loss: 1.4357 | pg_loss: 1.1894 | reg_loss: 0.8568 | reward: -3.8848 | rev_kl: 0.6201 | stu_lens: 12.5000 | mixed_lens: 14.5000 | lr: 6.6568e-07 | scale: 512.00 | time: 26.268 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    793/  1000| tot_loss: 2.7695 | rl_loss: 1.2481 | pt_loss: 1.5214 | pg_loss: 0.3194 | reg_loss: 0.9287 | reward: -0.2613 | rev_kl: 1.1708 | stu_lens: 60.5000 | mixed_lens: 84.0000 | lr: 6.5976e-07 | scale: 512.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    794/  1000| tot_loss: 3.5708 | rl_loss: 1.2985 | pt_loss: 2.2723 | pg_loss: 0.6539 | reg_loss: 0.6446 | reward: 0.1265 | rev_kl: 0.5520 | stu_lens: 39.0000 | mixed_lens: 42.5000 | lr: 6.5386e-07 | scale: 512.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    795/  1000| tot_loss: 3.4626 | rl_loss: 2.0365 | pt_loss: 1.4261 | pg_loss: 1.1203 | reg_loss: 0.9163 | reward: -0.3883 | rev_kl: 0.9128 | stu_lens: 25.5000 | mixed_lens: 25.5000 | lr: 6.4799e-07 | scale: 512.00 | time: 26.178 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    796/  1000| tot_loss: 2.6745 | rl_loss: 0.8397 | pt_loss: 1.8348 | pg_loss: 0.0414 | reg_loss: 0.7983 | reward: -0.0647 | rev_kl: 0.6117 | stu_lens: 91.0000 | mixed_lens: 128.0000 | lr: 6.4214e-07 | scale: 512.00 | time: 26.190 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    797/  1000| tot_loss: 3.3848 | rl_loss: 1.6370 | pt_loss: 1.7478 | pg_loss: 0.3861 | reg_loss: 1.2509 | reward: -0.3396 | rev_kl: 1.7917 | stu_lens: 31.0000 | mixed_lens: 35.5000 | lr: 6.3631e-07 | scale: 512.00 | time: 26.169 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    798/  1000| tot_loss: 3.1045 | rl_loss: 1.3176 | pt_loss: 1.7870 | pg_loss: 0.6415 | reg_loss: 0.6760 | reward: -0.4068 | rev_kl: 1.0517 | stu_lens: 79.0000 | mixed_lens: 71.5000 | lr: 6.3050e-07 | scale: 512.00 | time: 26.189 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    799/  1000| tot_loss: 2.9243 | rl_loss: 1.1322 | pt_loss: 1.7922 | pg_loss: 0.4534 | reg_loss: 0.6788 | reward: -1.4148 | rev_kl: 1.1732 | stu_lens: 55.0000 | mixed_lens: 66.5000 | lr: 6.2472e-07 | scale: 512.00 | time: 26.234 | step time: 0.000
                                 Evaluation #8                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Convert the above time to Pacific     │ Convert the above time to Pacific    │
│ Standard Time.                        │ Standard Time.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 02:30PM                              │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 1970-01-01T00:00:00Z                 │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 1970-01-01 00:00:00                  │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 15.546 | exact_match: 0.000 | rev_kl: 1.121 | lens: 82.478 | pt_loss: 1.087 | lm_loss: 1.178 | kd_loss: 0.996 
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    800/  1000| tot_loss: 2.1191 | rl_loss: 0.8717 | pt_loss: 1.2475 | pg_loss: 0.0300 | reg_loss: 0.8416 | reward: -0.2285 | rev_kl: 1.0994 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 6.1896e-07 | scale: 512.00 | time: 26.237 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    800/  1000| tot_loss: 3.1094 | rl_loss: 1.3961 | pt_loss: 1.7133 | pg_loss: 0.4218 | reg_loss: 0.9743 | reward: -0.4763 | rev_kl: 1.0471 | stu_lens: 80.3906 | mixed_lens: 80.9375 | lr: 6.1896e-07 | scale: 512.00 | time: 26.237 | step time: 27.470
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    801/  1000| tot_loss: 3.2470 | rl_loss: 1.8252 | pt_loss: 1.4218 | pg_loss: 0.4771 | reg_loss: 1.3481 | reward: -0.5652 | rev_kl: 1.4274 | stu_lens: 92.5000 | mixed_lens: 82.5000 | lr: 6.1323e-07 | scale: 512.00 | time: 26.194 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    802/  1000| tot_loss: 2.9833 | rl_loss: 1.3473 | pt_loss: 1.6360 | pg_loss: 0.2162 | reg_loss: 1.1311 | reward: -0.1654 | rev_kl: 2.0709 | stu_lens: 13.0000 | mixed_lens: 17.5000 | lr: 6.0751e-07 | scale: 512.00 | time: 26.169 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    803/  1000| tot_loss: 3.5385 | rl_loss: 1.8681 | pt_loss: 1.6704 | pg_loss: 0.6726 | reg_loss: 1.1955 | reward: -0.6313 | rev_kl: 1.3282 | stu_lens: 82.0000 | mixed_lens: 67.0000 | lr: 6.0182e-07 | scale: 512.00 | time: 26.229 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    804/  1000| tot_loss: 2.3052 | rl_loss: 0.7244 | pt_loss: 1.5808 | pg_loss: 0.1666 | reg_loss: 0.5578 | reward: -0.2231 | rev_kl: 1.0771 | stu_lens: 117.5000 | mixed_lens: 113.0000 | lr: 5.9615e-07 | scale: 512.00 | time: 26.212 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    805/  1000| tot_loss: 3.2238 | rl_loss: 1.3816 | pt_loss: 1.8423 | pg_loss: 0.3450 | reg_loss: 1.0366 | reward: -1.4904 | rev_kl: 1.1531 | stu_lens: 30.0000 | mixed_lens: 66.5000 | lr: 5.9051e-07 | scale: 512.00 | time: 26.203 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    806/  1000| tot_loss: 3.8127 | rl_loss: 1.6926 | pt_loss: 2.1201 | pg_loss: 1.0778 | reg_loss: 0.6148 | reward: -0.3883 | rev_kl: 0.9128 | stu_lens: 25.5000 | mixed_lens: 25.5000 | lr: 5.8489e-07 | scale: 512.00 | time: 26.176 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    807/  1000| tot_loss: 2.7672 | rl_loss: 1.0766 | pt_loss: 1.6906 | pg_loss: 0.5629 | reg_loss: 0.5137 | reward: 0.5928 | rev_kl: 0.9200 | stu_lens: 81.0000 | mixed_lens: 66.0000 | lr: 5.7929e-07 | scale: 512.00 | time: 26.205 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    808/  1000| tot_loss: 2.8525 | rl_loss: 1.0496 | pt_loss: 1.8029 | pg_loss: 0.4220 | reg_loss: 0.6276 | reward: -0.1163 | rev_kl: 0.8467 | stu_lens: 63.0000 | mixed_lens: 60.5000 | lr: 5.7372e-07 | scale: 512.00 | time: 26.140 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    809/  1000| tot_loss: 3.0943 | rl_loss: 1.6138 | pt_loss: 1.4805 | pg_loss: 0.4719 | reg_loss: 1.1419 | reward: -0.6287 | rev_kl: 2.0968 | stu_lens: 83.0000 | mixed_lens: 79.0000 | lr: 5.6817e-07 | scale: 512.00 | time: 26.130 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    810/  1000| tot_loss: 2.2041 | rl_loss: 0.4170 | pt_loss: 1.7871 | pg_loss: 0.0769 | reg_loss: 0.3401 | reward: -0.1381 | rev_kl: 1.6004 | stu_lens: 101.5000 | mixed_lens: 82.0000 | lr: 5.6264e-07 | scale: 512.00 | time: 26.101 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    811/  1000| tot_loss: 3.4050 | rl_loss: 1.2014 | pt_loss: 2.2036 | pg_loss: 0.6434 | reg_loss: 0.5580 | reward: -1.2514 | rev_kl: 1.1254 | stu_lens: 44.5000 | mixed_lens: 47.5000 | lr: 5.5714e-07 | scale: 512.00 | time: 26.176 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    812/  1000| tot_loss: 2.1982 | rl_loss: 0.8658 | pt_loss: 1.3324 | pg_loss: 0.1966 | reg_loss: 0.6692 | reward: -0.4726 | rev_kl: 1.3317 | stu_lens: 87.0000 | mixed_lens: 97.5000 | lr: 5.5166e-07 | scale: 512.00 | time: 26.181 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    813/  1000| tot_loss: 2.9281 | rl_loss: 0.9971 | pt_loss: 1.9310 | pg_loss: 0.0884 | reg_loss: 0.9088 | reward: -0.1578 | rev_kl: 0.9438 | stu_lens: 128.0000 | mixed_lens: 115.0000 | lr: 5.4620e-07 | scale: 512.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    814/  1000| tot_loss: 2.6319 | rl_loss: 1.0036 | pt_loss: 1.6283 | pg_loss: 0.3021 | reg_loss: 0.7015 | reward: -0.4601 | rev_kl: 0.9677 | stu_lens: 53.0000 | mixed_lens: 71.0000 | lr: 5.4077e-07 | scale: 512.00 | time: 26.162 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    815/  1000| tot_loss: 3.6221 | rl_loss: 2.1215 | pt_loss: 1.5006 | pg_loss: 0.8678 | reg_loss: 1.2537 | reward: -0.0930 | rev_kl: 0.4581 | stu_lens: 71.0000 | mixed_lens: 51.0000 | lr: 5.3536e-07 | scale: 512.00 | time: 26.181 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    816/  1000| tot_loss: 2.9217 | rl_loss: 1.3271 | pt_loss: 1.5946 | pg_loss: 0.4209 | reg_loss: 0.9061 | reward: -0.8787 | rev_kl: 1.0204 | stu_lens: 128.0000 | mixed_lens: 73.5000 | lr: 5.2997e-07 | scale: 512.00 | time: 26.152 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    816/  1000| tot_loss: 2.9512 | rl_loss: 1.2760 | pt_loss: 1.6752 | pg_loss: 0.4529 | reg_loss: 0.8232 | reward: -0.4775 | rev_kl: 1.1506 | stu_lens: 78.5781 | mixed_lens: 74.8438 | lr: 5.2997e-07 | scale: 512.00 | time: 26.152 | step time: 27.449
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    817/  1000| tot_loss: 2.8164 | rl_loss: 0.9519 | pt_loss: 1.8645 | pg_loss: 0.0646 | reg_loss: 0.8874 | reward: -0.3336 | rev_kl: 0.9984 | stu_lens: 99.5000 | mixed_lens: 128.0000 | lr: 5.2461e-07 | scale: 512.00 | time: 26.176 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    818/  1000| tot_loss: 2.8802 | rl_loss: 1.1512 | pt_loss: 1.7290 | pg_loss: 0.6820 | reg_loss: 0.4692 | reward: -0.5089 | rev_kl: 0.7808 | stu_lens: 42.5000 | mixed_lens: 47.5000 | lr: 5.1928e-07 | scale: 512.00 | time: 26.158 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    819/  1000| tot_loss: 2.6152 | rl_loss: 0.7522 | pt_loss: 1.8630 | pg_loss: 0.1588 | reg_loss: 0.5934 | reward: -0.2116 | rev_kl: 0.7538 | stu_lens: 128.0000 | mixed_lens: 108.0000 | lr: 5.1396e-07 | scale: 512.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    820/  1000| tot_loss: 2.9308 | rl_loss: 0.8338 | pt_loss: 2.0970 | pg_loss: 0.0902 | reg_loss: 0.7436 | reward: -0.1659 | rev_kl: 0.7374 | stu_lens: 50.5000 | mixed_lens: 98.0000 | lr: 5.0868e-07 | scale: 512.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    821/  1000| tot_loss: 2.8650 | rl_loss: 1.2016 | pt_loss: 1.6634 | pg_loss: 0.5390 | reg_loss: 0.6625 | reward: 0.4283 | rev_kl: 0.6869 | stu_lens: 71.0000 | mixed_lens: 57.0000 | lr: 5.0341e-07 | scale: 512.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    822/  1000| tot_loss: 2.1564 | rl_loss: 0.7715 | pt_loss: 1.3849 | pg_loss: 0.2976 | reg_loss: 0.4738 | reward: -0.3938 | rev_kl: 0.7639 | stu_lens: 104.0000 | mixed_lens: 96.0000 | lr: 4.9817e-07 | scale: 512.00 | time: 26.206 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    823/  1000| tot_loss: 2.2277 | rl_loss: 0.6807 | pt_loss: 1.5471 | pg_loss: 0.4520 | reg_loss: 0.2287 | reward: -0.5377 | rev_kl: 0.3614 | stu_lens: 71.0000 | mixed_lens: 75.5000 | lr: 4.9296e-07 | scale: 512.00 | time: 26.188 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    824/  1000| tot_loss: 3.2105 | rl_loss: 1.2656 | pt_loss: 1.9450 | pg_loss: 0.7193 | reg_loss: 0.5463 | reward: -0.6303 | rev_kl: 1.3643 | stu_lens: 79.0000 | mixed_lens: 58.5000 | lr: 4.8777e-07 | scale: 512.00 | time: 26.165 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    825/  1000| tot_loss: 3.2306 | rl_loss: 1.4550 | pt_loss: 1.7756 | pg_loss: 0.6405 | reg_loss: 0.8145 | reward: -1.2947 | rev_kl: 1.3321 | stu_lens: 63.0000 | mixed_lens: 57.5000 | lr: 4.8260e-07 | scale: 512.00 | time: 26.172 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    826/  1000| tot_loss: 2.5951 | rl_loss: 0.9750 | pt_loss: 1.6201 | pg_loss: 0.0846 | reg_loss: 0.8904 | reward: -0.3659 | rev_kl: 1.7957 | stu_lens: 84.5000 | mixed_lens: 112.5000 | lr: 4.7746e-07 | scale: 512.00 | time: 26.146 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    827/  1000| tot_loss: 3.8384 | rl_loss: 1.6711 | pt_loss: 2.1674 | pg_loss: 1.0280 | reg_loss: 0.6431 | reward: 0.3245 | rev_kl: 1.4238 | stu_lens: 61.5000 | mixed_lens: 37.5000 | lr: 4.7234e-07 | scale: 512.00 | time: 26.176 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    828/  1000| tot_loss: 2.2190 | rl_loss: 0.4347 | pt_loss: 1.7843 | pg_loss: 0.0190 | reg_loss: 0.4157 | reward: -0.8133 | rev_kl: 0.8383 | stu_lens: 73.0000 | mixed_lens: 50.5000 | lr: 4.6725e-07 | scale: 512.00 | time: 26.175 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    829/  1000| tot_loss: 2.7519 | rl_loss: 1.1631 | pt_loss: 1.5888 | pg_loss: 0.4709 | reg_loss: 0.6922 | reward: -1.3875 | rev_kl: 1.3284 | stu_lens: 66.5000 | mixed_lens: 65.0000 | lr: 4.6218e-07 | scale: 512.00 | time: 26.231 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    830/  1000| tot_loss: 2.9783 | rl_loss: 1.0311 | pt_loss: 1.9472 | pg_loss: 0.3860 | reg_loss: 0.6450 | reward: -0.3932 | rev_kl: 1.8413 | stu_lens: 64.5000 | mixed_lens: 82.0000 | lr: 4.5714e-07 | scale: 512.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    831/  1000| tot_loss: 3.4927 | rl_loss: 1.8486 | pt_loss: 1.6441 | pg_loss: 0.7224 | reg_loss: 1.1262 | reward: -0.6864 | rev_kl: 1.3720 | stu_lens: 106.0000 | mixed_lens: 63.5000 | lr: 4.5212e-07 | scale: 512.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    832/  1000| tot_loss: 2.5966 | rl_loss: 1.0421 | pt_loss: 1.5545 | pg_loss: 0.2160 | reg_loss: 0.8260 | reward: -0.3545 | rev_kl: 1.0149 | stu_lens: 125.0000 | mixed_lens: 101.5000 | lr: 4.4713e-07 | scale: 512.00 | time: 26.188 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    832/  1000| tot_loss: 2.8018 | rl_loss: 1.0647 | pt_loss: 1.7371 | pg_loss: 0.3923 | reg_loss: 0.6724 | reward: -0.5010 | rev_kl: 1.1183 | stu_lens: 75.8906 | mixed_lens: 78.4688 | lr: 4.4713e-07 | scale: 512.00 | time: 26.188 | step time: 27.461
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    833/  1000| tot_loss: 2.5670 | rl_loss: 1.0282 | pt_loss: 1.5389 | pg_loss: 0.3188 | reg_loss: 0.7094 | reward: -0.3633 | rev_kl: 1.1877 | stu_lens: 112.0000 | mixed_lens: 80.0000 | lr: 4.4216e-07 | scale: 512.00 | time: 26.167 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    834/  1000| tot_loss: 3.1380 | rl_loss: 1.1673 | pt_loss: 1.9707 | pg_loss: 0.0405 | reg_loss: 1.1268 | reward: -0.2269 | rev_kl: 1.2100 | stu_lens: 75.0000 | mixed_lens: 128.0000 | lr: 4.3722e-07 | scale: 512.00 | time: 26.202 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    835/  1000| tot_loss: 3.1960 | rl_loss: 1.6576 | pt_loss: 1.5384 | pg_loss: 0.2186 | reg_loss: 1.4391 | reward: -0.2891 | rev_kl: 1.3376 | stu_lens: 104.5000 | mixed_lens: 108.5000 | lr: 4.3230e-07 | scale: 512.00 | time: 26.190 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    836/  1000| tot_loss: 3.0962 | rl_loss: 2.2064 | pt_loss: 0.8898 | pg_loss: 0.7399 | reg_loss: 1.4665 | reward: 0.5549 | rev_kl: 1.2255 | stu_lens: 24.0000 | mixed_lens: 42.5000 | lr: 4.2741e-07 | scale: 512.00 | time: 26.158 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    837/  1000| tot_loss: 3.3566 | rl_loss: 1.7757 | pt_loss: 1.5809 | pg_loss: 0.7820 | reg_loss: 0.9937 | reward: -1.1942 | rev_kl: 0.8799 | stu_lens: 103.5000 | mixed_lens: 46.5000 | lr: 4.2254e-07 | scale: 512.00 | time: 26.196 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    838/  1000| tot_loss: 3.3169 | rl_loss: 1.3999 | pt_loss: 1.9170 | pg_loss: 0.9862 | reg_loss: 0.4137 | reward: -0.1851 | rev_kl: 0.1877 | stu_lens: 18.5000 | mixed_lens: 22.0000 | lr: 4.1770e-07 | scale: 512.00 | time: 26.179 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    839/  1000| tot_loss: 3.4629 | rl_loss: 1.7251 | pt_loss: 1.7378 | pg_loss: 0.2990 | reg_loss: 1.4261 | reward: -0.4522 | rev_kl: 1.5903 | stu_lens: 77.5000 | mixed_lens: 87.5000 | lr: 4.1288e-07 | scale: 512.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    840/  1000| tot_loss: 2.8102 | rl_loss: 1.0011 | pt_loss: 1.8090 | pg_loss: 0.0306 | reg_loss: 0.9706 | reward: -0.2619 | rev_kl: 0.6890 | stu_lens: 126.5000 | mixed_lens: 128.0000 | lr: 4.0809e-07 | scale: 512.00 | time: 26.166 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    841/  1000| tot_loss: 3.0782 | rl_loss: 1.4430 | pt_loss: 1.6353 | pg_loss: 0.0366 | reg_loss: 1.4064 | reward: -0.1623 | rev_kl: 0.9656 | stu_lens: 105.0000 | mixed_lens: 128.0000 | lr: 4.0332e-07 | scale: 512.00 | time: 26.214 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    842/  1000| tot_loss: 3.6534 | rl_loss: 1.8539 | pt_loss: 1.7995 | pg_loss: 0.6400 | reg_loss: 1.2139 | reward: -0.6672 | rev_kl: 0.8000 | stu_lens: 75.0000 | mixed_lens: 73.0000 | lr: 3.9858e-07 | scale: 512.00 | time: 26.193 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    843/  1000| tot_loss: 3.1402 | rl_loss: 1.6939 | pt_loss: 1.4462 | pg_loss: 0.2477 | reg_loss: 1.4462 | reward: -0.4213 | rev_kl: 0.7512 | stu_lens: 128.0000 | mixed_lens: 92.5000 | lr: 3.9387e-07 | scale: 512.00 | time: 26.219 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    844/  1000| tot_loss: 3.0156 | rl_loss: 1.2128 | pt_loss: 1.8028 | pg_loss: 0.0554 | reg_loss: 1.1573 | reward: -0.3311 | rev_kl: 0.9013 | stu_lens: 104.5000 | mixed_lens: 128.0000 | lr: 3.8918e-07 | scale: 512.00 | time: 26.154 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    845/  1000| tot_loss: 3.4764 | rl_loss: 1.7526 | pt_loss: 1.7238 | pg_loss: 0.3770 | reg_loss: 1.3755 | reward: -0.3877 | rev_kl: 1.1870 | stu_lens: 92.5000 | mixed_lens: 78.0000 | lr: 3.8452e-07 | scale: 512.00 | time: 26.195 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    846/  1000| tot_loss: 5.3446 | rl_loss: 4.1028 | pt_loss: 1.2418 | pg_loss: 2.0665 | reg_loss: 2.0363 | reward: -2.6790 | rev_kl: 1.5459 | stu_lens: 10.0000 | mixed_lens: 11.0000 | lr: 3.7988e-07 | scale: 512.00 | time: 26.156 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    847/  1000| tot_loss: 3.3885 | rl_loss: 1.6091 | pt_loss: 1.7794 | pg_loss: 0.5137 | reg_loss: 1.0953 | reward: -0.4289 | rev_kl: 0.4598 | stu_lens: 71.0000 | mixed_lens: 71.0000 | lr: 3.7527e-07 | scale: 512.00 | time: 26.206 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    848/  1000| tot_loss: 2.7002 | rl_loss: 1.0615 | pt_loss: 1.6387 | pg_loss: 0.0613 | reg_loss: 1.0002 | reward: -0.2117 | rev_kl: 1.2486 | stu_lens: 86.0000 | mixed_lens: 126.5000 | lr: 3.7068e-07 | scale: 512.00 | time: 26.262 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    848/  1000| tot_loss: 3.3904 | rl_loss: 1.6817 | pt_loss: 1.7087 | pg_loss: 0.4217 | reg_loss: 1.2600 | reward: -0.5968 | rev_kl: 1.0332 | stu_lens: 86.9844 | mixed_lens: 86.5781 | lr: 3.7068e-07 | scale: 512.00 | time: 26.262 | step time: 27.459
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    849/  1000| tot_loss: 2.3577 | rl_loss: 0.6645 | pt_loss: 1.6932 | pg_loss: 0.0461 | reg_loss: 0.6184 | reward: -0.1113 | rev_kl: 0.7695 | stu_lens: 98.0000 | mixed_lens: 128.0000 | lr: 3.6612e-07 | scale: 512.00 | time: 26.238 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    850/  1000| tot_loss: 3.3860 | rl_loss: 1.6371 | pt_loss: 1.7489 | pg_loss: 0.3646 | reg_loss: 1.2725 | reward: -0.4952 | rev_kl: 0.8335 | stu_lens: 75.0000 | mixed_lens: 69.5000 | lr: 3.6159e-07 | scale: 512.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    851/  1000| tot_loss: 3.8321 | rl_loss: 2.1084 | pt_loss: 1.7237 | pg_loss: 0.5829 | reg_loss: 1.5254 | reward: -0.5287 | rev_kl: 0.4997 | stu_lens: 45.0000 | mixed_lens: 66.5000 | lr: 3.5708e-07 | scale: 512.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    852/  1000| tot_loss: 2.8223 | rl_loss: 1.0441 | pt_loss: 1.7782 | pg_loss: 0.1815 | reg_loss: 0.8625 | reward: -0.2902 | rev_kl: 1.0801 | stu_lens: 94.5000 | mixed_lens: 103.5000 | lr: 3.5260e-07 | scale: 512.00 | time: 26.188 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    853/  1000| tot_loss: 3.4747 | rl_loss: 1.6414 | pt_loss: 1.8333 | pg_loss: 0.0018 | reg_loss: 1.6395 | reward: -0.4643 | rev_kl: 1.4566 | stu_lens: 88.0000 | mixed_lens: 128.0000 | lr: 3.4814e-07 | scale: 512.00 | time: 26.212 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    854/  1000| tot_loss: 2.8369 | rl_loss: 1.1256 | pt_loss: 1.7112 | pg_loss: 0.1921 | reg_loss: 0.9336 | reward: -0.3435 | rev_kl: 0.8290 | stu_lens: 124.5000 | mixed_lens: 98.5000 | lr: 3.4372e-07 | scale: 512.00 | time: 26.188 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    855/  1000| tot_loss: 2.8769 | rl_loss: 1.3131 | pt_loss: 1.5638 | pg_loss: 0.0635 | reg_loss: 1.2496 | reward: -0.2726 | rev_kl: 0.6533 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 3.3931e-07 | scale: 512.00 | time: 26.191 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    856/  1000| tot_loss: 3.2221 | rl_loss: 1.6329 | pt_loss: 1.5892 | pg_loss: 0.3614 | reg_loss: 1.2716 | reward: -0.3275 | rev_kl: 0.9764 | stu_lens: 101.5000 | mixed_lens: 93.0000 | lr: 3.3494e-07 | scale: 512.00 | time: 26.172 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    857/  1000| tot_loss: 3.3765 | rl_loss: 1.6223 | pt_loss: 1.7542 | pg_loss: 0.5865 | reg_loss: 1.0358 | reward: -0.6958 | rev_kl: 1.0412 | stu_lens: 60.5000 | mixed_lens: 64.0000 | lr: 3.3059e-07 | scale: 512.00 | time: 26.255 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    858/  1000| tot_loss: 2.9032 | rl_loss: 1.2304 | pt_loss: 1.6728 | pg_loss: 0.0988 | reg_loss: 1.1316 | reward: -0.4033 | rev_kl: 1.5403 | stu_lens: 69.0000 | mixed_lens: 92.5000 | lr: 3.2626e-07 | scale: 512.00 | time: 26.220 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    859/  1000| tot_loss: 2.6621 | rl_loss: 0.9799 | pt_loss: 1.6822 | pg_loss: 0.2375 | reg_loss: 0.7423 | reward: -0.3115 | rev_kl: 1.3530 | stu_lens: 42.0000 | mixed_lens: 87.5000 | lr: 3.2197e-07 | scale: 512.00 | time: 26.239 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    860/  1000| tot_loss: 3.1147 | rl_loss: 1.5099 | pt_loss: 1.6047 | pg_loss: 0.2355 | reg_loss: 1.2745 | reward: -0.4374 | rev_kl: 1.3841 | stu_lens: 117.5000 | mixed_lens: 98.5000 | lr: 3.1769e-07 | scale: 512.00 | time: 26.199 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    861/  1000| tot_loss: 3.8741 | rl_loss: 1.9405 | pt_loss: 1.9336 | pg_loss: 0.4992 | reg_loss: 1.4413 | reward: -2.6707 | rev_kl: 1.9730 | stu_lens: 28.5000 | mixed_lens: 38.5000 | lr: 3.1345e-07 | scale: 512.00 | time: 26.204 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    862/  1000| tot_loss: 2.1859 | rl_loss: 0.9192 | pt_loss: 1.2667 | pg_loss: 0.0329 | reg_loss: 0.8863 | reward: -0.2865 | rev_kl: 1.0230 | stu_lens: 126.5000 | mixed_lens: 128.0000 | lr: 3.0923e-07 | scale: 512.00 | time: 26.169 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    863/  1000| tot_loss: 2.7404 | rl_loss: 0.9641 | pt_loss: 1.7763 | pg_loss: 0.1576 | reg_loss: 0.8065 | reward: -0.4459 | rev_kl: 0.8729 | stu_lens: 126.0000 | mixed_lens: 105.5000 | lr: 3.0504e-07 | scale: 512.00 | time: 26.195 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    864/  1000| tot_loss: 3.6856 | rl_loss: 1.6992 | pt_loss: 1.9865 | pg_loss: 0.2930 | reg_loss: 1.4062 | reward: -0.4231 | rev_kl: 1.1913 | stu_lens: 116.5000 | mixed_lens: 93.0000 | lr: 3.0088e-07 | scale: 512.00 | time: 26.175 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    864/  1000| tot_loss: 3.1688 | rl_loss: 1.4390 | pt_loss: 1.7298 | pg_loss: 0.3487 | reg_loss: 1.0904 | reward: -0.5973 | rev_kl: 1.0575 | stu_lens: 85.2500 | mixed_lens: 88.1875 | lr: 3.0088e-07 | scale: 512.00 | time: 26.175 | step time: 27.473
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    865/  1000| tot_loss: 3.3149 | rl_loss: 1.5761 | pt_loss: 1.7388 | pg_loss: 0.6676 | reg_loss: 0.9084 | reward: -0.4977 | rev_kl: 0.5343 | stu_lens: 33.5000 | mixed_lens: 31.5000 | lr: 2.9674e-07 | scale: 512.00 | time: 26.206 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    866/  1000| tot_loss: 2.5095 | rl_loss: 0.8525 | pt_loss: 1.6570 | pg_loss: 0.2421 | reg_loss: 0.6105 | reward: -3.4047 | rev_kl: 1.0476 | stu_lens: 64.0000 | mixed_lens: 65.5000 | lr: 2.9263e-07 | scale: 512.00 | time: 26.182 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    867/  1000| tot_loss: 2.4495 | rl_loss: 0.8100 | pt_loss: 1.6395 | pg_loss: 0.1431 | reg_loss: 0.6669 | reward: -0.2812 | rev_kl: 0.5960 | stu_lens: 94.5000 | mixed_lens: 98.0000 | lr: 2.8855e-07 | scale: 512.00 | time: 26.242 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    868/  1000| tot_loss: 3.9906 | rl_loss: 1.9809 | pt_loss: 2.0097 | pg_loss: 1.2365 | reg_loss: 0.7444 | reward: -0.4385 | rev_kl: 0.6338 | stu_lens: 32.0000 | mixed_lens: 37.5000 | lr: 2.8449e-07 | scale: 512.00 | time: 26.216 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    869/  1000| tot_loss: 2.9712 | rl_loss: 1.4716 | pt_loss: 1.4996 | pg_loss: 0.4709 | reg_loss: 1.0007 | reward: -0.4468 | rev_kl: 1.1918 | stu_lens: 88.5000 | mixed_lens: 76.0000 | lr: 2.8046e-07 | scale: 512.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    870/  1000| tot_loss: 2.9112 | rl_loss: 1.5874 | pt_loss: 1.3238 | pg_loss: 0.1970 | reg_loss: 1.3904 | reward: -0.4214 | rev_kl: 0.8508 | stu_lens: 106.5000 | mixed_lens: 101.5000 | lr: 2.7646e-07 | scale: 512.00 | time: 26.186 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    871/  1000| tot_loss: 2.3867 | rl_loss: 0.9236 | pt_loss: 1.4631 | pg_loss: 0.2486 | reg_loss: 0.6750 | reward: -0.3618 | rev_kl: 0.8017 | stu_lens: 66.5000 | mixed_lens: 66.5000 | lr: 2.7248e-07 | scale: 512.00 | time: 26.196 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    872/  1000| tot_loss: 2.1285 | rl_loss: 0.6436 | pt_loss: 1.4849 | pg_loss: 0.0990 | reg_loss: 0.5445 | reward: -0.2478 | rev_kl: 0.6456 | stu_lens: 91.5000 | mixed_lens: 103.5000 | lr: 2.6854e-07 | scale: 512.00 | time: 26.179 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    873/  1000| tot_loss: 3.3073 | rl_loss: 1.3096 | pt_loss: 1.9977 | pg_loss: 0.2228 | reg_loss: 1.0868 | reward: -0.3008 | rev_kl: 1.0340 | stu_lens: 87.5000 | mixed_lens: 96.5000 | lr: 2.6461e-07 | scale: 512.00 | time: 26.190 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    874/  1000| tot_loss: 2.5672 | rl_loss: 0.6336 | pt_loss: 1.9336 | pg_loss: 0.1541 | reg_loss: 0.4796 | reward: -0.4337 | rev_kl: 1.3114 | stu_lens: 85.5000 | mixed_lens: 103.5000 | lr: 2.6072e-07 | scale: 512.00 | time: 26.152 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    875/  1000| tot_loss: 3.0979 | rl_loss: 1.3809 | pt_loss: 1.7170 | pg_loss: 0.2781 | reg_loss: 1.1029 | reward: -0.5556 | rev_kl: 1.0893 | stu_lens: 81.0000 | mixed_lens: 90.0000 | lr: 2.5685e-07 | scale: 512.00 | time: 26.188 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    876/  1000| tot_loss: 2.8104 | rl_loss: 1.2033 | pt_loss: 1.6071 | pg_loss: 0.0814 | reg_loss: 1.1219 | reward: -0.4874 | rev_kl: 0.9814 | stu_lens: 105.0000 | mixed_lens: 96.0000 | lr: 2.5301e-07 | scale: 512.00 | time: 26.188 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    877/  1000| tot_loss: 3.7354 | rl_loss: 1.6543 | pt_loss: 2.0811 | pg_loss: 0.1873 | reg_loss: 1.4670 | reward: -0.5407 | rev_kl: 1.5589 | stu_lens: 87.0000 | mixed_lens: 98.5000 | lr: 2.4920e-07 | scale: 512.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    878/  1000| tot_loss: 2.8738 | rl_loss: 1.2427 | pt_loss: 1.6311 | pg_loss: 0.0830 | reg_loss: 1.1597 | reward: -0.1644 | rev_kl: 1.0520 | stu_lens: 128.0000 | mixed_lens: 117.5000 | lr: 2.4542e-07 | scale: 512.00 | time: 26.205 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    879/  1000| tot_loss: 3.1294 | rl_loss: 1.2987 | pt_loss: 1.8308 | pg_loss: 0.3858 | reg_loss: 0.9128 | reward: -1.3353 | rev_kl: 1.2777 | stu_lens: 66.5000 | mixed_lens: 70.0000 | lr: 2.4166e-07 | scale: 512.00 | time: 26.211 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    880/  1000| tot_loss: 2.7355 | rl_loss: 0.9491 | pt_loss: 1.7864 | pg_loss: 0.1715 | reg_loss: 0.7776 | reward: -0.3986 | rev_kl: 0.5387 | stu_lens: 71.0000 | mixed_lens: 71.0000 | lr: 2.3793e-07 | scale: 512.00 | time: 26.174 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    880/  1000| tot_loss: 2.9607 | rl_loss: 1.2489 | pt_loss: 1.7118 | pg_loss: 0.2986 | reg_loss: 0.9503 | reward: -0.5888 | rev_kl: 1.0257 | stu_lens: 81.1250 | mixed_lens: 85.0156 | lr: 2.3793e-07 | scale: 512.00 | time: 26.174 | step time: 27.463
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    881/  1000| tot_loss: 2.8243 | rl_loss: 0.9938 | pt_loss: 1.8306 | pg_loss: 0.1175 | reg_loss: 0.8763 | reward: -0.3860 | rev_kl: 0.9571 | stu_lens: 94.5000 | mixed_lens: 101.5000 | lr: 2.3423e-07 | scale: 512.00 | time: 26.196 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    882/  1000| tot_loss: 1.8470 | rl_loss: 0.5705 | pt_loss: 1.2765 | pg_loss: 0.0419 | reg_loss: 0.5286 | reward: -0.1937 | rev_kl: 0.8196 | stu_lens: 96.5000 | mixed_lens: 128.0000 | lr: 2.3056e-07 | scale: 512.00 | time: 26.159 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    883/  1000| tot_loss: 3.5212 | rl_loss: 1.7756 | pt_loss: 1.7455 | pg_loss: 0.4655 | reg_loss: 1.3101 | reward: -0.6525 | rev_kl: 1.1316 | stu_lens: 68.0000 | mixed_lens: 73.0000 | lr: 2.2691e-07 | scale: 512.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    884/  1000| tot_loss: 3.1260 | rl_loss: 1.6099 | pt_loss: 1.5161 | pg_loss: 0.4209 | reg_loss: 1.1890 | reward: -1.0567 | rev_kl: 1.1488 | stu_lens: 107.0000 | mixed_lens: 63.5000 | lr: 2.2329e-07 | scale: 512.00 | time: 26.181 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    885/  1000| tot_loss: 3.0045 | rl_loss: 0.7926 | pt_loss: 2.2120 | pg_loss: 0.0267 | reg_loss: 0.7658 | reward: -0.2646 | rev_kl: 0.8387 | stu_lens: 110.5000 | mixed_lens: 122.0000 | lr: 2.1970e-07 | scale: 512.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    886/  1000| tot_loss: 3.5439 | rl_loss: 1.4898 | pt_loss: 2.0540 | pg_loss: 0.3981 | reg_loss: 1.0918 | reward: -2.9821 | rev_kl: 2.7082 | stu_lens: 26.5000 | mixed_lens: 45.5000 | lr: 2.1614e-07 | scale: 512.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    887/  1000| tot_loss: 2.6532 | rl_loss: 0.8148 | pt_loss: 1.8384 | pg_loss: 0.0120 | reg_loss: 0.8028 | reward: -0.0731 | rev_kl: 1.0356 | stu_lens: 92.5000 | mixed_lens: 124.5000 | lr: 2.1260e-07 | scale: 512.00 | time: 26.236 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    888/  1000| tot_loss: 3.1739 | rl_loss: 1.3753 | pt_loss: 1.7985 | pg_loss: 0.5677 | reg_loss: 0.8076 | reward: -0.2871 | rev_kl: 0.8484 | stu_lens: 54.0000 | mixed_lens: 72.0000 | lr: 2.0909e-07 | scale: 512.00 | time: 26.191 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    889/  1000| tot_loss: 2.6981 | rl_loss: 1.2581 | pt_loss: 1.4400 | pg_loss: 0.9444 | reg_loss: 0.3137 | reward: -0.1851 | rev_kl: 0.1877 | stu_lens: 18.5000 | mixed_lens: 22.0000 | lr: 2.0561e-07 | scale: 512.00 | time: 26.190 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    890/  1000| tot_loss: 2.3545 | rl_loss: 1.0198 | pt_loss: 1.3347 | pg_loss: 0.0112 | reg_loss: 1.0086 | reward: -0.2689 | rev_kl: 1.2648 | stu_lens: 76.5000 | mixed_lens: 126.5000 | lr: 2.0216e-07 | scale: 512.00 | time: 26.169 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    891/  1000| tot_loss: 2.9930 | rl_loss: 1.1929 | pt_loss: 1.8001 | pg_loss: 0.2191 | reg_loss: 0.9738 | reward: -1.3624 | rev_kl: 0.9584 | stu_lens: 71.5000 | mixed_lens: 76.0000 | lr: 1.9874e-07 | scale: 512.00 | time: 26.210 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    892/  1000| tot_loss: 3.0073 | rl_loss: 1.2366 | pt_loss: 1.7707 | pg_loss: 0.2357 | reg_loss: 1.0009 | reward: -0.5978 | rev_kl: 0.6692 | stu_lens: 128.0000 | mixed_lens: 96.0000 | lr: 1.9534e-07 | scale: 512.00 | time: 26.164 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    893/  1000| tot_loss: 3.0998 | rl_loss: 1.4635 | pt_loss: 1.6363 | pg_loss: 0.5612 | reg_loss: 0.9023 | reward: -0.3768 | rev_kl: 1.1164 | stu_lens: 122.0000 | mixed_lens: 67.0000 | lr: 1.9197e-07 | scale: 512.00 | time: 26.207 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    894/  1000| tot_loss: 3.1538 | rl_loss: 1.5028 | pt_loss: 1.6510 | pg_loss: 0.5542 | reg_loss: 0.9487 | reward: -0.4155 | rev_kl: 1.6474 | stu_lens: 68.5000 | mixed_lens: 73.0000 | lr: 1.8863e-07 | scale: 512.00 | time: 26.224 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    895/  1000| tot_loss: 3.3198 | rl_loss: 1.5504 | pt_loss: 1.7695 | pg_loss: 0.8027 | reg_loss: 0.7477 | reward: -0.7001 | rev_kl: 1.0997 | stu_lens: 61.5000 | mixed_lens: 58.5000 | lr: 1.8532e-07 | scale: 512.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    896/  1000| tot_loss: 3.2981 | rl_loss: 1.2714 | pt_loss: 2.0267 | pg_loss: 0.6759 | reg_loss: 0.5955 | reward: -3.4039 | rev_kl: 0.8509 | stu_lens: 62.5000 | mixed_lens: 38.0000 | lr: 1.8204e-07 | scale: 512.00 | time: 26.191 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    896/  1000| tot_loss: 2.8775 | rl_loss: 1.1763 | pt_loss: 1.7013 | pg_loss: 0.3133 | reg_loss: 0.8630 | reward: -0.5874 | rev_kl: 1.0437 | stu_lens: 85.9219 | mixed_lens: 86.2500 | lr: 1.8204e-07 | scale: 512.00 | time: 26.191 | step time: 27.468
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    897/  1000| tot_loss: 2.5370 | rl_loss: 0.7979 | pt_loss: 1.7391 | pg_loss: 0.0950 | reg_loss: 0.7029 | reward: -0.4294 | rev_kl: 0.9841 | stu_lens: 90.0000 | mixed_lens: 102.0000 | lr: 1.7879e-07 | scale: 512.00 | time: 26.208 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    898/  1000| tot_loss: 3.6444 | rl_loss: 1.6477 | pt_loss: 1.9966 | pg_loss: 0.3876 | reg_loss: 1.2602 | reward: -0.6687 | rev_kl: 1.1080 | stu_lens: 128.0000 | mixed_lens: 77.0000 | lr: 1.7556e-07 | scale: 512.00 | time: 26.298 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    899/  1000| tot_loss: 3.3676 | rl_loss: 1.6082 | pt_loss: 1.7594 | pg_loss: 0.0447 | reg_loss: 1.5635 | reward: -0.3401 | rev_kl: 1.0063 | stu_lens: 106.0000 | mixed_lens: 128.0000 | lr: 1.7236e-07 | scale: 512.00 | time: 26.257 | step time: 0.000
                                 Evaluation #9                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Convert the above time to Pacific     │ Convert the above time to Pacific    │
│ Standard Time.                        │ Standard Time.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 11:13 PM PST                         │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 0 seconds is an illegal value for a  │
│                                       │ timestamp in unix epoch time, so     │
│                                       │ there is no way to represent 0       │
│                                       │ seconds as a timestamp.              │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 1970-01-01T00:00:00Z                 │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 16.084 | exact_match: 0.000 | rev_kl: 1.119 | lens: 81.272 | pt_loss: 1.087 | lm_loss: 1.178 | kd_loss: 0.996 
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    900/  1000| tot_loss: 2.9312 | rl_loss: 1.4005 | pt_loss: 1.5307 | pg_loss: 0.3727 | reg_loss: 1.0278 | reward: -0.3796 | rev_kl: 1.1627 | stu_lens: 67.5000 | mixed_lens: 79.0000 | lr: 1.6919e-07 | scale: 512.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    901/  1000| tot_loss: 3.2177 | rl_loss: 1.3090 | pt_loss: 1.9087 | pg_loss: 0.3231 | reg_loss: 0.9859 | reward: -0.6503 | rev_kl: 1.1851 | stu_lens: 91.0000 | mixed_lens: 67.0000 | lr: 1.6605e-07 | scale: 512.00 | time: 26.232 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    902/  1000| tot_loss: 3.4209 | rl_loss: 1.3832 | pt_loss: 2.0377 | pg_loss: 0.0294 | reg_loss: 1.3538 | reward: -0.3291 | rev_kl: 1.5141 | stu_lens: 99.5000 | mixed_lens: 128.0000 | lr: 1.6294e-07 | scale: 512.00 | time: 26.198 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    903/  1000| tot_loss: 2.4003 | rl_loss: 0.8406 | pt_loss: 1.5597 | pg_loss: 0.3189 | reg_loss: 0.5217 | reward: -0.0757 | rev_kl: 0.7510 | stu_lens: 72.5000 | mixed_lens: 71.0000 | lr: 1.5985e-07 | scale: 512.00 | time: 26.154 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    904/  1000| tot_loss: 3.1949 | rl_loss: 1.2307 | pt_loss: 1.9641 | pg_loss: 0.5384 | reg_loss: 0.6923 | reward: -0.8825 | rev_kl: 1.1086 | stu_lens: 68.5000 | mixed_lens: 68.5000 | lr: 1.5680e-07 | scale: 512.00 | time: 26.207 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    905/  1000| tot_loss: 2.5357 | rl_loss: 0.7620 | pt_loss: 1.7736 | pg_loss: 0.1758 | reg_loss: 0.5863 | reward: 1.0083 | rev_kl: 0.5468 | stu_lens: 9.0000 | mixed_lens: 67.0000 | lr: 1.5377e-07 | scale: 512.00 | time: 26.191 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    906/  1000| tot_loss: 3.9148 | rl_loss: 2.5665 | pt_loss: 1.3484 | pg_loss: 0.9914 | reg_loss: 1.5751 | reward: -0.5957 | rev_kl: 0.7054 | stu_lens: 68.0000 | mixed_lens: 39.0000 | lr: 1.5077e-07 | scale: 512.00 | time: 26.190 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    907/  1000| tot_loss: 3.0267 | rl_loss: 1.2227 | pt_loss: 1.8040 | pg_loss: 0.3020 | reg_loss: 0.9207 | reward: -0.1863 | rev_kl: 2.1279 | stu_lens: 128.0000 | mixed_lens: 81.0000 | lr: 1.4780e-07 | scale: 512.00 | time: 26.156 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    908/  1000| tot_loss: 3.1350 | rl_loss: 1.4527 | pt_loss: 1.6822 | pg_loss: 0.0780 | reg_loss: 1.3747 | reward: -0.2787 | rev_kl: 1.2547 | stu_lens: 76.0000 | mixed_lens: 121.5000 | lr: 1.4486e-07 | scale: 512.00 | time: 26.153 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    909/  1000| tot_loss: 4.5216 | rl_loss: 2.7312 | pt_loss: 1.7904 | pg_loss: 1.3292 | reg_loss: 1.4020 | reward: -0.5813 | rev_kl: 1.8054 | stu_lens: 30.5000 | mixed_lens: 23.0000 | lr: 1.4194e-07 | scale: 512.00 | time: 26.138 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    910/  1000| tot_loss: 2.2508 | rl_loss: 1.0883 | pt_loss: 1.1625 | pg_loss: 0.2158 | reg_loss: 0.8725 | reward: -0.2897 | rev_kl: 0.4801 | stu_lens: 75.0000 | mixed_lens: 90.0000 | lr: 1.3906e-07 | scale: 512.00 | time: 26.151 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    911/  1000| tot_loss: 3.0362 | rl_loss: 1.3266 | pt_loss: 1.7096 | pg_loss: 0.0836 | reg_loss: 1.2430 | reward: -0.2959 | rev_kl: 1.0381 | stu_lens: 107.0000 | mixed_lens: 123.0000 | lr: 1.3620e-07 | scale: 512.00 | time: 26.169 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    912/  1000| tot_loss: 3.3277 | rl_loss: 1.4322 | pt_loss: 1.8955 | pg_loss: 0.2890 | reg_loss: 1.1432 | reward: -0.8497 | rev_kl: 0.6789 | stu_lens: 47.5000 | mixed_lens: 73.5000 | lr: 1.3338e-07 | scale: 512.00 | time: 26.210 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    912/  1000| tot_loss: 3.2562 | rl_loss: 1.5169 | pt_loss: 1.7393 | pg_loss: 0.3782 | reg_loss: 1.1387 | reward: -0.4756 | rev_kl: 1.0934 | stu_lens: 83.9062 | mixed_lens: 83.2031 | lr: 1.3338e-07 | scale: 512.00 | time: 26.210 | step time: 27.459
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    913/  1000| tot_loss: 3.6160 | rl_loss: 1.5589 | pt_loss: 2.0571 | pg_loss: 0.3954 | reg_loss: 1.1635 | reward: -0.2024 | rev_kl: 1.0868 | stu_lens: 124.5000 | mixed_lens: 91.0000 | lr: 1.3058e-07 | scale: 512.00 | time: 26.198 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    914/  1000| tot_loss: 2.4534 | rl_loss: 0.8812 | pt_loss: 1.5722 | pg_loss: 0.2179 | reg_loss: 0.6633 | reward: -0.3332 | rev_kl: 0.5881 | stu_lens: 87.5000 | mixed_lens: 59.5000 | lr: 1.2781e-07 | scale: 512.00 | time: 26.185 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    915/  1000| tot_loss: 3.4569 | rl_loss: 1.6633 | pt_loss: 1.7936 | pg_loss: 0.4969 | reg_loss: 1.1664 | reward: -0.8866 | rev_kl: 0.6448 | stu_lens: 68.0000 | mixed_lens: 73.5000 | lr: 1.2507e-07 | scale: 512.00 | time: 26.163 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    916/  1000| tot_loss: 3.5766 | rl_loss: 2.1472 | pt_loss: 1.4293 | pg_loss: 0.7038 | reg_loss: 1.4434 | reward: -0.5631 | rev_kl: 1.0800 | stu_lens: 30.5000 | mixed_lens: 53.5000 | lr: 1.2236e-07 | scale: 512.00 | time: 26.158 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    917/  1000| tot_loss: 2.8849 | rl_loss: 1.1228 | pt_loss: 1.7621 | pg_loss: 0.3649 | reg_loss: 0.7579 | reward: 0.9190 | rev_kl: 0.6694 | stu_lens: 66.5000 | mixed_lens: 37.0000 | lr: 1.1968e-07 | scale: 512.00 | time: 26.124 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    918/  1000| tot_loss: 4.4403 | rl_loss: 2.1603 | pt_loss: 2.2800 | pg_loss: 0.8562 | reg_loss: 1.3041 | reward: -0.6381 | rev_kl: 1.5747 | stu_lens: 29.0000 | mixed_lens: 23.0000 | lr: 1.1702e-07 | scale: 512.00 | time: 26.163 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    919/  1000| tot_loss: 3.0797 | rl_loss: 1.5269 | pt_loss: 1.5528 | pg_loss: 0.0110 | reg_loss: 1.5160 | reward: -0.3240 | rev_kl: 1.2766 | stu_lens: 103.5000 | mixed_lens: 128.0000 | lr: 1.1440e-07 | scale: 512.00 | time: 26.137 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    920/  1000| tot_loss: 3.3313 | rl_loss: 1.3804 | pt_loss: 1.9509 | pg_loss: 0.2769 | reg_loss: 1.1035 | reward: -0.3154 | rev_kl: 0.9198 | stu_lens: 93.0000 | mixed_lens: 97.0000 | lr: 1.1180e-07 | scale: 512.00 | time: 26.230 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    921/  1000| tot_loss: 3.0728 | rl_loss: 0.8168 | pt_loss: 2.2560 | pg_loss: 0.0147 | reg_loss: 0.8022 | reward: -0.2036 | rev_kl: 1.6078 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 1.0924e-07 | scale: 512.00 | time: 26.190 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    922/  1000| tot_loss: 2.7929 | rl_loss: 1.3215 | pt_loss: 1.4714 | pg_loss: 0.2094 | reg_loss: 1.1121 | reward: -1.0340 | rev_kl: 1.1888 | stu_lens: 76.5000 | mixed_lens: 68.5000 | lr: 1.0670e-07 | scale: 512.00 | time: 26.237 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    923/  1000| tot_loss: 2.7869 | rl_loss: 1.2174 | pt_loss: 1.5695 | pg_loss: 0.0014 | reg_loss: 1.2160 | reward: -0.1732 | rev_kl: 1.4066 | stu_lens: 99.5000 | mixed_lens: 128.0000 | lr: 1.0419e-07 | scale: 512.00 | time: 26.180 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    924/  1000| tot_loss: 3.4700 | rl_loss: 1.7194 | pt_loss: 1.7505 | pg_loss: 0.3532 | reg_loss: 1.3662 | reward: -0.2291 | rev_kl: 0.7970 | stu_lens: 62.0000 | mixed_lens: 71.0000 | lr: 1.0172e-07 | scale: 512.00 | time: 26.186 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    925/  1000| tot_loss: 3.0529 | rl_loss: 1.4395 | pt_loss: 1.6134 | pg_loss: 0.3140 | reg_loss: 1.1255 | reward: -0.3114 | rev_kl: 2.2584 | stu_lens: 100.5000 | mixed_lens: 89.0000 | lr: 9.9266e-08 | scale: 512.00 | time: 26.164 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    926/  1000| tot_loss: 3.1161 | rl_loss: 1.0801 | pt_loss: 2.0360 | pg_loss: 0.0288 | reg_loss: 1.0514 | reward: -0.2454 | rev_kl: 1.1585 | stu_lens: 59.0000 | mixed_lens: 128.0000 | lr: 9.6846e-08 | scale: 512.00 | time: 26.165 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    927/  1000| tot_loss: 2.1456 | rl_loss: 1.0402 | pt_loss: 1.1053 | pg_loss: 0.0594 | reg_loss: 0.9808 | reward: -0.1299 | rev_kl: 0.9370 | stu_lens: 128.0000 | mixed_lens: 121.5000 | lr: 9.4455e-08 | scale: 512.00 | time: 26.137 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    928/  1000| tot_loss: 3.2931 | rl_loss: 1.2337 | pt_loss: 2.0594 | pg_loss: 0.2631 | reg_loss: 0.9707 | reward: -0.0507 | rev_kl: 0.9854 | stu_lens: 128.0000 | mixed_lens: 100.5000 | lr: 9.2094e-08 | scale: 512.00 | time: 26.190 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    928/  1000| tot_loss: 3.2499 | rl_loss: 1.4760 | pt_loss: 1.7739 | pg_loss: 0.3849 | reg_loss: 1.0911 | reward: -0.4360 | rev_kl: 1.0773 | stu_lens: 85.6719 | mixed_lens: 84.7500 | lr: 9.2094e-08 | scale: 512.00 | time: 26.190 | step time: 27.440
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    929/  1000| tot_loss: 3.1093 | rl_loss: 1.6273 | pt_loss: 1.4820 | pg_loss: 0.3353 | reg_loss: 1.2920 | reward: -0.4595 | rev_kl: 1.3978 | stu_lens: 92.5000 | mixed_lens: 84.0000 | lr: 8.9761e-08 | scale: 512.00 | time: 26.202 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    930/  1000| tot_loss: 3.3318 | rl_loss: 1.5997 | pt_loss: 1.7321 | pg_loss: 0.2813 | reg_loss: 1.3184 | reward: -0.5145 | rev_kl: 1.1809 | stu_lens: 128.0000 | mixed_lens: 100.0000 | lr: 8.7459e-08 | scale: 512.00 | time: 26.211 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    931/  1000| tot_loss: 2.3636 | rl_loss: 0.7792 | pt_loss: 1.5844 | pg_loss: 0.2123 | reg_loss: 0.5669 | reward: -0.4035 | rev_kl: 1.1820 | stu_lens: 34.5000 | mixed_lens: 92.0000 | lr: 8.5185e-08 | scale: 512.00 | time: 26.191 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    932/  1000| tot_loss: 3.0581 | rl_loss: 1.1614 | pt_loss: 1.8967 | pg_loss: 0.0411 | reg_loss: 1.1203 | reward: -0.2600 | rev_kl: 1.2468 | stu_lens: 120.5000 | mixed_lens: 128.0000 | lr: 8.2942e-08 | scale: 512.00 | time: 26.192 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    933/  1000| tot_loss: 2.6886 | rl_loss: 0.7965 | pt_loss: 1.8921 | pg_loss: 0.0588 | reg_loss: 0.7377 | reward: -0.2702 | rev_kl: 0.7044 | stu_lens: 94.5000 | mixed_lens: 108.0000 | lr: 8.0727e-08 | scale: 512.00 | time: 26.161 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    934/  1000| tot_loss: 3.2978 | rl_loss: 1.3427 | pt_loss: 1.9551 | pg_loss: 0.1258 | reg_loss: 1.2169 | reward: -0.3168 | rev_kl: 1.3194 | stu_lens: 51.5000 | mixed_lens: 92.5000 | lr: 7.8542e-08 | scale: 512.00 | time: 26.172 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    935/  1000| tot_loss: 4.1122 | rl_loss: 2.2790 | pt_loss: 1.8332 | pg_loss: 1.0916 | reg_loss: 1.1875 | reward: -1.1434 | rev_kl: 1.0121 | stu_lens: 97.5000 | mixed_lens: 41.5000 | lr: 7.6387e-08 | scale: 512.00 | time: 26.136 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:    936/  1000| tot_loss: 3.0221 | rl_loss: 1.5247 | pt_loss: 1.4974 | pg_loss: 0.0383 | reg_loss: 1.4864 | reward: -0.2833 | rev_kl: 0.9830 | stu_lens: 117.5000 | mixed_lens: 121.5000 | lr: 7.4261e-08 | scale: 512.00 | time: 26.165 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  2/ 4 | global iter:    937/  1000| tot_loss: 4.1386 | rl_loss: 2.3069 | pt_loss: 1.8317 | pg_loss: 0.9254 | reg_loss: 1.3815 | reward: -0.5957 | rev_kl: 0.7054 | stu_lens: 68.0000 | mixed_lens: 39.0000 | lr: 7.2164e-08 | scale: 512.00 | time: 26.159 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  2/ 4 | global iter:    938/  1000| tot_loss: 3.1443 | rl_loss: 1.6680 | pt_loss: 1.4764 | pg_loss: 0.4650 | reg_loss: 1.2030 | reward: -0.3142 | rev_kl: 0.8402 | stu_lens: 87.5000 | mixed_lens: 77.0000 | lr: 7.0097e-08 | scale: 512.00 | time: 26.207 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  2/ 4 | global iter:    939/  1000| tot_loss: 2.8360 | rl_loss: 0.6710 | pt_loss: 2.1651 | pg_loss: 0.1634 | reg_loss: 0.5075 | reward: -1.1744 | rev_kl: 0.6940 | stu_lens: 69.0000 | mixed_lens: 69.0000 | lr: 6.8060e-08 | scale: 512.00 | time: 26.180 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  2/ 4 | global iter:    940/  1000| tot_loss: 3.1896 | rl_loss: 1.3319 | pt_loss: 1.8577 | pg_loss: 0.1305 | reg_loss: 1.2015 | reward: -0.4122 | rev_kl: 1.1857 | stu_lens: 128.0000 | mixed_lens: 54.5000 | lr: 6.6053e-08 | scale: 512.00 | time: 26.197 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  2/ 4 | global iter:    941/  1000| tot_loss: 2.8846 | rl_loss: 1.0524 | pt_loss: 1.8322 | pg_loss: 0.0616 | reg_loss: 0.9907 | reward: -0.1949 | rev_kl: 1.1004 | stu_lens: 86.0000 | mixed_lens: 121.0000 | lr: 6.4075e-08 | scale: 512.00 | time: 26.162 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  2/ 4 | global iter:    942/  1000| tot_loss: 3.5731 | rl_loss: 1.9380 | pt_loss: 1.6351 | pg_loss: 1.2207 | reg_loss: 0.7173 | reward: -1.5706 | rev_kl: 0.4952 | stu_lens: 14.0000 | mixed_lens: 14.0000 | lr: 6.2127e-08 | scale: 512.00 | time: 26.173 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  2/ 4 | global iter:    943/  1000| tot_loss: 3.5113 | rl_loss: 2.3891 | pt_loss: 1.1222 | pg_loss: 1.2036 | reg_loss: 1.1855 | reward: 0.7925 | rev_kl: 0.5441 | stu_lens: 52.5000 | mixed_lens: 36.0000 | lr: 6.0208e-08 | scale: 512.00 | time: 26.159 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    944/  1000| tot_loss: 2.6279 | rl_loss: 0.9388 | pt_loss: 1.6892 | pg_loss: 0.0064 | reg_loss: 0.9324 | reward: -0.1019 | rev_kl: 1.3440 | stu_lens: 114.0000 | mixed_lens: 128.0000 | lr: 5.8319e-08 | scale: 512.00 | time: 26.191 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  2/ 4 | global iter:    944/  1000| tot_loss: 3.0879 | rl_loss: 1.3936 | pt_loss: 1.6943 | pg_loss: 0.3228 | reg_loss: 1.0707 | reward: -0.4159 | rev_kl: 1.0971 | stu_lens: 88.1875 | mixed_lens: 83.1875 | lr: 5.8319e-08 | scale: 512.00 | time: 26.191 | step time: 27.444
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  2/ 4 | global iter:    945/  1000| tot_loss: 2.8623 | rl_loss: 1.1495 | pt_loss: 1.7128 | pg_loss: 0.2148 | reg_loss: 0.9346 | reward: -0.9310 | rev_kl: 1.0915 | stu_lens: 70.5000 | mixed_lens: 86.0000 | lr: 5.6460e-08 | scale: 512.00 | time: 26.145 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  3/ 4 | global iter:    946/  1000| tot_loss: 3.0324 | rl_loss: 1.1301 | pt_loss: 1.9023 | pg_loss: 0.2796 | reg_loss: 0.8505 | reward: -0.6503 | rev_kl: 1.1851 | stu_lens: 91.0000 | mixed_lens: 67.0000 | lr: 5.4631e-08 | scale: 512.00 | time: 26.240 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  3/ 4 | global iter:    947/  1000| tot_loss: 3.1637 | rl_loss: 1.3968 | pt_loss: 1.7669 | pg_loss: 0.0381 | reg_loss: 1.3587 | reward: -0.1917 | rev_kl: 1.3234 | stu_lens: 114.0000 | mixed_lens: 128.0000 | lr: 5.2832e-08 | scale: 512.00 | time: 26.184 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  3/ 4 | global iter:    948/  1000| tot_loss: 2.6730 | rl_loss: 0.7664 | pt_loss: 1.9066 | pg_loss: 0.1820 | reg_loss: 0.5844 | reward: -0.3710 | rev_kl: 0.6823 | stu_lens: 114.0000 | mixed_lens: 97.0000 | lr: 5.1062e-08 | scale: 512.00 | time: 26.215 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  3/ 4 | global iter:    949/  1000| tot_loss: 3.1922 | rl_loss: 1.1056 | pt_loss: 2.0866 | pg_loss: 0.1794 | reg_loss: 0.9262 | reward: -0.5762 | rev_kl: 1.1255 | stu_lens: 120.5000 | mixed_lens: 98.0000 | lr: 4.9322e-08 | scale: 512.00 | time: 26.191 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  3/ 4 | global iter:    950/  1000| tot_loss: 2.9153 | rl_loss: 1.0188 | pt_loss: 1.8965 | pg_loss: 0.1656 | reg_loss: 0.8532 | reward: -0.2928 | rev_kl: 1.1699 | stu_lens: 22.5000 | mixed_lens: 92.5000 | lr: 4.7612e-08 | scale: 512.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  3/ 4 | global iter:    951/  1000| tot_loss: 2.6730 | rl_loss: 1.1334 | pt_loss: 1.5395 | pg_loss: 0.1461 | reg_loss: 0.9873 | reward: -0.4130 | rev_kl: 1.3579 | stu_lens: 128.0000 | mixed_lens: 105.0000 | lr: 4.5932e-08 | scale: 512.00 | time: 26.184 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  3/ 4 | global iter:    952/  1000| tot_loss: 2.3457 | rl_loss: 0.9290 | pt_loss: 1.4167 | pg_loss: 0.2329 | reg_loss: 0.6962 | reward: 0.0050 | rev_kl: 0.3861 | stu_lens: 66.5000 | mixed_lens: 87.5000 | lr: 4.4282e-08 | scale: 512.00 | time: 26.199 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  3/ 4 | global iter:    953/  1000| tot_loss: 3.0255 | rl_loss: 1.4204 | pt_loss: 1.6051 | pg_loss: 0.2029 | reg_loss: 1.2175 | reward: -0.6556 | rev_kl: 1.4073 | stu_lens: 128.0000 | mixed_lens: 100.0000 | lr: 4.2662e-08 | scale: 512.00 | time: 26.161 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  3/ 4 | global iter:    954/  1000| tot_loss: 3.7099 | rl_loss: 1.7779 | pt_loss: 1.9320 | pg_loss: 0.4291 | reg_loss: 1.3487 | reward: -0.9549 | rev_kl: 0.7785 | stu_lens: 62.0000 | mixed_lens: 73.5000 | lr: 4.1071e-08 | scale: 512.00 | time: 26.205 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  3/ 4 | global iter:    955/  1000| tot_loss: 2.9084 | rl_loss: 1.3148 | pt_loss: 1.5936 | pg_loss: 0.0597 | reg_loss: 1.2551 | reward: -0.2045 | rev_kl: 0.7728 | stu_lens: 117.5000 | mixed_lens: 115.0000 | lr: 3.9511e-08 | scale: 512.00 | time: 26.178 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  3/ 4 | global iter:    956/  1000| tot_loss: 2.4613 | rl_loss: 0.9397 | pt_loss: 1.5216 | pg_loss: 0.1531 | reg_loss: 0.7865 | reward: -0.1797 | rev_kl: 1.0222 | stu_lens: 75.0000 | mixed_lens: 107.0000 | lr: 3.7981e-08 | scale: 512.00 | time: 26.243 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  3/ 4 | global iter:    957/  1000| tot_loss: 3.0413 | rl_loss: 1.1436 | pt_loss: 1.8977 | pg_loss: 0.2655 | reg_loss: 0.8781 | reward: -0.7543 | rev_kl: 1.3536 | stu_lens: 115.0000 | mixed_lens: 70.0000 | lr: 3.6480e-08 | scale: 512.00 | time: 26.223 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  3/ 4 | global iter:    958/  1000| tot_loss: 2.3733 | rl_loss: 1.0664 | pt_loss: 1.3069 | pg_loss: 0.1655 | reg_loss: 0.9009 | reward: -0.2174 | rev_kl: 0.8468 | stu_lens: 77.0000 | mixed_lens: 89.5000 | lr: 3.5010e-08 | scale: 512.00 | time: 26.249 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  3/ 4 | global iter:    959/  1000| tot_loss: 3.2251 | rl_loss: 1.3061 | pt_loss: 1.9190 | pg_loss: 0.0470 | reg_loss: 1.2591 | reward: -0.4260 | rev_kl: 1.2857 | stu_lens: 128.0000 | mixed_lens: 123.0000 | lr: 3.3570e-08 | scale: 512.00 | time: 26.187 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    960/  1000| tot_loss: 2.9090 | rl_loss: 1.1357 | pt_loss: 1.7733 | pg_loss: -0.0052 | reg_loss: 1.1409 | reward: -0.3390 | rev_kl: 1.4406 | stu_lens: 99.5000 | mixed_lens: 128.0000 | lr: 3.2159e-08 | scale: 512.00 | time: 26.205 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  3/ 4 | global iter:    960/  1000| tot_loss: 3.0734 | rl_loss: 1.3333 | pt_loss: 1.7401 | pg_loss: 0.2992 | reg_loss: 1.0341 | reward: -0.4849 | rev_kl: 1.0732 | stu_lens: 83.8594 | mixed_lens: 81.2500 | lr: 3.2159e-08 | scale: 512.00 | time: 26.205 | step time: 27.466
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  3/ 4 | global iter:    961/  1000| tot_loss: 2.6111 | rl_loss: 0.8954 | pt_loss: 1.7157 | pg_loss: 0.1998 | reg_loss: 0.6956 | reward: -1.2545 | rev_kl: 1.1256 | stu_lens: 69.0000 | mixed_lens: 69.0000 | lr: 3.0779e-08 | scale: 512.00 | time: 26.161 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  0/ 4 | global iter:    962/  1000| tot_loss: 2.6833 | rl_loss: 1.2013 | pt_loss: 1.4820 | pg_loss: 0.2831 | reg_loss: 0.9182 | reward: -0.1484 | rev_kl: 1.3971 | stu_lens: 26.0000 | mixed_lens: 27.5000 | lr: 2.9429e-08 | scale: 512.00 | time: 26.288 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  0/ 4 | global iter:    963/  1000| tot_loss: 3.8240 | rl_loss: 2.1900 | pt_loss: 1.6340 | pg_loss: 0.4313 | reg_loss: 1.7587 | reward: -0.6800 | rev_kl: 1.4829 | stu_lens: 84.5000 | mixed_lens: 89.5000 | lr: 2.8109e-08 | scale: 512.00 | time: 26.213 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  0/ 4 | global iter:    964/  1000| tot_loss: 3.3062 | rl_loss: 1.9034 | pt_loss: 1.4027 | pg_loss: 0.4207 | reg_loss: 1.4827 | reward: -0.1545 | rev_kl: 0.8378 | stu_lens: 93.0000 | mixed_lens: 82.5000 | lr: 2.6819e-08 | scale: 512.00 | time: 26.227 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  0/ 4 | global iter:    965/  1000| tot_loss: 2.0497 | rl_loss: 0.7790 | pt_loss: 1.2707 | pg_loss: 0.2044 | reg_loss: 0.5746 | reward: -0.2808 | rev_kl: 0.2542 | stu_lens: 58.5000 | mixed_lens: 76.0000 | lr: 2.5559e-08 | scale: 512.00 | time: 26.185 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  0/ 4 | global iter:    966/  1000| tot_loss: 3.3227 | rl_loss: 1.5069 | pt_loss: 1.8158 | pg_loss: 0.2256 | reg_loss: 1.2813 | reward: -0.1749 | rev_kl: 1.1148 | stu_lens: 99.0000 | mixed_lens: 106.5000 | lr: 2.4330e-08 | scale: 512.00 | time: 26.193 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  0/ 4 | global iter:    967/  1000| tot_loss: 2.9790 | rl_loss: 1.9989 | pt_loss: 0.9801 | pg_loss: 0.3033 | reg_loss: 1.6956 | reward: -0.3688 | rev_kl: 0.7827 | stu_lens: 54.5000 | mixed_lens: 103.5000 | lr: 2.3130e-08 | scale: 512.00 | time: 26.151 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  0/ 4 | global iter:    968/  1000| tot_loss: 3.7850 | rl_loss: 1.9789 | pt_loss: 1.8062 | pg_loss: 1.1148 | reg_loss: 0.8641 | reward: -0.5032 | rev_kl: 1.0492 | stu_lens: 25.5000 | mixed_lens: 33.5000 | lr: 2.1961e-08 | scale: 512.00 | time: 26.192 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  0/ 4 | global iter:    969/  1000| tot_loss: 3.4643 | rl_loss: 1.6820 | pt_loss: 1.7823 | pg_loss: 0.3793 | reg_loss: 1.3027 | reward: -0.4377 | rev_kl: 0.8612 | stu_lens: 71.5000 | mixed_lens: 82.0000 | lr: 2.0822e-08 | scale: 512.00 | time: 26.184 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  0/ 4 | global iter:    970/  1000| tot_loss: 2.5728 | rl_loss: 1.4490 | pt_loss: 1.1238 | pg_loss: 0.1396 | reg_loss: 1.3093 | reward: -0.2860 | rev_kl: 1.2738 | stu_lens: 81.0000 | mixed_lens: 118.5000 | lr: 1.9713e-08 | scale: 512.00 | time: 26.202 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  0/ 4 | global iter:    971/  1000| tot_loss: 3.0005 | rl_loss: 1.6588 | pt_loss: 1.3417 | pg_loss: 0.3243 | reg_loss: 1.3344 | reward: -0.3141 | rev_kl: 1.0713 | stu_lens: 72.5000 | mixed_lens: 94.0000 | lr: 1.8635e-08 | scale: 512.00 | time: 26.216 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  0/ 4 | global iter:    972/  1000| tot_loss: 3.0556 | rl_loss: 1.4542 | pt_loss: 1.6015 | pg_loss: 0.1374 | reg_loss: 1.3168 | reward: -0.2753 | rev_kl: 1.1795 | stu_lens: 106.5000 | mixed_lens: 108.0000 | lr: 1.7586e-08 | scale: 512.00 | time: 26.247 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  0/ 4 | global iter:    973/  1000| tot_loss: 2.6931 | rl_loss: 1.4309 | pt_loss: 1.2623 | pg_loss: 0.3238 | reg_loss: 1.1071 | reward: -2.1219 | rev_kl: 1.1798 | stu_lens: 78.0000 | mixed_lens: 67.5000 | lr: 1.6568e-08 | scale: 512.00 | time: 26.209 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  0/ 4 | global iter:    974/  1000| tot_loss: 4.0565 | rl_loss: 2.2507 | pt_loss: 1.8058 | pg_loss: 0.9944 | reg_loss: 1.2563 | reward: -0.6388 | rev_kl: 1.6664 | stu_lens: 70.5000 | mixed_lens: 39.0000 | lr: 1.5580e-08 | scale: 512.00 | time: 26.191 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  0/ 4 | global iter:    975/  1000| tot_loss: 3.1605 | rl_loss: 1.4362 | pt_loss: 1.7243 | pg_loss: 0.4364 | reg_loss: 0.9997 | reward: 2.0278 | rev_kl: 0.4772 | stu_lens: 61.5000 | mixed_lens: 65.5000 | lr: 1.4623e-08 | scale: 512.00 | time: 26.180 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    976/  1000| tot_loss: 3.6185 | rl_loss: 1.6106 | pt_loss: 2.0079 | pg_loss: 0.3424 | reg_loss: 1.2681 | reward: -0.2511 | rev_kl: 0.6868 | stu_lens: 42.0000 | mixed_lens: 76.0000 | lr: 1.3695e-08 | scale: 512.00 | time: 26.183 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  0/ 4 | global iter:    976/  1000| tot_loss: 3.1026 | rl_loss: 1.4578 | pt_loss: 1.6448 | pg_loss: 0.3574 | reg_loss: 1.1004 | reward: -0.5255 | rev_kl: 1.0262 | stu_lens: 77.8594 | mixed_lens: 79.4375 | lr: 1.3695e-08 | scale: 512.00 | time: 26.183 | step time: 27.472
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  0/ 4 | global iter:    977/  1000| tot_loss: 4.6116 | rl_loss: 2.8687 | pt_loss: 1.7429 | pg_loss: 1.6109 | reg_loss: 1.2578 | reward: -1.3715 | rev_kl: 1.1672 | stu_lens: 39.5000 | mixed_lens: 23.0000 | lr: 1.2798e-08 | scale: 512.00 | time: 26.156 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  1/ 4 | global iter:    978/  1000| tot_loss: 2.8348 | rl_loss: 1.1597 | pt_loss: 1.6751 | pg_loss: 0.0944 | reg_loss: 1.0654 | reward: -0.1359 | rev_kl: 0.8298 | stu_lens: 95.0000 | mixed_lens: 119.0000 | lr: 1.1932e-08 | scale: 512.00 | time: 26.179 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  1/ 4 | global iter:    979/  1000| tot_loss: 3.5156 | rl_loss: 1.6020 | pt_loss: 1.9136 | pg_loss: 0.3114 | reg_loss: 1.2906 | reward: -0.1692 | rev_kl: 1.6449 | stu_lens: 64.5000 | mixed_lens: 87.5000 | lr: 1.1095e-08 | scale: 512.00 | time: 26.143 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  1/ 4 | global iter:    980/  1000| tot_loss: 3.1682 | rl_loss: 1.6379 | pt_loss: 1.5303 | pg_loss: 0.3228 | reg_loss: 1.3151 | reward: -0.3700 | rev_kl: 0.9658 | stu_lens: 72.0000 | mixed_lens: 85.5000 | lr: 1.0289e-08 | scale: 512.00 | time: 26.241 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  1/ 4 | global iter:    981/  1000| tot_loss: 4.1640 | rl_loss: 2.4780 | pt_loss: 1.6860 | pg_loss: 1.2842 | reg_loss: 1.1938 | reward: -0.9157 | rev_kl: 0.8369 | stu_lens: 27.0000 | mixed_lens: 29.5000 | lr: 9.5133e-09 | scale: 512.00 | time: 26.212 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  1/ 4 | global iter:    982/  1000| tot_loss: 3.1674 | rl_loss: 1.2677 | pt_loss: 1.8996 | pg_loss: 0.2491 | reg_loss: 1.0186 | reward: -0.3123 | rev_kl: 0.6384 | stu_lens: 40.5000 | mixed_lens: 87.5000 | lr: 8.7679e-09 | scale: 512.00 | time: 26.222 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  1/ 4 | global iter:    983/  1000| tot_loss: 2.7635 | rl_loss: 0.7700 | pt_loss: 1.9936 | pg_loss: 0.0348 | reg_loss: 0.7351 | reward: -0.2580 | rev_kl: 1.1311 | stu_lens: 128.0000 | mixed_lens: 128.0000 | lr: 8.0528e-09 | scale: 512.00 | time: 26.193 | step time: 0.000
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  1/ 4 | global iter:    984/  1000| tot_loss: 2.3842 | rl_loss: 0.9514 | pt_loss: 1.4328 | pg_loss: 0.1700 | reg_loss: 0.7814 | reward: -0.1143 | rev_kl: 0.7274 | stu_lens: 85.5000 | mixed_lens: 107.0000 | lr: 7.3681e-09 | scale: 512.00 | time: 26.209 | step time: 0.000
train | data_epochs  0/10 | inner iter:  15/ 32 | ppo epoch:  1/ 4 | global iter:    985/  1000| tot_loss: 3.3833 | rl_loss: 1.8367 | pt_loss: 1.5466 | pg_loss: 0.5372 | reg_loss: 1.2996 | reward: -1.0654 | rev_kl: 0.9779 | stu_lens: 75.5000 | mixed_lens: 67.0000 | lr: 6.7138e-09 | scale: 512.00 | time: 26.163 | step time: 0.000
train | data_epochs  0/10 | inner iter:  17/ 32 | ppo epoch:  1/ 4 | global iter:    986/  1000| tot_loss: 3.4570 | rl_loss: 1.7213 | pt_loss: 1.7358 | pg_loss: 0.6656 | reg_loss: 1.0557 | reward: -0.8974 | rev_kl: 1.1794 | stu_lens: 104.5000 | mixed_lens: 48.5000 | lr: 6.0899e-09 | scale: 512.00 | time: 26.189 | step time: 0.000
train | data_epochs  0/10 | inner iter:  19/ 32 | ppo epoch:  1/ 4 | global iter:    987/  1000| tot_loss: 2.9570 | rl_loss: 0.9996 | pt_loss: 1.9574 | pg_loss: 0.2616 | reg_loss: 0.7380 | reward: -0.3626 | rev_kl: 0.8268 | stu_lens: 78.5000 | mixed_lens: 91.0000 | lr: 5.4963e-09 | scale: 512.00 | time: 26.149 | step time: 0.000
train | data_epochs  0/10 | inner iter:  21/ 32 | ppo epoch:  1/ 4 | global iter:    988/  1000| tot_loss: 4.0058 | rl_loss: 2.2526 | pt_loss: 1.7532 | pg_loss: 0.7478 | reg_loss: 1.5048 | reward: -3.5473 | rev_kl: 0.5826 | stu_lens: 25.0000 | mixed_lens: 54.5000 | lr: 4.9332e-09 | scale: 512.00 | time: 26.200 | step time: 0.000
train | data_epochs  0/10 | inner iter:  23/ 32 | ppo epoch:  1/ 4 | global iter:    989/  1000| tot_loss: 3.3257 | rl_loss: 1.5971 | pt_loss: 1.7285 | pg_loss: 0.3261 | reg_loss: 1.2710 | reward: -0.7299 | rev_kl: 1.3951 | stu_lens: 67.5000 | mixed_lens: 89.5000 | lr: 4.4004e-09 | scale: 512.00 | time: 26.245 | step time: 0.000
train | data_epochs  0/10 | inner iter:  25/ 32 | ppo epoch:  1/ 4 | global iter:    990/  1000| tot_loss: 2.5292 | rl_loss: 1.3132 | pt_loss: 1.2160 | pg_loss: 0.2643 | reg_loss: 1.0489 | reward: -0.3988 | rev_kl: 0.6402 | stu_lens: 94.0000 | mixed_lens: 93.5000 | lr: 3.8981e-09 | scale: 512.00 | time: 26.246 | step time: 0.000
train | data_epochs  0/10 | inner iter:  27/ 32 | ppo epoch:  1/ 4 | global iter:    991/  1000| tot_loss: 2.8933 | rl_loss: 1.2898 | pt_loss: 1.6035 | pg_loss: 0.0986 | reg_loss: 1.1912 | reward: -0.2732 | rev_kl: 1.0435 | stu_lens: 94.5000 | mixed_lens: 115.0000 | lr: 3.4262e-09 | scale: 512.00 | time: 26.217 | step time: 0.000
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    992/  1000| tot_loss: 3.4800 | rl_loss: 2.3239 | pt_loss: 1.1561 | pg_loss: 1.1201 | reg_loss: 1.2038 | reward: -1.2171 | rev_kl: 0.8386 | stu_lens: 27.0000 | mixed_lens: 18.0000 | lr: 2.9847e-09 | scale: 512.00 | time: 26.191 | step time: 0.000
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  29/ 32 | ppo epoch:  1/ 4 | global iter:    992/  1000| tot_loss: 3.4163 | rl_loss: 1.7316 | pt_loss: 1.6848 | pg_loss: 0.5767 | reg_loss: 1.1549 | reward: -0.6007 | rev_kl: 0.9901 | stu_lens: 69.8438 | mixed_lens: 72.4375 | lr: 2.9847e-09 | scale: 512.00 | time: 26.191 | step time: 27.462
/dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2
****************************************************************************************************
train | data_epochs  0/10 | inner iter:  31/ 32 | ppo epoch:  1/ 4 | global iter:    993/  1000| tot_loss: 4.4632 | rl_loss: 2.1868 | pt_loss: 2.2764 | pg_loss: 0.5985 | reg_loss: 1.5883 | reward: -0.5582 | rev_kl: 1.2375 | stu_lens: 106.5000 | mixed_lens: 68.5000 | lr: 2.5736e-09 | scale: 512.00 | time: 26.165 | step time: 0.000
train | data_epochs  0/10 | inner iter:   1/ 32 | ppo epoch:  2/ 4 | global iter:    994/  1000| tot_loss: 3.1624 | rl_loss: 1.7712 | pt_loss: 1.3912 | pg_loss: 0.2435 | reg_loss: 1.5278 | reward: -0.3739 | rev_kl: 1.1069 | stu_lens: 128.0000 | mixed_lens: 96.0000 | lr: 2.1929e-09 | scale: 512.00 | time: 26.162 | step time: 0.000
train | data_epochs  0/10 | inner iter:   3/ 32 | ppo epoch:  2/ 4 | global iter:    995/  1000| tot_loss: 2.7368 | rl_loss: 1.1913 | pt_loss: 1.5455 | pg_loss: 0.2278 | reg_loss: 0.9635 | reward: -0.2587 | rev_kl: 1.2153 | stu_lens: 126.0000 | mixed_lens: 111.0000 | lr: 1.8427e-09 | scale: 512.00 | time: 26.164 | step time: 0.000
train | data_epochs  0/10 | inner iter:   5/ 32 | ppo epoch:  2/ 4 | global iter:    996/  1000| tot_loss: 3.2133 | rl_loss: 1.7111 | pt_loss: 1.5022 | pg_loss: 0.4932 | reg_loss: 1.2179 | reward: -0.6572 | rev_kl: 1.2679 | stu_lens: 106.5000 | mixed_lens: 78.5000 | lr: 1.5229e-09 | scale: 512.00 | time: 26.179 | step time: 0.000
train | data_epochs  0/10 | inner iter:   7/ 32 | ppo epoch:  2/ 4 | global iter:    997/  1000| tot_loss: 3.1658 | rl_loss: 1.5992 | pt_loss: 1.5666 | pg_loss: 0.3050 | reg_loss: 1.2942 | reward: -0.2118 | rev_kl: 1.0906 | stu_lens: 99.0000 | mixed_lens: 106.5000 | lr: 1.2336e-09 | scale: 512.00 | time: 26.187 | step time: 0.000
train | data_epochs  0/10 | inner iter:   9/ 32 | ppo epoch:  2/ 4 | global iter:    998/  1000| tot_loss: 2.7327 | rl_loss: 1.2480 | pt_loss: 1.4847 | pg_loss: 0.3047 | reg_loss: 0.9433 | reward: -0.3901 | rev_kl: 0.6562 | stu_lens: 71.5000 | mixed_lens: 76.0000 | lr: 9.7471e-10 | scale: 512.00 | time: 26.233 | step time: 0.000
train | data_epochs  0/10 | inner iter:  11/ 32 | ppo epoch:  2/ 4 | global iter:    999/  1000| tot_loss: 3.9707 | rl_loss: 1.9653 | pt_loss: 2.0055 | pg_loss: 1.5784 | reg_loss: 0.3868 | reward: -0.7713 | rev_kl: 1.1560 | stu_lens: 55.5000 | mixed_lens: 15.5000 | lr: 7.4628e-10 | scale: 512.00 | time: 26.202 | step time: 0.000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/1000
                                 Evaluation #10                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Convert the above time to Pacific     │ Convert the above time to Pacific    │
│ Standard Time.                        │ Standard Time.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 08:00 UTC is equal to 04:00 PST.     │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ In unix 'epoch' time, the timestamp  │
│                                       │ is the number of seconds elapsed     │
│                                       │ since January 1, 1970. So, the       │
│                                       │ timestamp for 0 seconds would be 0   │
│                                       │ seconds.                             │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 0 seconds is not a valid time in     │
│                                       │ unix 'epoch' time. The smallest      │
│                                       │ value is 1 second.                   │
└───────────────────────────────────────┴──────────────────────────────────────┘
eval | rougeL: 15.601 | exact_match: 0.000 | rev_kl: 1.156 | lens: 80.782 | pt_loss: 1.087 | lm_loss: 1.178 | kd_loss: 0.996 
train | data_epochs  0/10 | inner iter:  13/ 32 | ppo epoch:  2/ 4 | global iter:   1000/  1000| tot_loss: 3.1199 | rl_loss: 1.3826 | pt_loss: 1.7373 | pg_loss: 0.2110 | reg_loss: 1.1716 | reward: -0.1688 | rev_kl: 0.7748 | stu_lens: 128.0000 | mixed_lens: 93.5000 | lr: 5.4829e-10 | scale: 512.00 | time: 26.260 | step time: 0.000
Reached total steps 1000/1000
Model save to /dtu/p1/johlau/LMOps/minillm/results/llama/train/minillm_en/bs2-lr5e-06-G2-N1-NN1-lm1-len256/pe4_rs0.5_nr64_ln_sr_tm0.2/1000
                                 Evaluation #11                                 
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ prompts                               ┃ samples                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ Convert the above time to Pacific     │ Convert the above time to Pacific    │
│ Standard Time.                        │ Standard Time.                       │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ 19:00 UTC is 12:00 PM PST            │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ That would be '1970-01-01 00:00:00'. │
├───────────────────────────────────────┼──────────────────────────────────────┤
│ Below is an instruction that          │ Below is an instruction that         │
│ describes a task. Write a response    │ describes a task. Write a response   │
│ that appropriately completes the      │ that appropriately completes the     │
│ request.                              │ request.                             │
│                                       │                                      │
│ ### Instruction:                      │ ### Instruction:                     │
│ What about in unix 'epoch' time?      │ What about in unix 'epoch' time?     │
│ (assume 0 seconds)?                   │ (assume 0 seconds)?                  │
│                                       │                                      │
│ ### Response:                         │ ### Response:                        │
│                                       │ The unix 'epoch' time is 1970-01-01  │
│                                       │ 00:00:00.                            │
└───────────────────────────────────────┴──────────────────────────────────────┘
