Loaded module: cuda/12.1
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 15 examples [00:00, 130.73 examples/s]Generating train split: 33 examples [00:00, 59.03 examples/s] Generating train split: 43 examples [00:00, 43.87 examples/s]Generating train split: 52 examples [00:01, 38.22 examples/s]Generating train split: 57 examples [00:01, 38.87 examples/s]Generating train split: 62 examples [00:01, 25.10 examples/s]Generating train split: 66 examples [00:02, 19.53 examples/s]Generating train split: 73 examples [00:02, 22.84 examples/s]Generating train split: 81 examples [00:02, 29.55 examples/s]Generating train split: 88 examples [00:02, 31.77 examples/s]Generating train split: 102 examples [00:02, 49.44 examples/s]Generating train split: 122 examples [00:02, 62.42 examples/s]Generating train split: 135 examples [00:03, 73.59 examples/s]Generating train split: 151 examples [00:03, 59.17 examples/s]Generating train split: 161 examples [00:03, 58.08 examples/s]Generating train split: 171 examples [00:04, 37.54 examples/s]Generating train split: 181 examples [00:04, 42.20 examples/s]Generating train split: 190 examples [00:04, 38.53 examples/s]Generating train split: 195 examples [00:04, 39.52 examples/s]Generating train split: 207 examples [00:04, 43.24 examples/s]Generating train split: 217 examples [00:05, 49.44 examples/s]Generating train split: 226 examples [00:05, 49.43 examples/s]Generating train split: 237 examples [00:05, 55.25 examples/s]Generating train split: 246 examples [00:05, 54.01 examples/s]Generating train split: 253 examples [00:05, 56.78 examples/s]Generating train split: 261 examples [00:05, 54.88 examples/s]Generating train split: 268 examples [00:06, 53.99 examples/s]Generating train split: 278 examples [00:06, 48.85 examples/s]Generating train split: 291 examples [00:06, 61.83 examples/s]Generating train split: 298 examples [00:06, 47.87 examples/s]Generating train split: 309 examples [00:06, 48.08 examples/s]Generating train split: 322 examples [00:07, 51.20 examples/s]Generating train split: 332 examples [00:07, 58.61 examples/s]Generating train split: 342 examples [00:07, 53.63 examples/s]Generating train split: 349 examples [00:07, 48.53 examples/s]Generating train split: 358 examples [00:07, 48.71 examples/s]Generating train split: 370 examples [00:08, 49.57 examples/s]Generating train split: 378 examples [00:08, 41.77 examples/s]Generating train split: 384 examples [00:08, 33.35 examples/s]Generating train split: 396 examples [00:08, 37.06 examples/s]Generating train split: 408 examples [00:08, 47.95 examples/s]Generating train split: 415 examples [00:09, 42.74 examples/s]Generating train split: 423 examples [00:09, 46.29 examples/s]Generating train split: 435 examples [00:09, 49.98 examples/s]Generating train split: 445 examples [00:09, 57.60 examples/s]Generating train split: 452 examples [00:09, 46.82 examples/s]Generating train split: 463 examples [00:10, 57.32 examples/s]Generating train split: 477 examples [00:10, 56.02 examples/s]Generating train split: 489 examples [00:10, 48.25 examples/s]Generating train split: 499 examples [00:10, 48.89 examples/s]Generating train split: 513 examples [00:10, 62.40 examples/s]Generating train split: 524 examples [00:11, 57.19 examples/s]Generating train split: 532 examples [00:11, 55.60 examples/s]Generating train split: 544 examples [00:11, 53.19 examples/s]Generating train split: 550 examples [00:11, 47.31 examples/s]
Generating validation split: 0 examples [00:00, ? examples/s]Generating validation split: 409 examples [00:00, 3715.99 examples/s]Generating validation split: 874 examples [00:00, 2524.89 examples/s]Generating validation split: 1178 examples [00:01, 873.43 examples/s]Generating validation split: 1590 examples [00:01, 1296.86 examples/s]Generating validation split: 1878 examples [00:01, 1251.27 examples/s]Generating validation split: 2195 examples [00:01, 1529.52 examples/s]Generating validation split: 2605 examples [00:01, 1987.62 examples/s]Generating validation split: 3000 examples [00:01, 1913.99 examples/s]Generating validation split: 3379 examples [00:01, 2267.66 examples/s]Generating validation split: 3868 examples [00:02, 2823.39 examples/s]Generating validation split: 4378 examples [00:02, 2244.75 examples/s]Generating validation split: 4794 examples [00:02, 2592.13 examples/s]Generating validation split: 5178 examples [00:02, 2685.29 examples/s]Generating validation split: 5678 examples [00:02, 3164.91 examples/s]Generating validation split: 6091 examples [00:02, 2597.83 examples/s]Generating validation split: 6572 examples [00:03, 3050.10 examples/s]Generating validation split: 6938 examples [00:03, 3186.55 examples/s]Generating validation split: 7478 examples [00:03, 2421.44 examples/s]Generating validation split: 7905 examples [00:03, 2762.56 examples/s]Generating validation split: 8362 examples [00:03, 2376.72 examples/s]Generating validation split: 8747 examples [00:03, 2606.24 examples/s]Generating validation split: 9108 examples [00:04, 2796.26 examples/s]Generating validation split: 9447 examples [00:04, 2198.94 examples/s]Generating validation split: 9753 examples [00:04, 2366.63 examples/s]Generating validation split: 10244 examples [00:04, 2807.40 examples/s]Generating validation split: 10572 examples [00:04, 2915.52 examples/s]Generating validation split: 11000 examples [00:04, 2464.11 examples/s]Generating validation split: 11347 examples [00:04, 2652.24 examples/s]Generating validation split: 11747 examples [00:05, 2839.23 examples/s]Generating validation split: 12147 examples [00:05, 2334.84 examples/s]Generating validation split: 12547 examples [00:05, 2180.14 examples/s]Generating validation split: 12997 examples [00:05, 2573.32 examples/s]Generating validation split: 13447 examples [00:05, 2687.80 examples/s]Generating validation split: 13747 examples [00:05, 2262.19 examples/s]Generating validation split: 14093 examples [00:06, 2502.04 examples/s]Generating validation split: 14601 examples [00:06, 3076.13 examples/s]Generating validation split: 15000 examples [00:06, 3186.25 examples/s]Generating validation split: 15476 examples [00:06, 2556.25 examples/s]Generating validation split: 15920 examples [00:06, 2937.79 examples/s]Generating validation split: 16276 examples [00:06, 2400.54 examples/s]Generating validation split: 16705 examples [00:07, 2497.76 examples/s]Generating validation split: 17091 examples [00:07, 2234.04 examples/s]Generating validation split: 17481 examples [00:07, 2087.90 examples/s]Generating validation split: 17973 examples [00:07, 2602.66 examples/s]Generating validation split: 18369 examples [00:07, 2520.18 examples/s]Generating validation split: 18681 examples [00:07, 1920.47 examples/s]Generating validation split: 19000 examples [00:08, 2122.26 examples/s]Generating validation split: 19478 examples [00:08, 2650.22 examples/s]Generating validation split: 19856 examples [00:08, 2899.18 examples/s]Generating validation split: 20281 examples [00:08, 2277.04 examples/s]Generating validation split: 20380 examples [00:08, 2278.94 examples/s]
Generating test split: 0 examples [00:00, ? examples/s]Generating test split: 280 examples [00:00, 2170.19 examples/s]Generating test split: 620 examples [00:00, 2813.92 examples/s]Generating test split: 1000 examples [00:00, 2154.48 examples/s]Generating test split: 1301 examples [00:00, 2237.91 examples/s]Generating test split: 1701 examples [00:00, 2642.84 examples/s]Generating test split: 2001 examples [00:00, 2695.76 examples/s]Generating test split: 2301 examples [00:01, 1914.30 examples/s]Generating test split: 2774 examples [00:01, 2522.47 examples/s]Generating test split: 3260 examples [00:01, 2548.25 examples/s]Generating test split: 3599 examples [00:01, 2187.78 examples/s]Generating test split: 3927 examples [00:01, 2303.20 examples/s]Generating test split: 4211 examples [00:01, 2362.83 examples/s]Generating test split: 4511 examples [00:01, 1989.73 examples/s]Generating test split: 4998 examples [00:02, 2554.32 examples/s]Generating test split: 5366 examples [00:02, 2807.71 examples/s]Generating test split: 5822 examples [00:02, 3176.55 examples/s]Generating test split: 6202 examples [00:02, 3302.66 examples/s]Generating test split: 6711 examples [00:02, 2236.52 examples/s]Generating test split: 7033 examples [00:02, 2416.13 examples/s]Generating test split: 7411 examples [00:03, 2237.57 examples/s]Generating test split: 7815 examples [00:03, 2498.62 examples/s]Generating test split: 8143 examples [00:03, 2637.93 examples/s]Generating test split: 8531 examples [00:03, 2368.88 examples/s]Generating test split: 8811 examples [00:03, 2386.47 examples/s]Generating test split: 9111 examples [00:03, 2315.28 examples/s]Generating test split: 9411 examples [00:03, 1954.59 examples/s]Generating test split: 9833 examples [00:04, 2291.21 examples/s]Generating test split: 10246 examples [00:04, 2681.29 examples/s]Generating test split: 10711 examples [00:04, 2258.99 examples/s]Generating test split: 11011 examples [00:04, 2396.15 examples/s]Generating test split: 11545 examples [00:04, 3036.03 examples/s]Generating test split: 11810 examples [00:04, 2380.95 examples/s]
  0%|          | 0/11810 [00:00<?, ?it/s]  0%|          | 0/11810 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/dtu/p1/johlau/Tk-Instruct/src/run_bloom.py", line 75, in <module>
    response = model(
  File "/zhome/4e/b/208805/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/zhome/4e/b/208805/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/dtu/p1/johlau/LMOps/minillm/transformers/src/transformers/models/bloom/modeling_bloom.py", line 869, in forward
    raise ValueError(f"Got unexpected arguments: {deprecated_arguments}")
ValueError: Got unexpected arguments: {'prompt': 'Definition: Generate an appropriate title for the given text. The generated title must be short and include the main topic of the text. The preferred titles are under fifteen words.\n\n Positive Example 1 -\nInput: But Eluned Morgan conceded that it would be "difficult for us to stop" from a legal point of view. Her comments were criticised by a Labour AM. Alun Davies said threatening legal action "sounds like the last breath before you\'re thrown out of the pub". Mr Davies said he was not convinced the Welsh Government would "have a leg to stand on" in trying to shape international trade deals after Brexit. Following Donald Trump\'s comments during last week\'s trade visit that the NHS would be "on the table" in any future trade talks between the UK and the USA, Eluned Morgan said there was "absolutely no prospect whatsoever of us allowing the Welsh NHS to be part of any negotiation." The US President then rowed back on his initial comments following criticism from a number of MPs. Asked about her response to President Trump\'s remarks as she gave evidence to the Assembly\'s Brexit committee on Monday, Ms Morgan said "legally, it would be difficult for us to stop because we don\'t have a veto over trade". "Politically, I think it\'s extremely unlikely to happen," the international relations and the Welsh language minister said. "They [the UK Government] should not be concluding any trade agreements without consulting us where we have the power." Ms Morgan explained that UK and Welsh government officials are working on an agreement or \'concordat\' for how future trade deals are negotiated. During a robust exchange, the Labour AM Alun Davies said: "I want something which is in law to which I can hold you to account and which colleagues in Westminster can hold the UK Government to account. "The argument we\'ll make life difficult for them, it sounds alright on the street, but it\'s not the reality of intergovernmental relations." "The United Kingdom has to find a way of functioning. "At the moment, your answers aren\'t giving me any confidence that there is that structure in place because, if the Welsh Government\'s argument is, \'we\'ll see you in court\', it\'s not a very impressive argument either for the continuation of the structure of United Kingdom as a state or the commitment of the government within the United Kingdom to actually work together," he added. Responding to the criticism, Ms Morgan said: "Is the current intergovernmental structure adequate? "Absolutely not... and it\'s not just in relation to trade, it\'s in relation to almost every aspect of government policy. So, that infrastructure needs to be built."\n Output: NHS Wales: Court action if trade deals affect service?\n\nNow complete the following example -\nInput: Chorley Council has objected to plans for the Cuerden retail park near Bamber Bridge in Lancashire amid concerns it could threaten its £17m town centre redevelopment. The authority is seeking the compensation from the developers and backers Lancashire County Council about the planned 65-hectare retail park. They said the "money is not justified". The developers said the site features restaurants and a hotel and would also create 4,500 jobs and could house offices and shops, as well as the Ikea store. But Chorley Council is concerned the plans could drive people away from its own new-look town centre, which will feature a cinema and new high street shops. The planning application will be dealt with by South Ribble Borough Council next month. Chorley Council has written a letter spelling out concerns, including fears about the impact of increased traffic. The council\'s deputy leader Peter Wilson said the council had been watching the plans "very closely" and wanted to "protect the interests" of Chorley. He added: "While we want to see economic growth across Lancashire, we are concerned that the proposals don\'t properly address the impact that a development of that size could have on Chorley town centre and the traffic and highways surrounding the area. "For those reasons, we cannot support the proposals as they currently stand." The council\'s objection letter demands "a financial contribution of £11,520,121.00 to mitigate the impact of the Cuerden development". A spokesman for the Cuerden Strategic Site developers said: "We are aware that Chorley Council has objected to the Cuerden application, however it is unclear from their letter what the justification is for doing so. "Following a detailed and robust assessment, our own professional advisers have concluded that the potential retail impacts on neighbouring areas are acceptable. "Therefore, Chorley Council\'s request for a significant sum of money by way of mitigation is not justified."\nOutput:', 'temperature': 1, 'max_tokens': 128}
Traceback (most recent call last):
  File "/dtu/p1/johlau/Tk-Instruct/src/compute_metrics.py", line 140, in <module>
    results = compute_metrics(predictions, references, xlingual=args.track == "xlingual")
  File "/dtu/p1/johlau/Tk-Instruct/src/compute_metrics.py", line 90, in compute_metrics
    exact_match = 100.0 * exact_match / len(references)
ZeroDivisionError: float division by zero
/dtu/p1/johlau/Tk-Instruct/scripts/run_bloom.sh: line 23: syntax error near unexpected token `done'
/dtu/p1/johlau/Tk-Instruct/scripts/run_bloom.sh: line 23: `done'
